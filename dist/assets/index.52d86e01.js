(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerpolicy&&(s.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?s.credentials="include":i.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();var hr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function gT(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function mT(r){var e=r.default;if(typeof e=="function"){var t=function(){return e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(r).forEach(function(n){var i=Object.getOwnPropertyDescriptor(r,n);Object.defineProperty(t,n,i.get?i:{enumerable:!0,get:function(){return r[n]}})}),t}var cn={exports:{}},Fe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var go=Symbol.for("react.element"),vT=Symbol.for("react.portal"),yT=Symbol.for("react.fragment"),ET=Symbol.for("react.strict_mode"),xT=Symbol.for("react.profiler"),TT=Symbol.for("react.provider"),ST=Symbol.for("react.context"),wT=Symbol.for("react.forward_ref"),_T=Symbol.for("react.suspense"),AT=Symbol.for("react.memo"),bT=Symbol.for("react.lazy"),mp=Symbol.iterator;function DT(r){return r===null||typeof r!="object"?null:(r=mp&&r[mp]||r["@@iterator"],typeof r=="function"?r:null)}var bm={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Dm=Object.assign,Cm={};function ta(r,e,t){this.props=r,this.context=e,this.refs=Cm,this.updater=t||bm}ta.prototype.isReactComponent={};ta.prototype.setState=function(r,e){if(typeof r!="object"&&typeof r!="function"&&r!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,r,e,"setState")};ta.prototype.forceUpdate=function(r){this.updater.enqueueForceUpdate(this,r,"forceUpdate")};function Rm(){}Rm.prototype=ta.prototype;function Nh(r,e,t){this.props=r,this.context=e,this.refs=Cm,this.updater=t||bm}var Ph=Nh.prototype=new Rm;Ph.constructor=Nh;Dm(Ph,ta.prototype);Ph.isPureReactComponent=!0;var vp=Array.isArray,Lm=Object.prototype.hasOwnProperty,Fh={current:null},Im={key:!0,ref:!0,__self:!0,__source:!0};function km(r,e,t){var n,i={},s=null,a=null;if(e!=null)for(n in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)Lm.call(e,n)&&!Im.hasOwnProperty(n)&&(i[n]=e[n]);var o=arguments.length-2;if(o===1)i.children=t;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];i.children=l}if(r&&r.defaultProps)for(n in o=r.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:go,type:r,key:s,ref:a,props:i,_owner:Fh.current}}function CT(r,e){return{$$typeof:go,type:r.type,key:e,ref:r.ref,props:r.props,_owner:r._owner}}function Mh(r){return typeof r=="object"&&r!==null&&r.$$typeof===go}function RT(r){var e={"=":"=0",":":"=2"};return"$"+r.replace(/[=:]/g,function(t){return e[t]})}var yp=/\/+/g;function uc(r,e){return typeof r=="object"&&r!==null&&r.key!=null?RT(""+r.key):e.toString(36)}function vl(r,e,t,n,i){var s=typeof r;(s==="undefined"||s==="boolean")&&(r=null);var a=!1;if(r===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(r.$$typeof){case go:case vT:a=!0}}if(a)return a=r,i=i(a),r=n===""?"."+uc(a,0):n,vp(i)?(t="",r!=null&&(t=r.replace(yp,"$&/")+"/"),vl(i,e,t,"",function(u){return u})):i!=null&&(Mh(i)&&(i=CT(i,t+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(yp,"$&/")+"/")+r)),e.push(i)),1;if(a=0,n=n===""?".":n+":",vp(r))for(var o=0;o<r.length;o++){s=r[o];var l=n+uc(s,o);a+=vl(s,e,t,l,i)}else if(l=DT(r),typeof l=="function")for(r=l.call(r),o=0;!(s=r.next()).done;)s=s.value,l=n+uc(s,o++),a+=vl(s,e,t,l,i);else if(s==="object")throw e=String(r),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Mo(r,e,t){if(r==null)return r;var n=[],i=0;return vl(r,n,"","",function(s){return e.call(t,s,i++)}),n}function LT(r){if(r._status===-1){var e=r._result;e=e(),e.then(function(t){(r._status===0||r._status===-1)&&(r._status=1,r._result=t)},function(t){(r._status===0||r._status===-1)&&(r._status=2,r._result=t)}),r._status===-1&&(r._status=0,r._result=e)}if(r._status===1)return r._result.default;throw r._result}var Jt={current:null},yl={transition:null},IT={ReactCurrentDispatcher:Jt,ReactCurrentBatchConfig:yl,ReactCurrentOwner:Fh};Fe.Children={map:Mo,forEach:function(r,e,t){Mo(r,function(){e.apply(this,arguments)},t)},count:function(r){var e=0;return Mo(r,function(){e++}),e},toArray:function(r){return Mo(r,function(e){return e})||[]},only:function(r){if(!Mh(r))throw Error("React.Children.only expected to receive a single React element child.");return r}};Fe.Component=ta;Fe.Fragment=yT;Fe.Profiler=xT;Fe.PureComponent=Nh;Fe.StrictMode=ET;Fe.Suspense=_T;Fe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=IT;Fe.cloneElement=function(r,e,t){if(r==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+r+".");var n=Dm({},r.props),i=r.key,s=r.ref,a=r._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=Fh.current),e.key!==void 0&&(i=""+e.key),r.type&&r.type.defaultProps)var o=r.type.defaultProps;for(l in e)Lm.call(e,l)&&!Im.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=t;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];n.children=o}return{$$typeof:go,type:r.type,key:i,ref:s,props:n,_owner:a}};Fe.createContext=function(r){return r={$$typeof:ST,_currentValue:r,_currentValue2:r,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},r.Provider={$$typeof:TT,_context:r},r.Consumer=r};Fe.createElement=km;Fe.createFactory=function(r){var e=km.bind(null,r);return e.type=r,e};Fe.createRef=function(){return{current:null}};Fe.forwardRef=function(r){return{$$typeof:wT,render:r}};Fe.isValidElement=Mh;Fe.lazy=function(r){return{$$typeof:bT,_payload:{_status:-1,_result:r},_init:LT}};Fe.memo=function(r,e){return{$$typeof:AT,type:r,compare:e===void 0?null:e}};Fe.startTransition=function(r){var e=yl.transition;yl.transition={};try{r()}finally{yl.transition=e}};Fe.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Fe.useCallback=function(r,e){return Jt.current.useCallback(r,e)};Fe.useContext=function(r){return Jt.current.useContext(r)};Fe.useDebugValue=function(){};Fe.useDeferredValue=function(r){return Jt.current.useDeferredValue(r)};Fe.useEffect=function(r,e){return Jt.current.useEffect(r,e)};Fe.useId=function(){return Jt.current.useId()};Fe.useImperativeHandle=function(r,e,t){return Jt.current.useImperativeHandle(r,e,t)};Fe.useInsertionEffect=function(r,e){return Jt.current.useInsertionEffect(r,e)};Fe.useLayoutEffect=function(r,e){return Jt.current.useLayoutEffect(r,e)};Fe.useMemo=function(r,e){return Jt.current.useMemo(r,e)};Fe.useReducer=function(r,e,t){return Jt.current.useReducer(r,e,t)};Fe.useRef=function(r){return Jt.current.useRef(r)};Fe.useState=function(r){return Jt.current.useState(r)};Fe.useSyncExternalStore=function(r,e,t){return Jt.current.useSyncExternalStore(r,e,t)};Fe.useTransition=function(){return Jt.current.useTransition()};Fe.version="18.2.0";(function(r){r.exports=Fe})(cn);const $r=gT(cn.exports);var Sf={},Om={exports:{}},Cr={},Nm={exports:{}},Pm={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(r){function e(N,U){var Z=N.length;N.push(U);e:for(;0<Z;){var oe=Z-1>>>1,re=N[oe];if(0<i(re,U))N[oe]=U,N[Z]=re,Z=oe;else break e}}function t(N){return N.length===0?null:N[0]}function n(N){if(N.length===0)return null;var U=N[0],Z=N.pop();if(Z!==U){N[0]=Z;e:for(var oe=0,re=N.length,pe=re>>>1;oe<pe;){var Te=2*(oe+1)-1,Ie=N[Te],Le=Te+1,Oe=N[Le];if(0>i(Ie,Z))Le<re&&0>i(Oe,Ie)?(N[oe]=Oe,N[Le]=Z,oe=Le):(N[oe]=Ie,N[Te]=Z,oe=Te);else if(Le<re&&0>i(Oe,Z))N[oe]=Oe,N[Le]=Z,oe=Le;else break e}}return U}function i(N,U){var Z=N.sortIndex-U.sortIndex;return Z!==0?Z:N.id-U.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;r.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();r.unstable_now=function(){return a.now()-o}}var l=[],u=[],c=1,f=null,h=3,d=!1,m=!1,x=!1,p=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(N){for(var U=t(u);U!==null;){if(U.callback===null)n(u);else if(U.startTime<=N)n(u),U.sortIndex=U.expirationTime,e(l,U);else break;U=t(u)}}function S(N){if(x=!1,E(N),!m)if(t(l)!==null)m=!0,j(T);else{var U=t(u);U!==null&&X(S,U.startTime-N)}}function T(N,U){m=!1,x&&(x=!1,g(C),C=-1),d=!0;var Z=h;try{for(E(U),f=t(l);f!==null&&(!(f.expirationTime>U)||N&&!V());){var oe=f.callback;if(typeof oe=="function"){f.callback=null,h=f.priorityLevel;var re=oe(f.expirationTime<=U);U=r.unstable_now(),typeof re=="function"?f.callback=re:f===t(l)&&n(l),E(U)}else n(l);f=t(l)}if(f!==null)var pe=!0;else{var Te=t(u);Te!==null&&X(S,Te.startTime-U),pe=!1}return pe}finally{f=null,h=Z,d=!1}}var w=!1,_=null,C=-1,O=5,L=-1;function V(){return!(r.unstable_now()-L<O)}function $(){if(_!==null){var N=r.unstable_now();L=N;var U=!0;try{U=_(!0,N)}finally{U?ne():(w=!1,_=null)}}else w=!1}var ne;if(typeof v=="function")ne=function(){v($)};else if(typeof MessageChannel<"u"){var me=new MessageChannel,H=me.port2;me.port1.onmessage=$,ne=function(){H.postMessage(null)}}else ne=function(){p($,0)};function j(N){_=N,w||(w=!0,ne())}function X(N,U){C=p(function(){N(r.unstable_now())},U)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(N){N.callback=null},r.unstable_continueExecution=function(){m||d||(m=!0,j(T))},r.unstable_forceFrameRate=function(N){0>N||125<N?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<N?Math.floor(1e3/N):5},r.unstable_getCurrentPriorityLevel=function(){return h},r.unstable_getFirstCallbackNode=function(){return t(l)},r.unstable_next=function(N){switch(h){case 1:case 2:case 3:var U=3;break;default:U=h}var Z=h;h=U;try{return N()}finally{h=Z}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(N,U){switch(N){case 1:case 2:case 3:case 4:case 5:break;default:N=3}var Z=h;h=N;try{return U()}finally{h=Z}},r.unstable_scheduleCallback=function(N,U,Z){var oe=r.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?oe+Z:oe):Z=oe,N){case 1:var re=-1;break;case 2:re=250;break;case 5:re=1073741823;break;case 4:re=1e4;break;default:re=5e3}return re=Z+re,N={id:c++,callback:U,priorityLevel:N,startTime:Z,expirationTime:re,sortIndex:-1},Z>oe?(N.sortIndex=Z,e(u,N),t(l)===null&&N===t(u)&&(x?(g(C),C=-1):x=!0,X(S,Z-oe))):(N.sortIndex=re,e(l,N),m||d||(m=!0,j(T))),N},r.unstable_shouldYield=V,r.unstable_wrapCallback=function(N){var U=h;return function(){var Z=h;h=U;try{return N.apply(this,arguments)}finally{h=Z}}}})(Pm);(function(r){r.exports=Pm})(Nm);/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fm=cn.exports,Dr=Nm.exports;function ce(r){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+r,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+r+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Mm=new Set,Wa={};function Ji(r,e){Hs(r,e),Hs(r+"Capture",e)}function Hs(r,e){for(Wa[r]=e,r=0;r<e.length;r++)Mm.add(e[r])}var Hn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),wf=Object.prototype.hasOwnProperty,kT=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ep={},xp={};function OT(r){return wf.call(xp,r)?!0:wf.call(Ep,r)?!1:kT.test(r)?xp[r]=!0:(Ep[r]=!0,!1)}function NT(r,e,t,n){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:t!==null?!t.acceptsBooleans:(r=r.toLowerCase().slice(0,5),r!=="data-"&&r!=="aria-");default:return!1}}function PT(r,e,t,n){if(e===null||typeof e>"u"||NT(r,e,t,n))return!0;if(n)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function er(r,e,t,n,i,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=t,this.propertyName=r,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var Bt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(r){Bt[r]=new er(r,0,!1,r,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(r){var e=r[0];Bt[e]=new er(e,1,!1,r[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(r){Bt[r]=new er(r,2,!1,r.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(r){Bt[r]=new er(r,2,!1,r,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(r){Bt[r]=new er(r,3,!1,r.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(r){Bt[r]=new er(r,3,!0,r,null,!1,!1)});["capture","download"].forEach(function(r){Bt[r]=new er(r,4,!1,r,null,!1,!1)});["cols","rows","size","span"].forEach(function(r){Bt[r]=new er(r,6,!1,r,null,!1,!1)});["rowSpan","start"].forEach(function(r){Bt[r]=new er(r,5,!1,r.toLowerCase(),null,!1,!1)});var Bh=/[\-:]([a-z])/g;function Uh(r){return r[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(r){var e=r.replace(Bh,Uh);Bt[e]=new er(e,1,!1,r,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(r){var e=r.replace(Bh,Uh);Bt[e]=new er(e,1,!1,r,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(r){var e=r.replace(Bh,Uh);Bt[e]=new er(e,1,!1,r,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(r){Bt[r]=new er(r,1,!1,r.toLowerCase(),null,!1,!1)});Bt.xlinkHref=new er("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(r){Bt[r]=new er(r,1,!1,r.toLowerCase(),null,!0,!0)});function $h(r,e,t,n){var i=Bt.hasOwnProperty(e)?Bt[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(PT(e,t,i,n)&&(t=null),n||i===null?OT(e)&&(t===null?r.removeAttribute(e):r.setAttribute(e,""+t)):i.mustUseProperty?r[i.propertyName]=t===null?i.type===3?!1:"":t:(e=i.attributeName,n=i.attributeNamespace,t===null?r.removeAttribute(e):(i=i.type,t=i===3||i===4&&t===!0?"":""+t,n?r.setAttributeNS(n,e,t):r.setAttribute(e,t))))}var Zn=Fm.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Bo=Symbol.for("react.element"),ws=Symbol.for("react.portal"),_s=Symbol.for("react.fragment"),zh=Symbol.for("react.strict_mode"),_f=Symbol.for("react.profiler"),Bm=Symbol.for("react.provider"),Um=Symbol.for("react.context"),Vh=Symbol.for("react.forward_ref"),Af=Symbol.for("react.suspense"),bf=Symbol.for("react.suspense_list"),Gh=Symbol.for("react.memo"),ai=Symbol.for("react.lazy"),$m=Symbol.for("react.offscreen"),Tp=Symbol.iterator;function fa(r){return r===null||typeof r!="object"?null:(r=Tp&&r[Tp]||r["@@iterator"],typeof r=="function"?r:null)}var ut=Object.assign,cc;function Ca(r){if(cc===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);cc=e&&e[1]||""}return`
`+cc+r}var fc=!1;function hc(r,e){if(!r||fc)return"";fc=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var n=u}Reflect.construct(r,[],e)}else{try{e.call()}catch(u){n=u}r.call(e.prototype)}else{try{throw Error()}catch(u){n=u}r()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=n.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var l=`
`+i[a].replace(" at new "," at ");return r.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",r.displayName)),l}while(1<=a&&0<=o);break}}}finally{fc=!1,Error.prepareStackTrace=t}return(r=r?r.displayName||r.name:"")?Ca(r):""}function FT(r){switch(r.tag){case 5:return Ca(r.type);case 16:return Ca("Lazy");case 13:return Ca("Suspense");case 19:return Ca("SuspenseList");case 0:case 2:case 15:return r=hc(r.type,!1),r;case 11:return r=hc(r.type.render,!1),r;case 1:return r=hc(r.type,!0),r;default:return""}}function Df(r){if(r==null)return null;if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case _s:return"Fragment";case ws:return"Portal";case _f:return"Profiler";case zh:return"StrictMode";case Af:return"Suspense";case bf:return"SuspenseList"}if(typeof r=="object")switch(r.$$typeof){case Um:return(r.displayName||"Context")+".Consumer";case Bm:return(r._context.displayName||"Context")+".Provider";case Vh:var e=r.render;return r=r.displayName,r||(r=e.displayName||e.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case Gh:return e=r.displayName||null,e!==null?e:Df(r.type)||"Memo";case ai:e=r._payload,r=r._init;try{return Df(r(e))}catch{}}return null}function MT(r){var e=r.type;switch(r.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return r=e.render,r=r.displayName||r.name||"",e.displayName||(r!==""?"ForwardRef("+r+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Df(e);case 8:return e===zh?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function wi(r){switch(typeof r){case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function zm(r){var e=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function BT(r){var e=zm(r)?"checked":"value",t=Object.getOwnPropertyDescriptor(r.constructor.prototype,e),n=""+r[e];if(!r.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var i=t.get,s=t.set;return Object.defineProperty(r,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){n=""+a,s.call(this,a)}}),Object.defineProperty(r,e,{enumerable:t.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){r._valueTracker=null,delete r[e]}}}}function Uo(r){r._valueTracker||(r._valueTracker=BT(r))}function Vm(r){if(!r)return!1;var e=r._valueTracker;if(!e)return!0;var t=e.getValue(),n="";return r&&(n=zm(r)?r.checked?"true":"false":r.value),r=n,r!==t?(e.setValue(r),!0):!1}function kl(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}function Cf(r,e){var t=e.checked;return ut({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t!=null?t:r._wrapperState.initialChecked})}function Sp(r,e){var t=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;t=wi(e.value!=null?e.value:t),r._wrapperState={initialChecked:n,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Gm(r,e){e=e.checked,e!=null&&$h(r,"checked",e,!1)}function Rf(r,e){Gm(r,e);var t=wi(e.value),n=e.type;if(t!=null)n==="number"?(t===0&&r.value===""||r.value!=t)&&(r.value=""+t):r.value!==""+t&&(r.value=""+t);else if(n==="submit"||n==="reset"){r.removeAttribute("value");return}e.hasOwnProperty("value")?Lf(r,e.type,t):e.hasOwnProperty("defaultValue")&&Lf(r,e.type,wi(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(r.defaultChecked=!!e.defaultChecked)}function wp(r,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+r._wrapperState.initialValue,t||e===r.value||(r.value=e),r.defaultValue=e}t=r.name,t!==""&&(r.name=""),r.defaultChecked=!!r._wrapperState.initialChecked,t!==""&&(r.name=t)}function Lf(r,e,t){(e!=="number"||kl(r.ownerDocument)!==r)&&(t==null?r.defaultValue=""+r._wrapperState.initialValue:r.defaultValue!==""+t&&(r.defaultValue=""+t))}var Ra=Array.isArray;function Bs(r,e,t,n){if(r=r.options,e){e={};for(var i=0;i<t.length;i++)e["$"+t[i]]=!0;for(t=0;t<r.length;t++)i=e.hasOwnProperty("$"+r[t].value),r[t].selected!==i&&(r[t].selected=i),i&&n&&(r[t].defaultSelected=!0)}else{for(t=""+wi(t),e=null,i=0;i<r.length;i++){if(r[i].value===t){r[i].selected=!0,n&&(r[i].defaultSelected=!0);return}e!==null||r[i].disabled||(e=r[i])}e!==null&&(e.selected=!0)}}function If(r,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ce(91));return ut({},e,{value:void 0,defaultValue:void 0,children:""+r._wrapperState.initialValue})}function _p(r,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(ce(92));if(Ra(t)){if(1<t.length)throw Error(ce(93));t=t[0]}e=t}e==null&&(e=""),t=e}r._wrapperState={initialValue:wi(t)}}function Wm(r,e){var t=wi(e.value),n=wi(e.defaultValue);t!=null&&(t=""+t,t!==r.value&&(r.value=t),e.defaultValue==null&&r.defaultValue!==t&&(r.defaultValue=t)),n!=null&&(r.defaultValue=""+n)}function Ap(r){var e=r.textContent;e===r._wrapperState.initialValue&&e!==""&&e!==null&&(r.value=e)}function Hm(r){switch(r){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function kf(r,e){return r==null||r==="http://www.w3.org/1999/xhtml"?Hm(e):r==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":r}var $o,jm=function(r){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,n,i){MSApp.execUnsafeLocalFunction(function(){return r(e,t,n,i)})}:r}(function(r,e){if(r.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in r)r.innerHTML=e;else{for($o=$o||document.createElement("div"),$o.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=$o.firstChild;r.firstChild;)r.removeChild(r.firstChild);for(;e.firstChild;)r.appendChild(e.firstChild)}});function Ha(r,e){if(e){var t=r.firstChild;if(t&&t===r.lastChild&&t.nodeType===3){t.nodeValue=e;return}}r.textContent=e}var ka={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},UT=["Webkit","ms","Moz","O"];Object.keys(ka).forEach(function(r){UT.forEach(function(e){e=e+r.charAt(0).toUpperCase()+r.substring(1),ka[e]=ka[r]})});function Km(r,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||ka.hasOwnProperty(r)&&ka[r]?(""+e).trim():e+"px"}function qm(r,e){r=r.style;for(var t in e)if(e.hasOwnProperty(t)){var n=t.indexOf("--")===0,i=Km(t,e[t],n);t==="float"&&(t="cssFloat"),n?r.setProperty(t,i):r[t]=i}}var $T=ut({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Of(r,e){if(e){if($T[r]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ce(137,r));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ce(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ce(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ce(62))}}function Nf(r,e){if(r.indexOf("-")===-1)return typeof e.is=="string";switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Pf=null;function Wh(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Ff=null,Us=null,$s=null;function bp(r){if(r=yo(r)){if(typeof Ff!="function")throw Error(ce(280));var e=r.stateNode;e&&(e=yu(e),Ff(r.stateNode,r.type,e))}}function Ym(r){Us?$s?$s.push(r):$s=[r]:Us=r}function Xm(){if(Us){var r=Us,e=$s;if($s=Us=null,bp(r),e)for(r=0;r<e.length;r++)bp(e[r])}}function Zm(r,e){return r(e)}function Qm(){}var dc=!1;function Jm(r,e,t){if(dc)return r(e,t);dc=!0;try{return Zm(r,e,t)}finally{dc=!1,(Us!==null||$s!==null)&&(Qm(),Xm())}}function ja(r,e){var t=r.stateNode;if(t===null)return null;var n=yu(t);if(n===null)return null;t=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(r=r.type,n=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!n;break e;default:r=!1}if(r)return null;if(t&&typeof t!="function")throw Error(ce(231,e,typeof t));return t}var Mf=!1;if(Hn)try{var ha={};Object.defineProperty(ha,"passive",{get:function(){Mf=!0}}),window.addEventListener("test",ha,ha),window.removeEventListener("test",ha,ha)}catch{Mf=!1}function zT(r,e,t,n,i,s,a,o,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(t,u)}catch(c){this.onError(c)}}var Oa=!1,Ol=null,Nl=!1,Bf=null,VT={onError:function(r){Oa=!0,Ol=r}};function GT(r,e,t,n,i,s,a,o,l){Oa=!1,Ol=null,zT.apply(VT,arguments)}function WT(r,e,t,n,i,s,a,o,l){if(GT.apply(this,arguments),Oa){if(Oa){var u=Ol;Oa=!1,Ol=null}else throw Error(ce(198));Nl||(Nl=!0,Bf=u)}}function es(r){var e=r,t=r;if(r.alternate)for(;e.return;)e=e.return;else{r=e;do e=r,(e.flags&4098)!==0&&(t=e.return),r=e.return;while(r)}return e.tag===3?t:null}function ev(r){if(r.tag===13){var e=r.memoizedState;if(e===null&&(r=r.alternate,r!==null&&(e=r.memoizedState)),e!==null)return e.dehydrated}return null}function Dp(r){if(es(r)!==r)throw Error(ce(188))}function HT(r){var e=r.alternate;if(!e){if(e=es(r),e===null)throw Error(ce(188));return e!==r?null:r}for(var t=r,n=e;;){var i=t.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){t=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===t)return Dp(i),r;if(s===n)return Dp(i),e;s=s.sibling}throw Error(ce(188))}if(t.return!==n.return)t=i,n=s;else{for(var a=!1,o=i.child;o;){if(o===t){a=!0,t=i,n=s;break}if(o===n){a=!0,n=i,t=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===t){a=!0,t=s,n=i;break}if(o===n){a=!0,n=s,t=i;break}o=o.sibling}if(!a)throw Error(ce(189))}}if(t.alternate!==n)throw Error(ce(190))}if(t.tag!==3)throw Error(ce(188));return t.stateNode.current===t?r:e}function tv(r){return r=HT(r),r!==null?rv(r):null}function rv(r){if(r.tag===5||r.tag===6)return r;for(r=r.child;r!==null;){var e=rv(r);if(e!==null)return e;r=r.sibling}return null}var nv=Dr.unstable_scheduleCallback,Cp=Dr.unstable_cancelCallback,jT=Dr.unstable_shouldYield,KT=Dr.unstable_requestPaint,mt=Dr.unstable_now,qT=Dr.unstable_getCurrentPriorityLevel,Hh=Dr.unstable_ImmediatePriority,iv=Dr.unstable_UserBlockingPriority,Pl=Dr.unstable_NormalPriority,YT=Dr.unstable_LowPriority,sv=Dr.unstable_IdlePriority,pu=null,wn=null;function XT(r){if(wn&&typeof wn.onCommitFiberRoot=="function")try{wn.onCommitFiberRoot(pu,r,void 0,(r.current.flags&128)===128)}catch{}}var fn=Math.clz32?Math.clz32:JT,ZT=Math.log,QT=Math.LN2;function JT(r){return r>>>=0,r===0?32:31-(ZT(r)/QT|0)|0}var zo=64,Vo=4194304;function La(r){switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return r&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return r}}function Fl(r,e){var t=r.pendingLanes;if(t===0)return 0;var n=0,i=r.suspendedLanes,s=r.pingedLanes,a=t&268435455;if(a!==0){var o=a&~i;o!==0?n=La(o):(s&=a,s!==0&&(n=La(s)))}else a=t&~i,a!==0?n=La(a):s!==0&&(n=La(s));if(n===0)return 0;if(e!==0&&e!==n&&(e&i)===0&&(i=n&-n,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if((n&4)!==0&&(n|=t&16),e=r.entangledLanes,e!==0)for(r=r.entanglements,e&=n;0<e;)t=31-fn(e),i=1<<t,n|=r[t],e&=~i;return n}function eS(r,e){switch(r){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function tS(r,e){for(var t=r.suspendedLanes,n=r.pingedLanes,i=r.expirationTimes,s=r.pendingLanes;0<s;){var a=31-fn(s),o=1<<a,l=i[a];l===-1?((o&t)===0||(o&n)!==0)&&(i[a]=eS(o,e)):l<=e&&(r.expiredLanes|=o),s&=~o}}function Uf(r){return r=r.pendingLanes&-1073741825,r!==0?r:r&1073741824?1073741824:0}function av(){var r=zo;return zo<<=1,(zo&4194240)===0&&(zo=64),r}function pc(r){for(var e=[],t=0;31>t;t++)e.push(r);return e}function mo(r,e,t){r.pendingLanes|=e,e!==536870912&&(r.suspendedLanes=0,r.pingedLanes=0),r=r.eventTimes,e=31-fn(e),r[e]=t}function rS(r,e){var t=r.pendingLanes&~e;r.pendingLanes=e,r.suspendedLanes=0,r.pingedLanes=0,r.expiredLanes&=e,r.mutableReadLanes&=e,r.entangledLanes&=e,e=r.entanglements;var n=r.eventTimes;for(r=r.expirationTimes;0<t;){var i=31-fn(t),s=1<<i;e[i]=0,n[i]=-1,r[i]=-1,t&=~s}}function jh(r,e){var t=r.entangledLanes|=e;for(r=r.entanglements;t;){var n=31-fn(t),i=1<<n;i&e|r[n]&e&&(r[n]|=e),t&=~i}}var je=0;function ov(r){return r&=-r,1<r?4<r?(r&268435455)!==0?16:536870912:4:1}var lv,Kh,uv,cv,fv,$f=!1,Go=[],gi=null,mi=null,vi=null,Ka=new Map,qa=new Map,ci=[],nS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Rp(r,e){switch(r){case"focusin":case"focusout":gi=null;break;case"dragenter":case"dragleave":mi=null;break;case"mouseover":case"mouseout":vi=null;break;case"pointerover":case"pointerout":Ka.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":qa.delete(e.pointerId)}}function da(r,e,t,n,i,s){return r===null||r.nativeEvent!==s?(r={blockedOn:e,domEventName:t,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},e!==null&&(e=yo(e),e!==null&&Kh(e)),r):(r.eventSystemFlags|=n,e=r.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),r)}function iS(r,e,t,n,i){switch(e){case"focusin":return gi=da(gi,r,e,t,n,i),!0;case"dragenter":return mi=da(mi,r,e,t,n,i),!0;case"mouseover":return vi=da(vi,r,e,t,n,i),!0;case"pointerover":var s=i.pointerId;return Ka.set(s,da(Ka.get(s)||null,r,e,t,n,i)),!0;case"gotpointercapture":return s=i.pointerId,qa.set(s,da(qa.get(s)||null,r,e,t,n,i)),!0}return!1}function hv(r){var e=Bi(r.target);if(e!==null){var t=es(e);if(t!==null){if(e=t.tag,e===13){if(e=ev(t),e!==null){r.blockedOn=e,fv(r.priority,function(){uv(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){r.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}r.blockedOn=null}function El(r){if(r.blockedOn!==null)return!1;for(var e=r.targetContainers;0<e.length;){var t=zf(r.domEventName,r.eventSystemFlags,e[0],r.nativeEvent);if(t===null){t=r.nativeEvent;var n=new t.constructor(t.type,t);Pf=n,t.target.dispatchEvent(n),Pf=null}else return e=yo(t),e!==null&&Kh(e),r.blockedOn=t,!1;e.shift()}return!0}function Lp(r,e,t){El(r)&&t.delete(e)}function sS(){$f=!1,gi!==null&&El(gi)&&(gi=null),mi!==null&&El(mi)&&(mi=null),vi!==null&&El(vi)&&(vi=null),Ka.forEach(Lp),qa.forEach(Lp)}function pa(r,e){r.blockedOn===e&&(r.blockedOn=null,$f||($f=!0,Dr.unstable_scheduleCallback(Dr.unstable_NormalPriority,sS)))}function Ya(r){function e(i){return pa(i,r)}if(0<Go.length){pa(Go[0],r);for(var t=1;t<Go.length;t++){var n=Go[t];n.blockedOn===r&&(n.blockedOn=null)}}for(gi!==null&&pa(gi,r),mi!==null&&pa(mi,r),vi!==null&&pa(vi,r),Ka.forEach(e),qa.forEach(e),t=0;t<ci.length;t++)n=ci[t],n.blockedOn===r&&(n.blockedOn=null);for(;0<ci.length&&(t=ci[0],t.blockedOn===null);)hv(t),t.blockedOn===null&&ci.shift()}var zs=Zn.ReactCurrentBatchConfig,Ml=!0;function aS(r,e,t,n){var i=je,s=zs.transition;zs.transition=null;try{je=1,qh(r,e,t,n)}finally{je=i,zs.transition=s}}function oS(r,e,t,n){var i=je,s=zs.transition;zs.transition=null;try{je=4,qh(r,e,t,n)}finally{je=i,zs.transition=s}}function qh(r,e,t,n){if(Ml){var i=zf(r,e,t,n);if(i===null)_c(r,e,n,Bl,t),Rp(r,n);else if(iS(i,r,e,t,n))n.stopPropagation();else if(Rp(r,n),e&4&&-1<nS.indexOf(r)){for(;i!==null;){var s=yo(i);if(s!==null&&lv(s),s=zf(r,e,t,n),s===null&&_c(r,e,n,Bl,t),s===i)break;i=s}i!==null&&n.stopPropagation()}else _c(r,e,n,null,t)}}var Bl=null;function zf(r,e,t,n){if(Bl=null,r=Wh(n),r=Bi(r),r!==null)if(e=es(r),e===null)r=null;else if(t=e.tag,t===13){if(r=ev(e),r!==null)return r;r=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;r=null}else e!==r&&(r=null);return Bl=r,null}function dv(r){switch(r){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(qT()){case Hh:return 1;case iv:return 4;case Pl:case YT:return 16;case sv:return 536870912;default:return 16}default:return 16}}var hi=null,Yh=null,xl=null;function pv(){if(xl)return xl;var r,e=Yh,t=e.length,n,i="value"in hi?hi.value:hi.textContent,s=i.length;for(r=0;r<t&&e[r]===i[r];r++);var a=t-r;for(n=1;n<=a&&e[t-n]===i[s-n];n++);return xl=i.slice(r,1<n?1-n:void 0)}function Tl(r){var e=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&e===13&&(r=13)):r=e,r===10&&(r=13),32<=r||r===13?r:0}function Wo(){return!0}function Ip(){return!1}function Rr(r){function e(t,n,i,s,a){this._reactName=t,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in r)r.hasOwnProperty(o)&&(t=r[o],this[o]=t?t(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Wo:Ip,this.isPropagationStopped=Ip,this}return ut(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Wo)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Wo)},persist:function(){},isPersistent:Wo}),e}var ra={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Xh=Rr(ra),vo=ut({},ra,{view:0,detail:0}),lS=Rr(vo),gc,mc,ga,gu=ut({},vo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Zh,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==ga&&(ga&&r.type==="mousemove"?(gc=r.screenX-ga.screenX,mc=r.screenY-ga.screenY):mc=gc=0,ga=r),gc)},movementY:function(r){return"movementY"in r?r.movementY:mc}}),kp=Rr(gu),uS=ut({},gu,{dataTransfer:0}),cS=Rr(uS),fS=ut({},vo,{relatedTarget:0}),vc=Rr(fS),hS=ut({},ra,{animationName:0,elapsedTime:0,pseudoElement:0}),dS=Rr(hS),pS=ut({},ra,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),gS=Rr(pS),mS=ut({},ra,{data:0}),Op=Rr(mS),vS={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},yS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ES={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function xS(r){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(r):(r=ES[r])?!!e[r]:!1}function Zh(){return xS}var TS=ut({},vo,{key:function(r){if(r.key){var e=vS[r.key]||r.key;if(e!=="Unidentified")return e}return r.type==="keypress"?(r=Tl(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?yS[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Zh,charCode:function(r){return r.type==="keypress"?Tl(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?Tl(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),SS=Rr(TS),wS=ut({},gu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Np=Rr(wS),_S=ut({},vo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Zh}),AS=Rr(_S),bS=ut({},ra,{propertyName:0,elapsedTime:0,pseudoElement:0}),DS=Rr(bS),CS=ut({},gu,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),RS=Rr(CS),LS=[9,13,27,32],Qh=Hn&&"CompositionEvent"in window,Na=null;Hn&&"documentMode"in document&&(Na=document.documentMode);var IS=Hn&&"TextEvent"in window&&!Na,gv=Hn&&(!Qh||Na&&8<Na&&11>=Na),Pp=String.fromCharCode(32),Fp=!1;function mv(r,e){switch(r){case"keyup":return LS.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function vv(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var As=!1;function kS(r,e){switch(r){case"compositionend":return vv(e);case"keypress":return e.which!==32?null:(Fp=!0,Pp);case"textInput":return r=e.data,r===Pp&&Fp?null:r;default:return null}}function OS(r,e){if(As)return r==="compositionend"||!Qh&&mv(r,e)?(r=pv(),xl=Yh=hi=null,As=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return gv&&e.locale!=="ko"?null:e.data;default:return null}}var NS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Mp(r){var e=r&&r.nodeName&&r.nodeName.toLowerCase();return e==="input"?!!NS[r.type]:e==="textarea"}function yv(r,e,t,n){Ym(n),e=Ul(e,"onChange"),0<e.length&&(t=new Xh("onChange","change",null,t,n),r.push({event:t,listeners:e}))}var Pa=null,Xa=null;function PS(r){Rv(r,0)}function mu(r){var e=Cs(r);if(Vm(e))return r}function FS(r,e){if(r==="change")return e}var Ev=!1;if(Hn){var yc;if(Hn){var Ec="oninput"in document;if(!Ec){var Bp=document.createElement("div");Bp.setAttribute("oninput","return;"),Ec=typeof Bp.oninput=="function"}yc=Ec}else yc=!1;Ev=yc&&(!document.documentMode||9<document.documentMode)}function Up(){Pa&&(Pa.detachEvent("onpropertychange",xv),Xa=Pa=null)}function xv(r){if(r.propertyName==="value"&&mu(Xa)){var e=[];yv(e,Xa,r,Wh(r)),Jm(PS,e)}}function MS(r,e,t){r==="focusin"?(Up(),Pa=e,Xa=t,Pa.attachEvent("onpropertychange",xv)):r==="focusout"&&Up()}function BS(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return mu(Xa)}function US(r,e){if(r==="click")return mu(e)}function $S(r,e){if(r==="input"||r==="change")return mu(e)}function zS(r,e){return r===e&&(r!==0||1/r===1/e)||r!==r&&e!==e}var pn=typeof Object.is=="function"?Object.is:zS;function Za(r,e){if(pn(r,e))return!0;if(typeof r!="object"||r===null||typeof e!="object"||e===null)return!1;var t=Object.keys(r),n=Object.keys(e);if(t.length!==n.length)return!1;for(n=0;n<t.length;n++){var i=t[n];if(!wf.call(e,i)||!pn(r[i],e[i]))return!1}return!0}function $p(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function zp(r,e){var t=$p(r);r=0;for(var n;t;){if(t.nodeType===3){if(n=r+t.textContent.length,r<=e&&n>=e)return{node:t,offset:e-r};r=n}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=$p(t)}}function Tv(r,e){return r&&e?r===e?!0:r&&r.nodeType===3?!1:e&&e.nodeType===3?Tv(r,e.parentNode):"contains"in r?r.contains(e):r.compareDocumentPosition?!!(r.compareDocumentPosition(e)&16):!1:!1}function Sv(){for(var r=window,e=kl();e instanceof r.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)r=e.contentWindow;else break;e=kl(r.document)}return e}function Jh(r){var e=r&&r.nodeName&&r.nodeName.toLowerCase();return e&&(e==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||e==="textarea"||r.contentEditable==="true")}function VS(r){var e=Sv(),t=r.focusedElem,n=r.selectionRange;if(e!==t&&t&&t.ownerDocument&&Tv(t.ownerDocument.documentElement,t)){if(n!==null&&Jh(t)){if(e=n.start,r=n.end,r===void 0&&(r=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(r,t.value.length);else if(r=(e=t.ownerDocument||document)&&e.defaultView||window,r.getSelection){r=r.getSelection();var i=t.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!r.extend&&s>n&&(i=n,n=s,s=i),i=zp(t,s);var a=zp(t,n);i&&a&&(r.rangeCount!==1||r.anchorNode!==i.node||r.anchorOffset!==i.offset||r.focusNode!==a.node||r.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),r.removeAllRanges(),s>n?(r.addRange(e),r.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),r.addRange(e)))}}for(e=[],r=t;r=r.parentNode;)r.nodeType===1&&e.push({element:r,left:r.scrollLeft,top:r.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)r=e[t],r.element.scrollLeft=r.left,r.element.scrollTop=r.top}}var GS=Hn&&"documentMode"in document&&11>=document.documentMode,bs=null,Vf=null,Fa=null,Gf=!1;function Vp(r,e,t){var n=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;Gf||bs==null||bs!==kl(n)||(n=bs,"selectionStart"in n&&Jh(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Fa&&Za(Fa,n)||(Fa=n,n=Ul(Vf,"onSelect"),0<n.length&&(e=new Xh("onSelect","select",null,e,t),r.push({event:e,listeners:n}),e.target=bs)))}function Ho(r,e){var t={};return t[r.toLowerCase()]=e.toLowerCase(),t["Webkit"+r]="webkit"+e,t["Moz"+r]="moz"+e,t}var Ds={animationend:Ho("Animation","AnimationEnd"),animationiteration:Ho("Animation","AnimationIteration"),animationstart:Ho("Animation","AnimationStart"),transitionend:Ho("Transition","TransitionEnd")},xc={},wv={};Hn&&(wv=document.createElement("div").style,"AnimationEvent"in window||(delete Ds.animationend.animation,delete Ds.animationiteration.animation,delete Ds.animationstart.animation),"TransitionEvent"in window||delete Ds.transitionend.transition);function vu(r){if(xc[r])return xc[r];if(!Ds[r])return r;var e=Ds[r],t;for(t in e)if(e.hasOwnProperty(t)&&t in wv)return xc[r]=e[t];return r}var _v=vu("animationend"),Av=vu("animationiteration"),bv=vu("animationstart"),Dv=vu("transitionend"),Cv=new Map,Gp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function bi(r,e){Cv.set(r,e),Ji(e,[r])}for(var Tc=0;Tc<Gp.length;Tc++){var Sc=Gp[Tc],WS=Sc.toLowerCase(),HS=Sc[0].toUpperCase()+Sc.slice(1);bi(WS,"on"+HS)}bi(_v,"onAnimationEnd");bi(Av,"onAnimationIteration");bi(bv,"onAnimationStart");bi("dblclick","onDoubleClick");bi("focusin","onFocus");bi("focusout","onBlur");bi(Dv,"onTransitionEnd");Hs("onMouseEnter",["mouseout","mouseover"]);Hs("onMouseLeave",["mouseout","mouseover"]);Hs("onPointerEnter",["pointerout","pointerover"]);Hs("onPointerLeave",["pointerout","pointerover"]);Ji("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ji("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ji("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ji("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ji("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ji("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ia="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jS=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ia));function Wp(r,e,t){var n=r.type||"unknown-event";r.currentTarget=t,WT(n,e,void 0,r),r.currentTarget=null}function Rv(r,e){e=(e&4)!==0;for(var t=0;t<r.length;t++){var n=r[t],i=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;Wp(i,o,u),s=l}else for(a=0;a<n.length;a++){if(o=n[a],l=o.instance,u=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;Wp(i,o,u),s=l}}}if(Nl)throw r=Bf,Nl=!1,Bf=null,r}function Qe(r,e){var t=e[qf];t===void 0&&(t=e[qf]=new Set);var n=r+"__bubble";t.has(n)||(Lv(e,r,2,!1),t.add(n))}function wc(r,e,t){var n=0;e&&(n|=4),Lv(t,r,n,e)}var jo="_reactListening"+Math.random().toString(36).slice(2);function Qa(r){if(!r[jo]){r[jo]=!0,Mm.forEach(function(t){t!=="selectionchange"&&(jS.has(t)||wc(t,!1,r),wc(t,!0,r))});var e=r.nodeType===9?r:r.ownerDocument;e===null||e[jo]||(e[jo]=!0,wc("selectionchange",!1,e))}}function Lv(r,e,t,n){switch(dv(e)){case 1:var i=aS;break;case 4:i=oS;break;default:i=qh}t=i.bind(null,e,t,r),i=void 0,!Mf||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?r.addEventListener(e,t,{capture:!0,passive:i}):r.addEventListener(e,t,!0):i!==void 0?r.addEventListener(e,t,{passive:i}):r.addEventListener(e,t,!1)}function _c(r,e,t,n,i){var s=n;if((e&1)===0&&(e&2)===0&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=n.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;a=a.return}for(;o!==null;){if(a=Bi(o),a===null)return;if(l=a.tag,l===5||l===6){n=s=a;continue e}o=o.parentNode}}n=n.return}Jm(function(){var u=s,c=Wh(t),f=[];e:{var h=Cv.get(r);if(h!==void 0){var d=Xh,m=r;switch(r){case"keypress":if(Tl(t)===0)break e;case"keydown":case"keyup":d=SS;break;case"focusin":m="focus",d=vc;break;case"focusout":m="blur",d=vc;break;case"beforeblur":case"afterblur":d=vc;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":d=kp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":d=cS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":d=AS;break;case _v:case Av:case bv:d=dS;break;case Dv:d=DS;break;case"scroll":d=lS;break;case"wheel":d=RS;break;case"copy":case"cut":case"paste":d=gS;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":d=Np}var x=(e&4)!==0,p=!x&&r==="scroll",g=x?h!==null?h+"Capture":null:h;x=[];for(var v=u,E;v!==null;){E=v;var S=E.stateNode;if(E.tag===5&&S!==null&&(E=S,g!==null&&(S=ja(v,g),S!=null&&x.push(Ja(v,S,E)))),p)break;v=v.return}0<x.length&&(h=new d(h,m,null,t,c),f.push({event:h,listeners:x}))}}if((e&7)===0){e:{if(h=r==="mouseover"||r==="pointerover",d=r==="mouseout"||r==="pointerout",h&&t!==Pf&&(m=t.relatedTarget||t.fromElement)&&(Bi(m)||m[jn]))break e;if((d||h)&&(h=c.window===c?c:(h=c.ownerDocument)?h.defaultView||h.parentWindow:window,d?(m=t.relatedTarget||t.toElement,d=u,m=m?Bi(m):null,m!==null&&(p=es(m),m!==p||m.tag!==5&&m.tag!==6)&&(m=null)):(d=null,m=u),d!==m)){if(x=kp,S="onMouseLeave",g="onMouseEnter",v="mouse",(r==="pointerout"||r==="pointerover")&&(x=Np,S="onPointerLeave",g="onPointerEnter",v="pointer"),p=d==null?h:Cs(d),E=m==null?h:Cs(m),h=new x(S,v+"leave",d,t,c),h.target=p,h.relatedTarget=E,S=null,Bi(c)===u&&(x=new x(g,v+"enter",m,t,c),x.target=E,x.relatedTarget=p,S=x),p=S,d&&m)t:{for(x=d,g=m,v=0,E=x;E;E=us(E))v++;for(E=0,S=g;S;S=us(S))E++;for(;0<v-E;)x=us(x),v--;for(;0<E-v;)g=us(g),E--;for(;v--;){if(x===g||g!==null&&x===g.alternate)break t;x=us(x),g=us(g)}x=null}else x=null;d!==null&&Hp(f,h,d,x,!1),m!==null&&p!==null&&Hp(f,p,m,x,!0)}}e:{if(h=u?Cs(u):window,d=h.nodeName&&h.nodeName.toLowerCase(),d==="select"||d==="input"&&h.type==="file")var T=FS;else if(Mp(h))if(Ev)T=$S;else{T=BS;var w=MS}else(d=h.nodeName)&&d.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(T=US);if(T&&(T=T(r,u))){yv(f,T,t,c);break e}w&&w(r,h,u),r==="focusout"&&(w=h._wrapperState)&&w.controlled&&h.type==="number"&&Lf(h,"number",h.value)}switch(w=u?Cs(u):window,r){case"focusin":(Mp(w)||w.contentEditable==="true")&&(bs=w,Vf=u,Fa=null);break;case"focusout":Fa=Vf=bs=null;break;case"mousedown":Gf=!0;break;case"contextmenu":case"mouseup":case"dragend":Gf=!1,Vp(f,t,c);break;case"selectionchange":if(GS)break;case"keydown":case"keyup":Vp(f,t,c)}var _;if(Qh)e:{switch(r){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else As?mv(r,t)&&(C="onCompositionEnd"):r==="keydown"&&t.keyCode===229&&(C="onCompositionStart");C&&(gv&&t.locale!=="ko"&&(As||C!=="onCompositionStart"?C==="onCompositionEnd"&&As&&(_=pv()):(hi=c,Yh="value"in hi?hi.value:hi.textContent,As=!0)),w=Ul(u,C),0<w.length&&(C=new Op(C,r,null,t,c),f.push({event:C,listeners:w}),_?C.data=_:(_=vv(t),_!==null&&(C.data=_)))),(_=IS?kS(r,t):OS(r,t))&&(u=Ul(u,"onBeforeInput"),0<u.length&&(c=new Op("onBeforeInput","beforeinput",null,t,c),f.push({event:c,listeners:u}),c.data=_))}Rv(f,e)})}function Ja(r,e,t){return{instance:r,listener:e,currentTarget:t}}function Ul(r,e){for(var t=e+"Capture",n=[];r!==null;){var i=r,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=ja(r,t),s!=null&&n.unshift(Ja(r,s,i)),s=ja(r,e),s!=null&&n.push(Ja(r,s,i))),r=r.return}return n}function us(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5);return r||null}function Hp(r,e,t,n,i){for(var s=e._reactName,a=[];t!==null&&t!==n;){var o=t,l=o.alternate,u=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&u!==null&&(o=u,i?(l=ja(t,s),l!=null&&a.unshift(Ja(t,l,o))):i||(l=ja(t,s),l!=null&&a.push(Ja(t,l,o)))),t=t.return}a.length!==0&&r.push({event:e,listeners:a})}var KS=/\r\n?/g,qS=/\u0000|\uFFFD/g;function jp(r){return(typeof r=="string"?r:""+r).replace(KS,`
`).replace(qS,"")}function Ko(r,e,t){if(e=jp(e),jp(r)!==e&&t)throw Error(ce(425))}function $l(){}var Wf=null,Hf=null;function jf(r,e){return r==="textarea"||r==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Kf=typeof setTimeout=="function"?setTimeout:void 0,YS=typeof clearTimeout=="function"?clearTimeout:void 0,Kp=typeof Promise=="function"?Promise:void 0,XS=typeof queueMicrotask=="function"?queueMicrotask:typeof Kp<"u"?function(r){return Kp.resolve(null).then(r).catch(ZS)}:Kf;function ZS(r){setTimeout(function(){throw r})}function Ac(r,e){var t=e,n=0;do{var i=t.nextSibling;if(r.removeChild(t),i&&i.nodeType===8)if(t=i.data,t==="/$"){if(n===0){r.removeChild(i),Ya(e);return}n--}else t!=="$"&&t!=="$?"&&t!=="$!"||n++;t=i}while(t);Ya(e)}function yi(r){for(;r!=null;r=r.nextSibling){var e=r.nodeType;if(e===1||e===3)break;if(e===8){if(e=r.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return r}function qp(r){r=r.previousSibling;for(var e=0;r;){if(r.nodeType===8){var t=r.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return r;e--}else t==="/$"&&e++}r=r.previousSibling}return null}var na=Math.random().toString(36).slice(2),Tn="__reactFiber$"+na,eo="__reactProps$"+na,jn="__reactContainer$"+na,qf="__reactEvents$"+na,QS="__reactListeners$"+na,JS="__reactHandles$"+na;function Bi(r){var e=r[Tn];if(e)return e;for(var t=r.parentNode;t;){if(e=t[jn]||t[Tn]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(r=qp(r);r!==null;){if(t=r[Tn])return t;r=qp(r)}return e}r=t,t=r.parentNode}return null}function yo(r){return r=r[Tn]||r[jn],!r||r.tag!==5&&r.tag!==6&&r.tag!==13&&r.tag!==3?null:r}function Cs(r){if(r.tag===5||r.tag===6)return r.stateNode;throw Error(ce(33))}function yu(r){return r[eo]||null}var Yf=[],Rs=-1;function Di(r){return{current:r}}function et(r){0>Rs||(r.current=Yf[Rs],Yf[Rs]=null,Rs--)}function Ze(r,e){Rs++,Yf[Rs]=r.current,r.current=e}var _i={},Ht=Di(_i),pr=Di(!1),Wi=_i;function js(r,e){var t=r.type.contextTypes;if(!t)return _i;var n=r.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in t)i[s]=e[s];return n&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=e,r.__reactInternalMemoizedMaskedChildContext=i),i}function gr(r){return r=r.childContextTypes,r!=null}function zl(){et(pr),et(Ht)}function Yp(r,e,t){if(Ht.current!==_i)throw Error(ce(168));Ze(Ht,e),Ze(pr,t)}function Iv(r,e,t){var n=r.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return t;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(ce(108,MT(r)||"Unknown",i));return ut({},t,n)}function Vl(r){return r=(r=r.stateNode)&&r.__reactInternalMemoizedMergedChildContext||_i,Wi=Ht.current,Ze(Ht,r),Ze(pr,pr.current),!0}function Xp(r,e,t){var n=r.stateNode;if(!n)throw Error(ce(169));t?(r=Iv(r,e,Wi),n.__reactInternalMemoizedMergedChildContext=r,et(pr),et(Ht),Ze(Ht,r)):et(pr),Ze(pr,t)}var Un=null,Eu=!1,bc=!1;function kv(r){Un===null?Un=[r]:Un.push(r)}function e1(r){Eu=!0,kv(r)}function Ci(){if(!bc&&Un!==null){bc=!0;var r=0,e=je;try{var t=Un;for(je=1;r<t.length;r++){var n=t[r];do n=n(!0);while(n!==null)}Un=null,Eu=!1}catch(i){throw Un!==null&&(Un=Un.slice(r+1)),nv(Hh,Ci),i}finally{je=e,bc=!1}}return null}var Ls=[],Is=0,Gl=null,Wl=0,Br=[],Ur=0,Hi=null,$n=1,zn="";function Ni(r,e){Ls[Is++]=Wl,Ls[Is++]=Gl,Gl=r,Wl=e}function Ov(r,e,t){Br[Ur++]=$n,Br[Ur++]=zn,Br[Ur++]=Hi,Hi=r;var n=$n;r=zn;var i=32-fn(n)-1;n&=~(1<<i),t+=1;var s=32-fn(e)+i;if(30<s){var a=i-i%5;s=(n&(1<<a)-1).toString(32),n>>=a,i-=a,$n=1<<32-fn(e)+i|t<<i|n,zn=s+r}else $n=1<<s|t<<i|n,zn=r}function ed(r){r.return!==null&&(Ni(r,1),Ov(r,1,0))}function td(r){for(;r===Gl;)Gl=Ls[--Is],Ls[Is]=null,Wl=Ls[--Is],Ls[Is]=null;for(;r===Hi;)Hi=Br[--Ur],Br[Ur]=null,zn=Br[--Ur],Br[Ur]=null,$n=Br[--Ur],Br[Ur]=null}var br=null,Ar=null,it=!1,on=null;function Nv(r,e){var t=zr(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=r,e=r.deletions,e===null?(r.deletions=[t],r.flags|=16):e.push(t)}function Zp(r,e){switch(r.tag){case 5:var t=r.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(r.stateNode=e,br=r,Ar=yi(e.firstChild),!0):!1;case 6:return e=r.pendingProps===""||e.nodeType!==3?null:e,e!==null?(r.stateNode=e,br=r,Ar=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=Hi!==null?{id:$n,overflow:zn}:null,r.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=zr(18,null,null,0),t.stateNode=e,t.return=r,r.child=t,br=r,Ar=null,!0):!1;default:return!1}}function Xf(r){return(r.mode&1)!==0&&(r.flags&128)===0}function Zf(r){if(it){var e=Ar;if(e){var t=e;if(!Zp(r,e)){if(Xf(r))throw Error(ce(418));e=yi(t.nextSibling);var n=br;e&&Zp(r,e)?Nv(n,t):(r.flags=r.flags&-4097|2,it=!1,br=r)}}else{if(Xf(r))throw Error(ce(418));r.flags=r.flags&-4097|2,it=!1,br=r}}}function Qp(r){for(r=r.return;r!==null&&r.tag!==5&&r.tag!==3&&r.tag!==13;)r=r.return;br=r}function qo(r){if(r!==br)return!1;if(!it)return Qp(r),it=!0,!1;var e;if((e=r.tag!==3)&&!(e=r.tag!==5)&&(e=r.type,e=e!=="head"&&e!=="body"&&!jf(r.type,r.memoizedProps)),e&&(e=Ar)){if(Xf(r))throw Pv(),Error(ce(418));for(;e;)Nv(r,e),e=yi(e.nextSibling)}if(Qp(r),r.tag===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(ce(317));e:{for(r=r.nextSibling,e=0;r;){if(r.nodeType===8){var t=r.data;if(t==="/$"){if(e===0){Ar=yi(r.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}r=r.nextSibling}Ar=null}}else Ar=br?yi(r.stateNode.nextSibling):null;return!0}function Pv(){for(var r=Ar;r;)r=yi(r.nextSibling)}function Ks(){Ar=br=null,it=!1}function rd(r){on===null?on=[r]:on.push(r)}var t1=Zn.ReactCurrentBatchConfig;function sn(r,e){if(r&&r.defaultProps){e=ut({},e),r=r.defaultProps;for(var t in r)e[t]===void 0&&(e[t]=r[t]);return e}return e}var Hl=Di(null),jl=null,ks=null,nd=null;function id(){nd=ks=jl=null}function sd(r){var e=Hl.current;et(Hl),r._currentValue=e}function Qf(r,e,t){for(;r!==null;){var n=r.alternate;if((r.childLanes&e)!==e?(r.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),r===t)break;r=r.return}}function Vs(r,e){jl=r,nd=ks=null,r=r.dependencies,r!==null&&r.firstContext!==null&&((r.lanes&e)!==0&&(dr=!0),r.firstContext=null)}function Gr(r){var e=r._currentValue;if(nd!==r)if(r={context:r,memoizedValue:e,next:null},ks===null){if(jl===null)throw Error(ce(308));ks=r,jl.dependencies={lanes:0,firstContext:r}}else ks=ks.next=r;return e}var Ui=null;function ad(r){Ui===null?Ui=[r]:Ui.push(r)}function Fv(r,e,t,n){var i=e.interleaved;return i===null?(t.next=t,ad(e)):(t.next=i.next,i.next=t),e.interleaved=t,Kn(r,n)}function Kn(r,e){r.lanes|=e;var t=r.alternate;for(t!==null&&(t.lanes|=e),t=r,r=r.return;r!==null;)r.childLanes|=e,t=r.alternate,t!==null&&(t.childLanes|=e),t=r,r=r.return;return t.tag===3?t.stateNode:null}var oi=!1;function od(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Mv(r,e){r=r.updateQueue,e.updateQueue===r&&(e.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,effects:r.effects})}function Gn(r,e){return{eventTime:r,lane:e,tag:0,payload:null,callback:null,next:null}}function Ei(r,e,t){var n=r.updateQueue;if(n===null)return null;if(n=n.shared,(Ue&2)!==0){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,Kn(r,t)}return i=n.interleaved,i===null?(e.next=e,ad(n)):(e.next=i.next,i.next=e),n.interleaved=e,Kn(r,t)}function Sl(r,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var n=e.lanes;n&=r.pendingLanes,t|=n,e.lanes=t,jh(r,t)}}function Jp(r,e){var t=r.updateQueue,n=r.alternate;if(n!==null&&(n=n.updateQueue,t===n)){var i=null,s=null;if(t=t.firstBaseUpdate,t!==null){do{var a={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};s===null?i=s=a:s=s.next=a,t=t.next}while(t!==null);s===null?i=s=e:s=s.next=e}else i=s=e;t={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},r.updateQueue=t;return}r=t.lastBaseUpdate,r===null?t.firstBaseUpdate=e:r.next=e,t.lastBaseUpdate=e}function Kl(r,e,t,n){var i=r.updateQueue;oi=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,u=l.next;l.next=null,a===null?s=u:a.next=u,a=l;var c=r.alternate;c!==null&&(c=c.updateQueue,o=c.lastBaseUpdate,o!==a&&(o===null?c.firstBaseUpdate=u:o.next=u,c.lastBaseUpdate=l))}if(s!==null){var f=i.baseState;a=0,c=u=l=null,o=s;do{var h=o.lane,d=o.eventTime;if((n&h)===h){c!==null&&(c=c.next={eventTime:d,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var m=r,x=o;switch(h=e,d=t,x.tag){case 1:if(m=x.payload,typeof m=="function"){f=m.call(d,f,h);break e}f=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=x.payload,h=typeof m=="function"?m.call(d,f,h):m,h==null)break e;f=ut({},f,h);break e;case 2:oi=!0}}o.callback!==null&&o.lane!==0&&(r.flags|=64,h=i.effects,h===null?i.effects=[o]:h.push(o))}else d={eventTime:d,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},c===null?(u=c=d,l=f):c=c.next=d,a|=h;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;h=o,o=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(1);if(c===null&&(l=f),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=c,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Ki|=a,r.lanes=a,r.memoizedState=f}}function eg(r,e,t){if(r=e.effects,e.effects=null,r!==null)for(e=0;e<r.length;e++){var n=r[e],i=n.callback;if(i!==null){if(n.callback=null,n=t,typeof i!="function")throw Error(ce(191,i));i.call(n)}}}var Bv=new Fm.Component().refs;function Jf(r,e,t,n){e=r.memoizedState,t=t(n,e),t=t==null?e:ut({},e,t),r.memoizedState=t,r.lanes===0&&(r.updateQueue.baseState=t)}var xu={isMounted:function(r){return(r=r._reactInternals)?es(r)===r:!1},enqueueSetState:function(r,e,t){r=r._reactInternals;var n=Qt(),i=Ti(r),s=Gn(n,i);s.payload=e,t!=null&&(s.callback=t),e=Ei(r,s,i),e!==null&&(hn(e,r,i,n),Sl(e,r,i))},enqueueReplaceState:function(r,e,t){r=r._reactInternals;var n=Qt(),i=Ti(r),s=Gn(n,i);s.tag=1,s.payload=e,t!=null&&(s.callback=t),e=Ei(r,s,i),e!==null&&(hn(e,r,i,n),Sl(e,r,i))},enqueueForceUpdate:function(r,e){r=r._reactInternals;var t=Qt(),n=Ti(r),i=Gn(t,n);i.tag=2,e!=null&&(i.callback=e),e=Ei(r,i,n),e!==null&&(hn(e,r,n,t),Sl(e,r,n))}};function tg(r,e,t,n,i,s,a){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(n,s,a):e.prototype&&e.prototype.isPureReactComponent?!Za(t,n)||!Za(i,s):!0}function Uv(r,e,t){var n=!1,i=_i,s=e.contextType;return typeof s=="object"&&s!==null?s=Gr(s):(i=gr(e)?Wi:Ht.current,n=e.contextTypes,s=(n=n!=null)?js(r,i):_i),e=new e(t,s),r.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=xu,r.stateNode=e,e._reactInternals=r,n&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=i,r.__reactInternalMemoizedMaskedChildContext=s),e}function rg(r,e,t,n){r=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,n),e.state!==r&&xu.enqueueReplaceState(e,e.state,null)}function eh(r,e,t,n){var i=r.stateNode;i.props=t,i.state=r.memoizedState,i.refs=Bv,od(r);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Gr(s):(s=gr(e)?Wi:Ht.current,i.context=js(r,s)),i.state=r.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Jf(r,e,s,t),i.state=r.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&xu.enqueueReplaceState(i,i.state,null),Kl(r,t,i,n),i.state=r.memoizedState),typeof i.componentDidMount=="function"&&(r.flags|=4194308)}function ma(r,e,t){if(r=t.ref,r!==null&&typeof r!="function"&&typeof r!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(ce(309));var n=t.stateNode}if(!n)throw Error(ce(147,r));var i=n,s=""+r;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var o=i.refs;o===Bv&&(o=i.refs={}),a===null?delete o[s]:o[s]=a},e._stringRef=s,e)}if(typeof r!="string")throw Error(ce(284));if(!t._owner)throw Error(ce(290,r))}return r}function Yo(r,e){throw r=Object.prototype.toString.call(e),Error(ce(31,r==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":r))}function ng(r){var e=r._init;return e(r._payload)}function $v(r){function e(g,v){if(r){var E=g.deletions;E===null?(g.deletions=[v],g.flags|=16):E.push(v)}}function t(g,v){if(!r)return null;for(;v!==null;)e(g,v),v=v.sibling;return null}function n(g,v){for(g=new Map;v!==null;)v.key!==null?g.set(v.key,v):g.set(v.index,v),v=v.sibling;return g}function i(g,v){return g=Si(g,v),g.index=0,g.sibling=null,g}function s(g,v,E){return g.index=E,r?(E=g.alternate,E!==null?(E=E.index,E<v?(g.flags|=2,v):E):(g.flags|=2,v)):(g.flags|=1048576,v)}function a(g){return r&&g.alternate===null&&(g.flags|=2),g}function o(g,v,E,S){return v===null||v.tag!==6?(v=Oc(E,g.mode,S),v.return=g,v):(v=i(v,E),v.return=g,v)}function l(g,v,E,S){var T=E.type;return T===_s?c(g,v,E.props.children,S,E.key):v!==null&&(v.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===ai&&ng(T)===v.type)?(S=i(v,E.props),S.ref=ma(g,v,E),S.return=g,S):(S=Cl(E.type,E.key,E.props,null,g.mode,S),S.ref=ma(g,v,E),S.return=g,S)}function u(g,v,E,S){return v===null||v.tag!==4||v.stateNode.containerInfo!==E.containerInfo||v.stateNode.implementation!==E.implementation?(v=Nc(E,g.mode,S),v.return=g,v):(v=i(v,E.children||[]),v.return=g,v)}function c(g,v,E,S,T){return v===null||v.tag!==7?(v=Vi(E,g.mode,S,T),v.return=g,v):(v=i(v,E),v.return=g,v)}function f(g,v,E){if(typeof v=="string"&&v!==""||typeof v=="number")return v=Oc(""+v,g.mode,E),v.return=g,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Bo:return E=Cl(v.type,v.key,v.props,null,g.mode,E),E.ref=ma(g,null,v),E.return=g,E;case ws:return v=Nc(v,g.mode,E),v.return=g,v;case ai:var S=v._init;return f(g,S(v._payload),E)}if(Ra(v)||fa(v))return v=Vi(v,g.mode,E,null),v.return=g,v;Yo(g,v)}return null}function h(g,v,E,S){var T=v!==null?v.key:null;if(typeof E=="string"&&E!==""||typeof E=="number")return T!==null?null:o(g,v,""+E,S);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Bo:return E.key===T?l(g,v,E,S):null;case ws:return E.key===T?u(g,v,E,S):null;case ai:return T=E._init,h(g,v,T(E._payload),S)}if(Ra(E)||fa(E))return T!==null?null:c(g,v,E,S,null);Yo(g,E)}return null}function d(g,v,E,S,T){if(typeof S=="string"&&S!==""||typeof S=="number")return g=g.get(E)||null,o(v,g,""+S,T);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Bo:return g=g.get(S.key===null?E:S.key)||null,l(v,g,S,T);case ws:return g=g.get(S.key===null?E:S.key)||null,u(v,g,S,T);case ai:var w=S._init;return d(g,v,E,w(S._payload),T)}if(Ra(S)||fa(S))return g=g.get(E)||null,c(v,g,S,T,null);Yo(v,S)}return null}function m(g,v,E,S){for(var T=null,w=null,_=v,C=v=0,O=null;_!==null&&C<E.length;C++){_.index>C?(O=_,_=null):O=_.sibling;var L=h(g,_,E[C],S);if(L===null){_===null&&(_=O);break}r&&_&&L.alternate===null&&e(g,_),v=s(L,v,C),w===null?T=L:w.sibling=L,w=L,_=O}if(C===E.length)return t(g,_),it&&Ni(g,C),T;if(_===null){for(;C<E.length;C++)_=f(g,E[C],S),_!==null&&(v=s(_,v,C),w===null?T=_:w.sibling=_,w=_);return it&&Ni(g,C),T}for(_=n(g,_);C<E.length;C++)O=d(_,g,C,E[C],S),O!==null&&(r&&O.alternate!==null&&_.delete(O.key===null?C:O.key),v=s(O,v,C),w===null?T=O:w.sibling=O,w=O);return r&&_.forEach(function(V){return e(g,V)}),it&&Ni(g,C),T}function x(g,v,E,S){var T=fa(E);if(typeof T!="function")throw Error(ce(150));if(E=T.call(E),E==null)throw Error(ce(151));for(var w=T=null,_=v,C=v=0,O=null,L=E.next();_!==null&&!L.done;C++,L=E.next()){_.index>C?(O=_,_=null):O=_.sibling;var V=h(g,_,L.value,S);if(V===null){_===null&&(_=O);break}r&&_&&V.alternate===null&&e(g,_),v=s(V,v,C),w===null?T=V:w.sibling=V,w=V,_=O}if(L.done)return t(g,_),it&&Ni(g,C),T;if(_===null){for(;!L.done;C++,L=E.next())L=f(g,L.value,S),L!==null&&(v=s(L,v,C),w===null?T=L:w.sibling=L,w=L);return it&&Ni(g,C),T}for(_=n(g,_);!L.done;C++,L=E.next())L=d(_,g,C,L.value,S),L!==null&&(r&&L.alternate!==null&&_.delete(L.key===null?C:L.key),v=s(L,v,C),w===null?T=L:w.sibling=L,w=L);return r&&_.forEach(function($){return e(g,$)}),it&&Ni(g,C),T}function p(g,v,E,S){if(typeof E=="object"&&E!==null&&E.type===_s&&E.key===null&&(E=E.props.children),typeof E=="object"&&E!==null){switch(E.$$typeof){case Bo:e:{for(var T=E.key,w=v;w!==null;){if(w.key===T){if(T=E.type,T===_s){if(w.tag===7){t(g,w.sibling),v=i(w,E.props.children),v.return=g,g=v;break e}}else if(w.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===ai&&ng(T)===w.type){t(g,w.sibling),v=i(w,E.props),v.ref=ma(g,w,E),v.return=g,g=v;break e}t(g,w);break}else e(g,w);w=w.sibling}E.type===_s?(v=Vi(E.props.children,g.mode,S,E.key),v.return=g,g=v):(S=Cl(E.type,E.key,E.props,null,g.mode,S),S.ref=ma(g,v,E),S.return=g,g=S)}return a(g);case ws:e:{for(w=E.key;v!==null;){if(v.key===w)if(v.tag===4&&v.stateNode.containerInfo===E.containerInfo&&v.stateNode.implementation===E.implementation){t(g,v.sibling),v=i(v,E.children||[]),v.return=g,g=v;break e}else{t(g,v);break}else e(g,v);v=v.sibling}v=Nc(E,g.mode,S),v.return=g,g=v}return a(g);case ai:return w=E._init,p(g,v,w(E._payload),S)}if(Ra(E))return m(g,v,E,S);if(fa(E))return x(g,v,E,S);Yo(g,E)}return typeof E=="string"&&E!==""||typeof E=="number"?(E=""+E,v!==null&&v.tag===6?(t(g,v.sibling),v=i(v,E),v.return=g,g=v):(t(g,v),v=Oc(E,g.mode,S),v.return=g,g=v),a(g)):t(g,v)}return p}var qs=$v(!0),zv=$v(!1),Eo={},_n=Di(Eo),to=Di(Eo),ro=Di(Eo);function $i(r){if(r===Eo)throw Error(ce(174));return r}function ld(r,e){switch(Ze(ro,e),Ze(to,r),Ze(_n,Eo),r=e.nodeType,r){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:kf(null,"");break;default:r=r===8?e.parentNode:e,e=r.namespaceURI||null,r=r.tagName,e=kf(e,r)}et(_n),Ze(_n,e)}function Ys(){et(_n),et(to),et(ro)}function Vv(r){$i(ro.current);var e=$i(_n.current),t=kf(e,r.type);e!==t&&(Ze(to,r),Ze(_n,t))}function ud(r){to.current===r&&(et(_n),et(to))}var at=Di(0);function ql(r){for(var e=r;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if((e.flags&128)!==0)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===r)break;for(;e.sibling===null;){if(e.return===null||e.return===r)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Dc=[];function cd(){for(var r=0;r<Dc.length;r++)Dc[r]._workInProgressVersionPrimary=null;Dc.length=0}var wl=Zn.ReactCurrentDispatcher,Cc=Zn.ReactCurrentBatchConfig,ji=0,lt=null,wt=null,Ct=null,Yl=!1,Ma=!1,no=0,r1=0;function zt(){throw Error(ce(321))}function fd(r,e){if(e===null)return!1;for(var t=0;t<e.length&&t<r.length;t++)if(!pn(r[t],e[t]))return!1;return!0}function hd(r,e,t,n,i,s){if(ji=s,lt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,wl.current=r===null||r.memoizedState===null?a1:o1,r=t(n,i),Ma){s=0;do{if(Ma=!1,no=0,25<=s)throw Error(ce(301));s+=1,Ct=wt=null,e.updateQueue=null,wl.current=l1,r=t(n,i)}while(Ma)}if(wl.current=Xl,e=wt!==null&&wt.next!==null,ji=0,Ct=wt=lt=null,Yl=!1,e)throw Error(ce(300));return r}function dd(){var r=no!==0;return no=0,r}function yn(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ct===null?lt.memoizedState=Ct=r:Ct=Ct.next=r,Ct}function Wr(){if(wt===null){var r=lt.alternate;r=r!==null?r.memoizedState:null}else r=wt.next;var e=Ct===null?lt.memoizedState:Ct.next;if(e!==null)Ct=e,wt=r;else{if(r===null)throw Error(ce(310));wt=r,r={memoizedState:wt.memoizedState,baseState:wt.baseState,baseQueue:wt.baseQueue,queue:wt.queue,next:null},Ct===null?lt.memoizedState=Ct=r:Ct=Ct.next=r}return Ct}function io(r,e){return typeof e=="function"?e(r):e}function Rc(r){var e=Wr(),t=e.queue;if(t===null)throw Error(ce(311));t.lastRenderedReducer=r;var n=wt,i=n.baseQueue,s=t.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}n.baseQueue=i=s,t.pending=null}if(i!==null){s=i.next,n=n.baseState;var o=a=null,l=null,u=s;do{var c=u.lane;if((ji&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:r(n,u.action);else{var f={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=f,a=n):l=l.next=f,lt.lanes|=c,Ki|=c}u=u.next}while(u!==null&&u!==s);l===null?a=n:l.next=o,pn(n,e.memoizedState)||(dr=!0),e.memoizedState=n,e.baseState=a,e.baseQueue=l,t.lastRenderedState=n}if(r=t.interleaved,r!==null){i=r;do s=i.lane,lt.lanes|=s,Ki|=s,i=i.next;while(i!==r)}else i===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function Lc(r){var e=Wr(),t=e.queue;if(t===null)throw Error(ce(311));t.lastRenderedReducer=r;var n=t.dispatch,i=t.pending,s=e.memoizedState;if(i!==null){t.pending=null;var a=i=i.next;do s=r(s,a.action),a=a.next;while(a!==i);pn(s,e.memoizedState)||(dr=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),t.lastRenderedState=s}return[s,n]}function Gv(){}function Wv(r,e){var t=lt,n=Wr(),i=e(),s=!pn(n.memoizedState,i);if(s&&(n.memoizedState=i,dr=!0),n=n.queue,pd(Kv.bind(null,t,n,r),[r]),n.getSnapshot!==e||s||Ct!==null&&Ct.memoizedState.tag&1){if(t.flags|=2048,so(9,jv.bind(null,t,n,i,e),void 0,null),Rt===null)throw Error(ce(349));(ji&30)!==0||Hv(t,e,i)}return i}function Hv(r,e,t){r.flags|=16384,r={getSnapshot:e,value:t},e=lt.updateQueue,e===null?(e={lastEffect:null,stores:null},lt.updateQueue=e,e.stores=[r]):(t=e.stores,t===null?e.stores=[r]:t.push(r))}function jv(r,e,t,n){e.value=t,e.getSnapshot=n,qv(e)&&Yv(r)}function Kv(r,e,t){return t(function(){qv(e)&&Yv(r)})}function qv(r){var e=r.getSnapshot;r=r.value;try{var t=e();return!pn(r,t)}catch{return!0}}function Yv(r){var e=Kn(r,1);e!==null&&hn(e,r,1,-1)}function ig(r){var e=yn();return typeof r=="function"&&(r=r()),e.memoizedState=e.baseState=r,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:io,lastRenderedState:r},e.queue=r,r=r.dispatch=s1.bind(null,lt,r),[e.memoizedState,r]}function so(r,e,t,n){return r={tag:r,create:e,destroy:t,deps:n,next:null},e=lt.updateQueue,e===null?(e={lastEffect:null,stores:null},lt.updateQueue=e,e.lastEffect=r.next=r):(t=e.lastEffect,t===null?e.lastEffect=r.next=r:(n=t.next,t.next=r,r.next=n,e.lastEffect=r)),r}function Xv(){return Wr().memoizedState}function _l(r,e,t,n){var i=yn();lt.flags|=r,i.memoizedState=so(1|e,t,void 0,n===void 0?null:n)}function Tu(r,e,t,n){var i=Wr();n=n===void 0?null:n;var s=void 0;if(wt!==null){var a=wt.memoizedState;if(s=a.destroy,n!==null&&fd(n,a.deps)){i.memoizedState=so(e,t,s,n);return}}lt.flags|=r,i.memoizedState=so(1|e,t,s,n)}function sg(r,e){return _l(8390656,8,r,e)}function pd(r,e){return Tu(2048,8,r,e)}function Zv(r,e){return Tu(4,2,r,e)}function Qv(r,e){return Tu(4,4,r,e)}function Jv(r,e){if(typeof e=="function")return r=r(),e(r),function(){e(null)};if(e!=null)return r=r(),e.current=r,function(){e.current=null}}function ey(r,e,t){return t=t!=null?t.concat([r]):null,Tu(4,4,Jv.bind(null,e,r),t)}function gd(){}function ty(r,e){var t=Wr();e=e===void 0?null:e;var n=t.memoizedState;return n!==null&&e!==null&&fd(e,n[1])?n[0]:(t.memoizedState=[r,e],r)}function ry(r,e){var t=Wr();e=e===void 0?null:e;var n=t.memoizedState;return n!==null&&e!==null&&fd(e,n[1])?n[0]:(r=r(),t.memoizedState=[r,e],r)}function ny(r,e,t){return(ji&21)===0?(r.baseState&&(r.baseState=!1,dr=!0),r.memoizedState=t):(pn(t,e)||(t=av(),lt.lanes|=t,Ki|=t,r.baseState=!0),e)}function n1(r,e){var t=je;je=t!==0&&4>t?t:4,r(!0);var n=Cc.transition;Cc.transition={};try{r(!1),e()}finally{je=t,Cc.transition=n}}function iy(){return Wr().memoizedState}function i1(r,e,t){var n=Ti(r);if(t={lane:n,action:t,hasEagerState:!1,eagerState:null,next:null},sy(r))ay(e,t);else if(t=Fv(r,e,t,n),t!==null){var i=Qt();hn(t,r,n,i),oy(t,e,n)}}function s1(r,e,t){var n=Ti(r),i={lane:n,action:t,hasEagerState:!1,eagerState:null,next:null};if(sy(r))ay(e,i);else{var s=r.alternate;if(r.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,o=s(a,t);if(i.hasEagerState=!0,i.eagerState=o,pn(o,a)){var l=e.interleaved;l===null?(i.next=i,ad(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}t=Fv(r,e,i,n),t!==null&&(i=Qt(),hn(t,r,n,i),oy(t,e,n))}}function sy(r){var e=r.alternate;return r===lt||e!==null&&e===lt}function ay(r,e){Ma=Yl=!0;var t=r.pending;t===null?e.next=e:(e.next=t.next,t.next=e),r.pending=e}function oy(r,e,t){if((t&4194240)!==0){var n=e.lanes;n&=r.pendingLanes,t|=n,e.lanes=t,jh(r,t)}}var Xl={readContext:Gr,useCallback:zt,useContext:zt,useEffect:zt,useImperativeHandle:zt,useInsertionEffect:zt,useLayoutEffect:zt,useMemo:zt,useReducer:zt,useRef:zt,useState:zt,useDebugValue:zt,useDeferredValue:zt,useTransition:zt,useMutableSource:zt,useSyncExternalStore:zt,useId:zt,unstable_isNewReconciler:!1},a1={readContext:Gr,useCallback:function(r,e){return yn().memoizedState=[r,e===void 0?null:e],r},useContext:Gr,useEffect:sg,useImperativeHandle:function(r,e,t){return t=t!=null?t.concat([r]):null,_l(4194308,4,Jv.bind(null,e,r),t)},useLayoutEffect:function(r,e){return _l(4194308,4,r,e)},useInsertionEffect:function(r,e){return _l(4,2,r,e)},useMemo:function(r,e){var t=yn();return e=e===void 0?null:e,r=r(),t.memoizedState=[r,e],r},useReducer:function(r,e,t){var n=yn();return e=t!==void 0?t(e):e,n.memoizedState=n.baseState=e,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:e},n.queue=r,r=r.dispatch=i1.bind(null,lt,r),[n.memoizedState,r]},useRef:function(r){var e=yn();return r={current:r},e.memoizedState=r},useState:ig,useDebugValue:gd,useDeferredValue:function(r){return yn().memoizedState=r},useTransition:function(){var r=ig(!1),e=r[0];return r=n1.bind(null,r[1]),yn().memoizedState=r,[e,r]},useMutableSource:function(){},useSyncExternalStore:function(r,e,t){var n=lt,i=yn();if(it){if(t===void 0)throw Error(ce(407));t=t()}else{if(t=e(),Rt===null)throw Error(ce(349));(ji&30)!==0||Hv(n,e,t)}i.memoizedState=t;var s={value:t,getSnapshot:e};return i.queue=s,sg(Kv.bind(null,n,s,r),[r]),n.flags|=2048,so(9,jv.bind(null,n,s,t,e),void 0,null),t},useId:function(){var r=yn(),e=Rt.identifierPrefix;if(it){var t=zn,n=$n;t=(n&~(1<<32-fn(n)-1)).toString(32)+t,e=":"+e+"R"+t,t=no++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=r1++,e=":"+e+"r"+t.toString(32)+":";return r.memoizedState=e},unstable_isNewReconciler:!1},o1={readContext:Gr,useCallback:ty,useContext:Gr,useEffect:pd,useImperativeHandle:ey,useInsertionEffect:Zv,useLayoutEffect:Qv,useMemo:ry,useReducer:Rc,useRef:Xv,useState:function(){return Rc(io)},useDebugValue:gd,useDeferredValue:function(r){var e=Wr();return ny(e,wt.memoizedState,r)},useTransition:function(){var r=Rc(io)[0],e=Wr().memoizedState;return[r,e]},useMutableSource:Gv,useSyncExternalStore:Wv,useId:iy,unstable_isNewReconciler:!1},l1={readContext:Gr,useCallback:ty,useContext:Gr,useEffect:pd,useImperativeHandle:ey,useInsertionEffect:Zv,useLayoutEffect:Qv,useMemo:ry,useReducer:Lc,useRef:Xv,useState:function(){return Lc(io)},useDebugValue:gd,useDeferredValue:function(r){var e=Wr();return wt===null?e.memoizedState=r:ny(e,wt.memoizedState,r)},useTransition:function(){var r=Lc(io)[0],e=Wr().memoizedState;return[r,e]},useMutableSource:Gv,useSyncExternalStore:Wv,useId:iy,unstable_isNewReconciler:!1};function Xs(r,e){try{var t="",n=e;do t+=FT(n),n=n.return;while(n);var i=t}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:r,source:e,stack:i,digest:null}}function Ic(r,e,t){return{value:r,source:null,stack:t!=null?t:null,digest:e!=null?e:null}}function th(r,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var u1=typeof WeakMap=="function"?WeakMap:Map;function ly(r,e,t){t=Gn(-1,t),t.tag=3,t.payload={element:null};var n=e.value;return t.callback=function(){Ql||(Ql=!0,fh=n),th(r,e)},t}function uy(r,e,t){t=Gn(-1,t),t.tag=3;var n=r.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;t.payload=function(){return n(i)},t.callback=function(){th(r,e)}}var s=r.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(t.callback=function(){th(r,e),typeof n!="function"&&(xi===null?xi=new Set([this]):xi.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),t}function ag(r,e,t){var n=r.pingCache;if(n===null){n=r.pingCache=new u1;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(t)||(i.add(t),r=w1.bind(null,r,e,t),e.then(r,r))}function og(r){do{var e;if((e=r.tag===13)&&(e=r.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return r;r=r.return}while(r!==null);return null}function lg(r,e,t,n,i){return(r.mode&1)===0?(r===e?r.flags|=65536:(r.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Gn(-1,1),e.tag=2,Ei(t,e,1))),t.lanes|=1),r):(r.flags|=65536,r.lanes=i,r)}var c1=Zn.ReactCurrentOwner,dr=!1;function Zt(r,e,t,n){e.child=r===null?zv(e,null,t,n):qs(e,r.child,t,n)}function ug(r,e,t,n,i){t=t.render;var s=e.ref;return Vs(e,i),n=hd(r,e,t,n,s,i),t=dd(),r!==null&&!dr?(e.updateQueue=r.updateQueue,e.flags&=-2053,r.lanes&=~i,qn(r,e,i)):(it&&t&&ed(e),e.flags|=1,Zt(r,e,n,i),e.child)}function cg(r,e,t,n,i){if(r===null){var s=t.type;return typeof s=="function"&&!wd(s)&&s.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=s,cy(r,e,s,n,i)):(r=Cl(t.type,null,n,e,e.mode,i),r.ref=e.ref,r.return=e,e.child=r)}if(s=r.child,(r.lanes&i)===0){var a=s.memoizedProps;if(t=t.compare,t=t!==null?t:Za,t(a,n)&&r.ref===e.ref)return qn(r,e,i)}return e.flags|=1,r=Si(s,n),r.ref=e.ref,r.return=e,e.child=r}function cy(r,e,t,n,i){if(r!==null){var s=r.memoizedProps;if(Za(s,n)&&r.ref===e.ref)if(dr=!1,e.pendingProps=n=s,(r.lanes&i)!==0)(r.flags&131072)!==0&&(dr=!0);else return e.lanes=r.lanes,qn(r,e,i)}return rh(r,e,t,n,i)}function fy(r,e,t){var n=e.pendingProps,i=n.children,s=r!==null?r.memoizedState:null;if(n.mode==="hidden")if((e.mode&1)===0)e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ze(Ns,_r),_r|=t;else{if((t&1073741824)===0)return r=s!==null?s.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:r,cachePool:null,transitions:null},e.updateQueue=null,Ze(Ns,_r),_r|=r,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:t,Ze(Ns,_r),_r|=n}else s!==null?(n=s.baseLanes|t,e.memoizedState=null):n=t,Ze(Ns,_r),_r|=n;return Zt(r,e,i,t),e.child}function hy(r,e){var t=e.ref;(r===null&&t!==null||r!==null&&r.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function rh(r,e,t,n,i){var s=gr(t)?Wi:Ht.current;return s=js(e,s),Vs(e,i),t=hd(r,e,t,n,s,i),n=dd(),r!==null&&!dr?(e.updateQueue=r.updateQueue,e.flags&=-2053,r.lanes&=~i,qn(r,e,i)):(it&&n&&ed(e),e.flags|=1,Zt(r,e,t,i),e.child)}function fg(r,e,t,n,i){if(gr(t)){var s=!0;Vl(e)}else s=!1;if(Vs(e,i),e.stateNode===null)Al(r,e),Uv(e,t,n),eh(e,t,n,i),n=!0;else if(r===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,u=t.contextType;typeof u=="object"&&u!==null?u=Gr(u):(u=gr(t)?Wi:Ht.current,u=js(e,u));var c=t.getDerivedStateFromProps,f=typeof c=="function"||typeof a.getSnapshotBeforeUpdate=="function";f||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||l!==u)&&rg(e,a,n,u),oi=!1;var h=e.memoizedState;a.state=h,Kl(e,n,a,i),l=e.memoizedState,o!==n||h!==l||pr.current||oi?(typeof c=="function"&&(Jf(e,t,c,n),l=e.memoizedState),(o=oi||tg(e,t,o,n,h,l,u))?(f||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),a.props=n,a.state=l,a.context=u,n=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{a=e.stateNode,Mv(r,e),o=e.memoizedProps,u=e.type===e.elementType?o:sn(e.type,o),a.props=u,f=e.pendingProps,h=a.context,l=t.contextType,typeof l=="object"&&l!==null?l=Gr(l):(l=gr(t)?Wi:Ht.current,l=js(e,l));var d=t.getDerivedStateFromProps;(c=typeof d=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==f||h!==l)&&rg(e,a,n,l),oi=!1,h=e.memoizedState,a.state=h,Kl(e,n,a,i);var m=e.memoizedState;o!==f||h!==m||pr.current||oi?(typeof d=="function"&&(Jf(e,t,d,n),m=e.memoizedState),(u=oi||tg(e,t,u,n,h,m,l)||!1)?(c||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,m,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,m,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===r.memoizedProps&&h===r.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===r.memoizedProps&&h===r.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=m),a.props=n,a.state=m,a.context=l,n=u):(typeof a.componentDidUpdate!="function"||o===r.memoizedProps&&h===r.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===r.memoizedProps&&h===r.memoizedState||(e.flags|=1024),n=!1)}return nh(r,e,t,n,s,i)}function nh(r,e,t,n,i,s){hy(r,e);var a=(e.flags&128)!==0;if(!n&&!a)return i&&Xp(e,t,!1),qn(r,e,s);n=e.stateNode,c1.current=e;var o=a&&typeof t.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,r!==null&&a?(e.child=qs(e,r.child,null,s),e.child=qs(e,null,o,s)):Zt(r,e,o,s),e.memoizedState=n.state,i&&Xp(e,t,!0),e.child}function dy(r){var e=r.stateNode;e.pendingContext?Yp(r,e.pendingContext,e.pendingContext!==e.context):e.context&&Yp(r,e.context,!1),ld(r,e.containerInfo)}function hg(r,e,t,n,i){return Ks(),rd(i),e.flags|=256,Zt(r,e,t,n),e.child}var ih={dehydrated:null,treeContext:null,retryLane:0};function sh(r){return{baseLanes:r,cachePool:null,transitions:null}}function py(r,e,t){var n=e.pendingProps,i=at.current,s=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=r!==null&&r.memoizedState===null?!1:(i&2)!==0),o?(s=!0,e.flags&=-129):(r===null||r.memoizedState!==null)&&(i|=1),Ze(at,i&1),r===null)return Zf(e),r=e.memoizedState,r!==null&&(r=r.dehydrated,r!==null)?((e.mode&1)===0?e.lanes=1:r.data==="$!"?e.lanes=8:e.lanes=1073741824,null):(a=n.children,r=n.fallback,s?(n=e.mode,s=e.child,a={mode:"hidden",children:a},(n&1)===0&&s!==null?(s.childLanes=0,s.pendingProps=a):s=_u(a,n,0,null),r=Vi(r,n,t,null),s.return=e,r.return=e,s.sibling=r,e.child=s,e.child.memoizedState=sh(t),e.memoizedState=ih,r):md(e,a));if(i=r.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return f1(r,e,a,n,o,i,t);if(s){s=n.fallback,a=e.mode,i=r.child,o=i.sibling;var l={mode:"hidden",children:n.children};return(a&1)===0&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=Si(i,l),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=Si(o,s):(s=Vi(s,a,t,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,a=r.child.memoizedState,a=a===null?sh(t):{baseLanes:a.baseLanes|t,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=r.childLanes&~t,e.memoizedState=ih,n}return s=r.child,r=s.sibling,n=Si(s,{mode:"visible",children:n.children}),(e.mode&1)===0&&(n.lanes=t),n.return=e,n.sibling=null,r!==null&&(t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)),e.child=n,e.memoizedState=null,n}function md(r,e){return e=_u({mode:"visible",children:e},r.mode,0,null),e.return=r,r.child=e}function Xo(r,e,t,n){return n!==null&&rd(n),qs(e,r.child,null,t),r=md(e,e.pendingProps.children),r.flags|=2,e.memoizedState=null,r}function f1(r,e,t,n,i,s,a){if(t)return e.flags&256?(e.flags&=-257,n=Ic(Error(ce(422))),Xo(r,e,a,n)):e.memoizedState!==null?(e.child=r.child,e.flags|=128,null):(s=n.fallback,i=e.mode,n=_u({mode:"visible",children:n.children},i,0,null),s=Vi(s,i,a,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,(e.mode&1)!==0&&qs(e,r.child,null,a),e.child.memoizedState=sh(a),e.memoizedState=ih,s);if((e.mode&1)===0)return Xo(r,e,a,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(ce(419)),n=Ic(s,n,void 0),Xo(r,e,a,n)}if(o=(a&r.childLanes)!==0,dr||o){if(n=Rt,n!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=(i&(n.suspendedLanes|a))!==0?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Kn(r,i),hn(n,r,i,-1))}return Sd(),n=Ic(Error(ce(421))),Xo(r,e,a,n)}return i.data==="$?"?(e.flags|=128,e.child=r.child,e=_1.bind(null,r),i._reactRetry=e,null):(r=s.treeContext,Ar=yi(i.nextSibling),br=e,it=!0,on=null,r!==null&&(Br[Ur++]=$n,Br[Ur++]=zn,Br[Ur++]=Hi,$n=r.id,zn=r.overflow,Hi=e),e=md(e,n.children),e.flags|=4096,e)}function dg(r,e,t){r.lanes|=e;var n=r.alternate;n!==null&&(n.lanes|=e),Qf(r.return,e,t)}function kc(r,e,t,n,i){var s=r.memoizedState;s===null?r.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:t,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=t,s.tailMode=i)}function gy(r,e,t){var n=e.pendingProps,i=n.revealOrder,s=n.tail;if(Zt(r,e,n.children,t),n=at.current,(n&2)!==0)n=n&1|2,e.flags|=128;else{if(r!==null&&(r.flags&128)!==0)e:for(r=e.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&dg(r,t,e);else if(r.tag===19)dg(r,t,e);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break e;for(;r.sibling===null;){if(r.return===null||r.return===e)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}n&=1}if(Ze(at,n),(e.mode&1)===0)e.memoizedState=null;else switch(i){case"forwards":for(t=e.child,i=null;t!==null;)r=t.alternate,r!==null&&ql(r)===null&&(i=t),t=t.sibling;t=i,t===null?(i=e.child,e.child=null):(i=t.sibling,t.sibling=null),kc(e,!1,i,t,s);break;case"backwards":for(t=null,i=e.child,e.child=null;i!==null;){if(r=i.alternate,r!==null&&ql(r)===null){e.child=i;break}r=i.sibling,i.sibling=t,t=i,i=r}kc(e,!0,t,null,s);break;case"together":kc(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Al(r,e){(e.mode&1)===0&&r!==null&&(r.alternate=null,e.alternate=null,e.flags|=2)}function qn(r,e,t){if(r!==null&&(e.dependencies=r.dependencies),Ki|=e.lanes,(t&e.childLanes)===0)return null;if(r!==null&&e.child!==r.child)throw Error(ce(153));if(e.child!==null){for(r=e.child,t=Si(r,r.pendingProps),e.child=t,t.return=e;r.sibling!==null;)r=r.sibling,t=t.sibling=Si(r,r.pendingProps),t.return=e;t.sibling=null}return e.child}function h1(r,e,t){switch(e.tag){case 3:dy(e),Ks();break;case 5:Vv(e);break;case 1:gr(e.type)&&Vl(e);break;case 4:ld(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;Ze(Hl,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(Ze(at,at.current&1),e.flags|=128,null):(t&e.child.childLanes)!==0?py(r,e,t):(Ze(at,at.current&1),r=qn(r,e,t),r!==null?r.sibling:null);Ze(at,at.current&1);break;case 19:if(n=(t&e.childLanes)!==0,(r.flags&128)!==0){if(n)return gy(r,e,t);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ze(at,at.current),n)break;return null;case 22:case 23:return e.lanes=0,fy(r,e,t)}return qn(r,e,t)}var my,ah,vy,yy;my=function(r,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)r.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};ah=function(){};vy=function(r,e,t,n){var i=r.memoizedProps;if(i!==n){r=e.stateNode,$i(_n.current);var s=null;switch(t){case"input":i=Cf(r,i),n=Cf(r,n),s=[];break;case"select":i=ut({},i,{value:void 0}),n=ut({},n,{value:void 0}),s=[];break;case"textarea":i=If(r,i),n=If(r,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(r.onclick=$l)}Of(t,n);var a;t=null;for(u in i)if(!n.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var o=i[u];for(a in o)o.hasOwnProperty(a)&&(t||(t={}),t[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Wa.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var l=n[u];if(o=i!=null?i[u]:void 0,n.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(t||(t={}),t[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(t||(t={}),t[a]=l[a])}else t||(s||(s=[]),s.push(u,t)),t=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Wa.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Qe("scroll",r),s||o===l||(s=[])):(s=s||[]).push(u,l))}t&&(s=s||[]).push("style",t);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};yy=function(r,e,t,n){t!==n&&(e.flags|=4)};function va(r,e){if(!it)switch(r.tailMode){case"hidden":e=r.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?r.tail=null:t.sibling=null;break;case"collapsed":t=r.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e||r.tail===null?r.tail=null:r.tail.sibling=null:n.sibling=null}}function Vt(r){var e=r.alternate!==null&&r.alternate.child===r.child,t=0,n=0;if(e)for(var i=r.child;i!==null;)t|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=r,i=i.sibling;else for(i=r.child;i!==null;)t|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=r,i=i.sibling;return r.subtreeFlags|=n,r.childLanes=t,e}function d1(r,e,t){var n=e.pendingProps;switch(td(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Vt(e),null;case 1:return gr(e.type)&&zl(),Vt(e),null;case 3:return n=e.stateNode,Ys(),et(pr),et(Ht),cd(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(r===null||r.child===null)&&(qo(e)?e.flags|=4:r===null||r.memoizedState.isDehydrated&&(e.flags&256)===0||(e.flags|=1024,on!==null&&(ph(on),on=null))),ah(r,e),Vt(e),null;case 5:ud(e);var i=$i(ro.current);if(t=e.type,r!==null&&e.stateNode!=null)vy(r,e,t,n,i),r.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(ce(166));return Vt(e),null}if(r=$i(_n.current),qo(e)){n=e.stateNode,t=e.type;var s=e.memoizedProps;switch(n[Tn]=e,n[eo]=s,r=(e.mode&1)!==0,t){case"dialog":Qe("cancel",n),Qe("close",n);break;case"iframe":case"object":case"embed":Qe("load",n);break;case"video":case"audio":for(i=0;i<Ia.length;i++)Qe(Ia[i],n);break;case"source":Qe("error",n);break;case"img":case"image":case"link":Qe("error",n),Qe("load",n);break;case"details":Qe("toggle",n);break;case"input":Sp(n,s),Qe("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Qe("invalid",n);break;case"textarea":_p(n,s),Qe("invalid",n)}Of(t,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&Ko(n.textContent,o,r),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&Ko(n.textContent,o,r),i=["children",""+o]):Wa.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&Qe("scroll",n)}switch(t){case"input":Uo(n),wp(n,s,!0);break;case"textarea":Uo(n),Ap(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=$l)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,r==="http://www.w3.org/1999/xhtml"&&(r=Hm(t)),r==="http://www.w3.org/1999/xhtml"?t==="script"?(r=a.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild)):typeof n.is=="string"?r=a.createElement(t,{is:n.is}):(r=a.createElement(t),t==="select"&&(a=r,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):r=a.createElementNS(r,t),r[Tn]=e,r[eo]=n,my(r,e,!1,!1),e.stateNode=r;e:{switch(a=Nf(t,n),t){case"dialog":Qe("cancel",r),Qe("close",r),i=n;break;case"iframe":case"object":case"embed":Qe("load",r),i=n;break;case"video":case"audio":for(i=0;i<Ia.length;i++)Qe(Ia[i],r);i=n;break;case"source":Qe("error",r),i=n;break;case"img":case"image":case"link":Qe("error",r),Qe("load",r),i=n;break;case"details":Qe("toggle",r),i=n;break;case"input":Sp(r,n),i=Cf(r,n),Qe("invalid",r);break;case"option":i=n;break;case"select":r._wrapperState={wasMultiple:!!n.multiple},i=ut({},n,{value:void 0}),Qe("invalid",r);break;case"textarea":_p(r,n),i=If(r,n),Qe("invalid",r);break;default:i=n}Of(t,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?qm(r,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&jm(r,l)):s==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&Ha(r,l):typeof l=="number"&&Ha(r,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Wa.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Qe("scroll",r):l!=null&&$h(r,s,l,a))}switch(t){case"input":Uo(r),wp(r,n,!1);break;case"textarea":Uo(r),Ap(r);break;case"option":n.value!=null&&r.setAttribute("value",""+wi(n.value));break;case"select":r.multiple=!!n.multiple,s=n.value,s!=null?Bs(r,!!n.multiple,s,!1):n.defaultValue!=null&&Bs(r,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(r.onclick=$l)}switch(t){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Vt(e),null;case 6:if(r&&e.stateNode!=null)yy(r,e,r.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(ce(166));if(t=$i(ro.current),$i(_n.current),qo(e)){if(n=e.stateNode,t=e.memoizedProps,n[Tn]=e,(s=n.nodeValue!==t)&&(r=br,r!==null))switch(r.tag){case 3:Ko(n.nodeValue,t,(r.mode&1)!==0);break;case 5:r.memoizedProps.suppressHydrationWarning!==!0&&Ko(n.nodeValue,t,(r.mode&1)!==0)}s&&(e.flags|=4)}else n=(t.nodeType===9?t:t.ownerDocument).createTextNode(n),n[Tn]=e,e.stateNode=n}return Vt(e),null;case 13:if(et(at),n=e.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(it&&Ar!==null&&(e.mode&1)!==0&&(e.flags&128)===0)Pv(),Ks(),e.flags|=98560,s=!1;else if(s=qo(e),n!==null&&n.dehydrated!==null){if(r===null){if(!s)throw Error(ce(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ce(317));s[Tn]=e}else Ks(),(e.flags&128)===0&&(e.memoizedState=null),e.flags|=4;Vt(e),s=!1}else on!==null&&(ph(on),on=null),s=!0;if(!s)return e.flags&65536?e:null}return(e.flags&128)!==0?(e.lanes=t,e):(n=n!==null,n!==(r!==null&&r.memoizedState!==null)&&n&&(e.child.flags|=8192,(e.mode&1)!==0&&(r===null||(at.current&1)!==0?_t===0&&(_t=3):Sd())),e.updateQueue!==null&&(e.flags|=4),Vt(e),null);case 4:return Ys(),ah(r,e),r===null&&Qa(e.stateNode.containerInfo),Vt(e),null;case 10:return sd(e.type._context),Vt(e),null;case 17:return gr(e.type)&&zl(),Vt(e),null;case 19:if(et(at),s=e.memoizedState,s===null)return Vt(e),null;if(n=(e.flags&128)!==0,a=s.rendering,a===null)if(n)va(s,!1);else{if(_t!==0||r!==null&&(r.flags&128)!==0)for(r=e.child;r!==null;){if(a=ql(r),a!==null){for(e.flags|=128,va(s,!1),n=a.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=t,t=e.child;t!==null;)s=t,r=n,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=r,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,r=a.dependencies,s.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),t=t.sibling;return Ze(at,at.current&1|2),e.child}r=r.sibling}s.tail!==null&&mt()>Zs&&(e.flags|=128,n=!0,va(s,!1),e.lanes=4194304)}else{if(!n)if(r=ql(a),r!==null){if(e.flags|=128,n=!0,t=r.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),va(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!it)return Vt(e),null}else 2*mt()-s.renderingStartTime>Zs&&t!==1073741824&&(e.flags|=128,n=!0,va(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(t=s.last,t!==null?t.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=mt(),e.sibling=null,t=at.current,Ze(at,n?t&1|2:t&1),e):(Vt(e),null);case 22:case 23:return Td(),n=e.memoizedState!==null,r!==null&&r.memoizedState!==null!==n&&(e.flags|=8192),n&&(e.mode&1)!==0?(_r&1073741824)!==0&&(Vt(e),e.subtreeFlags&6&&(e.flags|=8192)):Vt(e),null;case 24:return null;case 25:return null}throw Error(ce(156,e.tag))}function p1(r,e){switch(td(e),e.tag){case 1:return gr(e.type)&&zl(),r=e.flags,r&65536?(e.flags=r&-65537|128,e):null;case 3:return Ys(),et(pr),et(Ht),cd(),r=e.flags,(r&65536)!==0&&(r&128)===0?(e.flags=r&-65537|128,e):null;case 5:return ud(e),null;case 13:if(et(at),r=e.memoizedState,r!==null&&r.dehydrated!==null){if(e.alternate===null)throw Error(ce(340));Ks()}return r=e.flags,r&65536?(e.flags=r&-65537|128,e):null;case 19:return et(at),null;case 4:return Ys(),null;case 10:return sd(e.type._context),null;case 22:case 23:return Td(),null;case 24:return null;default:return null}}var Zo=!1,Wt=!1,g1=typeof WeakSet=="function"?WeakSet:Set,xe=null;function Os(r,e){var t=r.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(n){ft(r,e,n)}else t.current=null}function oh(r,e,t){try{t()}catch(n){ft(r,e,n)}}var pg=!1;function m1(r,e){if(Wf=Ml,r=Sv(),Jh(r)){if("selectionStart"in r)var t={start:r.selectionStart,end:r.selectionEnd};else e:{t=(t=r.ownerDocument)&&t.defaultView||window;var n=t.getSelection&&t.getSelection();if(n&&n.rangeCount!==0){t=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{t.nodeType,s.nodeType}catch{t=null;break e}var a=0,o=-1,l=-1,u=0,c=0,f=r,h=null;t:for(;;){for(var d;f!==t||i!==0&&f.nodeType!==3||(o=a+i),f!==s||n!==0&&f.nodeType!==3||(l=a+n),f.nodeType===3&&(a+=f.nodeValue.length),(d=f.firstChild)!==null;)h=f,f=d;for(;;){if(f===r)break t;if(h===t&&++u===i&&(o=a),h===s&&++c===n&&(l=a),(d=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=d}t=o===-1||l===-1?null:{start:o,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(Hf={focusedElem:r,selectionRange:t},Ml=!1,xe=e;xe!==null;)if(e=xe,r=e.child,(e.subtreeFlags&1028)!==0&&r!==null)r.return=e,xe=r;else for(;xe!==null;){e=xe;try{var m=e.alternate;if((e.flags&1024)!==0)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var x=m.memoizedProps,p=m.memoizedState,g=e.stateNode,v=g.getSnapshotBeforeUpdate(e.elementType===e.type?x:sn(e.type,x),p);g.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var E=e.stateNode.containerInfo;E.nodeType===1?E.textContent="":E.nodeType===9&&E.documentElement&&E.removeChild(E.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ce(163))}}catch(S){ft(e,e.return,S)}if(r=e.sibling,r!==null){r.return=e.return,xe=r;break}xe=e.return}return m=pg,pg=!1,m}function Ba(r,e,t){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&r)===r){var s=i.destroy;i.destroy=void 0,s!==void 0&&oh(e,t,s)}i=i.next}while(i!==n)}}function Su(r,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&r)===r){var n=t.create;t.destroy=n()}t=t.next}while(t!==e)}}function lh(r){var e=r.ref;if(e!==null){var t=r.stateNode;switch(r.tag){case 5:r=t;break;default:r=t}typeof e=="function"?e(r):e.current=r}}function Ey(r){var e=r.alternate;e!==null&&(r.alternate=null,Ey(e)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(e=r.stateNode,e!==null&&(delete e[Tn],delete e[eo],delete e[qf],delete e[QS],delete e[JS])),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}function xy(r){return r.tag===5||r.tag===3||r.tag===4}function gg(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||xy(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function uh(r,e,t){var n=r.tag;if(n===5||n===6)r=r.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(r,e):t.insertBefore(r,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(r,t)):(e=t,e.appendChild(r)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=$l));else if(n!==4&&(r=r.child,r!==null))for(uh(r,e,t),r=r.sibling;r!==null;)uh(r,e,t),r=r.sibling}function ch(r,e,t){var n=r.tag;if(n===5||n===6)r=r.stateNode,e?t.insertBefore(r,e):t.appendChild(r);else if(n!==4&&(r=r.child,r!==null))for(ch(r,e,t),r=r.sibling;r!==null;)ch(r,e,t),r=r.sibling}var Nt=null,an=!1;function ei(r,e,t){for(t=t.child;t!==null;)Ty(r,e,t),t=t.sibling}function Ty(r,e,t){if(wn&&typeof wn.onCommitFiberUnmount=="function")try{wn.onCommitFiberUnmount(pu,t)}catch{}switch(t.tag){case 5:Wt||Os(t,e);case 6:var n=Nt,i=an;Nt=null,ei(r,e,t),Nt=n,an=i,Nt!==null&&(an?(r=Nt,t=t.stateNode,r.nodeType===8?r.parentNode.removeChild(t):r.removeChild(t)):Nt.removeChild(t.stateNode));break;case 18:Nt!==null&&(an?(r=Nt,t=t.stateNode,r.nodeType===8?Ac(r.parentNode,t):r.nodeType===1&&Ac(r,t),Ya(r)):Ac(Nt,t.stateNode));break;case 4:n=Nt,i=an,Nt=t.stateNode.containerInfo,an=!0,ei(r,e,t),Nt=n,an=i;break;case 0:case 11:case 14:case 15:if(!Wt&&(n=t.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&((s&2)!==0||(s&4)!==0)&&oh(t,e,a),i=i.next}while(i!==n)}ei(r,e,t);break;case 1:if(!Wt&&(Os(t,e),n=t.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=t.memoizedProps,n.state=t.memoizedState,n.componentWillUnmount()}catch(o){ft(t,e,o)}ei(r,e,t);break;case 21:ei(r,e,t);break;case 22:t.mode&1?(Wt=(n=Wt)||t.memoizedState!==null,ei(r,e,t),Wt=n):ei(r,e,t);break;default:ei(r,e,t)}}function mg(r){var e=r.updateQueue;if(e!==null){r.updateQueue=null;var t=r.stateNode;t===null&&(t=r.stateNode=new g1),e.forEach(function(n){var i=A1.bind(null,r,n);t.has(n)||(t.add(n),n.then(i,i))})}}function Qr(r,e){var t=e.deletions;if(t!==null)for(var n=0;n<t.length;n++){var i=t[n];try{var s=r,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:Nt=o.stateNode,an=!1;break e;case 3:Nt=o.stateNode.containerInfo,an=!0;break e;case 4:Nt=o.stateNode.containerInfo,an=!0;break e}o=o.return}if(Nt===null)throw Error(ce(160));Ty(s,a,i),Nt=null,an=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){ft(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Sy(e,r),e=e.sibling}function Sy(r,e){var t=r.alternate,n=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:if(Qr(e,r),mn(r),n&4){try{Ba(3,r,r.return),Su(3,r)}catch(x){ft(r,r.return,x)}try{Ba(5,r,r.return)}catch(x){ft(r,r.return,x)}}break;case 1:Qr(e,r),mn(r),n&512&&t!==null&&Os(t,t.return);break;case 5:if(Qr(e,r),mn(r),n&512&&t!==null&&Os(t,t.return),r.flags&32){var i=r.stateNode;try{Ha(i,"")}catch(x){ft(r,r.return,x)}}if(n&4&&(i=r.stateNode,i!=null)){var s=r.memoizedProps,a=t!==null?t.memoizedProps:s,o=r.type,l=r.updateQueue;if(r.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&Gm(i,s),Nf(o,a);var u=Nf(o,s);for(a=0;a<l.length;a+=2){var c=l[a],f=l[a+1];c==="style"?qm(i,f):c==="dangerouslySetInnerHTML"?jm(i,f):c==="children"?Ha(i,f):$h(i,c,f,u)}switch(o){case"input":Rf(i,s);break;case"textarea":Wm(i,s);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var d=s.value;d!=null?Bs(i,!!s.multiple,d,!1):h!==!!s.multiple&&(s.defaultValue!=null?Bs(i,!!s.multiple,s.defaultValue,!0):Bs(i,!!s.multiple,s.multiple?[]:"",!1))}i[eo]=s}catch(x){ft(r,r.return,x)}}break;case 6:if(Qr(e,r),mn(r),n&4){if(r.stateNode===null)throw Error(ce(162));i=r.stateNode,s=r.memoizedProps;try{i.nodeValue=s}catch(x){ft(r,r.return,x)}}break;case 3:if(Qr(e,r),mn(r),n&4&&t!==null&&t.memoizedState.isDehydrated)try{Ya(e.containerInfo)}catch(x){ft(r,r.return,x)}break;case 4:Qr(e,r),mn(r);break;case 13:Qr(e,r),mn(r),i=r.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Ed=mt())),n&4&&mg(r);break;case 22:if(c=t!==null&&t.memoizedState!==null,r.mode&1?(Wt=(u=Wt)||c,Qr(e,r),Wt=u):Qr(e,r),mn(r),n&8192){if(u=r.memoizedState!==null,(r.stateNode.isHidden=u)&&!c&&(r.mode&1)!==0)for(xe=r,c=r.child;c!==null;){for(f=xe=c;xe!==null;){switch(h=xe,d=h.child,h.tag){case 0:case 11:case 14:case 15:Ba(4,h,h.return);break;case 1:Os(h,h.return);var m=h.stateNode;if(typeof m.componentWillUnmount=="function"){n=h,t=h.return;try{e=n,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(x){ft(n,t,x)}}break;case 5:Os(h,h.return);break;case 22:if(h.memoizedState!==null){yg(f);continue}}d!==null?(d.return=h,xe=d):yg(f)}c=c.sibling}e:for(c=null,f=r;;){if(f.tag===5){if(c===null){c=f;try{i=f.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=f.stateNode,l=f.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=Km("display",a))}catch(x){ft(r,r.return,x)}}}else if(f.tag===6){if(c===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(x){ft(r,r.return,x)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===r)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===r)break e;for(;f.sibling===null;){if(f.return===null||f.return===r)break e;c===f&&(c=null),f=f.return}c===f&&(c=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Qr(e,r),mn(r),n&4&&mg(r);break;case 21:break;default:Qr(e,r),mn(r)}}function mn(r){var e=r.flags;if(e&2){try{e:{for(var t=r.return;t!==null;){if(xy(t)){var n=t;break e}t=t.return}throw Error(ce(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Ha(i,""),n.flags&=-33);var s=gg(r);ch(r,s,i);break;case 3:case 4:var a=n.stateNode.containerInfo,o=gg(r);uh(r,o,a);break;default:throw Error(ce(161))}}catch(l){ft(r,r.return,l)}r.flags&=-3}e&4096&&(r.flags&=-4097)}function v1(r,e,t){xe=r,wy(r)}function wy(r,e,t){for(var n=(r.mode&1)!==0;xe!==null;){var i=xe,s=i.child;if(i.tag===22&&n){var a=i.memoizedState!==null||Zo;if(!a){var o=i.alternate,l=o!==null&&o.memoizedState!==null||Wt;o=Zo;var u=Wt;if(Zo=a,(Wt=l)&&!u)for(xe=i;xe!==null;)a=xe,l=a.child,a.tag===22&&a.memoizedState!==null?Eg(i):l!==null?(l.return=a,xe=l):Eg(i);for(;s!==null;)xe=s,wy(s),s=s.sibling;xe=i,Zo=o,Wt=u}vg(r)}else(i.subtreeFlags&8772)!==0&&s!==null?(s.return=i,xe=s):vg(r)}}function vg(r){for(;xe!==null;){var e=xe;if((e.flags&8772)!==0){var t=e.alternate;try{if((e.flags&8772)!==0)switch(e.tag){case 0:case 11:case 15:Wt||Su(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!Wt)if(t===null)n.componentDidMount();else{var i=e.elementType===e.type?t.memoizedProps:sn(e.type,t.memoizedProps);n.componentDidUpdate(i,t.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&eg(e,s,n);break;case 3:var a=e.updateQueue;if(a!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}eg(e,a,t)}break;case 5:var o=e.stateNode;if(t===null&&e.flags&4){t=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var f=c.dehydrated;f!==null&&Ya(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ce(163))}Wt||e.flags&512&&lh(e)}catch(h){ft(e,e.return,h)}}if(e===r){xe=null;break}if(t=e.sibling,t!==null){t.return=e.return,xe=t;break}xe=e.return}}function yg(r){for(;xe!==null;){var e=xe;if(e===r){xe=null;break}var t=e.sibling;if(t!==null){t.return=e.return,xe=t;break}xe=e.return}}function Eg(r){for(;xe!==null;){var e=xe;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{Su(4,e)}catch(l){ft(e,t,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(l){ft(e,i,l)}}var s=e.return;try{lh(e)}catch(l){ft(e,s,l)}break;case 5:var a=e.return;try{lh(e)}catch(l){ft(e,a,l)}}}catch(l){ft(e,e.return,l)}if(e===r){xe=null;break}var o=e.sibling;if(o!==null){o.return=e.return,xe=o;break}xe=e.return}}var y1=Math.ceil,Zl=Zn.ReactCurrentDispatcher,vd=Zn.ReactCurrentOwner,Vr=Zn.ReactCurrentBatchConfig,Ue=0,Rt=null,Et=null,Mt=0,_r=0,Ns=Di(0),_t=0,ao=null,Ki=0,wu=0,yd=0,Ua=null,ur=null,Ed=0,Zs=1/0,Fn=null,Ql=!1,fh=null,xi=null,Qo=!1,di=null,Jl=0,$a=0,hh=null,bl=-1,Dl=0;function Qt(){return(Ue&6)!==0?mt():bl!==-1?bl:bl=mt()}function Ti(r){return(r.mode&1)===0?1:(Ue&2)!==0&&Mt!==0?Mt&-Mt:t1.transition!==null?(Dl===0&&(Dl=av()),Dl):(r=je,r!==0||(r=window.event,r=r===void 0?16:dv(r.type)),r)}function hn(r,e,t,n){if(50<$a)throw $a=0,hh=null,Error(ce(185));mo(r,t,n),((Ue&2)===0||r!==Rt)&&(r===Rt&&((Ue&2)===0&&(wu|=t),_t===4&&fi(r,Mt)),mr(r,n),t===1&&Ue===0&&(e.mode&1)===0&&(Zs=mt()+500,Eu&&Ci()))}function mr(r,e){var t=r.callbackNode;tS(r,e);var n=Fl(r,r===Rt?Mt:0);if(n===0)t!==null&&Cp(t),r.callbackNode=null,r.callbackPriority=0;else if(e=n&-n,r.callbackPriority!==e){if(t!=null&&Cp(t),e===1)r.tag===0?e1(xg.bind(null,r)):kv(xg.bind(null,r)),XS(function(){(Ue&6)===0&&Ci()}),t=null;else{switch(ov(n)){case 1:t=Hh;break;case 4:t=iv;break;case 16:t=Pl;break;case 536870912:t=sv;break;default:t=Pl}t=Iy(t,_y.bind(null,r))}r.callbackPriority=e,r.callbackNode=t}}function _y(r,e){if(bl=-1,Dl=0,(Ue&6)!==0)throw Error(ce(327));var t=r.callbackNode;if(Gs()&&r.callbackNode!==t)return null;var n=Fl(r,r===Rt?Mt:0);if(n===0)return null;if((n&30)!==0||(n&r.expiredLanes)!==0||e)e=eu(r,n);else{e=n;var i=Ue;Ue|=2;var s=by();(Rt!==r||Mt!==e)&&(Fn=null,Zs=mt()+500,zi(r,e));do try{T1();break}catch(o){Ay(r,o)}while(1);id(),Zl.current=s,Ue=i,Et!==null?e=0:(Rt=null,Mt=0,e=_t)}if(e!==0){if(e===2&&(i=Uf(r),i!==0&&(n=i,e=dh(r,i))),e===1)throw t=ao,zi(r,0),fi(r,n),mr(r,mt()),t;if(e===6)fi(r,n);else{if(i=r.current.alternate,(n&30)===0&&!E1(i)&&(e=eu(r,n),e===2&&(s=Uf(r),s!==0&&(n=s,e=dh(r,s))),e===1))throw t=ao,zi(r,0),fi(r,n),mr(r,mt()),t;switch(r.finishedWork=i,r.finishedLanes=n,e){case 0:case 1:throw Error(ce(345));case 2:Pi(r,ur,Fn);break;case 3:if(fi(r,n),(n&130023424)===n&&(e=Ed+500-mt(),10<e)){if(Fl(r,0)!==0)break;if(i=r.suspendedLanes,(i&n)!==n){Qt(),r.pingedLanes|=r.suspendedLanes&i;break}r.timeoutHandle=Kf(Pi.bind(null,r,ur,Fn),e);break}Pi(r,ur,Fn);break;case 4:if(fi(r,n),(n&4194240)===n)break;for(e=r.eventTimes,i=-1;0<n;){var a=31-fn(n);s=1<<a,a=e[a],a>i&&(i=a),n&=~s}if(n=i,n=mt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*y1(n/1960))-n,10<n){r.timeoutHandle=Kf(Pi.bind(null,r,ur,Fn),n);break}Pi(r,ur,Fn);break;case 5:Pi(r,ur,Fn);break;default:throw Error(ce(329))}}}return mr(r,mt()),r.callbackNode===t?_y.bind(null,r):null}function dh(r,e){var t=Ua;return r.current.memoizedState.isDehydrated&&(zi(r,e).flags|=256),r=eu(r,e),r!==2&&(e=ur,ur=t,e!==null&&ph(e)),r}function ph(r){ur===null?ur=r:ur.push.apply(ur,r)}function E1(r){for(var e=r;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var n=0;n<t.length;n++){var i=t[n],s=i.getSnapshot;i=i.value;try{if(!pn(s(),i))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===r)break;for(;e.sibling===null;){if(e.return===null||e.return===r)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function fi(r,e){for(e&=~yd,e&=~wu,r.suspendedLanes|=e,r.pingedLanes&=~e,r=r.expirationTimes;0<e;){var t=31-fn(e),n=1<<t;r[t]=-1,e&=~n}}function xg(r){if((Ue&6)!==0)throw Error(ce(327));Gs();var e=Fl(r,0);if((e&1)===0)return mr(r,mt()),null;var t=eu(r,e);if(r.tag!==0&&t===2){var n=Uf(r);n!==0&&(e=n,t=dh(r,n))}if(t===1)throw t=ao,zi(r,0),fi(r,e),mr(r,mt()),t;if(t===6)throw Error(ce(345));return r.finishedWork=r.current.alternate,r.finishedLanes=e,Pi(r,ur,Fn),mr(r,mt()),null}function xd(r,e){var t=Ue;Ue|=1;try{return r(e)}finally{Ue=t,Ue===0&&(Zs=mt()+500,Eu&&Ci())}}function qi(r){di!==null&&di.tag===0&&(Ue&6)===0&&Gs();var e=Ue;Ue|=1;var t=Vr.transition,n=je;try{if(Vr.transition=null,je=1,r)return r()}finally{je=n,Vr.transition=t,Ue=e,(Ue&6)===0&&Ci()}}function Td(){_r=Ns.current,et(Ns)}function zi(r,e){r.finishedWork=null,r.finishedLanes=0;var t=r.timeoutHandle;if(t!==-1&&(r.timeoutHandle=-1,YS(t)),Et!==null)for(t=Et.return;t!==null;){var n=t;switch(td(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&zl();break;case 3:Ys(),et(pr),et(Ht),cd();break;case 5:ud(n);break;case 4:Ys();break;case 13:et(at);break;case 19:et(at);break;case 10:sd(n.type._context);break;case 22:case 23:Td()}t=t.return}if(Rt=r,Et=r=Si(r.current,null),Mt=_r=e,_t=0,ao=null,yd=wu=Ki=0,ur=Ua=null,Ui!==null){for(e=0;e<Ui.length;e++)if(t=Ui[e],n=t.interleaved,n!==null){t.interleaved=null;var i=n.next,s=t.pending;if(s!==null){var a=s.next;s.next=i,n.next=a}t.pending=n}Ui=null}return r}function Ay(r,e){do{var t=Et;try{if(id(),wl.current=Xl,Yl){for(var n=lt.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Yl=!1}if(ji=0,Ct=wt=lt=null,Ma=!1,no=0,vd.current=null,t===null||t.return===null){_t=1,ao=e,Et=null;break}e:{var s=r,a=t.return,o=t,l=e;if(e=Mt,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=o,f=c.tag;if((c.mode&1)===0&&(f===0||f===11||f===15)){var h=c.alternate;h?(c.updateQueue=h.updateQueue,c.memoizedState=h.memoizedState,c.lanes=h.lanes):(c.updateQueue=null,c.memoizedState=null)}var d=og(a);if(d!==null){d.flags&=-257,lg(d,a,o,s,e),d.mode&1&&ag(s,u,e),e=d,l=u;var m=e.updateQueue;if(m===null){var x=new Set;x.add(l),e.updateQueue=x}else m.add(l);break e}else{if((e&1)===0){ag(s,u,e),Sd();break e}l=Error(ce(426))}}else if(it&&o.mode&1){var p=og(a);if(p!==null){(p.flags&65536)===0&&(p.flags|=256),lg(p,a,o,s,e),rd(Xs(l,o));break e}}s=l=Xs(l,o),_t!==4&&(_t=2),Ua===null?Ua=[s]:Ua.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var g=ly(s,l,e);Jp(s,g);break e;case 1:o=l;var v=s.type,E=s.stateNode;if((s.flags&128)===0&&(typeof v.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(xi===null||!xi.has(E)))){s.flags|=65536,e&=-e,s.lanes|=e;var S=uy(s,o,e);Jp(s,S);break e}}s=s.return}while(s!==null)}Cy(t)}catch(T){e=T,Et===t&&t!==null&&(Et=t=t.return);continue}break}while(1)}function by(){var r=Zl.current;return Zl.current=Xl,r===null?Xl:r}function Sd(){(_t===0||_t===3||_t===2)&&(_t=4),Rt===null||(Ki&268435455)===0&&(wu&268435455)===0||fi(Rt,Mt)}function eu(r,e){var t=Ue;Ue|=2;var n=by();(Rt!==r||Mt!==e)&&(Fn=null,zi(r,e));do try{x1();break}catch(i){Ay(r,i)}while(1);if(id(),Ue=t,Zl.current=n,Et!==null)throw Error(ce(261));return Rt=null,Mt=0,_t}function x1(){for(;Et!==null;)Dy(Et)}function T1(){for(;Et!==null&&!jT();)Dy(Et)}function Dy(r){var e=Ly(r.alternate,r,_r);r.memoizedProps=r.pendingProps,e===null?Cy(r):Et=e,vd.current=null}function Cy(r){var e=r;do{var t=e.alternate;if(r=e.return,(e.flags&32768)===0){if(t=d1(t,e,_r),t!==null){Et=t;return}}else{if(t=p1(t,e),t!==null){t.flags&=32767,Et=t;return}if(r!==null)r.flags|=32768,r.subtreeFlags=0,r.deletions=null;else{_t=6,Et=null;return}}if(e=e.sibling,e!==null){Et=e;return}Et=e=r}while(e!==null);_t===0&&(_t=5)}function Pi(r,e,t){var n=je,i=Vr.transition;try{Vr.transition=null,je=1,S1(r,e,t,n)}finally{Vr.transition=i,je=n}return null}function S1(r,e,t,n){do Gs();while(di!==null);if((Ue&6)!==0)throw Error(ce(327));t=r.finishedWork;var i=r.finishedLanes;if(t===null)return null;if(r.finishedWork=null,r.finishedLanes=0,t===r.current)throw Error(ce(177));r.callbackNode=null,r.callbackPriority=0;var s=t.lanes|t.childLanes;if(rS(r,s),r===Rt&&(Et=Rt=null,Mt=0),(t.subtreeFlags&2064)===0&&(t.flags&2064)===0||Qo||(Qo=!0,Iy(Pl,function(){return Gs(),null})),s=(t.flags&15990)!==0,(t.subtreeFlags&15990)!==0||s){s=Vr.transition,Vr.transition=null;var a=je;je=1;var o=Ue;Ue|=4,vd.current=null,m1(r,t),Sy(t,r),VS(Hf),Ml=!!Wf,Hf=Wf=null,r.current=t,v1(t),KT(),Ue=o,je=a,Vr.transition=s}else r.current=t;if(Qo&&(Qo=!1,di=r,Jl=i),s=r.pendingLanes,s===0&&(xi=null),XT(t.stateNode),mr(r,mt()),e!==null)for(n=r.onRecoverableError,t=0;t<e.length;t++)i=e[t],n(i.value,{componentStack:i.stack,digest:i.digest});if(Ql)throw Ql=!1,r=fh,fh=null,r;return(Jl&1)!==0&&r.tag!==0&&Gs(),s=r.pendingLanes,(s&1)!==0?r===hh?$a++:($a=0,hh=r):$a=0,Ci(),null}function Gs(){if(di!==null){var r=ov(Jl),e=Vr.transition,t=je;try{if(Vr.transition=null,je=16>r?16:r,di===null)var n=!1;else{if(r=di,di=null,Jl=0,(Ue&6)!==0)throw Error(ce(331));var i=Ue;for(Ue|=4,xe=r.current;xe!==null;){var s=xe,a=s.child;if((xe.flags&16)!==0){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(xe=u;xe!==null;){var c=xe;switch(c.tag){case 0:case 11:case 15:Ba(8,c,s)}var f=c.child;if(f!==null)f.return=c,xe=f;else for(;xe!==null;){c=xe;var h=c.sibling,d=c.return;if(Ey(c),c===u){xe=null;break}if(h!==null){h.return=d,xe=h;break}xe=d}}}var m=s.alternate;if(m!==null){var x=m.child;if(x!==null){m.child=null;do{var p=x.sibling;x.sibling=null,x=p}while(x!==null)}}xe=s}}if((s.subtreeFlags&2064)!==0&&a!==null)a.return=s,xe=a;else e:for(;xe!==null;){if(s=xe,(s.flags&2048)!==0)switch(s.tag){case 0:case 11:case 15:Ba(9,s,s.return)}var g=s.sibling;if(g!==null){g.return=s.return,xe=g;break e}xe=s.return}}var v=r.current;for(xe=v;xe!==null;){a=xe;var E=a.child;if((a.subtreeFlags&2064)!==0&&E!==null)E.return=a,xe=E;else e:for(a=v;xe!==null;){if(o=xe,(o.flags&2048)!==0)try{switch(o.tag){case 0:case 11:case 15:Su(9,o)}}catch(T){ft(o,o.return,T)}if(o===a){xe=null;break e}var S=o.sibling;if(S!==null){S.return=o.return,xe=S;break e}xe=o.return}}if(Ue=i,Ci(),wn&&typeof wn.onPostCommitFiberRoot=="function")try{wn.onPostCommitFiberRoot(pu,r)}catch{}n=!0}return n}finally{je=t,Vr.transition=e}}return!1}function Tg(r,e,t){e=Xs(t,e),e=ly(r,e,1),r=Ei(r,e,1),e=Qt(),r!==null&&(mo(r,1,e),mr(r,e))}function ft(r,e,t){if(r.tag===3)Tg(r,r,t);else for(;e!==null;){if(e.tag===3){Tg(e,r,t);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(xi===null||!xi.has(n))){r=Xs(t,r),r=uy(e,r,1),e=Ei(e,r,1),r=Qt(),e!==null&&(mo(e,1,r),mr(e,r));break}}e=e.return}}function w1(r,e,t){var n=r.pingCache;n!==null&&n.delete(e),e=Qt(),r.pingedLanes|=r.suspendedLanes&t,Rt===r&&(Mt&t)===t&&(_t===4||_t===3&&(Mt&130023424)===Mt&&500>mt()-Ed?zi(r,0):yd|=t),mr(r,e)}function Ry(r,e){e===0&&((r.mode&1)===0?e=1:(e=Vo,Vo<<=1,(Vo&130023424)===0&&(Vo=4194304)));var t=Qt();r=Kn(r,e),r!==null&&(mo(r,e,t),mr(r,t))}function _1(r){var e=r.memoizedState,t=0;e!==null&&(t=e.retryLane),Ry(r,t)}function A1(r,e){var t=0;switch(r.tag){case 13:var n=r.stateNode,i=r.memoizedState;i!==null&&(t=i.retryLane);break;case 19:n=r.stateNode;break;default:throw Error(ce(314))}n!==null&&n.delete(e),Ry(r,t)}var Ly;Ly=function(r,e,t){if(r!==null)if(r.memoizedProps!==e.pendingProps||pr.current)dr=!0;else{if((r.lanes&t)===0&&(e.flags&128)===0)return dr=!1,h1(r,e,t);dr=(r.flags&131072)!==0}else dr=!1,it&&(e.flags&1048576)!==0&&Ov(e,Wl,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;Al(r,e),r=e.pendingProps;var i=js(e,Ht.current);Vs(e,t),i=hd(null,e,n,r,i,t);var s=dd();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,gr(n)?(s=!0,Vl(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,od(e),i.updater=xu,e.stateNode=i,i._reactInternals=e,eh(e,n,r,t),e=nh(null,e,n,!0,s,t)):(e.tag=0,it&&s&&ed(e),Zt(null,e,i,t),e=e.child),e;case 16:n=e.elementType;e:{switch(Al(r,e),r=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=D1(n),r=sn(n,r),i){case 0:e=rh(null,e,n,r,t);break e;case 1:e=fg(null,e,n,r,t);break e;case 11:e=ug(null,e,n,r,t);break e;case 14:e=cg(null,e,n,sn(n.type,r),t);break e}throw Error(ce(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:sn(n,i),rh(r,e,n,i,t);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:sn(n,i),fg(r,e,n,i,t);case 3:e:{if(dy(e),r===null)throw Error(ce(387));n=e.pendingProps,s=e.memoizedState,i=s.element,Mv(r,e),Kl(e,n,null,t);var a=e.memoizedState;if(n=a.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Xs(Error(ce(423)),e),e=hg(r,e,n,t,i);break e}else if(n!==i){i=Xs(Error(ce(424)),e),e=hg(r,e,n,t,i);break e}else for(Ar=yi(e.stateNode.containerInfo.firstChild),br=e,it=!0,on=null,t=zv(e,null,n,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(Ks(),n===i){e=qn(r,e,t);break e}Zt(r,e,n,t)}e=e.child}return e;case 5:return Vv(e),r===null&&Zf(e),n=e.type,i=e.pendingProps,s=r!==null?r.memoizedProps:null,a=i.children,jf(n,i)?a=null:s!==null&&jf(n,s)&&(e.flags|=32),hy(r,e),Zt(r,e,a,t),e.child;case 6:return r===null&&Zf(e),null;case 13:return py(r,e,t);case 4:return ld(e,e.stateNode.containerInfo),n=e.pendingProps,r===null?e.child=qs(e,null,n,t):Zt(r,e,n,t),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:sn(n,i),ug(r,e,n,i,t);case 7:return Zt(r,e,e.pendingProps,t),e.child;case 8:return Zt(r,e,e.pendingProps.children,t),e.child;case 12:return Zt(r,e,e.pendingProps.children,t),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,s=e.memoizedProps,a=i.value,Ze(Hl,n._currentValue),n._currentValue=a,s!==null)if(pn(s.value,a)){if(s.children===i.children&&!pr.current){e=qn(r,e,t);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=Gn(-1,t&-t),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}s.lanes|=t,l=s.alternate,l!==null&&(l.lanes|=t),Qf(s.return,t,e),o.lanes|=t;break}l=l.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(ce(341));a.lanes|=t,o=a.alternate,o!==null&&(o.lanes|=t),Qf(a,t,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}Zt(r,e,i.children,t),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,Vs(e,t),i=Gr(i),n=n(i),e.flags|=1,Zt(r,e,n,t),e.child;case 14:return n=e.type,i=sn(n,e.pendingProps),i=sn(n.type,i),cg(r,e,n,i,t);case 15:return cy(r,e,e.type,e.pendingProps,t);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:sn(n,i),Al(r,e),e.tag=1,gr(n)?(r=!0,Vl(e)):r=!1,Vs(e,t),Uv(e,n,i),eh(e,n,i,t),nh(null,e,n,!0,r,t);case 19:return gy(r,e,t);case 22:return fy(r,e,t)}throw Error(ce(156,e.tag))};function Iy(r,e){return nv(r,e)}function b1(r,e,t,n){this.tag=r,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function zr(r,e,t,n){return new b1(r,e,t,n)}function wd(r){return r=r.prototype,!(!r||!r.isReactComponent)}function D1(r){if(typeof r=="function")return wd(r)?1:0;if(r!=null){if(r=r.$$typeof,r===Vh)return 11;if(r===Gh)return 14}return 2}function Si(r,e){var t=r.alternate;return t===null?(t=zr(r.tag,e,r.key,r.mode),t.elementType=r.elementType,t.type=r.type,t.stateNode=r.stateNode,t.alternate=r,r.alternate=t):(t.pendingProps=e,t.type=r.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=r.flags&14680064,t.childLanes=r.childLanes,t.lanes=r.lanes,t.child=r.child,t.memoizedProps=r.memoizedProps,t.memoizedState=r.memoizedState,t.updateQueue=r.updateQueue,e=r.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=r.sibling,t.index=r.index,t.ref=r.ref,t}function Cl(r,e,t,n,i,s){var a=2;if(n=r,typeof r=="function")wd(r)&&(a=1);else if(typeof r=="string")a=5;else e:switch(r){case _s:return Vi(t.children,i,s,e);case zh:a=8,i|=8;break;case _f:return r=zr(12,t,e,i|2),r.elementType=_f,r.lanes=s,r;case Af:return r=zr(13,t,e,i),r.elementType=Af,r.lanes=s,r;case bf:return r=zr(19,t,e,i),r.elementType=bf,r.lanes=s,r;case $m:return _u(t,i,s,e);default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case Bm:a=10;break e;case Um:a=9;break e;case Vh:a=11;break e;case Gh:a=14;break e;case ai:a=16,n=null;break e}throw Error(ce(130,r==null?r:typeof r,""))}return e=zr(a,t,e,i),e.elementType=r,e.type=n,e.lanes=s,e}function Vi(r,e,t,n){return r=zr(7,r,n,e),r.lanes=t,r}function _u(r,e,t,n){return r=zr(22,r,n,e),r.elementType=$m,r.lanes=t,r.stateNode={isHidden:!1},r}function Oc(r,e,t){return r=zr(6,r,null,e),r.lanes=t,r}function Nc(r,e,t){return e=zr(4,r.children!==null?r.children:[],r.key,e),e.lanes=t,e.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},e}function C1(r,e,t,n,i){this.tag=e,this.containerInfo=r,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=pc(0),this.expirationTimes=pc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=pc(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function _d(r,e,t,n,i,s,a,o,l){return r=new C1(r,e,t,o,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=zr(3,null,null,e),r.current=s,s.stateNode=r,s.memoizedState={element:n,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},od(s),r}function R1(r,e,t){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ws,key:n==null?null:""+n,children:r,containerInfo:e,implementation:t}}function ky(r){if(!r)return _i;r=r._reactInternals;e:{if(es(r)!==r||r.tag!==1)throw Error(ce(170));var e=r;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(gr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ce(171))}if(r.tag===1){var t=r.type;if(gr(t))return Iv(r,t,e)}return e}function Oy(r,e,t,n,i,s,a,o,l){return r=_d(t,n,!0,r,i,s,a,o,l),r.context=ky(null),t=r.current,n=Qt(),i=Ti(t),s=Gn(n,i),s.callback=e!=null?e:null,Ei(t,s,i),r.current.lanes=i,mo(r,i,n),mr(r,n),r}function Au(r,e,t,n){var i=e.current,s=Qt(),a=Ti(i);return t=ky(t),e.context===null?e.context=t:e.pendingContext=t,e=Gn(s,a),e.payload={element:r},n=n===void 0?null:n,n!==null&&(e.callback=n),r=Ei(i,e,a),r!==null&&(hn(r,i,a,s),Sl(r,i,a)),a}function tu(r){if(r=r.current,!r.child)return null;switch(r.child.tag){case 5:return r.child.stateNode;default:return r.child.stateNode}}function Sg(r,e){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var t=r.retryLane;r.retryLane=t!==0&&t<e?t:e}}function Ad(r,e){Sg(r,e),(r=r.alternate)&&Sg(r,e)}function L1(){return null}var Ny=typeof reportError=="function"?reportError:function(r){console.error(r)};function bd(r){this._internalRoot=r}bu.prototype.render=bd.prototype.render=function(r){var e=this._internalRoot;if(e===null)throw Error(ce(409));Au(r,e,null,null)};bu.prototype.unmount=bd.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var e=r.containerInfo;qi(function(){Au(null,r,null,null)}),e[jn]=null}};function bu(r){this._internalRoot=r}bu.prototype.unstable_scheduleHydration=function(r){if(r){var e=cv();r={blockedOn:null,target:r,priority:e};for(var t=0;t<ci.length&&e!==0&&e<ci[t].priority;t++);ci.splice(t,0,r),t===0&&hv(r)}};function Dd(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function Du(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11&&(r.nodeType!==8||r.nodeValue!==" react-mount-point-unstable "))}function wg(){}function I1(r,e,t,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var u=tu(a);s.call(u)}}var a=Oy(e,n,r,0,null,!1,!1,"",wg);return r._reactRootContainer=a,r[jn]=a.current,Qa(r.nodeType===8?r.parentNode:r),qi(),a}for(;i=r.lastChild;)r.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var u=tu(l);o.call(u)}}var l=_d(r,0,!1,null,null,!1,!1,"",wg);return r._reactRootContainer=l,r[jn]=l.current,Qa(r.nodeType===8?r.parentNode:r),qi(function(){Au(e,l,t,n)}),l}function Cu(r,e,t,n,i){var s=t._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var l=tu(a);o.call(l)}}Au(e,a,r,i)}else a=I1(t,e,r,i,n);return tu(a)}lv=function(r){switch(r.tag){case 3:var e=r.stateNode;if(e.current.memoizedState.isDehydrated){var t=La(e.pendingLanes);t!==0&&(jh(e,t|1),mr(e,mt()),(Ue&6)===0&&(Zs=mt()+500,Ci()))}break;case 13:qi(function(){var n=Kn(r,1);if(n!==null){var i=Qt();hn(n,r,1,i)}}),Ad(r,1)}};Kh=function(r){if(r.tag===13){var e=Kn(r,134217728);if(e!==null){var t=Qt();hn(e,r,134217728,t)}Ad(r,134217728)}};uv=function(r){if(r.tag===13){var e=Ti(r),t=Kn(r,e);if(t!==null){var n=Qt();hn(t,r,e,n)}Ad(r,e)}};cv=function(){return je};fv=function(r,e){var t=je;try{return je=r,e()}finally{je=t}};Ff=function(r,e,t){switch(e){case"input":if(Rf(r,t),e=t.name,t.type==="radio"&&e!=null){for(t=r;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var n=t[e];if(n!==r&&n.form===r.form){var i=yu(n);if(!i)throw Error(ce(90));Vm(n),Rf(n,i)}}}break;case"textarea":Wm(r,t);break;case"select":e=t.value,e!=null&&Bs(r,!!t.multiple,e,!1)}};Zm=xd;Qm=qi;var k1={usingClientEntryPoint:!1,Events:[yo,Cs,yu,Ym,Xm,xd]},ya={findFiberByHostInstance:Bi,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},O1={bundleType:ya.bundleType,version:ya.version,rendererPackageName:ya.rendererPackageName,rendererConfig:ya.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Zn.ReactCurrentDispatcher,findHostInstanceByFiber:function(r){return r=tv(r),r===null?null:r.stateNode},findFiberByHostInstance:ya.findFiberByHostInstance||L1,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Jo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Jo.isDisabled&&Jo.supportsFiber)try{pu=Jo.inject(O1),wn=Jo}catch{}}Cr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=k1;Cr.createPortal=function(r,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Dd(e))throw Error(ce(200));return R1(r,e,null,t)};Cr.createRoot=function(r,e){if(!Dd(r))throw Error(ce(299));var t=!1,n="",i=Ny;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=_d(r,1,!1,null,null,t,!1,n,i),r[jn]=e.current,Qa(r.nodeType===8?r.parentNode:r),new bd(e)};Cr.findDOMNode=function(r){if(r==null)return null;if(r.nodeType===1)return r;var e=r._reactInternals;if(e===void 0)throw typeof r.render=="function"?Error(ce(188)):(r=Object.keys(r).join(","),Error(ce(268,r)));return r=tv(e),r=r===null?null:r.stateNode,r};Cr.flushSync=function(r){return qi(r)};Cr.hydrate=function(r,e,t){if(!Du(e))throw Error(ce(200));return Cu(null,r,e,!0,t)};Cr.hydrateRoot=function(r,e,t){if(!Dd(r))throw Error(ce(405));var n=t!=null&&t.hydratedSources||null,i=!1,s="",a=Ny;if(t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),e=Oy(e,null,r,1,t!=null?t:null,i,!1,s,a),r[jn]=e.current,Qa(r),n)for(r=0;r<n.length;r++)t=n[r],i=t._getVersion,i=i(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,i]:e.mutableSourceEagerHydrationData.push(t,i);return new bu(e)};Cr.render=function(r,e,t){if(!Du(e))throw Error(ce(200));return Cu(null,r,e,!1,t)};Cr.unmountComponentAtNode=function(r){if(!Du(r))throw Error(ce(40));return r._reactRootContainer?(qi(function(){Cu(null,null,r,!1,function(){r._reactRootContainer=null,r[jn]=null})}),!0):!1};Cr.unstable_batchedUpdates=xd;Cr.unstable_renderSubtreeIntoContainer=function(r,e,t,n){if(!Du(t))throw Error(ce(200));if(r==null||r._reactInternals===void 0)throw Error(ce(38));return Cu(r,e,t,!1,n)};Cr.version="18.2.0-next-9e3b772b8-20220608";(function(r){function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}e(),r.exports=Cr})(Om);var _g=Om.exports;Sf.createRoot=_g.createRoot,Sf.hydrateRoot=_g.hydrateRoot;function N1(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Py={exports:{}};(function(r,e){(function(t){var n=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,i=/^(?=([^\/?#]*))\1([^]*)$/,s=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,o={buildAbsoluteURL:function(l,u,c){if(c=c||{},l=l.trim(),u=u.trim(),!u){if(!c.alwaysNormalize)return l;var f=o.parseURL(l);if(!f)throw new Error("Error trying to parse base URL.");return f.path=o.normalizePath(f.path),o.buildURLFromParts(f)}var h=o.parseURL(u);if(!h)throw new Error("Error trying to parse relative URL.");if(h.scheme)return c.alwaysNormalize?(h.path=o.normalizePath(h.path),o.buildURLFromParts(h)):u;var d=o.parseURL(l);if(!d)throw new Error("Error trying to parse base URL.");if(!d.netLoc&&d.path&&d.path[0]!=="/"){var m=i.exec(d.path);d.netLoc=m[1],d.path=m[2]}d.netLoc&&!d.path&&(d.path="/");var x={scheme:d.scheme,netLoc:h.netLoc,path:null,params:h.params,query:h.query,fragment:h.fragment};if(!h.netLoc&&(x.netLoc=d.netLoc,h.path[0]!=="/"))if(!h.path)x.path=d.path,h.params||(x.params=d.params,h.query||(x.query=d.query));else{var p=d.path,g=p.substring(0,p.lastIndexOf("/")+1)+h.path;x.path=o.normalizePath(g)}return x.path===null&&(x.path=c.alwaysNormalize?o.normalizePath(h.path):h.path),o.buildURLFromParts(x)},parseURL:function(l){var u=n.exec(l);return u?{scheme:u[1]||"",netLoc:u[2]||"",path:u[3]||"",params:u[4]||"",query:u[5]||"",fragment:u[6]||""}:null},normalizePath:function(l){for(l=l.split("").reverse().join("").replace(s,"");l.length!==(l=l.replace(a,"")).length;);return l.split("").reverse().join("")},buildURLFromParts:function(l){return l.scheme+l.netLoc+l.path+l.params+l.query+l.fragment}};r.exports=o})()})(Py);var Cd=Py.exports;function Ag(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function vr(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Ag(Object(t),!0).forEach(function(n){P1(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Ag(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function P1(r,e,t){return e=M1(e),e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function At(){return At=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},At.apply(this,arguments)}function F1(r,e){if(typeof r!="object"||r===null)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function M1(r){var e=F1(r,"string");return typeof e=="symbol"?e:String(e)}const _e=Number.isFinite||function(r){return typeof r=="number"&&isFinite(r)};let A=function(r){return r.MEDIA_ATTACHING="hlsMediaAttaching",r.MEDIA_ATTACHED="hlsMediaAttached",r.MEDIA_DETACHING="hlsMediaDetaching",r.MEDIA_DETACHED="hlsMediaDetached",r.BUFFER_RESET="hlsBufferReset",r.BUFFER_CODECS="hlsBufferCodecs",r.BUFFER_CREATED="hlsBufferCreated",r.BUFFER_APPENDING="hlsBufferAppending",r.BUFFER_APPENDED="hlsBufferAppended",r.BUFFER_EOS="hlsBufferEos",r.BUFFER_FLUSHING="hlsBufferFlushing",r.BUFFER_FLUSHED="hlsBufferFlushed",r.MANIFEST_LOADING="hlsManifestLoading",r.MANIFEST_LOADED="hlsManifestLoaded",r.MANIFEST_PARSED="hlsManifestParsed",r.LEVEL_SWITCHING="hlsLevelSwitching",r.LEVEL_SWITCHED="hlsLevelSwitched",r.LEVEL_LOADING="hlsLevelLoading",r.LEVEL_LOADED="hlsLevelLoaded",r.LEVEL_UPDATED="hlsLevelUpdated",r.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",r.LEVELS_UPDATED="hlsLevelsUpdated",r.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",r.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",r.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",r.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",r.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",r.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",r.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",r.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",r.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",r.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",r.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",r.CUES_PARSED="hlsCuesParsed",r.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",r.INIT_PTS_FOUND="hlsInitPtsFound",r.FRAG_LOADING="hlsFragLoading",r.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",r.FRAG_LOADED="hlsFragLoaded",r.FRAG_DECRYPTED="hlsFragDecrypted",r.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",r.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",r.FRAG_PARSING_METADATA="hlsFragParsingMetadata",r.FRAG_PARSED="hlsFragParsed",r.FRAG_BUFFERED="hlsFragBuffered",r.FRAG_CHANGED="hlsFragChanged",r.FPS_DROP="hlsFpsDrop",r.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",r.ERROR="hlsError",r.DESTROYING="hlsDestroying",r.KEY_LOADING="hlsKeyLoading",r.KEY_LOADED="hlsKeyLoaded",r.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",r.BACK_BUFFER_REACHED="hlsBackBufferReached",r}({}),be=function(r){return r.NETWORK_ERROR="networkError",r.MEDIA_ERROR="mediaError",r.KEY_SYSTEM_ERROR="keySystemError",r.MUX_ERROR="muxError",r.OTHER_ERROR="otherError",r}({}),J=function(r){return r.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",r.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",r.KEY_SYSTEM_NO_SESSION="keySystemNoSession",r.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",r.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",r.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",r.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",r.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",r.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",r.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",r.MANIFEST_LOAD_ERROR="manifestLoadError",r.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",r.MANIFEST_PARSING_ERROR="manifestParsingError",r.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",r.LEVEL_EMPTY_ERROR="levelEmptyError",r.LEVEL_LOAD_ERROR="levelLoadError",r.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",r.LEVEL_PARSING_ERROR="levelParsingError",r.LEVEL_SWITCH_ERROR="levelSwitchError",r.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",r.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",r.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",r.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",r.FRAG_LOAD_ERROR="fragLoadError",r.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",r.FRAG_DECRYPT_ERROR="fragDecryptError",r.FRAG_PARSING_ERROR="fragParsingError",r.FRAG_GAP="fragGap",r.REMUX_ALLOC_ERROR="remuxAllocError",r.KEY_LOAD_ERROR="keyLoadError",r.KEY_LOAD_TIMEOUT="keyLoadTimeOut",r.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",r.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",r.BUFFER_APPEND_ERROR="bufferAppendError",r.BUFFER_APPENDING_ERROR="bufferAppendingError",r.BUFFER_STALLED_ERROR="bufferStalledError",r.BUFFER_FULL_ERROR="bufferFullError",r.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",r.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",r.INTERNAL_EXCEPTION="internalException",r.INTERNAL_ABORTED="aborted",r.UNKNOWN="unknown",r}({});const Fi=function(){},gh={trace:Fi,debug:Fi,log:Fi,warn:Fi,info:Fi,error:Fi};let za=gh;function B1(r){const e=self.console[r];return e?e.bind(self.console,`[${r}] >`):Fi}function U1(r,...e){e.forEach(function(t){za[t]=r[t]?r[t].bind(r):B1(t)})}function $1(r,e){if(self.console&&r===!0||typeof r=="object"){U1(r,"debug","log","info","warn","error");try{za.log(`Debug logs enabled for "${e}" in hls.js version 1.4.4`)}catch{za=gh}}else za=gh}const G=za,z1=/^(\d+)x(\d+)$/,bg=/(.+?)=(".*?"|.*?)(?:,|$)/g;class st{constructor(e){typeof e=="string"&&(e=st.parseAttrList(e));for(const t in e)e.hasOwnProperty(t)&&(t.substring(0,2)==="X-"&&(this.clientAttrs=this.clientAttrs||[],this.clientAttrs.push(t)),this[t]=e[t])}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(t.length&1?"0":"")+t;const n=new Uint8Array(t.length/2);for(let i=0;i<t.length/2;i++)n[i]=parseInt(t.slice(i*2,i*2+2),16);return n}else return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const n=this[e];return n?parseFloat(n):t}enumeratedString(e){return this[e]}bool(e){return this[e]==="YES"}decimalResolution(e){const t=z1.exec(this[e]);if(t!==null)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e){let t;const n={},i='"';for(bg.lastIndex=0;(t=bg.exec(e))!==null;){let s=t[2];s.indexOf(i)===0&&s.lastIndexOf(i)===s.length-1&&(s=s.slice(1,-1));const a=t[1].trim();n[a]=s}return n}}function V1(r){return r!=="ID"&&r!=="CLASS"&&r!=="START-DATE"&&r!=="DURATION"&&r!=="END-DATE"&&r!=="END-ON-NEXT"}function G1(r){return r==="SCTE35-OUT"||r==="SCTE35-IN"}class Fy{constructor(e,t){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,t){const n=t.attr;for(const i in n)if(Object.prototype.hasOwnProperty.call(e,i)&&e[i]!==n[i]){G.warn(`DATERANGE tag attribute: "${i}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=i;break}e=At(new st({}),n,e)}if(this.attr=e,this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const n=new Date(this.attr["END-DATE"]);_e(n.getTime())&&(this._endDate=n)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get startDate(){return this._startDate}get endDate(){if(this._endDate)return this._endDate;const e=this.duration;return e!==null?new Date(this._startDate.getTime()+e*1e3):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(_e(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isValid(){return!!this.id&&!this._badValueForSameId&&_e(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)}}class Ru{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var qe={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class My{constructor(e){this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams={[qe.AUDIO]:null,[qe.VIDEO]:null,[qe.AUDIOVIDEO]:null},this.baseurl=e}setByteRange(e,t){const n=e.split("@",2),i=[];n.length===1?i[0]=t?t.byteRangeEndOffset:0:i[0]=parseInt(n[1]),i[1]=parseInt(n[0])+i[0],this._byteRange=i}get byteRange(){return this._byteRange?this._byteRange:[]}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Cd.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}}class Pc extends My{constructor(e,t){super(t),this._decryptdata=null,this.rawProgramDateTime=null,this.programDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.stats=new Ru,this.urlId=0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.type=e}get decryptdata(){const{levelkeys:e}=this;if(!e&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const t=this.levelkeys.identity;if(t)this._decryptdata=t.getDecryptData(this.sn);else{const n=Object.keys(this.levelkeys);if(n.length===1)return this._decryptdata=this.levelkeys[n[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null||!_e(this.programDateTime))return null;const e=_e(this.duration)?this.duration:0;return this.programDateTime+e*1e3}get encrypted(){var e;if((e=this._decryptdata)!=null&&e.encrypted)return!0;if(this.levelkeys){const t=Object.keys(this.levelkeys),n=t.length;if(n>1||n===1&&this.levelkeys[t[0]].encrypted)return!0}return!1}setKeyFormat(e){if(this.levelkeys){const t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}}abortRequests(){var e,t;(e=this.loader)==null||e.abort(),(t=this.keyLoader)==null||t.abort()}setElementaryStreamInfo(e,t,n,i,s,a=!1){const{elementaryStreams:o}=this,l=o[e];if(!l){o[e]={startPTS:t,endPTS:n,startDTS:i,endDTS:s,partial:a};return}l.startPTS=Math.min(l.startPTS,t),l.endPTS=Math.max(l.endPTS,n),l.startDTS=Math.min(l.startDTS,i),l.endDTS=Math.max(l.endDTS,s)}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[qe.AUDIO]=null,e[qe.VIDEO]=null,e[qe.AUDIOVIDEO]=null}}class W1 extends My{constructor(e,t,n,i,s){super(n),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.stats=new Ru,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=i;const a=e.enumeratedString("BYTERANGE");a&&this.setByteRange(a,s),s&&(this.fragOffset=s.fragOffset+s.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}const H1=10;class j1{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e){this.advanced=!0,this.updated=!0;return}const t=this.lastPartSn-e.lastPartSn,n=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!n||!!t,this.advanced=this.endSN>e.endSN||t>0||t===0&&n>0,this.updated||this.advanced?this.misses=Math.floor(e.misses*.6):this.misses=e.misses+1,this.availabilityDelay=e.availabilityDelay}get hasProgramDateTime(){return this.fragments.length?_e(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||H1}get drift(){const e=this.driftEndTime-this.driftStartTime;return e>0?(this.driftEnd-this.driftStart)*1e3/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var e;return(e=this.fragments)!=null&&e.length?this.fragments[this.fragments.length-1].end:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].index:-1}get lastPartSn(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}function Rd(r){return Uint8Array.from(atob(r),e=>e.charCodeAt(0))}function K1(r){const e=By(r).subarray(0,16),t=new Uint8Array(16);return t.set(e,16-e.length),t}function q1(r){const e=function(n,i,s){const a=n[i];n[i]=n[s],n[s]=a};e(r,0,3),e(r,1,2),e(r,4,5),e(r,6,7)}function Y1(r){const e=r.split(":");let t=null;if(e[0]==="data"&&e.length===2){const n=e[1].split(";"),i=n[n.length-1].split(",");if(i.length===2){const s=i[0]==="base64",a=i[1];s?(n.splice(-1,1),t=Rd(a)):t=K1(a)}}return t}function By(r){return Uint8Array.from(unescape(encodeURIComponent(r)),e=>e.charCodeAt(0))}var ot={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},cr={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function Dg(r){switch(r){case cr.FAIRPLAY:return ot.FAIRPLAY;case cr.PLAYREADY:return ot.PLAYREADY;case cr.WIDEVINE:return ot.WIDEVINE;case cr.CLEARKEY:return ot.CLEARKEY}}var Uy={WIDEVINE:"edef8ba979d64acea3c827dcd51d21ed"};function X1(r){if(r===Uy.WIDEVINE)return ot.WIDEVINE}function Cg(r){switch(r){case ot.FAIRPLAY:return cr.FAIRPLAY;case ot.PLAYREADY:return cr.PLAYREADY;case ot.WIDEVINE:return cr.WIDEVINE;case ot.CLEARKEY:return cr.CLEARKEY}}function Fc(r){const{drmSystems:e,widevineLicenseUrl:t}=r,n=e?[ot.FAIRPLAY,ot.WIDEVINE,ot.PLAYREADY,ot.CLEARKEY].filter(i=>!!e[i]):[];return!n[ot.WIDEVINE]&&t&&n.push(ot.WIDEVINE),n}const $y=function(){return typeof self<"u"&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}();function Z1(r,e,t,n){let i;switch(r){case ot.FAIRPLAY:i=["cenc","sinf"];break;case ot.WIDEVINE:case ot.PLAYREADY:i=["cenc"];break;case ot.CLEARKEY:i=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${r}`)}return Q1(i,e,t,n)}function Q1(r,e,t,n){return[{initDataTypes:r,persistentState:n.persistentState||"not-allowed",distinctiveIdentifier:n.distinctiveIdentifier||"not-allowed",sessionTypes:n.sessionTypes||[n.sessionType||"temporary"],audioCapabilities:e.map(s=>({contentType:`audio/mp4; codecs="${s}"`,robustness:n.audioRobustness||"",encryptionScheme:n.audioEncryptionScheme||null})),videoCapabilities:t.map(s=>({contentType:`video/mp4; codecs="${s}"`,robustness:n.videoRobustness||"",encryptionScheme:n.videoEncryptionScheme||null}))}]}function Gi(r,e,t){return Uint8Array.prototype.slice?r.slice(e,t):new Uint8Array(Array.prototype.slice.call(r,e,t))}const Ld=(r,e)=>e+10<=r.length&&r[e]===73&&r[e+1]===68&&r[e+2]===51&&r[e+3]<255&&r[e+4]<255&&r[e+6]<128&&r[e+7]<128&&r[e+8]<128&&r[e+9]<128,zy=(r,e)=>e+10<=r.length&&r[e]===51&&r[e+1]===68&&r[e+2]===73&&r[e+3]<255&&r[e+4]<255&&r[e+6]<128&&r[e+7]<128&&r[e+8]<128&&r[e+9]<128,ru=(r,e)=>{const t=e;let n=0;for(;Ld(r,e);){n+=10;const i=Lu(r,e+6);n+=i,zy(r,e+10)&&(n+=10),e+=n}if(n>0)return r.subarray(t,t+n)},Lu=(r,e)=>{let t=0;return t=(r[e]&127)<<21,t|=(r[e+1]&127)<<14,t|=(r[e+2]&127)<<7,t|=r[e+3]&127,t},J1=(r,e)=>Ld(r,e)&&Lu(r,e+6)+10<=r.length-e,ew=r=>{const e=Gy(r);for(let t=0;t<e.length;t++){const n=e[t];if(Vy(n))return aw(n)}},Vy=r=>r&&r.key==="PRIV"&&r.info==="com.apple.streaming.transportStreamTimestamp",tw=r=>{const e=String.fromCharCode(r[0],r[1],r[2],r[3]),t=Lu(r,4),n=10;return{type:e,size:t,data:r.subarray(n,n+t)}},Gy=r=>{let e=0;const t=[];for(;Ld(r,e);){const n=Lu(r,e+6);e+=10;const i=e+n;for(;e+8<i;){const s=tw(r.subarray(e)),a=rw(s);a&&t.push(a),e+=s.size+10}zy(r,e)&&(e+=10)}return t},rw=r=>r.type==="PRIV"?nw(r):r.type[0]==="W"?sw(r):iw(r),nw=r=>{if(r.size<2)return;const e=An(r.data,!0),t=new Uint8Array(r.data.subarray(e.length+1));return{key:r.type,info:e,data:t.buffer}},iw=r=>{if(r.size<2)return;if(r.type==="TXXX"){let t=1;const n=An(r.data.subarray(t),!0);t+=n.length+1;const i=An(r.data.subarray(t));return{key:r.type,info:n,data:i}}const e=An(r.data.subarray(1));return{key:r.type,data:e}},sw=r=>{if(r.type==="WXXX"){if(r.size<2)return;let t=1;const n=An(r.data.subarray(t),!0);t+=n.length+1;const i=An(r.data.subarray(t));return{key:r.type,info:n,data:i}}const e=An(r.data);return{key:r.type,data:e}},aw=r=>{if(r.data.byteLength===8){const e=new Uint8Array(r.data),t=e[3]&1;let n=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return n/=45,t&&(n+=4772185884e-2),Math.round(n)}},An=(r,e=!1)=>{const t=ow();if(t){const u=t.decode(r);if(e){const c=u.indexOf("\0");return c!==-1?u.substring(0,c):u}return u.replace(/\0/g,"")}const n=r.length;let i,s,a,o="",l=0;for(;l<n;){if(i=r[l++],i===0&&e)return o;if(i===0||i===3)continue;switch(i>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:o+=String.fromCharCode(i);break;case 12:case 13:s=r[l++],o+=String.fromCharCode((i&31)<<6|s&63);break;case 14:s=r[l++],a=r[l++],o+=String.fromCharCode((i&15)<<12|(s&63)<<6|(a&63)<<0);break}}return o};let Mc;function ow(){return!Mc&&typeof self.TextDecoder<"u"&&(Mc=new self.TextDecoder("utf-8")),Mc}const En={hexDump:function(r){let e="";for(let t=0;t<r.length;t++){let n=r[t].toString(16);n.length<2&&(n="0"+n),e+=n}return e}},nu=Math.pow(2,32)-1,lw=[].push,Wy={video:1,audio:2,id3:3,text:4};function Pt(r){return String.fromCharCode.apply(null,r)}function Hy(r,e){const t=r[e]<<8|r[e+1];return t<0?65536+t:t}function Ce(r,e){const t=jy(r,e);return t<0?4294967296+t:t}function jy(r,e){return r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3]}function Bc(r,e,t){r[e]=t>>24,r[e+1]=t>>16&255,r[e+2]=t>>8&255,r[e+3]=t&255}function Be(r,e){const t=[];if(!e.length)return t;const n=r.byteLength;for(let i=0;i<n;){const s=Ce(r,i),a=Pt(r.subarray(i+4,i+8)),o=s>1?i+s:n;if(a===e[0])if(e.length===1)t.push(r.subarray(i+8,o));else{const l=Be(r.subarray(i+8,o),e.slice(1));l.length&&lw.apply(t,l)}i=o}return t}function uw(r){const e=[],t=r[0];let n=8;const i=Ce(r,n);n+=4;const s=0,a=0;t===0?n+=8:n+=16,n+=2;let o=r.length+a;const l=Hy(r,n);n+=2;for(let u=0;u<l;u++){let c=n;const f=Ce(r,c);c+=4;const h=f&2147483647;if((f&2147483648)>>>31===1)return G.warn("SIDX has hierarchical references (not supported)"),null;const m=Ce(r,c);c+=4,e.push({referenceSize:h,subsegmentDuration:m,info:{duration:m/i,start:o,end:o+h-1}}),o+=h,c+=4,n=c}return{earliestPresentationTime:s,timescale:i,version:t,referencesCount:l,references:e}}function Ky(r){const e=[],t=Be(r,["moov","trak"]);for(let i=0;i<t.length;i++){const s=t[i],a=Be(s,["tkhd"])[0];if(a){let o=a[0],l=o===0?12:20;const u=Ce(a,l),c=Be(s,["mdia","mdhd"])[0];if(c){o=c[0],l=o===0?12:20;const f=Ce(c,l),h=Be(s,["mdia","hdlr"])[0];if(h){const d=Pt(h.subarray(8,12)),m={soun:qe.AUDIO,vide:qe.VIDEO}[d];if(m){const x=Be(s,["mdia","minf","stbl","stsd"])[0];let p;x&&(p=Pt(x.subarray(12,16))),e[u]={timescale:f,type:m},e[m]={timescale:f,id:u,codec:p}}}}}}return Be(r,["moov","mvex","trex"]).forEach(i=>{const s=Ce(i,4),a=e[s];a&&(a.default={duration:Ce(i,12),flags:Ce(i,20)})}),e}function cw(r,e){if(!r||!e)return r;const t=e.keyId;return t&&e.isCommonEncryption&&Be(r,["moov","trak"]).forEach(i=>{const a=Be(i,["mdia","minf","stbl","stsd"])[0].subarray(8);let o=Be(a,["enca"]);const l=o.length>0;l||(o=Be(a,["encv"])),o.forEach(u=>{const c=l?u.subarray(28):u.subarray(78);Be(c,["sinf"]).forEach(h=>{const d=qy(h);if(d){const m=d.subarray(8,24);m.some(x=>x!==0)||(G.log(`[eme] Patching keyId in 'enc${l?"a":"v"}>sinf>>tenc' box: ${En.hexDump(m)} -> ${En.hexDump(t)}`),d.set(t,8))}})})}),r}function qy(r){const e=Be(r,["schm"])[0];if(e){const t=Pt(e.subarray(4,8));if(t==="cbcs"||t==="cenc")return Be(r,["schi","tenc"])[0]}return G.error("[eme] missing 'schm' box"),null}function fw(r,e){return Be(e,["moof","traf"]).reduce((t,n)=>{const i=Be(n,["tfdt"])[0],s=i[0],a=Be(n,["tfhd"]).reduce((o,l)=>{const u=Ce(l,4),c=r[u];if(c){let f=Ce(i,4);if(s===1){if(f===nu)return G.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),o;f*=nu+1,f+=Ce(i,8)}const h=c.timescale||9e4,d=f/h;if(isFinite(d)&&(o===null||d<o))return d}return o},null);return a!==null&&isFinite(a)&&(t===null||a<t)?a:t},null)}function hw(r,e){let t=0,n=0,i=0;const s=Be(r,["moof","traf"]);for(let a=0;a<s.length;a++){const o=s[a],l=Be(o,["tfhd"])[0],u=Ce(l,4),c=e[u];if(!c)continue;const f=c.default,h=Ce(l,0)|(f==null?void 0:f.flags);let d=f==null?void 0:f.duration;h&8&&(h&2?d=Ce(l,12):d=Ce(l,8));const m=c.timescale||9e4,x=Be(o,["trun"]);for(let p=0;p<x.length;p++){if(t=dw(x[p]),!t&&d){const g=Ce(x[p],4);t=d*g}c.type===qe.VIDEO?n+=t/m:c.type===qe.AUDIO&&(i+=t/m)}}if(n===0&&i===0){let a=0;const o=Be(r,["sidx"]);for(let l=0;l<o.length;l++){const u=uw(o[l]);u!=null&&u.references&&(a+=u.references.reduce((c,f)=>c+f.info.duration||0,0))}return a}return n||i}function dw(r){const e=Ce(r,0);let t=8;e&1&&(t+=4),e&4&&(t+=4);let n=0;const i=Ce(r,4);for(let s=0;s<i;s++){if(e&256){const a=Ce(r,t);n+=a,t+=4}e&512&&(t+=4),e&1024&&(t+=4),e&2048&&(t+=4)}return n}function pw(r,e,t){Be(e,["moof","traf"]).forEach(n=>{Be(n,["tfhd"]).forEach(i=>{const s=Ce(i,4),a=r[s];if(!a)return;const o=a.timescale||9e4;Be(n,["tfdt"]).forEach(l=>{const u=l[0];let c=Ce(l,4);if(u===0)c-=t*o,c=Math.max(c,0),Bc(l,4,c);else{c*=Math.pow(2,32),c+=Ce(l,8),c-=t*o,c=Math.max(c,0);const f=Math.floor(c/(nu+1)),h=Math.floor(c%(nu+1));Bc(l,4,f),Bc(l,8,h)}})})})}function gw(r){const e={valid:null,remainder:null},t=Be(r,["moof"]);if(t){if(t.length<2)return e.remainder=r,e}else return e;const n=t[t.length-1];return e.valid=Gi(r,0,n.byteOffset-8),e.remainder=Gi(r,n.byteOffset-8),e}function Yi(r,e){const t=new Uint8Array(r.length+e.length);return t.set(r),t.set(e,r.length),t}function Rg(r,e){const t=[],n=e.samples,i=e.timescale,s=e.id;let a=!1;return Be(n,["moof"]).map(l=>{const u=l.byteOffset-8;Be(l,["traf"]).map(f=>{const h=Be(f,["tfdt"]).map(d=>{const m=d[0];let x=Ce(d,4);return m===1&&(x*=Math.pow(2,32),x+=Ce(d,8)),x/i})[0];return h!==void 0&&(r=h),Be(f,["tfhd"]).map(d=>{const m=Ce(d,4),x=Ce(d,0)&16777215,p=(x&1)!==0,g=(x&2)!==0,v=(x&8)!==0;let E=0;const S=(x&16)!==0;let T=0;const w=(x&32)!==0;let _=8;m===s&&(p&&(_+=8),g&&(_+=4),v&&(E=Ce(d,_),_+=4),S&&(T=Ce(d,_),_+=4),w&&(_+=4),e.type==="video"&&(a=mw(e.codec)),Be(f,["trun"]).map(C=>{const O=C[0],L=Ce(C,0)&16777215,V=(L&1)!==0;let $=0;const ne=(L&4)!==0,me=(L&256)!==0;let H=0;const j=(L&512)!==0;let X=0;const N=(L&1024)!==0,U=(L&2048)!==0;let Z=0;const oe=Ce(C,4);let re=8;V&&($=Ce(C,re),re+=4),ne&&(re+=4);let pe=$+u;for(let Te=0;Te<oe;Te++){if(me?(H=Ce(C,re),re+=4):H=E,j?(X=Ce(C,re),re+=4):X=T,N&&(re+=4),U&&(O===0?Z=Ce(C,re):Z=jy(C,re),re+=4),e.type===qe.VIDEO){let Ie=0;for(;Ie<X;){const Le=Ce(n,pe);if(pe+=4,vw(a,n[pe])){const Oe=n.subarray(pe,pe+Le);Yy(Oe,a?2:1,r+Z/i,t)}pe+=Le,Ie+=Le+4}}r+=H/i}}))})})}),t}function mw(r){if(!r)return!1;const e=r.indexOf("."),t=e<0?r:r.substring(0,e);return t==="hvc1"||t==="hev1"||t==="dvh1"||t==="dvhe"}function vw(r,e){if(r){const t=e>>1&63;return t===39||t===40}else return(e&31)===6}function Yy(r,e,t,n){const i=Xy(r);let s=0;s+=e;let a=0,o=0,l=!1,u=0;for(;s<i.length;){a=0;do{if(s>=i.length)break;u=i[s++],a+=u}while(u===255);o=0;do{if(s>=i.length)break;u=i[s++],o+=u}while(u===255);const c=i.length-s;if(!l&&a===4&&s<i.length){if(l=!0,i[s++]===181){const h=Hy(i,s);if(s+=2,h===49){const d=Ce(i,s);if(s+=4,d===1195456820){const m=i[s++];if(m===3){const x=i[s++],p=31&x,g=64&x,v=g?2+p*3:0,E=new Uint8Array(v);if(g){E[0]=x;for(let S=1;S<v;S++)E[S]=i[s++]}n.push({type:m,payloadType:a,pts:t,bytes:E})}}}}}else if(a===5&&o<c){if(l=!0,o>16){const f=[];for(let m=0;m<16;m++){const x=i[s++].toString(16);f.push(x.length==1?"0"+x:x),(m===3||m===5||m===7||m===9)&&f.push("-")}const h=o-16,d=new Uint8Array(h);for(let m=0;m<h;m++)d[m]=i[s++];n.push({payloadType:a,pts:t,uuid:f.join(""),userData:An(d),userDataBytes:d})}}else if(o<c)s+=o;else if(o>c)break}}function Xy(r){const e=r.byteLength,t=[];let n=1;for(;n<e-2;)r[n]===0&&r[n+1]===0&&r[n+2]===3?(t.push(n+2),n+=2):n++;if(t.length===0)return r;const i=e-t.length,s=new Uint8Array(i);let a=0;for(n=0;n<i;a++,n++)a===t[0]&&(a++,t.shift()),s[n]=r[a];return s}function yw(r){const e=r[0];let t="",n="",i=0,s=0,a=0,o=0,l=0,u=0;if(e===0){for(;Pt(r.subarray(u,u+1))!=="\0";)t+=Pt(r.subarray(u,u+1)),u+=1;for(t+=Pt(r.subarray(u,u+1)),u+=1;Pt(r.subarray(u,u+1))!=="\0";)n+=Pt(r.subarray(u,u+1)),u+=1;n+=Pt(r.subarray(u,u+1)),u+=1,i=Ce(r,12),s=Ce(r,16),o=Ce(r,20),l=Ce(r,24),u=28}else if(e===1){u+=4,i=Ce(r,u),u+=4;const f=Ce(r,u);u+=4;const h=Ce(r,u);for(u+=4,a=2**32*f+h,Number.isSafeInteger(a)||(a=Number.MAX_SAFE_INTEGER,G.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),o=Ce(r,u),u+=4,l=Ce(r,u),u+=4;Pt(r.subarray(u,u+1))!=="\0";)t+=Pt(r.subarray(u,u+1)),u+=1;for(t+=Pt(r.subarray(u,u+1)),u+=1;Pt(r.subarray(u,u+1))!=="\0";)n+=Pt(r.subarray(u,u+1)),u+=1;n+=Pt(r.subarray(u,u+1)),u+=1}const c=r.subarray(u,r.byteLength);return{schemeIdUri:t,value:n,timeScale:i,presentationTime:a,presentationTimeDelta:s,eventDuration:o,id:l,payload:c}}function Ew(r,...e){const t=e.length;let n=8,i=t;for(;i--;)n+=e[i].byteLength;const s=new Uint8Array(n);for(s[0]=n>>24&255,s[1]=n>>16&255,s[2]=n>>8&255,s[3]=n&255,s.set(r,4),i=0,n=8;i<t;i++)s.set(e[i],n),n+=e[i].byteLength;return s}function xw(r,e,t){if(r.byteLength!==16)throw new RangeError("Invalid system id");let n,i;if(e){n=1,i=new Uint8Array(e.length*16);for(let o=0;o<e.length;o++){const l=e[o];if(l.byteLength!==16)throw new RangeError("Invalid key");i.set(l,o*16)}}else n=0,i=new Uint8Array;let s;n>0?(s=new Uint8Array(4),e.length>0&&new DataView(s.buffer).setUint32(0,e.length,!1)):s=new Uint8Array;const a=new Uint8Array(4);return t&&t.byteLength>0&&new DataView(a.buffer).setUint32(0,t.byteLength,!1),Ew([112,115,115,104],new Uint8Array([n,0,0,0]),r,s,i,a,t||new Uint8Array)}function Tw(r){if(!(r instanceof ArrayBuffer)||r.byteLength<32)return null;const e={version:0,systemId:"",kids:null,data:null},t=new DataView(r),n=t.getUint32(0);if(r.byteLength!==n&&n>44||t.getUint32(4)!==1886614376||(e.version=t.getUint32(8)>>>24,e.version>1))return null;e.systemId=En.hexDump(new Uint8Array(r,12,16));const s=t.getUint32(28);if(e.version===0){if(n-32<s)return null;e.data=new Uint8Array(r,32,s)}else if(e.version===1){e.kids=[];for(let a=0;a<s;a++)e.kids.push(new Uint8Array(r,32+a*16,16))}return e}let el={};class oo{static clearKeyUriToKeyIdMap(){el={}}constructor(e,t,n,i=[1],s=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=n,this.keyFormatVersions=i,this.iv=s,this.encrypted=e?e!=="NONE":!1,this.isCommonEncryption=this.encrypted&&e!=="AES-128"}isSupported(){if(this.method){if(this.method==="AES-128"||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case cr.FAIRPLAY:case cr.WIDEVINE:case cr.PLAYREADY:case cr.CLEARKEY:return["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if(this.method==="AES-128"&&this.uri&&!this.iv){typeof e!="number"&&(this.method==="AES-128"&&!this.iv&&G.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0);const n=Sw(e);return new oo(this.method,this.uri,"identity",this.keyFormatVersions,n)}const t=Y1(this.uri);if(t)switch(this.keyFormat){case cr.WIDEVINE:this.pssh=t,t.length>=22&&(this.keyId=t.subarray(t.length-22,t.length-6));break;case cr.PLAYREADY:{const n=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=xw(n,null,t);const i=new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2),s=String.fromCharCode.apply(null,Array.from(i)),a=s.substring(s.indexOf("<"),s.length),u=new DOMParser().parseFromString(a,"text/xml").getElementsByTagName("KID")[0];if(u){const c=u.childNodes[0]?u.childNodes[0].nodeValue:u.getAttribute("VALUE");if(c){const f=Rd(c).subarray(0,16);q1(f),this.keyId=f}}break}default:{let n=t.subarray(0,16);if(n.length!==16){const i=new Uint8Array(16);i.set(n,16-n.length),n=i}this.keyId=n;break}}if(!this.keyId||this.keyId.byteLength!==16){let n=el[this.uri];if(!n){const i=Object.keys(el).length%Number.MAX_SAFE_INTEGER;n=new Uint8Array(16),new DataView(n.buffer,12,4).setUint32(0,i),el[this.uri]=n}this.keyId=n}return this}}function Sw(r){const e=new Uint8Array(16);for(let t=12;t<16;t++)e[t]=r>>8*(15-t)&255;return e}const Zy=/\{\$([a-zA-Z0-9-_]+)\}/g;function Lg(r){return Zy.test(r)}function or(r,e,t){if(r.variableList!==null||r.hasVariableRefs)for(let n=t.length;n--;){const i=t[n],s=e[i];s&&(e[i]=mh(r,s))}}function mh(r,e){if(r.variableList!==null||r.hasVariableRefs){const t=r.variableList;return e.replace(Zy,n=>{const i=n.substring(2,n.length-1),s=t==null?void 0:t[i];return s===void 0?(r.playlistParsingError||(r.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${i}"`)),n):s})}return e}function Ig(r,e,t){let n=r.variableList;n||(r.variableList=n={});let i,s;if("QUERYPARAM"in e){i=e.QUERYPARAM;try{const a=new self.URL(t).searchParams;if(a.has(i))s=a.get(i);else throw new Error(`"${i}" does not match any query parameter in URI: "${t}"`)}catch(a){r.playlistParsingError||(r.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${a.message}`))}}else i=e.NAME,s=e.VALUE;i in n?r.playlistParsingError||(r.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${i}"`)):n[i]=s||""}function ww(r,e,t){const n=e.IMPORT;if(t&&n in t){let i=r.variableList;i||(r.variableList=i={}),i[n]=t[n]}else r.playlistParsingError||(r.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${n}"`))}function Iu(){if(!(typeof self>"u"))return self.MediaSource||self.WebKitMediaSource}const _w={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dva1:!0,dvav:!0,dvh1:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}},kg=Iu();function Aw(r,e){const t=_w[e];return!!t&&t[r.slice(0,4)]===!0}function Uc(r,e){var t;return(t=kg==null?void 0:kg.isTypeSupported(`${e||"video"}/mp4;codecs="${r}"`))!=null?t:!1}const Og=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,Ng=/#EXT-X-MEDIA:(.*)/g,bw=/^#EXT(?:INF|-X-TARGETDURATION):/m,Pg=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),Dw=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class un{static findGroup(e,t){for(let n=0;n<e.length;n++){const i=e[n];if(i.id===t)return i}}static convertAVC1ToAVCOTI(e){const t=e.split(".");if(t.length>2){let n=t.shift()+".";return n+=parseInt(t.shift()).toString(16),n+=("000"+parseInt(t.shift()).toString(16)).slice(-4),n}return e}static resolve(e,t){return Cd.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return bw.test(e)}static parseMasterPlaylist(e,t){const n=Lg(e),i={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:n},s=[];Og.lastIndex=0;let a;for(;(a=Og.exec(e))!=null;)if(a[1]){var o;const u=new st(a[1]);or(i,u,["CODECS","SUPPLEMENTAL-CODECS","ALLOWED-CPC","PATHWAY-ID","STABLE-VARIANT-ID","AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS","NAME"]);const c=mh(i,a[2]),f={attrs:u,bitrate:u.decimalInteger("AVERAGE-BANDWIDTH")||u.decimalInteger("BANDWIDTH"),name:u.NAME,url:un.resolve(c,t)},h=u.decimalResolution("RESOLUTION");h&&(f.width=h.width,f.height=h.height),Cw((u.CODECS||"").split(/[ ,]+/).filter(d=>d),f),f.videoCodec&&f.videoCodec.indexOf("avc1")!==-1&&(f.videoCodec=un.convertAVC1ToAVCOTI(f.videoCodec)),(o=f.unknownCodecs)!=null&&o.length||s.push(f),i.levels.push(f)}else if(a[3]){const u=a[3],c=a[4];switch(u){case"SESSION-DATA":{const f=new st(c);or(i,f,["DATA-ID","LANGUAGE","VALUE","URI"]);const h=f["DATA-ID"];h&&(i.sessionData===null&&(i.sessionData={}),i.sessionData[h]=f);break}case"SESSION-KEY":{const f=Fg(c,t,i);f.encrypted&&f.isSupported()?(i.sessionKeys===null&&(i.sessionKeys=[]),i.sessionKeys.push(f)):G.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${c}"`);break}case"DEFINE":{{const f=new st(c);or(i,f,["NAME","VALUE","QUERYPARAM"]),Ig(i,f,t)}break}case"CONTENT-STEERING":{const f=new st(c);or(i,f,["SERVER-URI","PATHWAY-ID"]),i.contentSteering={uri:un.resolve(f["SERVER-URI"],t),pathwayId:f["PATHWAY-ID"]||"."};break}case"START":{i.startTimeOffset=Mg(c);break}}}const l=s.length>0&&s.length<i.levels.length;return i.levels=l?s:i.levels,i.levels.length===0&&(i.playlistParsingError=new Error("no levels found in manifest")),i}static parseMasterPlaylistMedia(e,t,n){let i;const s={},a=n.levels,o={AUDIO:a.map(u=>({id:u.attrs.AUDIO,audioCodec:u.audioCodec})),SUBTITLES:a.map(u=>({id:u.attrs.SUBTITLES,textCodec:u.textCodec})),"CLOSED-CAPTIONS":[]};let l=0;for(Ng.lastIndex=0;(i=Ng.exec(e))!==null;){const u=new st(i[1]),c=u.TYPE;if(c){const f=o[c],h=s[c]||[];s[c]=h,or(n,u,["URI","GROUP-ID","LANGUAGE","ASSOC-LANGUAGE","STABLE-RENDITION-ID","NAME","INSTREAM-ID","CHARACTERISTICS","CHANNELS"]);const d={attrs:u,bitrate:0,id:l++,groupId:u["GROUP-ID"]||"",instreamId:u["INSTREAM-ID"],name:u.NAME||u.LANGUAGE||"",type:c,default:u.bool("DEFAULT"),autoselect:u.bool("AUTOSELECT"),forced:u.bool("FORCED"),lang:u.LANGUAGE,url:u.URI?un.resolve(u.URI,t):""};if(f!=null&&f.length){const m=un.findGroup(f,d.groupId)||f[0];Bg(d,m,"audioCodec"),Bg(d,m,"textCodec")}h.push(d)}}return s}static parseLevelPlaylist(e,t,n,i,s,a){const o=new j1(t),l=o.fragments;let u=null,c=0,f=0,h=0,d=0,m=null,x=new Pc(i,t),p,g,v,E=-1,S=!1;for(Pg.lastIndex=0,o.m3u8=e,o.hasVariableRefs=Lg(e);(p=Pg.exec(e))!==null;){S&&(S=!1,x=new Pc(i,t),x.start=h,x.sn=c,x.cc=d,x.level=n,u&&(x.initSegment=u,x.rawProgramDateTime=u.rawProgramDateTime,u.rawProgramDateTime=null));const C=p[1];if(C){x.duration=parseFloat(C);const O=(" "+p[2]).slice(1);x.title=O||null,x.tagList.push(O?["INF",C,O]:["INF",C])}else if(p[3]){if(_e(x.duration)){x.start=h,v&&zg(x,v,o),x.sn=c,x.level=n,x.cc=d,x.urlId=s,l.push(x);const O=(" "+p[3]).slice(1);x.relurl=mh(o,O),Ug(x,m),m=x,h+=x.duration,c++,f=0,S=!0}}else if(p[4]){const O=(" "+p[4]).slice(1);m?x.setByteRange(O,m):x.setByteRange(O)}else if(p[5])x.rawProgramDateTime=(" "+p[5]).slice(1),x.tagList.push(["PROGRAM-DATE-TIME",x.rawProgramDateTime]),E===-1&&(E=l.length);else{if(p=p[0].match(Dw),!p){G.warn("No matches on slow regex match for level playlist!");continue}for(g=1;g<p.length&&!(typeof p[g]<"u");g++);const O=(" "+p[g]).slice(1),L=(" "+p[g+1]).slice(1),V=p[g+2]?(" "+p[g+2]).slice(1):"";switch(O){case"PLAYLIST-TYPE":o.type=L.toUpperCase();break;case"MEDIA-SEQUENCE":c=o.startSN=parseInt(L);break;case"SKIP":{const $=new st(L);or(o,$,["RECENTLY-REMOVED-DATERANGES"]);const ne=$.decimalInteger("SKIPPED-SEGMENTS");if(_e(ne)){o.skippedSegments=ne;for(let H=ne;H--;)l.unshift(null);c+=ne}const me=$.enumeratedString("RECENTLY-REMOVED-DATERANGES");me&&(o.recentlyRemovedDateranges=me.split("	"));break}case"TARGETDURATION":o.targetduration=Math.max(parseInt(L),1);break;case"VERSION":o.version=parseInt(L);break;case"EXTM3U":break;case"ENDLIST":o.live=!1;break;case"#":(L||V)&&x.tagList.push(V?[L,V]:[L]);break;case"DISCONTINUITY":d++,x.tagList.push(["DIS"]);break;case"GAP":x.gap=!0,x.tagList.push([O]);break;case"BITRATE":x.tagList.push([O,L]);break;case"DATERANGE":{const $=new st(L);or(o,$,["ID","CLASS","START-DATE","END-DATE","SCTE35-CMD","SCTE35-OUT","SCTE35-IN"]),or(o,$,$.clientAttrs);const ne=new Fy($,o.dateRanges[$.ID]);ne.isValid||o.skippedSegments?o.dateRanges[ne.id]=ne:G.warn(`Ignoring invalid DATERANGE tag: "${L}"`),x.tagList.push(["EXT-X-DATERANGE",L]);break}case"DEFINE":{{const $=new st(L);or(o,$,["NAME","VALUE","IMPORT","QUERYPARAM"]),"IMPORT"in $?ww(o,$,a):Ig(o,$,t)}break}case"DISCONTINUITY-SEQUENCE":d=parseInt(L);break;case"KEY":{const $=Fg(L,t,o);if($.isSupported()){if($.method==="NONE"){v=void 0;break}v||(v={}),v[$.keyFormat]&&(v=At({},v)),v[$.keyFormat]=$}else G.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${L}"`);break}case"START":o.startTimeOffset=Mg(L);break;case"MAP":{const $=new st(L);if(or(o,$,["BYTERANGE","URI"]),x.duration){const ne=new Pc(i,t);$g(ne,$,n,v),u=ne,x.initSegment=u,u.rawProgramDateTime&&!x.rawProgramDateTime&&(x.rawProgramDateTime=u.rawProgramDateTime)}else $g(x,$,n,v),u=x,S=!0;break}case"SERVER-CONTROL":{const $=new st(L);o.canBlockReload=$.bool("CAN-BLOCK-RELOAD"),o.canSkipUntil=$.optionalFloat("CAN-SKIP-UNTIL",0),o.canSkipDateRanges=o.canSkipUntil>0&&$.bool("CAN-SKIP-DATERANGES"),o.partHoldBack=$.optionalFloat("PART-HOLD-BACK",0),o.holdBack=$.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{const $=new st(L);o.partTarget=$.decimalFloatingPoint("PART-TARGET");break}case"PART":{let $=o.partList;$||($=o.partList=[]);const ne=f>0?$[$.length-1]:void 0,me=f++,H=new st(L);or(o,H,["BYTERANGE","URI"]);const j=new W1(H,x,t,me,ne);$.push(j),x.duration+=j.duration;break}case"PRELOAD-HINT":{const $=new st(L);or(o,$,["URI"]),o.preloadHint=$;break}case"RENDITION-REPORT":{const $=new st(L);or(o,$,["URI"]),o.renditionReports=o.renditionReports||[],o.renditionReports.push($);break}default:G.warn(`line parsed but not handled: ${p}`);break}}}m&&!m.relurl?(l.pop(),h-=m.duration,o.partList&&(o.fragmentHint=m)):o.partList&&(Ug(x,m),x.cc=d,o.fragmentHint=x,v&&zg(x,v,o));const T=l.length,w=l[0],_=l[T-1];if(h+=o.skippedSegments*o.targetduration,h>0&&T&&_){o.averagetargetduration=h/T;const C=_.sn;o.endSN=C!=="initSegment"?C:0,o.live||(_.endList=!0),w&&(o.startCC=w.cc)}else o.endSN=0,o.startCC=0;return o.fragmentHint&&(h+=o.fragmentHint.duration),o.totalduration=h,o.endCC=d,E>0&&Rw(l,E),o}}function Fg(r,e,t){var n,i;const s=new st(r);or(t,s,["KEYFORMAT","KEYFORMATVERSIONS","URI","IV","URI"]);const a=(n=s.METHOD)!=null?n:"",o=s.URI,l=s.hexadecimalInteger("IV"),u=s.KEYFORMATVERSIONS,c=(i=s.KEYFORMAT)!=null?i:"identity";o&&s.IV&&!l&&G.error(`Invalid IV: ${s.IV}`);const f=o?un.resolve(o,e):"",h=(u||"1").split("/").map(Number).filter(Number.isFinite);return new oo(a,f,c,h,l)}function Mg(r){const t=new st(r).decimalFloatingPoint("TIME-OFFSET");return _e(t)?t:null}function Cw(r,e){["video","audio","text"].forEach(t=>{const n=r.filter(i=>Aw(i,t));if(n.length){const i=n.filter(s=>s.lastIndexOf("avc1",0)===0||s.lastIndexOf("mp4a",0)===0);e[`${t}Codec`]=i.length>0?i[0]:n[0],r=r.filter(s=>n.indexOf(s)===-1)}}),e.unknownCodecs=r}function Bg(r,e,t){const n=e[t];n&&(r[t]=n)}function Rw(r,e){let t=r[e];for(let n=e;n--;){const i=r[n];if(!i)return;i.programDateTime=t.programDateTime-i.duration*1e3,t=i}}function Ug(r,e){r.rawProgramDateTime?r.programDateTime=Date.parse(r.rawProgramDateTime):e!=null&&e.programDateTime&&(r.programDateTime=e.endProgramDateTime),_e(r.programDateTime)||(r.programDateTime=null,r.rawProgramDateTime=null)}function $g(r,e,t,n){r.relurl=e.URI,e.BYTERANGE&&r.setByteRange(e.BYTERANGE),r.level=t,r.sn="initSegment",n&&(r.levelkeys=n),r.initSegment=null}function zg(r,e,t){r.levelkeys=e;const{encryptedFragments:n}=t;(!n.length||n[n.length-1].levelkeys!==e)&&Object.keys(e).some(i=>e[i].isCommonEncryption)&&n.push(r)}var ze={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},De={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};function Vg(r){const{type:e}=r;switch(e){case ze.AUDIO_TRACK:return De.AUDIO;case ze.SUBTITLE_TRACK:return De.SUBTITLE;default:return De.MAIN}}function $c(r,e){let t=r.url;return(t===void 0||t.indexOf("data:")===0)&&(t=e.url),t}class Lw{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(A.MANIFEST_LOADING,this.onManifestLoading,this),e.on(A.LEVEL_LOADING,this.onLevelLoading,this),e.on(A.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(A.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}unregisterListeners(){const{hls:e}=this;e.off(A.MANIFEST_LOADING,this.onManifestLoading,this),e.off(A.LEVEL_LOADING,this.onLevelLoading,this),e.off(A.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(A.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}createInternalLoader(e){const t=this.hls.config,n=t.pLoader,i=t.loader,s=n||i,a=new s(t);return this.loaders[e.type]=a,a}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:n}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:ze.MANIFEST,url:n,deliveryDirectives:null})}onLevelLoading(e,t){const{id:n,level:i,url:s,deliveryDirectives:a}=t;this.load({id:n,level:i,responseType:"text",type:ze.LEVEL,url:s,deliveryDirectives:a})}onAudioTrackLoading(e,t){const{id:n,groupId:i,url:s,deliveryDirectives:a}=t;this.load({id:n,groupId:i,level:null,responseType:"text",type:ze.AUDIO_TRACK,url:s,deliveryDirectives:a})}onSubtitleTrackLoading(e,t){const{id:n,groupId:i,url:s,deliveryDirectives:a}=t;this.load({id:n,groupId:i,level:null,responseType:"text",type:ze.SUBTITLE_TRACK,url:s,deliveryDirectives:a})}load(e){var t;const n=this.hls.config;let i=this.getInternalLoader(e);if(i){const u=i.context;if(u&&u.url===e.url){G.trace("[playlist-loader]: playlist request ongoing");return}G.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),i.abort()}let s;if(e.type===ze.MANIFEST?s=n.manifestLoadPolicy.default:s=At({},n.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),i=this.createInternalLoader(e),(t=e.deliveryDirectives)!=null&&t.part){let u;if(e.type===ze.LEVEL&&e.level!==null?u=this.hls.levels[e.level].details:e.type===ze.AUDIO_TRACK&&e.id!==null?u=this.hls.audioTracks[e.id].details:e.type===ze.SUBTITLE_TRACK&&e.id!==null&&(u=this.hls.subtitleTracks[e.id].details),u){const c=u.partTarget,f=u.targetduration;if(c&&f){const h=Math.max(c*3,f*.8)*1e3;s=At({},s,{maxTimeToFirstByteMs:Math.min(h,s.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(h,s.maxTimeToFirstByteMs)})}}}const a=s.errorRetry||s.timeoutRetry||{},o={loadPolicy:s,timeout:s.maxLoadTimeMs,maxRetry:a.maxNumRetry||0,retryDelay:a.retryDelayMs||0,maxRetryDelay:a.maxRetryDelayMs||0},l={onSuccess:(u,c,f,h)=>{const d=this.getInternalLoader(f);this.resetInternalLoader(f.type);const m=u.data;if(m.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(u,f,new Error("no EXTM3U delimiter"),h||null,c);return}c.parsing.start=performance.now(),un.isMediaPlaylist(m)?this.handleTrackOrLevelPlaylist(u,c,f,h||null,d):this.handleMasterPlaylist(u,c,f,h)},onError:(u,c,f,h)=>{this.handleNetworkError(c,f,!1,u,h)},onTimeout:(u,c,f)=>{this.handleNetworkError(c,f,!0,void 0,u)}};i.load(e,o,l)}handleMasterPlaylist(e,t,n,i){const s=this.hls,a=e.data,o=$c(e,n),l=un.parseMasterPlaylist(a,o);if(l.playlistParsingError){this.handleManifestParsingError(e,n,l.playlistParsingError,i,t);return}const{contentSteering:u,levels:c,sessionData:f,sessionKeys:h,startTimeOffset:d,variableList:m}=l;this.variableList=m;const{AUDIO:x=[],SUBTITLES:p,"CLOSED-CAPTIONS":g}=un.parseMasterPlaylistMedia(a,o,l);x.length&&!x.some(E=>!E.url)&&c[0].audioCodec&&!c[0].attrs.AUDIO&&(G.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),x.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new st({}),bitrate:0,url:""})),s.trigger(A.MANIFEST_LOADED,{levels:c,audioTracks:x,subtitles:p,captions:g,contentSteering:u,url:o,stats:t,networkDetails:i,sessionData:f,sessionKeys:h,startTimeOffset:d,variableList:m})}handleTrackOrLevelPlaylist(e,t,n,i,s){const a=this.hls,{id:o,level:l,type:u}=n,c=$c(e,n),f=_e(o)?o:0,h=_e(l)?l:f,d=Vg(n),m=un.parseLevelPlaylist(e.data,c,h,d,f,this.variableList);if(u===ze.MANIFEST){const x={attrs:new st({}),bitrate:0,details:m,name:"",url:c};a.trigger(A.MANIFEST_LOADED,{levels:[x],audioTracks:[],url:c,stats:t,networkDetails:i,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),n.levelDetails=m,this.handlePlaylistLoaded(m,e,t,n,i,s)}handleManifestParsingError(e,t,n,i,s){this.hls.trigger(A.ERROR,{type:be.NETWORK_ERROR,details:J.MANIFEST_PARSING_ERROR,fatal:t.type===ze.MANIFEST,url:e.url,err:n,error:n,reason:n.message,response:e,context:t,networkDetails:i,stats:s})}handleNetworkError(e,t,n=!1,i,s){let a=`A network ${n?"timeout":"error"+(i?" (status "+i.code+")":"")} occurred while loading ${e.type}`;e.type===ze.LEVEL?a+=`: ${e.level} id: ${e.id}`:(e.type===ze.AUDIO_TRACK||e.type===ze.SUBTITLE_TRACK)&&(a+=` id: ${e.id} group-id: "${e.groupId}"`);const o=new Error(a);G.warn(`[playlist-loader]: ${a}`);let l=J.UNKNOWN,u=!1;const c=this.getInternalLoader(e);switch(e.type){case ze.MANIFEST:l=n?J.MANIFEST_LOAD_TIMEOUT:J.MANIFEST_LOAD_ERROR,u=!0;break;case ze.LEVEL:l=n?J.LEVEL_LOAD_TIMEOUT:J.LEVEL_LOAD_ERROR,u=!1;break;case ze.AUDIO_TRACK:l=n?J.AUDIO_TRACK_LOAD_TIMEOUT:J.AUDIO_TRACK_LOAD_ERROR,u=!1;break;case ze.SUBTITLE_TRACK:l=n?J.SUBTITLE_TRACK_LOAD_TIMEOUT:J.SUBTITLE_LOAD_ERROR,u=!1;break}c&&this.resetInternalLoader(e.type);const f={type:be.NETWORK_ERROR,details:l,fatal:u,url:e.url,loader:c,context:e,error:o,networkDetails:t,stats:s};if(i){const h=(t==null?void 0:t.url)||e.url;f.response=vr({url:h,data:void 0},i)}this.hls.trigger(A.ERROR,f)}handlePlaylistLoaded(e,t,n,i,s,a){const o=this.hls,{type:l,level:u,id:c,groupId:f,deliveryDirectives:h}=i,d=$c(t,i),m=Vg(i),x=typeof i.level=="number"&&m===De.MAIN?u:void 0;if(!e.fragments.length){const g=new Error("No Segments found in Playlist");o.trigger(A.ERROR,{type:be.NETWORK_ERROR,details:J.LEVEL_EMPTY_ERROR,fatal:!1,url:d,error:g,reason:g.message,response:t,context:i,level:x,parent:m,networkDetails:s,stats:n});return}e.targetduration||(e.playlistParsingError=new Error("Missing Target Duration"));const p=e.playlistParsingError;if(p){o.trigger(A.ERROR,{type:be.NETWORK_ERROR,details:J.LEVEL_PARSING_ERROR,fatal:!1,url:d,error:p,reason:p.message,response:t,context:i,level:x,parent:m,networkDetails:s,stats:n});return}switch(e.live&&a&&(a.getCacheAge&&(e.ageHeader=a.getCacheAge()||0),(!a.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),l){case ze.MANIFEST:case ze.LEVEL:o.trigger(A.LEVEL_LOADED,{details:e,level:x||0,id:c||0,stats:n,networkDetails:s,deliveryDirectives:h});break;case ze.AUDIO_TRACK:o.trigger(A.AUDIO_TRACK_LOADED,{details:e,id:c||0,groupId:f||"",stats:n,networkDetails:s,deliveryDirectives:h});break;case ze.SUBTITLE_TRACK:o.trigger(A.SUBTITLE_TRACK_LOADED,{details:e,id:c||0,groupId:f||"",stats:n,networkDetails:s,deliveryDirectives:h});break}}}function Qy(r,e){let t;try{t=new Event("addtrack")}catch{t=document.createEvent("Event"),t.initEvent("addtrack",!1,!1)}t.track=r,e.dispatchEvent(t)}function Jy(r,e){const t=r.mode;if(t==="disabled"&&(r.mode="hidden"),r.cues&&!r.cues.getCueById(e.id))try{if(r.addCue(e),!r.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(n){G.debug(`[texttrack-utils]: ${n}`);const i=new self.TextTrackCue(e.startTime,e.endTime,e.text);i.id=e.id,r.addCue(i)}t==="disabled"&&(r.mode=t)}function Ps(r){const e=r.mode;if(e==="disabled"&&(r.mode="hidden"),r.cues)for(let t=r.cues.length;t--;)r.removeCue(r.cues[t]);e==="disabled"&&(r.mode=e)}function vh(r,e,t,n){const i=r.mode;if(i==="disabled"&&(r.mode="hidden"),r.cues&&r.cues.length>0){const s=kw(r.cues,e,t);for(let a=0;a<s.length;a++)(!n||n(s[a]))&&r.removeCue(s[a])}i==="disabled"&&(r.mode=i)}function Iw(r,e){if(e<r[0].startTime)return 0;const t=r.length-1;if(e>r[t].endTime)return-1;let n=0,i=t;for(;n<=i;){const s=Math.floor((i+n)/2);if(e<r[s].startTime)i=s-1;else if(e>r[s].startTime&&n<t)n=s+1;else return s}return r[n].startTime-e<e-r[i].startTime?n:i}function kw(r,e,t){const n=[],i=Iw(r,e);if(i>-1)for(let s=i,a=r.length;s<a;s++){const o=r[s];if(o.startTime>=e&&o.endTime<=t)n.push(o);else if(o.startTime>t)return n}return n}var ln={audioId3:"org.id3",dateRange:"com.apple.quicktime.HLS",emsg:"https://aomedia.org/emsg/ID3"};const Ow=.25;function yh(){if(!(typeof self>"u"))return self.WebKitDataCue||self.VTTCue||self.TextTrackCue}const tl=(()=>{const r=yh();try{new r(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function zc(r,e){return r.getTime()/1e3-e}function Nw(r){return Uint8Array.from(r.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}class Pw{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null}_registerListeners(){const{hls:e}=this;e.on(A.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(A.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(A.MANIFEST_LOADING,this.onManifestLoading,this),e.on(A.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(A.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(A.LEVEL_UPDATED,this.onLevelUpdated,this)}_unregisterListeners(){const{hls:e}=this;e.off(A.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(A.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(A.MANIFEST_LOADING,this.onManifestLoading,this),e.off(A.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(A.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(A.LEVEL_UPDATED,this.onLevelUpdated,this)}onMediaAttached(e,t){this.media=t.media}onMediaDetaching(){!this.id3Track||(Ps(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(!!this.media){for(let t=0;t<e.length;t++){const n=e[t];if(n.kind==="metadata"&&n.label==="id3")return Qy(n,this.media),n}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues:n,enableID3MetadataCues:i}}}=this;if(!n&&!i)return;const{samples:s}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const a=yh();for(let o=0;o<s.length;o++){const l=s[o].type;if(l===ln.emsg&&!n||!i)continue;const u=Gy(s[o].data);if(u){const c=s[o].pts;let f=c+s[o].duration;f>tl&&(f=tl),f-c<=0&&(f=c+Ow);for(let d=0;d<u.length;d++){const m=u[d];if(!Vy(m)){this.updateId3CueEnds(c);const x=new a(c,f,"");x.value=m,l&&(x.type=l),this.id3Track.addCue(x)}}}}}updateId3CueEnds(e){var t;const n=(t=this.id3Track)==null?void 0:t.cues;if(n)for(let i=n.length;i--;){const s=n[i];s.startTime<e&&s.endTime===tl&&(s.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:n,type:i}){const{id3Track:s,hls:a}=this;if(!a)return;const{config:{enableEmsgMetadataCues:o,enableID3MetadataCues:l}}=a;if(s&&(o||l)){let u;i==="audio"?u=c=>c.type===ln.audioId3&&l:i==="video"?u=c=>c.type===ln.emsg&&o:u=c=>c.type===ln.audioId3&&l||c.type===ln.emsg&&o,vh(s,t,n,u)}}onLevelUpdated(e,{details:t}){if(!this.media||!t.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;const{dateRangeCuesAppended:n,id3Track:i}=this,{dateRanges:s}=t,a=Object.keys(s);if(i){const c=Object.keys(n).filter(f=>!a.includes(f));for(let f=c.length;f--;){const h=c[f];Object.keys(n[h].cues).forEach(d=>{i.removeCue(n[h].cues[d])}),delete n[h]}}const o=t.fragments[t.fragments.length-1];if(a.length===0||!_e(o==null?void 0:o.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const l=o.programDateTime/1e3-o.start,u=yh();for(let c=0;c<a.length;c++){const f=a[c],h=s[f],d=n[f],m=(d==null?void 0:d.cues)||{};let x=(d==null?void 0:d.durationKnown)||!1;const p=zc(h.startDate,l);let g=tl;const v=h.endDate;if(v)g=zc(v,l),x=!0;else if(h.endOnNext&&!x){const S=a.reduce((T,w)=>{const _=s[w];return _.class===h.class&&_.id!==w&&_.startDate>h.startDate&&T.push(_),T},[]).sort((T,w)=>T.startDate.getTime()-w.startDate.getTime())[0];S&&(g=zc(S.startDate,l),x=!0)}const E=Object.keys(h.attr);for(let S=0;S<E.length;S++){const T=E[S];if(!V1(T))continue;let w=m[T];if(w)x&&!d.durationKnown&&(w.endTime=g);else{let _=h.attr[T];w=new u(p,g,""),G1(T)&&(_=Nw(_)),w.value={key:T,data:_},w.type=ln.dateRange,w.id=f,this.id3Track.addCue(w),m[T]=w}}n[f]={cues:m,dateRange:h,durationKnown:x}}}}class Fw{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=()=>this.timeupdate(),this.hls=e,this.config=e.config,this.registerListeners()}get latency(){return this._latency||0}get maxLatency(){const{config:e,levelDetails:t}=this;return e.liveMaxLatencyDuration!==void 0?e.liveMaxLatencyDuration:t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const{levelDetails:e}=this;if(e===null)return null;const{holdBack:t,partHoldBack:n,targetduration:i}=e,{liveSyncDuration:s,liveSyncDurationCount:a,lowLatencyMode:o}=this.config,l=this.hls.userConfig;let u=o&&n||t;(l.liveSyncDuration||l.liveSyncDurationCount||u===0)&&(u=s!==void 0?s:a*i);const c=i,f=1;return u+Math.min(this.stallCount*f,c)}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency,n=this.levelDetails;if(e===null||t===null||n===null)return null;const i=n.edge,s=e-t-this.edgeStalled,a=i-n.totalduration,o=i-(this.config.lowLatencyMode&&n.partTarget||n.targetduration);return Math.min(Math.max(a,s),o)}get drift(){const{levelDetails:e}=this;return e===null?1:e.drift}get edgeStalled(){const{levelDetails:e}=this;if(e===null)return 0;const t=(this.config.lowLatencyMode&&e.partTarget||e.targetduration)*3;return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e,levelDetails:t}=this;if(!e||!t)return 0;const n=e.buffered.length;return(n?e.buffered.end(n-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null}registerListeners(){this.hls.on(A.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(A.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(A.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(A.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(A.ERROR,this.onError,this)}unregisterListeners(){this.hls.off(A.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(A.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.off(A.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(A.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.off(A.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)}onManifestLoading(){this.levelDetails=null,this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){this.levelDetails=t,t.advanced&&this.timeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)}onError(e,t){var n;t.details===J.BUFFER_STALLED_ERROR&&(this.stallCount++,(n=this.levelDetails)!=null&&n.live&&G.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))}timeupdate(){const{media:e,levelDetails:t}=this;if(!e||!t)return;this.currentTime=e.currentTime;const n=this.computeLatency();if(n===null)return;this._latency=n;const{lowLatencyMode:i,maxLiveSyncPlaybackRate:s}=this.config;if(!i||s===1)return;const a=this.targetLatency;if(a===null)return;const o=n-a,l=Math.min(this.maxLatency,a+t.targetduration),u=o<l;if(t.live&&u&&o>.05&&this.forwardBufferLength>1){const c=Math.min(2,Math.max(1,s)),f=Math.round(2/(1+Math.exp(-.75*o-this.edgeStalled))*20)/20;e.playbackRate=Math.min(c,Math.max(1,f))}else e.playbackRate!==1&&e.playbackRate!==0&&(e.playbackRate=1)}estimateLiveEdge(){const{levelDetails:e}=this;return e===null?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return e===null?null:e-this.currentTime}}const Eh=["NONE","TYPE-0","TYPE-1",null];var Va={No:"",Yes:"YES",v2:"v2"};function Mw(r,e){const{canSkipUntil:t,canSkipDateRanges:n,endSN:i}=r,s=e!==void 0?e-i:0;return t&&s<t?n?Va.v2:Va.Yes:Va.No}class Gg{constructor(e,t,n){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=n}addDirectives(e){const t=new self.URL(e);return this.msn!==void 0&&t.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class lo{constructor(e){this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.unknownCodecs=e.unknownCodecs,this.codecSet=[e.videoCodec,e.audioCodec].filter(t=>t).join(",").replace(/\.[^.,]+/g,"")}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get attrs(){return this._attrs[this._urlId]}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get uri(){return this.url[this._urlId]||""}get urlId(){return this._urlId}set urlId(e){const t=e%this.url.length;this._urlId!==t&&(this.fragmentError=0,this.loadError=0,this.details=void 0,this._urlId=t)}get audioGroupId(){var e;return(e=this.audioGroupIds)==null?void 0:e[this.urlId]}get textGroupId(){var e;return(e=this.textGroupIds)==null?void 0:e[this.urlId]}addFallback(e){this.url.push(e.url),this._attrs.push(e.attrs)}}function Vc(r,e){const t=e.startPTS;if(_e(t)){let n=0,i;e.sn>r.sn?(n=t-r.start,i=r):(n=r.start-t,i=e),i.duration!==n&&(i.duration=n)}else e.sn>r.sn?r.cc===e.cc&&r.minEndPTS?e.start=r.start+(r.minEndPTS-r.start):e.start=r.start+r.duration:e.start=Math.max(r.start-e.duration,0)}function eE(r,e,t,n,i,s){n-t<=0&&(G.warn("Fragment should have a positive duration",e),n=t+e.duration,s=i+e.duration);let o=t,l=n;const u=e.startPTS,c=e.endPTS;if(_e(u)){const p=Math.abs(u-t);_e(e.deltaPTS)?e.deltaPTS=Math.max(p,e.deltaPTS):e.deltaPTS=p,o=Math.max(t,u),t=Math.min(t,u),i=Math.min(i,e.startDTS),l=Math.min(n,c),n=Math.max(n,c),s=Math.max(s,e.endDTS)}const f=t-e.start;e.start!==0&&(e.start=t),e.duration=n-e.start,e.startPTS=t,e.maxStartPTS=o,e.startDTS=i,e.endPTS=n,e.minEndPTS=l,e.endDTS=s;const h=e.sn;if(!r||h<r.startSN||h>r.endSN)return 0;let d;const m=h-r.startSN,x=r.fragments;for(x[m]=e,d=m;d>0;d--)Vc(x[d],x[d-1]);for(d=m;d<x.length-1;d++)Vc(x[d],x[d+1]);return r.fragmentHint&&Vc(x[x.length-1],r.fragmentHint),r.PTSKnown=r.alignedSliding=!0,f}function Bw(r,e){let t=null;const n=r.fragments;for(let l=n.length-1;l>=0;l--){const u=n[l].initSegment;if(u){t=u;break}}r.fragmentHint&&delete r.fragmentHint.endPTS;let i=0,s;if(zw(r,e,(l,u)=>{l.relurl&&(i=l.cc-u.cc),_e(l.startPTS)&&_e(l.endPTS)&&(u.start=u.startPTS=l.startPTS,u.startDTS=l.startDTS,u.maxStartPTS=l.maxStartPTS,u.endPTS=l.endPTS,u.endDTS=l.endDTS,u.minEndPTS=l.minEndPTS,u.duration=l.endPTS-l.startPTS,u.duration&&(s=u),e.PTSKnown=e.alignedSliding=!0),u.elementaryStreams=l.elementaryStreams,u.loader=l.loader,u.stats=l.stats,u.urlId=l.urlId,l.initSegment&&(u.initSegment=l.initSegment,t=l.initSegment)}),t&&(e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments).forEach(u=>{var c;(!u.initSegment||u.initSegment.relurl===((c=t)==null?void 0:c.relurl))&&(u.initSegment=t)}),e.skippedSegments)if(e.deltaUpdateFailed=e.fragments.some(l=>!l),e.deltaUpdateFailed){G.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let l=e.skippedSegments;l--;)e.fragments.shift();e.startSN=e.fragments[0].sn,e.startCC=e.fragments[0].cc}else e.canSkipDateRanges&&(e.dateRanges=Uw(r.dateRanges,e.dateRanges,e.recentlyRemovedDateranges));const a=e.fragments;if(i){G.warn("discontinuity sliding from playlist, take drift into account");for(let l=0;l<a.length;l++)a[l].cc+=i}e.skippedSegments&&(e.startCC=e.fragments[0].cc),$w(r.partList,e.partList,(l,u)=>{u.elementaryStreams=l.elementaryStreams,u.stats=l.stats}),s?eE(e,s,s.startPTS,s.endPTS,s.startDTS,s.endDTS):tE(r,e),a.length&&(e.totalduration=e.edge-a[0].start),e.driftStartTime=r.driftStartTime,e.driftStart=r.driftStart;const o=e.advancedDateTime;if(e.advanced&&o){const l=e.edge;e.driftStart||(e.driftStartTime=o,e.driftStart=l),e.driftEndTime=o,e.driftEnd=l}else e.driftEndTime=r.driftEndTime,e.driftEnd=r.driftEnd,e.advancedDateTime=r.advancedDateTime}function Uw(r,e,t){const n=At({},r);return t&&t.forEach(i=>{delete n[i]}),Object.keys(e).forEach(i=>{const s=new Fy(e[i].attr,n[i]);s.isValid?n[i]=s:G.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${JSON.stringify(e[i].attr)}"`)}),n}function $w(r,e,t){if(r&&e){let n=0;for(let i=0,s=r.length;i<=s;i++){const a=r[i],o=e[i+n];a&&o&&a.index===o.index&&a.fragment.sn===o.fragment.sn?t(a,o):n--}}}function zw(r,e,t){const n=e.skippedSegments,i=Math.max(r.startSN,e.startSN)-e.startSN,s=(r.fragmentHint?1:0)+(n?e.endSN:Math.min(r.endSN,e.endSN))-e.startSN,a=e.startSN-r.startSN,o=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,l=r.fragmentHint?r.fragments.concat(r.fragmentHint):r.fragments;for(let u=i;u<=s;u++){const c=l[a+u];let f=o[u];n&&!f&&u<n&&(f=e.fragments[u]=c),c&&f&&t(c,f)}}function tE(r,e){const t=e.startSN+e.skippedSegments-r.startSN,n=r.fragments;t<0||t>=n.length||xh(e,n[t].start)}function xh(r,e){if(e){const t=r.fragments;for(let n=r.skippedSegments;n<t.length;n++)t[n].start+=e;r.fragmentHint&&(r.fragmentHint.start+=e)}}function Vw(r,e=1/0){let t=1e3*r.targetduration;if(r.updated){const n=r.fragments,i=4;if(n.length&&t*i>e){const s=n[n.length-1].duration*1e3;s<t&&(t=s)}}else t/=2;return Math.round(t)}function Gw(r,e,t){if(!(r!=null&&r.details))return null;const n=r.details;let i=n.fragments[e-n.startSN];return i||(i=n.fragmentHint,i&&i.sn===e)?i:e<n.startSN&&t&&t.sn===e?t:null}function Wg(r,e,t){var n;return r!=null&&r.details?rE((n=r.details)==null?void 0:n.partList,e,t):null}function rE(r,e,t){if(r)for(let n=r.length;n--;){const i=r[n];if(i.index===t&&i.fragment.sn===e)return i}return null}function iu(r){switch(r.details){case J.FRAG_LOAD_TIMEOUT:case J.KEY_LOAD_TIMEOUT:case J.LEVEL_LOAD_TIMEOUT:case J.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function Hg(r,e){const t=iu(e);return r.default[`${t?"timeout":"error"}Retry`]}function Id(r,e){const t=r.backoff==="linear"?1:Math.pow(2,e);return Math.min(t*r.retryDelayMs,r.maxRetryDelayMs)}function jg(r){return vr(vr({},r),{errorRetry:null,timeoutRetry:null})}function su(r,e,t,n){return!!r&&e<r.maxNumRetry&&(Ww(n)||!!t)}function Ww(r){return r===0&&navigator.onLine===!1||!!r&&(r<400||r>499)}const nE={search:function(r,e){let t=0,n=r.length-1,i=null,s=null;for(;t<=n;){i=(t+n)/2|0,s=r[i];const a=e(s);if(a>0)t=i+1;else if(a<0)n=i-1;else return s}return null}};function Hw(r,e,t){if(e===null||!Array.isArray(r)||!r.length||!_e(e))return null;const n=r[0].programDateTime;if(e<(n||0))return null;const i=r[r.length-1].endProgramDateTime;if(e>=(i||0))return null;t=t||0;for(let s=0;s<r.length;++s){const a=r[s];if(jw(e,t,a))return a}return null}function uo(r,e,t=0,n=0){let i=null;if(r?i=e[r.sn-e[0].sn+1]||null:t===0&&e[0].start===0&&(i=e[0]),i&&Th(t,n,i)===0)return i;const s=nE.search(e,Th.bind(null,t,n));return s&&(s!==r||!i)?s:i}function Th(r=0,e=0,t){if(t.start<=r&&t.start+t.duration>r)return 0;const n=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-n<=r?1:t.start-n>r&&t.start?-1:0}function jw(r,e,t){const n=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0))*1e3;return(t.endProgramDateTime||0)-n>r}function Kw(r,e){return nE.search(r,t=>t.cc<e?1:t.cc>e?-1:0)}const qw=3e5;var lr={DoNothing:0,SendEndCallback:1,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,InsertDiscontinuity:4,RetryRequest:5},rn={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,SwitchToSDR:4};class Yw{constructor(e){this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.log=void 0,this.warn=void 0,this.error=void 0,this.hls=e,this.log=G.log.bind(G,"[info]:"),this.warn=G.warn.bind(G,"[warning]:"),this.error=G.error.bind(G,"[error]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(A.ERROR,this.onError,this),e.on(A.MANIFEST_LOADING,this.onManifestLoading,this),e.on(A.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;!e||(e.off(A.ERROR,this.onError,this),e.off(A.ERROR,this.onErrorOut,this),e.off(A.MANIFEST_LOADING,this.onManifestLoading,this),e.off(A.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(e){this.playlistError=0}stopLoad(){}getVariantLevelIndex(e){return(e==null?void 0:e.type)===De.MAIN?e.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(e,t){var n;if(t.fatal)return;const i=this.hls,s=t.context;switch(t.details){case J.FRAG_LOAD_ERROR:case J.FRAG_LOAD_TIMEOUT:case J.KEY_LOAD_ERROR:case J.KEY_LOAD_TIMEOUT:t.errorAction=this.getFragRetryOrSwitchAction(t);return;case J.FRAG_GAP:case J.FRAG_PARSING_ERROR:case J.FRAG_DECRYPT_ERROR:{t.errorAction=this.getFragRetryOrSwitchAction(t),t.errorAction.action=lr.SendAlternateToPenaltyBox;return}case J.LEVEL_EMPTY_ERROR:case J.LEVEL_PARSING_ERROR:{var a,o;const l=t.parent===De.MAIN?t.level:i.loadLevel;t.details===J.LEVEL_EMPTY_ERROR&&!!((a=t.context)!=null&&(o=a.levelDetails)!=null&&o.live)?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,l):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,l))}return;case J.LEVEL_LOAD_ERROR:case J.LEVEL_LOAD_TIMEOUT:typeof(s==null?void 0:s.level)=="number"&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,s.level));return;case J.AUDIO_TRACK_LOAD_ERROR:case J.AUDIO_TRACK_LOAD_TIMEOUT:case J.SUBTITLE_LOAD_ERROR:case J.SUBTITLE_TRACK_LOAD_TIMEOUT:if(s){const l=i.levels[i.loadLevel];if(l&&(s.type===ze.AUDIO_TRACK&&s.groupId===l.audioGroupId||s.type===ze.SUBTITLE_TRACK&&s.groupId===l.textGroupId)){t.errorAction=this.getPlaylistRetryOrSwitchAction(t,i.loadLevel),t.errorAction.action=lr.SendAlternateToPenaltyBox,t.errorAction.flags=rn.MoveAllAlternatesMatchingHost;return}}return;case J.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const l=i.levels[i.loadLevel],u=l==null?void 0:l.attrs["HDCP-LEVEL"];u&&(t.errorAction={action:lr.SendAlternateToPenaltyBox,flags:rn.MoveAllAlternatesMatchingHDCP,hdcpLevel:u})}return;case J.BUFFER_ADD_CODEC_ERROR:case J.REMUX_ALLOC_ERROR:t.errorAction=this.getLevelSwitchAction(t,(n=t.level)!=null?n:i.loadLevel);return;case J.INTERNAL_EXCEPTION:case J.BUFFER_APPENDING_ERROR:case J.BUFFER_APPEND_ERROR:case J.BUFFER_FULL_ERROR:case J.LEVEL_SWITCH_ERROR:case J.BUFFER_STALLED_ERROR:case J.BUFFER_SEEK_OVER_HOLE:case J.BUFFER_NUDGE_ON_STALL:t.errorAction={action:lr.DoNothing,flags:rn.None};return}if(t.type===be.KEY_SYSTEM_ERROR){const l=this.getVariantLevelIndex(t.frag);t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,l);return}}getPlaylistRetryOrSwitchAction(e,t){var n;const i=this.hls,s=Hg(i.config.playlistLoadPolicy,e),a=this.playlistError++,o=(n=e.response)==null?void 0:n.code;if(su(s,a,iu(e),o))return{action:lr.RetryRequest,flags:rn.None,retryConfig:s,retryCount:a};const u=this.getLevelSwitchAction(e,t);return s&&(u.retryConfig=s,u.retryCount=a),u}getFragRetryOrSwitchAction(e){const t=this.hls,n=this.getVariantLevelIndex(e.frag),i=t.levels[n],{fragLoadPolicy:s,keyLoadPolicy:a}=t.config,o=Hg(e.details.startsWith("key")?a:s,e),l=t.levels.reduce((f,h)=>f+h.fragmentError,0);if(i){var u;e.details!==J.FRAG_GAP&&i.fragmentError++;const f=(u=e.response)==null?void 0:u.code;if(su(o,l,iu(e),f))return{action:lr.RetryRequest,flags:rn.None,retryConfig:o,retryCount:l}}const c=this.getLevelSwitchAction(e,n);return o&&(c.retryConfig=o,c.retryCount=l),c}getLevelSwitchAction(e,t){const n=this.hls;t==null&&(t=n.loadLevel);const i=this.hls.levels[t];if(i&&(i.loadError++,n.autoLevelEnabled)){var s,a;let o=-1;const l=n.levels,u=(s=e.frag)==null?void 0:s.type,{type:c,groupId:f}=(a=e.context)!=null?a:{};for(let h=l.length;h--;){const d=(h+n.loadLevel)%l.length;if(d!==n.loadLevel&&l[d].loadError===0){const m=l[d];if(e.details===J.FRAG_GAP&&e.frag){const x=l[d].details;if(x){const p=uo(e.frag,x.fragments,e.frag.start);if(p!=null&&p.gap)continue}}else{if(c===ze.AUDIO_TRACK&&f===m.audioGroupId||c===ze.SUBTITLE_TRACK&&f===m.textGroupId)continue;if(u===De.AUDIO&&i.audioGroupId===m.audioGroupId||u===De.SUBTITLE&&i.textGroupId===m.textGroupId)continue}o=d;break}}if(o>-1&&n.loadLevel!==o)return e.levelRetry=!0,this.playlistError=0,{action:lr.SendAlternateToPenaltyBox,flags:rn.None,nextAutoLevel:o}}return{action:lr.SendAlternateToPenaltyBox,flags:rn.MoveAllAlternatesMatchingHost}}onErrorOut(e,t){var n;switch((n=t.errorAction)==null?void 0:n.action){case lr.DoNothing:break;case lr.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(t),!t.errorAction.resolved&&t.details!==J.FRAG_GAP&&(t.fatal=!0);break}if(t.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(e){const t=this.hls,n=e.errorAction;if(!n)return;const{flags:i,hdcpLevel:s,nextAutoLevel:a}=n;switch(i){case rn.None:this.switchLevel(e,a);break;case rn.MoveAllAlternatesMatchingHost:n.resolved||(n.resolved=this.redundantFailover(e));break;case rn.MoveAllAlternatesMatchingHDCP:s&&(t.maxHdcpLevel=Eh[Eh.indexOf(s)-1],n.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`);break}n.resolved||this.switchLevel(e,a)}switchLevel(e,t){t!==void 0&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel)}redundantFailover(e){const{hls:t,penalizedRenditions:n}=this,i=e.parent===De.MAIN?e.level:t.loadLevel,s=t.levels[i],a=s.url.length,o=e.frag?e.frag.urlId:s.urlId;s.urlId===o&&(!e.frag||s.details)&&this.penalizeRendition(s,e);for(let l=1;l<a;l++){const u=(o+l)%a,c=n[u];if(!c||Xw(c,e,n[o]))return this.warn(`Switching to Redundant Stream ${u+1}/${a}: "${s.url[u]}" after ${e.details}`),this.playlistError=0,t.levels.forEach(f=>{f.urlId=u}),t.nextLoadLevel=i,!0}return!1}penalizeRendition(e,t){const{penalizedRenditions:n}=this,i=n[e.urlId]||{lastErrorPerfMs:0,errors:[],details:void 0};i.lastErrorPerfMs=performance.now(),i.errors.push(t),i.details=e.details,n[e.urlId]=i}}function Xw(r,e,t){if(performance.now()-r.lastErrorPerfMs>qw)return!0;const n=r.details;if(e.details===J.FRAG_GAP&&n&&e.frag){const i=e.frag.start,s=uo(null,n.fragments,i);if(s&&!s.gap)return!0}if(t&&r.errors.length<t.errors.length){const i=r.errors[r.errors.length-1];if(n&&i.frag&&e.frag&&Math.abs(i.frag.start-e.frag.start)>n.targetduration*3)return!0}return!1}class kd{constructor(e,t){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.log=void 0,this.warn=void 0,this.log=G.log.bind(G,`${t}:`),this.warn=G.warn.bind(G,`${t}:`),this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){clearTimeout(this.timer),this.timer=-1}startLoad(){this.canLoad=!0,this.requestScheduled=-1,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t){const n=t==null?void 0:t.renditionReports;if(n){let i=-1;for(let s=0;s<n.length;s++){const a=n[s];let o;try{o=new self.URL(a.URI,t.url).href}catch(l){G.warn(`Could not construct new URL for Rendition Report: ${l}`),o=a.URI||""}if(o===e){i=s;break}else o===e.substring(0,o.length)&&(i=s)}if(i!==-1){const s=n[i],a=parseInt(s["LAST-MSN"])||(t==null?void 0:t.lastPartSn);let o=parseInt(s["LAST-PART"])||(t==null?void 0:t.lastPartIndex);if(this.hls.config.lowLatencyMode){const l=Math.min(t.age-t.partTarget,t.targetduration);o>=0&&l>t.partTarget&&(o+=1)}return new Gg(a,o>=0?o:void 0,Va.No)}}}loadPlaylist(e){this.requestScheduled===-1&&(this.requestScheduled=self.performance.now())}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}shouldReloadPlaylist(e){return this.timer===-1&&this.requestScheduled===-1&&this.shouldLoadPlaylist(e)}playlistLoaded(e,t,n){const{details:i,stats:s}=t,a=self.performance.now(),o=s.loading.first?Math.max(0,a-s.loading.first):0;if(i.advancedDateTime=Date.now()-o,i.live||n!=null&&n.live){if(i.reloaded(n),n&&this.log(`live playlist ${e} ${i.advanced?"REFRESHED "+i.lastPartSn+"-"+i.lastPartIndex:"MISSED"}`),n&&i.fragments.length>0&&Bw(n,i),!this.canLoad||!i.live)return;let l,u,c;if(i.canBlockReload&&i.endSN&&i.advanced){const p=this.hls.config.lowLatencyMode,g=i.lastPartSn,v=i.endSN,E=i.lastPartIndex,S=E!==-1,T=g===v,w=p?0:E;S?(u=T?v+1:g,c=T?w:E+1):u=v+1;const _=i.age,C=_+i.ageHeader;let O=Math.min(C-i.partTarget,i.targetduration*1.5);if(O>0){if(n&&O>n.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${n.tuneInGoal} to: ${O} with playlist age: ${i.age}`),O=0;else{const L=Math.floor(O/i.targetduration);if(u+=L,c!==void 0){const V=Math.round(O%i.targetduration/i.partTarget);c+=V}this.log(`CDN Tune-in age: ${i.ageHeader}s last advanced ${_.toFixed(2)}s goal: ${O} skip sn ${L} to part ${c}`)}i.tuneInGoal=O}if(l=this.getDeliveryDirectives(i,t.deliveryDirectives,u,c),p||!T){this.loadPlaylist(l);return}}else i.canBlockReload&&(l=this.getDeliveryDirectives(i,t.deliveryDirectives,u,c));const f=this.hls.mainForwardBufferInfo,h=f?f.end-f.len:0,d=(i.edge-h)*1e3,m=Vw(i,d);i.updated&&a>this.requestScheduled+m&&(this.requestScheduled=s.loading.start),u!==void 0&&i.canBlockReload?this.requestScheduled=s.loading.first+m-(i.partTarget*1e3||1e3):this.requestScheduled===-1||this.requestScheduled+m<a?this.requestScheduled=a:this.requestScheduled-a<=0&&(this.requestScheduled+=m);let x=this.requestScheduled-a;x=Math.max(0,x),this.log(`reload live playlist ${e} in ${Math.round(x)} ms`),this.timer=self.setTimeout(()=>this.loadPlaylist(l),x)}else this.clearTimer()}getDeliveryDirectives(e,t,n,i){let s=Mw(e,n);return t!=null&&t.skip&&e.deltaUpdateFailed&&(n=t.msn,i=t.part,s=Va.No),new Gg(n,i,s)}checkRetry(e){const t=e.details,n=iu(e),i=e.errorAction,{action:s,retryCount:a=0,retryConfig:o}=i||{},l=!!i&&!!o&&(s===lr.RetryRequest||!i.resolved&&s===lr.SendAlternateToPenaltyBox);if(l){var u;if(this.requestScheduled=-1,a>=o.maxNumRetry)return!1;if(n&&(u=e.context)!=null&&u.deliveryDirectives)this.warn(`Retrying playlist loading ${a+1}/${o.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const c=Id(o,a);this.timer=self.setTimeout(()=>this.loadPlaylist(),c),this.warn(`Retrying playlist loading ${a+1}/${o.maxNumRetry} after "${t}" in ${c}ms`)}e.levelRetry=!0,i.resolved=!0}return l}}let Gc;class Zw extends kd{constructor(e,t){super(e,"[level-controller]"),this._levels=[],this._firstLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(A.MANIFEST_LOADING,this.onManifestLoading,this),e.on(A.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(A.LEVEL_LOADED,this.onLevelLoaded,this),e.on(A.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(A.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(A.FRAG_LOADED,this.onFragLoaded,this),e.on(A.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(A.MANIFEST_LOADING,this.onManifestLoading,this),e.off(A.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(A.LEVEL_LOADED,this.onLevelLoaded,this),e.off(A.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(A.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(A.FRAG_LOADED,this.onFragLoaded,this),e.off(A.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}startLoad(){this._levels.forEach(t=>{t.loadError=0,t.fragmentError=0}),super.startLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[]}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const n=[],i={};let s;t.levels.forEach(a=>{var o;const l=a.attrs;((o=a.audioCodec)==null?void 0:o.indexOf("mp4a.40.34"))!==-1&&(Gc||(Gc=/chrome|firefox/i.test(navigator.userAgent)),Gc&&(a.audioCodec=void 0));const{AUDIO:u,CODECS:c,"FRAME-RATE":f,"PATHWAY-ID":h,RESOLUTION:d,SUBTITLES:m}=l,p=`${`${h||"."}-`}${a.bitrate}-${d}-${f}-${c}`;s=i[p],s?s.addFallback(a):(s=new lo(a),i[p]=s,n.push(s)),au(s,"audio",u),au(s,"text",m)}),this.filterAndSortMediaOptions(n,t)}filterAndSortMediaOptions(e,t){let n=[],i=[],s=!1,a=!1,o=!1,l=e.filter(({audioCodec:d,videoCodec:m,width:x,height:p,unknownCodecs:g})=>(s||(s=!!(x&&p)),a||(a=!!m),o||(o=!!d),!(g!=null&&g.length)&&(!d||Uc(d,"audio"))&&(!m||Uc(m,"video"))));if((s||a)&&o&&(l=l.filter(({videoCodec:d,width:m,height:x})=>!!d||!!(m&&x))),l.length===0){Promise.resolve().then(()=>{if(this.hls){const d=new Error("no level with compatible codecs found in manifest");this.hls.trigger(A.ERROR,{type:be.MEDIA_ERROR,details:J.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:d,reason:d.message})}});return}t.audioTracks&&(n=t.audioTracks.filter(d=>!d.audioCodec||Uc(d.audioCodec,"audio")),Kg(n)),t.subtitles&&(i=t.subtitles,Kg(i));const u=l.slice(0);l.sort((d,m)=>d.attrs["HDCP-LEVEL"]!==m.attrs["HDCP-LEVEL"]?(d.attrs["HDCP-LEVEL"]||"")>(m.attrs["HDCP-LEVEL"]||"")?1:-1:d.bitrate!==m.bitrate?d.bitrate-m.bitrate:d.attrs["FRAME-RATE"]!==m.attrs["FRAME-RATE"]?d.attrs.decimalFloatingPoint("FRAME-RATE")-m.attrs.decimalFloatingPoint("FRAME-RATE"):d.attrs.SCORE!==m.attrs.SCORE?d.attrs.decimalFloatingPoint("SCORE")-m.attrs.decimalFloatingPoint("SCORE"):s&&d.height!==m.height?d.height-m.height:0);let c=u[0];if(this.steering&&(l=this.steering.filterParsedLevels(l),l.length!==u.length)){for(let d=0;d<u.length;d++)if(u[d].pathwayId===l[0].pathwayId){c=u[d];break}}this._levels=l;for(let d=0;d<l.length;d++)if(l[d]===c){this._firstLevel=d,this.log(`manifest loaded, ${l.length} level(s) found, first bitrate: ${c.bitrate}`);break}const f=o&&!a,h={levels:l,audioTracks:n,subtitleTracks:i,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:o,video:a,altAudio:!f&&n.some(d=>!!d.url)};this.hls.trigger(A.MANIFEST_PARSED,h),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}get levels(){return this._levels.length===0?null:this._levels}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(t.length===0)return;if(e<0||e>=t.length){const c=new Error("invalid level idx"),f=e<0;if(this.hls.trigger(A.ERROR,{type:be.OTHER_ERROR,details:J.LEVEL_SWITCH_ERROR,level:e,fatal:f,error:c,reason:c.message}),f)return;e=Math.min(e,t.length-1)}const n=this.currentLevelIndex,i=this.currentLevel,s=i?i.attrs["PATHWAY-ID"]:void 0,a=t[e],o=a.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=a,n===e&&a.details&&i&&s===o)return;this.log(`Switching to level ${e}${o?" with Pathway "+o:""} from level ${n}${s?" with Pathway "+s:""}`);const l=At({},a,{level:e,maxBitrate:a.maxBitrate,attrs:a.attrs,uri:a.uri,urlId:a.urlId});delete l._attrs,delete l._urlId,this.hls.trigger(A.LEVEL_SWITCHING,l);const u=a.details;if(!u||u.live){const c=this.switchParams(a.uri,i==null?void 0:i.details);this.loadPlaylist(c)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,this._startLevel===void 0&&(this._startLevel=e),e!==-1&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(this._startLevel===void 0){const e=this.hls.config.startLevel;return e!==void 0?e:this._firstLevel}else return this._startLevel}set startLevel(e){this._startLevel=e}onError(e,t){t.fatal||!t.context||t.context.type===ze.LEVEL&&t.context.level===this.level&&this.checkRetry(t)}onFragLoaded(e,{frag:t}){if(t!==void 0&&t.type===De.MAIN){const n=this._levels[t.level];n!==void 0&&(n.loadError=0)}}onLevelLoaded(e,t){var n;const{level:i,details:s}=t,a=this._levels[i];if(!a){var o;this.warn(`Invalid level index ${i}`),(o=t.deliveryDirectives)!=null&&o.skip&&(s.deltaUpdateFailed=!0);return}i===this.currentLevelIndex?(a.fragmentError===0&&(a.loadError=0),this.playlistLoaded(i,t,a.details)):(n=t.deliveryDirectives)!=null&&n.skip&&(s.deltaUpdateFailed=!0)}onAudioTrackSwitched(e,t){const n=this.currentLevel;if(!n)return;const i=this.hls.audioTracks[t.id].groupId;if(n.audioGroupIds&&n.audioGroupId!==i){let s=-1;for(let a=0;a<n.audioGroupIds.length;a++)if(n.audioGroupIds[a]===i){s=a;break}s!==-1&&s!==n.urlId&&(n.urlId=s,this.canLoad&&this.startLoad())}}loadPlaylist(e){super.loadPlaylist();const t=this.currentLevelIndex,n=this.currentLevel;if(n&&this.shouldLoadPlaylist(n)){const i=n.urlId;let s=n.uri;if(e)try{s=e.addDirectives(s)}catch(o){this.warn(`Could not construct new URL with HLS Delivery Directives: ${o}`)}const a=n.attrs["PATHWAY-ID"];this.log(`Loading level index ${t}${(e==null?void 0:e.msn)!==void 0?" at sn "+e.msn+" part "+e.part:""} with${a?" Pathway "+a:""} URI ${i+1}/${n.url.length} ${s}`),this.clearTimer(),this.hls.trigger(A.LEVEL_LOADING,{url:s,level:t,id:i,deliveryDirectives:e||null})}}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=e)}removeLevel(e,t){const n=(s,a)=>a!==t,i=this._levels.filter((s,a)=>a!==e?!0:s.url.length>1&&t!==void 0?(s.url=s.url.filter(n),s.audioGroupIds&&(s.audioGroupIds=s.audioGroupIds.filter(n)),s.textGroupIds&&(s.textGroupIds=s.textGroupIds.filter(n)),s.urlId=0,!0):(this.steering&&this.steering.removeLevel(s),!1));this.hls.trigger(A.LEVELS_UPDATED,{levels:i})}onLevelsUpdated(e,{levels:t}){t.forEach((n,i)=>{const{details:s}=n;s!=null&&s.fragments&&s.fragments.forEach(a=>{a.level=i})}),this._levels=t}}function au(r,e,t){!t||(e==="audio"?(r.audioGroupIds||(r.audioGroupIds=[]),r.audioGroupIds[r.url.length-1]=t):e==="text"&&(r.textGroupIds||(r.textGroupIds=[]),r.textGroupIds[r.url.length-1]=t))}function Kg(r){const e={};r.forEach(t=>{const n=t.groupId||"";t.id=e[n]=e[n]||0,e[n]++})}var Ft={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class Qw{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(A.BUFFER_APPENDED,this.onBufferAppended,this),e.on(A.FRAG_BUFFERED,this.onFragBuffered,this),e.on(A.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls:e}=this;e.off(A.BUFFER_APPENDED,this.onBufferAppended,this),e.off(A.FRAG_BUFFERED,this.onFragBuffered,this),e.off(A.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const n=this.activePartLists[t];if(n)for(let i=n.length;i--;){const s=n[i];if(!s)break;const a=s.end;if(s.start<=e&&a!==null&&e<=a)return s}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){const{fragments:n}=this,i=Object.keys(n);for(let s=i.length;s--;){const a=n[i[s]];if((a==null?void 0:a.body.type)===t&&a.buffered){const o=a.body;if(o.start<=e&&e<=o.end)return o}}return null}detectEvictedFragments(e,t,n,i){this.timeRanges&&(this.timeRanges[e]=t);const s=(i==null?void 0:i.fragment.sn)||-1;Object.keys(this.fragments).forEach(a=>{const o=this.fragments[a];if(!o||s>=o.body.sn)return;if(!o.buffered&&!o.loaded){o.body.type===n&&this.removeFragment(o.body);return}const l=o.range[e];!l||l.time.some(u=>{const c=!this.isTimeBuffered(u.startPTS,u.endPTS,t);return c&&this.removeFragment(o.body),c})})}detectPartialFragments(e){const t=this.timeRanges,{frag:n,part:i}=e;if(!t||n.sn==="initSegment")return;const s=cs(n),a=this.fragments[s];if(!a)return;const o=!n.relurl;Object.keys(t).forEach(l=>{const u=n.elementaryStreams[l];if(!u)return;const c=t[l],f=o||u.partial===!0;a.range[l]=this.getBufferedTimes(n,i,f,c)}),a.loaded=null,Object.keys(a.range).length?(a.buffered=!0,a.body.endList&&(this.endListFragments[a.body.type]=a),rl(a)||this.removeParts(n.sn-1,n.type)):this.removeFragment(a.body)}removeParts(e,t){const n=this.activePartLists[t];!n||(this.activePartLists[t]=n.filter(i=>i.fragment.sn>=e))}fragBuffered(e,t){const n=cs(e);let i=this.fragments[n];!i&&t&&(i=this.fragments[n]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),i&&(i.loaded=null,i.buffered=!0)}getBufferedTimes(e,t,n,i){const s={time:[],partial:n},a=e.start,o=e.end,l=e.minEndPTS||o,u=e.maxStartPTS||a;for(let c=0;c<i.length;c++){const f=i.start(c)-this.bufferPadding,h=i.end(c)+this.bufferPadding;if(u>=f&&l<=h){s.time.push({startPTS:Math.max(a,i.start(c)),endPTS:Math.min(o,i.end(c))});break}else if(a<h&&o>f)s.partial=!0,s.time.push({startPTS:Math.max(a,i.start(c)),endPTS:Math.min(o,i.end(c))});else if(o<=f)break}return s}getPartialFragment(e){let t=null,n,i,s,a=0;const{bufferPadding:o,fragments:l}=this;return Object.keys(l).forEach(u=>{const c=l[u];!c||rl(c)&&(i=c.body.start-o,s=c.body.end+o,e>=i&&e<=s&&(n=Math.min(e-i,s-e),a<=n&&(t=c.body,a=n)))}),t}isEndListAppended(e){const t=this.endListFragments[e];return t!==void 0&&(t.buffered||rl(t))}getState(e){const t=cs(e),n=this.fragments[t];return n?n.buffered?rl(n)?Ft.PARTIAL:Ft.OK:Ft.APPENDING:Ft.NOT_LOADED}isTimeBuffered(e,t,n){let i,s;for(let a=0;a<n.length;a++){if(i=n.start(a)-this.bufferPadding,s=n.end(a)+this.bufferPadding,e>=i&&t<=s)return!0;if(t<=i)return!1}return!1}onFragLoaded(e,t){const{frag:n,part:i}=t;if(n.sn==="initSegment"||n.bitrateTest)return;const s=i?null:t,a=cs(n);this.fragments[a]={body:n,appendedPTS:null,loaded:s,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:n,part:i,timeRanges:s}=t;if(n.sn==="initSegment")return;const a=n.type;if(i){let o=this.activePartLists[a];o||(this.activePartLists[a]=o=[]),o.push(i)}this.timeRanges=s,Object.keys(s).forEach(o=>{const l=s[o];this.detectEvictedFragments(o,l,a,i)})}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=cs(e);return!!this.fragments[t]}hasParts(e){var t;return!!((t=this.activePartLists[e])!=null&&t.length)}removeFragmentsInRange(e,t,n,i,s){i&&!this.hasGaps||Object.keys(this.fragments).forEach(a=>{const o=this.fragments[a];if(!o)return;const l=o.body;l.type!==n||i&&!l.gap||l.start<t&&l.end>e&&(o.buffered||s)&&this.removeFragment(l)})}removeFragment(e){const t=cs(e);e.stats.loaded=0,e.clearElementaryStreamInfo();const n=this.activePartLists[e.type];if(n){const i=e.sn;this.activePartLists[e.type]=n.filter(s=>s.fragment.sn!==i)}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1}}function rl(r){var e,t,n;return r.buffered&&(r.body.gap||((e=r.range.video)==null?void 0:e.partial)||((t=r.range.audio)==null?void 0:t.partial)||((n=r.range.audiovideo)==null?void 0:n.partial))}function cs(r){return`${r.type}_${r.level}_${r.urlId}_${r.sn}`}const qg=Math.pow(2,17);class Jw{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const n=e.url;if(!n)return Promise.reject(new Mn({type:be.NETWORK_ERROR,details:J.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error(`Fragment does not have a ${n?"part list":"url"}`),networkDetails:null}));this.abort();const i=this.config,s=i.fLoader,a=i.loader;return new Promise((o,l)=>{if(this.loader&&this.loader.destroy(),e.gap){l(Xg(e));return}const u=this.loader=e.loader=s?new s(i):new a(i),c=Yg(e),f=jg(i.fragLoadPolicy.default),h={loadPolicy:f,timeout:f.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:e.sn==="initSegment"?1/0:qg};e.stats=u.stats,u.load(c,h,{onSuccess:(d,m,x,p)=>{this.resetLoader(e,u);let g=d.data;x.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(g.slice(0,16)),g=g.slice(16)),o({frag:e,part:null,payload:g,networkDetails:p})},onError:(d,m,x,p)=>{this.resetLoader(e,u),l(new Mn({type:be.NETWORK_ERROR,details:J.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:vr({url:n,data:void 0},d),error:new Error(`HTTP Error ${d.code} ${d.text}`),networkDetails:x,stats:p}))},onAbort:(d,m,x)=>{this.resetLoader(e,u),l(new Mn({type:be.NETWORK_ERROR,details:J.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:x,stats:d}))},onTimeout:(d,m,x)=>{this.resetLoader(e,u),l(new Mn({type:be.NETWORK_ERROR,details:J.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${h.timeout}ms`),networkDetails:x,stats:d}))},onProgress:(d,m,x,p)=>{t&&t({frag:e,part:null,payload:x,networkDetails:p})}})})}loadPart(e,t,n){this.abort();const i=this.config,s=i.fLoader,a=i.loader;return new Promise((o,l)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap){l(Xg(e,t));return}const u=this.loader=e.loader=s?new s(i):new a(i),c=Yg(e,t),f=jg(i.fragLoadPolicy.default),h={loadPolicy:f,timeout:f.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:qg};t.stats=u.stats,u.load(c,h,{onSuccess:(d,m,x,p)=>{this.resetLoader(e,u),this.updateStatsFromPart(e,t);const g={frag:e,part:t,payload:d.data,networkDetails:p};n(g),o(g)},onError:(d,m,x,p)=>{this.resetLoader(e,u),l(new Mn({type:be.NETWORK_ERROR,details:J.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:vr({url:c.url,data:void 0},d),error:new Error(`HTTP Error ${d.code} ${d.text}`),networkDetails:x,stats:p}))},onAbort:(d,m,x)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,u),l(new Mn({type:be.NETWORK_ERROR,details:J.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:x,stats:d}))},onTimeout:(d,m,x)=>{this.resetLoader(e,u),l(new Mn({type:be.NETWORK_ERROR,details:J.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${h.timeout}ms`),networkDetails:x,stats:d}))}})})}updateStatsFromPart(e,t){const n=e.stats,i=t.stats,s=i.total;if(n.loaded+=i.loaded,s){const l=Math.round(e.duration/t.duration),u=Math.min(Math.round(n.loaded/s),l),f=(l-u)*Math.round(n.loaded/u);n.total=n.loaded+f}else n.total=Math.max(n.loaded,n.total);const a=n.loading,o=i.loading;a.start?a.first+=o.first-o.start:(a.start=o.start,a.first=o.first),a.end=o.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function Yg(r,e=null){const t=e||r,n={frag:r,part:e,responseType:"arraybuffer",url:t.url,headers:{},rangeStart:0,rangeEnd:0},i=t.byteRangeStartOffset,s=t.byteRangeEndOffset;if(_e(i)&&_e(s)){var a;let o=i,l=s;if(r.sn==="initSegment"&&((a=r.decryptdata)==null?void 0:a.method)==="AES-128"){const u=s-i;u%16&&(l=s+(16-u%16)),i!==0&&(n.resetIV=!0,o=i-16)}n.rangeStart=o,n.rangeEnd=l}return n}function Xg(r,e){const t=new Error(`GAP ${r.gap?"tag":"attribute"} found`),n={type:be.MEDIA_ERROR,details:J.FRAG_GAP,fatal:!1,frag:r,error:t,networkDetails:null};return e&&(n.part=e),(e||r).stats.aborted=!0,new Mn(n)}class Mn extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class e2{constructor(e){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const t in this.keyUriToKeyInfo){const n=this.keyUriToKeyInfo[t].loader;if(n){if(e&&e!==n.context.frag.type)return;n.abort()}}}detach(){for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e].loader;t&&t.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(e,t=J.KEY_LOAD_ERROR,n,i,s){return new Mn({type:be.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:s,error:n,networkDetails:i})}loadClear(e,t){if(this.emeController&&this.config.emeEnabled){const{sn:n,cc:i}=e;for(let s=0;s<t.length;s++){const a=t[s];if(i<=a.cc&&(n==="initSegment"||a.sn==="initSegment"||n<a.sn)){this.emeController.selectKeySystemFormat(a).then(o=>{a.setKeyFormat(o)});break}}}}load(e){return!e.decryptdata&&e.encrypted&&this.emeController?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var n,i;t&&e.setKeyFormat(t);const s=e.decryptdata;if(!s){const u=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,J.KEY_LOAD_ERROR,u))}const a=s.uri;if(!a)return Promise.reject(this.createKeyLoadError(e,J.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${a}"`)));let o=this.keyUriToKeyInfo[a];if((n=o)!=null&&n.decryptdata.key)return s.key=o.decryptdata.key,Promise.resolve({frag:e,keyInfo:o});if((i=o)!=null&&i.keyLoadPromise){var l;switch((l=o.mediaKeySessionContext)==null?void 0:l.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return o.keyLoadPromise.then(u=>(s.key=u.keyInfo.decryptdata.key,{frag:e,keyInfo:o}))}}switch(o=this.keyUriToKeyInfo[a]={decryptdata:s,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},s.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return s.keyFormat==="identity"?this.loadKeyHTTP(o,e):this.loadKeyEME(o,e);case"AES-128":return this.loadKeyHTTP(o,e);default:return Promise.reject(this.createKeyLoadError(e,J.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${s.method}"`)))}}loadKeyEME(e,t){const n={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){const i=this.emeController.loadKey(n);if(i)return(e.keyLoadPromise=i.then(s=>(e.mediaKeySessionContext=s,n))).catch(s=>{throw e.keyLoadPromise=null,s})}return Promise.resolve(n)}loadKeyHTTP(e,t){const n=this.config,i=n.loader,s=new i(n);return t.keyLoader=e.loader=s,e.keyLoadPromise=new Promise((a,o)=>{const l={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},u=n.keyLoadPolicy.default,c={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},f={onSuccess:(h,d,m,x)=>{const{frag:p,keyInfo:g,url:v}=m;if(!p.decryptdata||g!==this.keyUriToKeyInfo[v])return o(this.createKeyLoadError(p,J.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),x));g.decryptdata.key=p.decryptdata.key=new Uint8Array(h.data),p.keyLoader=null,g.loader=null,a({frag:p,keyInfo:g})},onError:(h,d,m,x)=>{this.resetLoader(d),o(this.createKeyLoadError(t,J.KEY_LOAD_ERROR,new Error(`HTTP Error ${h.code} loading key ${h.text}`),m,vr({url:l.url,data:void 0},h)))},onTimeout:(h,d,m)=>{this.resetLoader(d),o(this.createKeyLoadError(t,J.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),m))},onAbort:(h,d,m)=>{this.resetLoader(d),o(this.createKeyLoadError(t,J.INTERNAL_ABORTED,new Error("key loading aborted"),m))}};s.load(l,c,f)})}resetLoader(e){const{frag:t,keyInfo:n,url:i}=e,s=n.loader;t.keyLoader===s&&(t.keyLoader=null,n.loader=null),delete this.keyUriToKeyInfo[i],s&&s.destroy()}}class t2{constructor(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}const r2={length:0,start:()=>0,end:()=>0};class Je{static isBuffered(e,t){try{if(e){const n=Je.getBuffered(e);for(let i=0;i<n.length;i++)if(t>=n.start(i)&&t<=n.end(i))return!0}}catch{}return!1}static bufferInfo(e,t,n){try{if(e){const i=Je.getBuffered(e),s=[];let a;for(a=0;a<i.length;a++)s.push({start:i.start(a),end:i.end(a)});return this.bufferedInfo(s,t,n)}}catch{}return{len:0,start:t,end:t,nextStart:void 0}}static bufferedInfo(e,t,n){t=Math.max(0,t),e.sort(function(u,c){const f=u.start-c.start;return f||c.end-u.end});let i=[];if(n)for(let u=0;u<e.length;u++){const c=i.length;if(c){const f=i[c-1].end;e[u].start-f<n?e[u].end>f&&(i[c-1].end=e[u].end):i.push(e[u])}else i.push(e[u])}else i=e;let s=0,a,o=t,l=t;for(let u=0;u<i.length;u++){const c=i[u].start,f=i[u].end;if(t+n>=c&&t<f)o=c,l=f,s=l-t;else if(t+n<c){a=c;break}}return{len:s,start:o||0,end:l||0,nextStart:a}}static getBuffered(e){try{return e.buffered}catch(t){return G.log("failed to get media.buffered",t),r2}}}class Od{constructor(e,t,n,i=0,s=-1,a=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=nl(),this.buffering={audio:nl(),video:nl(),audiovideo:nl()},this.level=e,this.sn=t,this.id=n,this.size=i,this.part=s,this.partial=a}}function nl(){return{start:0,executeStart:0,executeEnd:0,end:0}}function iE(r,e){let t=null;for(let n=0,i=r.length;n<i;n++){const s=r[n];if(s&&s.cc===e){t=s;break}}return t}function n2(r,e,t){return!!(e.details&&(t.endCC>t.startCC||r&&r.cc<t.startCC))}function i2(r,e,t=0){const n=r.fragments,i=e.fragments;if(!i.length||!n.length){G.log("No fragments to align");return}const s=iE(n,i[0].cc);if(!s||s&&!s.startPTS){G.log("No frag in previous level to align on");return}return s}function Zg(r,e){if(r){const t=r.start+e;r.start=r.startPTS=t,r.endPTS=t+r.duration}}function Nd(r,e){const t=e.fragments;for(let n=0,i=t.length;n<i;n++)Zg(t[n],r);e.fragmentHint&&Zg(e.fragmentHint,r),e.alignedSliding=!0}function s2(r,e,t){!e||(a2(r,t,e),!t.alignedSliding&&e.details&&o2(t,e.details),!t.alignedSliding&&e.details&&!t.skippedSegments&&tE(e.details,t))}function a2(r,e,t){if(n2(r,t,e)){const n=i2(t.details,e);n&&_e(n.start)&&(G.log(`Adjusting PTS using last level due to CC increase within current level ${e.url}`),Nd(n.start,e))}}function o2(r,e){if(!e.fragments.length||!r.hasProgramDateTime||!e.hasProgramDateTime)return;const t=e.fragments[0].programDateTime,n=r.fragments[0].programDateTime,i=(n-t)/1e3+e.fragments[0].start;i&&_e(i)&&(G.log(`Adjusting PTS using programDateTime delta ${n-t}ms, sliding:${i.toFixed(3)} ${r.url} `),Nd(i,r))}function sE(r,e){if(!r.hasProgramDateTime||!e.hasProgramDateTime)return;const t=r.fragments,n=e.fragments;if(!t.length||!n.length)return;const i=Math.round(n.length/2)-1,s=n[i],a=iE(t,s.cc)||t[Math.round(t.length/2)-1],o=s.programDateTime,l=a.programDateTime;if(o===null||l===null)return;const u=(l-o)/1e3-(a.start-s.start);Nd(u,r)}class l2{constructor(e,t){this.subtle=void 0,this.aesIV=void 0,this.subtle=e,this.aesIV=t}decrypt(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)}}class u2{constructor(e,t){this.subtle=void 0,this.key=void 0,this.subtle=e,this.key=t}expandKey(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}function c2(r){const e=r.byteLength,t=e&&new DataView(r.buffer).getUint8(e-1);return t?Gi(r,0,e-t):r}class f2{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),n=new Uint32Array(4);for(let i=0;i<4;i++)n[i]=t.getUint32(i*4);return n}initTable(){const e=this.sBox,t=this.invSBox,n=this.subMix,i=n[0],s=n[1],a=n[2],o=n[3],l=this.invSubMix,u=l[0],c=l[1],f=l[2],h=l[3],d=new Uint32Array(256);let m=0,x=0,p=0;for(p=0;p<256;p++)p<128?d[p]=p<<1:d[p]=p<<1^283;for(p=0;p<256;p++){let g=x^x<<1^x<<2^x<<3^x<<4;g=g>>>8^g&255^99,e[m]=g,t[g]=m;const v=d[m],E=d[v],S=d[E];let T=d[g]*257^g*16843008;i[m]=T<<24|T>>>8,s[m]=T<<16|T>>>16,a[m]=T<<8|T>>>24,o[m]=T,T=S*16843009^E*65537^v*257^m*16843008,u[g]=T<<24|T>>>8,c[g]=T<<16|T>>>16,f[g]=T<<8|T>>>24,h[g]=T,m?(m=v^d[d[d[S^v]]],x^=d[d[x]]):m=x=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let n=!0,i=0;for(;i<t.length&&n;)n=t[i]===this.key[i],i++;if(n)return;this.key=t;const s=this.keySize=t.length;if(s!==4&&s!==6&&s!==8)throw new Error("Invalid aes key size="+s);const a=this.ksRows=(s+6+1)*4;let o,l;const u=this.keySchedule=new Uint32Array(a),c=this.invKeySchedule=new Uint32Array(a),f=this.sBox,h=this.rcon,d=this.invSubMix,m=d[0],x=d[1],p=d[2],g=d[3];let v,E;for(o=0;o<a;o++){if(o<s){v=u[o]=t[o];continue}E=v,o%s===0?(E=E<<8|E>>>24,E=f[E>>>24]<<24|f[E>>>16&255]<<16|f[E>>>8&255]<<8|f[E&255],E^=h[o/s|0]<<24):s>6&&o%s===4&&(E=f[E>>>24]<<24|f[E>>>16&255]<<16|f[E>>>8&255]<<8|f[E&255]),u[o]=v=(u[o-s]^E)>>>0}for(l=0;l<a;l++)o=a-l,l&3?E=u[o]:E=u[o-4],l<4||o<=4?c[l]=E:c[l]=m[f[E>>>24]]^x[f[E>>>16&255]]^p[f[E>>>8&255]]^g[f[E&255]],c[l]=c[l]>>>0}networkToHostOrderSwap(e){return e<<24|(e&65280)<<8|(e&16711680)>>8|e>>>24}decrypt(e,t,n){const i=this.keySize+6,s=this.invKeySchedule,a=this.invSBox,o=this.invSubMix,l=o[0],u=o[1],c=o[2],f=o[3],h=this.uint8ArrayToUint32Array_(n);let d=h[0],m=h[1],x=h[2],p=h[3];const g=new Int32Array(e),v=new Int32Array(g.length);let E,S,T,w,_,C,O,L,V,$,ne,me,H,j;const X=this.networkToHostOrderSwap;for(;t<g.length;){for(V=X(g[t]),$=X(g[t+1]),ne=X(g[t+2]),me=X(g[t+3]),_=V^s[0],C=me^s[1],O=ne^s[2],L=$^s[3],H=4,j=1;j<i;j++)E=l[_>>>24]^u[C>>16&255]^c[O>>8&255]^f[L&255]^s[H],S=l[C>>>24]^u[O>>16&255]^c[L>>8&255]^f[_&255]^s[H+1],T=l[O>>>24]^u[L>>16&255]^c[_>>8&255]^f[C&255]^s[H+2],w=l[L>>>24]^u[_>>16&255]^c[C>>8&255]^f[O&255]^s[H+3],_=E,C=S,O=T,L=w,H=H+4;E=a[_>>>24]<<24^a[C>>16&255]<<16^a[O>>8&255]<<8^a[L&255]^s[H],S=a[C>>>24]<<24^a[O>>16&255]<<16^a[L>>8&255]<<8^a[_&255]^s[H+1],T=a[O>>>24]<<24^a[L>>16&255]<<16^a[_>>8&255]<<8^a[C&255]^s[H+2],w=a[L>>>24]<<24^a[_>>16&255]<<16^a[C>>8&255]<<8^a[O&255]^s[H+3],v[t]=X(E^d),v[t+1]=X(w^m),v[t+2]=X(T^x),v[t+3]=X(S^p),d=V,m=$,x=ne,p=me,t=t+4}return v.buffer}}const h2=16;class Pd{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const n=self.crypto;n&&(this.subtle=n.subtle||n.webkitSubtle)}catch{}this.subtle===null&&(this.useSoftware=!0)}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const n=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?c2(n):n}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,n){return this.useSoftware?new Promise((i,s)=>{this.softwareDecrypt(new Uint8Array(e),t,n);const a=this.flush();a?i(a.buffer):s(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,n)}softwareDecrypt(e,t,n){const{currentIV:i,currentResult:s,remainderData:a}=this;this.logOnce("JS AES decrypt"),a&&(e=Yi(a,e),this.remainderData=null);const o=this.getValidChunk(e);if(!o.length)return null;i&&(n=i);let l=this.softwareDecrypter;l||(l=this.softwareDecrypter=new f2),l.expandKey(t);const u=s;return this.currentResult=l.decrypt(o.buffer,0,n),this.currentIV=Gi(o,-16).buffer,u||null}webCryptoDecrypt(e,t,n){const i=this.subtle;return(this.key!==t||!this.fastAesKey)&&(this.key=t,this.fastAesKey=new u2(i,t)),this.fastAesKey.expandKey().then(s=>i?(this.logOnce("WebCrypto AES decrypt"),new l2(i,new Uint8Array(n)).decrypt(e.buffer,s)):Promise.reject(new Error("web crypto not initialized"))).catch(s=>(G.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${s.name}: ${s.message}`),this.onWebCryptoError(e,t,n)))}onWebCryptoError(e,t,n){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,n);const i=this.flush();if(i)return i.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")}getValidChunk(e){let t=e;const n=e.length-e.length%h2;return n!==e.length&&(t=Gi(e,0,n),this.remainderData=Gi(e,n)),t}logOnce(e){!this.logEnabled||(G.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const d2={toString:function(r){let e="";const t=r.length;for(let n=0;n<t;n++)e+=`[${r.start(n).toFixed(3)}-${r.end(n).toFixed(3)}]`;return e}},se={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class Fd extends t2{constructor(e,t,n,i,s){super(),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=se.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.loadedmetadata=!1,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.onvseeking=null,this.onvended=null,this.logPrefix="",this.log=void 0,this.warn=void 0,this.playlistType=s,this.logPrefix=i,this.log=G.log.bind(G,`${i}:`),this.warn=G.warn.bind(G,`${i}:`),this.hls=e,this.fragmentLoader=new Jw(e.config),this.keyLoader=n,this.fragmentTracker=t,this.config=e.config,this.decrypter=new Pd(e.config),e.on(A.MANIFEST_LOADED,this.onManifestLoaded,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;e!=null&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=se.STOPPED}_streamEnded(e,t){if(t.live||e.nextStart||!e.end||!this.media)return!1;const n=t.partList;if(n!=null&&n.length){const s=n[n.length-1];return Je.isBuffered(this.media,s.start+s.duration/2)}const i=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(i)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null){var e;return(e=this.levels[this.levelLastLoaded])==null?void 0:e.details}}onMediaAttached(e,t){const n=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),n.addEventListener("seeking",this.onvseeking),n.addEventListener("ended",this.onvended);const i=this.config;this.levels&&i.autoStartLoad&&this.state===se.STOPPED&&this.startLoad(i.startPosition)}onMediaDetaching(){const e=this.media;e!=null&&e.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&this.onvseeking&&this.onvended&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}onMediaSeeking(){const{config:e,fragCurrent:t,media:n,mediaBuffer:i,state:s}=this,a=n?n.currentTime:0,o=Je.bufferInfo(i||n,a,e.maxBufferHole);if(this.log(`media seeking to ${_e(a)?a.toFixed(3):a}, state: ${s}`),this.state===se.ENDED)this.resetLoadingState();else if(t){const l=e.maxFragLookUpTolerance,u=t.start-l,c=t.start+t.duration+l;if(!o.len||c<o.start||u>o.end){const f=a>c;(a<u||f)&&(f&&t.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),t.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}n&&(this.fragmentTracker.removeFragmentsInRange(a,1/0,this.playlistType,!0),this.lastCurrentTime=a),!this.loadedmetadata&&!o.len&&(this.nextLoadPosition=this.startPosition=a),this.tickImmediate()}onMediaEnded(){this.startPosition=this.lastCurrentTime=0}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset,this.initPTS=[]}onHandlerDestroying(){this.stopLoad(),super.onHandlerDestroying()}onHandlerDestroyed(){this.state=se.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,n){this._loadFragForPlayback(e,t,n)}_loadFragForPlayback(e,t,n){const i=s=>{if(this.fragContextChanged(e)){this.warn(`Fragment ${e.sn}${s.part?" p: "+s.part.index:""} of level ${e.level} was dropped during download.`),this.fragmentTracker.removeFragment(e);return}e.stats.chunkCount++,this._handleFragmentLoadProgress(s)};this._doFragLoad(e,t,n,i).then(s=>{if(!s)return;const a=this.state;if(this.fragContextChanged(e)){(a===se.FRAG_LOADING||!this.fragCurrent&&a===se.PARSING)&&(this.fragmentTracker.removeFragment(e),this.state=se.IDLE);return}"payload"in s&&(this.log(`Loaded fragment ${e.sn} of level ${e.level}`),this.hls.trigger(A.FRAG_LOADED,s)),this._handleFragmentLoadComplete(s)}).catch(s=>{this.state===se.STOPPED||this.state===se.ERROR||(this.warn(s),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;const{fragmentTracker:n}=this;if(n.getState(e)===Ft.APPENDING){const s=e.type,a=this.getFwdBufferInfo(this.mediaBuffer,s),o=Math.max(e.duration,a?a.len:this.config.maxBufferLength);this.reduceMaxBufferLength(o)&&n.removeFragment(e)}else((t=this.mediaBuffer)==null?void 0:t.buffered.length)===0?n.removeAllFragments():n.hasParts(e.type)&&(n.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),n.getState(e)===Ft.PARTIAL&&n.removeFragment(e))}flushMainBuffer(e,t,n=null){if(!(e-t))return;const i={startOffset:e,endOffset:t,type:n};this.hls.trigger(A.BUFFER_FLUSHING,i)}_loadInitSegment(e,t){this._doFragLoad(e,t).then(n=>{if(!n||this.fragContextChanged(e)||!this.levels)throw new Error("init load aborted");return n}).then(n=>{const{hls:i}=this,{payload:s}=n,a=e.decryptdata;if(s&&s.byteLength>0&&a&&a.key&&a.iv&&a.method==="AES-128"){const o=self.performance.now();return this.decrypter.decrypt(new Uint8Array(s),a.key.buffer,a.iv.buffer).catch(l=>{throw i.trigger(A.ERROR,{type:be.MEDIA_ERROR,details:J.FRAG_DECRYPT_ERROR,fatal:!1,error:l,reason:l.message,frag:e}),l}).then(l=>{const u=self.performance.now();return i.trigger(A.FRAG_DECRYPTED,{frag:e,payload:l,stats:{tstart:o,tdecrypt:u}}),n.payload=l,n})}return n}).then(n=>{const{fragCurrent:i,hls:s,levels:a}=this;if(!a)throw new Error("init load aborted, missing levels");const o=e.stats;this.state=se.IDLE,t.fragmentError=0,e.data=new Uint8Array(n.payload),o.parsing.start=o.buffering.start=self.performance.now(),o.parsing.end=o.buffering.end=self.performance.now(),n.frag===i&&s.trigger(A.FRAG_BUFFERED,{stats:o,frag:i,part:null,id:e.type}),this.tick()}).catch(n=>{this.state===se.STOPPED||this.state===se.ERROR||(this.warn(n),this.resetFragmentLoading(e))})}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.level!==t.level||e.sn!==t.sn||e.urlId!==t.urlId}fragBufferedComplete(e,t){var n,i,s,a;const o=this.mediaBuffer?this.mediaBuffer:this.media;this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.playlistType===De.MAIN?"level":"track"} ${e.level} (frag:[${((n=e.startPTS)!=null?n:NaN).toFixed(3)}-${((i=e.endPTS)!=null?i:NaN).toFixed(3)}] > buffer:${o?d2.toString(Je.getBuffered(o)):"(detached)"})`),this.state=se.IDLE,o&&(!this.loadedmetadata&&e.type==De.MAIN&&o.buffered.length&&((s=this.fragCurrent)==null?void 0:s.sn)===((a=this.fragPrevious)==null?void 0:a.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())}seekToStartPos(){}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:n,part:i,partsLoaded:s}=e,a=!s||s.length===0||s.some(l=>!l),o=new Od(n.level,n.sn,n.stats.chunkCount+1,0,i?i.index:-1,!a);t.flush(o)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,n=null,i){var s;const a=t==null?void 0:t.details;if(!this.levels||!a)throw new Error(`frag load aborted, missing level${a?"":" detail"}s`);let o=null;if(e.encrypted&&!((s=e.decryptdata)!=null&&s.key)?(this.log(`Loading key for ${e.sn} of [${a.startSN}-${a.endSN}], ${this.logPrefix==="[stream-controller]"?"level":"track"} ${e.level}`),this.state=se.KEY_LOADING,this.fragCurrent=e,o=this.keyLoader.load(e).then(c=>{if(!this.fragContextChanged(c.frag))return this.hls.trigger(A.KEY_LOADED,c),this.state===se.KEY_LOADING&&(this.state=se.IDLE),c}),this.hls.trigger(A.KEY_LOADING,{frag:e}),this.fragCurrent===null&&(o=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))):!e.encrypted&&a.encryptedFragments.length&&this.keyLoader.loadClear(e,a.encryptedFragments),n=Math.max(e.start,n||0),this.config.lowLatencyMode&&e.sn!=="initSegment"){const c=a.partList;if(c&&i){n>e.end&&a.fragmentHint&&(e=a.fragmentHint);const f=this.getNextPart(c,e,n);if(f>-1){const h=c[f];this.log(`Loading part sn: ${e.sn} p: ${h.index} cc: ${e.cc} of playlist [${a.startSN}-${a.endSN}] parts [0-${f}-${c.length-1}] ${this.logPrefix==="[stream-controller]"?"level":"track"}: ${e.level}, target: ${parseFloat(n.toFixed(3))}`),this.nextLoadPosition=h.start+h.duration,this.state=se.FRAG_LOADING;let d;return o?d=o.then(m=>!m||this.fragContextChanged(m.frag)?null:this.doFragPartsLoad(e,h,t,i)).catch(m=>this.handleFragLoadError(m)):d=this.doFragPartsLoad(e,h,t,i).catch(m=>this.handleFragLoadError(m)),this.hls.trigger(A.FRAG_LOADING,{frag:e,part:h,targetBufferTime:n}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):d}else if(!e.url||this.loadedEndOfParts(c,n))return Promise.resolve(null)}}this.log(`Loading fragment ${e.sn} cc: ${e.cc} ${a?"of ["+a.startSN+"-"+a.endSN+"] ":""}${this.logPrefix==="[stream-controller]"?"level":"track"}: ${e.level}, target: ${parseFloat(n.toFixed(3))}`),_e(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=se.FRAG_LOADING;const l=this.config.progressive;let u;return l&&o?u=o.then(c=>!c||this.fragContextChanged(c==null?void 0:c.frag)?null:this.fragmentLoader.load(e,i)).catch(c=>this.handleFragLoadError(c)):u=Promise.all([this.fragmentLoader.load(e,l?i:void 0),o]).then(([c])=>(!l&&c&&i&&i(c),c)).catch(c=>this.handleFragLoadError(c)),this.hls.trigger(A.FRAG_LOADING,{frag:e,targetBufferTime:n}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):u}doFragPartsLoad(e,t,n,i){return new Promise((s,a)=>{var o;const l=[],u=(o=n.details)==null?void 0:o.partList,c=f=>{this.fragmentLoader.loadPart(e,f,i).then(h=>{l[f.index]=h;const d=h.part;this.hls.trigger(A.FRAG_LOADED,h);const m=Wg(n,e.sn,f.index+1)||rE(u,e.sn,f.index+1);if(m)c(m);else return s({frag:e,part:d,partsLoaded:l})}).catch(a)};c(t)})}handleFragLoadError(e){if("data"in e){const t=e.data;e.data&&t.details===J.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(A.ERROR,t)}else this.hls.trigger(A.ERROR,{type:be.OTHER_ERROR,details:J.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==se.PARSING){!this.fragCurrent&&this.state!==se.STOPPED&&this.state!==se.ERROR&&(this.state=se.IDLE);return}const{frag:n,part:i,level:s}=t,a=self.performance.now();n.stats.parsing.end=a,i&&(i.stats.parsing.end=a),this.updateLevelTiming(n,i,s,e.partial)}getCurrentContext(e){const{levels:t,fragCurrent:n}=this,{level:i,sn:s,part:a}=e;if(!(t!=null&&t[i]))return this.warn(`Levels object was unset while buffering fragment ${s} of level ${i}. The current chunk will not be buffered.`),null;const o=t[i],l=a>-1?Wg(o,s,a):null,u=l?l.fragment:Gw(o,s,n);return u?(n&&n!==u&&(u.stats=n.stats),{frag:u,part:l,level:o}):null}bufferFragmentData(e,t,n,i){var s;if(!e||this.state!==se.PARSING)return;const{data1:a,data2:o}=e;let l=a;if(a&&o&&(l=Yi(a,o)),!((s=l)!=null&&s.length))return;const u={type:e.type,frag:t,part:n,chunkMeta:i,parent:t.type,data:l};this.hls.trigger(A.BUFFER_APPENDING,u),e.dropped&&e.independent&&!n&&this.flushBufferGap(t)}flushBufferGap(e){const t=this.media;if(!t)return;if(!Je.isBuffered(t,t.currentTime)){this.flushMainBuffer(0,e.start);return}const n=t.currentTime,i=Je.bufferInfo(t,n,0),s=e.duration,a=Math.min(this.config.maxFragLookUpTolerance*2,s*.25),o=Math.max(Math.min(e.start-a,i.end-a),n+a);e.start-o>a&&this.flushMainBuffer(o,e.start)}getFwdBufferInfo(e,t){const n=this.getLoadPosition();return _e(n)?this.getFwdBufferInfoAtPos(e,n,t):null}getFwdBufferInfoAtPos(e,t,n){const{config:{maxBufferHole:i}}=this,s=Je.bufferInfo(e,t,i);if(s.len===0&&s.nextStart!==void 0){const a=this.fragmentTracker.getBufferedFrag(t,n);if(a&&s.nextStart<a.end)return Je.bufferInfo(e,t,Math.max(s.nextStart,i))}return s}getMaxBufferLength(e){const{config:t}=this;let n;return e?n=Math.max(8*t.maxBufferSize/e,t.maxBufferLength):n=t.maxBufferLength,Math.min(n,t.maxMaxBufferLength)}reduceMaxBufferLength(e){const t=this.config,n=e||t.maxBufferLength;return t.maxMaxBufferLength>=n?(t.maxMaxBufferLength/=2,this.warn(`Reduce max buffer length to ${t.maxMaxBufferLength}s`),!0):!1}getAppendedFrag(e,t=De.MAIN){const n=this.fragmentTracker.getAppendedFrag(e,De.MAIN);return n&&"fragment"in n?n.fragment:n}getNextFragment(e,t){const n=t.fragments,i=n.length;if(!i)return null;const{config:s}=this,a=n[0].start;let o;if(t.live){const l=s.initialLiveManifestSize;if(i<l)return this.warn(`Not enough fragments to start playback (have: ${i}, need: ${l})`),null;!t.PTSKnown&&!this.startFragRequested&&this.startPosition===-1&&(o=this.getInitialLiveFragment(t,n),this.startPosition=o?this.hls.liveSyncPosition||o.start:e)}else e<=a&&(o=n[0]);if(!o){const l=s.lowLatencyMode?t.partEnd:t.fragmentEnd;o=this.getFragmentAtPosition(e,l,t)}return this.mapToInitFragWhenRequired(o)}isLoopLoading(e,t){const n=this.fragmentTracker.getState(e);return(n===Ft.OK||n===Ft.PARTIAL&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,n,i,s){const a=e.gap,o=this.getNextFragment(this.nextLoadPosition,t);if(o===null)return o;if(e=o,a&&e&&!e.gap&&n.nextStart){const l=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,n.nextStart,i);if(l!==null&&n.len+l.len>=s)return this.log(`buffer full after gaps in "${i}" playlist starting at sn: ${e.sn}`),null}return e}mapToInitFragWhenRequired(e){return e!=null&&e.initSegment&&!(e!=null&&e.initSegment.data)&&!this.bitrateTest?e.initSegment:e}getNextPart(e,t,n){let i=-1,s=!1,a=!0;for(let o=0,l=e.length;o<l;o++){const u=e[o];if(a=a&&!u.independent,i>-1&&n<u.start)break;const c=u.loaded;c?i=-1:(s||u.independent||a)&&u.fragment===t&&(i=o),s=c}return i}loadedEndOfParts(e,t){const n=e[e.length-1];return n&&t>n.start&&n.loaded}getInitialLiveFragment(e,t){const n=this.fragPrevious;let i=null;if(n){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${n.programDateTime}`),i=Hw(t,n.endProgramDateTime,this.config.maxFragLookUpTolerance)),!i){const s=n.sn+1;if(s>=e.startSN&&s<=e.endSN){const a=t[s-e.startSN];n.cc===a.cc&&(i=a,this.log(`Live playlist, switching playlist, load frag with next SN: ${i.sn}`))}i||(i=Kw(t,n.cc),i&&this.log(`Live playlist, switching playlist, load frag with same CC: ${i.sn}`))}}else{const s=this.hls.liveSyncPosition;s!==null&&(i=this.getFragmentAtPosition(s,this.bitrateTest?e.fragmentEnd:e.edge,e))}return i}getFragmentAtPosition(e,t,n){const{config:i}=this;let{fragPrevious:s}=this,{fragments:a,endSN:o}=n;const{fragmentHint:l}=n,u=i.maxFragLookUpTolerance,c=n.partList,f=!!(i.lowLatencyMode&&c!=null&&c.length&&l);f&&l&&!this.bitrateTest&&(a=a.concat(l),o=l.sn);let h;if(e<t){const d=e>t-u?0:u;h=uo(s,a,e,d)}else h=a[a.length-1];if(h){const d=h.sn-n.startSN,m=this.fragmentTracker.getState(h);if((m===Ft.OK||m===Ft.PARTIAL&&h.gap)&&(s=h),s&&h.sn===s.sn&&(!f||c[0].fragment.sn>h.sn)&&s&&h.level===s.level){const p=a[d+1];h.sn<o&&this.fragmentTracker.getState(p)!==Ft.OK?h=p:h=null}}return h}synchronizeToLiveEdge(e){const{config:t,media:n}=this;if(!n)return;const i=this.hls.liveSyncPosition,s=n.currentTime,a=e.fragments[0].start,o=e.edge,l=s>=a-t.maxFragLookUpTolerance&&s<=o;if(i!==null&&n.duration>i&&(s<i||!l)){const u=t.liveMaxLatencyDuration!==void 0?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;(!l&&n.readyState<4||s<o-u)&&(this.loadedmetadata||(this.nextLoadPosition=i),n.readyState&&(this.warn(`Playback: ${s.toFixed(3)} is located too far from the end of live sliding playlist: ${o}, reset currentTime to : ${i.toFixed(3)}`),n.currentTime=i))}}alignPlaylists(e,t){const{levels:n,levelLastLoaded:i,fragPrevious:s}=this,a=i!==null?n[i]:null,o=e.fragments.length;if(!o)return this.warn("No fragments in live playlist"),0;const l=e.fragments[0].start,u=!t,c=e.alignedSliding&&_e(l);if(u||!c&&!l){s2(s,a,e);const f=e.fragments[0].start;return this.log(`Live playlist sliding: ${f.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} prev-sn: ${s?s.sn:"na"} fragments: ${o}`),f}return l}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*3)}setStartPosition(e,t){let n=this.startPosition;if(n<t&&(n=-1),n===-1||this.lastCurrentTime===-1){const i=this.startTimeOffset!==null,s=i?this.startTimeOffset:e.startTimeOffset;s!==null&&_e(s)?(n=t+s,s<0&&(n+=e.totalduration),n=Math.min(Math.max(t,n),t+e.totalduration),this.log(`Start time offset ${s} found in ${i?"multivariant":"media"} playlist, adjust startPosition to ${n}`),this.startPosition=n):e.live?n=this.hls.liveSyncPosition||t:this.startPosition=n=0,this.lastCurrentTime=n}this.nextLoadPosition=n}getLoadPosition(){const{media:e}=this;let t=0;return this.loadedmetadata&&e?t=e.currentTime:this.nextLoadPosition&&(t=this.nextLoadPosition),t}handleFragLoadAborted(e,t){this.transmuxer&&e.sn!=="initSegment"&&e.stats.aborted&&(this.warn(`Fragment ${e.sn}${t?" part "+t.index:""} of level ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){(!this.fragCurrent||!this.fragContextChanged(e)&&this.state!==se.FRAG_LOADING_WAITING_RETRY)&&(this.state=se.IDLE)}onFragmentOrKeyLoadError(e,t){if(t.chunkMeta&&!t.frag){const c=this.getCurrentContext(t.chunkMeta);c&&(t.frag=c.frag)}const n=t.frag;if(!n||n.type!==e||!this.levels)return;if(this.fragContextChanged(n)){var i;this.warn(`Frag load error must match current frag to retry ${n.url} > ${(i=this.fragCurrent)==null?void 0:i.url}`);return}const s=t.details===J.FRAG_GAP;s&&this.fragmentTracker.fragBuffered(n,!0);const a=t.errorAction,{action:o,retryCount:l=0,retryConfig:u}=a||{};if(a&&o===lr.RetryRequest&&u){this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition);const c=Id(u,l);this.warn(`Fragment ${n.sn} of ${e} ${n.level} errored with ${t.details}, retrying loading ${l+1}/${u.maxNumRetry} in ${c}ms`),a.resolved=!0,this.retryDate=self.performance.now()+c,this.state=se.FRAG_LOADING_WAITING_RETRY}else u&&a?(this.resetFragmentErrors(e),l<u.maxNumRetry?s||(a.resolved=!0):G.warn(`${t.details} reached or exceeded max retry (${l})`)):this.state=se.ERROR;this.tickImmediate()}reduceLengthAndFlushBuffer(e){if(this.state===se.PARSING||this.state===se.PARSED){const t=e.parent,n=this.getFwdBufferInfo(this.mediaBuffer,t),i=n&&n.len>.5;i&&this.reduceMaxBufferLength(n.len);const s=!i;return s&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${t} buffer`),e.frag&&(this.fragmentTracker.removeFragment(e.frag),this.nextLoadPosition=e.frag.start),this.resetLoadingState(),s}return!1}resetFragmentErrors(e){e===De.AUDIO&&(this.fragCurrent=null),this.loadedmetadata||(this.startFragRequested=!1),this.state!==se.STOPPED&&(this.state=se.IDLE)}afterBufferFlushed(e,t,n){if(!e)return;const i=Je.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,i,n),this.state===se.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=se.IDLE}resetStartWhenNotLoaded(e){if(!this.loadedmetadata){this.startFragRequested=!1;const t=this.levels?this.levels[e].details:null;t!=null&&t.live?(this.startPosition=-1,this.setStartPosition(t,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.warn(`The loading context changed while buffering fragment ${e.sn} of level ${e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(e.level),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,n,i){var s;const a=n.details;if(!a){this.warn("level.details undefined");return}if(Object.keys(e.elementaryStreams).reduce((l,u)=>{const c=e.elementaryStreams[u];if(c){const f=c.endPTS-c.startPTS;if(f<=0)return this.warn(`Could not parse fragment ${e.sn} ${u} duration reliably (${f})`),l||!1;const h=i?0:eE(a,e,c.startPTS,c.endPTS,c.startDTS,c.endDTS);return this.hls.trigger(A.LEVEL_PTS_UPDATED,{details:a,level:n,drift:h,type:u,frag:e,start:c.startPTS,end:c.endPTS}),!0}return l},!1))n.fragmentError=0;else if(((s=this.transmuxer)==null?void 0:s.error)===null){const l=new Error(`Found no media in fragment ${e.sn} of level ${n.id} resetting transmuxer to fallback to playlist timing`);if(this.warn(l.message),this.hls.trigger(A.ERROR,{type:be.MEDIA_ERROR,details:J.FRAG_PARSING_ERROR,fatal:!1,error:l,frag:e,reason:`Found no media in msn ${e.sn} of level "${n.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state=se.PARSED,this.hls.trigger(A.FRAG_PARSED,{frag:e,part:t})}resetTransmuxer(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)}recoverWorkerError(e){e.event==="demuxerWorker"&&(this.resetTransmuxer(),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}function aE(){return self.SourceBuffer||self.WebKitSourceBuffer}function p2(){const r=Iu();if(!r)return!1;const e=aE(),t=r&&typeof r.isTypeSupported=="function"&&r.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),n=!e||e.prototype&&typeof e.prototype.appendBuffer=="function"&&typeof e.prototype.remove=="function";return!!t&&!!n}function g2(){var r;const e=aE();return typeof(e==null||(r=e.prototype)==null?void 0:r.changeType)=="function"}function m2(){return typeof __HLS_WORKER_BUNDLE__=="function"}function v2(){const r=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),e=self.URL.createObjectURL(r);return{worker:new self.Worker(e),objectURL:e}}function y2(r){const e=new self.URL(r,self.location.href).href;return{worker:new self.Worker(e),scriptURL:e}}function xn(r="",e=9e4){return{type:r,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class oE{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,n,i){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,n){}demux(e,t){this.cachedData&&(e=Yi(this.cachedData,e),this.cachedData=null);let n=ru(e,0),i=n?n.length:0,s;const a=this._audioTrack,o=this._id3Track,l=n?ew(n):void 0,u=e.length;for((this.basePTS===null||this.frameIndex===0&&_e(l))&&(this.basePTS=E2(l,t,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),n&&n.length>0&&o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:ln.audioId3,duration:Number.POSITIVE_INFINITY});i<u;){if(this.canParse(e,i)){const c=this.appendFrame(a,e,i);c?(this.frameIndex++,this.lastPTS=c.sample.pts,i+=c.length,s=i):i=u}else J1(e,i)?(n=ru(e,i),o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:ln.audioId3,duration:Number.POSITIVE_INFINITY}),i+=n.length,s=i):i++;if(i===u&&s!==u){const c=Gi(e,s);this.cachedData?this.cachedData=Yi(this.cachedData,c):this.cachedData=c}}return{audioTrack:a,videoTrack:xn(),id3Track:o,textTrack:xn()}}demuxSampleAes(e,t,n){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:xn(),id3Track:this._id3Track,textTrack:xn()}}destroy(){}}const E2=(r,e,t)=>{if(_e(r))return r*90;const n=t?t.baseTime*9e4/t.timescale:0;return e*9e4+n};function x2(r,e,t,n){let i,s,a,o;const l=navigator.userAgent.toLowerCase(),u=n,c=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];i=((e[t+2]&192)>>>6)+1;const f=(e[t+2]&60)>>>2;if(f>c.length-1){r.trigger(A.ERROR,{type:be.MEDIA_ERROR,details:J.FRAG_PARSING_ERROR,fatal:!0,reason:`invalid ADTS sampling index:${f}`});return}return a=(e[t+2]&1)<<2,a|=(e[t+3]&192)>>>6,G.log(`manifest codec:${n}, ADTS type:${i}, samplingIndex:${f}`),/firefox/i.test(l)?f>=6?(i=5,o=new Array(4),s=f-3):(i=2,o=new Array(2),s=f):l.indexOf("android")!==-1?(i=2,o=new Array(2),s=f):(i=5,o=new Array(4),n&&(n.indexOf("mp4a.40.29")!==-1||n.indexOf("mp4a.40.5")!==-1)||!n&&f>=6?s=f-3:((n&&n.indexOf("mp4a.40.2")!==-1&&(f>=6&&a===1||/vivaldi/i.test(l))||!n&&a===1)&&(i=2,o=new Array(2)),s=f)),o[0]=i<<3,o[0]|=(f&14)>>1,o[1]|=(f&1)<<7,o[1]|=a<<3,i===5&&(o[1]|=(s&14)>>1,o[2]=(s&1)<<7,o[2]|=2<<2,o[3]=0),{config:o,samplerate:c[f],channelCount:a,codec:"mp4a.40."+i,manifestCodec:u}}function lE(r,e){return r[e]===255&&(r[e+1]&246)===240}function uE(r,e){return r[e+1]&1?7:9}function Md(r,e){return(r[e+3]&3)<<11|r[e+4]<<3|(r[e+5]&224)>>>5}function T2(r,e){return e+5<r.length}function ou(r,e){return e+1<r.length&&lE(r,e)}function S2(r,e){return T2(r,e)&&lE(r,e)&&Md(r,e)<=r.length-e}function w2(r,e){if(ou(r,e)){const t=uE(r,e);if(e+t>=r.length)return!1;const n=Md(r,e);if(n<=t)return!1;const i=e+n;return i===r.length||ou(r,i)}return!1}function cE(r,e,t,n,i){if(!r.samplerate){const s=x2(e,t,n,i);if(!s)return;r.config=s.config,r.samplerate=s.samplerate,r.channelCount=s.channelCount,r.codec=s.codec,r.manifestCodec=s.manifestCodec,G.log(`parsed codec:${r.codec}, rate:${s.samplerate}, channels:${s.channelCount}`)}}function fE(r){return 1024*9e4/r}function _2(r,e){const t=uE(r,e);if(e+t<=r.length){const n=Md(r,e)-t;if(n>0)return{headerLength:t,frameLength:n}}}function hE(r,e,t,n,i){const s=fE(r.samplerate),a=n+i*s,o=_2(e,t);let l;if(o){const{frameLength:f,headerLength:h}=o,d=h+f,m=Math.max(0,t+d-e.length);m?(l=new Uint8Array(d-h),l.set(e.subarray(t+h,e.length),0)):l=e.subarray(t+h,t+d);const x={unit:l,pts:a};return m||r.samples.push(x),{sample:x,length:d,missing:m}}const u=e.length-t;return l=new Uint8Array(u),l.set(e.subarray(t,e.length),0),{sample:{unit:l,pts:a},length:u,missing:-1}}class A2 extends oE{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,n,i){super.resetInitSegment(e,t,n,i),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;let n=(ru(e,0)||[]).length;for(let i=e.length;n<i;n++)if(w2(e,n))return G.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return S2(e,t)}appendFrame(e,t,n){cE(e,this.observer,t,n,e.manifestCodec);const i=hE(e,t,n,this.basePTS,this.frameIndex);if(i&&i.missing===0)return i}}const b2=/\/emsg[-/]ID3/i;class D2{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,n,i){const s=this.videoTrack=xn("video",1),a=this.audioTrack=xn("audio",1),o=this.txtTrack=xn("text",1);if(this.id3Track=xn("id3",1),this.timeOffset=0,!(e!=null&&e.byteLength))return;const l=Ky(e);if(l.video){const{id:u,timescale:c,codec:f}=l.video;s.id=u,s.timescale=o.timescale=c,s.codec=f}if(l.audio){const{id:u,timescale:c,codec:f}=l.audio;a.id=u,a.timescale=c,a.codec=f}o.id=Wy.text,s.sampleDuration=0,s.duration=a.duration=i}resetContiguity(){this.remainderData=null}static probe(e){return e=e.length>16384?e.subarray(0,16384):e,Be(e,["moof"]).length>0}demux(e,t){this.timeOffset=t;let n=e;const i=this.videoTrack,s=this.txtTrack;if(this.config.progressive){this.remainderData&&(n=Yi(this.remainderData,e));const o=gw(n);this.remainderData=o.remainder,i.samples=o.valid||new Uint8Array}else i.samples=n;const a=this.extractID3Track(i,t);return s.samples=Rg(t,i),{videoTrack:i,audioTrack:this.audioTrack,id3Track:a,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,n=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const i=this.extractID3Track(t,this.timeOffset);return n.samples=Rg(e,t),{videoTrack:t,audioTrack:xn(),id3Track:i,textTrack:xn()}}extractID3Track(e,t){const n=this.id3Track;if(e.samples.length){const i=Be(e.samples,["emsg"]);i&&i.forEach(s=>{const a=yw(s);if(b2.test(a.schemeIdUri)){const o=_e(a.presentationTime)?a.presentationTime/a.timeScale:t+a.presentationTimeDelta/a.timeScale;let l=a.eventDuration===4294967295?Number.POSITIVE_INFINITY:a.eventDuration/a.timeScale;l<=.001&&(l=Number.POSITIVE_INFINITY);const u=a.payload;n.samples.push({data:u,len:u.byteLength,dts:o,pts:o,type:ln.emsg,duration:l})}})}return n}demuxSampleAes(e,t,n){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){}}let il=null;const C2=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],R2=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],L2=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],I2=[0,1,1,4];function dE(r,e,t,n,i){if(t+24>e.length)return;const s=pE(e,t);if(s&&t+s.frameLength<=e.length){const a=s.samplesPerFrame*9e4/s.sampleRate,o=n+i*a,l={unit:e.subarray(t,t+s.frameLength),pts:o,dts:o};return r.config=[],r.channelCount=s.channelCount,r.samplerate=s.sampleRate,r.samples.push(l),{sample:l,length:s.frameLength,missing:0}}}function pE(r,e){const t=r[e+1]>>3&3,n=r[e+1]>>1&3,i=r[e+2]>>4&15,s=r[e+2]>>2&3;if(t!==1&&i!==0&&i!==15&&s!==3){const a=r[e+2]>>1&1,o=r[e+3]>>6,l=t===3?3-n:n===3?3:4,u=C2[l*14+i-1]*1e3,f=R2[(t===3?0:t===2?1:2)*3+s],h=o===3?1:2,d=L2[t][n],m=I2[n],x=d*8*m,p=Math.floor(d*u/f+a)*m;if(il===null){const E=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);il=E?parseInt(E[1]):0}return!!il&&il<=87&&n===2&&u>=224e3&&o===0&&(r[e+3]=r[e+3]|128),{sampleRate:f,channelCount:h,frameLength:p,samplesPerFrame:x}}}function Bd(r,e){return r[e]===255&&(r[e+1]&224)===224&&(r[e+1]&6)!==0}function gE(r,e){return e+1<r.length&&Bd(r,e)}function k2(r,e){return Bd(r,e)&&4<=r.length-e}function O2(r,e){if(e+1<r.length&&Bd(r,e)){const n=pE(r,e);let i=4;n!=null&&n.frameLength&&(i=n.frameLength);const s=e+i;return s===r.length||gE(r,s)}return!1}class Qg{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,n=e.byteLength-t,i=new Uint8Array(4),s=Math.min(4,t);if(s===0)throw new Error("no bytes available");i.set(e.subarray(n,n+s)),this.word=new DataView(i.buffer).getUint32(0),this.bitsAvailable=s*8,this.bytesAvailable-=s}skipBits(e){let t;e=Math.min(e,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const n=this.word>>>32-t;if(e>32&&G.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return t=e-t,t>0&&this.bitsAvailable?n<<t|this.readBits(t):n}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if((this.word&2147483648>>>e)!==0)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}skipScalingList(e){let t=8,n=8,i;for(let s=0;s<e;s++)n!==0&&(i=this.readEG(),n=(t+i+256)%256),t=n===0?t:n}readSPS(){let e=0,t=0,n=0,i=0,s,a,o;const l=this.readUByte.bind(this),u=this.readBits.bind(this),c=this.readUEG.bind(this),f=this.readBoolean.bind(this),h=this.skipBits.bind(this),d=this.skipEG.bind(this),m=this.skipUEG.bind(this),x=this.skipScalingList.bind(this);l();const p=l();if(u(5),h(3),l(),m(),p===100||p===110||p===122||p===244||p===44||p===83||p===86||p===118||p===128){const w=c();if(w===3&&h(1),m(),m(),h(1),f())for(a=w!==3?8:12,o=0;o<a;o++)f()&&(o<6?x(16):x(64))}m();const g=c();if(g===0)c();else if(g===1)for(h(1),d(),d(),s=c(),o=0;o<s;o++)d();m(),h(1);const v=c(),E=c(),S=u(1);S===0&&h(1),h(1),f()&&(e=c(),t=c(),n=c(),i=c());let T=[1,1];if(f()&&f())switch(l()){case 1:T=[1,1];break;case 2:T=[12,11];break;case 3:T=[10,11];break;case 4:T=[16,11];break;case 5:T=[40,33];break;case 6:T=[24,11];break;case 7:T=[20,11];break;case 8:T=[32,11];break;case 9:T=[80,33];break;case 10:T=[18,11];break;case 11:T=[15,11];break;case 12:T=[64,33];break;case 13:T=[160,99];break;case 14:T=[4,3];break;case 15:T=[3,2];break;case 16:T=[2,1];break;case 255:{T=[l()<<8|l(),l()<<8|l()];break}}return{width:Math.ceil((v+1)*16-e*2-t*2),height:(2-S)*(E+1)*16-(S?2:4)*(n+i),pixelRatio:T}}readSliceType(){return this.readUByte(),this.readUEG(),this.readUEG()}}class N2{constructor(e,t,n){this.keyData=void 0,this.decrypter=void 0,this.keyData=n,this.decrypter=new Pd(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer)}decryptAacSample(e,t,n){const i=e[t].unit;if(i.length<=16)return;const s=i.subarray(16,i.length-i.length%16),a=s.buffer.slice(s.byteOffset,s.byteOffset+s.length);this.decryptBuffer(a).then(o=>{const l=new Uint8Array(o);i.set(l,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,n)})}decryptAacSamples(e,t,n){for(;;t++){if(t>=e.length){n();return}if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,n),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const t=Math.floor((e.length-48)/160)*16+16,n=new Int8Array(t);let i=0;for(let s=32;s<e.length-16;s+=160,i+=16)n.set(e.subarray(s,s+16),i);return n}getAvcDecryptedUnit(e,t){const n=new Uint8Array(t);let i=0;for(let s=32;s<e.length-16;s+=160,i+=16)e.set(n.subarray(i,i+16),s);return e}decryptAvcSample(e,t,n,i,s){const a=Xy(s.data),o=this.getAvcEncryptedData(a);this.decryptBuffer(o.buffer).then(l=>{s.data=this.getAvcDecryptedUnit(a,l),this.decrypter.isSync()||this.decryptAvcSamples(e,t,n+1,i)})}decryptAvcSamples(e,t,n,i){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,n=0){if(t>=e.length){i();return}const s=e[t].units;for(;!(n>=s.length);n++){const a=s[n];if(!(a.data.length<=48||a.type!==1&&a.type!==5)&&(this.decryptAvcSample(e,t,n,i,a),!this.decrypter.isSync()))return}}}}const Gt=188;class li{constructor(e,t,n){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=e,this.config=t,this.typeSupported=n}static probe(e){const t=li.syncOffset(e);return t>0&&G.warn(`MPEG2-TS detected but first sync word found @ offset ${t}`),t!==-1}static syncOffset(e){const t=e.length;let n=Math.min(Gt*5,e.length-Gt)+1,i=0;for(;i<n;){let s=!1,a=-1,o=0;for(let l=i;l<t;l+=Gt)if(e[l]===71){if(o++,a===-1&&(a=l,a!==0&&(n=Math.min(a+Gt*99,e.length-Gt)+1)),s||(s=Sh(e,l)===0),s&&o>1&&(a===0&&o>2||l+Gt>n))return a}else{if(o)return-1;break}i++}return-1}static createTrack(e,t){return{container:e==="video"||e==="audio"?"video/mp2t":void 0,type:e,id:Wy[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:e==="audio"?t:void 0}}resetInitSegment(e,t,n,i){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=li.createTrack("video"),this._audioTrack=li.createTrack("audio",i),this._id3Track=li.createTrack("id3"),this._txtTrack=li.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=n,this._duration=i}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_avcTrack:t,_id3Track:n}=this;e&&(e.pesData=null),t&&(t.pesData=null),n&&(n.pesData=null),this.aacOverFlow=null,this.avcSample=null,this.remainderData=null}demux(e,t,n=!1,i=!1){n||(this.sampleAes=null);let s;const a=this._avcTrack,o=this._audioTrack,l=this._id3Track,u=this._txtTrack;let c=a.pid,f=a.pesData,h=o.pid,d=l.pid,m=o.pesData,x=l.pesData,p=null,g=this.pmtParsed,v=this._pmtId,E=e.length;if(this.remainderData&&(e=Yi(this.remainderData,e),E=e.length,this.remainderData=null),E<Gt&&!i)return this.remainderData=e,{audioTrack:o,videoTrack:a,id3Track:l,textTrack:u};const S=Math.max(0,li.syncOffset(e));E-=(E-S)%Gt,E<e.byteLength&&!i&&(this.remainderData=new Uint8Array(e.buffer,E,e.buffer.byteLength-E));let T=0;for(let _=S;_<E;_+=Gt)if(e[_]===71){const C=!!(e[_+1]&64),O=Sh(e,_),L=(e[_+3]&48)>>4;let V;if(L>1){if(V=_+5+e[_+4],V===_+Gt)continue}else V=_+4;switch(O){case c:C&&(f&&(s=fs(f))&&this.parseAVCPES(a,u,s,!1),f={data:[],size:0}),f&&(f.data.push(e.subarray(V,_+Gt)),f.size+=_+Gt-V);break;case h:if(C){if(m&&(s=fs(m)))switch(o.segmentCodec){case"aac":this.parseAACPES(o,s);break;case"mp3":this.parseMPEGPES(o,s);break}m={data:[],size:0}}m&&(m.data.push(e.subarray(V,_+Gt)),m.size+=_+Gt-V);break;case d:C&&(x&&(s=fs(x))&&this.parseID3PES(l,s),x={data:[],size:0}),x&&(x.data.push(e.subarray(V,_+Gt)),x.size+=_+Gt-V);break;case 0:C&&(V+=e[V]+1),v=this._pmtId=P2(e,V);break;case v:{C&&(V+=e[V]+1);const $=F2(e,V,this.typeSupported,n);c=$.avc,c>0&&(a.pid=c),h=$.audio,h>0&&(o.pid=h,o.segmentCodec=$.segmentCodec),d=$.id3,d>0&&(l.pid=d),p!==null&&!g&&(G.warn(`MPEG-TS PMT found at ${_} after unknown PID '${p}'. Backtracking to sync byte @${S} to parse all TS packets.`),p=null,_=S-188),g=this.pmtParsed=!0;break}case 17:case 8191:break;default:p=O;break}}else T++;if(T>0){const _=new Error(`Found ${T} TS packet/s that do not start with 0x47`);this.observer.emit(A.ERROR,A.ERROR,{type:be.MEDIA_ERROR,details:J.FRAG_PARSING_ERROR,fatal:!1,error:_,reason:_.message})}a.pesData=f,o.pesData=m,l.pesData=x;const w={audioTrack:o,videoTrack:a,id3Track:l,textTrack:u};return i&&this.extractRemainingSamples(w),w}flush(){const{remainderData:e}=this;this.remainderData=null;let t;return e?t=this.demux(e,-1,!1,!0):t={videoTrack:this._avcTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:n,id3Track:i,textTrack:s}=e,a=n.pesData,o=t.pesData,l=i.pesData;let u;if(a&&(u=fs(a))?(this.parseAVCPES(n,s,u,!0),n.pesData=null):n.pesData=a,o&&(u=fs(o))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,u);break;case"mp3":this.parseMPEGPES(t,u);break}t.pesData=null}else o!=null&&o.size&&G.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=o;l&&(u=fs(l))?(this.parseID3PES(i,u),i.pesData=null):i.pesData=l}demuxSampleAes(e,t,n){const i=this.demux(e,n,!0,!this.config.progressive),s=this.sampleAes=new N2(this.observer,this.config,t);return this.decrypt(i,s)}decrypt(e,t){return new Promise(n=>{const{audioTrack:i,videoTrack:s}=e;i.samples&&i.segmentCodec==="aac"?t.decryptAacSamples(i.samples,0,()=>{s.samples?t.decryptAvcSamples(s.samples,0,0,()=>{n(e)}):n(e)}):s.samples&&t.decryptAvcSamples(s.samples,0,0,()=>{n(e)})})}destroy(){this._duration=0}parseAVCPES(e,t,n,i){const s=this.parseAVCNALu(e,n.data);let a=this.avcSample,o,l=!1;n.data=null,a&&s.length&&!e.audFound&&(Wc(a,e),a=this.avcSample=sl(!1,n.pts,n.dts,"")),s.forEach(u=>{switch(u.type){case 1:{o=!0,a||(a=this.avcSample=sl(!0,n.pts,n.dts,"")),a.frame=!0;const c=u.data;if(l&&c.length>4){const f=new Qg(c).readSliceType();(f===2||f===4||f===7||f===9)&&(a.key=!0)}break}case 5:o=!0,a||(a=this.avcSample=sl(!0,n.pts,n.dts,"")),a.key=!0,a.frame=!0;break;case 6:{o=!0,Yy(u.data,1,n.pts,t.samples);break}case 7:if(o=!0,l=!0,!e.sps){const c=u.data,h=new Qg(c).readSPS();e.width=h.width,e.height=h.height,e.pixelRatio=h.pixelRatio,e.sps=[c],e.duration=this._duration;const d=c.subarray(1,4);let m="avc1.";for(let x=0;x<3;x++){let p=d[x].toString(16);p.length<2&&(p="0"+p),m+=p}e.codec=m}break;case 8:o=!0,e.pps||(e.pps=[u.data]);break;case 9:o=!1,e.audFound=!0,a&&Wc(a,e),a=this.avcSample=sl(!1,n.pts,n.dts,"");break;case 12:o=!0;break;default:o=!1,a&&(a.debug+="unknown NAL "+u.type+" ");break}a&&o&&a.units.push(u)}),i&&a&&(Wc(a,e),this.avcSample=null)}getLastNalUnit(e){var t;let n=this.avcSample,i;if((!n||n.units.length===0)&&(n=e[e.length-1]),(t=n)!=null&&t.units){const s=n.units;i=s[s.length-1]}return i}parseAVCNALu(e,t){const n=t.byteLength;let i=e.naluState||0;const s=i,a=[];let o=0,l,u,c,f=-1,h=0;for(i===-1&&(f=0,h=t[0]&31,i=0,o=1);o<n;){if(l=t[o++],!i){i=l?0:1;continue}if(i===1){i=l?0:2;continue}if(!l)i=3;else if(l===1){if(f>=0){const d={data:t.subarray(f,o-i-1),type:h};a.push(d)}else{const d=this.getLastNalUnit(e.samples);if(d&&(s&&o<=4-s&&d.state&&(d.data=d.data.subarray(0,d.data.byteLength-s)),u=o-i-1,u>0)){const m=new Uint8Array(d.data.byteLength+u);m.set(d.data,0),m.set(t.subarray(0,u),d.data.byteLength),d.data=m,d.state=0}}o<n?(c=t[o]&31,f=o,h=c,i=0):i=-1}else i=0}if(f>=0&&i>=0){const d={data:t.subarray(f,n),type:h,state:i};a.push(d)}if(a.length===0){const d=this.getLastNalUnit(e.samples);if(d){const m=new Uint8Array(d.data.byteLength+t.byteLength);m.set(d.data,0),m.set(t,d.data.byteLength),d.data=m}}return e.naluState=i,a}parseAACPES(e,t){let n=0;const i=this.aacOverFlow;let s=t.data;if(i){this.aacOverFlow=null;const f=i.missing,h=i.sample.unit.byteLength;if(f===-1){const d=new Uint8Array(h+s.byteLength);d.set(i.sample.unit,0),d.set(s,h),s=d}else{const d=h-f;i.sample.unit.set(s.subarray(0,f),d),e.samples.push(i.sample),n=i.missing}}let a,o;for(a=n,o=s.length;a<o-1&&!ou(s,a);a++);if(a!==n){let f;const h=a<o-1;h?f=`AAC PES did not start with ADTS header,offset:${a}`:f="No ADTS header found in AAC PES";const d=new Error(f);if(G.warn(`parsing error: ${f}`),this.observer.emit(A.ERROR,A.ERROR,{type:be.MEDIA_ERROR,details:J.FRAG_PARSING_ERROR,fatal:!1,levelRetry:h,error:d,reason:f}),!h)return}cE(e,this.observer,s,a,this.audioCodec);let l;if(t.pts!==void 0)l=t.pts;else if(i){const f=fE(e.samplerate);l=i.sample.pts+f}else{G.warn("[tsdemuxer]: AAC PES unknown PTS");return}let u=0,c;for(;a<o;)if(c=hE(e,s,a,l,u),a+=c.length,c.missing){this.aacOverFlow=c;break}else for(u++;a<o-1&&!ou(s,a);a++);}parseMPEGPES(e,t){const n=t.data,i=n.length;let s=0,a=0;const o=t.pts;if(o===void 0){G.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;a<i;)if(gE(n,a)){const l=dE(e,n,a,o,s);if(l)a+=l.length,s++;else break}else a++}parseID3PES(e,t){if(t.pts===void 0){G.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const n=At({},t,{type:this._avcTrack?ln.emsg:ln.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(n)}}function sl(r,e,t,n){return{key:r,frame:!1,pts:e,dts:t,units:[],debug:n,length:0}}function Sh(r,e){return((r[e+1]&31)<<8)+r[e+2]}function P2(r,e){return(r[e+10]&31)<<8|r[e+11]}function F2(r,e,t,n){const i={audio:-1,avc:-1,id3:-1,segmentCodec:"aac"},s=(r[e+1]&15)<<8|r[e+2],a=e+3+s-4,o=(r[e+10]&15)<<8|r[e+11];for(e+=12+o;e<a;){const l=Sh(r,e);switch(r[e]){case 207:if(!n){G.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:i.audio===-1&&(i.audio=l);break;case 21:i.id3===-1&&(i.id3=l);break;case 219:if(!n){G.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:i.avc===-1&&(i.avc=l);break;case 3:case 4:t.mpeg!==!0&&t.mp3!==!0?G.log("MPEG audio found, not supported in this browser"):i.audio===-1&&(i.audio=l,i.segmentCodec="mp3");break;case 36:G.warn("Unsupported HEVC stream type found");break}e+=((r[e+3]&15)<<8|r[e+4])+5}return i}function fs(r){let e=0,t,n,i,s,a;const o=r.data;if(!r||r.size===0)return null;for(;o[0].length<19&&o.length>1;){const u=new Uint8Array(o[0].length+o[1].length);u.set(o[0]),u.set(o[1],o[0].length),o[0]=u,o.splice(1,1)}if(t=o[0],(t[0]<<16)+(t[1]<<8)+t[2]===1){if(n=(t[4]<<8)+t[5],n&&n>r.size-6)return null;const u=t[7];u&192&&(s=(t[9]&14)*536870912+(t[10]&255)*4194304+(t[11]&254)*16384+(t[12]&255)*128+(t[13]&254)/2,u&64?(a=(t[14]&14)*536870912+(t[15]&255)*4194304+(t[16]&254)*16384+(t[17]&255)*128+(t[18]&254)/2,s-a>60*9e4&&(G.warn(`${Math.round((s-a)/9e4)}s delta between PTS and DTS, align them`),s=a)):a=s),i=t[8];let c=i+9;if(r.size<=c)return null;r.size-=c;const f=new Uint8Array(r.size);for(let h=0,d=o.length;h<d;h++){t=o[h];let m=t.byteLength;if(c)if(c>m){c-=m;continue}else t=t.subarray(c),m-=c,c=0;f.set(t,e),e+=m}return n&&(n-=i+3),{data:f,pts:s,dts:a,len:n}}return null}function Wc(r,e){if(r.units.length&&r.frame){if(r.pts===void 0){const t=e.samples,n=t.length;if(n){const i=t[n-1];r.pts=i.pts,r.dts=i.dts}else{e.dropped++;return}}e.samples.push(r)}r.debug.length&&G.log(r.pts+"/"+r.dts+":"+r.debug)}class M2 extends oE{resetInitSegment(e,t,n,i){super.resetInitSegment(e,t,n,i),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;let n=(ru(e,0)||[]).length;for(let i=e.length;n<i;n++)if(O2(e,n))return G.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return k2(e,t)}appendFrame(e,t,n){if(this.basePTS!==null)return dE(e,t,n,this.basePTS,this.frameIndex)}}class Jg{static getSilentFrame(e,t){switch(e){case"mp4a.40.2":if(t===1)return new Uint8Array([0,200,0,128,35,128]);if(t===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(t===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(t===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(t===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(t===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(t===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const ti=Math.pow(2,32)-1;class q{static init(){q.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let e;for(e in q.types)q.types.hasOwnProperty(e)&&(q.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);q.HDLR_TYPES={video:t,audio:n};const i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),s=new Uint8Array([0,0,0,0,0,0,0,0]);q.STTS=q.STSC=q.STCO=s,q.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),q.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),q.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),q.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const a=new Uint8Array([105,115,111,109]),o=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);q.FTYP=q.box(q.types.ftyp,a,l,a,o),q.DINF=q.box(q.types.dinf,q.box(q.types.dref,i))}static box(e,...t){let n=8,i=t.length;const s=i;for(;i--;)n+=t[i].byteLength;const a=new Uint8Array(n);for(a[0]=n>>24&255,a[1]=n>>16&255,a[2]=n>>8&255,a[3]=n&255,a.set(e,4),i=0,n=8;i<s;i++)a.set(t[i],n),n+=t[i].byteLength;return a}static hdlr(e){return q.box(q.types.hdlr,q.HDLR_TYPES[e])}static mdat(e){return q.box(q.types.mdat,e)}static mdhd(e,t){t*=e;const n=Math.floor(t/(ti+1)),i=Math.floor(t%(ti+1));return q.box(q.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,n>>24,n>>16&255,n>>8&255,n&255,i>>24,i>>16&255,i>>8&255,i&255,85,196,0,0]))}static mdia(e){return q.box(q.types.mdia,q.mdhd(e.timescale,e.duration),q.hdlr(e.type),q.minf(e))}static mfhd(e){return q.box(q.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255]))}static minf(e){return e.type==="audio"?q.box(q.types.minf,q.box(q.types.smhd,q.SMHD),q.DINF,q.stbl(e)):q.box(q.types.minf,q.box(q.types.vmhd,q.VMHD),q.DINF,q.stbl(e))}static moof(e,t,n){return q.box(q.types.moof,q.mfhd(e),q.traf(n,t))}static moov(e){let t=e.length;const n=[];for(;t--;)n[t]=q.trak(e[t]);return q.box.apply(null,[q.types.moov,q.mvhd(e[0].timescale,e[0].duration)].concat(n).concat(q.mvex(e)))}static mvex(e){let t=e.length;const n=[];for(;t--;)n[t]=q.trex(e[t]);return q.box.apply(null,[q.types.mvex,...n])}static mvhd(e,t){t*=e;const n=Math.floor(t/(ti+1)),i=Math.floor(t%(ti+1)),s=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,n>>24,n>>16&255,n>>8&255,n&255,i>>24,i>>16&255,i>>8&255,i&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return q.box(q.types.mvhd,s)}static sdtp(e){const t=e.samples||[],n=new Uint8Array(4+t.length);let i,s;for(i=0;i<t.length;i++)s=t[i].flags,n[i+4]=s.dependsOn<<4|s.isDependedOn<<2|s.hasRedundancy;return q.box(q.types.sdtp,n)}static stbl(e){return q.box(q.types.stbl,q.stsd(e),q.box(q.types.stts,q.STTS),q.box(q.types.stsc,q.STSC),q.box(q.types.stsz,q.STSZ),q.box(q.types.stco,q.STCO))}static avc1(e){let t=[],n=[],i,s,a;for(i=0;i<e.sps.length;i++)s=e.sps[i],a=s.byteLength,t.push(a>>>8&255),t.push(a&255),t=t.concat(Array.prototype.slice.call(s));for(i=0;i<e.pps.length;i++)s=e.pps[i],a=s.byteLength,n.push(a>>>8&255),n.push(a&255),n=n.concat(Array.prototype.slice.call(s));const o=q.box(q.types.avcC,new Uint8Array([1,t[3],t[4],t[5],255,224|e.sps.length].concat(t).concat([e.pps.length]).concat(n))),l=e.width,u=e.height,c=e.pixelRatio[0],f=e.pixelRatio[1];return q.box(q.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,l&255,u>>8&255,u&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),o,q.box(q.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),q.box(q.types.pasp,new Uint8Array([c>>24,c>>16&255,c>>8&255,c&255,f>>24,f>>16&255,f>>8&255,f&255])))}static esds(e){const t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))}static mp4a(e){const t=e.samplerate;return q.box(q.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,t&255,0,0]),q.box(q.types.esds,q.esds(e)))}static mp3(e){const t=e.samplerate;return q.box(q.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,t&255,0,0]))}static stsd(e){return e.type==="audio"?e.segmentCodec==="mp3"&&e.codec==="mp3"?q.box(q.types.stsd,q.STSD,q.mp3(e)):q.box(q.types.stsd,q.STSD,q.mp4a(e)):q.box(q.types.stsd,q.STSD,q.avc1(e))}static tkhd(e){const t=e.id,n=e.duration*e.timescale,i=e.width,s=e.height,a=Math.floor(n/(ti+1)),o=Math.floor(n%(ti+1));return q.box(q.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,0,0,0,0,a>>24,a>>16&255,a>>8&255,a&255,o>>24,o>>16&255,o>>8&255,o&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>8&255,i&255,0,0,s>>8&255,s&255,0,0]))}static traf(e,t){const n=q.sdtp(e),i=e.id,s=Math.floor(t/(ti+1)),a=Math.floor(t%(ti+1));return q.box(q.types.traf,q.box(q.types.tfhd,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,i&255])),q.box(q.types.tfdt,new Uint8Array([1,0,0,0,s>>24,s>>16&255,s>>8&255,s&255,a>>24,a>>16&255,a>>8&255,a&255])),q.trun(e,n.length+16+20+8+16+8+8),n)}static trak(e){return e.duration=e.duration||4294967295,q.box(q.types.trak,q.tkhd(e),q.mdia(e))}static trex(e){const t=e.id;return q.box(q.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const n=e.samples||[],i=n.length,s=12+16*i,a=new Uint8Array(s);let o,l,u,c,f,h;for(t+=8+s,a.set([e.type==="video"?1:0,0,15,1,i>>>24&255,i>>>16&255,i>>>8&255,i&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255],0),o=0;o<i;o++)l=n[o],u=l.duration,c=l.size,f=l.flags,h=l.cts,a.set([u>>>24&255,u>>>16&255,u>>>8&255,u&255,c>>>24&255,c>>>16&255,c>>>8&255,c&255,f.isLeading<<2|f.dependsOn,f.isDependedOn<<6|f.hasRedundancy<<4|f.paddingValue<<1|f.isNonSync,f.degradPrio&240<<8,f.degradPrio&15,h>>>24&255,h>>>16&255,h>>>8&255,h&255],12+16*o);return q.box(q.types.trun,a)}static initSegment(e){q.types||q.init();const t=q.moov(e),n=new Uint8Array(q.FTYP.byteLength+t.byteLength);return n.set(q.FTYP),n.set(t,q.FTYP.byteLength),n}}q.types=void 0;q.HDLR_TYPES=void 0;q.STTS=void 0;q.STSC=void 0;q.STCO=void 0;q.STSZ=void 0;q.VMHD=void 0;q.SMHD=void 0;q.STSD=void 0;q.FTYP=void 0;q.DINF=void 0;const mE=9e4;function Ud(r,e,t=1,n=!1){const i=r*e*t;return n?Math.round(i):i}function B2(r,e,t=1,n=!1){return Ud(r,e,1/t,n)}function Ea(r,e=!1){return Ud(r,1e3,1/mE,e)}function U2(r,e=1){return Ud(r,mE,1/e)}const $2=10*1e3,e0=1024,z2=1152;let al=null,Hc=null;class jc{constructor(e,t,n,i=""){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=e,this.config=t,this.typeSupported=n,this.ISGenerated=!1,al===null){const a=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);al=a?parseInt(a[1]):0}if(Hc===null){const s=navigator.userAgent.match(/Safari\/(\d+)/i);Hc=s?parseInt(s[1]):0}}destroy(){}resetTimeStamp(e){G.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e}resetNextTimestamp(){G.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){G.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1}getVideoStartPts(e){let t=!1;const n=e.reduce((i,s)=>{const a=s.pts-i;return a<-4294967296?(t=!0,Mr(i,s.pts)):a>0?i:s.pts},e[0].pts);return t&&G.debug("PTS rollover detected"),n}remux(e,t,n,i,s,a,o,l){let u,c,f,h,d,m,x=s,p=s;const g=e.pid>-1,v=t.pid>-1,E=t.samples.length,S=e.samples.length>0,T=o&&E>0||E>1;if((!g||S)&&(!v||T)||this.ISGenerated||o){this.ISGenerated||(f=this.generateIS(e,t,s,a));const _=this.isVideoContiguous;let C=-1,O;if(T&&(C=V2(t.samples),!_&&this.config.forceKeyFrameOnDiscontinuity))if(m=!0,C>0){G.warn(`[mp4-remuxer]: Dropped ${C} out of ${E} video samples due to a missing keyframe`);const L=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(C),t.dropped+=C,p+=(t.samples[0].pts-L)/t.inputTimeScale,O=p}else C===-1&&(G.warn(`[mp4-remuxer]: No keyframe found out of ${E} video samples`),m=!1);if(this.ISGenerated){if(S&&T){const L=this.getVideoStartPts(t.samples),$=(Mr(e.samples[0].pts,L)-L)/t.inputTimeScale;x+=Math.max(0,$),p+=Math.max(0,-$)}if(S){if(e.samplerate||(G.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),f=this.generateIS(e,t,s,a)),c=this.remuxAudio(e,x,this.isAudioContiguous,a,v||T||l===De.AUDIO?p:void 0),T){const L=c?c.endPTS-c.startPTS:0;t.inputTimeScale||(G.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),f=this.generateIS(e,t,s,a)),u=this.remuxVideo(t,p,_,L)}}else T&&(u=this.remuxVideo(t,p,_,0));u&&(u.firstKeyFrame=C,u.independent=C!==-1,u.firstKeyFramePTS=O)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(n.samples.length&&(d=vE(n,s,this._initPTS,this._initDTS)),i.samples.length&&(h=yE(i,s,this._initPTS))),{audio:c,video:u,initSegment:f,independent:m,text:h,id3:d}}generateIS(e,t,n,i){const s=e.samples,a=t.samples,o=this.typeSupported,l={},u=this._initPTS;let c=!u||i,f="audio/mp4",h,d,m;if(c&&(h=d=1/0),e.config&&s.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":o.mpeg?(f="audio/mpeg",e.codec=""):o.mp3&&(e.codec="mp3");break}l.audio={id:"audio",container:f,codec:e.codec,initSegment:e.segmentCodec==="mp3"&&o.mpeg?new Uint8Array(0):q.initSegment([e]),metadata:{channelCount:e.channelCount}},c&&(m=e.inputTimeScale,!u||m!==u.timescale?h=d=s[0].pts-Math.round(m*n):c=!1)}if(t.sps&&t.pps&&a.length&&(t.timescale=t.inputTimeScale,l.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:q.initSegment([t]),metadata:{width:t.width,height:t.height}},c))if(m=t.inputTimeScale,!u||m!==u.timescale){const x=this.getVideoStartPts(a),p=Math.round(m*n);d=Math.min(d,Mr(a[0].dts,x)-p),h=Math.min(h,x-p)}else c=!1;if(Object.keys(l).length)return this.ISGenerated=!0,c?(this._initPTS={baseTime:h,timescale:m},this._initDTS={baseTime:d,timescale:m}):h=m=void 0,{tracks:l,initPTS:h,timescale:m}}remuxVideo(e,t,n,i){const s=e.inputTimeScale,a=e.samples,o=[],l=a.length,u=this._initPTS;let c=this.nextAvcDts,f=8,h=this.videoSampleDuration,d,m,x=Number.POSITIVE_INFINITY,p=Number.NEGATIVE_INFINITY,g=!1;if(!n||c===null){const N=t*s,U=a[0].pts-Mr(a[0].dts,a[0].pts);c=N-U}const v=u.baseTime*s/u.timescale;for(let N=0;N<l;N++){const U=a[N];U.pts=Mr(U.pts-v,c),U.dts=Mr(U.dts-v,c),U.dts<a[N>0?N-1:N].dts&&(g=!0)}g&&a.sort(function(N,U){const Z=N.dts-U.dts,oe=N.pts-U.pts;return Z||oe}),d=a[0].dts,m=a[a.length-1].dts;const E=m-d,S=E?Math.round(E/(l-1)):h||e.inputTimeScale/30;if(n){const N=d-c,U=N>S,Z=N<-1;if((U||Z)&&(U?G.warn(`AVC: ${Ea(N,!0)} ms (${N}dts) hole between fragments detected, filling it`):G.warn(`AVC: ${Ea(-N,!0)} ms (${N}dts) overlapping between fragments detected`),!Z||c>=a[0].pts)){d=c;const oe=a[0].pts-N;a[0].dts=d,a[0].pts=oe,G.log(`Video: First PTS/DTS adjusted: ${Ea(oe,!0)}/${Ea(d,!0)}, delta: ${Ea(N,!0)} ms`)}}d=Math.max(0,d);let T=0,w=0;for(let N=0;N<l;N++){const U=a[N],Z=U.units,oe=Z.length;let re=0;for(let pe=0;pe<oe;pe++)re+=Z[pe].data.length;w+=re,T+=oe,U.length=re,U.dts=Math.max(U.dts,d),x=Math.min(U.pts,x),p=Math.max(U.pts,p)}m=a[l-1].dts;const _=w+4*T+8;let C;try{C=new Uint8Array(_)}catch(N){this.observer.emit(A.ERROR,A.ERROR,{type:be.MUX_ERROR,details:J.REMUX_ALLOC_ERROR,fatal:!1,error:N,bytes:_,reason:`fail allocating video mdat ${_}`});return}const O=new DataView(C.buffer);O.setUint32(0,_),C.set(q.types.mdat,4);let L=!1,V=Number.POSITIVE_INFINITY,$=Number.POSITIVE_INFINITY,ne=Number.NEGATIVE_INFINITY,me=Number.NEGATIVE_INFINITY;for(let N=0;N<l;N++){const U=a[N],Z=U.units;let oe=0;for(let Te=0,Ie=Z.length;Te<Ie;Te++){const Le=Z[Te],Oe=Le.data,Re=Le.data.byteLength;O.setUint32(f,Re),f+=4,C.set(Oe,f),f+=Re,oe+=4+Re}let re;if(N<l-1)h=a[N+1].dts-U.dts,re=a[N+1].pts-U.pts;else{const Te=this.config,Ie=N>0?U.dts-a[N-1].dts:S;if(re=N>0?U.pts-a[N-1].pts:S,Te.stretchShortVideoTrack&&this.nextAudioPts!==null){const Le=Math.floor(Te.maxBufferHole*s),Oe=(i?x+i*s:this.nextAudioPts)-U.pts;Oe>Le?(h=Oe-Ie,h<0?h=Ie:L=!0,G.log(`[mp4-remuxer]: It is approximately ${Oe/90} ms to the next segment; using duration ${h/90} ms for the last video frame.`)):h=Ie}else h=Ie}const pe=Math.round(U.pts-U.dts);V=Math.min(V,h),ne=Math.max(ne,h),$=Math.min($,re),me=Math.max(me,re),o.push(new t0(U.key,h,oe,pe))}if(o.length){if(al){if(al<70){const N=o[0].flags;N.dependsOn=2,N.isNonSync=0}}else if(Hc&&me-$<ne-V&&S/ne<.025&&o[0].cts===0){G.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let N=d;for(let U=0,Z=o.length;U<Z;U++){const oe=N+o[U].duration,re=N+o[U].cts;if(U<Z-1){const pe=oe+o[U+1].cts;o[U].duration=pe-re}else o[U].duration=U?o[U-1].duration:S;o[U].cts=0,N=oe}}}h=L||!h?S:h,this.nextAvcDts=c=m+h,this.videoSampleDuration=h,this.isVideoContiguous=!0;const H=q.moof(e.sequenceNumber++,d,At({},e,{samples:o})),j="video",X={data1:H,data2:C,startPTS:x/s,endPTS:(p+h)/s,startDTS:d/s,endDTS:c/s,type:j,hasAudio:!1,hasVideo:!0,nb:o.length,dropped:e.dropped};return e.samples=[],e.dropped=0,X}remuxAudio(e,t,n,i,s){const a=e.inputTimeScale,o=e.samplerate?e.samplerate:a,l=a/o,u=e.segmentCodec==="aac"?e0:z2,c=u*l,f=this._initPTS,h=e.segmentCodec==="mp3"&&this.typeSupported.mpeg,d=[],m=s!==void 0;let x=e.samples,p=h?0:8,g=this.nextAudioPts||-1;const v=t*a,E=f.baseTime*a/f.timescale;if(this.isAudioContiguous=n=n||x.length&&g>0&&(i&&Math.abs(v-g)<9e3||Math.abs(Mr(x[0].pts-E,v)-g)<20*c),x.forEach(function(j){j.pts=Mr(j.pts-E,v)}),!n||g<0){if(x=x.filter(j=>j.pts>=0),!x.length)return;s===0?g=0:i&&!m?g=Math.max(0,v):g=x[0].pts}if(e.segmentCodec==="aac"){const j=this.config.maxAudioFramesDrift;for(let X=0,N=g;X<x.length;X++){const U=x[X],Z=U.pts,oe=Z-N,re=Math.abs(1e3*oe/a);if(oe<=-j*c&&m)X===0&&(G.warn(`Audio frame @ ${(Z/a).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*oe/a)} ms.`),this.nextAudioPts=g=N=Z);else if(oe>=j*c&&re<$2&&m){let pe=Math.round(oe/c);N=Z-pe*c,N<0&&(pe--,N+=c),X===0&&(this.nextAudioPts=g=N),G.warn(`[mp4-remuxer]: Injecting ${pe} audio frame @ ${(N/a).toFixed(3)}s due to ${Math.round(1e3*oe/a)} ms gap.`);for(let Te=0;Te<pe;Te++){const Ie=Math.max(N,0);let Le=Jg.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);Le||(G.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),Le=U.unit.subarray()),x.splice(X,0,{unit:Le,pts:Ie}),N+=c,X++}}U.pts=N,N+=c}}let S=null,T=null,w,_=0,C=x.length;for(;C--;)_+=x[C].unit.byteLength;for(let j=0,X=x.length;j<X;j++){const N=x[j],U=N.unit;let Z=N.pts;if(T!==null){const re=d[j-1];re.duration=Math.round((Z-T)/l)}else if(n&&e.segmentCodec==="aac"&&(Z=g),S=Z,_>0){_+=p;try{w=new Uint8Array(_)}catch(re){this.observer.emit(A.ERROR,A.ERROR,{type:be.MUX_ERROR,details:J.REMUX_ALLOC_ERROR,fatal:!1,error:re,bytes:_,reason:`fail allocating audio mdat ${_}`});return}h||(new DataView(w.buffer).setUint32(0,_),w.set(q.types.mdat,4))}else return;w.set(U,p);const oe=U.byteLength;p+=oe,d.push(new t0(!0,u,oe,0)),T=Z}const O=d.length;if(!O)return;const L=d[d.length-1];this.nextAudioPts=g=T+l*L.duration;const V=h?new Uint8Array(0):q.moof(e.sequenceNumber++,S/l,At({},e,{samples:d}));e.samples=[];const $=S/a,ne=g/a,H={data1:V,data2:w,startPTS:$,endPTS:ne,startDTS:$,endDTS:ne,type:"audio",hasAudio:!0,hasVideo:!1,nb:O};return this.isAudioContiguous=!0,H}remuxEmptyAudio(e,t,n,i){const s=e.inputTimeScale,a=e.samplerate?e.samplerate:s,o=s/a,l=this.nextAudioPts,u=this._initDTS,c=u.baseTime*9e4/u.timescale,f=(l!==null?l:i.startDTS*s)+c,h=i.endDTS*s+c,d=o*e0,m=Math.ceil((h-f)/d),x=Jg.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(G.warn("[mp4-remuxer]: remux empty Audio"),!x){G.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");return}const p=[];for(let g=0;g<m;g++){const v=f+g*d;p.push({unit:x,pts:v,dts:v})}return e.samples=p,this.remuxAudio(e,t,n,!1)}}function Mr(r,e){let t;if(e===null)return r;for(e<r?t=-8589934592:t=8589934592;Math.abs(r-e)>4294967296;)r+=t;return r}function V2(r){for(let e=0;e<r.length;e++)if(r[e].key)return e;return-1}function vE(r,e,t,n){const i=r.samples.length;if(!i)return;const s=r.inputTimeScale;for(let o=0;o<i;o++){const l=r.samples[o];l.pts=Mr(l.pts-t.baseTime*s/t.timescale,e*s)/s,l.dts=Mr(l.dts-n.baseTime*s/n.timescale,e*s)/s}const a=r.samples;return r.samples=[],{samples:a}}function yE(r,e,t){const n=r.samples.length;if(!n)return;const i=r.inputTimeScale;for(let a=0;a<n;a++){const o=r.samples[a];o.pts=Mr(o.pts-t.baseTime*9e4/t.timescale,e*i)/i}r.samples.sort((a,o)=>a.pts-o.pts);const s=r.samples;return r.samples=[],{samples:s}}class t0{constructor(e,t,n,i){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=t,this.size=n,this.cts=i,this.flags=new G2(e)}}class G2{constructor(e){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=e?2:1,this.isNonSync=e?0:1}}class W2{constructor(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null}destroy(){}resetTimeStamp(e){this.initPTS=e,this.lastEndTime=null}resetNextTimestamp(){this.lastEndTime=null}resetInitSegment(e,t,n,i){this.audioCodec=t,this.videoCodec=n,this.generateInitSegment(cw(e,i)),this.emitInitSegment=!0}generateInitSegment(e){let{audioCodec:t,videoCodec:n}=this;if(!(e!=null&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const i=this.initData=Ky(e);t||(t=r0(i.audio,qe.AUDIO)),n||(n=r0(i.video,qe.VIDEO));const s={};i.audio&&i.video?s.audiovideo={container:"video/mp4",codec:t+","+n,initSegment:e,id:"main"}:i.audio?s.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:i.video?s.video={container:"video/mp4",codec:n,initSegment:e,id:"main"}:G.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=s}remux(e,t,n,i,s,a){var o,l;let{initPTS:u,lastEndTime:c}=this;const f={audio:void 0,video:void 0,text:i,id3:n,initSegment:void 0};_e(c)||(c=this.lastEndTime=s||0);const h=t.samples;if(!(h!=null&&h.length))return f;const d={initPTS:void 0,timescale:1};let m=this.initData;if((o=m)!=null&&o.length||(this.generateInitSegment(h),m=this.initData),!((l=m)!=null&&l.length))return G.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),f;this.emitInitSegment&&(d.tracks=this.initTracks,this.emitInitSegment=!1);const x=hw(h,m),p=fw(m,h),g=p===null?s:p;(H2(u,g,s,x)||d.timescale!==u.timescale&&a)&&(d.initPTS=g-s,u&&u.timescale===1&&G.warn(`Adjusting initPTS by ${d.initPTS-u.baseTime}`),this.initPTS=u={baseTime:d.initPTS,timescale:1});const v=e?g-u.baseTime/u.timescale:c,E=v+x;pw(m,h,u.baseTime/u.timescale),x>0?this.lastEndTime=E:(G.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const S=!!m.audio,T=!!m.video;let w="";S&&(w+="audio"),T&&(w+="video");const _={data1:h,startPTS:v,startDTS:v,endPTS:E,endDTS:E,type:w,hasAudio:S,hasVideo:T,nb:1,dropped:0};return f.audio=_.type==="audio"?_:void 0,f.video=_.type!=="audio"?_:void 0,f.initSegment=d,f.id3=vE(n,s,u,u),i.samples.length&&(f.text=yE(i,s,u)),f}}function H2(r,e,t,n){if(r===null)return!0;const i=Math.max(n,1),s=e-r.baseTime/r.timescale;return Math.abs(s-t)>i}function r0(r,e){const t=r==null?void 0:r.codec;return t&&t.length>4?t:t==="hvc1"||t==="hev1"?"hvc1.1.6.L120.90":t==="av01"?"av01.0.04M.08":t==="avc1"||e===qe.VIDEO?"avc1.42e01e":"mp4a.40.5"}let Bn;try{Bn=self.performance.now.bind(self.performance)}catch{G.debug("Unable to use Performance API on this environment"),Bn=typeof self<"u"&&self.Date.now}const Kc=[{demux:D2,remux:W2},{demux:li,remux:jc},{demux:A2,remux:jc},{demux:M2,remux:jc}];class n0{constructor(e,t,n,i,s){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=n,this.vendor=i,this.id=s}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,n,i){const s=n.transmuxing;s.executeStart=Bn();let a=new Uint8Array(e);const{currentTransmuxState:o,transmuxConfig:l}=this;i&&(this.currentTransmuxState=i);const{contiguous:u,discontinuity:c,trackSwitch:f,accurateTimeOffset:h,timeOffset:d,initSegmentChange:m}=i||o,{audioCodec:x,videoCodec:p,defaultInitPts:g,duration:v,initSegmentData:E}=l,S=j2(a,t);if(S&&S.method==="AES-128"){const C=this.getDecrypter();if(C.isSync()){let O=C.softwareDecrypt(a,S.key.buffer,S.iv.buffer);if(n.part>-1&&(O=C.flush()),!O)return s.executeEnd=Bn(),qc(n);a=new Uint8Array(O)}else return this.decryptionPromise=C.webCryptoDecrypt(a,S.key.buffer,S.iv.buffer).then(O=>{const L=this.push(O,null,n);return this.decryptionPromise=null,L}),this.decryptionPromise}const T=this.needsProbing(c,f);if(T){const C=this.configureTransmuxer(a);if(C)return G.warn(`[transmuxer] ${C.message}`),this.observer.emit(A.ERROR,A.ERROR,{type:be.MEDIA_ERROR,details:J.FRAG_PARSING_ERROR,fatal:!1,error:C,reason:C.message}),s.executeEnd=Bn(),qc(n)}(c||f||m||T)&&this.resetInitSegment(E,x,p,v,t),(c||m||T)&&this.resetInitialTimestamp(g),u||this.resetContiguity();const w=this.transmux(a,S,d,h,n),_=this.currentTransmuxState;return _.contiguous=!0,_.discontinuity=!1,_.trackSwitch=!1,s.executeEnd=Bn(),w}flush(e){const t=e.transmuxing;t.executeStart=Bn();const{decrypter:n,currentTransmuxState:i,decryptionPromise:s}=this;if(s)return s.then(()=>this.flush(e));const a=[],{timeOffset:o}=i;if(n){const f=n.flush();f&&a.push(this.push(f,null,e))}const{demuxer:l,remuxer:u}=this;if(!l||!u)return t.executeEnd=Bn(),[qc(e)];const c=l.flush(o);return Rl(c)?c.then(f=>(this.flushRemux(a,f,e),a)):(this.flushRemux(a,c,e),a)}flushRemux(e,t,n){const{audioTrack:i,videoTrack:s,id3Track:a,textTrack:o}=t,{accurateTimeOffset:l,timeOffset:u}=this.currentTransmuxState;G.log(`[transmuxer.ts]: Flushed fragment ${n.sn}${n.part>-1?" p: "+n.part:""} of level ${n.level}`);const c=this.remuxer.remux(i,s,a,o,u,l,!0,this.id);e.push({remuxResult:c,chunkMeta:n}),n.transmuxing.executeEnd=Bn()}resetInitialTimestamp(e){const{demuxer:t,remuxer:n}=this;!t||!n||(t.resetTimeStamp(e),n.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;!e||!t||(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,n,i,s){const{demuxer:a,remuxer:o}=this;!a||!o||(a.resetInitSegment(e,t,n,i),o.resetInitSegment(e,t,n,s))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,n,i,s){let a;return t&&t.method==="SAMPLE-AES"?a=this.transmuxSampleAes(e,t,n,i,s):a=this.transmuxUnencrypted(e,n,i,s),a}transmuxUnencrypted(e,t,n,i){const{audioTrack:s,videoTrack:a,id3Track:o,textTrack:l}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(s,a,o,l,t,n,!1,this.id),chunkMeta:i}}transmuxSampleAes(e,t,n,i,s){return this.demuxer.demuxSampleAes(e,t,n).then(a=>({remuxResult:this.remuxer.remux(a.audioTrack,a.videoTrack,a.id3Track,a.textTrack,n,i,!1,this.id),chunkMeta:s}))}configureTransmuxer(e){const{config:t,observer:n,typeSupported:i,vendor:s}=this;let a;for(let f=0,h=Kc.length;f<h;f++)if(Kc[f].demux.probe(e)){a=Kc[f];break}if(!a)return new Error("Failed to find demuxer by probing fragment data");const o=this.demuxer,l=this.remuxer,u=a.remux,c=a.demux;(!l||!(l instanceof u))&&(this.remuxer=new u(n,t,i,s)),(!o||!(o instanceof c))&&(this.demuxer=new c(n,t,i),this.probe=c.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new Pd(this.config)),e}}function j2(r,e){let t=null;return r.byteLength>0&&e!=null&&e.key!=null&&e.iv!==null&&e.method!=null&&(t=e),t}const qc=r=>({remuxResult:{},chunkMeta:r});function Rl(r){return"then"in r&&r.then instanceof Function}class K2{constructor(e,t,n,i,s){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=n,this.duration=i,this.defaultInitPts=s||null}}class q2{constructor(e,t,n,i,s,a){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=n,this.trackSwitch=i,this.timeOffset=s,this.initSegmentChange=a}}var EE={exports:{}};(function(r){var e=Object.prototype.hasOwnProperty,t="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(t=!1));function i(l,u,c){this.fn=l,this.context=u,this.once=c||!1}function s(l,u,c,f,h){if(typeof c!="function")throw new TypeError("The listener must be a function");var d=new i(c,f||l,h),m=t?t+u:u;return l._events[m]?l._events[m].fn?l._events[m]=[l._events[m],d]:l._events[m].push(d):(l._events[m]=d,l._eventsCount++),l}function a(l,u){--l._eventsCount===0?l._events=new n:delete l._events[u]}function o(){this._events=new n,this._eventsCount=0}o.prototype.eventNames=function(){var u=[],c,f;if(this._eventsCount===0)return u;for(f in c=this._events)e.call(c,f)&&u.push(t?f.slice(1):f);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(c)):u},o.prototype.listeners=function(u){var c=t?t+u:u,f=this._events[c];if(!f)return[];if(f.fn)return[f.fn];for(var h=0,d=f.length,m=new Array(d);h<d;h++)m[h]=f[h].fn;return m},o.prototype.listenerCount=function(u){var c=t?t+u:u,f=this._events[c];return f?f.fn?1:f.length:0},o.prototype.emit=function(u,c,f,h,d,m){var x=t?t+u:u;if(!this._events[x])return!1;var p=this._events[x],g=arguments.length,v,E;if(p.fn){switch(p.once&&this.removeListener(u,p.fn,void 0,!0),g){case 1:return p.fn.call(p.context),!0;case 2:return p.fn.call(p.context,c),!0;case 3:return p.fn.call(p.context,c,f),!0;case 4:return p.fn.call(p.context,c,f,h),!0;case 5:return p.fn.call(p.context,c,f,h,d),!0;case 6:return p.fn.call(p.context,c,f,h,d,m),!0}for(E=1,v=new Array(g-1);E<g;E++)v[E-1]=arguments[E];p.fn.apply(p.context,v)}else{var S=p.length,T;for(E=0;E<S;E++)switch(p[E].once&&this.removeListener(u,p[E].fn,void 0,!0),g){case 1:p[E].fn.call(p[E].context);break;case 2:p[E].fn.call(p[E].context,c);break;case 3:p[E].fn.call(p[E].context,c,f);break;case 4:p[E].fn.call(p[E].context,c,f,h);break;default:if(!v)for(T=1,v=new Array(g-1);T<g;T++)v[T-1]=arguments[T];p[E].fn.apply(p[E].context,v)}}return!0},o.prototype.on=function(u,c,f){return s(this,u,c,f,!1)},o.prototype.once=function(u,c,f){return s(this,u,c,f,!0)},o.prototype.removeListener=function(u,c,f,h){var d=t?t+u:u;if(!this._events[d])return this;if(!c)return a(this,d),this;var m=this._events[d];if(m.fn)m.fn===c&&(!h||m.once)&&(!f||m.context===f)&&a(this,d);else{for(var x=0,p=[],g=m.length;x<g;x++)(m[x].fn!==c||h&&!m[x].once||f&&m[x].context!==f)&&p.push(m[x]);p.length?this._events[d]=p.length===1?p[0]:p:a(this,d)}return this},o.prototype.removeAllListeners=function(u){var c;return u?(c=t?t+u:u,this._events[c]&&a(this,c)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=t,o.EventEmitter=o,r.exports=o})(EE);var Y2=EE.exports,$d=N1(Y2);const Yc=Iu()||{isTypeSupported:()=>!1};class xE{constructor(e,t,n,i){this.error=null,this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;const s=e.config;this.hls=e,this.id=t,this.useWorker=!!s.enableWorker,this.onTransmuxComplete=n,this.onFlush=i;const a=(u,c)=>{c=c||{},c.frag=this.frag,c.id=this.id,u===A.ERROR&&(this.error=c.error),this.hls.trigger(u,c)};this.observer=new $d,this.observer.on(A.FRAG_DECRYPTED,a),this.observer.on(A.ERROR,a);const o={mp4:Yc.isTypeSupported("video/mp4"),mpeg:Yc.isTypeSupported("audio/mpeg"),mp3:Yc.isTypeSupported('audio/mp4; codecs="mp3"')},l=navigator.vendor;if(this.useWorker&&typeof Worker<"u"&&(s.workerPath||m2())){try{s.workerPath?(G.log(`loading Web Worker ${s.workerPath} for "${t}"`),this.workerContext=y2(s.workerPath)):(G.log(`injecting Web Worker for "${t}"`),this.workerContext=v2()),this.onwmsg=f=>this.onWorkerMessage(f);const{worker:c}=this.workerContext;c.addEventListener("message",this.onwmsg),c.onerror=f=>{const h=new Error(`${f.message}  (${f.filename}:${f.lineno})`);s.enableWorker=!1,G.warn(`Error in "${t}" Web Worker, fallback to inline`),this.hls.trigger(A.ERROR,{type:be.OTHER_ERROR,details:J.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:h})},c.postMessage({cmd:"init",typeSupported:o,vendor:l,id:t,config:JSON.stringify(s)})}catch(c){G.warn(`Error setting up "${t}" Web Worker, fallback to inline`,c),this.resetWorker(),this.error=null,this.transmuxer=new n0(this.observer,o,s,l,t)}return}this.transmuxer=new n0(this.observer,o,s,l,t)}resetWorker(){if(this.workerContext){const{worker:e,objectURL:t}=this.workerContext;t&&self.URL.revokeObjectURL(t),e.removeEventListener("message",this.onwmsg),e.onerror=null,e.terminate(),this.workerContext=null}}destroy(){if(this.workerContext)this.resetWorker(),this.onwmsg=void 0;else{const t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null}push(e,t,n,i,s,a,o,l,u,c){var f,h;u.transmuxing.start=self.performance.now();const{transmuxer:d}=this,m=a?a.start:s.start,x=s.decryptdata,p=this.frag,g=!(p&&s.cc===p.cc),v=!(p&&u.level===p.level),E=p?u.sn-p.sn:-1,S=this.part?u.part-this.part.index:-1,T=E===0&&u.id>1&&u.id===(p==null?void 0:p.stats.chunkCount),w=!v&&(E===1||E===0&&(S===1||T&&S<=0)),_=self.performance.now();(v||E||s.stats.parsing.start===0)&&(s.stats.parsing.start=_),a&&(S||!w)&&(a.stats.parsing.start=_);const C=!(p&&((f=s.initSegment)==null?void 0:f.url)===((h=p.initSegment)==null?void 0:h.url)),O=new q2(g,w,l,v,m,C);if(!w||g||C){G.log(`[transmuxer-interface, ${s.type}]: Starting new transmux session for sn: ${u.sn} p: ${u.part} level: ${u.level} id: ${u.id}
        discontinuity: ${g}
        trackSwitch: ${v}
        contiguous: ${w}
        accurateTimeOffset: ${l}
        timeOffset: ${m}
        initSegmentChange: ${C}`);const L=new K2(n,i,t,o,c);this.configureTransmuxer(L)}if(this.frag=s,this.part=a,this.workerContext)this.workerContext.worker.postMessage({cmd:"demux",data:e,decryptdata:x,chunkMeta:u,state:O},e instanceof ArrayBuffer?[e]:[]);else if(d){const L=d.push(e,x,u,O);Rl(L)?(d.async=!0,L.then(V=>{this.handleTransmuxComplete(V)}).catch(V=>{this.transmuxerError(V,u,"transmuxer-interface push error")})):(d.async=!1,this.handleTransmuxComplete(L))}}flush(e){e.transmuxing.start=self.performance.now();const{transmuxer:t}=this;if(this.workerContext)this.workerContext.worker.postMessage({cmd:"flush",chunkMeta:e});else if(t){let n=t.flush(e);Rl(n)||t.async?(Rl(n)||(n=Promise.resolve(n)),n.then(s=>{this.handleFlushResult(s,e)}).catch(s=>{this.transmuxerError(s,e,"transmuxer-interface flush error")})):this.handleFlushResult(n,e)}}transmuxerError(e,t,n){!this.hls||(this.error=e,this.hls.trigger(A.ERROR,{type:be.MEDIA_ERROR,details:J.FRAG_PARSING_ERROR,chunkMeta:t,fatal:!1,error:e,err:e,reason:n}))}handleFlushResult(e,t){e.forEach(n=>{this.handleTransmuxComplete(n)}),this.onFlush(t)}onWorkerMessage(e){const t=e.data,n=this.hls;switch(t.event){case"init":{var i;const s=(i=this.workerContext)==null?void 0:i.objectURL;s&&self.URL.revokeObjectURL(s);break}case"transmuxComplete":{this.handleTransmuxComplete(t.data);break}case"flush":{this.onFlush(t.data);break}case"workerLog":G[t.data.logType]&&G[t.data.logType](t.data.message);break;default:{t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,n.trigger(t.event,t.data);break}}}configureTransmuxer(e){const{transmuxer:t}=this;this.workerContext?this.workerContext.worker.postMessage({cmd:"configure",config:e}):t&&t.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}const X2=250,Xc=2,Z2=.1,Q2=.05;class J2{constructor(e,t,n,i){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=e,this.media=t,this.fragmentTracker=n,this.hls=i}destroy(){this.media=null,this.hls=this.fragmentTracker=null}poll(e,t){const{config:n,media:i,stalled:s}=this;if(i===null)return;const{currentTime:a,seeking:o}=i,l=this.seeking&&!o,u=!this.seeking&&o;if(this.seeking=o,a!==e){if(this.moved=!0,s!==null){if(this.stallReported){const g=self.performance.now()-s;G.warn(`playback not stuck anymore @${a}, after ${Math.round(g)}ms`),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}return}if(u||l){this.stalled=null;return}if(i.paused&&!o||i.ended||i.playbackRate===0||!Je.getBuffered(i).length)return;const c=Je.bufferInfo(i,a,0),f=c.len>0,h=c.nextStart||0;if(!f&&!h)return;if(o){const g=c.len>Xc,v=!h||t&&t.start<=a||h-a>Xc&&!this.fragmentTracker.getPartialFragment(a);if(g||v)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var d;const g=Math.max(h,c.start||0)-a,v=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,S=(v==null||(d=v.details)==null?void 0:d.live)?v.details.targetduration*2:Xc,T=this.fragmentTracker.getPartialFragment(a);if(g>0&&(g<=S||T)){this._trySkipBufferHole(T);return}}const m=self.performance.now();if(s===null){this.stalled=m;return}const x=m-s;if(!o&&x>=X2&&(this._reportStall(c),!this.media))return;const p=Je.bufferInfo(i,a,n.maxBufferHole);this._tryFixBufferStall(p,x)}_tryFixBufferStall(e,t){const{config:n,fragmentTracker:i,media:s}=this;if(s===null)return;const a=s.currentTime,o=i.getPartialFragment(a);o&&(this._trySkipBufferHole(o)||!this.media)||(e.len>n.maxBufferHole||e.nextStart&&e.nextStart-a<n.maxBufferHole)&&t>n.highBufferWatchdogPeriod*1e3&&(G.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}_reportStall(e){const{hls:t,media:n,stallReported:i}=this;if(!i&&n){this.stallReported=!0;const s=new Error(`Playback stalling at @${n.currentTime} due to low buffer (${JSON.stringify(e)})`);G.warn(s.message),t.trigger(A.ERROR,{type:be.MEDIA_ERROR,details:J.BUFFER_STALLED_ERROR,fatal:!1,error:s,buffer:e.len})}}_trySkipBufferHole(e){const{config:t,hls:n,media:i}=this;if(i===null)return 0;const s=i.currentTime,a=Je.bufferInfo(i,s,0),o=s<a.start?a.start:a.nextStart;if(o){const l=a.len<=t.maxBufferHole,u=a.len>0&&a.len<1&&i.readyState<3,c=o-s;if(c>0&&(l||u)){if(c>t.maxBufferHole){const{fragmentTracker:h}=this;let d=!1;if(s===0){const m=h.getAppendedFrag(0,De.MAIN);m&&o<m.end&&(d=!0)}if(!d){const m=e||h.getAppendedFrag(s,De.MAIN);if(m){let x=!1,p=m.end;for(;p<o;){const g=h.getPartialFragment(p);if(g)p+=g.duration;else{x=!0;break}}if(x)return 0}}}const f=Math.max(o+Q2,s+Z2);if(G.warn(`skipping hole, adjusting currentTime from ${s} to ${f}`),this.moved=!0,this.stalled=null,i.currentTime=f,e&&!e.gap){const h=new Error(`fragment loaded with buffer holes, seeking from ${s} to ${f}`);n.trigger(A.ERROR,{type:be.MEDIA_ERROR,details:J.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:h,reason:h.message,frag:e})}return f}}return 0}_tryNudgeBuffer(){const{config:e,hls:t,media:n,nudgeRetry:i}=this;if(n===null)return;const s=n.currentTime;if(this.nudgeRetry++,i<e.nudgeMaxRetry){const a=s+(i+1)*e.nudgeOffset,o=new Error(`Nudging 'currentTime' from ${s} to ${a}`);G.warn(o.message),n.currentTime=a,t.trigger(A.ERROR,{type:be.MEDIA_ERROR,details:J.BUFFER_NUDGE_ON_STALL,error:o,fatal:!1})}else{const a=new Error(`Playhead still not moving while enough data buffered @${s} after ${e.nudgeMaxRetry} nudges`);G.error(a.message),t.trigger(A.ERROR,{type:be.MEDIA_ERROR,details:J.BUFFER_STALLED_ERROR,error:a,fatal:!0})}}}const e_=100;class t_ extends Fd{constructor(e,t,n){super(e,t,n,"[stream-controller]",De.MAIN),this.audioCodecSwap=!1,this.gapController=null,this.level=-1,this._forceStartLoad=!1,this.altAudio=!1,this.audioOnly=!1,this.fragPlaying=null,this.onvplaying=null,this.onvseeked=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(A.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(A.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(A.MANIFEST_LOADING,this.onManifestLoading,this),e.on(A.MANIFEST_PARSED,this.onManifestParsed,this),e.on(A.LEVEL_LOADING,this.onLevelLoading,this),e.on(A.LEVEL_LOADED,this.onLevelLoaded,this),e.on(A.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(A.ERROR,this.onError,this),e.on(A.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(A.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(A.BUFFER_CREATED,this.onBufferCreated,this),e.on(A.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(A.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(A.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(A.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(A.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(A.MANIFEST_LOADING,this.onManifestLoading,this),e.off(A.MANIFEST_PARSED,this.onManifestParsed,this),e.off(A.LEVEL_LOADED,this.onLevelLoaded,this),e.off(A.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(A.ERROR,this.onError,this),e.off(A.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(A.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(A.BUFFER_CREATED,this.onBufferCreated,this),e.off(A.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(A.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(A.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this._unregisterListeners(),this.onMediaDetaching()}startLoad(e){if(this.levels){const{lastCurrentTime:t,hls:n}=this;if(this.stopLoad(),this.setInterval(e_),this.level=-1,!this.startFragRequested){let i=n.startLevel;i===-1&&(n.config.testBandwidth&&this.levels.length>1?(i=0,this.bitrateTest=!0):i=n.nextAutoLevel),this.level=n.nextLoadLevel=i,this.loadedmetadata=!1}t>0&&e===-1&&(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t),this.state=se.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this._forceStartLoad=!0,this.state=se.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case se.WAITING_LEVEL:{var e;const{levels:n,level:i}=this,s=n==null||(e=n[i])==null?void 0:e.details;if(s&&(!s.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(s))break;this.state=se.IDLE;break}break}case se.FRAG_LOADING_WAITING_RETRY:{var t;const n=self.performance.now(),i=this.retryDate;(!i||n>=i||(t=this.media)!=null&&t.seeking)&&(this.resetStartWhenNotLoaded(this.level),this.state=se.IDLE)}break}this.state===se.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){super.onTickEnd(),this.checkBuffer(),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:n,media:i}=this,{config:s,nextLoadLevel:a}=e;if(t===null||!i&&(this.startFragRequested||!s.startFragPrefetch)||this.altAudio&&this.audioOnly||!(n!=null&&n[a]))return;const o=n[a],l=this.getMainFwdBufferInfo();if(l===null)return;const u=this.getLevelDetails();if(u&&this._streamEnded(l,u)){const p={};this.altAudio&&(p.type="video"),this.hls.trigger(A.BUFFER_EOS,p),this.state=se.ENDED;return}e.loadLevel!==a&&e.manualLevel===-1&&this.log(`Adapting to level ${a} from level ${this.level}`),this.level=e.nextLoadLevel=a;const c=o.details;if(!c||this.state===se.WAITING_LEVEL||c.live&&this.levelLastLoaded!==a){this.level=a,this.state=se.WAITING_LEVEL;return}const f=l.len,h=this.getMaxBufferLength(o.maxBitrate);if(f>=h)return;this.backtrackFragment&&this.backtrackFragment.start>l.end&&(this.backtrackFragment=null);const d=this.backtrackFragment?this.backtrackFragment.start:l.end;let m=this.getNextFragment(d,c);if(this.couldBacktrack&&!this.fragPrevious&&m&&m.sn!=="initSegment"&&this.fragmentTracker.getState(m)!==Ft.OK){var x;const g=((x=this.backtrackFragment)!=null?x:m).sn-c.startSN,v=c.fragments[g-1];v&&m.cc===v.cc&&(m=v,this.fragmentTracker.removeFragment(v))}else this.backtrackFragment&&l.len&&(this.backtrackFragment=null);if(m&&this.isLoopLoading(m,d)){if(!m.gap){const g=this.audioOnly&&!this.altAudio?qe.AUDIO:qe.VIDEO,v=(g===qe.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;v&&this.afterBufferFlushed(v,g,De.MAIN)}m=this.getNextFragmentLoopLoading(m,c,l,De.MAIN,h)}!m||(m.initSegment&&!m.initSegment.data&&!this.bitrateTest&&(m=m.initSegment),this.loadFragment(m,o,d))}loadFragment(e,t,n){const i=this.fragmentTracker.getState(e);this.fragCurrent=e,i===Ft.NOT_LOADED||i===Ft.PARTIAL?e.sn==="initSegment"?this._loadInitSegment(e,t):this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):(this.startFragRequested=!0,super.loadFragment(e,t,n)):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,De.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(t!=null&&t.readyState){let n;const i=this.getAppendedFrag(t.currentTime);i&&i.start>1&&this.flushMainBuffer(0,i.start-1);const s=this.getLevelDetails();if(s!=null&&s.live){const o=this.getMainFwdBufferInfo();if(!o||o.len<s.targetduration*2)return}if(!t.paused&&e){const o=this.hls.nextLoadLevel,l=e[o],u=this.fragLastKbps;u&&this.fragCurrent?n=this.fragCurrent.duration*l.maxBitrate/(1e3*u)+1:n=0}else n=0;const a=this.getBufferedFrag(t.currentTime+n);if(a){const o=this.followingBufferedFrag(a);if(o){this.abortCurrentFrag();const l=o.maxStartPTS?o.maxStartPTS:o.start,u=o.duration,c=Math.max(a.end,l+Math.min(Math.max(u-this.config.maxFragLookUpTolerance,u*.5),u*.75));this.flushMainBuffer(c,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case se.KEY_LOADING:case se.FRAG_LOADING:case se.FRAG_LOADING_WAITING_RETRY:case se.PARSING:case se.PARSED:this.state=se.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const n=t.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),n.addEventListener("playing",this.onvplaying),n.addEventListener("seeked",this.onvseeked),this.gapController=new J2(this.config,n,this.fragmentTracker,this.hls)}onMediaDetaching(){const{media:e}=this;e&&this.onvplaying&&this.onvseeked&&(e.removeEventListener("playing",this.onvplaying),e.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),super.onMediaDetaching()}onMediaPlaying(){this.tick()}onMediaSeeked(){const e=this.media,t=e?e.currentTime:null;_e(t)&&this.log(`Media seeked to ${t.toFixed(3)}`);const n=this.getMainFwdBufferInfo();if(n===null||n.len===0){this.warn(`Main forward buffer length on "seeked" event ${n?n.len:"empty"})`);return}this.tick()}onManifestLoading(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(A.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=0,this.levels=this.fragPlaying=this.backtrackFragment=null,this.altAudio=this.audioOnly=!1}onManifestParsed(e,t){let n=!1,i=!1,s;t.levels.forEach(a=>{s=a.audioCodec,s&&(s.indexOf("mp4a.40.2")!==-1&&(n=!0),s.indexOf("mp4a.40.5")!==-1&&(i=!0))}),this.audioCodecSwitch=n&&i&&!g2(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:n}=this;if(!n||this.state!==se.IDLE)return;const i=n[t.level];(!i.details||i.details.live&&this.levelLastLoaded!==t.level||this.waitForCdnTuneIn(i.details))&&(this.state=se.WAITING_LEVEL)}onLevelLoaded(e,t){var n;const{levels:i}=this,s=t.level,a=t.details,o=a.totalduration;if(!i){this.warn(`Levels were reset while loading level ${s}`);return}this.log(`Level ${s} loaded [${a.startSN},${a.endSN}]${a.lastPartSn?`[part-${a.lastPartSn}-${a.lastPartIndex}]`:""}, cc [${a.startCC}, ${a.endCC}] duration:${o}`);const l=i[s],u=this.fragCurrent;u&&(this.state===se.FRAG_LOADING||this.state===se.FRAG_LOADING_WAITING_RETRY)&&(u.level!==t.level||u.urlId!==l.urlId)&&u.loader&&this.abortCurrentFrag();let c=0;if(a.live||(n=l.details)!=null&&n.live){if(a.fragments[0]||(a.deltaUpdateFailed=!0),a.deltaUpdateFailed)return;c=this.alignPlaylists(a,l.details)}if(l.details=a,this.levelLastLoaded=s,this.hls.trigger(A.LEVEL_UPDATED,{details:a,level:s}),this.state===se.WAITING_LEVEL){if(this.waitForCdnTuneIn(a))return;this.state=se.IDLE}this.startFragRequested?a.live&&this.synchronizeToLiveEdge(a):this.setStartPosition(a,c),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:n,part:i,payload:s}=e,{levels:a}=this;if(!a){this.warn(`Levels were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);return}const o=a[n.level],l=o.details;if(!l){this.warn(`Dropping fragment ${n.sn} of level ${n.level} after level details were reset`),this.fragmentTracker.removeFragment(n);return}const u=o.videoCodec,c=l.PTSKnown||!l.live,f=(t=n.initSegment)==null?void 0:t.data,h=this._getAudioCodec(o),d=this.transmuxer=this.transmuxer||new xE(this.hls,De.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),m=i?i.index:-1,x=m!==-1,p=new Od(n.level,n.sn,n.stats.chunkCount,s.byteLength,m,x),g=this.initPTS[n.cc];d.push(s,f,h,u,n,i,l.totalduration,c,p,g)}onAudioTrackSwitching(e,t){const n=this.altAudio;if(!!!t.url){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const a=this.fragCurrent;a&&(this.log("Switching to main audio track, cancel main fragment load"),a.abortRequests(),this.fragmentTracker.removeFragment(a)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();const s=this.hls;n&&(s.trigger(A.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null}),this.fragmentTracker.removeAllFragments()),s.trigger(A.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const n=t.id,i=!!this.hls.audioTracks[n].url;if(i){const s=this.videoBuffer;s&&this.mediaBuffer!==s&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=s)}this.altAudio=i,this.tick()}onBufferCreated(e,t){const n=t.tracks;let i,s,a=!1;for(const o in n){const l=n[o];if(l.id==="main"){if(s=o,i=l,o==="video"){const u=n[o];u&&(this.videoBuffer=u.buffer)}}else a=!0}a&&i?(this.log(`Alternate track found, use ${s}.buffered to schedule main fragment loading`),this.mediaBuffer=i.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:n,part:i}=t;if(n&&n.type!==De.MAIN)return;if(this.fragContextChanged(n)){this.warn(`Fragment ${n.sn}${i?" p: "+i.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}`),this.state===se.PARSED&&(this.state=se.IDLE);return}const s=i?i.stats:n.stats;this.fragLastKbps=Math.round(8*s.total/(s.buffering.end-s.loading.first)),n.sn!=="initSegment"&&(this.fragPrevious=n),this.fragBufferedComplete(n,i)}onError(e,t){var n;if(t.fatal){this.state=se.ERROR;return}switch(t.details){case J.FRAG_GAP:case J.FRAG_PARSING_ERROR:case J.FRAG_DECRYPT_ERROR:case J.FRAG_LOAD_ERROR:case J.FRAG_LOAD_TIMEOUT:case J.KEY_LOAD_ERROR:case J.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(De.MAIN,t);break;case J.LEVEL_LOAD_ERROR:case J.LEVEL_LOAD_TIMEOUT:case J.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===se.WAITING_LEVEL&&((n=t.context)==null?void 0:n.type)===ze.LEVEL&&(this.state=se.IDLE);break;case J.BUFFER_FULL_ERROR:if(!t.parent||t.parent!=="main")return;this.reduceLengthAndFlushBuffer(t)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case J.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}checkBuffer(){const{media:e,gapController:t}=this;if(!(!e||!t||!e.readyState)){if(this.loadedmetadata||!Je.getBuffered(e).length){const n=this.state!==se.IDLE?this.fragCurrent:null;t.poll(this.lastCurrentTime,n)}this.lastCurrentTime=e.currentTime}}onFragLoadEmergencyAborted(){this.state=se.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==qe.AUDIO||this.audioOnly&&!this.altAudio){const n=(t===qe.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(n,t,De.MAIN)}}onLevelsUpdated(e,t){this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let n=this.startPosition;if(n>=0&&t<n){if(e.seeking){this.log(`could not seek to ${n}, already seeking at ${t}`);return}const i=Je.getBuffered(e),a=(i.length?i.start(0):0)-n;a>0&&(a<this.config.maxBufferHole||a<this.config.maxFragLookUpTolerance)&&(this.log(`adjusting start position by ${a} to match buffer start`),n+=a,this.startPosition=n),this.log(`seek to target start position ${n} from current time ${t}`),e.currentTime=n}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t.indexOf("mp4a.40.5")!==-1?t="mp4a.40.2":t="mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(n=>{const{hls:i}=this;if(!n||this.fragContextChanged(e))return;t.fragmentError=0,this.state=se.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const s=e.stats;s.parsing.start=s.parsing.end=s.buffering.start=s.buffering.end=self.performance.now(),i.trigger(A.FRAG_LOADED,n),e.bitrateTest=!1})}_handleTransmuxComplete(e){var t;const n="main",{hls:i}=this,{remuxResult:s,chunkMeta:a}=e,o=this.getCurrentContext(a);if(!o){this.resetWhenMissingContext(a);return}const{frag:l,part:u,level:c}=o,{video:f,text:h,id3:d,initSegment:m}=s,{details:x}=c,p=this.altAudio?void 0:s.audio;if(this.fragContextChanged(l)){this.fragmentTracker.removeFragment(l);return}if(this.state=se.PARSING,m){if(m!=null&&m.tracks){const E=l.initSegment||l;this._bufferInitSegment(c,m.tracks,E,a),i.trigger(A.FRAG_PARSING_INIT_SEGMENT,{frag:E,id:n,tracks:m.tracks})}const g=m.initPTS,v=m.timescale;_e(g)&&(this.initPTS[l.cc]={baseTime:g,timescale:v},i.trigger(A.INIT_PTS_FOUND,{frag:l,id:n,initPTS:g,timescale:v}))}if(f&&s.independent!==!1){if(x){const{startPTS:g,endPTS:v,startDTS:E,endDTS:S}=f;if(u)u.elementaryStreams[f.type]={startPTS:g,endPTS:v,startDTS:E,endDTS:S};else if(f.firstKeyFrame&&f.independent&&a.id===1&&(this.couldBacktrack=!0),f.dropped&&f.independent){const T=this.getMainFwdBufferInfo(),w=(T?T.end:this.getLoadPosition())+this.config.maxBufferHole,_=f.firstKeyFramePTS?f.firstKeyFramePTS:g;if(w<_-this.config.maxBufferHole){this.backtrack(l);return}l.setElementaryStreamInfo(f.type,l.start,v,l.start,S,!0)}l.setElementaryStreamInfo(f.type,g,v,E,S),this.backtrackFragment&&(this.backtrackFragment=l),this.bufferFragmentData(f,l,u,a)}}else if(s.independent===!1){this.backtrack(l);return}if(p){const{startPTS:g,endPTS:v,startDTS:E,endDTS:S}=p;u&&(u.elementaryStreams[qe.AUDIO]={startPTS:g,endPTS:v,startDTS:E,endDTS:S}),l.setElementaryStreamInfo(qe.AUDIO,g,v,E,S),this.bufferFragmentData(p,l,u,a)}if(x&&d!=null&&(t=d.samples)!=null&&t.length){const g={id:n,frag:l,details:x,samples:d.samples};i.trigger(A.FRAG_PARSING_METADATA,g)}if(x&&h){const g={id:n,frag:l,details:x,samples:h.samples};i.trigger(A.FRAG_PARSING_USERDATA,g)}}_bufferInitSegment(e,t,n,i){if(this.state!==se.PARSING)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&delete t.audio;const{audio:s,video:a,audiovideo:o}=t;if(s){let l=e.audioCodec;const u=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(l&&(l.indexOf("mp4a.40.5")!==-1?l="mp4a.40.2":l="mp4a.40.5"),s.metadata.channelCount!==1&&u.indexOf("firefox")===-1&&(l="mp4a.40.5")),u.indexOf("android")!==-1&&s.container!=="audio/mpeg"&&(l="mp4a.40.2",this.log(`Android: force audio codec to ${l}`)),e.audioCodec&&e.audioCodec!==l&&this.log(`Swapping manifest audio codec "${e.audioCodec}" for "${l}"`),s.levelCodec=l,s.id="main",this.log(`Init audio buffer, container:${s.container}, codecs[selected/level/parsed]=[${l||""}/${e.audioCodec||""}/${s.codec}]`)}a&&(a.levelCodec=e.videoCodec,a.id="main",this.log(`Init video buffer, container:${a.container}, codecs[level/parsed]=[${e.videoCodec||""}/${a.codec}]`)),o&&this.log(`Init audiovideo buffer, container:${o.container}, codecs[level/parsed]=[${e.attrs.CODECS||""}/${o.codec}]`),this.hls.trigger(A.BUFFER_CODECS,t),Object.keys(t).forEach(l=>{const c=t[l].initSegment;c!=null&&c.byteLength&&this.hls.trigger(A.BUFFER_APPENDING,{type:l,data:c,frag:n,part:null,chunkMeta:i,parent:n.type})}),this.tick()}getMainFwdBufferInfo(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,De.MAIN)}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=se.IDLE}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&e.seeking===!1){const n=e.currentTime;if(Je.isBuffered(e,n)?t=this.getAppendedFrag(n):Je.isBuffered(e,n+.1)&&(t=this.getAppendedFrag(n+.1)),t){this.backtrackFragment=null;const i=this.fragPlaying,s=t.level;(!i||t.sn!==i.sn||i.level!==s||t.urlId!==i.urlId)&&(this.fragPlaying=t,this.hls.trigger(A.FRAG_CHANGED,{frag:t}),(!i||i.level!==s)&&this.hls.trigger(A.LEVEL_SWITCHED,{level:s}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){const e=this.media;return e?this.fragPlaying||this.getAppendedFrag(e.currentTime):null}get currentProgramDateTime(){const e=this.media;if(e){const t=e.currentTime,n=this.currentFrag;if(n&&_e(t)&&_e(n.programDateTime)){const i=n.programDateTime+(t-n.start)*1e3;return new Date(i)}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class hs{constructor(e,t=0,n=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=n}sample(e,t){const n=Math.pow(this.alpha_,e);this.estimate_=t*(1-n)+n*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class r_{constructor(e,t,n,i=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new hs(e),this.fast_=new hs(t),this.defaultTTFB_=i,this.ttfb_=new hs(e)}update(e,t){const{slow_:n,fast_:i,ttfb_:s}=this;n.halfLife!==e&&(this.slow_=new hs(e,n.getEstimate(),n.getTotalWeight())),i.halfLife!==t&&(this.fast_=new hs(t,i.getEstimate(),i.getTotalWeight())),s.halfLife!==e&&(this.ttfb_=new hs(e,s.getEstimate(),s.getTotalWeight()))}sample(e,t){e=Math.max(e,this.minDelayMs_);const n=8*t,i=e/1e3,s=n/i;this.fast_.sample(i,s),this.slow_.sample(i,s)}sampleTTFB(e){const t=e/1e3,n=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(n,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}destroy(){}}class n_{constructor(e){this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=-1,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=e;const t=e.config;this.bwEstimator=new r_(t.abrEwmaSlowVoD,t.abrEwmaFastVoD,t.abrEwmaDefaultEstimate),this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(A.FRAG_LOADING,this.onFragLoading,this),e.on(A.FRAG_LOADED,this.onFragLoaded,this),e.on(A.FRAG_BUFFERED,this.onFragBuffered,this),e.on(A.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(A.LEVEL_LOADED,this.onLevelLoaded,this)}unregisterListeners(){const{hls:e}=this;e.off(A.FRAG_LOADING,this.onFragLoading,this),e.off(A.FRAG_LOADED,this.onFragLoaded,this),e.off(A.FRAG_BUFFERED,this.onFragBuffered,this),e.off(A.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(A.LEVEL_LOADED,this.onLevelLoaded,this)}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null}onFragLoading(e,t){var n;const i=t.frag;this.ignoreFragment(i)||(this.fragCurrent=i,this.partCurrent=(n=t.part)!=null?n:null,this.clearTimer(),this.timer=self.setInterval(this.onCheck,100))}onLevelSwitching(e,t){this.clearTimer()}getTimeToLoadFrag(e,t,n,i){const s=e+n/t,a=i?this.lastLevelLoadSec:0;return s+a}onLevelLoaded(e,t){const n=this.hls.config,{total:i,bwEstimate:s}=t.stats;_e(i)&&_e(s)&&(this.lastLevelLoadSec=8*i/s),t.details.live?this.bwEstimator.update(n.abrEwmaSlowLive,n.abrEwmaFastLive):this.bwEstimator.update(n.abrEwmaSlowVoD,n.abrEwmaFastVoD)}_abandonRulesCheck(){const{fragCurrent:e,partCurrent:t,hls:n}=this,{autoLevelEnabled:i,media:s}=n;if(!e||!s)return;const a=performance.now(),o=t?t.stats:e.stats,l=t?t.duration:e.duration,u=a-o.loading.start;if(o.aborted||o.loaded&&o.loaded===o.total||e.level===0){this.clearTimer(),this._nextAutoLevel=-1;return}if(!i||s.paused||!s.playbackRate||!s.readyState)return;const c=n.mainForwardBufferInfo;if(c===null)return;const f=this.bwEstimator.getEstimateTTFB(),h=Math.abs(s.playbackRate);if(u<=Math.max(f,1e3*(l/(h*2))))return;const d=c.len/h;if(d>=2*l/h)return;const m=o.loading.first?o.loading.first-o.loading.start:-1,x=o.loaded&&m>-1,p=this.bwEstimator.getEstimate(),{levels:g,minAutoLevel:v}=n,E=g[e.level],S=o.total||Math.max(o.loaded,Math.round(l*E.maxBitrate/8));let T=u-m;T<1&&x&&(T=Math.min(u,o.loaded*8/p));const w=x?o.loaded*1e3/T:0,_=w?(S-o.loaded)/w:S*8/p+f/1e3;if(_<=d)return;const C=w?w*8:p;let O=Number.POSITIVE_INFINITY,L;for(L=e.level-1;L>v;L--){const V=g[L].maxBitrate;if(O=this.getTimeToLoadFrag(f/1e3,C,l*V,!g[L].details),O<d)break}O>=_||O>l*10||(n.nextLoadLevel=L,x?this.bwEstimator.sample(u-Math.min(f,m),o.loaded):this.bwEstimator.sampleTTFB(u),this.clearTimer(),G.warn(`[abr] Fragment ${e.sn}${t?" part "+t.index:""} of level ${e.level} is loading too slowly;
      Time to underbuffer: ${d.toFixed(3)} s
      Estimated load time for current fragment: ${_.toFixed(3)} s
      Estimated load time for down switch fragment: ${O.toFixed(3)} s
      TTFB estimate: ${m}
      Current BW estimate: ${_e(p)?(p/1024).toFixed(3):"Unknown"} Kb/s
      New BW estimate: ${(this.bwEstimator.getEstimate()/1024).toFixed(3)} Kb/s
      Aborting and switching to level ${L}`),e.loader&&(this.fragCurrent=this.partCurrent=null,e.abortRequests()),n.trigger(A.FRAG_LOAD_EMERGENCY_ABORTED,{frag:e,part:t,stats:o}))}onFragLoaded(e,{frag:t,part:n}){const i=n?n.stats:t.stats;if(t.type===De.MAIN&&this.bwEstimator.sampleTTFB(i.loading.first-i.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),this.lastLoadedFragLevel=t.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){const s=n?n.duration:t.duration,a=this.hls.levels[t.level],o=(a.loaded?a.loaded.bytes:0)+i.loaded,l=(a.loaded?a.loaded.duration:0)+s;a.loaded={bytes:o,duration:l},a.realBitrate=Math.round(8*o/l)}if(t.bitrateTest){const s={stats:i,frag:t,part:n,id:t.type};this.onFragBuffered(A.FRAG_BUFFERED,s),t.bitrateTest=!1}}}onFragBuffered(e,t){const{frag:n,part:i}=t,s=i!=null&&i.stats.loaded?i.stats:n.stats;if(s.aborted||this.ignoreFragment(n))return;const a=s.parsing.end-s.loading.start-Math.min(s.loading.first-s.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(a,s.loaded),s.bwEstimate=this.bwEstimator.getEstimate(),n.bitrateTest?this.bitrateTestDelay=a/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==De.MAIN||e.sn==="initSegment"}clearTimer(){self.clearInterval(this.timer)}get nextAutoLevel(){const e=this._nextAutoLevel,t=this.bwEstimator;if(e!==-1&&!t.canEstimate())return e;let n=this.getNextABRAutoLevel();if(e!==-1){const i=this.hls.levels;if(i.length>Math.max(e,n)&&i[e].loadError<=i[n].loadError)return e}return e!==-1&&(n=Math.min(e,n)),n}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:n}=this,{maxAutoLevel:i,config:s,minAutoLevel:a,media:o}=n,l=t?t.duration:e?e.duration:0,u=o&&o.playbackRate!==0?Math.abs(o.playbackRate):1,c=this.bwEstimator?this.bwEstimator.getEstimate():s.abrEwmaDefaultEstimate,f=n.mainForwardBufferInfo,h=(f?f.len:0)/u;let d=this.findBestLevel(c,a,i,h,s.abrBandWidthFactor,s.abrBandWidthUpFactor);if(d>=0)return d;G.trace(`[abr] ${h?"rebuffering expected":"buffer is empty"}, finding optimal quality level`);let m=l?Math.min(l,s.maxStarvationDelay):s.maxStarvationDelay,x=s.abrBandWidthFactor,p=s.abrBandWidthUpFactor;if(!h){const g=this.bitrateTestDelay;g&&(m=(l?Math.min(l,s.maxLoadingDelay):s.maxLoadingDelay)-g,G.trace(`[abr] bitrate test took ${Math.round(1e3*g)}ms, set first fragment max fetchDuration to ${Math.round(1e3*m)} ms`),x=p=1)}return d=this.findBestLevel(c,a,i,h+m,x,p),Math.max(d,0)}findBestLevel(e,t,n,i,s,a){var o;const{fragCurrent:l,partCurrent:u,lastLoadedFragLevel:c}=this,{levels:f}=this.hls,h=f[c],d=!!(h!=null&&(o=h.details)!=null&&o.live),m=h==null?void 0:h.codecSet,x=u?u.duration:l?l.duration:0,p=this.bwEstimator.getEstimateTTFB()/1e3;let g=t,v=-1;for(let E=n;E>=t;E--){const S=f[E];if(!S||m&&S.codecSet!==m){S&&(g=Math.min(E,g),v=Math.max(E,v));continue}v!==-1&&G.trace(`[abr] Skipped level(s) ${g}-${v} with CODECS:"${f[v].attrs.CODECS}"; not compatible with "${h.attrs.CODECS}"`);const T=S.details,w=(u?T==null?void 0:T.partTarget:T==null?void 0:T.averagetargetduration)||x;let _;E<=c?_=s*e:_=a*e;const C=f[E].maxBitrate,O=this.getTimeToLoadFrag(p,_,C*w,T===void 0);if(G.trace(`[abr] level:${E} adjustedbw-bitrate:${Math.round(_-C)} avgDuration:${w.toFixed(1)} maxFetchDuration:${i.toFixed(1)} fetchDuration:${O.toFixed(1)}`),_>C&&(O===0||!_e(O)||d&&!this.bitrateTestDelay||O<i))return E}return-1}set nextAutoLevel(e){this._nextAutoLevel=e}}class TE{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let n;if(e.length)e.length===1?n=e[0]:n=i_(e,t);else return new Uint8Array(0);return this.reset(),n}reset(){this.chunks.length=0,this.dataLength=0}}function i_(r,e){const t=new Uint8Array(e);let n=0;for(let i=0;i<r.length;i++){const s=r[i];t.set(s,n),n+=s.length}return t}const i0=100;class s_ extends Fd{constructor(e,t,n){super(e,t,n,"[audio-stream-controller]",De.AUDIO),this.videoBuffer=null,this.videoTrackCC=-1,this.waitingVideoCC=-1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),this.mainDetails=null,this.bufferedTrack=null,this.switchingTrack=null}_registerListeners(){const{hls:e}=this;e.on(A.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(A.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(A.MANIFEST_LOADING,this.onManifestLoading,this),e.on(A.LEVEL_LOADED,this.onLevelLoaded,this),e.on(A.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(A.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(A.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(A.ERROR,this.onError,this),e.on(A.BUFFER_RESET,this.onBufferReset,this),e.on(A.BUFFER_CREATED,this.onBufferCreated,this),e.on(A.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(A.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(A.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(A.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(A.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(A.MANIFEST_LOADING,this.onManifestLoading,this),e.off(A.LEVEL_LOADED,this.onLevelLoaded,this),e.off(A.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(A.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(A.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(A.ERROR,this.onError,this),e.off(A.BUFFER_RESET,this.onBufferReset,this),e.off(A.BUFFER_CREATED,this.onBufferCreated,this),e.off(A.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(A.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(A.FRAG_BUFFERED,this.onFragBuffered,this)}onInitPtsFound(e,{frag:t,id:n,initPTS:i,timescale:s}){if(n==="main"){const a=t.cc;this.initPTS[t.cc]={baseTime:i,timescale:s},this.log(`InitPTS for cc: ${a} found from main: ${i}`),this.videoTrackCC=a,this.state===se.WAITING_INIT_PTS&&this.tick()}}startLoad(e){if(!this.levels){this.startPosition=e,this.state=se.STOPPED;return}const t=this.lastCurrentTime;this.stopLoad(),this.setInterval(i0),t>0&&e===-1?(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t,this.state=se.IDLE):(this.loadedmetadata=!1,this.state=se.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}doTick(){switch(this.state){case se.IDLE:this.doTickIdle();break;case se.WAITING_TRACK:{var e;const{levels:n,trackId:i}=this,s=n==null||(e=n[i])==null?void 0:e.details;if(s){if(this.waitForCdnTuneIn(s))break;this.state=se.WAITING_INIT_PTS}break}case se.FRAG_LOADING_WAITING_RETRY:{var t;const n=performance.now(),i=this.retryDate;(!i||n>=i||(t=this.media)!=null&&t.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.trackId),this.state=se.IDLE);break}case se.WAITING_INIT_PTS:{const n=this.waitingData;if(n){const{frag:i,part:s,cache:a,complete:o}=n;if(this.initPTS[i.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=se.FRAG_LOADING;const l=a.flush(),u={frag:i,part:s,payload:l,networkDetails:null};this._handleFragmentLoadProgress(u),o&&super._handleFragmentLoadComplete(u)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log(`Waiting fragment cc (${i.cc}) cancelled because video is at cc ${this.videoTrackCC}`),this.clearWaitingFragment();else{const l=this.getLoadPosition(),u=Je.bufferInfo(this.mediaBuffer,l,this.config.maxBufferHole);Th(u.end,this.config.maxFragLookUpTolerance,i)<0&&(this.log(`Waiting fragment cc (${i.cc}) @ ${i.start} cancelled because another fragment at ${u.end} is needed`),this.clearWaitingFragment())}}else this.state=se.IDLE}}this.onTickEnd()}clearWaitingFragment(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=se.IDLE)}resetLoadingState(){this.clearWaitingFragment(),super.resetLoadingState()}onTickEnd(){const{media:e}=this;!(e!=null&&e.readyState)||(this.lastCurrentTime=e.currentTime)}doTickIdle(){const{hls:e,levels:t,media:n,trackId:i}=this,s=e.config;if(!(t!=null&&t[i])||!n&&(this.startFragRequested||!s.startFragPrefetch))return;const a=t[i],o=a.details;if(!o||o.live&&this.levelLastLoaded!==i||this.waitForCdnTuneIn(o)){this.state=se.WAITING_TRACK;return}const l=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&l&&(this.bufferFlushed=!1,this.afterBufferFlushed(l,qe.AUDIO,De.AUDIO));const u=this.getFwdBufferInfo(l,De.AUDIO);if(u===null)return;const{bufferedTrack:c,switchingTrack:f}=this;if(!f&&this._streamEnded(u,o)){e.trigger(A.BUFFER_EOS,{type:"audio"}),this.state=se.ENDED;return}const h=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,De.MAIN),d=u.len,m=this.getMaxBufferLength(h==null?void 0:h.len);if(d>=m&&!f)return;const p=o.fragments[0].start;let g=u.end;if(f&&n){const T=this.getLoadPosition();c&&f.attrs!==c.attrs&&(g=T),o.PTSKnown&&T<p&&(u.end>p||u.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),n.currentTime=p+.05)}let v=this.getNextFragment(g,o),E=!1;if(v&&this.isLoopLoading(v,g)&&(E=!!v.gap,v=this.getNextFragmentLoopLoading(v,o,u,De.MAIN,m)),!v){this.bufferFlushed=!0;return}const S=h&&v.start>h.end+o.targetduration;if(S||!(h!=null&&h.len)&&u.len){const T=this.getAppendedFrag(v.start,De.MAIN);if(T===null||(E||(E=!!T.gap||!!S&&h.len===0),S&&!E||E&&u.nextStart&&u.nextStart<T.end))return}this.loadFragment(v,a,g)}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.min(Math.max(t,e),this.config.maxMaxBufferLength):t}onMediaDetaching(){this.videoBuffer=null,super.onMediaDetaching()}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(n=>new lo(n))}onAudioTrackSwitching(e,t){const n=!!t.url;this.trackId=t.id;const{fragCurrent:i}=this;i&&(i.abortRequests(),this.removeUnbufferedFrags(i.start)),this.resetLoadingState(),n?this.setInterval(i0):this.resetTransmuxer(),n?(this.switchingTrack=t,this.state=se.IDLE):(this.switchingTrack=null,this.bufferedTrack=t,this.state=se.STOPPED),this.tick()}onManifestLoading(){this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1,this.levels=this.mainDetails=this.waitingData=this.bufferedTrack=this.cachedTrackLoadedData=this.switchingTrack=null,this.startFragRequested=!1,this.trackId=this.videoTrackCC=this.waitingVideoCC=-1}onLevelLoaded(e,t){this.mainDetails=t.details,this.cachedTrackLoadedData!==null&&(this.hls.trigger(A.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)}onAudioTrackLoaded(e,t){var n;if(this.mainDetails==null){this.cachedTrackLoadedData=t;return}const{levels:i}=this,{details:s,id:a}=t;if(!i){this.warn(`Audio tracks were reset while loading level ${a}`);return}this.log(`Track ${a} loaded [${s.startSN},${s.endSN}]${s.lastPartSn?`[part-${s.lastPartSn}-${s.lastPartIndex}]`:""},duration:${s.totalduration}`);const o=i[a];let l=0;if(s.live||(n=o.details)!=null&&n.live){const u=this.mainDetails;if(s.fragments[0]||(s.deltaUpdateFailed=!0),s.deltaUpdateFailed||!u)return;!o.details&&s.hasProgramDateTime&&u.hasProgramDateTime?(sE(s,u),l=s.fragments[0].start):l=this.alignPlaylists(s,o.details)}o.details=s,this.levelLastLoaded=a,!this.startFragRequested&&(this.mainDetails||!s.live)&&this.setStartPosition(o.details,l),this.state===se.WAITING_TRACK&&!this.waitForCdnTuneIn(s)&&(this.state=se.IDLE),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:n,part:i,payload:s}=e,{config:a,trackId:o,levels:l}=this;if(!l){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);return}const u=l[o];if(!u){this.warn("Audio track is undefined on fragment load progress");return}const c=u.details;if(!c){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(n.start);return}const f=a.defaultAudioCodec||u.audioCodec||"mp4a.40.2";let h=this.transmuxer;h||(h=this.transmuxer=new xE(this.hls,De.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const d=this.initPTS[n.cc],m=(t=n.initSegment)==null?void 0:t.data;if(d!==void 0){const p=i?i.index:-1,g=p!==-1,v=new Od(n.level,n.sn,n.stats.chunkCount,s.byteLength,p,g);h.push(s,m,f,"",n,i,c.totalduration,!1,v,d)}else{this.log(`Unknown video PTS for cc ${n.cc}, waiting for video PTS before demuxing audio frag ${n.sn} of [${c.startSN} ,${c.endSN}],track ${o}`);const{cache:x}=this.waitingData=this.waitingData||{frag:n,part:i,cache:new TE,complete:!1};x.push(new Uint8Array(s)),this.waitingVideoCC=this.videoTrackCC,this.state=se.WAITING_INIT_PTS}}_handleFragmentLoadComplete(e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1}onBufferCreated(e,t){const n=t.tracks.audio;n&&(this.mediaBuffer=n.buffer||null),t.tracks.video&&(this.videoBuffer=t.tracks.video.buffer||null)}onFragBuffered(e,t){const{frag:n,part:i}=t;if(n.type!==De.AUDIO){if(!this.loadedmetadata&&n.type===De.MAIN){const s=this.videoBuffer||this.media;s&&Je.getBuffered(s).length&&(this.loadedmetadata=!0)}return}if(this.fragContextChanged(n)){this.warn(`Fragment ${n.sn}${i?" p: "+i.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(n.sn!=="initSegment"){this.fragPrevious=n;const s=this.switchingTrack;s&&(this.bufferedTrack=s,this.switchingTrack=null,this.hls.trigger(A.AUDIO_TRACK_SWITCHED,vr({},s)))}this.fragBufferedComplete(n,i)}onError(e,t){var n;if(t.fatal){this.state=se.ERROR;return}switch(t.details){case J.FRAG_GAP:case J.FRAG_PARSING_ERROR:case J.FRAG_DECRYPT_ERROR:case J.FRAG_LOAD_ERROR:case J.FRAG_LOAD_TIMEOUT:case J.KEY_LOAD_ERROR:case J.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(De.AUDIO,t);break;case J.AUDIO_TRACK_LOAD_ERROR:case J.AUDIO_TRACK_LOAD_TIMEOUT:case J.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===se.WAITING_TRACK&&((n=t.context)==null?void 0:n.type)===ze.AUDIO_TRACK&&(this.state=se.IDLE);break;case J.BUFFER_FULL_ERROR:if(!t.parent||t.parent!=="audio")return;this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case J.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onBufferFlushed(e,{type:t}){t===qe.AUDIO&&(this.bufferFlushed=!0,this.state===se.ENDED&&(this.state=se.IDLE))}_handleTransmuxComplete(e){var t;const n="audio",{hls:i}=this,{remuxResult:s,chunkMeta:a}=e,o=this.getCurrentContext(a);if(!o){this.resetWhenMissingContext(a);return}const{frag:l,part:u,level:c}=o,{details:f}=c,{audio:h,text:d,id3:m,initSegment:x}=s;if(this.fragContextChanged(l)||!f){this.fragmentTracker.removeFragment(l);return}if(this.state=se.PARSING,this.switchingTrack&&h&&this.completeAudioSwitch(this.switchingTrack),x!=null&&x.tracks){const p=l.initSegment||l;this._bufferInitSegment(x.tracks,p,a),i.trigger(A.FRAG_PARSING_INIT_SEGMENT,{frag:p,id:n,tracks:x.tracks})}if(h){const{startPTS:p,endPTS:g,startDTS:v,endDTS:E}=h;u&&(u.elementaryStreams[qe.AUDIO]={startPTS:p,endPTS:g,startDTS:v,endDTS:E}),l.setElementaryStreamInfo(qe.AUDIO,p,g,v,E),this.bufferFragmentData(h,l,u,a)}if(m!=null&&(t=m.samples)!=null&&t.length){const p=At({id:n,frag:l,details:f},m);i.trigger(A.FRAG_PARSING_METADATA,p)}if(d){const p=At({id:n,frag:l,details:f},d);i.trigger(A.FRAG_PARSING_USERDATA,p)}}_bufferInitSegment(e,t,n){if(this.state!==se.PARSING)return;e.video&&delete e.video;const i=e.audio;if(!i)return;i.levelCodec=i.codec,i.id="audio",this.log(`Init audio buffer, container:${i.container}, codecs[parsed]=[${i.codec}]`),this.hls.trigger(A.BUFFER_CODECS,e);const s=i.initSegment;if(s!=null&&s.byteLength){const a={type:"audio",frag:t,part:null,chunkMeta:n,parent:t.type,data:s};this.hls.trigger(A.BUFFER_APPENDING,a)}this.tick()}loadFragment(e,t,n){const i=this.fragmentTracker.getState(e);if(this.fragCurrent=e,this.switchingTrack||i===Ft.NOT_LOADED||i===Ft.PARTIAL){var s;e.sn==="initSegment"?this._loadInitSegment(e,t):(s=t.details)!=null&&s.live&&!this.initPTS[e.cc]?(this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=se.WAITING_INIT_PTS):(this.startFragRequested=!0,super.loadFragment(e,t,n))}else this.clearTrackerIfNeeded(e)}completeAudioSwitch(e){const{hls:t,media:n,bufferedTrack:i}=this,s=i==null?void 0:i.attrs,a=e.attrs;n&&s&&(s.CHANNELS!==a.CHANNELS||s.NAME!==a.NAME||s.LANGUAGE!==a.LANGUAGE)&&(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio")),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(A.AUDIO_TRACK_SWITCHED,vr({},e))}}class a_ extends kd{constructor(e){super(e,"[audio-track-controller]"),this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(A.MANIFEST_LOADING,this.onManifestLoading,this),e.on(A.MANIFEST_PARSED,this.onManifestParsed,this),e.on(A.LEVEL_LOADING,this.onLevelLoading,this),e.on(A.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(A.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(A.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(A.MANIFEST_LOADING,this.onManifestLoading,this),e.off(A.MANIFEST_PARSED,this.onManifestParsed,this),e.off(A.LEVEL_LOADING,this.onLevelLoading,this),e.off(A.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(A.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(A.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:n,groupId:i,details:s}=t,a=this.tracksInGroup[n];if(!a||a.groupId!==i){this.warn(`Track with id:${n} and group:${i} not found in active group ${a.groupId}`);return}const o=a.details;a.details=t.details,this.log(`audio-track ${n} "${a.name}" lang:${a.lang} group:${i} loaded [${s.startSN}-${s.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,o)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!(t!=null&&t.audioGroupIds))return;const n=t.audioGroupIds[t.urlId];if(this.groupId!==n){this.groupId=n||null;const i=this.tracks.filter(a=>!n||a.groupId===n);this.selectDefaultTrack&&!i.some(a=>a.default)&&(this.selectDefaultTrack=!1),this.tracksInGroup=i;const s={audioTracks:i};this.log(`Updating audio tracks, ${i.length} track(s) found in group:${n}`),this.hls.trigger(A.AUDIO_TRACKS_UPDATED,s),this.selectInitialTrack()}else this.shouldReloadPlaylist(this.currentTrack)&&this.setAudioTrack(this.trackId)}onError(e,t){t.fatal||!t.context||t.context.type===ze.AUDIO_TRACK&&t.context.id===this.trackId&&t.context.groupId===this.groupId&&(this.requestScheduled=-1,this.checkRetry(t))}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length){this.warn("Invalid id passed to audio-track controller");return}this.clearTimer();const n=this.currentTrack;t[this.trackId];const i=t[e],{groupId:s,name:a}=i;if(this.log(`Switching to audio-track ${e} "${a}" lang:${i.lang} group:${s}`),this.trackId=e,this.currentTrack=i,this.selectDefaultTrack=!1,this.hls.trigger(A.AUDIO_TRACK_SWITCHING,vr({},i)),i.details&&!i.details.live)return;const o=this.switchParams(i.url,n==null?void 0:n.details);this.loadPlaylist(o)}selectInitialTrack(){const e=this.tracksInGroup,t=this.findTrackId(this.currentTrack)|this.findTrackId(null);if(t!==-1)this.setAudioTrack(t);else{const n=new Error(`No track found for running audio group-ID: ${this.groupId} track count: ${e.length}`);this.warn(n.message),this.hls.trigger(A.ERROR,{type:be.MEDIA_ERROR,details:J.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:n})}}findTrackId(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const i=t[n];if((!this.selectDefaultTrack||i.default)&&(!e||e.attrs["STABLE-RENDITION-ID"]!==void 0&&e.attrs["STABLE-RENDITION-ID"]===i.attrs["STABLE-RENDITION-ID"]||e.name===i.name&&e.lang===i.lang))return i.id}return-1}loadPlaylist(e){super.loadPlaylist();const t=this.tracksInGroup[this.trackId];if(this.shouldLoadPlaylist(t)){const n=t.id,i=t.groupId;let s=t.url;if(e)try{s=e.addDirectives(s)}catch(a){this.warn(`Could not construct new URL with HLS Delivery Directives: ${a}`)}this.log(`loading audio-track playlist ${n} "${t.name}" lang:${t.lang} group:${i}`),this.clearTimer(),this.hls.trigger(A.AUDIO_TRACK_LOADING,{url:s,id:n,groupId:i,deliveryDirectives:e||null})}}}function SE(r,e){if(r.length!==e.length)return!1;for(let t=0;t<r.length;t++)if(!o_(r[t].attrs,e[t].attrs))return!1;return!0}function o_(r,e){const t=r["STABLE-RENDITION-ID"];return t?t===e["STABLE-RENDITION-ID"]:!["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED"].some(n=>r[n]!==e[n])}const s0=500;class l_ extends Fd{constructor(e,t,n){super(e,t,n,"[subtitle-stream-controller]",De.SUBTITLE),this.levels=[],this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),this.mainDetails=null}_registerListeners(){const{hls:e}=this;e.on(A.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(A.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(A.MANIFEST_LOADING,this.onManifestLoading,this),e.on(A.LEVEL_LOADED,this.onLevelLoaded,this),e.on(A.ERROR,this.onError,this),e.on(A.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(A.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(A.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(A.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(A.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(A.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(A.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(A.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(A.MANIFEST_LOADING,this.onManifestLoading,this),e.off(A.LEVEL_LOADED,this.onLevelLoaded,this),e.off(A.ERROR,this.onError,this),e.off(A.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(A.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(A.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(A.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(A.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(A.FRAG_BUFFERED,this.onFragBuffered,this)}startLoad(e){this.stopLoad(),this.state=se.IDLE,this.setInterval(s0),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}onManifestLoading(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()}onMediaDetaching(){this.tracksBuffered=[],super.onMediaDetaching()}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:n,success:i}=t;if(this.fragPrevious=n,this.state=se.IDLE,!i)return;const s=this.tracksBuffered[this.currentTrackId];if(!s)return;let a;const o=n.start;for(let u=0;u<s.length;u++)if(o>=s[u].start&&o<=s[u].end){a=s[u];break}const l=n.start+n.duration;a?a.end=l:(a={start:o,end:l},s.push(a)),this.fragmentTracker.fragBuffered(n)}onBufferFlushing(e,t){const{startOffset:n,endOffset:i}=t;if(n===0&&i!==Number.POSITIVE_INFINITY){const{currentTrackId:s,levels:a}=this;if(!a.length||!a[s]||!a[s].details)return;const l=a[s].details.targetduration,u=i-l;if(u<=0)return;t.endOffsetSubtitles=Math.max(0,u),this.tracksBuffered.forEach(c=>{for(let f=0;f<c.length;){if(c[f].end<=u){c.shift();continue}else if(c[f].start<u)c[f].start=u;else break;f++}}),this.fragmentTracker.removeFragmentsInRange(n,u,De.SUBTITLE)}}onFragBuffered(e,t){if(!this.loadedmetadata&&t.frag.type===De.MAIN){var n;(n=this.media)!=null&&n.buffered.length&&(this.loadedmetadata=!0)}}onError(e,t){const n=t.frag;(n==null?void 0:n.type)===De.SUBTITLE&&(this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==se.STOPPED&&(this.state=se.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){if(SE(this.levels,t)){this.levels=t.map(n=>new lo(n));return}this.tracksBuffered=[],this.levels=t.map(n=>{const i=new lo(n);return this.tracksBuffered[i.id]=[],i}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,De.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(e,t){if(this.currentTrackId=t.id,!this.levels.length||this.currentTrackId===-1){this.clearInterval();return}const n=this.levels[this.currentTrackId];n!=null&&n.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,n&&this.setInterval(s0)}onSubtitleTrackLoaded(e,t){var n;const{details:i,id:s}=t,{currentTrackId:a,levels:o}=this;if(!o.length)return;const l=o[a];if(s>=o.length||s!==a||!l)return;this.mediaBuffer=this.mediaBufferTimeRanges;let u=0;if(i.live||(n=l.details)!=null&&n.live){const c=this.mainDetails;if(i.deltaUpdateFailed||!c)return;const f=c.fragments[0];l.details?(u=this.alignPlaylists(i,l.details),u===0&&f&&(u=f.start,xh(i,u))):i.hasProgramDateTime&&c.hasProgramDateTime?(sE(i,c),u=i.fragments[0].start):f&&(u=f.start,xh(i,u))}l.details=i,this.levelLastLoaded=s,!this.startFragRequested&&(this.mainDetails||!i.live)&&this.setStartPosition(l.details,u),this.tick(),i.live&&!this.fragCurrent&&this.media&&this.state===se.IDLE&&(uo(null,i.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),l.details=void 0))}_handleFragmentLoadComplete(e){const{frag:t,payload:n}=e,i=t.decryptdata,s=this.hls;if(!this.fragContextChanged(t)&&n&&n.byteLength>0&&i&&i.key&&i.iv&&i.method==="AES-128"){const a=performance.now();this.decrypter.decrypt(new Uint8Array(n),i.key.buffer,i.iv.buffer).catch(o=>{throw s.trigger(A.ERROR,{type:be.MEDIA_ERROR,details:J.FRAG_DECRYPT_ERROR,fatal:!1,error:o,reason:o.message,frag:t}),o}).then(o=>{const l=performance.now();s.trigger(A.FRAG_DECRYPTED,{frag:t,payload:o,stats:{tstart:a,tdecrypt:l}})}).catch(o=>{this.warn(`${o.name}: ${o.message}`),this.state=se.IDLE})}}doTick(){if(!this.media){this.state=se.IDLE;return}if(this.state===se.IDLE){const{currentTrackId:e,levels:t}=this,n=t[e];if(!t.length||!n||!n.details)return;const i=n.details,s=i.targetduration,{config:a}=this,o=this.getLoadPosition(),l=Je.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],o-s,a.maxBufferHole),{end:u,len:c}=l,f=this.getFwdBufferInfo(this.media,De.MAIN),h=this.getMaxBufferLength(f==null?void 0:f.len)+s;if(c>h)return;const d=i.fragments,m=d.length,x=i.edge;let p=null;const g=this.fragPrevious;if(u<x){const{maxFragLookUpTolerance:v}=a;p=uo(g,d,Math.max(d[0].start,u),v),!p&&g&&g.start<d[0].start&&(p=d[0])}else p=d[m-1];if(!p)return;p=this.mapToInitFragWhenRequired(p),this.fragmentTracker.getState(p)===Ft.NOT_LOADED&&this.loadFragment(p,n,u)}}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.max(t,e):t}loadFragment(e,t,n){this.fragCurrent=e,e.sn==="initSegment"?this._loadInitSegment(e,t):(this.startFragRequested=!0,super.loadFragment(e,t,n))}get mediaBufferTimeRanges(){return new u_(this.tracksBuffered[this.currentTrackId]||[])}}class u_{constructor(e){this.buffered=void 0;const t=(n,i,s)=>{if(i=i>>>0,i>s-1)throw new DOMException(`Failed to execute '${n}' on 'TimeRanges': The index provided (${i}) is greater than the maximum bound (${s})`);return e[i][n]};this.buffered={get length(){return e.length},end(n){return t("end",n,e.length)},start(n){return t("start",n,e.length)}}}}class c_ extends kd{constructor(e){super(e,"[subtitle-track-controller]"),this.media=null,this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.trackChangeListener=()=>this.onTextTracksChanged(),this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes(this.trackId)}registerListeners(){const{hls:e}=this;e.on(A.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(A.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(A.MANIFEST_LOADING,this.onManifestLoading,this),e.on(A.MANIFEST_PARSED,this.onManifestParsed,this),e.on(A.LEVEL_LOADING,this.onLevelLoading,this),e.on(A.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(A.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(A.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(A.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(A.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(A.MANIFEST_LOADING,this.onManifestLoading,this),e.off(A.MANIFEST_PARSED,this.onManifestParsed,this),e.off(A.LEVEL_LOADING,this.onLevelLoading,this),e.off(A.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(A.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(A.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,e)}onMediaDetaching(){if(!this.media)return;self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),Zc(this.media.textTracks).forEach(t=>{Ps(t)}),this.subtitleTrack=-1,this.media=null}onManifestLoading(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:n,details:i}=t,{trackId:s}=this,a=this.tracksInGroup[s];if(!a){this.warn(`Invalid subtitle track id ${n}`);return}const o=a.details;a.details=t.details,this.log(`subtitle track ${n} loaded [${i.startSN}-${i.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,o)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!(t!=null&&t.textGroupIds))return;const n=t.textGroupIds[t.urlId],i=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;if(this.groupId!==n){const s=this.tracks.filter(l=>!n||l.groupId===n);this.tracksInGroup=s;const a=this.findTrackId(i==null?void 0:i.name)||this.findTrackId();this.groupId=n||null;const o={subtitleTracks:s};this.log(`Updating subtitle tracks, ${s.length} track(s) found in "${n}" group-id`),this.hls.trigger(A.SUBTITLE_TRACKS_UPDATED,o),a!==-1&&this.setSubtitleTrack(a,i)}else this.shouldReloadPlaylist(i)&&this.setSubtitleTrack(this.trackId,i)}findTrackId(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const i=t[n];if((!this.selectDefaultTrack||i.default)&&(!e||e===i.name))return i.id}return-1}onError(e,t){t.fatal||!t.context||t.context.type===ze.SUBTITLE_TRACK&&t.context.id===this.trackId&&t.context.groupId===this.groupId&&this.checkRetry(t)}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1;const t=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.setSubtitleTrack(e,t)}loadPlaylist(e){super.loadPlaylist();const t=this.tracksInGroup[this.trackId];if(this.shouldLoadPlaylist(t)){const n=t.id,i=t.groupId;let s=t.url;if(e)try{s=e.addDirectives(s)}catch(a){this.warn(`Could not construct new URL with HLS Delivery Directives: ${a}`)}this.log(`Loading subtitle playlist for id ${n}`),this.hls.trigger(A.SUBTITLE_TRACK_LOADING,{url:s,id:n,groupId:i,deliveryDirectives:e||null})}}toggleTrackModes(e){const{media:t,trackId:n}=this;if(!t)return;const i=Zc(t.textTracks),s=i.filter(o=>o.groupId===this.groupId);if(e===-1)[].slice.call(i).forEach(o=>{o.mode="disabled"});else{const o=s[n];o&&(o.mode="disabled")}const a=s[e];a&&(a.mode=this.subtitleDisplay?"showing":"hidden")}setSubtitleTrack(e,t){var n;const i=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(this.trackId!==e&&this.toggleTrackModes(e),this.trackId===e&&(e===-1||(n=i[e])!=null&&n.details)||e<-1||e>=i.length)return;this.clearTimer();const s=i[e];if(this.log(`Switching to subtitle-track ${e}`+(s?` "${s.name}" lang:${s.lang} group:${s.groupId}`:"")),this.trackId=e,s){const{id:a,groupId:o="",name:l,type:u,url:c}=s;this.hls.trigger(A.SUBTITLE_TRACK_SWITCH,{id:a,groupId:o,name:l,type:u,url:c});const f=this.switchParams(s.url,t==null?void 0:t.details);this.loadPlaylist(f)}else this.hls.trigger(A.SUBTITLE_TRACK_SWITCH,{id:e})}onTextTracksChanged(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let e=-1;const t=Zc(this.media.textTracks);for(let n=0;n<t.length;n++)if(t[n].mode==="hidden")e=n;else if(t[n].mode==="showing"){e=n;break}this.subtitleTrack!==e&&(this.subtitleTrack=e)}}function Zc(r){const e=[];for(let t=0;t<r.length;t++){const n=r[t];(n.kind==="subtitles"||n.kind==="captions")&&n.label&&e.push(r[t])}return e}class f_{constructor(e){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=e}append(e,t){const n=this.queues[t];n.push(e),n.length===1&&this.buffers[t]&&this.executeNext(t)}insertAbort(e,t){this.queues[t].unshift(e),this.executeNext(t)}appendBlocker(e){let t;const n=new Promise(s=>{t=s}),i={execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};return this.append(i,e),n}executeNext(e){const{buffers:t,queues:n}=this,i=t[e],s=n[e];if(s.length){const a=s[0];try{a.execute()}catch(o){G.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),a.onError(o),i!=null&&i.updating||(s.shift(),this.executeNext(e))}}}shiftAndExecuteNext(e){this.queues[e].shift(),this.executeNext(e)}current(e){return this.queues[e][0]}}const a0=Iu(),o0=/([ha]vc.)(?:\.[^.,]+)+/;class h_{constructor(e){this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=()=>{const{media:t,mediaSource:n}=this;G.log("[buffer-controller]: Media source opened"),t&&(t.removeEventListener("emptied",this._onMediaEmptied),this.updateMediaElementDuration(),this.hls.trigger(A.MEDIA_ATTACHED,{media:t})),n&&n.removeEventListener("sourceopen",this._onMediaSourceOpen),this.checkPendingTracks()},this._onMediaSourceClose=()=>{G.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=()=>{G.log("[buffer-controller]: Media source ended")},this._onMediaEmptied=()=>{const{media:t,_objectUrl:n}=this;t&&t.src!==n&&G.error(`Media element src was set while attaching MediaSource (${n} > ${t.src})`)},this.hls=e,this._initSourceBuffer(),this.registerListeners()}hasSourceTypes(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null}registerListeners(){const{hls:e}=this;e.on(A.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(A.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(A.MANIFEST_LOADING,this.onManifestLoading,this),e.on(A.MANIFEST_PARSED,this.onManifestParsed,this),e.on(A.BUFFER_RESET,this.onBufferReset,this),e.on(A.BUFFER_APPENDING,this.onBufferAppending,this),e.on(A.BUFFER_CODECS,this.onBufferCodecs,this),e.on(A.BUFFER_EOS,this.onBufferEos,this),e.on(A.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(A.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(A.FRAG_PARSED,this.onFragParsed,this),e.on(A.FRAG_CHANGED,this.onFragChanged,this)}unregisterListeners(){const{hls:e}=this;e.off(A.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(A.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(A.MANIFEST_LOADING,this.onManifestLoading,this),e.off(A.MANIFEST_PARSED,this.onManifestParsed,this),e.off(A.BUFFER_RESET,this.onBufferReset,this),e.off(A.BUFFER_APPENDING,this.onBufferAppending,this),e.off(A.BUFFER_CODECS,this.onBufferCodecs,this),e.off(A.BUFFER_EOS,this.onBufferEos,this),e.off(A.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(A.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(A.FRAG_PARSED,this.onFragParsed,this),e.off(A.FRAG_CHANGED,this.onFragChanged,this)}_initSourceBuffer(){this.sourceBuffer={},this.operationQueue=new f_(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.lastMpegAudioChunk=null}onManifestLoading(){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){let n=2;(t.audio&&!t.video||!t.altAudio)&&(n=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=n,G.log(`${this.bufferCodecEventsExpected} bufferCodec event(s) expected`)}onMediaAttaching(e,t){const n=this.media=t.media;if(n&&a0){const i=this.mediaSource=new a0;i.addEventListener("sourceopen",this._onMediaSourceOpen),i.addEventListener("sourceended",this._onMediaSourceEnded),i.addEventListener("sourceclose",this._onMediaSourceClose),n.src=self.URL.createObjectURL(i),this._objectUrl=n.src,n.addEventListener("emptied",this._onMediaEmptied)}}onMediaDetaching(){const{media:e,mediaSource:t,_objectUrl:n}=this;if(t){if(G.log("[buffer-controller]: media source detaching"),t.readyState==="open")try{t.endOfStream()}catch(i){G.warn(`[buffer-controller]: onMediaDetaching: ${i.message} while calling endOfStream`)}this.onBufferReset(),t.removeEventListener("sourceopen",this._onMediaSourceOpen),t.removeEventListener("sourceended",this._onMediaSourceEnded),t.removeEventListener("sourceclose",this._onMediaSourceClose),e&&(e.removeEventListener("emptied",this._onMediaEmptied),n&&self.URL.revokeObjectURL(n),e.src===n?(e.removeAttribute("src"),e.load()):G.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(A.MEDIA_DETACHED,void 0)}onBufferReset(){this.getSourceBufferTypes().forEach(e=>{const t=this.sourceBuffer[e];try{t&&(this.removeBufferListeners(e),this.mediaSource&&this.mediaSource.removeSourceBuffer(t),this.sourceBuffer[e]=void 0)}catch(n){G.warn(`[buffer-controller]: Failed to reset the ${e} buffer`,n)}}),this._initSourceBuffer()}onBufferCodecs(e,t){const n=this.getSourceBufferTypes().length;Object.keys(t).forEach(i=>{if(n){const s=this.tracks[i];if(s&&typeof s.buffer.changeType=="function"){const{id:a,codec:o,levelCodec:l,container:u,metadata:c}=t[i],f=(s.levelCodec||s.codec).replace(o0,"$1"),h=(l||o).replace(o0,"$1");if(f!==h){const d=`${u};codecs=${l||o}`;this.appendChangeType(i,d),G.log(`[buffer-controller]: switching codec ${f} to ${h}`),this.tracks[i]={buffer:s.buffer,codec:o,container:u,levelCodec:l,metadata:c,id:a}}}}else this.pendingTracks[i]=t[i]}),!n&&(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks())}appendChangeType(e,t){const{operationQueue:n}=this,i={execute:()=>{const s=this.sourceBuffer[e];s&&(G.log(`[buffer-controller]: changing ${e} sourceBuffer type to ${t}`),s.changeType(t)),n.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:s=>{G.warn(`[buffer-controller]: Failed to change ${e} SourceBuffer type`,s)}};n.append(i,e)}onBufferAppending(e,t){const{hls:n,operationQueue:i,tracks:s}=this,{data:a,type:o,frag:l,part:u,chunkMeta:c}=t,f=c.buffering[o],h=self.performance.now();f.start=h;const d=l.stats.buffering,m=u?u.stats.buffering:null;d.start===0&&(d.start=h),m&&m.start===0&&(m.start=h);const x=s.audio;let p=!1;o==="audio"&&(x==null?void 0:x.container)==="audio/mpeg"&&(p=!this.lastMpegAudioChunk||c.id===1||this.lastMpegAudioChunk.sn!==c.sn,this.lastMpegAudioChunk=c);const g=l.start,v={execute:()=>{if(f.executeStart=self.performance.now(),p){const E=this.sourceBuffer[o];if(E){const S=g-E.timestampOffset;Math.abs(S)>=.1&&(G.log(`[buffer-controller]: Updating audio SourceBuffer timestampOffset to ${g} (delta: ${S}) sn: ${l.sn})`),E.timestampOffset=g)}}this.appendExecutor(a,o)},onStart:()=>{},onComplete:()=>{const E=self.performance.now();f.executeEnd=f.end=E,d.first===0&&(d.first=E),m&&m.first===0&&(m.first=E);const{sourceBuffer:S}=this,T={};for(const w in S)T[w]=Je.getBuffered(S[w]);this.appendError=0,this.hls.trigger(A.BUFFER_APPENDED,{type:o,frag:l,part:u,chunkMeta:c,parent:l.type,timeRanges:T})},onError:E=>{G.error(`[buffer-controller]: Error encountered while trying to append to the ${o} SourceBuffer`,E);const S={type:be.MEDIA_ERROR,parent:l.type,details:J.BUFFER_APPEND_ERROR,frag:l,part:u,chunkMeta:c,error:E,err:E,fatal:!1};E.code===DOMException.QUOTA_EXCEEDED_ERR?S.details=J.BUFFER_FULL_ERROR:(this.appendError++,S.details=J.BUFFER_APPEND_ERROR,this.appendError>n.config.appendErrorMaxRetry&&(G.error(`[buffer-controller]: Failed ${n.config.appendErrorMaxRetry} times to append segment in sourceBuffer`),S.fatal=!0)),n.trigger(A.ERROR,S)}};i.append(v,o)}onBufferFlushing(e,t){const{operationQueue:n}=this,i=s=>({execute:this.removeExecutor.bind(this,s,t.startOffset,t.endOffset),onStart:()=>{},onComplete:()=>{this.hls.trigger(A.BUFFER_FLUSHED,{type:s})},onError:a=>{G.warn(`[buffer-controller]: Failed to remove from ${s} SourceBuffer`,a)}});t.type?n.append(i(t.type),t.type):this.getSourceBufferTypes().forEach(s=>{n.append(i(s),s)})}onFragParsed(e,t){const{frag:n,part:i}=t,s=[],a=i?i.elementaryStreams:n.elementaryStreams;a[qe.AUDIOVIDEO]?s.push("audiovideo"):(a[qe.AUDIO]&&s.push("audio"),a[qe.VIDEO]&&s.push("video"));const o=()=>{const l=self.performance.now();n.stats.buffering.end=l,i&&(i.stats.buffering.end=l);const u=i?i.stats:n.stats;this.hls.trigger(A.FRAG_BUFFERED,{frag:n,part:i,stats:u,id:n.type})};s.length===0&&G.warn(`Fragments must have at least one ElementaryStreamType set. type: ${n.type} level: ${n.level} sn: ${n.sn}`),this.blockBuffers(o,s)}onFragChanged(e,t){this.flushBackBuffer()}onBufferEos(e,t){this.getSourceBufferTypes().reduce((i,s)=>{const a=this.sourceBuffer[s];return a&&(!t.type||t.type===s)&&(a.ending=!0,a.ended||(a.ended=!0,G.log(`[buffer-controller]: ${s} sourceBuffer now EOS`))),i&&!!(!a||a.ended)},!0)&&(G.log("[buffer-controller]: Queueing mediaSource.endOfStream()"),this.blockBuffers(()=>{this.getSourceBufferTypes().forEach(s=>{const a=this.sourceBuffer[s];a&&(a.ending=!1)});const{mediaSource:i}=this;if(!i||i.readyState!=="open"){i&&G.info(`[buffer-controller]: Could not call mediaSource.endOfStream(). mediaSource.readyState: ${i.readyState}`);return}G.log("[buffer-controller]: Calling mediaSource.endOfStream()"),i.endOfStream()}))}onLevelUpdated(e,{details:t}){!t.fragments.length||(this.details=t,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())}flushBackBuffer(){const{hls:e,details:t,media:n,sourceBuffer:i}=this;if(!n||t===null)return;const s=this.getSourceBufferTypes();if(!s.length)return;const a=t.live&&e.config.liveBackBufferLength!==null?e.config.liveBackBufferLength:e.config.backBufferLength;if(!_e(a)||a<0)return;const o=n.currentTime,l=t.levelTargetDuration,u=Math.max(a,l),c=Math.floor(o/l)*l-u;s.forEach(f=>{const h=i[f];if(h){const d=Je.getBuffered(h);if(d.length>0&&c>d.start(0)){if(e.trigger(A.BACK_BUFFER_REACHED,{bufferEnd:c}),t.live)e.trigger(A.LIVE_BACK_BUFFER_REACHED,{bufferEnd:c});else if(h.ended&&d.end(d.length-1)-o<l*2){G.info(`[buffer-controller]: Cannot flush ${f} back buffer while SourceBuffer is in ended state`);return}e.trigger(A.BUFFER_FLUSHING,{startOffset:0,endOffset:c,type:f})}}})}updateMediaElementDuration(){if(!this.details||!this.media||!this.mediaSource||this.mediaSource.readyState!=="open")return;const{details:e,hls:t,media:n,mediaSource:i}=this,s=e.fragments[0].start+e.totalduration,a=n.duration,o=_e(i.duration)?i.duration:0;e.live&&t.config.liveDurationInfinity?(G.log("[buffer-controller]: Media Source duration is set to Infinity"),i.duration=1/0,this.updateSeekableRange(e)):(s>o&&s>a||!_e(a))&&(G.log(`[buffer-controller]: Updating Media Source duration to ${s.toFixed(3)}`),i.duration=s)}updateSeekableRange(e){const t=this.mediaSource,n=e.fragments;if(n.length&&e.live&&t!=null&&t.setLiveSeekableRange){const s=Math.max(0,n[0].start),a=Math.max(s,s+e.totalduration);t.setLiveSeekableRange(s,a)}}checkPendingTracks(){const{bufferCodecEventsExpected:e,operationQueue:t,pendingTracks:n}=this,i=Object.keys(n).length;if(i&&!e||i===2){this.createSourceBuffers(n),this.pendingTracks={};const s=this.getSourceBufferTypes();if(s.length)this.hls.trigger(A.BUFFER_CREATED,{tracks:this.tracks}),s.forEach(a=>{t.executeNext(a)});else{const a=new Error("could not create source buffer for media codec(s)");this.hls.trigger(A.ERROR,{type:be.MEDIA_ERROR,details:J.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:a,reason:a.message})}}}createSourceBuffers(e){const{sourceBuffer:t,mediaSource:n}=this;if(!n)throw Error("createSourceBuffers called when mediaSource was null");for(const i in e)if(!t[i]){const s=e[i];if(!s)throw Error(`source buffer exists for track ${i}, however track does not`);const a=s.levelCodec||s.codec,o=`${s.container};codecs=${a}`;G.log(`[buffer-controller]: creating sourceBuffer(${o})`);try{const l=t[i]=n.addSourceBuffer(o),u=i;this.addBufferListener(u,"updatestart",this._onSBUpdateStart),this.addBufferListener(u,"updateend",this._onSBUpdateEnd),this.addBufferListener(u,"error",this._onSBUpdateError),this.tracks[i]={buffer:l,codec:a,container:s.container,levelCodec:s.levelCodec,metadata:s.metadata,id:s.id}}catch(l){G.error(`[buffer-controller]: error while trying to add sourceBuffer: ${l.message}`),this.hls.trigger(A.ERROR,{type:be.MEDIA_ERROR,details:J.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:l,mimeType:o})}}}_onSBUpdateStart(e){const{operationQueue:t}=this;t.current(e).onStart()}_onSBUpdateEnd(e){const{operationQueue:t}=this;t.current(e).onComplete(),t.shiftAndExecuteNext(e)}_onSBUpdateError(e,t){const n=new Error(`${e} SourceBuffer error`);G.error(`[buffer-controller]: ${n}`,t),this.hls.trigger(A.ERROR,{type:be.MEDIA_ERROR,details:J.BUFFER_APPENDING_ERROR,error:n,fatal:!1});const i=this.operationQueue.current(e);i&&i.onError(t)}removeExecutor(e,t,n){const{media:i,mediaSource:s,operationQueue:a,sourceBuffer:o}=this,l=o[e];if(!i||!s||!l){G.warn(`[buffer-controller]: Attempting to remove from the ${e} SourceBuffer, but it does not exist`),a.shiftAndExecuteNext(e);return}const u=_e(i.duration)?i.duration:1/0,c=_e(s.duration)?s.duration:1/0,f=Math.max(0,t),h=Math.min(n,u,c);h>f&&!l.ending?(l.ended=!1,G.log(`[buffer-controller]: Removing [${f},${h}] from the ${e} SourceBuffer`),l.remove(f,h)):a.shiftAndExecuteNext(e)}appendExecutor(e,t){const{operationQueue:n,sourceBuffer:i}=this,s=i[t];if(!s){G.warn(`[buffer-controller]: Attempting to append to the ${t} SourceBuffer, but it does not exist`),n.shiftAndExecuteNext(t);return}s.ended=!1,s.appendBuffer(e)}blockBuffers(e,t=this.getSourceBufferTypes()){if(!t.length){G.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);return}const{operationQueue:n}=this,i=t.map(s=>n.appendBlocker(s));Promise.all(i).then(()=>{e(),t.forEach(s=>{const a=this.sourceBuffer[s];a!=null&&a.updating||n.shiftAndExecuteNext(s)})})}getSourceBufferTypes(){return Object.keys(this.sourceBuffer)}addBufferListener(e,t,n){const i=this.sourceBuffer[e];if(!i)return;const s=n.bind(this,e);this.listeners[e].push({event:t,listener:s}),i.addEventListener(t,s)}removeBufferListeners(e){const t=this.sourceBuffer[e];!t||this.listeners[e].forEach(n=>{t.removeEventListener(n.event,n.listener)})}}const l0={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},wE=function(e){let t=e;return l0.hasOwnProperty(e)&&(t=l0[e]),String.fromCharCode(t)},nn=15,On=100,d_={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},p_={17:2,18:4,21:6,22:8,23:10,19:13,20:15},g_={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},m_={25:2,26:4,29:6,30:8,31:10,27:13,28:15},v_=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class y_{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const n=typeof t=="function"?t():t;G.log(`${this.time} [${e}] ${n}`)}}}const Li=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].toString(16));return t};class _E{constructor(e,t,n,i,s){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=e||"white",this.underline=t||!1,this.italics=n||!1,this.background=i||"black",this.flash=s||!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let n=0;n<t.length;n++){const i=t[n];e.hasOwnProperty(i)&&(this[i]=e[i])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class E_{constructor(e,t,n,i,s,a){this.uchar=void 0,this.penState=void 0,this.uchar=e||" ",this.penState=new _E(t,n,i,s,a)}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class x_{constructor(e){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(let t=0;t<On;t++)this.chars.push(new E_);this.logger=e,this.pos=0,this.currPenState=new _E}equals(e){let t=!0;for(let n=0;n<On;n++)if(!this.chars[n].equals(e.chars[n])){t=!1;break}return t}copy(e){for(let t=0;t<On;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<On;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>On&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=On)}moveCursor(e){const t=this.pos+e;if(e>1)for(let n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=wE(e);if(this.pos>=On){this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)}clearFromPos(e){let t;for(t=e;t<On;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let n=0;n<On;n++){const i=this.chars[n].uchar;i!==" "&&(t=!1),e.push(i)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class Qc{constructor(e){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(let t=0;t<nn;t++)this.rows.push(new x_(e));this.logger=e,this.currRow=nn-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}reset(){for(let e=0;e<nn;e++)this.rows[e].clear();this.currRow=nn-1}equals(e){let t=!0;for(let n=0;n<nn;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t}copy(e){for(let t=0;t<nn;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<nn;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+JSON.stringify(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let o=0;o<nn;o++)this.rows[o].clear();const s=this.currRow+1-this.nrRollUpRows,a=this.lastOutputScreen;if(a){const o=a.rows[s].cueStartTime,l=this.logger.time;if(o&&l!==null&&o<l)for(let u=0;u<this.nrRollUpRows;u++)this.rows[t-this.nrRollUpRows+u+1].copy(a.rows[s+u])}}this.currRow=t;const n=this.rows[this.currRow];if(e.indent!==null){const s=e.indent,a=Math.max(s-1,0);n.setCursor(e.indent),e.color=n.chars[a].penState.foreground}const i={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(i)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let n="",i=-1;for(let s=0;s<nn;s++){const a=this.rows[s].getTextString();a&&(i=s+1,e?t.push("Row "+i+": '"+a+"'"):t.push(a.trim()))}return t.length>0&&(e?n="["+t.join(" | ")+"]":n=t.join(`
`)),n}getTextAndFormat(){return this.rows}}class u0{constructor(e,t,n){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new Qc(n),this.nonDisplayedMemory=new Qc(n),this.lastOutputScreen=new Qc(n),this.currRollUpRow=this.displayedMemory.rows[nn-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=n}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[nn-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let n=0;n<e.length;n++)this.writeScreen.insertChar(e[n]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{const n=Math.floor(e/2)-16,i=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=i[n]}this.logger.log(2,"MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;t!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=t:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class c0{constructor(e,t,n){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;const i=new y_;this.channels=[null,new u0(e,t,i),new u0(e+1,n,i)],this.cmdHistory=h0(),this.logger=i}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){let n,i,s,a=!1;this.logger.time=e;for(let o=0;o<t.length;o+=2)if(i=t[o]&127,s=t[o+1]&127,!(i===0&&s===0)){if(this.logger.log(3,"["+Li([t[o],t[o+1]])+"] -> ("+Li([i,s])+")"),n=this.parseCmd(i,s),n||(n=this.parseMidrow(i,s)),n||(n=this.parsePAC(i,s)),n||(n=this.parseBackgroundAttributes(i,s)),!n&&(a=this.parseChars(i,s),a)){const l=this.currentChannel;l&&l>0?this.channels[l].insertChars(a):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!n&&!a&&this.logger.log(2,"Couldn't parse cleaned data "+Li([i,s])+" orig: "+Li([t[o],t[o+1]]))}}parseCmd(e,t){const{cmdHistory:n}=this,i=(e===20||e===28||e===21||e===29)&&t>=32&&t<=47,s=(e===23||e===31)&&t>=33&&t<=35;if(!(i||s))return!1;if(f0(e,t,n))return ds(null,null,n),this.logger.log(3,"Repeated command ("+Li([e,t])+") is dropped"),!0;const a=e===20||e===21||e===23?1:2,o=this.channels[a];return e===20||e===21||e===28||e===29?t===32?o.ccRCL():t===33?o.ccBS():t===34?o.ccAOF():t===35?o.ccAON():t===36?o.ccDER():t===37?o.ccRU(2):t===38?o.ccRU(3):t===39?o.ccRU(4):t===40?o.ccFON():t===41?o.ccRDC():t===42?o.ccTR():t===43?o.ccRTD():t===44?o.ccEDM():t===45?o.ccCR():t===46?o.ccENM():t===47&&o.ccEOC():o.ccTO(t-32),ds(e,t,n),this.currentChannel=a,!0}parseMidrow(e,t){let n=0;if((e===17||e===25)&&t>=32&&t<=47){if(e===17?n=1:n=2,n!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const i=this.channels[n];return i?(i.ccMIDROW(t),this.logger.log(3,"MIDROW ("+Li([e,t])+")"),!0):!1}return!1}parsePAC(e,t){let n;const i=this.cmdHistory,s=(e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127,a=(e===16||e===24)&&t>=64&&t<=95;if(!(s||a))return!1;if(f0(e,t,i))return ds(null,null,i),!0;const o=e<=23?1:2;t>=64&&t<=95?n=o===1?d_[e]:g_[e]:n=o===1?p_[e]:m_[e];const l=this.channels[o];return l?(l.setPAC(this.interpretPAC(n,t)),ds(e,t,i),this.currentChannel=o,!0):!1}interpretPAC(e,t){let n;const i={color:null,italics:!1,indent:null,underline:!1,row:e};return t>95?n=t-96:n=t-64,i.underline=(n&1)===1,n<=13?i.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(i.italics=!0,i.color="white"):i.indent=Math.floor((n-16)/2)*4,i}parseChars(e,t){let n,i=null,s=null;if(e>=25?(n=2,s=e-8):(n=1,s=e),s>=17&&s<=19){let a;s===17?a=t+80:s===18?a=t+112:a=t+144,this.logger.log(2,"Special char '"+wE(a)+"' in channel "+n),i=[a]}else e>=32&&e<=127&&(i=t===0?[e]:[e,t]);if(i){const a=Li(i);this.logger.log(3,"Char codes =  "+a.join(",")),ds(e,t,this.cmdHistory)}return i}parseBackgroundAttributes(e,t){const n=(e===16||e===24)&&t>=32&&t<=47,i=(e===23||e===31)&&t>=45&&t<=47;if(!(n||i))return!1;let s;const a={};e===16||e===24?(s=Math.floor((t-32)/2),a.background=v_[s],t%2===1&&(a.background=a.background+"_semi")):t===45?a.background="transparent":(a.foreground="black",t===47&&(a.underline=!0));const o=e<=23?1:2;return this.channels[o].setBkgData(a),ds(e,t,this.cmdHistory),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}this.cmdHistory=h0()}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const n=this.channels[t];n&&n.cueSplitAtTime(e)}}}function ds(r,e,t){t.a=r,t.b=e}function f0(r,e,t){return t.a===r&&t.b===e}function h0(){return{a:null,b:null}}class ol{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,n){(this.startTime===null||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=n,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}var zd=function(){if(typeof self<"u"&&self.VTTCue)return self.VTTCue;const r=["","lr","rl"],e=["start","middle","end","left","right"];function t(o,l){if(typeof l!="string"||!Array.isArray(o))return!1;const u=l.toLowerCase();return~o.indexOf(u)?u:!1}function n(o){return t(r,o)}function i(o){return t(e,o)}function s(o,...l){let u=1;for(;u<arguments.length;u++){const c=arguments[u];for(const f in c)o[f]=c[f]}return o}function a(o,l,u){const c=this,f={enumerable:!0};c.hasBeenReset=!1;let h="",d=!1,m=o,x=l,p=u,g=null,v="",E=!0,S="auto",T="start",w=50,_="middle",C=50,O="middle";Object.defineProperty(c,"id",s({},f,{get:function(){return h},set:function(L){h=""+L}})),Object.defineProperty(c,"pauseOnExit",s({},f,{get:function(){return d},set:function(L){d=!!L}})),Object.defineProperty(c,"startTime",s({},f,{get:function(){return m},set:function(L){if(typeof L!="number")throw new TypeError("Start time must be set to a number.");m=L,this.hasBeenReset=!0}})),Object.defineProperty(c,"endTime",s({},f,{get:function(){return x},set:function(L){if(typeof L!="number")throw new TypeError("End time must be set to a number.");x=L,this.hasBeenReset=!0}})),Object.defineProperty(c,"text",s({},f,{get:function(){return p},set:function(L){p=""+L,this.hasBeenReset=!0}})),Object.defineProperty(c,"region",s({},f,{get:function(){return g},set:function(L){g=L,this.hasBeenReset=!0}})),Object.defineProperty(c,"vertical",s({},f,{get:function(){return v},set:function(L){const V=n(L);if(V===!1)throw new SyntaxError("An invalid or illegal string was specified.");v=V,this.hasBeenReset=!0}})),Object.defineProperty(c,"snapToLines",s({},f,{get:function(){return E},set:function(L){E=!!L,this.hasBeenReset=!0}})),Object.defineProperty(c,"line",s({},f,{get:function(){return S},set:function(L){if(typeof L!="number"&&L!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");S=L,this.hasBeenReset=!0}})),Object.defineProperty(c,"lineAlign",s({},f,{get:function(){return T},set:function(L){const V=i(L);if(!V)throw new SyntaxError("An invalid or illegal string was specified.");T=V,this.hasBeenReset=!0}})),Object.defineProperty(c,"position",s({},f,{get:function(){return w},set:function(L){if(L<0||L>100)throw new Error("Position must be between 0 and 100.");w=L,this.hasBeenReset=!0}})),Object.defineProperty(c,"positionAlign",s({},f,{get:function(){return _},set:function(L){const V=i(L);if(!V)throw new SyntaxError("An invalid or illegal string was specified.");_=V,this.hasBeenReset=!0}})),Object.defineProperty(c,"size",s({},f,{get:function(){return C},set:function(L){if(L<0||L>100)throw new Error("Size must be between 0 and 100.");C=L,this.hasBeenReset=!0}})),Object.defineProperty(c,"align",s({},f,{get:function(){return O},set:function(L){const V=i(L);if(!V)throw new SyntaxError("An invalid or illegal string was specified.");O=V,this.hasBeenReset=!0}})),c.displayState=void 0}return a.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},a}();class T_{decode(e,t){if(!e)return"";if(typeof e!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function AE(r){function e(n,i,s,a){return(n|0)*3600+(i|0)*60+(s|0)+parseFloat(a||0)}const t=r.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return t?parseFloat(t[2])>59?e(t[2],t[3],0,t[4]):e(t[1],t[2],t[3],t[4]):null}class S_{constructor(){this.values=Object.create(null)}set(e,t){!this.get(e)&&t!==""&&(this.values[e]=t)}get(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,n){for(let i=0;i<n.length;++i)if(t===n[i]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const n=parseFloat(t);if(n>=0&&n<=100)return this.set(e,n),!0}return!1}}function bE(r,e,t,n){const i=n?r.split(n):[r];for(const s in i){if(typeof i[s]!="string")continue;const a=i[s].split(t);if(a.length!==2)continue;const o=a[0],l=a[1];e(o,l)}}const wh=new zd(0,0,""),ll=wh.align==="middle"?"middle":"center";function w_(r,e,t){const n=r;function i(){const o=AE(r);if(o===null)throw new Error("Malformed timestamp: "+n);return r=r.replace(/^[^\sa-zA-Z-]+/,""),o}function s(o,l){const u=new S_;bE(o,function(h,d){let m;switch(h){case"region":for(let x=t.length-1;x>=0;x--)if(t[x].id===d){u.set(h,t[x].region);break}break;case"vertical":u.alt(h,d,["rl","lr"]);break;case"line":m=d.split(","),u.integer(h,m[0]),u.percent(h,m[0])&&u.set("snapToLines",!1),u.alt(h,m[0],["auto"]),m.length===2&&u.alt("lineAlign",m[1],["start",ll,"end"]);break;case"position":m=d.split(","),u.percent(h,m[0]),m.length===2&&u.alt("positionAlign",m[1],["start",ll,"end","line-left","line-right","auto"]);break;case"size":u.percent(h,d);break;case"align":u.alt(h,d,["start",ll,"end","left","right"]);break}},/:/,/\s/),l.region=u.get("region",null),l.vertical=u.get("vertical","");let c=u.get("line","auto");c==="auto"&&wh.line===-1&&(c=-1),l.line=c,l.lineAlign=u.get("lineAlign","start"),l.snapToLines=u.get("snapToLines",!0),l.size=u.get("size",100),l.align=u.get("align",ll);let f=u.get("position","auto");f==="auto"&&wh.position===50&&(f=l.align==="start"||l.align==="left"?0:l.align==="end"||l.align==="right"?100:50),l.position=f}function a(){r=r.replace(/^\s+/,"")}if(a(),e.startTime=i(),a(),r.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+n);r=r.slice(3),a(),e.endTime=i(),a(),s(r,e)}function DE(r){return r.replace(/<br(?: \/)?>/gi,`
`)}class __{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new T_,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));function n(){let s=t.buffer,a=0;for(s=DE(s);a<s.length&&s[a]!=="\r"&&s[a]!==`
`;)++a;const o=s.slice(0,a);return s[a]==="\r"&&++a,s[a]===`
`&&++a,t.buffer=s.slice(a),o}function i(s){bE(s,function(a,o){},/:/)}try{let s="";if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;s=n();const o=s.match(/^()?WEBVTT([ \t].*)?$/);if(!(o!=null&&o[0]))throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let a=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(a?a=!1:s=n(),t.state){case"HEADER":/:/.test(s)?i(s):s||(t.state="ID");continue;case"NOTE":s||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(s)){t.state="NOTE";break}if(!s)continue;if(t.cue=new zd(0,0,""),t.state="CUE",s.indexOf("-->")===-1){t.cue.id=s;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{w_(s,t.cue,t.regionList)}catch{t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const o=s.indexOf("-->")!==-1;if(!s||o&&(a=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(t.cue===null)continue;t.cue.text&&(t.cue.text+=`
`),t.cue.text+=s}continue;case"BADCUE":s||(t.state="ID")}}}catch{t.state==="CUETEXT"&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||e.state==="HEADER")&&(e.buffer+=`

`,e.parse()),e.state==="INITIAL"||e.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}const A_=/\r\n|\n\r|\n|\r/g,Jc=function(e,t,n=0){return e.slice(n,n+t.length)===t},b_=function(e){let t=parseInt(e.slice(-3));const n=parseInt(e.slice(-6,-4)),i=parseInt(e.slice(-9,-7)),s=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!_e(t)||!_e(n)||!_e(i)||!_e(s))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*n,t+=60*1e3*i,t+=60*60*1e3*s,t},ef=function(e){let t=5381,n=e.length;for(;n;)t=t*33^e.charCodeAt(--n);return(t>>>0).toString()};function Vd(r,e,t){return ef(r.toString())+ef(e.toString())+ef(t)}const D_=function(e,t,n){let i=e[t],s=e[i.prevCC];if(!s||!s.new&&i.new){e.ccOffset=e.presentationOffset=i.start,i.new=!1;return}for(;(a=s)!=null&&a.new;){var a;e.ccOffset+=i.start-s.start,i.new=!1,i=s,s=e[i.prevCC]}e.presentationOffset=n};function C_(r,e,t,n,i,s,a){const o=new __,l=An(new Uint8Array(r)).trim().replace(A_,`
`).split(`
`),u=[],c=U2(e.baseTime,e.timescale);let f="00:00.000",h=0,d=0,m,x=!0;o.oncue=function(p){const g=t[n];let v=t.ccOffset;const E=(h-c)/9e4;g!=null&&g.new&&(d!==void 0?v=t.ccOffset=g.start:D_(t,n,E)),E&&(v=E-t.presentationOffset);const S=p.endTime-p.startTime,T=Mr((p.startTime+v-d)*9e4,i*9e4)/9e4;p.startTime=Math.max(T,0),p.endTime=Math.max(T+S,0);const w=p.text.trim();p.text=decodeURIComponent(encodeURIComponent(w)),p.id||(p.id=Vd(p.startTime,p.endTime,w)),p.endTime>0&&u.push(p)},o.onparsingerror=function(p){m=p},o.onflush=function(){if(m){a(m);return}s(u)},l.forEach(p=>{if(x)if(Jc(p,"X-TIMESTAMP-MAP=")){x=!1,p.slice(16).split(",").forEach(g=>{Jc(g,"LOCAL:")?f=g.slice(6):Jc(g,"MPEGTS:")&&(h=parseInt(g.slice(7)))});try{d=b_(f)/1e3}catch(g){m=g}return}else p===""&&(x=!1);o.parse(p+`
`)}),o.flush()}const tf="stpp.ttml.im1t",CE=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,RE=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,R_={left:"start",center:"center",right:"end",start:"start",end:"end"};function d0(r,e,t,n){const i=Be(new Uint8Array(r),["mdat"]);if(i.length===0){n(new Error("Could not parse IMSC1 mdat"));return}const s=i.map(o=>An(o)),a=B2(e.baseTime,1,e.timescale);try{s.forEach(o=>t(L_(o,a)))}catch(o){n(o)}}function L_(r,e){const i=new DOMParser().parseFromString(r,"text/xml").getElementsByTagName("tt")[0];if(!i)throw new Error("Invalid ttml");const s={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},a=Object.keys(s).reduce((f,h)=>(f[h]=i.getAttribute(`ttp:${h}`)||s[h],f),{}),o=i.getAttribute("xml:space")!=="preserve",l=p0(rf(i,"styling","style")),u=p0(rf(i,"layout","region")),c=rf(i,"body","[begin]");return[].map.call(c,f=>{const h=LE(f,o);if(!h||!f.hasAttribute("begin"))return null;const d=sf(f.getAttribute("begin"),a),m=sf(f.getAttribute("dur"),a);let x=sf(f.getAttribute("end"),a);if(d===null)throw g0(f);if(x===null){if(m===null)throw g0(f);x=d+m}const p=new zd(d-e,x-e,h);p.id=Vd(p.startTime,p.endTime,p.text);const g=u[f.getAttribute("region")],v=l[f.getAttribute("style")],E=I_(g,v,l),{textAlign:S}=E;if(S){const T=R_[S];T&&(p.lineAlign=T),p.align=S}return At(p,E),p}).filter(f=>f!==null)}function rf(r,e,t){const n=r.getElementsByTagName(e)[0];return n?[].slice.call(n.querySelectorAll(t)):[]}function p0(r){return r.reduce((e,t)=>{const n=t.getAttribute("xml:id");return n&&(e[n]=t),e},{})}function LE(r,e){return[].slice.call(r.childNodes).reduce((t,n,i)=>{var s;return n.nodeName==="br"&&i?t+`
`:(s=n.childNodes)!=null&&s.length?LE(n,e):e?t+n.textContent.trim().replace(/\s+/g," "):t+n.textContent},"")}function I_(r,e,t){const n="http://www.w3.org/ns/ttml#styling";let i=null;const s=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],a=r!=null&&r.hasAttribute("style")?r.getAttribute("style"):null;return a&&t.hasOwnProperty(a)&&(i=t[a]),s.reduce((o,l)=>{const u=nf(e,n,l)||nf(r,n,l)||nf(i,n,l);return u&&(o[l]=u),o},{})}function nf(r,e,t){return r&&r.hasAttributeNS(e,t)?r.getAttributeNS(e,t):null}function g0(r){return new Error(`Could not parse ttml timestamp ${r}`)}function sf(r,e){if(!r)return null;let t=AE(r);return t===null&&(CE.test(r)?t=k_(r,e):RE.test(r)&&(t=O_(r,e))),t}function k_(r,e){const t=CE.exec(r),n=(t[4]|0)+(t[5]|0)/e.subFrameRate;return(t[1]|0)*3600+(t[2]|0)*60+(t[3]|0)+n/e.frameRate}function O_(r,e){const t=RE.exec(r),n=Number(t[1]);switch(t[2]){case"h":return n*3600;case"m":return n*60;case"ms":return n*1e3;case"f":return n/e.frameRate;case"t":return n/e.tickRate}return n}class N_{constructor(e){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=m0(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){const t=new ol(this,"textTrack1"),n=new ol(this,"textTrack2"),i=new ol(this,"textTrack3"),s=new ol(this,"textTrack4");this.cea608Parser1=new c0(1,t,n),this.cea608Parser2=new c0(3,i,s)}e.on(A.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(A.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(A.MANIFEST_LOADING,this.onManifestLoading,this),e.on(A.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(A.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(A.FRAG_LOADING,this.onFragLoading,this),e.on(A.FRAG_LOADED,this.onFragLoaded,this),e.on(A.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(A.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(A.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(A.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(A.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(A.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(A.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(A.MANIFEST_LOADING,this.onManifestLoading,this),e.off(A.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(A.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(A.FRAG_LOADING,this.onFragLoading,this),e.off(A.FRAG_LOADED,this.onFragLoaded,this),e.off(A.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(A.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(A.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(A.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(A.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null}addCues(e,t,n,i,s){let a=!1;for(let o=s.length;o--;){const l=s[o],u=F_(l[0],l[1],t,n);if(u>=0&&(l[0]=Math.min(l[0],t),l[1]=Math.max(l[1],n),a=!0,u/(n-t)>.5))return}if(a||s.push([t,n]),this.config.renderTextTracksNatively){const o=this.captionsTracks[e];this.Cues.newCue(o,t,n,i)}else{const o=this.Cues.newCue(null,t,n,i);this.hls.trigger(A.CUES_PARSED,{type:"captions",cues:o,track:e})}}onInitPtsFound(e,{frag:t,id:n,initPTS:i,timescale:s}){const{unparsedVttFrags:a}=this;n==="main"&&(this.initPTS[t.cc]={baseTime:i,timescale:s}),a.length&&(this.unparsedVttFrags=[],a.forEach(o=>{this.onFragLoaded(A.FRAG_LOADED,o)}))}getExistingTrack(e){const{media:t}=this;if(t)for(let n=0;n<t.textTracks.length;n++){const i=t.textTracks[n];if(i[e])return i}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:n,media:i}=this,{label:s,languageCode:a}=t[e],o=this.getExistingTrack(e);if(o)n[e]=o,Ps(n[e]),Qy(n[e],i);else{const l=this.createTextTrack("captions",s,a);l&&(l[e]=!0,n[e]=l)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const n=t.label,i={_id:e,label:n,kind:"captions",default:t.media?!!t.media.default:!1,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=i,this.hls.trigger(A.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[i]})}createTextTrack(e,t,n){const i=this.media;if(!!i)return i.addTextTrack(e,t,n)}onMediaAttaching(e,t){this.media=t.media,this._cleanTracks()}onMediaDetaching(){const{captionsTracks:e}=this;Object.keys(e).forEach(t=>{Ps(e[t]),delete e[t]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=m0(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let n=0;n<t.length;n++)Ps(t[n])}onSubtitleTracksUpdated(e,t){const n=t.subtitleTracks||[],i=n.some(s=>s.textCodec===tf);if(this.config.enableWebVTT||i&&this.config.enableIMSC1){if(SE(this.tracks,n)){this.tracks=n;return}if(this.textTracks=[],this.tracks=n,this.config.renderTextTracksNatively){const a=this.media?this.media.textTracks:null;this.tracks.forEach((o,l)=>{let u;if(a&&l<a.length){let c=null;for(let f=0;f<a.length;f++)if(P_(a[f],o)){c=a[f];break}c&&(u=c)}if(u)Ps(u);else{const c=this._captionsOrSubtitlesFromCharacteristics(o);u=this.createTextTrack(c,o.name,o.lang),u&&(u.mode="disabled")}u&&(u.groupId=o.groupId,this.textTracks.push(u))})}else if(this.tracks.length){const a=this.tracks.map(o=>({label:o.name,kind:o.type.toLowerCase(),default:o.default,subtitleTrack:o}));this.hls.trigger(A.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:a})}}}_captionsOrSubtitlesFromCharacteristics(e){if(e.attrs.CHARACTERISTICS){const t=/transcribes-spoken-dialog/gi.test(e.attrs.CHARACTERISTICS),n=/describes-music-and-sound/gi.test(e.attrs.CHARACTERISTICS);if(t&&n)return"captions"}return"subtitles"}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(n=>{const i=/(?:CC|SERVICE)([1-4])/.exec(n.instreamId);if(!i)return;const s=`textTrack${i[1]}`,a=this.captionsProperties[s];!a||(a.label=n.name,n.lang&&(a.languageCode=n.lang),a.media=n)})}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return t==null?void 0:t.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){const{cea608Parser1:n,cea608Parser2:i,lastSn:s,lastPartIndex:a}=this;if(!(!this.enabled||!(n&&i))&&t.frag.type===De.MAIN){var o,l;const u=t.frag.sn,c=(o=t==null||(l=t.part)==null?void 0:l.index)!=null?o:-1;u===s+1||u===s&&c===a+1||(n.reset(),i.reset()),this.lastSn=u,this.lastPartIndex=c}}onFragLoaded(e,t){const{frag:n,payload:i}=t,{initPTS:s,unparsedVttFrags:a}=this;if(n.type===De.SUBTITLE)if(i.byteLength){if(!s[n.cc]){a.push(t),s.length&&this.hls.trigger(A.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:new Error("Missing initial subtitle PTS")});return}const o=n.decryptdata,l="stats"in t;if(o==null||!o.encrypted||l){const u=this.tracks[n.level],c=this.vttCCs;c[n.cc]||(c[n.cc]={start:n.start,prevCC:this.prevCC,new:!0},this.prevCC=n.cc),u&&u.textCodec===tf?this._parseIMSC1(n,i):this._parseVTTs(n,i,c)}}else this.hls.trigger(A.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const n=this.hls;d0(t,this.initPTS[e.cc],i=>{this._appendCues(i,e.level),n.trigger(A.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},i=>{G.log(`Failed to parse IMSC1: ${i}`),n.trigger(A.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:i})})}_parseVTTs(e,t,n){var i;const s=this.hls,a=(i=e.initSegment)!=null&&i.data?Yi(e.initSegment.data,new Uint8Array(t)):t;C_(a,this.initPTS[e.cc],n,e.cc,e.start,o=>{this._appendCues(o,e.level),s.trigger(A.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},o=>{this._fallbackToIMSC1(e,t),G.log(`Failed to parse VTT cue: ${o}`),s.trigger(A.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:o})})}_fallbackToIMSC1(e,t){const n=this.tracks[e.level];n.textCodec||d0(t,this.initPTS[e.cc],()=>{n.textCodec=tf,this._parseIMSC1(e,t)},()=>{n.textCodec="wvtt"})}_appendCues(e,t){const n=this.hls;if(this.config.renderTextTracksNatively){const i=this.textTracks[t];if(!i||i.mode==="disabled")return;e.forEach(s=>Jy(i,s))}else{const i=this.tracks[t];if(!i)return;const s=i.default?"default":"subtitles"+t;n.trigger(A.CUES_PARSED,{type:"subtitles",cues:e,track:s})}}onFragDecrypted(e,t){const{frag:n}=t;if(n.type===De.SUBTITLE){if(!this.initPTS[n.cc]){this.unparsedVttFrags.push(t);return}this.onFragLoaded(A.FRAG_LOADED,t)}}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){const{cea608Parser1:n,cea608Parser2:i}=this;if(!this.enabled||!(n&&i))return;const{frag:s,samples:a}=t;if(!(s.type===De.MAIN&&this.closedCaptionsForLevel(s)==="NONE"))for(let o=0;o<a.length;o++){const l=a[o].bytes;if(l){const u=this.extractCea608Data(l);n.addData(a[o].pts,u[0]),i.addData(a[o].pts,u[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:n,endOffsetSubtitles:i,type:s}){const{media:a}=this;if(!(!a||a.currentTime<n)){if(!s||s==="video"){const{captionsTracks:o}=this;Object.keys(o).forEach(l=>vh(o[l],t,n))}if(this.config.renderTextTracksNatively&&t===0&&i!==void 0){const{textTracks:o}=this;Object.keys(o).forEach(l=>vh(o[l],t,i))}}}extractCea608Data(e){const t=[[],[]],n=e[0]&31;let i=2;for(let s=0;s<n;s++){const a=e[i++],o=127&e[i++],l=127&e[i++];if(o===0&&l===0)continue;if((4&a)!==0){const c=3&a;(c===0||c===1)&&(t[c].push(o),t[c].push(l))}}return t}}function P_(r,e){return!!r&&r.label===e.name&&!(r.textTrack1||r.textTrack2)}function F_(r,e,t,n){return Math.min(e,n)-Math.max(r,t)}function m0(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}class Gd{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(A.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(A.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(A.MANIFEST_PARSED,this.onManifestParsed,this),e.on(A.BUFFER_CODECS,this.onBufferCodecs,this),e.on(A.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(A.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(A.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(A.MANIFEST_PARSED,this.onManifestParsed,this),e.off(A.BUFFER_CODECS,this.onBufferCodecs,this),e.off(A.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const n=this.hls.levels[t.droppedLevel];this.isLevelAllowed(n)&&this.restrictedLevels.push({bitrate:n.bitrate,height:n.height,width:n.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null}onManifestParsed(e,t){const n=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,n.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping()}detectPlayerSize(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){const e=this.hls.levels;if(e.length){const t=this.hls;t.autoLevelCapping=this.getMaxLevel(e.length-1),t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const n=t.filter((i,s)=>this.isLevelAllowed(i)&&s<=e);return this.clientRect=null,Gd.getMaxLevelByMediaSize(n,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const n=e.getBoundingClientRect();t.width=n.width,t.height=n.height,!t.width&&!t.height&&(t.width=n.right-n.left||e.width||0,t.height=n.bottom-n.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch{}return e}isLevelAllowed(e){return!this.restrictedLevels.some(n=>e.bitrate===n.bitrate&&e.width===n.width&&e.height===n.height)}static getMaxLevelByMediaSize(e,t,n){if(!(e!=null&&e.length))return-1;const i=(a,o)=>o?a.width!==o.width||a.height!==o.height:!0;let s=e.length-1;for(let a=0;a<e.length;a+=1){const o=e[a];if((o.width>=t||o.height>=n)&&i(o,e[a+1])){s=a;break}}return s}}class M_{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(A.MEDIA_ATTACHING,this.onMediaAttaching,this)}unregisterListeners(){this.hls.off(A.MEDIA_ATTACHING,this.onMediaAttaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const n=this.hls.config;if(n.capLevelOnFPSDrop){const i=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=i,i&&typeof i.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),n.fpsDroppedMonitoringPeriod)}}checkFPS(e,t,n){const i=performance.now();if(t){if(this.lastTime){const s=i-this.lastTime,a=n-this.lastDroppedFrames,o=t-this.lastDecodedFrames,l=1e3*a/s,u=this.hls;if(u.trigger(A.FPS_DROP,{currentDropped:a,currentDecoded:o,totalDroppedFrames:n}),l>0&&a>u.config.fpsDroppedMonitoringThreshold*o){let c=u.currentLevel;G.warn("drop FPS ratio greater than max allowed value for currentLevel: "+c),c>0&&(u.autoLevelCapping===-1||u.autoLevelCapping>=c)&&(c=c-1,u.trigger(A.FPS_DROP_LEVEL_CAPPING,{level:c,droppedLevel:u.currentLevel}),u.autoLevelCapping=c,this.streamController.nextLevelSwitch())}}this.lastTime=i,this.lastDroppedFrames=n,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}const ul="[eme]";class Ws{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=Ws.CDMCleanupPromise?[Ws.CDMCleanupPromise]:[],this.onMediaEncrypted=this._onMediaEncrypted.bind(this),this.onWaitingForKey=this._onWaitingForKey.bind(this),this.debug=G.debug.bind(G,ul),this.log=G.log.bind(G,ul),this.warn=G.warn.bind(G,ul),this.error=G.error.bind(G,ul),this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.unregisterListeners(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.onMediaEncrypted=this.onWaitingForKey=this.keyIdToKeySessionPromise=null,this.config=null}registerListeners(){this.hls.on(A.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(A.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(A.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(A.MANIFEST_LOADED,this.onManifestLoaded,this)}unregisterListeners(){this.hls.off(A.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(A.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(A.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(A.MANIFEST_LOADED,this.onManifestLoaded,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:n}=this.config,i=t[e];if(i)return i.licenseUrl;if(e===ot.WIDEVINE&&n)return n;throw new Error(`no license server URL configured for key-system "${e}"`)}getServerCertificateUrl(e){const{drmSystems:t}=this.config,n=t[e];if(n)return n.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,n=(a,o,l)=>!!a&&l.indexOf(a)===o,i=t.map(a=>a.audioCodec).filter(n),s=t.map(a=>a.videoCodec).filter(n);return i.length+s.length===0&&s.push("avc1.42e01e"),new Promise((a,o)=>{const l=u=>{const c=u.shift();this.getMediaKeysPromise(c,i,s).then(f=>a({keySystem:c,mediaKeys:f})).catch(f=>{u.length?l(u):f instanceof kr?o(f):o(new kr({type:be.KEY_SYSTEM_ERROR,details:J.KEY_SYSTEM_NO_ACCESS,error:f,fatal:!0},f.message))})};l(e)})}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:n}=this.config;if(typeof n!="function"){let i=`Configured requestMediaKeySystemAccess is not a function ${n}`;return $y===null&&self.location.protocol==="http:"&&(i=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(i))}return n(e,t)}getMediaKeysPromise(e,t,n){const i=Z1(e,t,n,this.config.drmSystemOptions),s=this.keySystemAccessPromises[e];let a=s==null?void 0:s.keySystemAccess;if(!a){this.log(`Requesting encrypted media "${e}" key-system access with config: ${JSON.stringify(i)}`),a=this.requestMediaKeySystemAccess(e,i);const o=this.keySystemAccessPromises[e]={keySystemAccess:a};return a.catch(l=>{this.log(`Failed to obtain access to key-system "${e}": ${l}`)}),a.then(l=>{this.log(`Access for key-system "${l.keySystem}" obtained`);const u=this.fetchServerCertificate(e);return this.log(`Create media-keys for "${e}"`),o.mediaKeys=l.createMediaKeys().then(c=>(this.log(`Media-keys created for "${e}"`),u.then(f=>f?this.setMediaKeysServerCertificate(c,e,f):c))),o.mediaKeys.catch(c=>{this.error(`Failed to create media-keys for "${e}"}: ${c}`)}),o.mediaKeys})}return a.then(()=>s.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:n}){this.log(`Creating key-system session "${t}" keyId: ${En.hexDump(e.keyId||[])}`);const i=n.createSession(),s={decryptdata:e,keySystem:t,mediaKeys:n,mediaKeysSession:i,keyStatus:"status-pending"};return this.mediaKeySessions.push(s),s}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const n=this.createMediaKeySessionContext(e),i=this.getKeyIdString(t),s="cenc";this.keyIdToKeySessionPromise[i]=this.generateRequestWithPreferredKeySession(n,s,t.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}getKeyIdString(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(e.keyId===null)throw new Error("keyId is null");return En.hexDump(e.keyId)}updateKeySession(e,t){var n;const i=e.mediaKeysSession;return this.log(`Updating key-session "${i.sessionId}" for keyID ${En.hexDump(((n=e.decryptdata)==null?void 0:n.keyId)||[])}
      } (data length: ${t&&t.byteLength})`),i.update(t)}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){return new Promise((t,n)=>{const i=Fc(this.config),s=e.map(Dg).filter(a=>!!a&&i.indexOf(a)!==-1);return this.getKeySystemSelectionPromise(s).then(({keySystem:a})=>{const o=Cg(a);o?t(o):n(new Error(`Unable to find format for key-system "${a}"`))}).catch(n)})}loadKey(e){const t=e.keyInfo.decryptdata,n=this.getKeyIdString(t),i=`(keyId: ${n} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${i}`);let s=this.keyIdToKeySessionPromise[n];return s||(s=this.keyIdToKeySessionPromise[n]=this.getKeySystemForKeyPromise(t).then(({keySystem:a,mediaKeys:o})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${i}`),this.attemptSetMediaKeys(a,o).then(()=>{this.throwIfDestroyed();const l=this.createMediaKeySessionContext({keySystem:a,mediaKeys:o,decryptdata:t}),u="cenc";return this.generateRequestWithPreferredKeySession(l,u,t.pssh,"playlist-key")}))),s.catch(a=>this.handleError(a))),s}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e){!this.hls||(this.error(e.message),e instanceof kr?this.hls.trigger(A.ERROR,e.data):this.hls.trigger(A.ERROR,{type:be.KEY_SYSTEM_ERROR,details:J.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))}getKeySystemForKeyPromise(e){const t=this.getKeyIdString(e),n=this.keyIdToKeySessionPromise[t];if(!n){const i=Dg(e.keyFormat),s=i?[i]:Fc(this.config);return this.attemptKeySystemAccess(s)}return n}getKeySystemSelectionPromise(e){if(e.length||(e=Fc(this.config)),e.length===0)throw new kr({type:be.KEY_SYSTEM_ERROR,details:J.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${JSON.stringify({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}_onMediaEncrypted(e){const{initDataType:t,initData:n}=e;if(this.debug(`"${e.type}" event: init data type: "${t}"`),n===null)return;let i,s;if(t==="sinf"&&this.config.drmSystems[ot.FAIRPLAY]){const c=Pt(new Uint8Array(n));try{const f=Rd(JSON.parse(c).sinf),h=qy(new Uint8Array(f));if(!h)return;i=h.subarray(8,24),s=ot.FAIRPLAY}catch{this.warn('Failed to parse sinf "encrypted" event message initData');return}}else{const c=Tw(n);if(c===null)return;c.version===0&&c.systemId===Uy.WIDEVINE&&c.data&&(i=c.data.subarray(8,24)),s=X1(c.systemId)}if(!s||!i)return;const a=En.hexDump(i),{keyIdToKeySessionPromise:o,mediaKeySessions:l}=this;let u=o[a];for(let c=0;c<l.length;c++){const f=l[c],h=f.decryptdata;if(h.pssh||!h.keyId)continue;const d=En.hexDump(h.keyId);if(a===d||h.uri.replace(/-/g,"").indexOf(a)!==-1){u=o[d],delete o[d],h.pssh=new Uint8Array(n),h.keyId=i,u=o[a]=u.then(()=>this.generateRequestWithPreferredKeySession(f,t,n,"encrypted-event-key-match"));break}}u||(u=o[a]=this.getKeySystemSelectionPromise([s]).then(({keySystem:c,mediaKeys:f})=>{var h;this.throwIfDestroyed();const d=new oo("ISO-23001-7",a,(h=Cg(c))!=null?h:"");return d.pssh=new Uint8Array(n),d.keyId=i,this.attemptSetMediaKeys(c,f).then(()=>{this.throwIfDestroyed();const m=this.createMediaKeySessionContext({decryptdata:d,keySystem:c,mediaKeys:f});return this.generateRequestWithPreferredKeySession(m,t,n,"encrypted-event-no-match")})})),u.catch(c=>this.handleError(c))}_onWaitingForKey(e){this.log(`"${e.type}" event`)}attemptSetMediaKeys(e,t){const n=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const i=Promise.all(n).then(()=>{if(!this.media)throw new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(t)});return this.setMediaKeysQueue.push(i),i.then(()=>{this.log(`Media-keys set for "${e}"`),n.push(i),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(s=>n.indexOf(s)===-1)})}generateRequestWithPreferredKeySession(e,t,n,i){var s,a;const o=(s=this.config.drmSystems)==null||(a=s[e.keySystem])==null?void 0:a.generateRequest;if(o)try{const h=o.call(this.hls,t,n,e);if(!h)throw new Error("Invalid response from configured generateRequest filter");t=h.initDataType,n=e.decryptdata.pssh=h.initData?new Uint8Array(h.initData):null}catch(h){var l;if(this.warn(h.message),(l=this.hls)!=null&&l.config.debug)throw h}if(n===null)return this.log(`Skipping key-session request for "${i}" (no initData)`),Promise.resolve(e);const u=this.getKeyIdString(e.decryptdata);this.log(`Generating key-session request for "${i}": ${u} (init data type: ${t} length: ${n?n.byteLength:null})`);const c=new $d;e.mediaKeysSession.onmessage=h=>{const d=e.mediaKeysSession;if(!d){c.emit("error",new Error("invalid state"));return}const{messageType:m,message:x}=h;this.log(`"${m}" message event for session "${d.sessionId}" message size: ${x.byteLength}`),m==="license-request"||m==="license-renewal"?this.renewLicense(e,x).catch(p=>{this.handleError(p),c.emit("error",p)}):m==="license-release"?e.keySystem===ot.FAIRPLAY&&(this.updateKeySession(e,By("acknowledged")),this.removeSession(e)):this.warn(`unhandled media key message type "${m}"`)},e.mediaKeysSession.onkeystatuseschange=h=>{if(!e.mediaKeysSession){c.emit("error",new Error("invalid state"));return}this.onKeyStatusChange(e);const m=e.keyStatus;c.emit("keyStatus",m),m==="expired"&&(this.warn(`${e.keySystem} expired for key ${u}`),this.renewKeySession(e))};const f=new Promise((h,d)=>{c.on("error",d),c.on("keyStatus",m=>{m.startsWith("usable")?h():m==="output-restricted"?d(new kr({type:be.KEY_SYSTEM_ERROR,details:J.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):m==="internal-error"?d(new kr({type:be.KEY_SYSTEM_ERROR,details:J.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${m}"`)):m==="expired"?d(new Error("key expired while generating request")):this.warn(`unhandled key status change "${m}"`)})});return e.mediaKeysSession.generateRequest(t,n).then(()=>{var h;this.log(`Request generated for key-session "${(h=e.mediaKeysSession)==null?void 0:h.sessionId}" keyId: ${u}`)}).catch(h=>{throw new kr({type:be.KEY_SYSTEM_ERROR,details:J.KEY_SYSTEM_NO_SESSION,error:h,fatal:!1},`Error generating key-session request: ${h}`)}).then(()=>f).catch(h=>{throw c.removeAllListeners(),this.removeSession(e),h}).then(()=>(c.removeAllListeners(),e))}onKeyStatusChange(e){e.mediaKeysSession.keyStatuses.forEach((t,n)=>{this.log(`key status change "${t}" for keyStatuses keyId: ${En.hexDump("buffer"in n?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n))} session keyId: ${En.hexDump(new Uint8Array(e.decryptdata.keyId||[]))} uri: ${e.decryptdata.uri}`),e.keyStatus=t})}fetchServerCertificate(e){const t=this.config,n=t.loader,i=new n(t),s=this.getServerCertificateUrl(e);return s?(this.log(`Fetching serverCertificate for "${e}"`),new Promise((a,o)=>{const l={responseType:"arraybuffer",url:s},u=t.certLoadPolicy.default,c={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},f={onSuccess:(h,d,m,x)=>{a(h.data)},onError:(h,d,m,x)=>{o(new kr({type:be.KEY_SYSTEM_ERROR,details:J.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:m,response:vr({url:l.url,data:void 0},h)},`"${e}" certificate request failed (${s}). Status: ${h.code} (${h.text})`))},onTimeout:(h,d,m)=>{o(new kr({type:be.KEY_SYSTEM_ERROR,details:J.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:m,response:{url:l.url,data:void 0}},`"${e}" certificate request timed out (${s})`))},onAbort:(h,d,m)=>{o(new Error("aborted"))}};i.load(l,c,f)})):Promise.resolve()}setMediaKeysServerCertificate(e,t,n){return new Promise((i,s)=>{e.setServerCertificate(n).then(a=>{this.log(`setServerCertificate ${a?"success":"not supported by CDM"} (${n==null?void 0:n.byteLength}) on "${t}"`),i(e)}).catch(a=>{s(new kr({type:be.KEY_SYSTEM_ERROR,details:J.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:a,fatal:!0},a.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(n=>this.updateKeySession(e,new Uint8Array(n)).catch(i=>{throw new kr({type:be.KEY_SYSTEM_ERROR,details:J.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:i,fatal:!0},i.message)}))}setupLicenseXHR(e,t,n,i){const s=this.config.licenseXhrSetup;return s?Promise.resolve().then(()=>{if(!n.decryptdata)throw new Error("Key removed");return s.call(this.hls,e,t,n,i)}).catch(a=>{if(!n.decryptdata)throw a;return e.open("POST",t,!0),s.call(this.hls,e,t,n,i)}).then(a=>(e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:a||i})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:i}))}requestLicense(e,t){const n=this.config.keyLoadPolicy.default;return new Promise((i,s)=>{const a=this.getLicenseServerUrl(e.keySystem);this.log(`Sending license request to URL: ${a}`);const o=new XMLHttpRequest;o.responseType="arraybuffer",o.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return s(new Error("invalid state"));if(o.readyState===4)if(o.status===200){this._requestLicenseFailureCount=0;let l=o.response;this.log(`License received ${l instanceof ArrayBuffer?l.byteLength:l}`);const u=this.config.licenseResponseCallback;if(u)try{l=u.call(this.hls,o,a,e)}catch(c){this.error(c)}i(l)}else{const l=n.errorRetry,u=l?l.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>u||o.status>=400&&o.status<500)s(new kr({type:be.KEY_SYSTEM_ERROR,details:J.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:o,response:{url:a,data:void 0,code:o.status,text:o.statusText}},`License Request XHR failed (${a}). Status: ${o.status} (${o.statusText})`));else{const c=u-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${c} attempts left`),this.requestLicense(e,t).then(i,s)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=o,this.setupLicenseXHR(o,a,e,t).then(({xhr:l,licenseChallenge:u})=>{l.send(u)})})}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const n=t.media;this.media=n,n.addEventListener("encrypted",this.onMediaEncrypted),n.addEventListener("waitingforkey",this.onWaitingForKey)}onMediaDetached(){const e=this.media,t=this.mediaKeySessions;e&&(e.removeEventListener("encrypted",this.onMediaEncrypted),e.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},oo.clearKeyUriToKeyIdMap();const n=t.length;Ws.CDMCleanupPromise=Promise.all(t.map(i=>this.removeSession(i)).concat(e==null?void 0:e.setMediaKeys(null).catch(i=>{this.log(`Could not clear media keys: ${i}. media.src: ${e==null?void 0:e.src}`)}))).then(()=>{n&&(this.log("finished closing key sessions and clearing media keys"),t.length=0)}).catch(i=>{this.log(`Could not close sessions and clear media keys: ${i}. media.src: ${e==null?void 0:e.src}`)})}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(e,{sessionKeys:t}){if(!(!t||!this.config.emeEnabled)&&!this.keyFormatPromise){const n=t.reduce((i,s)=>(i.indexOf(s.keyFormat)===-1&&i.push(s.keyFormat),i),[]);this.log(`Selecting key-system from session-keys ${n.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(n)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:n}=e;if(t){this.log(`Remove licenses and keys and close session ${t.sessionId}`),t.onmessage=null,t.onkeystatuseschange=null,n&&n.readyState!==XMLHttpRequest.DONE&&n.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const i=this.mediaKeySessions.indexOf(e);return i>-1&&this.mediaKeySessions.splice(i,1),t.remove().catch(s=>{this.log(`Could not remove session: ${s}`)}).then(()=>t.close()).catch(s=>{this.log(`Could not close session: ${s}`)})}}}Ws.CDMCleanupPromise=void 0;class kr extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}const B_=1;var ar={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"};const U_="h";class ui{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=i=>{try{this.apply(i,{ot:ar.MANIFEST,su:!this.initialized})}catch(s){G.warn("Could not generate manifest CMCD data.",s)}},this.applyFragmentData=i=>{try{const s=i.frag,a=this.hls.levels[s.level],o=this.getObjectType(s),l={d:s.duration*1e3,ot:o};(o===ar.VIDEO||o===ar.AUDIO||o==ar.MUXED)&&(l.br=a.bitrate/1e3,l.tb=this.getTopBandwidth(o)/1e3,l.bl=this.getBufferLength(o)),this.apply(i,l)}catch(s){G.warn("Could not generate segment CMCD data.",s)}},this.hls=e;const t=this.config=e.config,{cmcd:n}=t;n!=null&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=n.sessionId||ui.uuid(),this.cid=n.contentId,this.useHeaders=n.useHeaders===!0,this.registerListeners())}registerListeners(){const e=this.hls;e.on(A.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(A.MEDIA_DETACHED,this.onMediaDetached,this),e.on(A.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(A.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(A.MEDIA_DETACHED,this.onMediaDetached,this),e.off(A.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){!this.media||(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var n,i;this.audioBuffer=(n=t.tracks.audio)==null?void 0:n.buffer,this.videoBuffer=(i=t.tracks.video)==null?void 0:i.buffer}createData(){var e;return{v:B_,sf:U_,sid:this.sid,cid:this.cid,pr:(e=this.media)==null?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){At(t,this.createData());const n=t.ot===ar.INIT||t.ot===ar.VIDEO||t.ot===ar.MUXED;if(this.starved&&n&&(t.bs=!0,t.su=!0,this.starved=!1),t.su==null&&(t.su=this.buffering),this.useHeaders){const i=ui.toHeaders(t);if(!Object.keys(i).length)return;e.headers||(e.headers={}),At(e.headers,i)}else{const i=ui.toQuery(t);if(!i)return;e.url=ui.appendQueryToUri(e.url,i)}}getObjectType(e){const{type:t}=e;if(t==="subtitle")return ar.TIMED_TEXT;if(e.sn==="initSegment")return ar.INIT;if(t==="audio")return ar.AUDIO;if(t==="main")return this.hls.audioTracks.length?ar.VIDEO:ar.MUXED}getTopBandwidth(e){let t=0,n;const i=this.hls;if(e===ar.AUDIO)n=i.audioTracks;else{const s=i.maxAutoLevel,a=s>-1?s+1:i.levels.length;n=i.levels.slice(0,a)}for(const s of n)s.bitrate>t&&(t=s.bitrate);return t>0?t:NaN}getBufferLength(e){const t=this.hls.media,n=e===ar.AUDIO?this.audioBuffer:this.videoBuffer;return!n||!t?NaN:Je.bufferInfo(n,t.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,n=e||this.config.loader;return class{constructor(s){this.loader=void 0,this.loader=new n(s)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(s,a,o){t(s),this.loader.load(s,a,o)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,n=e||this.config.loader;return class{constructor(s){this.loader=void 0,this.loader=new n(s)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(s,a,o){t(s),this.loader.load(s,a,o)}}}static uuid(){const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}static serialize(e){const t=[],n=u=>!Number.isNaN(u)&&u!=null&&u!==""&&u!==!1,i=u=>Math.round(u),s=u=>i(u/100)*100,o={br:i,d:i,bl:s,dl:s,mtp:s,nor:u=>encodeURIComponent(u),rtp:s,tb:i},l=Object.keys(e||{}).sort();for(const u of l){let c=e[u];if(!n(c)||u==="v"&&c===1||u=="pr"&&c===1)continue;const f=o[u];f&&(c=f(c));const h=typeof c;let d;u==="ot"||u==="sf"||u==="st"?d=`${u}=${c}`:h==="boolean"?d=u:h==="number"?d=`${u}=${c}`:d=`${u}=${JSON.stringify(c)}`,t.push(d)}return t.join(",")}static toHeaders(e){const t=Object.keys(e),n={},i=["Object","Request","Session","Status"],s=[{},{},{},{}],a={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3};for(const o of t){const l=a[o]!=null?a[o]:1;s[l][o]=e[o]}for(let o=0;o<s.length;o++){const l=ui.serialize(s[o]);l&&(n[`CMCD-${i[o]}`]=l)}return n}static toQuery(e){return`CMCD=${encodeURIComponent(ui.serialize(e))}`}static appendQueryToUri(e,t){if(!t)return e;const n=e.includes("?")?"&":"?";return`${e}${n}${t}`}}const $_=3e5;class z_{constructor(e){this.hls=void 0,this.log=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this.pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.log=G.log.bind(G,"[content-steering]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(A.MANIFEST_LOADING,this.onManifestLoading,this),e.on(A.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(A.MANIFEST_PARSED,this.onManifestParsed,this),e.on(A.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;!e||(e.off(A.MANIFEST_LOADING,this.onManifestLoading,this),e.off(A.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(A.MANIFEST_PARSED,this.onManifestParsed,this),e.off(A.ERROR,this.onError,this))}startLoad(){if(this.started=!0,self.clearTimeout(this.reloadTimer),this.enabled&&this.uri)if(this.updated){const e=Math.max(this.timeToLoad*1e3-(performance.now()-this.updated),0);this.scheduleRefresh(this.uri,e)}else this.loadSteeringManifest(this.uri)}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),self.clearTimeout(this.reloadTimer)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter(n=>n!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:n}=t;n!==null&&(this.pathwayId=n.pathwayId,this.uri=n.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:n}=t;if((n==null?void 0:n.action)===lr.SendAlternateToPenaltyBox&&n.flags===rn.MoveAllAlternatesMatchingHost){let i=this.pathwayPriority;const s=this.pathwayId;this.penalizedPathways[s]||(this.penalizedPathways[s]=performance.now()),!i&&this.levels&&(i=this.levels.reduce((a,o)=>(a.indexOf(o.pathwayId)===-1&&a.push(o.pathwayId),a),[])),i&&i.length>1&&(this.updatePathwayPriority(i),n.resolved=this.pathwayId!==s)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(t.length===0){const n=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${n}"`),t=this.getLevelsForPathway(n),this.pathwayId=n}return t.length!==e.length?(this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t):e}getLevelsForPathway(e){return this.levels===null?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){this.pathwayPriority=e;let t;const n=this.penalizedPathways,i=performance.now();Object.keys(n).forEach(s=>{i-n[s]>$_&&delete n[s]});for(let s=0;s<e.length;s++){const a=e[s];if(n[a])continue;if(a===this.pathwayId)return;const o=this.hls.nextLoadLevel,l=this.hls.levels[o];if(t=this.getLevelsForPathway(a),t.length>0){this.log(`Setting Pathway to "${a}"`),this.pathwayId=a,this.hls.trigger(A.LEVELS_UPDATED,{levels:t});const u=this.hls.levels[o];l&&u&&this.levels&&(u.attrs["STABLE-VARIANT-ID"]!==l.attrs["STABLE-VARIANT-ID"]&&u.bitrate!==l.bitrate&&this.log(`Unstable Pathways change from bitrate ${l.bitrate} to ${u.bitrate}`),this.hls.nextLoadLevel=o);break}}}clonePathways(e){const t=this.levels;if(!t)return;const n={},i={};e.forEach(s=>{const{ID:a,"BASE-ID":o,"URI-REPLACEMENT":l}=s;if(t.some(c=>c.pathwayId===a))return;const u=this.getLevelsForPathway(o).map(c=>{const f=At({},c);f.details=void 0,f.url=IE(c.uri,c.attrs["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",l);const h=new st(c.attrs);h["PATHWAY-ID"]=a;const d=h.AUDIO&&`${h.AUDIO}_clone_${a}`,m=h.SUBTITLES&&`${h.SUBTITLES}_clone_${a}`;d&&(n[h.AUDIO]=d,h.AUDIO=d),m&&(i[h.SUBTITLES]=m,h.SUBTITLES=m),f.attrs=h;const x=new lo(f);return au(x,"audio",d),au(x,"text",m),x});t.push(...u),v0(this.audioTracks,n,l,a),v0(this.subtitleTracks,i,l,a)})}loadSteeringManifest(e){const t=this.hls.config,n=t.loader;this.loader&&this.loader.destroy(),this.loader=new n(t);let i;try{i=new self.URL(e)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${e}`);return}if(i.protocol!=="data:"){const c=(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate)|0;i.searchParams.set("_HLS_pathway",this.pathwayId),i.searchParams.set("_HLS_throughput",""+c)}const s={responseType:"json",url:i.href},a=t.steeringManifestLoadPolicy.default,o=a.errorRetry||a.timeoutRetry||{},l={loadPolicy:a,timeout:a.maxLoadTimeMs,maxRetry:o.maxNumRetry||0,retryDelay:o.retryDelayMs||0,maxRetryDelay:o.maxRetryDelayMs||0},u={onSuccess:(c,f,h,d)=>{this.log(`Loaded steering manifest: "${i}"`);const m=c.data;if(m.VERSION!==1){this.log(`Steering VERSION ${m.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=m.TTL;const{"RELOAD-URI":x,"PATHWAY-CLONES":p,"PATHWAY-PRIORITY":g}=m;if(x)try{this.uri=new self.URL(x,i).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${x}`);return}this.scheduleRefresh(this.uri||h.url),p&&this.clonePathways(p),g&&this.updatePathwayPriority(g)},onError:(c,f,h,d)=>{if(this.log(`Error loading steering manifest: ${c.code} ${c.text} (${f.url})`),this.stopLoad(),c.code===410){this.enabled=!1,this.log(`Steering manifest ${f.url} no longer available`);return}let m=this.timeToLoad*1e3;if(c.code===429){const x=this.loader;if(typeof(x==null?void 0:x.getResponseHeader)=="function"){const p=x.getResponseHeader("Retry-After");p&&(m=parseFloat(p)*1e3)}this.log(`Steering manifest ${f.url} rate limited`);return}this.scheduleRefresh(this.uri||f.url,m)},onTimeout:(c,f,h)=>{this.log(`Timeout loading steering manifest (${f.url})`),this.scheduleRefresh(this.uri||f.url)}};this.log(`Requesting steering manifest: ${i}`),this.loader.load(s,l,u)}scheduleRefresh(e,t=this.timeToLoad*1e3){self.clearTimeout(this.reloadTimer),this.reloadTimer=self.setTimeout(()=>{this.loadSteeringManifest(e)},t)}}function v0(r,e,t,n){!r||Object.keys(e).forEach(i=>{const s=r.filter(a=>a.groupId===i).map(a=>{const o=At({},a);return o.details=void 0,o.attrs=new st(o.attrs),o.url=o.attrs.URI=IE(a.url,a.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",t),o.groupId=o.attrs["GROUP-ID"]=e[i],o.attrs["PATHWAY-ID"]=n,o});r.push(...s)})}function IE(r,e,t,n){const{HOST:i,PARAMS:s,[t]:a}=n;let o;e&&(o=a==null?void 0:a[e],o&&(r=o));const l=new self.URL(r);return i&&!o&&(l.host=i),s&&Object.keys(s).sort().forEach(u=>{u&&l.searchParams.set(u,s[u])}),l.href}const V_=/^age:\s*[\d.]+\s*$/im;class kE{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new Ru,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,e.readyState!==4&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,n){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=n,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e)return;const n=this.loader=new self.XMLHttpRequest,i=this.stats;i.loading.first=0,i.loaded=0;const s=this.xhrSetup;s?Promise.resolve().then(()=>{if(!this.stats.aborted)return s(n,t.url)}).catch(a=>(n.open("GET",t.url,!0),s(n,t.url))).then(()=>{this.stats.aborted||this.openAndSendXhr(n,t,e)}).catch(a=>{this.callbacks.onError({code:n.status,text:a.message},t,n,i)}):this.openAndSendXhr(n,t,e)}openAndSendXhr(e,t,n){e.readyState||e.open("GET",t.url,!0);const i=this.context.headers,{maxTimeToFirstByteMs:s,maxLoadTimeMs:a}=n.loadPolicy;if(i)for(const o in i)e.setRequestHeader(o,i[o]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),n.timeout=s&&_e(s)?s:a,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),n.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:n}=this;if(!e||!t)return;const i=t.readyState,s=this.config;if(!n.aborted&&i>=2&&(n.loading.first===0&&(n.loading.first=Math.max(self.performance.now(),n.loading.start),s.timeout!==s.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),s.timeout=s.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),s.loadPolicy.maxLoadTimeMs-(n.loading.first-n.loading.start)))),i===4)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const a=t.status,o=t.responseType!=="text";if(a>=200&&a<300&&(o&&t.response||t.responseText!==null)){n.loading.end=Math.max(self.performance.now(),n.loading.first);const l=o?t.response:t.responseText,u=t.responseType==="arraybuffer"?l.byteLength:l.length;if(n.loaded=n.total=u,n.bwEstimate=n.total*8e3/(n.loading.end-n.loading.first),!this.callbacks)return;const c=this.callbacks.onProgress;if(c&&c(n,e,l,t),!this.callbacks)return;const f={url:t.responseURL,data:l,code:a};this.callbacks.onSuccess(f,n,e,t)}else{const l=s.loadPolicy.errorRetry,u=n.retry;su(l,u,!1,a)?this.retry(l):(G.error(`${a} while loading ${e.url}`),this.callbacks.onError({code:a,text:t.statusText},e,t,n))}}}loadtimeout(){var e;const t=(e=this.config)==null?void 0:e.loadPolicy.timeoutRetry,n=this.stats.retry;if(su(t,n,!0))this.retry(t);else{G.warn(`timeout while loading ${this.context.url}`);const i=this.callbacks;i&&(this.abortInternal(),i.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:n}=this;this.retryDelay=Id(e,n.retry),n.retry++,G.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${t.url}, retrying ${n.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&V_.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}function G_(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}const W_=/(\d+)-(\d+)\/(\d+)/;class y0{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||q_,this.controller=new self.AbortController,this.stats=new Ru}destroy(){this.loader=this.callbacks=null,this.abortInternal()}abortInternal(){const e=this.response;e!=null&&e.ok||(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,n){const i=this.stats;if(i.loading.start)throw new Error("Loader can only be used once.");i.loading.start=self.performance.now();const s=H_(e,this.controller.signal),a=n.onProgress,o=e.responseType==="arraybuffer",l=o?"byteLength":"length",{maxTimeToFirstByteMs:u,maxLoadTimeMs:c}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=n,this.request=this.fetchSetup(e,s),self.clearTimeout(this.requestTimeout),t.timeout=u&&_e(u)?u:c,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),n.onTimeout(i,e,this.response)},t.timeout),self.fetch(this.request).then(f=>{this.response=this.loader=f;const h=Math.max(self.performance.now(),i.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=c,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),n.onTimeout(i,e,this.response)},c-(h-i.loading.start)),!f.ok){const{status:d,statusText:m}=f;throw new Y_(m||"fetch, bad network response",d,f)}return i.loading.first=h,i.total=K_(f.headers)||i.total,a&&_e(t.highWaterMark)?this.loadProgressively(f,i,e,t.highWaterMark,a):o?f.arrayBuffer():e.responseType==="json"?f.json():f.text()}).then(f=>{const{response:h}=this;self.clearTimeout(this.requestTimeout),i.loading.end=Math.max(self.performance.now(),i.loading.first);const d=f[l];d&&(i.loaded=i.total=d);const m={url:h.url,data:f,code:h.status};a&&!_e(t.highWaterMark)&&a(i,e,f,h),n.onSuccess(m,i,e,h)}).catch(f=>{if(self.clearTimeout(this.requestTimeout),i.aborted)return;const h=f&&f.code||0,d=f?f.message:null;n.onError({code:h,text:d},e,f?f.details:null,i)})}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,n,i=0,s){const a=new TE,o=e.body.getReader(),l=()=>o.read().then(u=>{if(u.done)return a.dataLength&&s(t,n,a.flush(),e),Promise.resolve(new ArrayBuffer(0));const c=u.value,f=c.length;return t.loaded+=f,f<i||a.dataLength?(a.push(c),a.dataLength>=i&&s(t,n,a.flush(),e)):s(t,n,c,e),l()}).catch(()=>Promise.reject());return l()}}function H_(r,e){const t={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(At({},r.headers))};return r.rangeEnd&&t.headers.set("Range","bytes="+r.rangeStart+"-"+String(r.rangeEnd-1)),t}function j_(r){const e=W_.exec(r);if(e)return parseInt(e[2])-parseInt(e[1])+1}function K_(r){const e=r.get("Content-Range");if(e){const n=j_(e);if(_e(n))return n}const t=r.get("Content-Length");if(t)return parseInt(t)}function q_(r,e){return new self.Request(r.url,e)}class Y_ extends Error{constructor(e,t,n){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=n}}const X_=/\s/,Z_={newCue(r,e,t,n){const i=[];let s,a,o,l,u;const c=self.VTTCue||self.TextTrackCue;for(let h=0;h<n.rows.length;h++)if(s=n.rows[h],o=!0,l=0,u="",!s.isEmpty()){var f;for(let x=0;x<s.chars.length;x++)X_.test(s.chars[x].uchar)&&o?l++:(u+=s.chars[x].uchar,o=!1);s.cueStartTime=e,e===t&&(t+=1e-4),l>=16?l--:l++;const d=DE(u.trim()),m=Vd(e,t,d);r!=null&&(f=r.cues)!=null&&f.getCueById(m)||(a=new c(e,t,d),a.id=m,a.line=h+1,a.align="left",a.position=10+Math.min(80,Math.floor(l*8/32)*10),i.push(a))}return r&&i.length&&(i.sort((h,d)=>h.line==="auto"||d.line==="auto"?0:h.line>8&&d.line>8?d.line-h.line:h.line-d.line),i.forEach(h=>Jy(r,h))),i}},Q_={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},J_=vr(vr({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:60*1e3*1e3,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:kE,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:n_,bufferController:h_,capLevelController:Gd,errorController:Yw,fpsController:M_,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:$y,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0,certLoadPolicy:{default:Q_},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},eA()),{},{subtitleStreamController:l_,subtitleTrackController:c_,timelineController:N_,audioStreamController:s_,audioTrackController:a_,emeController:Ws,cmcdController:ui,contentSteeringController:z_});function eA(){return{cueHandler:Z_,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function tA(r,e){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(e.liveMaxLatencyDurationCount!==void 0&&(e.liveSyncDurationCount===void 0||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(e.liveMaxLatencyDuration!==void 0&&(e.liveSyncDuration===void 0||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const t=_h(r),n=["manifest","level","frag"],i=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return n.forEach(s=>{const a=`${s==="level"?"playlist":s}LoadPolicy`,o=e[a]===void 0,l=[];i.forEach(u=>{const c=`${s}Loading${u}`,f=e[c];if(f!==void 0&&o){l.push(c);const h=t[a].default;switch(e[a]={default:h},u){case"TimeOut":h.maxLoadTimeMs=f,h.maxTimeToFirstByteMs=f;break;case"MaxRetry":h.errorRetry.maxNumRetry=f,h.timeoutRetry.maxNumRetry=f;break;case"RetryDelay":h.errorRetry.retryDelayMs=f,h.timeoutRetry.retryDelayMs=f;break;case"MaxRetryTimeout":h.errorRetry.maxRetryDelayMs=f,h.timeoutRetry.maxRetryDelayMs=f;break}}}),l.length&&G.warn(`hls.js config: "${l.join('", "')}" setting(s) are deprecated, use "${a}": ${JSON.stringify(e[a])}`)}),vr(vr({},t),e)}function _h(r){return r&&typeof r=="object"?Array.isArray(r)?r.map(_h):Object.keys(r).reduce((e,t)=>(e[t]=_h(r[t]),e),{}):r}function rA(r){const e=r.loader;e!==y0&&e!==kE?(G.log("[config]: Custom loader detected, cannot enable progressive streaming"),r.progressive=!1):G_()&&(r.loader=y0,r.progressive=!0,r.enableSoftwareAES=!0,G.log("[config]: Progressive streaming enabled, using FetchLoader"))}class Vn{static get version(){return"1.4.4"}static isSupported(){return p2()}static get Events(){return A}static get ErrorTypes(){return be}static get ErrorDetails(){return J}static get DefaultConfig(){return Vn.defaultConfig?Vn.defaultConfig:J_}static set DefaultConfig(e){Vn.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new $d,this._autoLevelCapping=void 0,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null,$1(e.debug||!1,"Hls instance");const t=this.config=tA(Vn.DefaultConfig,e);this.userConfig=e,this._autoLevelCapping=-1,t.progressive&&rA(t);const{abrController:n,bufferController:i,capLevelController:s,errorController:a,fpsController:o}=t,l=new a(this),u=this.abrController=new n(this),c=this.bufferController=new i(this),f=this.capLevelController=new s(this),h=new o(this),d=new Lw(this),m=new Pw(this),x=t.contentSteeringController,p=x?new x(this):null,g=this.levelController=new Zw(this,p),v=new Qw(this),E=new e2(this.config),S=this.streamController=new t_(this,v,E);f.setStreamController(S),h.setStreamController(S);const T=[d,g,S];p&&T.splice(1,0,p),this.networkControllers=T;const w=[u,c,f,h,m,v];this.audioTrackController=this.createController(t.audioTrackController,T);const _=t.audioStreamController;_&&T.push(new _(this,v,E)),this.subtitleTrackController=this.createController(t.subtitleTrackController,T);const C=t.subtitleStreamController;C&&T.push(new C(this,v,E)),this.createController(t.timelineController,w),E.emeController=this.emeController=this.createController(t.emeController,w),this.cmcdController=this.createController(t.cmcdController,w),this.latencyController=this.createController(Fw,w),this.coreComponents=w,T.push(l);const O=l.onErrorOut;typeof O=="function"&&this.on(A.ERROR,O,l)}createController(e,t){if(e){const n=new e(this);return t&&t.push(n),n}return null}on(e,t,n=this){this._emitter.on(e,t,n)}once(e,t,n=this){this._emitter.once(e,t,n)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,n=this,i){this._emitter.off(e,t,n,i)}listeners(e){return this._emitter.listeners(e)}emit(e,t,n){return this._emitter.emit(e,t,n)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(n){G.error("An internal error happened while handling event "+e+'. Error message: "'+n.message+'". Here is a stacktrace:',n),this.trigger(A.ERROR,{type:be.OTHER_ERROR,details:J.INTERNAL_EXCEPTION,fatal:!1,event:e,error:n})}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){G.log("destroy"),this.trigger(A.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(t=>t.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(t=>t.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){G.log("attachMedia"),this._media=e,this.trigger(A.MEDIA_ATTACHING,{media:e})}detachMedia(){G.log("detachMedia"),this.trigger(A.MEDIA_DETACHING,void 0),this._media=null}loadSource(e){this.stopLoad();const t=this.media,n=this.url,i=this.url=Cd.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});G.log(`loadSource:${i}`),t&&n&&(n!==i||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(A.MANIFEST_LOADING,{url:e})}startLoad(e=-1){G.log(`startLoad(${e})`),this.networkControllers.forEach(t=>{t.startLoad(e)})}stopLoad(){G.log("stopLoad"),this.networkControllers.forEach(e=>{e.stopLoad()})}swapAudioCodec(){G.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){G.log("recoverMediaError");const e=this._media;this.detachMedia(),e&&this.attachMedia(e)}removeLevel(e,t=0){this.levelController.removeLevel(e,t)}get levels(){const e=this.levelController.levels;return e||[]}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){G.log(`set currentLevel:${e}`),this.loadLevel=e,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){G.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){G.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){G.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){return this.levelController.startLevel}set startLevel(e){G.log(`set startLevel:${e}`),e!==-1&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(G.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e)}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){Eh.indexOf(e)>-1&&(this._maxHdcpLevel=e)}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const n=e.length;for(let i=0;i<n;i++)if(e[i].maxBitrate>=t)return i;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:n}=this;let i;if(t===-1&&e&&e.length?i=e.length-1:i=t,n)for(let s=i;s--;){const a=e[s].attrs["HDCP-LEVEL"];if(a&&a<=n)return s}return i}get nextAutoLevel(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)}set nextAutoLevel(e){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,e)}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return e?e.subtitleDisplay:!1}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}}Vn.defaultConfig=void 0;const nA=()=>(cn.exports.useEffect(()=>{const r=document.getElementById("video"),e="https://vip.lzcdn2.com/20220318/37_8786d09c/1200k/hls/mixed.m3u8";if(Vn.isSupported()){const t=new Vn;t.loadSource(e),t.attachMedia(r),t.on(Vn.Events.MANIFEST_PARSED,function(){})}else r.canPlayType("application/vnd.apple.mpegurl")&&(r.src=e,r.addEventListener("loadedmetadata",function(){}))}),$r.createElement($r.Fragment,null,$r.createElement("video",{controls:!0,autoPlay:!1,style:{width:"100%"},id:"video"})));var af={},ku={},Wd={exports:{}},iA="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",sA=iA,aA=sA;function OE(){}function NE(){}NE.resetWarningCache=OE;var oA=function(){function r(n,i,s,a,o,l){if(l!==aA){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}r.isRequired=r;function e(){return r}var t={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:e,element:r,elementType:r,instanceOf:e,node:r,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:NE,resetWarningCache:OE};return t.PropTypes=t,t};Wd.exports=oA();var PE={},xo={},Hr={exports:{}},FE={exports:{}},lA=void 0,ME=function(r){return r!==lA&&r!==null},uA=ME,cA={object:!0,function:!0,undefined:!0},fA=function(r){return uA(r)?hasOwnProperty.call(cA,typeof r):!1},hA=fA,dA=function(r){if(!hA(r))return!1;try{return r.constructor?r.constructor.prototype===r:!1}catch{return!1}},pA=dA,gA=function(r){if(typeof r!="function"||!hasOwnProperty.call(r,"length"))return!1;try{if(typeof r.length!="number"||typeof r.call!="function"||typeof r.apply!="function")return!1}catch{return!1}return!pA(r)},mA=gA,vA=/^\s*class[\s{/}]/,yA=Function.prototype.toString,EA=function(r){return!(!mA(r)||vA.test(yA.call(r)))},xA=function(){var r=Object.assign,e;return typeof r!="function"?!1:(e={foo:"raz"},r(e,{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")},of,E0;function TA(){return E0||(E0=1,of=function(){try{return Object.keys("primitive"),!0}catch{return!1}}),of}var SA=function(){},wA=SA(),Hd=function(r){return r!==wA&&r!==null},lf,x0;function _A(){if(x0)return lf;x0=1;var r=Hd,e=Object.keys;return lf=function(t){return e(r(t)?Object(t):t)},lf}var uf,T0;function AA(){return T0||(T0=1,uf=TA()()?Object.keys:_A()),uf}var cf,S0;function bA(){if(S0)return cf;S0=1;var r=Hd;return cf=function(e){if(!r(e))throw new TypeError("Cannot use null or undefined");return e},cf}var ff,w0;function DA(){if(w0)return ff;w0=1;var r=AA(),e=bA(),t=Math.max;return ff=function(n,i){var s,a,o=t(arguments.length,2),l;for(n=Object(e(n)),l=function(u){try{n[u]=i[u]}catch(c){s||(s=c)}},a=1;a<o;++a)i=arguments[a],r(i).forEach(l);if(s!==void 0)throw s;return n},ff}var CA=xA()?Object.assign:DA(),RA=Hd,LA=Array.prototype.forEach,IA=Object.create,kA=function(r,e){var t;for(t in r)e[t]=r[t]},OA=function(r){var e=IA(null);return LA.call(arguments,function(t){!RA(t)||kA(Object(t),e)}),e},hf="razdwatrzy",NA=function(){return typeof hf.contains!="function"?!1:hf.contains("dwa")===!0&&hf.contains("foo")===!1},df,_0;function PA(){if(_0)return df;_0=1;var r=String.prototype.indexOf;return df=function(e){return r.call(this,e,arguments[1])>-1},df}var FA=NA()?String.prototype.contains:PA(),Ll=ME,A0=EA,BE=CA,UE=OA,Ga=FA,MA=FE.exports=function(r,e){var t,n,i,s,a;return arguments.length<2||typeof r!="string"?(s=e,e=r,r=null):s=arguments[2],Ll(r)?(t=Ga.call(r,"c"),n=Ga.call(r,"e"),i=Ga.call(r,"w")):(t=i=!0,n=!1),a={value:e,configurable:t,enumerable:n,writable:i},s?BE(UE(s),a):a};MA.gs=function(r,e,t){var n,i,s,a;return typeof r!="string"?(s=t,t=e,e=r,r=null):s=arguments[3],Ll(e)?A0(e)?Ll(t)?A0(t)||(s=t,t=void 0):t=void 0:(s=e,e=t=void 0):e=void 0,Ll(r)?(n=Ga.call(r,"c"),i=Ga.call(r,"e")):(n=!0,i=!1),a={get:e,set:t,configurable:n,enumerable:i},s?BE(UE(s),a):a};var BA=function(r){if(typeof r!="function")throw new TypeError(r+" is not a function");return r};(function(r,e){var t=FE.exports,n=BA,i=Function.prototype.apply,s=Function.prototype.call,a=Object.create,o=Object.defineProperty,l=Object.defineProperties,u=Object.prototype.hasOwnProperty,c={configurable:!0,enumerable:!1,writable:!0},f,h,d,m,x,p,g;f=function(v,E){var S;return n(E),u.call(this,"__ee__")?S=this.__ee__:(S=c.value=a(null),o(this,"__ee__",c),c.value=null),S[v]?typeof S[v]=="object"?S[v].push(E):S[v]=[S[v],E]:S[v]=E,this},h=function(v,E){var S,T;return n(E),T=this,f.call(this,v,S=function(){d.call(T,v,S),i.call(E,this,arguments)}),S.__eeOnceListener__=E,this},d=function(v,E){var S,T,w,_;if(n(E),!u.call(this,"__ee__"))return this;if(S=this.__ee__,!S[v])return this;if(T=S[v],typeof T=="object")for(_=0;w=T[_];++_)(w===E||w.__eeOnceListener__===E)&&(T.length===2?S[v]=T[_?0:1]:T.splice(_,1));else(T===E||T.__eeOnceListener__===E)&&delete S[v];return this},m=function(v){var E,S,T,w,_;if(!!u.call(this,"__ee__")&&(w=this.__ee__[v],!!w))if(typeof w=="object"){for(S=arguments.length,_=new Array(S-1),E=1;E<S;++E)_[E-1]=arguments[E];for(w=w.slice(),E=0;T=w[E];++E)i.call(T,this,_)}else switch(arguments.length){case 1:s.call(w,this);break;case 2:s.call(w,this,arguments[1]);break;case 3:s.call(w,this,arguments[1],arguments[2]);break;default:for(S=arguments.length,_=new Array(S-1),E=1;E<S;++E)_[E-1]=arguments[E];i.call(w,this,_)}},x={on:f,once:h,off:d,emit:m},p={on:t(f),once:t(h),off:t(d),emit:t(m)},g=l({},p),r.exports=e=function(v){return v==null?a(g):l(Object(v),p)},e.methods=x})(Hr,Hr.exports);var Ee={},To={},Qn={},Ri={};function UA(r,e,t){if(t===void 0&&(t=Array.prototype),r&&typeof t.find=="function")return t.find.call(r,e);for(var n=0;n<r.length;n++)if(Object.prototype.hasOwnProperty.call(r,n)){var i=r[n];if(e.call(void 0,i,n,r))return i}}function jd(r,e){return e===void 0&&(e=Object),e&&typeof e.freeze=="function"?e.freeze(r):r}var $E=jd({HTML:"text/html",isHTML:function(r){return r===$E.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),zE=jd({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(r){return r===zE.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});Ri.find=UA;Ri.freeze=jd;Ri.MIME_TYPE=$E;Ri.NAMESPACE=zE;var VE=Ri,bn=VE.find,co=VE.NAMESPACE;function $A(r){return r!==""}function zA(r){return r?r.split(/[\t\n\f\r ]+/).filter($A):[]}function VA(r,e){return r.hasOwnProperty(e)||(r[e]=!0),r}function b0(r){if(!r)return[];var e=zA(r);return Object.keys(e.reduce(VA,{}))}function GA(r){return function(e){return r&&r.indexOf(e)!==-1}}function So(r,e){for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t])}function yr(r,e){var t=r.prototype;if(!(t instanceof e)){let i=function(){};var n=i;i.prototype=e.prototype,i=new i,So(t,i),r.prototype=t=i}t.constructor!=r&&(typeof r!="function"&&console.error("unknown Class:"+r),t.constructor=r)}var Er={},dn=Er.ELEMENT_NODE=1,Qs=Er.ATTRIBUTE_NODE=2,lu=Er.TEXT_NODE=3,GE=Er.CDATA_SECTION_NODE=4,WE=Er.ENTITY_REFERENCE_NODE=5,WA=Er.ENTITY_NODE=6,HE=Er.PROCESSING_INSTRUCTION_NODE=7,jE=Er.COMMENT_NODE=8,KE=Er.DOCUMENT_NODE=9,qE=Er.DOCUMENT_TYPE_NODE=10,Yn=Er.DOCUMENT_FRAGMENT_NODE=11,HA=Er.NOTATION_NODE=12,jt={},It={};jt.INDEX_SIZE_ERR=(It[1]="Index size error",1);jt.DOMSTRING_SIZE_ERR=(It[2]="DOMString size error",2);var fr=jt.HIERARCHY_REQUEST_ERR=(It[3]="Hierarchy request error",3);jt.WRONG_DOCUMENT_ERR=(It[4]="Wrong document",4);jt.INVALID_CHARACTER_ERR=(It[5]="Invalid character",5);jt.NO_DATA_ALLOWED_ERR=(It[6]="No data allowed",6);jt.NO_MODIFICATION_ALLOWED_ERR=(It[7]="No modification allowed",7);var YE=jt.NOT_FOUND_ERR=(It[8]="Not found",8);jt.NOT_SUPPORTED_ERR=(It[9]="Not supported",9);var D0=jt.INUSE_ATTRIBUTE_ERR=(It[10]="Attribute in use",10);jt.INVALID_STATE_ERR=(It[11]="Invalid state",11);jt.SYNTAX_ERR=(It[12]="Syntax error",12);jt.INVALID_MODIFICATION_ERR=(It[13]="Invalid modification",13);jt.NAMESPACE_ERR=(It[14]="Invalid namespace",14);jt.INVALID_ACCESS_ERR=(It[15]="Invalid access",15);function vt(r,e){if(e instanceof Error)var t=e;else t=this,Error.call(this,It[r]),this.message=It[r],Error.captureStackTrace&&Error.captureStackTrace(this,vt);return t.code=r,e&&(this.message=this.message+": "+e),t}vt.prototype=Error.prototype;So(jt,vt);function Wn(){}Wn.prototype={length:0,item:function(r){return this[r]||null},toString:function(r,e){for(var t=[],n=0;n<this.length;n++)Fs(this[n],t,r,e);return t.join("")},filter:function(r){return Array.prototype.filter.call(this,r)},indexOf:function(r){return Array.prototype.indexOf.call(this,r)}};function Js(r,e){this._node=r,this._refresh=e,Kd(this)}function Kd(r){var e=r._node._inc||r._node.ownerDocument._inc;if(r._inc!=e){var t=r._refresh(r._node);ox(r,"length",t.length),So(t,r),r._inc=e}}Js.prototype.item=function(r){return Kd(this),this[r]};yr(Js,Wn);function uu(){}function XE(r,e){for(var t=r.length;t--;)if(r[t]===e)return t}function C0(r,e,t,n){if(n?e[XE(e,n)]=t:e[e.length++]=t,r){t.ownerElement=r;var i=r.ownerDocument;i&&(n&&JE(i,r,n),jA(i,r,t))}}function R0(r,e,t){var n=XE(e,t);if(n>=0){for(var i=e.length-1;n<i;)e[n]=e[++n];if(e.length=i,r){var s=r.ownerDocument;s&&(JE(s,r,t),t.ownerElement=null)}}else throw new vt(YE,new Error(r.tagName+"@"+t))}uu.prototype={length:0,item:Wn.prototype.item,getNamedItem:function(r){for(var e=this.length;e--;){var t=this[e];if(t.nodeName==r)return t}},setNamedItem:function(r){var e=r.ownerElement;if(e&&e!=this._ownerElement)throw new vt(D0);var t=this.getNamedItem(r.nodeName);return C0(this._ownerElement,this,r,t),t},setNamedItemNS:function(r){var e=r.ownerElement,t;if(e&&e!=this._ownerElement)throw new vt(D0);return t=this.getNamedItemNS(r.namespaceURI,r.localName),C0(this._ownerElement,this,r,t),t},removeNamedItem:function(r){var e=this.getNamedItem(r);return R0(this._ownerElement,this,e),e},removeNamedItemNS:function(r,e){var t=this.getNamedItemNS(r,e);return R0(this._ownerElement,this,t),t},getNamedItemNS:function(r,e){for(var t=this.length;t--;){var n=this[t];if(n.localName==e&&n.namespaceURI==r)return n}return null}};function ZE(){}ZE.prototype={hasFeature:function(r,e){return!0},createDocument:function(r,e,t){var n=new wo;if(n.implementation=this,n.childNodes=new Wn,n.doctype=t||null,t&&n.appendChild(t),e){var i=n.createElementNS(r,e);n.appendChild(i)}return n},createDocumentType:function(r,e,t){var n=new Ou;return n.name=r,n.nodeName=r,n.publicId=e||"",n.systemId=t||"",n}};function Ke(){}Ke.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(r,e){return cu(this,r,e)},replaceChild:function(r,e){cu(this,r,e,tx),e&&this.removeChild(e)},removeChild:function(r){return ex(this,r)},appendChild:function(r){return this.insertBefore(r,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(r){return Ah(this.ownerDocument||this,this,r)},normalize:function(){for(var r=this.firstChild;r;){var e=r.nextSibling;e&&e.nodeType==lu&&r.nodeType==lu?(this.removeChild(e),r.appendData(e.data)):(r.normalize(),r=e)}},isSupported:function(r,e){return this.ownerDocument.implementation.hasFeature(r,e)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(r){for(var e=this;e;){var t=e._nsMap;if(t){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&t[n]===r)return n}e=e.nodeType==Qs?e.ownerDocument:e.parentNode}return null},lookupNamespaceURI:function(r){for(var e=this;e;){var t=e._nsMap;if(t&&r in t&&Object.prototype.hasOwnProperty.call(t,r))return t[r];e=e.nodeType==Qs?e.ownerDocument:e.parentNode}return null},isDefaultNamespace:function(r){var e=this.lookupPrefix(r);return e==null}};function QE(r){return r=="<"&&"&lt;"||r==">"&&"&gt;"||r=="&"&&"&amp;"||r=='"'&&"&quot;"||"&#"+r.charCodeAt()+";"}So(Er,Ke);So(Er,Ke.prototype);function fo(r,e){if(e(r))return!0;if(r=r.firstChild)do if(fo(r,e))return!0;while(r=r.nextSibling)}function wo(){this.ownerDocument=this}function jA(r,e,t){r&&r._inc++;var n=t.namespaceURI;n===co.XMLNS&&(e._nsMap[t.prefix?t.localName:""]=t.value)}function JE(r,e,t,n){r&&r._inc++;var i=t.namespaceURI;i===co.XMLNS&&delete e._nsMap[t.prefix?t.localName:""]}function qd(r,e,t){if(r&&r._inc){r._inc++;var n=e.childNodes;if(t)n[n.length++]=t;else{for(var i=e.firstChild,s=0;i;)n[s++]=i,i=i.nextSibling;n.length=s,delete n[n.length]}}}function ex(r,e){var t=e.previousSibling,n=e.nextSibling;return t?t.nextSibling=n:r.firstChild=n,n?n.previousSibling=t:r.lastChild=t,e.parentNode=null,e.previousSibling=null,e.nextSibling=null,qd(r.ownerDocument,r),e}function KA(r){return r&&(r.nodeType===Ke.DOCUMENT_NODE||r.nodeType===Ke.DOCUMENT_FRAGMENT_NODE||r.nodeType===Ke.ELEMENT_NODE)}function qA(r){return r&&(Dn(r)||Yd(r)||Xn(r)||r.nodeType===Ke.DOCUMENT_FRAGMENT_NODE||r.nodeType===Ke.COMMENT_NODE||r.nodeType===Ke.PROCESSING_INSTRUCTION_NODE)}function Xn(r){return r&&r.nodeType===Ke.DOCUMENT_TYPE_NODE}function Dn(r){return r&&r.nodeType===Ke.ELEMENT_NODE}function Yd(r){return r&&r.nodeType===Ke.TEXT_NODE}function L0(r,e){var t=r.childNodes||[];if(bn(t,Dn)||Xn(e))return!1;var n=bn(t,Xn);return!(e&&n&&t.indexOf(n)>t.indexOf(e))}function I0(r,e){var t=r.childNodes||[];function n(s){return Dn(s)&&s!==e}if(bn(t,n))return!1;var i=bn(t,Xn);return!(e&&i&&t.indexOf(i)>t.indexOf(e))}function YA(r,e,t){if(!KA(r))throw new vt(fr,"Unexpected parent node type "+r.nodeType);if(t&&t.parentNode!==r)throw new vt(YE,"child not in parent");if(!qA(e)||Xn(e)&&r.nodeType!==Ke.DOCUMENT_NODE)throw new vt(fr,"Unexpected node type "+e.nodeType+" for parent node type "+r.nodeType)}function XA(r,e,t){var n=r.childNodes||[],i=e.childNodes||[];if(e.nodeType===Ke.DOCUMENT_FRAGMENT_NODE){var s=i.filter(Dn);if(s.length>1||bn(i,Yd))throw new vt(fr,"More than one element or text in fragment");if(s.length===1&&!L0(r,t))throw new vt(fr,"Element in fragment can not be inserted before doctype")}if(Dn(e)&&!L0(r,t))throw new vt(fr,"Only one element can be added and only after doctype");if(Xn(e)){if(bn(n,Xn))throw new vt(fr,"Only one doctype is allowed");var a=bn(n,Dn);if(t&&n.indexOf(a)<n.indexOf(t))throw new vt(fr,"Doctype can only be inserted before an element");if(!t&&a)throw new vt(fr,"Doctype can not be appended since element is present")}}function tx(r,e,t){var n=r.childNodes||[],i=e.childNodes||[];if(e.nodeType===Ke.DOCUMENT_FRAGMENT_NODE){var s=i.filter(Dn);if(s.length>1||bn(i,Yd))throw new vt(fr,"More than one element or text in fragment");if(s.length===1&&!I0(r,t))throw new vt(fr,"Element in fragment can not be inserted before doctype")}if(Dn(e)&&!I0(r,t))throw new vt(fr,"Only one element can be added and only after doctype");if(Xn(e)){let l=function(u){return Xn(u)&&u!==t};var o=l;if(bn(n,l))throw new vt(fr,"Only one doctype is allowed");var a=bn(n,Dn);if(t&&n.indexOf(a)<n.indexOf(t))throw new vt(fr,"Doctype can only be inserted before an element")}}function cu(r,e,t,n){YA(r,e,t),r.nodeType===Ke.DOCUMENT_NODE&&(n||XA)(r,e,t);var i=e.parentNode;if(i&&i.removeChild(e),e.nodeType===Yn){var s=e.firstChild;if(s==null)return e;var a=e.lastChild}else s=a=e;var o=t?t.previousSibling:r.lastChild;s.previousSibling=o,a.nextSibling=t,o?o.nextSibling=s:r.firstChild=s,t==null?r.lastChild=a:t.previousSibling=a;do s.parentNode=r;while(s!==a&&(s=s.nextSibling));return qd(r.ownerDocument||r,r),e.nodeType==Yn&&(e.firstChild=e.lastChild=null),e}function ZA(r,e){return e.parentNode&&e.parentNode.removeChild(e),e.parentNode=r,e.previousSibling=r.lastChild,e.nextSibling=null,e.previousSibling?e.previousSibling.nextSibling=e:r.firstChild=e,r.lastChild=e,qd(r.ownerDocument,r,e),e}wo.prototype={nodeName:"#document",nodeType:KE,doctype:null,documentElement:null,_inc:1,insertBefore:function(r,e){if(r.nodeType==Yn){for(var t=r.firstChild;t;){var n=t.nextSibling;this.insertBefore(t,e),t=n}return r}return cu(this,r,e),r.ownerDocument=this,this.documentElement===null&&r.nodeType===dn&&(this.documentElement=r),r},removeChild:function(r){return this.documentElement==r&&(this.documentElement=null),ex(this,r)},replaceChild:function(r,e){cu(this,r,e,tx),r.ownerDocument=this,e&&this.removeChild(e),Dn(r)&&(this.documentElement=r)},importNode:function(r,e){return ax(this,r,e)},getElementById:function(r){var e=null;return fo(this.documentElement,function(t){if(t.nodeType==dn&&t.getAttribute("id")==r)return e=t,!0}),e},getElementsByClassName:function(r){var e=b0(r);return new Js(this,function(t){var n=[];return e.length>0&&fo(t.documentElement,function(i){if(i!==t&&i.nodeType===dn){var s=i.getAttribute("class");if(s){var a=r===s;if(!a){var o=b0(s);a=e.every(GA(o))}a&&n.push(i)}}}),n})},createElement:function(r){var e=new Xi;e.ownerDocument=this,e.nodeName=r,e.tagName=r,e.localName=r,e.childNodes=new Wn;var t=e.attributes=new uu;return t._ownerElement=e,e},createDocumentFragment:function(){var r=new Nu;return r.ownerDocument=this,r.childNodes=new Wn,r},createTextNode:function(r){var e=new Xd;return e.ownerDocument=this,e.appendData(r),e},createComment:function(r){var e=new Zd;return e.ownerDocument=this,e.appendData(r),e},createCDATASection:function(r){var e=new Qd;return e.ownerDocument=this,e.appendData(r),e},createProcessingInstruction:function(r,e){var t=new ep;return t.ownerDocument=this,t.tagName=t.target=r,t.nodeValue=t.data=e,t},createAttribute:function(r){var e=new fu;return e.ownerDocument=this,e.name=r,e.nodeName=r,e.localName=r,e.specified=!0,e},createEntityReference:function(r){var e=new Jd;return e.ownerDocument=this,e.nodeName=r,e},createElementNS:function(r,e){var t=new Xi,n=e.split(":"),i=t.attributes=new uu;return t.childNodes=new Wn,t.ownerDocument=this,t.nodeName=e,t.tagName=e,t.namespaceURI=r,n.length==2?(t.prefix=n[0],t.localName=n[1]):t.localName=e,i._ownerElement=t,t},createAttributeNS:function(r,e){var t=new fu,n=e.split(":");return t.ownerDocument=this,t.nodeName=e,t.name=e,t.namespaceURI=r,t.specified=!0,n.length==2?(t.prefix=n[0],t.localName=n[1]):t.localName=e,t}};yr(wo,Ke);function Xi(){this._nsMap={}}Xi.prototype={nodeType:dn,hasAttribute:function(r){return this.getAttributeNode(r)!=null},getAttribute:function(r){var e=this.getAttributeNode(r);return e&&e.value||""},getAttributeNode:function(r){return this.attributes.getNamedItem(r)},setAttribute:function(r,e){var t=this.ownerDocument.createAttribute(r);t.value=t.nodeValue=""+e,this.setAttributeNode(t)},removeAttribute:function(r){var e=this.getAttributeNode(r);e&&this.removeAttributeNode(e)},appendChild:function(r){return r.nodeType===Yn?this.insertBefore(r,null):ZA(this,r)},setAttributeNode:function(r){return this.attributes.setNamedItem(r)},setAttributeNodeNS:function(r){return this.attributes.setNamedItemNS(r)},removeAttributeNode:function(r){return this.attributes.removeNamedItem(r.nodeName)},removeAttributeNS:function(r,e){var t=this.getAttributeNodeNS(r,e);t&&this.removeAttributeNode(t)},hasAttributeNS:function(r,e){return this.getAttributeNodeNS(r,e)!=null},getAttributeNS:function(r,e){var t=this.getAttributeNodeNS(r,e);return t&&t.value||""},setAttributeNS:function(r,e,t){var n=this.ownerDocument.createAttributeNS(r,e);n.value=n.nodeValue=""+t,this.setAttributeNode(n)},getAttributeNodeNS:function(r,e){return this.attributes.getNamedItemNS(r,e)},getElementsByTagName:function(r){return new Js(this,function(e){var t=[];return fo(e,function(n){n!==e&&n.nodeType==dn&&(r==="*"||n.tagName==r)&&t.push(n)}),t})},getElementsByTagNameNS:function(r,e){return new Js(this,function(t){var n=[];return fo(t,function(i){i!==t&&i.nodeType===dn&&(r==="*"||i.namespaceURI===r)&&(e==="*"||i.localName==e)&&n.push(i)}),n})}};wo.prototype.getElementsByTagName=Xi.prototype.getElementsByTagName;wo.prototype.getElementsByTagNameNS=Xi.prototype.getElementsByTagNameNS;yr(Xi,Ke);function fu(){}fu.prototype.nodeType=Qs;yr(fu,Ke);function _o(){}_o.prototype={data:"",substringData:function(r,e){return this.data.substring(r,r+e)},appendData:function(r){r=this.data+r,this.nodeValue=this.data=r,this.length=r.length},insertData:function(r,e){this.replaceData(r,0,e)},appendChild:function(r){throw new Error(It[fr])},deleteData:function(r,e){this.replaceData(r,e,"")},replaceData:function(r,e,t){var n=this.data.substring(0,r),i=this.data.substring(r+e);t=n+t+i,this.nodeValue=this.data=t,this.length=t.length}};yr(_o,Ke);function Xd(){}Xd.prototype={nodeName:"#text",nodeType:lu,splitText:function(r){var e=this.data,t=e.substring(r);e=e.substring(0,r),this.data=this.nodeValue=e,this.length=e.length;var n=this.ownerDocument.createTextNode(t);return this.parentNode&&this.parentNode.insertBefore(n,this.nextSibling),n}};yr(Xd,_o);function Zd(){}Zd.prototype={nodeName:"#comment",nodeType:jE};yr(Zd,_o);function Qd(){}Qd.prototype={nodeName:"#cdata-section",nodeType:GE};yr(Qd,_o);function Ou(){}Ou.prototype.nodeType=qE;yr(Ou,Ke);function rx(){}rx.prototype.nodeType=HA;yr(rx,Ke);function nx(){}nx.prototype.nodeType=WA;yr(nx,Ke);function Jd(){}Jd.prototype.nodeType=WE;yr(Jd,Ke);function Nu(){}Nu.prototype.nodeName="#document-fragment";Nu.prototype.nodeType=Yn;yr(Nu,Ke);function ep(){}ep.prototype.nodeType=HE;yr(ep,Ke);function ix(){}ix.prototype.serializeToString=function(r,e,t){return sx.call(r,e,t)};Ke.prototype.toString=sx;function sx(r,e){var t=[],n=this.nodeType==9&&this.documentElement||this,i=n.prefix,s=n.namespaceURI;if(s&&i==null){var i=n.lookupPrefix(s);if(i==null)var a=[{namespace:s,prefix:null}]}return Fs(this,t,r,e,a),t.join("")}function k0(r,e,t){var n=r.prefix||"",i=r.namespaceURI;if(!i||n==="xml"&&i===co.XML||i===co.XMLNS)return!1;for(var s=t.length;s--;){var a=t[s];if(a.prefix===n)return a.namespace!==i}return!0}function pf(r,e,t){r.push(" ",e,'="',t.replace(/[<&"]/g,QE),'"')}function Fs(r,e,t,n,i){if(i||(i=[]),n)if(r=n(r),r){if(typeof r=="string"){e.push(r);return}}else return;switch(r.nodeType){case dn:var s=r.attributes,a=s.length,g=r.firstChild,o=r.tagName;t=co.isHTML(r.namespaceURI)||t;var l=o;if(!t&&!r.prefix&&r.namespaceURI){for(var u,c=0;c<s.length;c++)if(s.item(c).name==="xmlns"){u=s.item(c).value;break}if(!u)for(var f=i.length-1;f>=0;f--){var h=i[f];if(h.prefix===""&&h.namespace===r.namespaceURI){u=h.namespace;break}}if(u!==r.namespaceURI)for(var f=i.length-1;f>=0;f--){var h=i[f];if(h.namespace===r.namespaceURI){h.prefix&&(l=h.prefix+":"+o);break}}}e.push("<",l);for(var d=0;d<a;d++){var m=s.item(d);m.prefix=="xmlns"?i.push({prefix:m.localName,namespace:m.value}):m.nodeName=="xmlns"&&i.push({prefix:"",namespace:m.value})}for(var d=0;d<a;d++){var m=s.item(d);if(k0(m,t,i)){var x=m.prefix||"",p=m.namespaceURI;pf(e,x?"xmlns:"+x:"xmlns",p),i.push({prefix:x,namespace:p})}Fs(m,e,t,n,i)}if(o===l&&k0(r,t,i)){var x=r.prefix||"",p=r.namespaceURI;pf(e,x?"xmlns:"+x:"xmlns",p),i.push({prefix:x,namespace:p})}if(g||t&&!/^(?:meta|link|img|br|hr|input)$/i.test(o)){if(e.push(">"),t&&/^script$/i.test(o))for(;g;)g.data?e.push(g.data):Fs(g,e,t,n,i.slice()),g=g.nextSibling;else for(;g;)Fs(g,e,t,n,i.slice()),g=g.nextSibling;e.push("</",l,">")}else e.push("/>");return;case KE:case Yn:for(var g=r.firstChild;g;)Fs(g,e,t,n,i.slice()),g=g.nextSibling;return;case Qs:return pf(e,r.name,r.value);case lu:return e.push(r.data.replace(/[<&]/g,QE).replace(/]]>/g,"]]&gt;"));case GE:return e.push("<![CDATA[",r.data,"]]>");case jE:return e.push("<!--",r.data,"-->");case qE:var v=r.publicId,E=r.systemId;if(e.push("<!DOCTYPE ",r.name),v)e.push(" PUBLIC ",v),E&&E!="."&&e.push(" ",E),e.push(">");else if(E&&E!=".")e.push(" SYSTEM ",E,">");else{var S=r.internalSubset;S&&e.push(" [",S,"]"),e.push(">")}return;case HE:return e.push("<?",r.target," ",r.data,"?>");case WE:return e.push("&",r.nodeName,";");default:e.push("??",r.nodeName)}}function ax(r,e,t){var n;switch(e.nodeType){case dn:n=e.cloneNode(!1),n.ownerDocument=r;case Yn:break;case Qs:t=!0;break}if(n||(n=e.cloneNode(!1)),n.ownerDocument=r,n.parentNode=null,t)for(var i=e.firstChild;i;)n.appendChild(ax(r,i,t)),i=i.nextSibling;return n}function Ah(r,e,t){var n=new e.constructor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var s=e[i];typeof s!="object"&&s!=n[i]&&(n[i]=s)}switch(e.childNodes&&(n.childNodes=new Wn),n.ownerDocument=r,n.nodeType){case dn:var a=e.attributes,o=n.attributes=new uu,l=a.length;o._ownerElement=n;for(var u=0;u<l;u++)n.setAttributeNode(Ah(r,a.item(u),!0));break;case Qs:t=!0}if(t)for(var c=e.firstChild;c;)n.appendChild(Ah(r,c,t)),c=c.nextSibling;return n}function ox(r,e,t){r[e]=t}try{if(Object.defineProperty){let r=function(t){switch(t.nodeType){case dn:case Yn:var n=[];for(t=t.firstChild;t;)t.nodeType!==7&&t.nodeType!==8&&n.push(r(t)),t=t.nextSibling;return n.join("");default:return t.nodeValue}};var LE=r;Object.defineProperty(Js.prototype,"length",{get:function(){return Kd(this),this.$$length}}),Object.defineProperty(Ke.prototype,"textContent",{get:function(){return r(this)},set:function(t){switch(this.nodeType){case dn:case Yn:for(;this.firstChild;)this.removeChild(this.firstChild);(t||String(t))&&this.appendChild(this.ownerDocument.createTextNode(t));break;default:this.data=t,this.value=t,this.nodeValue=t}}}),ox=function(t,n,i){t["$$"+n]=i}}}catch{}Qn.DocumentType=Ou;Qn.DOMException=vt;Qn.DOMImplementation=ZE;Qn.Element=Xi;Qn.Node=Ke;Qn.NodeList=Wn;Qn.XMLSerializer=ix;var Ao={},lx={};(function(r){var e=Ri.freeze;r.XML_ENTITIES=e({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),r.HTML_ENTITIES=e({Aacute:"\xC1",aacute:"\xE1",Abreve:"\u0102",abreve:"\u0103",ac:"\u223E",acd:"\u223F",acE:"\u223E\u0333",Acirc:"\xC2",acirc:"\xE2",acute:"\xB4",Acy:"\u0410",acy:"\u0430",AElig:"\xC6",aelig:"\xE6",af:"\u2061",Afr:"\u{1D504}",afr:"\u{1D51E}",Agrave:"\xC0",agrave:"\xE0",alefsym:"\u2135",aleph:"\u2135",Alpha:"\u0391",alpha:"\u03B1",Amacr:"\u0100",amacr:"\u0101",amalg:"\u2A3F",AMP:"&",amp:"&",And:"\u2A53",and:"\u2227",andand:"\u2A55",andd:"\u2A5C",andslope:"\u2A58",andv:"\u2A5A",ang:"\u2220",ange:"\u29A4",angle:"\u2220",angmsd:"\u2221",angmsdaa:"\u29A8",angmsdab:"\u29A9",angmsdac:"\u29AA",angmsdad:"\u29AB",angmsdae:"\u29AC",angmsdaf:"\u29AD",angmsdag:"\u29AE",angmsdah:"\u29AF",angrt:"\u221F",angrtvb:"\u22BE",angrtvbd:"\u299D",angsph:"\u2222",angst:"\xC5",angzarr:"\u237C",Aogon:"\u0104",aogon:"\u0105",Aopf:"\u{1D538}",aopf:"\u{1D552}",ap:"\u2248",apacir:"\u2A6F",apE:"\u2A70",ape:"\u224A",apid:"\u224B",apos:"'",ApplyFunction:"\u2061",approx:"\u2248",approxeq:"\u224A",Aring:"\xC5",aring:"\xE5",Ascr:"\u{1D49C}",ascr:"\u{1D4B6}",Assign:"\u2254",ast:"*",asymp:"\u2248",asympeq:"\u224D",Atilde:"\xC3",atilde:"\xE3",Auml:"\xC4",auml:"\xE4",awconint:"\u2233",awint:"\u2A11",backcong:"\u224C",backepsilon:"\u03F6",backprime:"\u2035",backsim:"\u223D",backsimeq:"\u22CD",Backslash:"\u2216",Barv:"\u2AE7",barvee:"\u22BD",Barwed:"\u2306",barwed:"\u2305",barwedge:"\u2305",bbrk:"\u23B5",bbrktbrk:"\u23B6",bcong:"\u224C",Bcy:"\u0411",bcy:"\u0431",bdquo:"\u201E",becaus:"\u2235",Because:"\u2235",because:"\u2235",bemptyv:"\u29B0",bepsi:"\u03F6",bernou:"\u212C",Bernoullis:"\u212C",Beta:"\u0392",beta:"\u03B2",beth:"\u2136",between:"\u226C",Bfr:"\u{1D505}",bfr:"\u{1D51F}",bigcap:"\u22C2",bigcirc:"\u25EF",bigcup:"\u22C3",bigodot:"\u2A00",bigoplus:"\u2A01",bigotimes:"\u2A02",bigsqcup:"\u2A06",bigstar:"\u2605",bigtriangledown:"\u25BD",bigtriangleup:"\u25B3",biguplus:"\u2A04",bigvee:"\u22C1",bigwedge:"\u22C0",bkarow:"\u290D",blacklozenge:"\u29EB",blacksquare:"\u25AA",blacktriangle:"\u25B4",blacktriangledown:"\u25BE",blacktriangleleft:"\u25C2",blacktriangleright:"\u25B8",blank:"\u2423",blk12:"\u2592",blk14:"\u2591",blk34:"\u2593",block:"\u2588",bne:"=\u20E5",bnequiv:"\u2261\u20E5",bNot:"\u2AED",bnot:"\u2310",Bopf:"\u{1D539}",bopf:"\u{1D553}",bot:"\u22A5",bottom:"\u22A5",bowtie:"\u22C8",boxbox:"\u29C9",boxDL:"\u2557",boxDl:"\u2556",boxdL:"\u2555",boxdl:"\u2510",boxDR:"\u2554",boxDr:"\u2553",boxdR:"\u2552",boxdr:"\u250C",boxH:"\u2550",boxh:"\u2500",boxHD:"\u2566",boxHd:"\u2564",boxhD:"\u2565",boxhd:"\u252C",boxHU:"\u2569",boxHu:"\u2567",boxhU:"\u2568",boxhu:"\u2534",boxminus:"\u229F",boxplus:"\u229E",boxtimes:"\u22A0",boxUL:"\u255D",boxUl:"\u255C",boxuL:"\u255B",boxul:"\u2518",boxUR:"\u255A",boxUr:"\u2559",boxuR:"\u2558",boxur:"\u2514",boxV:"\u2551",boxv:"\u2502",boxVH:"\u256C",boxVh:"\u256B",boxvH:"\u256A",boxvh:"\u253C",boxVL:"\u2563",boxVl:"\u2562",boxvL:"\u2561",boxvl:"\u2524",boxVR:"\u2560",boxVr:"\u255F",boxvR:"\u255E",boxvr:"\u251C",bprime:"\u2035",Breve:"\u02D8",breve:"\u02D8",brvbar:"\xA6",Bscr:"\u212C",bscr:"\u{1D4B7}",bsemi:"\u204F",bsim:"\u223D",bsime:"\u22CD",bsol:"\\",bsolb:"\u29C5",bsolhsub:"\u27C8",bull:"\u2022",bullet:"\u2022",bump:"\u224E",bumpE:"\u2AAE",bumpe:"\u224F",Bumpeq:"\u224E",bumpeq:"\u224F",Cacute:"\u0106",cacute:"\u0107",Cap:"\u22D2",cap:"\u2229",capand:"\u2A44",capbrcup:"\u2A49",capcap:"\u2A4B",capcup:"\u2A47",capdot:"\u2A40",CapitalDifferentialD:"\u2145",caps:"\u2229\uFE00",caret:"\u2041",caron:"\u02C7",Cayleys:"\u212D",ccaps:"\u2A4D",Ccaron:"\u010C",ccaron:"\u010D",Ccedil:"\xC7",ccedil:"\xE7",Ccirc:"\u0108",ccirc:"\u0109",Cconint:"\u2230",ccups:"\u2A4C",ccupssm:"\u2A50",Cdot:"\u010A",cdot:"\u010B",cedil:"\xB8",Cedilla:"\xB8",cemptyv:"\u29B2",cent:"\xA2",CenterDot:"\xB7",centerdot:"\xB7",Cfr:"\u212D",cfr:"\u{1D520}",CHcy:"\u0427",chcy:"\u0447",check:"\u2713",checkmark:"\u2713",Chi:"\u03A7",chi:"\u03C7",cir:"\u25CB",circ:"\u02C6",circeq:"\u2257",circlearrowleft:"\u21BA",circlearrowright:"\u21BB",circledast:"\u229B",circledcirc:"\u229A",circleddash:"\u229D",CircleDot:"\u2299",circledR:"\xAE",circledS:"\u24C8",CircleMinus:"\u2296",CirclePlus:"\u2295",CircleTimes:"\u2297",cirE:"\u29C3",cire:"\u2257",cirfnint:"\u2A10",cirmid:"\u2AEF",cirscir:"\u29C2",ClockwiseContourIntegral:"\u2232",CloseCurlyDoubleQuote:"\u201D",CloseCurlyQuote:"\u2019",clubs:"\u2663",clubsuit:"\u2663",Colon:"\u2237",colon:":",Colone:"\u2A74",colone:"\u2254",coloneq:"\u2254",comma:",",commat:"@",comp:"\u2201",compfn:"\u2218",complement:"\u2201",complexes:"\u2102",cong:"\u2245",congdot:"\u2A6D",Congruent:"\u2261",Conint:"\u222F",conint:"\u222E",ContourIntegral:"\u222E",Copf:"\u2102",copf:"\u{1D554}",coprod:"\u2210",Coproduct:"\u2210",COPY:"\xA9",copy:"\xA9",copysr:"\u2117",CounterClockwiseContourIntegral:"\u2233",crarr:"\u21B5",Cross:"\u2A2F",cross:"\u2717",Cscr:"\u{1D49E}",cscr:"\u{1D4B8}",csub:"\u2ACF",csube:"\u2AD1",csup:"\u2AD0",csupe:"\u2AD2",ctdot:"\u22EF",cudarrl:"\u2938",cudarrr:"\u2935",cuepr:"\u22DE",cuesc:"\u22DF",cularr:"\u21B6",cularrp:"\u293D",Cup:"\u22D3",cup:"\u222A",cupbrcap:"\u2A48",CupCap:"\u224D",cupcap:"\u2A46",cupcup:"\u2A4A",cupdot:"\u228D",cupor:"\u2A45",cups:"\u222A\uFE00",curarr:"\u21B7",curarrm:"\u293C",curlyeqprec:"\u22DE",curlyeqsucc:"\u22DF",curlyvee:"\u22CE",curlywedge:"\u22CF",curren:"\xA4",curvearrowleft:"\u21B6",curvearrowright:"\u21B7",cuvee:"\u22CE",cuwed:"\u22CF",cwconint:"\u2232",cwint:"\u2231",cylcty:"\u232D",Dagger:"\u2021",dagger:"\u2020",daleth:"\u2138",Darr:"\u21A1",dArr:"\u21D3",darr:"\u2193",dash:"\u2010",Dashv:"\u2AE4",dashv:"\u22A3",dbkarow:"\u290F",dblac:"\u02DD",Dcaron:"\u010E",dcaron:"\u010F",Dcy:"\u0414",dcy:"\u0434",DD:"\u2145",dd:"\u2146",ddagger:"\u2021",ddarr:"\u21CA",DDotrahd:"\u2911",ddotseq:"\u2A77",deg:"\xB0",Del:"\u2207",Delta:"\u0394",delta:"\u03B4",demptyv:"\u29B1",dfisht:"\u297F",Dfr:"\u{1D507}",dfr:"\u{1D521}",dHar:"\u2965",dharl:"\u21C3",dharr:"\u21C2",DiacriticalAcute:"\xB4",DiacriticalDot:"\u02D9",DiacriticalDoubleAcute:"\u02DD",DiacriticalGrave:"`",DiacriticalTilde:"\u02DC",diam:"\u22C4",Diamond:"\u22C4",diamond:"\u22C4",diamondsuit:"\u2666",diams:"\u2666",die:"\xA8",DifferentialD:"\u2146",digamma:"\u03DD",disin:"\u22F2",div:"\xF7",divide:"\xF7",divideontimes:"\u22C7",divonx:"\u22C7",DJcy:"\u0402",djcy:"\u0452",dlcorn:"\u231E",dlcrop:"\u230D",dollar:"$",Dopf:"\u{1D53B}",dopf:"\u{1D555}",Dot:"\xA8",dot:"\u02D9",DotDot:"\u20DC",doteq:"\u2250",doteqdot:"\u2251",DotEqual:"\u2250",dotminus:"\u2238",dotplus:"\u2214",dotsquare:"\u22A1",doublebarwedge:"\u2306",DoubleContourIntegral:"\u222F",DoubleDot:"\xA8",DoubleDownArrow:"\u21D3",DoubleLeftArrow:"\u21D0",DoubleLeftRightArrow:"\u21D4",DoubleLeftTee:"\u2AE4",DoubleLongLeftArrow:"\u27F8",DoubleLongLeftRightArrow:"\u27FA",DoubleLongRightArrow:"\u27F9",DoubleRightArrow:"\u21D2",DoubleRightTee:"\u22A8",DoubleUpArrow:"\u21D1",DoubleUpDownArrow:"\u21D5",DoubleVerticalBar:"\u2225",DownArrow:"\u2193",Downarrow:"\u21D3",downarrow:"\u2193",DownArrowBar:"\u2913",DownArrowUpArrow:"\u21F5",DownBreve:"\u0311",downdownarrows:"\u21CA",downharpoonleft:"\u21C3",downharpoonright:"\u21C2",DownLeftRightVector:"\u2950",DownLeftTeeVector:"\u295E",DownLeftVector:"\u21BD",DownLeftVectorBar:"\u2956",DownRightTeeVector:"\u295F",DownRightVector:"\u21C1",DownRightVectorBar:"\u2957",DownTee:"\u22A4",DownTeeArrow:"\u21A7",drbkarow:"\u2910",drcorn:"\u231F",drcrop:"\u230C",Dscr:"\u{1D49F}",dscr:"\u{1D4B9}",DScy:"\u0405",dscy:"\u0455",dsol:"\u29F6",Dstrok:"\u0110",dstrok:"\u0111",dtdot:"\u22F1",dtri:"\u25BF",dtrif:"\u25BE",duarr:"\u21F5",duhar:"\u296F",dwangle:"\u29A6",DZcy:"\u040F",dzcy:"\u045F",dzigrarr:"\u27FF",Eacute:"\xC9",eacute:"\xE9",easter:"\u2A6E",Ecaron:"\u011A",ecaron:"\u011B",ecir:"\u2256",Ecirc:"\xCA",ecirc:"\xEA",ecolon:"\u2255",Ecy:"\u042D",ecy:"\u044D",eDDot:"\u2A77",Edot:"\u0116",eDot:"\u2251",edot:"\u0117",ee:"\u2147",efDot:"\u2252",Efr:"\u{1D508}",efr:"\u{1D522}",eg:"\u2A9A",Egrave:"\xC8",egrave:"\xE8",egs:"\u2A96",egsdot:"\u2A98",el:"\u2A99",Element:"\u2208",elinters:"\u23E7",ell:"\u2113",els:"\u2A95",elsdot:"\u2A97",Emacr:"\u0112",emacr:"\u0113",empty:"\u2205",emptyset:"\u2205",EmptySmallSquare:"\u25FB",emptyv:"\u2205",EmptyVerySmallSquare:"\u25AB",emsp:"\u2003",emsp13:"\u2004",emsp14:"\u2005",ENG:"\u014A",eng:"\u014B",ensp:"\u2002",Eogon:"\u0118",eogon:"\u0119",Eopf:"\u{1D53C}",eopf:"\u{1D556}",epar:"\u22D5",eparsl:"\u29E3",eplus:"\u2A71",epsi:"\u03B5",Epsilon:"\u0395",epsilon:"\u03B5",epsiv:"\u03F5",eqcirc:"\u2256",eqcolon:"\u2255",eqsim:"\u2242",eqslantgtr:"\u2A96",eqslantless:"\u2A95",Equal:"\u2A75",equals:"=",EqualTilde:"\u2242",equest:"\u225F",Equilibrium:"\u21CC",equiv:"\u2261",equivDD:"\u2A78",eqvparsl:"\u29E5",erarr:"\u2971",erDot:"\u2253",Escr:"\u2130",escr:"\u212F",esdot:"\u2250",Esim:"\u2A73",esim:"\u2242",Eta:"\u0397",eta:"\u03B7",ETH:"\xD0",eth:"\xF0",Euml:"\xCB",euml:"\xEB",euro:"\u20AC",excl:"!",exist:"\u2203",Exists:"\u2203",expectation:"\u2130",ExponentialE:"\u2147",exponentiale:"\u2147",fallingdotseq:"\u2252",Fcy:"\u0424",fcy:"\u0444",female:"\u2640",ffilig:"\uFB03",fflig:"\uFB00",ffllig:"\uFB04",Ffr:"\u{1D509}",ffr:"\u{1D523}",filig:"\uFB01",FilledSmallSquare:"\u25FC",FilledVerySmallSquare:"\u25AA",fjlig:"fj",flat:"\u266D",fllig:"\uFB02",fltns:"\u25B1",fnof:"\u0192",Fopf:"\u{1D53D}",fopf:"\u{1D557}",ForAll:"\u2200",forall:"\u2200",fork:"\u22D4",forkv:"\u2AD9",Fouriertrf:"\u2131",fpartint:"\u2A0D",frac12:"\xBD",frac13:"\u2153",frac14:"\xBC",frac15:"\u2155",frac16:"\u2159",frac18:"\u215B",frac23:"\u2154",frac25:"\u2156",frac34:"\xBE",frac35:"\u2157",frac38:"\u215C",frac45:"\u2158",frac56:"\u215A",frac58:"\u215D",frac78:"\u215E",frasl:"\u2044",frown:"\u2322",Fscr:"\u2131",fscr:"\u{1D4BB}",gacute:"\u01F5",Gamma:"\u0393",gamma:"\u03B3",Gammad:"\u03DC",gammad:"\u03DD",gap:"\u2A86",Gbreve:"\u011E",gbreve:"\u011F",Gcedil:"\u0122",Gcirc:"\u011C",gcirc:"\u011D",Gcy:"\u0413",gcy:"\u0433",Gdot:"\u0120",gdot:"\u0121",gE:"\u2267",ge:"\u2265",gEl:"\u2A8C",gel:"\u22DB",geq:"\u2265",geqq:"\u2267",geqslant:"\u2A7E",ges:"\u2A7E",gescc:"\u2AA9",gesdot:"\u2A80",gesdoto:"\u2A82",gesdotol:"\u2A84",gesl:"\u22DB\uFE00",gesles:"\u2A94",Gfr:"\u{1D50A}",gfr:"\u{1D524}",Gg:"\u22D9",gg:"\u226B",ggg:"\u22D9",gimel:"\u2137",GJcy:"\u0403",gjcy:"\u0453",gl:"\u2277",gla:"\u2AA5",glE:"\u2A92",glj:"\u2AA4",gnap:"\u2A8A",gnapprox:"\u2A8A",gnE:"\u2269",gne:"\u2A88",gneq:"\u2A88",gneqq:"\u2269",gnsim:"\u22E7",Gopf:"\u{1D53E}",gopf:"\u{1D558}",grave:"`",GreaterEqual:"\u2265",GreaterEqualLess:"\u22DB",GreaterFullEqual:"\u2267",GreaterGreater:"\u2AA2",GreaterLess:"\u2277",GreaterSlantEqual:"\u2A7E",GreaterTilde:"\u2273",Gscr:"\u{1D4A2}",gscr:"\u210A",gsim:"\u2273",gsime:"\u2A8E",gsiml:"\u2A90",Gt:"\u226B",GT:">",gt:">",gtcc:"\u2AA7",gtcir:"\u2A7A",gtdot:"\u22D7",gtlPar:"\u2995",gtquest:"\u2A7C",gtrapprox:"\u2A86",gtrarr:"\u2978",gtrdot:"\u22D7",gtreqless:"\u22DB",gtreqqless:"\u2A8C",gtrless:"\u2277",gtrsim:"\u2273",gvertneqq:"\u2269\uFE00",gvnE:"\u2269\uFE00",Hacek:"\u02C7",hairsp:"\u200A",half:"\xBD",hamilt:"\u210B",HARDcy:"\u042A",hardcy:"\u044A",hArr:"\u21D4",harr:"\u2194",harrcir:"\u2948",harrw:"\u21AD",Hat:"^",hbar:"\u210F",Hcirc:"\u0124",hcirc:"\u0125",hearts:"\u2665",heartsuit:"\u2665",hellip:"\u2026",hercon:"\u22B9",Hfr:"\u210C",hfr:"\u{1D525}",HilbertSpace:"\u210B",hksearow:"\u2925",hkswarow:"\u2926",hoarr:"\u21FF",homtht:"\u223B",hookleftarrow:"\u21A9",hookrightarrow:"\u21AA",Hopf:"\u210D",hopf:"\u{1D559}",horbar:"\u2015",HorizontalLine:"\u2500",Hscr:"\u210B",hscr:"\u{1D4BD}",hslash:"\u210F",Hstrok:"\u0126",hstrok:"\u0127",HumpDownHump:"\u224E",HumpEqual:"\u224F",hybull:"\u2043",hyphen:"\u2010",Iacute:"\xCD",iacute:"\xED",ic:"\u2063",Icirc:"\xCE",icirc:"\xEE",Icy:"\u0418",icy:"\u0438",Idot:"\u0130",IEcy:"\u0415",iecy:"\u0435",iexcl:"\xA1",iff:"\u21D4",Ifr:"\u2111",ifr:"\u{1D526}",Igrave:"\xCC",igrave:"\xEC",ii:"\u2148",iiiint:"\u2A0C",iiint:"\u222D",iinfin:"\u29DC",iiota:"\u2129",IJlig:"\u0132",ijlig:"\u0133",Im:"\u2111",Imacr:"\u012A",imacr:"\u012B",image:"\u2111",ImaginaryI:"\u2148",imagline:"\u2110",imagpart:"\u2111",imath:"\u0131",imof:"\u22B7",imped:"\u01B5",Implies:"\u21D2",in:"\u2208",incare:"\u2105",infin:"\u221E",infintie:"\u29DD",inodot:"\u0131",Int:"\u222C",int:"\u222B",intcal:"\u22BA",integers:"\u2124",Integral:"\u222B",intercal:"\u22BA",Intersection:"\u22C2",intlarhk:"\u2A17",intprod:"\u2A3C",InvisibleComma:"\u2063",InvisibleTimes:"\u2062",IOcy:"\u0401",iocy:"\u0451",Iogon:"\u012E",iogon:"\u012F",Iopf:"\u{1D540}",iopf:"\u{1D55A}",Iota:"\u0399",iota:"\u03B9",iprod:"\u2A3C",iquest:"\xBF",Iscr:"\u2110",iscr:"\u{1D4BE}",isin:"\u2208",isindot:"\u22F5",isinE:"\u22F9",isins:"\u22F4",isinsv:"\u22F3",isinv:"\u2208",it:"\u2062",Itilde:"\u0128",itilde:"\u0129",Iukcy:"\u0406",iukcy:"\u0456",Iuml:"\xCF",iuml:"\xEF",Jcirc:"\u0134",jcirc:"\u0135",Jcy:"\u0419",jcy:"\u0439",Jfr:"\u{1D50D}",jfr:"\u{1D527}",jmath:"\u0237",Jopf:"\u{1D541}",jopf:"\u{1D55B}",Jscr:"\u{1D4A5}",jscr:"\u{1D4BF}",Jsercy:"\u0408",jsercy:"\u0458",Jukcy:"\u0404",jukcy:"\u0454",Kappa:"\u039A",kappa:"\u03BA",kappav:"\u03F0",Kcedil:"\u0136",kcedil:"\u0137",Kcy:"\u041A",kcy:"\u043A",Kfr:"\u{1D50E}",kfr:"\u{1D528}",kgreen:"\u0138",KHcy:"\u0425",khcy:"\u0445",KJcy:"\u040C",kjcy:"\u045C",Kopf:"\u{1D542}",kopf:"\u{1D55C}",Kscr:"\u{1D4A6}",kscr:"\u{1D4C0}",lAarr:"\u21DA",Lacute:"\u0139",lacute:"\u013A",laemptyv:"\u29B4",lagran:"\u2112",Lambda:"\u039B",lambda:"\u03BB",Lang:"\u27EA",lang:"\u27E8",langd:"\u2991",langle:"\u27E8",lap:"\u2A85",Laplacetrf:"\u2112",laquo:"\xAB",Larr:"\u219E",lArr:"\u21D0",larr:"\u2190",larrb:"\u21E4",larrbfs:"\u291F",larrfs:"\u291D",larrhk:"\u21A9",larrlp:"\u21AB",larrpl:"\u2939",larrsim:"\u2973",larrtl:"\u21A2",lat:"\u2AAB",lAtail:"\u291B",latail:"\u2919",late:"\u2AAD",lates:"\u2AAD\uFE00",lBarr:"\u290E",lbarr:"\u290C",lbbrk:"\u2772",lbrace:"{",lbrack:"[",lbrke:"\u298B",lbrksld:"\u298F",lbrkslu:"\u298D",Lcaron:"\u013D",lcaron:"\u013E",Lcedil:"\u013B",lcedil:"\u013C",lceil:"\u2308",lcub:"{",Lcy:"\u041B",lcy:"\u043B",ldca:"\u2936",ldquo:"\u201C",ldquor:"\u201E",ldrdhar:"\u2967",ldrushar:"\u294B",ldsh:"\u21B2",lE:"\u2266",le:"\u2264",LeftAngleBracket:"\u27E8",LeftArrow:"\u2190",Leftarrow:"\u21D0",leftarrow:"\u2190",LeftArrowBar:"\u21E4",LeftArrowRightArrow:"\u21C6",leftarrowtail:"\u21A2",LeftCeiling:"\u2308",LeftDoubleBracket:"\u27E6",LeftDownTeeVector:"\u2961",LeftDownVector:"\u21C3",LeftDownVectorBar:"\u2959",LeftFloor:"\u230A",leftharpoondown:"\u21BD",leftharpoonup:"\u21BC",leftleftarrows:"\u21C7",LeftRightArrow:"\u2194",Leftrightarrow:"\u21D4",leftrightarrow:"\u2194",leftrightarrows:"\u21C6",leftrightharpoons:"\u21CB",leftrightsquigarrow:"\u21AD",LeftRightVector:"\u294E",LeftTee:"\u22A3",LeftTeeArrow:"\u21A4",LeftTeeVector:"\u295A",leftthreetimes:"\u22CB",LeftTriangle:"\u22B2",LeftTriangleBar:"\u29CF",LeftTriangleEqual:"\u22B4",LeftUpDownVector:"\u2951",LeftUpTeeVector:"\u2960",LeftUpVector:"\u21BF",LeftUpVectorBar:"\u2958",LeftVector:"\u21BC",LeftVectorBar:"\u2952",lEg:"\u2A8B",leg:"\u22DA",leq:"\u2264",leqq:"\u2266",leqslant:"\u2A7D",les:"\u2A7D",lescc:"\u2AA8",lesdot:"\u2A7F",lesdoto:"\u2A81",lesdotor:"\u2A83",lesg:"\u22DA\uFE00",lesges:"\u2A93",lessapprox:"\u2A85",lessdot:"\u22D6",lesseqgtr:"\u22DA",lesseqqgtr:"\u2A8B",LessEqualGreater:"\u22DA",LessFullEqual:"\u2266",LessGreater:"\u2276",lessgtr:"\u2276",LessLess:"\u2AA1",lesssim:"\u2272",LessSlantEqual:"\u2A7D",LessTilde:"\u2272",lfisht:"\u297C",lfloor:"\u230A",Lfr:"\u{1D50F}",lfr:"\u{1D529}",lg:"\u2276",lgE:"\u2A91",lHar:"\u2962",lhard:"\u21BD",lharu:"\u21BC",lharul:"\u296A",lhblk:"\u2584",LJcy:"\u0409",ljcy:"\u0459",Ll:"\u22D8",ll:"\u226A",llarr:"\u21C7",llcorner:"\u231E",Lleftarrow:"\u21DA",llhard:"\u296B",lltri:"\u25FA",Lmidot:"\u013F",lmidot:"\u0140",lmoust:"\u23B0",lmoustache:"\u23B0",lnap:"\u2A89",lnapprox:"\u2A89",lnE:"\u2268",lne:"\u2A87",lneq:"\u2A87",lneqq:"\u2268",lnsim:"\u22E6",loang:"\u27EC",loarr:"\u21FD",lobrk:"\u27E6",LongLeftArrow:"\u27F5",Longleftarrow:"\u27F8",longleftarrow:"\u27F5",LongLeftRightArrow:"\u27F7",Longleftrightarrow:"\u27FA",longleftrightarrow:"\u27F7",longmapsto:"\u27FC",LongRightArrow:"\u27F6",Longrightarrow:"\u27F9",longrightarrow:"\u27F6",looparrowleft:"\u21AB",looparrowright:"\u21AC",lopar:"\u2985",Lopf:"\u{1D543}",lopf:"\u{1D55D}",loplus:"\u2A2D",lotimes:"\u2A34",lowast:"\u2217",lowbar:"_",LowerLeftArrow:"\u2199",LowerRightArrow:"\u2198",loz:"\u25CA",lozenge:"\u25CA",lozf:"\u29EB",lpar:"(",lparlt:"\u2993",lrarr:"\u21C6",lrcorner:"\u231F",lrhar:"\u21CB",lrhard:"\u296D",lrm:"\u200E",lrtri:"\u22BF",lsaquo:"\u2039",Lscr:"\u2112",lscr:"\u{1D4C1}",Lsh:"\u21B0",lsh:"\u21B0",lsim:"\u2272",lsime:"\u2A8D",lsimg:"\u2A8F",lsqb:"[",lsquo:"\u2018",lsquor:"\u201A",Lstrok:"\u0141",lstrok:"\u0142",Lt:"\u226A",LT:"<",lt:"<",ltcc:"\u2AA6",ltcir:"\u2A79",ltdot:"\u22D6",lthree:"\u22CB",ltimes:"\u22C9",ltlarr:"\u2976",ltquest:"\u2A7B",ltri:"\u25C3",ltrie:"\u22B4",ltrif:"\u25C2",ltrPar:"\u2996",lurdshar:"\u294A",luruhar:"\u2966",lvertneqq:"\u2268\uFE00",lvnE:"\u2268\uFE00",macr:"\xAF",male:"\u2642",malt:"\u2720",maltese:"\u2720",Map:"\u2905",map:"\u21A6",mapsto:"\u21A6",mapstodown:"\u21A7",mapstoleft:"\u21A4",mapstoup:"\u21A5",marker:"\u25AE",mcomma:"\u2A29",Mcy:"\u041C",mcy:"\u043C",mdash:"\u2014",mDDot:"\u223A",measuredangle:"\u2221",MediumSpace:"\u205F",Mellintrf:"\u2133",Mfr:"\u{1D510}",mfr:"\u{1D52A}",mho:"\u2127",micro:"\xB5",mid:"\u2223",midast:"*",midcir:"\u2AF0",middot:"\xB7",minus:"\u2212",minusb:"\u229F",minusd:"\u2238",minusdu:"\u2A2A",MinusPlus:"\u2213",mlcp:"\u2ADB",mldr:"\u2026",mnplus:"\u2213",models:"\u22A7",Mopf:"\u{1D544}",mopf:"\u{1D55E}",mp:"\u2213",Mscr:"\u2133",mscr:"\u{1D4C2}",mstpos:"\u223E",Mu:"\u039C",mu:"\u03BC",multimap:"\u22B8",mumap:"\u22B8",nabla:"\u2207",Nacute:"\u0143",nacute:"\u0144",nang:"\u2220\u20D2",nap:"\u2249",napE:"\u2A70\u0338",napid:"\u224B\u0338",napos:"\u0149",napprox:"\u2249",natur:"\u266E",natural:"\u266E",naturals:"\u2115",nbsp:"\xA0",nbump:"\u224E\u0338",nbumpe:"\u224F\u0338",ncap:"\u2A43",Ncaron:"\u0147",ncaron:"\u0148",Ncedil:"\u0145",ncedil:"\u0146",ncong:"\u2247",ncongdot:"\u2A6D\u0338",ncup:"\u2A42",Ncy:"\u041D",ncy:"\u043D",ndash:"\u2013",ne:"\u2260",nearhk:"\u2924",neArr:"\u21D7",nearr:"\u2197",nearrow:"\u2197",nedot:"\u2250\u0338",NegativeMediumSpace:"\u200B",NegativeThickSpace:"\u200B",NegativeThinSpace:"\u200B",NegativeVeryThinSpace:"\u200B",nequiv:"\u2262",nesear:"\u2928",nesim:"\u2242\u0338",NestedGreaterGreater:"\u226B",NestedLessLess:"\u226A",NewLine:`
`,nexist:"\u2204",nexists:"\u2204",Nfr:"\u{1D511}",nfr:"\u{1D52B}",ngE:"\u2267\u0338",nge:"\u2271",ngeq:"\u2271",ngeqq:"\u2267\u0338",ngeqslant:"\u2A7E\u0338",nges:"\u2A7E\u0338",nGg:"\u22D9\u0338",ngsim:"\u2275",nGt:"\u226B\u20D2",ngt:"\u226F",ngtr:"\u226F",nGtv:"\u226B\u0338",nhArr:"\u21CE",nharr:"\u21AE",nhpar:"\u2AF2",ni:"\u220B",nis:"\u22FC",nisd:"\u22FA",niv:"\u220B",NJcy:"\u040A",njcy:"\u045A",nlArr:"\u21CD",nlarr:"\u219A",nldr:"\u2025",nlE:"\u2266\u0338",nle:"\u2270",nLeftarrow:"\u21CD",nleftarrow:"\u219A",nLeftrightarrow:"\u21CE",nleftrightarrow:"\u21AE",nleq:"\u2270",nleqq:"\u2266\u0338",nleqslant:"\u2A7D\u0338",nles:"\u2A7D\u0338",nless:"\u226E",nLl:"\u22D8\u0338",nlsim:"\u2274",nLt:"\u226A\u20D2",nlt:"\u226E",nltri:"\u22EA",nltrie:"\u22EC",nLtv:"\u226A\u0338",nmid:"\u2224",NoBreak:"\u2060",NonBreakingSpace:"\xA0",Nopf:"\u2115",nopf:"\u{1D55F}",Not:"\u2AEC",not:"\xAC",NotCongruent:"\u2262",NotCupCap:"\u226D",NotDoubleVerticalBar:"\u2226",NotElement:"\u2209",NotEqual:"\u2260",NotEqualTilde:"\u2242\u0338",NotExists:"\u2204",NotGreater:"\u226F",NotGreaterEqual:"\u2271",NotGreaterFullEqual:"\u2267\u0338",NotGreaterGreater:"\u226B\u0338",NotGreaterLess:"\u2279",NotGreaterSlantEqual:"\u2A7E\u0338",NotGreaterTilde:"\u2275",NotHumpDownHump:"\u224E\u0338",NotHumpEqual:"\u224F\u0338",notin:"\u2209",notindot:"\u22F5\u0338",notinE:"\u22F9\u0338",notinva:"\u2209",notinvb:"\u22F7",notinvc:"\u22F6",NotLeftTriangle:"\u22EA",NotLeftTriangleBar:"\u29CF\u0338",NotLeftTriangleEqual:"\u22EC",NotLess:"\u226E",NotLessEqual:"\u2270",NotLessGreater:"\u2278",NotLessLess:"\u226A\u0338",NotLessSlantEqual:"\u2A7D\u0338",NotLessTilde:"\u2274",NotNestedGreaterGreater:"\u2AA2\u0338",NotNestedLessLess:"\u2AA1\u0338",notni:"\u220C",notniva:"\u220C",notnivb:"\u22FE",notnivc:"\u22FD",NotPrecedes:"\u2280",NotPrecedesEqual:"\u2AAF\u0338",NotPrecedesSlantEqual:"\u22E0",NotReverseElement:"\u220C",NotRightTriangle:"\u22EB",NotRightTriangleBar:"\u29D0\u0338",NotRightTriangleEqual:"\u22ED",NotSquareSubset:"\u228F\u0338",NotSquareSubsetEqual:"\u22E2",NotSquareSuperset:"\u2290\u0338",NotSquareSupersetEqual:"\u22E3",NotSubset:"\u2282\u20D2",NotSubsetEqual:"\u2288",NotSucceeds:"\u2281",NotSucceedsEqual:"\u2AB0\u0338",NotSucceedsSlantEqual:"\u22E1",NotSucceedsTilde:"\u227F\u0338",NotSuperset:"\u2283\u20D2",NotSupersetEqual:"\u2289",NotTilde:"\u2241",NotTildeEqual:"\u2244",NotTildeFullEqual:"\u2247",NotTildeTilde:"\u2249",NotVerticalBar:"\u2224",npar:"\u2226",nparallel:"\u2226",nparsl:"\u2AFD\u20E5",npart:"\u2202\u0338",npolint:"\u2A14",npr:"\u2280",nprcue:"\u22E0",npre:"\u2AAF\u0338",nprec:"\u2280",npreceq:"\u2AAF\u0338",nrArr:"\u21CF",nrarr:"\u219B",nrarrc:"\u2933\u0338",nrarrw:"\u219D\u0338",nRightarrow:"\u21CF",nrightarrow:"\u219B",nrtri:"\u22EB",nrtrie:"\u22ED",nsc:"\u2281",nsccue:"\u22E1",nsce:"\u2AB0\u0338",Nscr:"\u{1D4A9}",nscr:"\u{1D4C3}",nshortmid:"\u2224",nshortparallel:"\u2226",nsim:"\u2241",nsime:"\u2244",nsimeq:"\u2244",nsmid:"\u2224",nspar:"\u2226",nsqsube:"\u22E2",nsqsupe:"\u22E3",nsub:"\u2284",nsubE:"\u2AC5\u0338",nsube:"\u2288",nsubset:"\u2282\u20D2",nsubseteq:"\u2288",nsubseteqq:"\u2AC5\u0338",nsucc:"\u2281",nsucceq:"\u2AB0\u0338",nsup:"\u2285",nsupE:"\u2AC6\u0338",nsupe:"\u2289",nsupset:"\u2283\u20D2",nsupseteq:"\u2289",nsupseteqq:"\u2AC6\u0338",ntgl:"\u2279",Ntilde:"\xD1",ntilde:"\xF1",ntlg:"\u2278",ntriangleleft:"\u22EA",ntrianglelefteq:"\u22EC",ntriangleright:"\u22EB",ntrianglerighteq:"\u22ED",Nu:"\u039D",nu:"\u03BD",num:"#",numero:"\u2116",numsp:"\u2007",nvap:"\u224D\u20D2",nVDash:"\u22AF",nVdash:"\u22AE",nvDash:"\u22AD",nvdash:"\u22AC",nvge:"\u2265\u20D2",nvgt:">\u20D2",nvHarr:"\u2904",nvinfin:"\u29DE",nvlArr:"\u2902",nvle:"\u2264\u20D2",nvlt:"<\u20D2",nvltrie:"\u22B4\u20D2",nvrArr:"\u2903",nvrtrie:"\u22B5\u20D2",nvsim:"\u223C\u20D2",nwarhk:"\u2923",nwArr:"\u21D6",nwarr:"\u2196",nwarrow:"\u2196",nwnear:"\u2927",Oacute:"\xD3",oacute:"\xF3",oast:"\u229B",ocir:"\u229A",Ocirc:"\xD4",ocirc:"\xF4",Ocy:"\u041E",ocy:"\u043E",odash:"\u229D",Odblac:"\u0150",odblac:"\u0151",odiv:"\u2A38",odot:"\u2299",odsold:"\u29BC",OElig:"\u0152",oelig:"\u0153",ofcir:"\u29BF",Ofr:"\u{1D512}",ofr:"\u{1D52C}",ogon:"\u02DB",Ograve:"\xD2",ograve:"\xF2",ogt:"\u29C1",ohbar:"\u29B5",ohm:"\u03A9",oint:"\u222E",olarr:"\u21BA",olcir:"\u29BE",olcross:"\u29BB",oline:"\u203E",olt:"\u29C0",Omacr:"\u014C",omacr:"\u014D",Omega:"\u03A9",omega:"\u03C9",Omicron:"\u039F",omicron:"\u03BF",omid:"\u29B6",ominus:"\u2296",Oopf:"\u{1D546}",oopf:"\u{1D560}",opar:"\u29B7",OpenCurlyDoubleQuote:"\u201C",OpenCurlyQuote:"\u2018",operp:"\u29B9",oplus:"\u2295",Or:"\u2A54",or:"\u2228",orarr:"\u21BB",ord:"\u2A5D",order:"\u2134",orderof:"\u2134",ordf:"\xAA",ordm:"\xBA",origof:"\u22B6",oror:"\u2A56",orslope:"\u2A57",orv:"\u2A5B",oS:"\u24C8",Oscr:"\u{1D4AA}",oscr:"\u2134",Oslash:"\xD8",oslash:"\xF8",osol:"\u2298",Otilde:"\xD5",otilde:"\xF5",Otimes:"\u2A37",otimes:"\u2297",otimesas:"\u2A36",Ouml:"\xD6",ouml:"\xF6",ovbar:"\u233D",OverBar:"\u203E",OverBrace:"\u23DE",OverBracket:"\u23B4",OverParenthesis:"\u23DC",par:"\u2225",para:"\xB6",parallel:"\u2225",parsim:"\u2AF3",parsl:"\u2AFD",part:"\u2202",PartialD:"\u2202",Pcy:"\u041F",pcy:"\u043F",percnt:"%",period:".",permil:"\u2030",perp:"\u22A5",pertenk:"\u2031",Pfr:"\u{1D513}",pfr:"\u{1D52D}",Phi:"\u03A6",phi:"\u03C6",phiv:"\u03D5",phmmat:"\u2133",phone:"\u260E",Pi:"\u03A0",pi:"\u03C0",pitchfork:"\u22D4",piv:"\u03D6",planck:"\u210F",planckh:"\u210E",plankv:"\u210F",plus:"+",plusacir:"\u2A23",plusb:"\u229E",pluscir:"\u2A22",plusdo:"\u2214",plusdu:"\u2A25",pluse:"\u2A72",PlusMinus:"\xB1",plusmn:"\xB1",plussim:"\u2A26",plustwo:"\u2A27",pm:"\xB1",Poincareplane:"\u210C",pointint:"\u2A15",Popf:"\u2119",popf:"\u{1D561}",pound:"\xA3",Pr:"\u2ABB",pr:"\u227A",prap:"\u2AB7",prcue:"\u227C",prE:"\u2AB3",pre:"\u2AAF",prec:"\u227A",precapprox:"\u2AB7",preccurlyeq:"\u227C",Precedes:"\u227A",PrecedesEqual:"\u2AAF",PrecedesSlantEqual:"\u227C",PrecedesTilde:"\u227E",preceq:"\u2AAF",precnapprox:"\u2AB9",precneqq:"\u2AB5",precnsim:"\u22E8",precsim:"\u227E",Prime:"\u2033",prime:"\u2032",primes:"\u2119",prnap:"\u2AB9",prnE:"\u2AB5",prnsim:"\u22E8",prod:"\u220F",Product:"\u220F",profalar:"\u232E",profline:"\u2312",profsurf:"\u2313",prop:"\u221D",Proportion:"\u2237",Proportional:"\u221D",propto:"\u221D",prsim:"\u227E",prurel:"\u22B0",Pscr:"\u{1D4AB}",pscr:"\u{1D4C5}",Psi:"\u03A8",psi:"\u03C8",puncsp:"\u2008",Qfr:"\u{1D514}",qfr:"\u{1D52E}",qint:"\u2A0C",Qopf:"\u211A",qopf:"\u{1D562}",qprime:"\u2057",Qscr:"\u{1D4AC}",qscr:"\u{1D4C6}",quaternions:"\u210D",quatint:"\u2A16",quest:"?",questeq:"\u225F",QUOT:'"',quot:'"',rAarr:"\u21DB",race:"\u223D\u0331",Racute:"\u0154",racute:"\u0155",radic:"\u221A",raemptyv:"\u29B3",Rang:"\u27EB",rang:"\u27E9",rangd:"\u2992",range:"\u29A5",rangle:"\u27E9",raquo:"\xBB",Rarr:"\u21A0",rArr:"\u21D2",rarr:"\u2192",rarrap:"\u2975",rarrb:"\u21E5",rarrbfs:"\u2920",rarrc:"\u2933",rarrfs:"\u291E",rarrhk:"\u21AA",rarrlp:"\u21AC",rarrpl:"\u2945",rarrsim:"\u2974",Rarrtl:"\u2916",rarrtl:"\u21A3",rarrw:"\u219D",rAtail:"\u291C",ratail:"\u291A",ratio:"\u2236",rationals:"\u211A",RBarr:"\u2910",rBarr:"\u290F",rbarr:"\u290D",rbbrk:"\u2773",rbrace:"}",rbrack:"]",rbrke:"\u298C",rbrksld:"\u298E",rbrkslu:"\u2990",Rcaron:"\u0158",rcaron:"\u0159",Rcedil:"\u0156",rcedil:"\u0157",rceil:"\u2309",rcub:"}",Rcy:"\u0420",rcy:"\u0440",rdca:"\u2937",rdldhar:"\u2969",rdquo:"\u201D",rdquor:"\u201D",rdsh:"\u21B3",Re:"\u211C",real:"\u211C",realine:"\u211B",realpart:"\u211C",reals:"\u211D",rect:"\u25AD",REG:"\xAE",reg:"\xAE",ReverseElement:"\u220B",ReverseEquilibrium:"\u21CB",ReverseUpEquilibrium:"\u296F",rfisht:"\u297D",rfloor:"\u230B",Rfr:"\u211C",rfr:"\u{1D52F}",rHar:"\u2964",rhard:"\u21C1",rharu:"\u21C0",rharul:"\u296C",Rho:"\u03A1",rho:"\u03C1",rhov:"\u03F1",RightAngleBracket:"\u27E9",RightArrow:"\u2192",Rightarrow:"\u21D2",rightarrow:"\u2192",RightArrowBar:"\u21E5",RightArrowLeftArrow:"\u21C4",rightarrowtail:"\u21A3",RightCeiling:"\u2309",RightDoubleBracket:"\u27E7",RightDownTeeVector:"\u295D",RightDownVector:"\u21C2",RightDownVectorBar:"\u2955",RightFloor:"\u230B",rightharpoondown:"\u21C1",rightharpoonup:"\u21C0",rightleftarrows:"\u21C4",rightleftharpoons:"\u21CC",rightrightarrows:"\u21C9",rightsquigarrow:"\u219D",RightTee:"\u22A2",RightTeeArrow:"\u21A6",RightTeeVector:"\u295B",rightthreetimes:"\u22CC",RightTriangle:"\u22B3",RightTriangleBar:"\u29D0",RightTriangleEqual:"\u22B5",RightUpDownVector:"\u294F",RightUpTeeVector:"\u295C",RightUpVector:"\u21BE",RightUpVectorBar:"\u2954",RightVector:"\u21C0",RightVectorBar:"\u2953",ring:"\u02DA",risingdotseq:"\u2253",rlarr:"\u21C4",rlhar:"\u21CC",rlm:"\u200F",rmoust:"\u23B1",rmoustache:"\u23B1",rnmid:"\u2AEE",roang:"\u27ED",roarr:"\u21FE",robrk:"\u27E7",ropar:"\u2986",Ropf:"\u211D",ropf:"\u{1D563}",roplus:"\u2A2E",rotimes:"\u2A35",RoundImplies:"\u2970",rpar:")",rpargt:"\u2994",rppolint:"\u2A12",rrarr:"\u21C9",Rrightarrow:"\u21DB",rsaquo:"\u203A",Rscr:"\u211B",rscr:"\u{1D4C7}",Rsh:"\u21B1",rsh:"\u21B1",rsqb:"]",rsquo:"\u2019",rsquor:"\u2019",rthree:"\u22CC",rtimes:"\u22CA",rtri:"\u25B9",rtrie:"\u22B5",rtrif:"\u25B8",rtriltri:"\u29CE",RuleDelayed:"\u29F4",ruluhar:"\u2968",rx:"\u211E",Sacute:"\u015A",sacute:"\u015B",sbquo:"\u201A",Sc:"\u2ABC",sc:"\u227B",scap:"\u2AB8",Scaron:"\u0160",scaron:"\u0161",sccue:"\u227D",scE:"\u2AB4",sce:"\u2AB0",Scedil:"\u015E",scedil:"\u015F",Scirc:"\u015C",scirc:"\u015D",scnap:"\u2ABA",scnE:"\u2AB6",scnsim:"\u22E9",scpolint:"\u2A13",scsim:"\u227F",Scy:"\u0421",scy:"\u0441",sdot:"\u22C5",sdotb:"\u22A1",sdote:"\u2A66",searhk:"\u2925",seArr:"\u21D8",searr:"\u2198",searrow:"\u2198",sect:"\xA7",semi:";",seswar:"\u2929",setminus:"\u2216",setmn:"\u2216",sext:"\u2736",Sfr:"\u{1D516}",sfr:"\u{1D530}",sfrown:"\u2322",sharp:"\u266F",SHCHcy:"\u0429",shchcy:"\u0449",SHcy:"\u0428",shcy:"\u0448",ShortDownArrow:"\u2193",ShortLeftArrow:"\u2190",shortmid:"\u2223",shortparallel:"\u2225",ShortRightArrow:"\u2192",ShortUpArrow:"\u2191",shy:"\xAD",Sigma:"\u03A3",sigma:"\u03C3",sigmaf:"\u03C2",sigmav:"\u03C2",sim:"\u223C",simdot:"\u2A6A",sime:"\u2243",simeq:"\u2243",simg:"\u2A9E",simgE:"\u2AA0",siml:"\u2A9D",simlE:"\u2A9F",simne:"\u2246",simplus:"\u2A24",simrarr:"\u2972",slarr:"\u2190",SmallCircle:"\u2218",smallsetminus:"\u2216",smashp:"\u2A33",smeparsl:"\u29E4",smid:"\u2223",smile:"\u2323",smt:"\u2AAA",smte:"\u2AAC",smtes:"\u2AAC\uFE00",SOFTcy:"\u042C",softcy:"\u044C",sol:"/",solb:"\u29C4",solbar:"\u233F",Sopf:"\u{1D54A}",sopf:"\u{1D564}",spades:"\u2660",spadesuit:"\u2660",spar:"\u2225",sqcap:"\u2293",sqcaps:"\u2293\uFE00",sqcup:"\u2294",sqcups:"\u2294\uFE00",Sqrt:"\u221A",sqsub:"\u228F",sqsube:"\u2291",sqsubset:"\u228F",sqsubseteq:"\u2291",sqsup:"\u2290",sqsupe:"\u2292",sqsupset:"\u2290",sqsupseteq:"\u2292",squ:"\u25A1",Square:"\u25A1",square:"\u25A1",SquareIntersection:"\u2293",SquareSubset:"\u228F",SquareSubsetEqual:"\u2291",SquareSuperset:"\u2290",SquareSupersetEqual:"\u2292",SquareUnion:"\u2294",squarf:"\u25AA",squf:"\u25AA",srarr:"\u2192",Sscr:"\u{1D4AE}",sscr:"\u{1D4C8}",ssetmn:"\u2216",ssmile:"\u2323",sstarf:"\u22C6",Star:"\u22C6",star:"\u2606",starf:"\u2605",straightepsilon:"\u03F5",straightphi:"\u03D5",strns:"\xAF",Sub:"\u22D0",sub:"\u2282",subdot:"\u2ABD",subE:"\u2AC5",sube:"\u2286",subedot:"\u2AC3",submult:"\u2AC1",subnE:"\u2ACB",subne:"\u228A",subplus:"\u2ABF",subrarr:"\u2979",Subset:"\u22D0",subset:"\u2282",subseteq:"\u2286",subseteqq:"\u2AC5",SubsetEqual:"\u2286",subsetneq:"\u228A",subsetneqq:"\u2ACB",subsim:"\u2AC7",subsub:"\u2AD5",subsup:"\u2AD3",succ:"\u227B",succapprox:"\u2AB8",succcurlyeq:"\u227D",Succeeds:"\u227B",SucceedsEqual:"\u2AB0",SucceedsSlantEqual:"\u227D",SucceedsTilde:"\u227F",succeq:"\u2AB0",succnapprox:"\u2ABA",succneqq:"\u2AB6",succnsim:"\u22E9",succsim:"\u227F",SuchThat:"\u220B",Sum:"\u2211",sum:"\u2211",sung:"\u266A",Sup:"\u22D1",sup:"\u2283",sup1:"\xB9",sup2:"\xB2",sup3:"\xB3",supdot:"\u2ABE",supdsub:"\u2AD8",supE:"\u2AC6",supe:"\u2287",supedot:"\u2AC4",Superset:"\u2283",SupersetEqual:"\u2287",suphsol:"\u27C9",suphsub:"\u2AD7",suplarr:"\u297B",supmult:"\u2AC2",supnE:"\u2ACC",supne:"\u228B",supplus:"\u2AC0",Supset:"\u22D1",supset:"\u2283",supseteq:"\u2287",supseteqq:"\u2AC6",supsetneq:"\u228B",supsetneqq:"\u2ACC",supsim:"\u2AC8",supsub:"\u2AD4",supsup:"\u2AD6",swarhk:"\u2926",swArr:"\u21D9",swarr:"\u2199",swarrow:"\u2199",swnwar:"\u292A",szlig:"\xDF",Tab:"	",target:"\u2316",Tau:"\u03A4",tau:"\u03C4",tbrk:"\u23B4",Tcaron:"\u0164",tcaron:"\u0165",Tcedil:"\u0162",tcedil:"\u0163",Tcy:"\u0422",tcy:"\u0442",tdot:"\u20DB",telrec:"\u2315",Tfr:"\u{1D517}",tfr:"\u{1D531}",there4:"\u2234",Therefore:"\u2234",therefore:"\u2234",Theta:"\u0398",theta:"\u03B8",thetasym:"\u03D1",thetav:"\u03D1",thickapprox:"\u2248",thicksim:"\u223C",ThickSpace:"\u205F\u200A",thinsp:"\u2009",ThinSpace:"\u2009",thkap:"\u2248",thksim:"\u223C",THORN:"\xDE",thorn:"\xFE",Tilde:"\u223C",tilde:"\u02DC",TildeEqual:"\u2243",TildeFullEqual:"\u2245",TildeTilde:"\u2248",times:"\xD7",timesb:"\u22A0",timesbar:"\u2A31",timesd:"\u2A30",tint:"\u222D",toea:"\u2928",top:"\u22A4",topbot:"\u2336",topcir:"\u2AF1",Topf:"\u{1D54B}",topf:"\u{1D565}",topfork:"\u2ADA",tosa:"\u2929",tprime:"\u2034",TRADE:"\u2122",trade:"\u2122",triangle:"\u25B5",triangledown:"\u25BF",triangleleft:"\u25C3",trianglelefteq:"\u22B4",triangleq:"\u225C",triangleright:"\u25B9",trianglerighteq:"\u22B5",tridot:"\u25EC",trie:"\u225C",triminus:"\u2A3A",TripleDot:"\u20DB",triplus:"\u2A39",trisb:"\u29CD",tritime:"\u2A3B",trpezium:"\u23E2",Tscr:"\u{1D4AF}",tscr:"\u{1D4C9}",TScy:"\u0426",tscy:"\u0446",TSHcy:"\u040B",tshcy:"\u045B",Tstrok:"\u0166",tstrok:"\u0167",twixt:"\u226C",twoheadleftarrow:"\u219E",twoheadrightarrow:"\u21A0",Uacute:"\xDA",uacute:"\xFA",Uarr:"\u219F",uArr:"\u21D1",uarr:"\u2191",Uarrocir:"\u2949",Ubrcy:"\u040E",ubrcy:"\u045E",Ubreve:"\u016C",ubreve:"\u016D",Ucirc:"\xDB",ucirc:"\xFB",Ucy:"\u0423",ucy:"\u0443",udarr:"\u21C5",Udblac:"\u0170",udblac:"\u0171",udhar:"\u296E",ufisht:"\u297E",Ufr:"\u{1D518}",ufr:"\u{1D532}",Ugrave:"\xD9",ugrave:"\xF9",uHar:"\u2963",uharl:"\u21BF",uharr:"\u21BE",uhblk:"\u2580",ulcorn:"\u231C",ulcorner:"\u231C",ulcrop:"\u230F",ultri:"\u25F8",Umacr:"\u016A",umacr:"\u016B",uml:"\xA8",UnderBar:"_",UnderBrace:"\u23DF",UnderBracket:"\u23B5",UnderParenthesis:"\u23DD",Union:"\u22C3",UnionPlus:"\u228E",Uogon:"\u0172",uogon:"\u0173",Uopf:"\u{1D54C}",uopf:"\u{1D566}",UpArrow:"\u2191",Uparrow:"\u21D1",uparrow:"\u2191",UpArrowBar:"\u2912",UpArrowDownArrow:"\u21C5",UpDownArrow:"\u2195",Updownarrow:"\u21D5",updownarrow:"\u2195",UpEquilibrium:"\u296E",upharpoonleft:"\u21BF",upharpoonright:"\u21BE",uplus:"\u228E",UpperLeftArrow:"\u2196",UpperRightArrow:"\u2197",Upsi:"\u03D2",upsi:"\u03C5",upsih:"\u03D2",Upsilon:"\u03A5",upsilon:"\u03C5",UpTee:"\u22A5",UpTeeArrow:"\u21A5",upuparrows:"\u21C8",urcorn:"\u231D",urcorner:"\u231D",urcrop:"\u230E",Uring:"\u016E",uring:"\u016F",urtri:"\u25F9",Uscr:"\u{1D4B0}",uscr:"\u{1D4CA}",utdot:"\u22F0",Utilde:"\u0168",utilde:"\u0169",utri:"\u25B5",utrif:"\u25B4",uuarr:"\u21C8",Uuml:"\xDC",uuml:"\xFC",uwangle:"\u29A7",vangrt:"\u299C",varepsilon:"\u03F5",varkappa:"\u03F0",varnothing:"\u2205",varphi:"\u03D5",varpi:"\u03D6",varpropto:"\u221D",vArr:"\u21D5",varr:"\u2195",varrho:"\u03F1",varsigma:"\u03C2",varsubsetneq:"\u228A\uFE00",varsubsetneqq:"\u2ACB\uFE00",varsupsetneq:"\u228B\uFE00",varsupsetneqq:"\u2ACC\uFE00",vartheta:"\u03D1",vartriangleleft:"\u22B2",vartriangleright:"\u22B3",Vbar:"\u2AEB",vBar:"\u2AE8",vBarv:"\u2AE9",Vcy:"\u0412",vcy:"\u0432",VDash:"\u22AB",Vdash:"\u22A9",vDash:"\u22A8",vdash:"\u22A2",Vdashl:"\u2AE6",Vee:"\u22C1",vee:"\u2228",veebar:"\u22BB",veeeq:"\u225A",vellip:"\u22EE",Verbar:"\u2016",verbar:"|",Vert:"\u2016",vert:"|",VerticalBar:"\u2223",VerticalLine:"|",VerticalSeparator:"\u2758",VerticalTilde:"\u2240",VeryThinSpace:"\u200A",Vfr:"\u{1D519}",vfr:"\u{1D533}",vltri:"\u22B2",vnsub:"\u2282\u20D2",vnsup:"\u2283\u20D2",Vopf:"\u{1D54D}",vopf:"\u{1D567}",vprop:"\u221D",vrtri:"\u22B3",Vscr:"\u{1D4B1}",vscr:"\u{1D4CB}",vsubnE:"\u2ACB\uFE00",vsubne:"\u228A\uFE00",vsupnE:"\u2ACC\uFE00",vsupne:"\u228B\uFE00",Vvdash:"\u22AA",vzigzag:"\u299A",Wcirc:"\u0174",wcirc:"\u0175",wedbar:"\u2A5F",Wedge:"\u22C0",wedge:"\u2227",wedgeq:"\u2259",weierp:"\u2118",Wfr:"\u{1D51A}",wfr:"\u{1D534}",Wopf:"\u{1D54E}",wopf:"\u{1D568}",wp:"\u2118",wr:"\u2240",wreath:"\u2240",Wscr:"\u{1D4B2}",wscr:"\u{1D4CC}",xcap:"\u22C2",xcirc:"\u25EF",xcup:"\u22C3",xdtri:"\u25BD",Xfr:"\u{1D51B}",xfr:"\u{1D535}",xhArr:"\u27FA",xharr:"\u27F7",Xi:"\u039E",xi:"\u03BE",xlArr:"\u27F8",xlarr:"\u27F5",xmap:"\u27FC",xnis:"\u22FB",xodot:"\u2A00",Xopf:"\u{1D54F}",xopf:"\u{1D569}",xoplus:"\u2A01",xotime:"\u2A02",xrArr:"\u27F9",xrarr:"\u27F6",Xscr:"\u{1D4B3}",xscr:"\u{1D4CD}",xsqcup:"\u2A06",xuplus:"\u2A04",xutri:"\u25B3",xvee:"\u22C1",xwedge:"\u22C0",Yacute:"\xDD",yacute:"\xFD",YAcy:"\u042F",yacy:"\u044F",Ycirc:"\u0176",ycirc:"\u0177",Ycy:"\u042B",ycy:"\u044B",yen:"\xA5",Yfr:"\u{1D51C}",yfr:"\u{1D536}",YIcy:"\u0407",yicy:"\u0457",Yopf:"\u{1D550}",yopf:"\u{1D56A}",Yscr:"\u{1D4B4}",yscr:"\u{1D4CE}",YUcy:"\u042E",yucy:"\u044E",Yuml:"\u0178",yuml:"\xFF",Zacute:"\u0179",zacute:"\u017A",Zcaron:"\u017D",zcaron:"\u017E",Zcy:"\u0417",zcy:"\u0437",Zdot:"\u017B",zdot:"\u017C",zeetrf:"\u2128",ZeroWidthSpace:"\u200B",Zeta:"\u0396",zeta:"\u03B6",Zfr:"\u2128",zfr:"\u{1D537}",ZHcy:"\u0416",zhcy:"\u0436",zigrarr:"\u21DD",Zopf:"\u2124",zopf:"\u{1D56B}",Zscr:"\u{1D4B5}",zscr:"\u{1D4CF}",zwj:"\u200D",zwnj:"\u200C"}),r.entityMap=r.HTML_ENTITIES})(lx);var tp={},ho=Ri.NAMESPACE,bh=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,O0=new RegExp("[\\-\\.0-9"+bh.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),N0=new RegExp("^"+bh.source+O0.source+"*(?::"+bh.source+O0.source+"*)?$"),xa=0,ri=1,ps=2,Ta=3,gs=4,ms=5,Sa=6,cl=7;function ea(r,e){this.message=r,this.locator=e,Error.captureStackTrace&&Error.captureStackTrace(this,ea)}ea.prototype=new Error;ea.prototype.name=ea.name;function ux(){}ux.prototype={parse:function(r,e,t){var n=this.domBuilder;n.startDocument(),cx(e,e={}),QA(r,e,t,n,this.errorHandler),n.endDocument()}};function QA(r,e,t,n,i){function s(j){if(j>65535){j-=65536;var X=55296+(j>>10),N=56320+(j&1023);return String.fromCharCode(X,N)}else return String.fromCharCode(j)}function a(j){var X=j.slice(1,-1);return X in t?t[X]:X.charAt(0)==="#"?s(parseInt(X.substr(1).replace("x","0x"))):(i.error("entity not found:"+j),j)}function o(j){if(j>x){var X=r.substring(x,j).replace(/&#?\w+;/g,a);h&&l(x),n.characters(X,0,j-x),x=j}}function l(j,X){for(;j>=c&&(X=f.exec(r));)u=X.index,c=u+X[0].length,h.lineNumber++;h.columnNumber=j-u+1}for(var u=0,c=0,f=/.*(?:\r\n?|\n)|.*$/g,h=n.locator,d=[{currentNSMap:e}],m={},x=0;;){try{var p=r.indexOf("<",x);if(p<0){if(!r.substr(x).match(/^\s*$/)){var g=n.doc,v=g.createTextNode(r.substr(x));g.appendChild(v),n.currentElement=v}return}switch(p>x&&o(p),r.charAt(p+1)){case"/":var V=r.indexOf(">",p+3),E=r.substring(p+2,V).replace(/[ \t\n\r]+$/g,""),S=d.pop();V<0?(E=r.substring(p+2).replace(/[\s<].*/,""),i.error("end tag name: "+E+" is not complete:"+S.tagName),V=p+1+E.length):E.match(/\s</)&&(E=E.replace(/[\s<].*/,""),i.error("end tag name: "+E+" maybe not complete"),V=p+1+E.length);var T=S.localNSMap,w=S.tagName==E,_=w||S.tagName&&S.tagName.toLowerCase()==E.toLowerCase();if(_){if(n.endElement(S.uri,S.localName,E),T)for(var C in T)Object.prototype.hasOwnProperty.call(T,C)&&n.endPrefixMapping(C);w||i.fatalError("end tag name: "+E+" is not match the current start tagName:"+S.tagName)}else d.push(S);V++;break;case"?":h&&l(p),V=nb(r,p,n);break;case"!":h&&l(p),V=rb(r,p,n,i);break;default:h&&l(p);var O=new fx,L=d[d.length-1].currentNSMap,V=JA(r,p,O,L,a,i),$=O.length;if(!O.closed&&tb(r,V,O.tagName,m)&&(O.closed=!0,t.nbsp||i.warning("unclosed xml attribute")),h&&$){for(var ne=P0(h,{}),me=0;me<$;me++){var H=O[me];l(H.offset),H.locator=P0(h,{})}n.locator=ne,F0(O,n,L)&&d.push(O),n.locator=h}else F0(O,n,L)&&d.push(O);ho.isHTML(O.uri)&&!O.closed?V=eb(r,V,O.tagName,a,n):V++}}catch(j){if(j instanceof ea)throw j;i.error("element parse error: "+j),V=-1}V>x?x=V:o(Math.max(p,x)+1)}}function P0(r,e){return e.lineNumber=r.lineNumber,e.columnNumber=r.columnNumber,e}function JA(r,e,t,n,i,s){function a(h,d,m){t.attributeNames.hasOwnProperty(h)&&s.fatalError("Attribute "+h+" redefined"),t.addValue(h,d,m)}for(var o,l,u=++e,c=xa;;){var f=r.charAt(u);switch(f){case"=":if(c===ri)o=r.slice(e,u),c=Ta;else if(c===ps)c=Ta;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(c===Ta||c===ri)if(c===ri&&(s.warning('attribute value must after "="'),o=r.slice(e,u)),e=u+1,u=r.indexOf(f,e),u>0)l=r.slice(e,u).replace(/&#?\w+;/g,i),a(o,l,e-1),c=ms;else throw new Error("attribute value no end '"+f+"' match");else if(c==gs)l=r.slice(e,u).replace(/&#?\w+;/g,i),a(o,l,e),s.warning('attribute "'+o+'" missed start quot('+f+")!!"),e=u+1,c=ms;else throw new Error('attribute value must after "="');break;case"/":switch(c){case xa:t.setTagName(r.slice(e,u));case ms:case Sa:case cl:c=cl,t.closed=!0;case gs:case ri:break;case ps:t.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return s.error("unexpected end of input"),c==xa&&t.setTagName(r.slice(e,u)),u;case">":switch(c){case xa:t.setTagName(r.slice(e,u));case ms:case Sa:case cl:break;case gs:case ri:l=r.slice(e,u),l.slice(-1)==="/"&&(t.closed=!0,l=l.slice(0,-1));case ps:c===ps&&(l=o),c==gs?(s.warning('attribute "'+l+'" missed quot(")!'),a(o,l.replace(/&#?\w+;/g,i),e)):((!ho.isHTML(n[""])||!l.match(/^(?:disabled|checked|selected)$/i))&&s.warning('attribute "'+l+'" missed value!! "'+l+'" instead!!'),a(l,l,e));break;case Ta:throw new Error("attribute value missed!!")}return u;case"\x80":f=" ";default:if(f<=" ")switch(c){case xa:t.setTagName(r.slice(e,u)),c=Sa;break;case ri:o=r.slice(e,u),c=ps;break;case gs:var l=r.slice(e,u).replace(/&#?\w+;/g,i);s.warning('attribute "'+l+'" missed quot(")!!'),a(o,l,e);case ms:c=Sa;break}else switch(c){case ps:t.tagName,(!ho.isHTML(n[""])||!o.match(/^(?:disabled|checked|selected)$/i))&&s.warning('attribute "'+o+'" missed value!! "'+o+'" instead2!!'),a(o,o,e),e=u,c=ri;break;case ms:s.warning('attribute space is required"'+o+'"!!');case Sa:c=ri,e=u;break;case Ta:c=gs,e=u;break;case cl:throw new Error("elements closed character '/' and '>' must be connected to")}}u++}}function F0(r,e,t){for(var n=r.tagName,i=null,f=r.length;f--;){var s=r[f],a=s.qName,o=s.value,h=a.indexOf(":");if(h>0)var l=s.prefix=a.slice(0,h),u=a.slice(h+1),c=l==="xmlns"&&u;else u=a,l=null,c=a==="xmlns"&&"";s.localName=u,c!==!1&&(i==null&&(i={},cx(t,t={})),t[c]=i[c]=o,s.uri=ho.XMLNS,e.startPrefixMapping(c,o))}for(var f=r.length;f--;){s=r[f];var l=s.prefix;l&&(l==="xml"&&(s.uri=ho.XML),l!=="xmlns"&&(s.uri=t[l||""]))}var h=n.indexOf(":");h>0?(l=r.prefix=n.slice(0,h),u=r.localName=n.slice(h+1)):(l=null,u=r.localName=n);var d=r.uri=t[l||""];if(e.startElement(d,u,n,r),r.closed){if(e.endElement(d,u,n),i)for(l in i)Object.prototype.hasOwnProperty.call(i,l)&&e.endPrefixMapping(l)}else return r.currentNSMap=t,r.localNSMap=i,!0}function eb(r,e,t,n,i){if(/^(?:script|textarea)$/i.test(t)){var s=r.indexOf("</"+t+">",e),a=r.substring(e+1,s);if(/[&<]/.test(a))return/^script$/i.test(t)?(i.characters(a,0,a.length),s):(a=a.replace(/&#?\w+;/g,n),i.characters(a,0,a.length),s)}return e+1}function tb(r,e,t,n){var i=n[t];return i==null&&(i=r.lastIndexOf("</"+t+">"),i<e&&(i=r.lastIndexOf("</"+t)),n[t]=i),i<e}function cx(r,e){for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t])}function rb(r,e,t,n){var i=r.charAt(e+2);switch(i){case"-":if(r.charAt(e+3)==="-"){var s=r.indexOf("-->",e+4);return s>e?(t.comment(r,e+4,s-e-4),s+3):(n.error("Unclosed comment"),-1)}else return-1;default:if(r.substr(e+3,6)=="CDATA["){var s=r.indexOf("]]>",e+9);return t.startCDATA(),t.characters(r,e+9,s-e-9),t.endCDATA(),s+3}var a=ib(r,e),o=a.length;if(o>1&&/!doctype/i.test(a[0][0])){var l=a[1][0],u=!1,c=!1;o>3&&(/^public$/i.test(a[2][0])?(u=a[3][0],c=o>4&&a[4][0]):/^system$/i.test(a[2][0])&&(c=a[3][0]));var f=a[o-1];return t.startDTD(l,u,c),t.endDTD(),f.index+f[0].length}}return-1}function nb(r,e,t){var n=r.indexOf("?>",e);if(n){var i=r.substring(e,n).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);return i?(i[0].length,t.processingInstruction(i[1],i[2]),n+2):-1}return-1}function fx(){this.attributeNames={}}fx.prototype={setTagName:function(r){if(!N0.test(r))throw new Error("invalid tagName:"+r);this.tagName=r},addValue:function(r,e,t){if(!N0.test(r))throw new Error("invalid attribute:"+r);this.attributeNames[r]=this.length,this[this.length++]={qName:r,value:e,offset:t}},length:0,getLocalName:function(r){return this[r].localName},getLocator:function(r){return this[r].locator},getQName:function(r){return this[r].qName},getURI:function(r){return this[r].uri},getValue:function(r){return this[r].value}};function ib(r,e){var t,n=[],i=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(i.lastIndex=e,i.exec(r);t=i.exec(r);)if(n.push(t),t[1])return n}tp.XMLReader=ux;tp.ParseError=ea;var sb=Ri,rp=Qn,M0=lx,hx=tp,ab=rp.DOMImplementation,B0=sb.NAMESPACE,ob=hx.ParseError,lb=hx.XMLReader;function dx(r){this.options=r||{locator:{}}}dx.prototype.parseFromString=function(r,e){var t=this.options,n=new lb,i=t.domBuilder||new bo,s=t.errorHandler,a=t.locator,o=t.xmlns||{},l=/\/x?html?$/.test(e),u=l?M0.HTML_ENTITIES:M0.XML_ENTITIES;return a&&i.setDocumentLocator(a),n.errorHandler=ub(s,i,a),n.domBuilder=t.domBuilder||i,l&&(o[""]=B0.HTML),o.xml=o.xml||B0.XML,r&&typeof r=="string"?n.parse(r,o,u):n.errorHandler.error("invalid doc source"),i.doc};function ub(r,e,t){if(!r){if(e instanceof bo)return e;r=e}var n={},i=r instanceof Function;t=t||{};function s(a){var o=r[a];!o&&i&&(o=r.length==2?function(l){r(a,l)}:r),n[a]=o&&function(l){o("[xmldom "+a+"]	"+l+Dh(t))}||function(){}}return s("warning"),s("error"),s("fatalError"),n}function bo(){this.cdata=!1}function vs(r,e){e.lineNumber=r.lineNumber,e.columnNumber=r.columnNumber}bo.prototype={startDocument:function(){this.doc=new ab().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(r,e,t,n){var i=this.doc,s=i.createElementNS(r,t||e),a=n.length;fl(this,s),this.currentElement=s,this.locator&&vs(this.locator,s);for(var o=0;o<a;o++){var r=n.getURI(o),l=n.getValue(o),t=n.getQName(o),u=i.createAttributeNS(r,t);this.locator&&vs(n.getLocator(o),u),u.value=u.nodeValue=l,s.setAttributeNode(u)}},endElement:function(r,e,t){var n=this.currentElement;n.tagName,this.currentElement=n.parentNode},startPrefixMapping:function(r,e){},endPrefixMapping:function(r){},processingInstruction:function(r,e){var t=this.doc.createProcessingInstruction(r,e);this.locator&&vs(this.locator,t),fl(this,t)},ignorableWhitespace:function(r,e,t){},characters:function(r,e,t){if(r=U0.apply(this,arguments),r){if(this.cdata)var n=this.doc.createCDATASection(r);else var n=this.doc.createTextNode(r);this.currentElement?this.currentElement.appendChild(n):/^\s*$/.test(r)&&this.doc.appendChild(n),this.locator&&vs(this.locator,n)}},skippedEntity:function(r){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(r){(this.locator=r)&&(r.lineNumber=0)},comment:function(r,e,t){r=U0.apply(this,arguments);var n=this.doc.createComment(r);this.locator&&vs(this.locator,n),fl(this,n)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(r,e,t){var n=this.doc.implementation;if(n&&n.createDocumentType){var i=n.createDocumentType(r,e,t);this.locator&&vs(this.locator,i),fl(this,i),this.doc.doctype=i}},warning:function(r){console.warn("[xmldom warning]	"+r,Dh(this.locator))},error:function(r){console.error("[xmldom error]	"+r,Dh(this.locator))},fatalError:function(r){throw new ob(r,this.locator)}};function Dh(r){if(r)return`
@`+(r.systemId||"")+"#[line:"+r.lineNumber+",col:"+r.columnNumber+"]"}function U0(r,e,t){return typeof r=="string"?r.substr(e,t):r.length>=e+t||e?new java.lang.String(r,e,t)+"":r}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(r){bo.prototype[r]=function(){return null}});function fl(r,e){r.currentElement?r.currentElement.appendChild(e):r.doc.appendChild(e)}Ao.__DOMHandler=bo;Ao.DOMParser=dx;Ao.DOMImplementation=rp.DOMImplementation;Ao.XMLSerializer=rp.XMLSerializer;var px=Qn;To.DOMImplementation=px.DOMImplementation;To.XMLSerializer=px.XMLSerializer;To.DOMParser=Ao.DOMParser;Object.defineProperty(Ee,"__esModule",{value:!0});Ee.RangeObject=void 0;Ee.blob2base64=Fb;Ee.borders=Sb;Ee.bounds=Tb;Ee.createBase64Url=Lb;Ee.createBlob=yx;Ee.createBlobUrl=Cb;Ee.defaults=yb;Ee.defer=Mb;Ee.documentHeight=pb;Ee.extend=Eb;Ee.filterChildren=$b;Ee.findChildren=Ub;Ee.getParentByTagName=zb;Ee.indexOfElementNode=bb;Ee.indexOfNode=np;Ee.indexOfSorted=Ch;Ee.indexOfTextNode=Ab;Ee.insert=xb;Ee.isElement=gb;Ee.isFloat=mb;Ee.isNumber=vx;Ee.isXml=Db;Ee.locationOf=hu;Ee.nodeBounds=wb;Ee.parents=Rh;Ee.parse=kb;Ee.prefixed=vb;Ee.qs=Ob;Ee.qsa=Ex;Ee.qsp=Nb;Ee.querySelectorByType=Bb;Ee.requestAnimationFrame=void 0;Ee.revokeBlobUrl=Rb;Ee.sprint=Pb;Ee.treeWalker=xx;Ee.type=Ib;Ee.uuid=mx;Ee.walk=ip;Ee.windowBounds=_b;var cb=To;const fb=typeof window<"u"?window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame:!1;Ee.requestAnimationFrame=fb;const hb=1,db=3,gx=typeof URL<"u"?URL:typeof window<"u"?window.URL||window.webkitURL||window.mozURL:void 0;function mx(){var r=new Date().getTime(),e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(r+Math.random()*16)%16|0;return r=Math.floor(r/16),(t=="x"?n:n&7|8).toString(16)});return e}function pb(){return Math.max(document.documentElement.clientHeight,document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight)}function gb(r){return!!(r&&r.nodeType==1)}function vx(r){return!isNaN(parseFloat(r))&&isFinite(r)}function mb(r){let e=parseFloat(r);return vx(r)===!1?!1:typeof r=="string"&&r.indexOf(".")>-1?!0:Math.floor(e)!==e}function vb(r){var e=["Webkit","webkit","Moz","O","ms"],t=["-webkit-","-webkit-","-moz-","-o-","-ms-"],n=r.toLowerCase(),i=e.length;if(typeof document>"u"||typeof document.body.style[n]<"u")return r;for(var s=0;s<i;s++)if(typeof document.body.style[t[s]+n]<"u")return t[s]+n;return r}function yb(r){for(var e=1,t=arguments.length;e<t;e++){var n=arguments[e];for(var i in n)r[i]===void 0&&(r[i]=n[i])}return r}function Eb(r){var e=[].slice.call(arguments,1);return e.forEach(function(t){!t||Object.getOwnPropertyNames(t).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}),r}function xb(r,e,t){var n=hu(r,e,t);return e.splice(n,0,r),n}function hu(r,e,t,n,i){var s=n||0,a=i||e.length,o=parseInt(s+(a-s)/2),l;return t||(t=function(u,c){if(u>c)return 1;if(u<c)return-1;if(u==c)return 0}),a-s<=0?o:(l=t(e[o],r),a-s===1?l>=0?o:o+1:l===0?o:l===-1?hu(r,e,t,o,a):hu(r,e,t,s,o))}function Ch(r,e,t,n,i){var s=n||0,a=i||e.length,o=parseInt(s+(a-s)/2),l;return t||(t=function(u,c){if(u>c)return 1;if(u<c)return-1;if(u==c)return 0}),a-s<=0?-1:(l=t(e[o],r),a-s===1?l===0?o:-1:l===0?o:l===-1?Ch(r,e,t,o,a):Ch(r,e,t,s,o))}function Tb(r){var e=window.getComputedStyle(r),t=["width","paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"],n=["height","paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"],i=0,s=0;return t.forEach(function(a){i+=parseFloat(e[a])||0}),n.forEach(function(a){s+=parseFloat(e[a])||0}),{height:s,width:i}}function Sb(r){var e=window.getComputedStyle(r),t=["paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"],n=["paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"],i=0,s=0;return t.forEach(function(a){i+=parseFloat(e[a])||0}),n.forEach(function(a){s+=parseFloat(e[a])||0}),{height:s,width:i}}function wb(r){let e,t=r.ownerDocument;if(r.nodeType==Node.TEXT_NODE){let n=t.createRange();n.selectNodeContents(r),e=n.getBoundingClientRect()}else e=r.getBoundingClientRect();return e}function _b(){var r=window.innerWidth,e=window.innerHeight;return{top:0,left:0,right:r,bottom:e,width:r,height:e}}function np(r,e){for(var t=r.parentNode,n=t.childNodes,i,s=-1,a=0;a<n.length&&(i=n[a],i.nodeType===e&&s++,i!=r);a++);return s}function Ab(r){return np(r,db)}function bb(r){return np(r,hb)}function Db(r){return["xml","opf","ncx"].indexOf(r)>-1}function yx(r,e){return new Blob([r],{type:e})}function Cb(r,e){var t,n=yx(r,e);return t=gx.createObjectURL(n),t}function Rb(r){return gx.revokeObjectURL(r)}function Lb(r,e){var t,n;if(typeof r=="string")return t=btoa(r),n="data:"+e+";base64,"+t,n}function Ib(r){return Object.prototype.toString.call(r).slice(8,-1)}function kb(r,e,t){var n,i;return typeof DOMParser>"u"||t?i=cb.DOMParser:i=DOMParser,r.charCodeAt(0)===65279&&(r=r.slice(1)),n=new i().parseFromString(r,e),n}function Ob(r,e){var t;if(!r)throw new Error("No Element Provided");if(typeof r.querySelector<"u")return r.querySelector(e);if(t=r.getElementsByTagName(e),t.length)return t[0]}function Ex(r,e){return typeof r.querySelector<"u"?r.querySelectorAll(e):r.getElementsByTagName(e)}function Nb(r,e,t){var n,i;if(typeof r.querySelector<"u"){e+="[";for(var s in t)e+=s+"~='"+t[s]+"'";return e+="]",r.querySelector(e)}else if(n=r.getElementsByTagName(e),i=Array.prototype.slice.call(n,0).filter(function(a){for(var o in t)if(a.getAttribute(o)===t[o])return!0;return!1}),i)return i[0]}function Pb(r,e){var t=r.ownerDocument||r;typeof t.createTreeWalker<"u"?xx(r,e,NodeFilter.SHOW_TEXT):ip(r,function(n){n&&n.nodeType===3&&e(n)})}function xx(r,e,t){var n=document.createTreeWalker(r,t,null,!1);let i;for(;i=n.nextNode();)e(i)}function ip(r,e){if(e(r))return!0;if(r=r.firstChild,r)do{if(ip(r,e))return!0;r=r.nextSibling}while(r)}function Fb(r){return new Promise(function(e,t){var n=new FileReader;n.readAsDataURL(r),n.onloadend=function(){e(n.result)}})}function Mb(){this.resolve=null,this.reject=null,this.id=mx(),this.promise=new Promise((r,e)=>{this.resolve=r,this.reject=e}),Object.freeze(this)}function Bb(r,e,t){var n;if(typeof r.querySelector<"u"&&(n=r.querySelector(`${e}[*|type="${t}"]`)),!n||n.length===0){n=Ex(r,e);for(var i=0;i<n.length;i++)if(n[i].getAttributeNS("http://www.idpf.org/2007/ops","type")===t||n[i].getAttribute("epub:type")===t)return n[i]}else return n}function Ub(r){for(var e=[],t=r.childNodes,n=0;n<t.length;n++){let i=t[n];i.nodeType===1&&e.push(i)}return e}function Rh(r){for(var e=[r];r;r=r.parentNode)e.unshift(r);return e}function $b(r,e,t){for(var n=[],i=r.childNodes,s=0;s<i.length;s++){let a=i[s];if(a.nodeType===1&&a.nodeName.toLowerCase()===e){if(t)return a;n.push(a)}}if(!t)return n}function zb(r,e){let t;if(!(r===null||e===""))for(t=r.parentNode;t.nodeType===1;){if(t.tagName.toLowerCase()===e)return t;t=t.parentNode}}class Vb{constructor(){this.collapsed=!1,this.commonAncestorContainer=void 0,this.endContainer=void 0,this.endOffset=void 0,this.startContainer=void 0,this.startOffset=void 0}setStart(e,t){this.startContainer=e,this.startOffset=t,this.endContainer?this.commonAncestorContainer=this._commonAncestorContainer():this.collapse(!0),this._checkCollapsed()}setEnd(e,t){this.endContainer=e,this.endOffset=t,this.startContainer?(this.collapsed=!1,this.commonAncestorContainer=this._commonAncestorContainer()):this.collapse(!1),this._checkCollapsed()}collapse(e){this.collapsed=!0,e?(this.endContainer=this.startContainer,this.endOffset=this.startOffset,this.commonAncestorContainer=this.startContainer.parentNode):(this.startContainer=this.endContainer,this.startOffset=this.endOffset,this.commonAncestorContainer=this.endOffset.parentNode)}selectNode(e){let t=e.parentNode,n=Array.prototype.indexOf.call(t.childNodes,e);this.setStart(t,n),this.setEnd(t,n+1)}selectNodeContents(e){e.childNodes[e.childNodes-1];let t=e.nodeType===3?e.textContent.length:parent.childNodes.length;this.setStart(e,0),this.setEnd(e,t)}_commonAncestorContainer(e,t){var n=Rh(e||this.startContainer),i=Rh(t||this.endContainer);if(n[0]==i[0]){for(var s=0;s<n.length;s++)if(n[s]!=i[s])return n[s-1]}}_checkCollapsed(){this.startContainer===this.endContainer&&this.startOffset===this.endOffset?this.collapsed=!0:this.collapsed=!1}toString(){}}Ee.RangeObject=Vb;var ts={},Cn={};if(!Tx)var Tx={cwd:function(){return"/"}};function vn(r){if(typeof r!="string")throw new TypeError("Path must be a string. Received "+r)}function $0(r,e){for(var t="",n=-1,i=0,s,a=0;a<=r.length;++a){if(a<r.length)s=r.charCodeAt(a);else{if(s===47)break;s=47}if(s===47){if(!(n===a-1||i===1))if(n!==a-1&&i===2){if(t.length<2||t.charCodeAt(t.length-1)!==46||t.charCodeAt(t.length-2)!==46){if(t.length>2){for(var o=t.length-1,l=o;l>=0&&t.charCodeAt(l)!==47;--l);if(l!==o){l===-1?t="":t=t.slice(0,l),n=a,i=0;continue}}else if(t.length===2||t.length===1){t="",n=a,i=0;continue}}e&&(t.length>0?t+="/..":t="..")}else t.length>0?t+="/"+r.slice(n+1,a):t=r.slice(n+1,a);n=a,i=0}else s===46&&i!==-1?++i:i=-1}return t}function Gb(r,e){var t=e.dir||e.root,n=e.base||(e.name||"")+(e.ext||"");return t?t===e.root?t+n:t+r+n:n}var Il={resolve:function(){for(var e="",t=!1,n,i=arguments.length-1;i>=-1&&!t;i--){var s;i>=0?s=arguments[i]:(n===void 0&&(n=Tx.cwd()),s=n),vn(s),s.length!==0&&(e=s+"/"+e,t=s.charCodeAt(0)===47)}return e=$0(e,!t),t?e.length>0?"/"+e:"/":e.length>0?e:"."},normalize:function(e){if(vn(e),e.length===0)return".";var t=e.charCodeAt(0)===47,n=e.charCodeAt(e.length-1)===47;return e=$0(e,!t),e.length===0&&!t&&(e="."),e.length>0&&n&&(e+="/"),t?"/"+e:e},isAbsolute:function(e){return vn(e),e.length>0&&e.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var e,t=0;t<arguments.length;++t){var n=arguments[t];vn(n),n.length>0&&(e===void 0?e=n:e+="/"+n)}return e===void 0?".":Il.normalize(e)},relative:function(e,t){if(vn(e),vn(t),e===t||(e=Il.resolve(e),t=Il.resolve(t),e===t))return"";for(var n=1;n<e.length&&e.charCodeAt(n)===47;++n);for(var i=e.length,s=i-n,a=1;a<t.length&&t.charCodeAt(a)===47;++a);for(var o=t.length,l=o-a,u=s<l?s:l,c=-1,f=0;f<=u;++f){if(f===u){if(l>u){if(t.charCodeAt(a+f)===47)return t.slice(a+f+1);if(f===0)return t.slice(a+f)}else s>u&&(e.charCodeAt(n+f)===47?c=f:f===0&&(c=0));break}var h=e.charCodeAt(n+f),d=t.charCodeAt(a+f);if(h!==d)break;h===47&&(c=f)}var m="";for(f=n+c+1;f<=i;++f)(f===i||e.charCodeAt(f)===47)&&(m.length===0?m+="..":m+="/..");return m.length>0?m+t.slice(a+c):(a+=c,t.charCodeAt(a)===47&&++a,t.slice(a))},_makeLong:function(e){return e},dirname:function(e){if(vn(e),e.length===0)return".";for(var t=e.charCodeAt(0),n=t===47,i=-1,s=!0,a=e.length-1;a>=1;--a)if(t=e.charCodeAt(a),t===47){if(!s){i=a;break}}else s=!1;return i===-1?n?"/":".":n&&i===1?"//":e.slice(0,i)},basename:function(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');vn(e);var n=0,i=-1,s=!0,a;if(t!==void 0&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var o=t.length-1,l=-1;for(a=e.length-1;a>=0;--a){var u=e.charCodeAt(a);if(u===47){if(!s){n=a+1;break}}else l===-1&&(s=!1,l=a+1),o>=0&&(u===t.charCodeAt(o)?--o===-1&&(i=a):(o=-1,i=l))}return n===i?i=l:i===-1&&(i=e.length),e.slice(n,i)}else{for(a=e.length-1;a>=0;--a)if(e.charCodeAt(a)===47){if(!s){n=a+1;break}}else i===-1&&(s=!1,i=a+1);return i===-1?"":e.slice(n,i)}},extname:function(e){vn(e);for(var t=-1,n=0,i=-1,s=!0,a=0,o=e.length-1;o>=0;--o){var l=e.charCodeAt(o);if(l===47){if(!s){n=o+1;break}continue}i===-1&&(s=!1,i=o+1),l===46?t===-1?t=o:a!==1&&(a=1):t!==-1&&(a=-1)}return t===-1||i===-1||a===0||a===1&&t===i-1&&t===n+1?"":e.slice(t,i)},format:function(e){if(e===null||typeof e!="object")throw new TypeError('Parameter "pathObject" must be an object, not '+typeof e);return Gb("/",e)},parse:function(e){vn(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return t;var n=e.charCodeAt(0),i=n===47,s;i?(t.root="/",s=1):s=0;for(var a=-1,o=0,l=-1,u=!0,c=e.length-1,f=0;c>=s;--c){if(n=e.charCodeAt(c),n===47){if(!u){o=c+1;break}continue}l===-1&&(u=!1,l=c+1),n===46?a===-1?a=c:f!==1&&(f=1):a!==-1&&(f=-1)}return a===-1||l===-1||f===0||f===1&&a===l-1&&a===o+1?l!==-1&&(o===0&&i?t.base=t.name=e.slice(1,l):t.base=t.name=e.slice(o,l)):(o===0&&i?(t.name=e.slice(1,a),t.base=e.slice(1,l)):(t.name=e.slice(o,a),t.base=e.slice(o,l)),t.ext=e.slice(a,l)),o>0?t.dir=e.slice(0,o-1):i&&(t.dir="/"),t},sep:"/",delimiter:":",posix:null},Pu=Il;Object.defineProperty(Cn,"__esModule",{value:!0});Cn.default=void 0;var hl=Wb(Pu);function Wb(r){return r&&r.__esModule?r:{default:r}}class Hb{constructor(e){var t,n;t=e.indexOf("://"),t>-1&&(e=new URL(e).pathname),n=this.parse(e),this.path=e,this.isDirectory(e)?this.directory=e:this.directory=n.dir+"/",this.filename=n.base,this.extension=n.ext.slice(1)}parse(e){return hl.default.parse(e)}isAbsolute(e){return hl.default.isAbsolute(e||this.path)}isDirectory(e){return e.charAt(e.length-1)==="/"}resolve(e){return hl.default.resolve(this.directory,e)}relative(e){var t=e&&e.indexOf("://")>-1;return t?e:hl.default.relative(this.directory,e)}splitPath(e){return this.splitPathRe.exec(e).slice(1)}toString(){return this.path}}var jb=Hb;Cn.default=jb;Object.defineProperty(ts,"__esModule",{value:!0});ts.default=void 0;var z0=Sx(Cn),V0=Sx(Pu);function Sx(r){return r&&r.__esModule?r:{default:r}}class Kb{constructor(e,t){var n=e.indexOf("://")>-1,i=e,s;if(this.Url=void 0,this.href=e,this.protocol="",this.origin="",this.hash="",this.hash="",this.search="",this.base=t,!n&&t!==!1&&typeof t!="string"&&window&&window.location&&(this.base=window.location.href),n||this.base)try{this.base?this.Url=new URL(e,this.base):this.Url=new URL(e),this.href=this.Url.href,this.protocol=this.Url.protocol,this.origin=this.Url.origin,this.hash=this.Url.hash,this.search=this.Url.search,i=this.Url.pathname+(this.Url.search?this.Url.search:"")}catch{this.Url=void 0,this.base&&(s=new z0.default(this.base),i=s.resolve(i))}this.Path=new z0.default(i),this.directory=this.Path.directory,this.filename=this.Path.filename,this.extension=this.Path.extension}path(){return this.Path}resolve(e){var t=e.indexOf("://")>-1,n;return t?e:(n=V0.default.resolve(this.directory,e),this.origin+n)}relative(e){return V0.default.relative(e,this.directory)}toString(){return this.href}}var qb=Kb;ts.default=qb;var Fu={},tr={};Object.defineProperty(tr,"__esModule",{value:!0});tr.default=void 0;var ni=Ee;const ys=1,Or=3,Yb=9;class Mi{constructor(e,t,n){var i;if(this.str="",this.base={},this.spinePos=0,this.range=!1,this.path={},this.start=null,this.end=null,!(this instanceof Mi))return new Mi(e,t,n);if(typeof t=="string"?this.base=this.parseComponent(t):typeof t=="object"&&t.steps&&(this.base=t),i=this.checkType(e),i==="string")return this.str=e,(0,ni.extend)(this,this.parse(e));if(i==="range")return(0,ni.extend)(this,this.fromRange(e,this.base,n));if(i==="node")return(0,ni.extend)(this,this.fromNode(e,this.base,n));if(i==="EpubCFI"&&e.path)return e;if(e)throw new TypeError("not a valid argument for EpubCFI");return this}checkType(e){return this.isCfiString(e)?"string":e&&typeof e=="object"&&((0,ni.type)(e)==="Range"||typeof e.startContainer<"u")?"range":e&&typeof e=="object"&&typeof e.nodeType<"u"?"node":e&&typeof e=="object"&&e instanceof Mi?"EpubCFI":!1}parse(e){var t={spinePos:-1,range:!1,base:{},path:{},start:null,end:null},n,i,s;return typeof e!="string"?{spinePos:-1}:(e.indexOf("epubcfi(")===0&&e[e.length-1]===")"&&(e=e.slice(8,e.length-1)),n=this.getChapterComponent(e),n?(t.base=this.parseComponent(n),i=this.getPathComponent(e),t.path=this.parseComponent(i),s=this.getRange(e),s&&(t.range=!0,t.start=this.parseComponent(s[0]),t.end=this.parseComponent(s[1])),t.spinePos=t.base.steps[1].index,t):{spinePos:-1})}parseComponent(e){var t={steps:[],terminal:{offset:null,assertion:null}},n=e.split(":"),i=n[0].split("/"),s;return n.length>1&&(s=n[1],t.terminal=this.parseTerminal(s)),i[0]===""&&i.shift(),t.steps=i.map(function(a){return this.parseStep(a)}.bind(this)),t}parseStep(e){var t,n,i,s,a;if(s=e.match(/\[(.*)\]/),s&&s[1]&&(a=s[1]),n=parseInt(e),!isNaN(n))return n%2===0?(t="element",i=n/2-1):(t="text",i=(n-1)/2),{type:t,index:i,id:a||null}}parseTerminal(e){var t,n,i=e.match(/\[(.*)\]/);return i&&i[1]?(t=parseInt(e.split("[")[0]),n=i[1]):t=parseInt(e),(0,ni.isNumber)(t)||(t=null),{offset:t,assertion:n}}getChapterComponent(e){var t=e.split("!");return t[0]}getPathComponent(e){var t=e.split("!");if(t[1])return t[1].split(",")[0]}getRange(e){var t=e.split(",");return t.length===3?[t[1],t[2]]:!1}getCharecterOffsetComponent(e){var t=e.split(":");return t[1]||""}joinSteps(e){return e?e.map(function(t){var n="";return t.type==="element"&&(n+=(t.index+1)*2),t.type==="text"&&(n+=1+2*t.index),t.id&&(n+="["+t.id+"]"),n}).join("/"):""}segmentString(e){var t="/";return t+=this.joinSteps(e.steps),e.terminal&&e.terminal.offset!=null&&(t+=":"+e.terminal.offset),e.terminal&&e.terminal.assertion!=null&&(t+="["+e.terminal.assertion+"]"),t}toString(){var e="epubcfi(";return e+=this.segmentString(this.base),e+="!",e+=this.segmentString(this.path),this.range&&this.start&&(e+=",",e+=this.segmentString(this.start)),this.range&&this.end&&(e+=",",e+=this.segmentString(this.end)),e+=")",e}compare(e,t){var n,i,s,a;if(typeof e=="string"&&(e=new Mi(e)),typeof t=="string"&&(t=new Mi(t)),e.spinePos>t.spinePos)return 1;if(e.spinePos<t.spinePos)return-1;e.range?(n=e.path.steps.concat(e.start.steps),s=e.start.terminal):(n=e.path.steps,s=e.path.terminal),t.range?(i=t.path.steps.concat(t.start.steps),a=t.start.terminal):(i=t.path.steps,a=t.path.terminal);for(var o=0;o<n.length;o++){if(!n[o])return-1;if(!i[o]||n[o].index>i[o].index)return 1;if(n[o].index<i[o].index)return-1}return n.length<i.length?-1:s.offset>a.offset?1:s.offset<a.offset?-1:0}step(e){var t=e.nodeType===Or?"text":"element";return{id:e.id,tagName:e.tagName,type:t,index:this.position(e)}}filteredStep(e,t){var n=this.filter(e,t),i;if(!!n)return i=n.nodeType===Or?"text":"element",{id:n.id,tagName:n.tagName,type:i,index:this.filteredPosition(n,t)}}pathTo(e,t,n){for(var i={steps:[],terminal:{offset:null,assertion:null}},s=e,a;s&&s.parentNode&&s.parentNode.nodeType!=Yb;)n?a=this.filteredStep(s,n):a=this.step(s),a&&i.steps.unshift(a),s=s.parentNode;return t!=null&&t>=0&&(i.terminal.offset=t,i.steps[i.steps.length-1].type!="text"&&i.steps.push({type:"text",index:0})),i}equalStep(e,t){return!e||!t?!1:e.index===t.index&&e.id===t.id&&e.type===t.type}fromRange(e,t,n){var i={range:!1,base:{},path:{},start:null,end:null},s=e.startContainer,a=e.endContainer,o=e.startOffset,l=e.endOffset,u=!1;if(n&&(u=s.ownerDocument.querySelector("."+n)!=null),typeof t=="string"?(i.base=this.parseComponent(t),i.spinePos=i.base.steps[1].index):typeof t=="object"&&(i.base=t),e.collapsed)u&&(o=this.patchOffset(s,o,n)),i.path=this.pathTo(s,o,n);else{i.range=!0,u&&(o=this.patchOffset(s,o,n)),i.start=this.pathTo(s,o,n),u&&(l=this.patchOffset(a,l,n)),i.end=this.pathTo(a,l,n),i.path={steps:[],terminal:null};var c=i.start.steps.length,f;for(f=0;f<c&&this.equalStep(i.start.steps[f],i.end.steps[f]);f++)f===c-1?i.start.terminal===i.end.terminal&&(i.path.steps.push(i.start.steps[f]),i.range=!1):i.path.steps.push(i.start.steps[f]);i.start.steps=i.start.steps.slice(i.path.steps.length),i.end.steps=i.end.steps.slice(i.path.steps.length)}return i}fromNode(e,t,n){var i={range:!1,base:{},path:{},start:null,end:null};return typeof t=="string"?(i.base=this.parseComponent(t),i.spinePos=i.base.steps[1].index):typeof t=="object"&&(i.base=t),i.path=this.pathTo(e,null,n),i}filter(e,t){var n,i,s,a,o,l=!1;return e.nodeType===Or?(l=!0,s=e.parentNode,n=e.parentNode.classList.contains(t)):(l=!1,n=e.classList.contains(t)),n&&l?(a=s.previousSibling,o=s.nextSibling,a&&a.nodeType===Or?i=a:o&&o.nodeType===Or&&(i=o),i||e):n&&!l?!1:e}patchOffset(e,t,n){if(e.nodeType!=Or)throw new Error("Anchor must be a text node");var i=e,s=t;for(e.parentNode.classList.contains(n)&&(i=e.parentNode);i.previousSibling;){if(i.previousSibling.nodeType===ys)if(i.previousSibling.classList.contains(n))s+=i.previousSibling.textContent.length;else break;else s+=i.previousSibling.textContent.length;i=i.previousSibling}return s}normalizedMap(e,t,n){var i={},s=-1,a,o=e.length,l,u;for(a=0;a<o;a++)l=e[a].nodeType,l===ys&&e[a].classList.contains(n)&&(l=Or),a>0&&l===Or&&u===Or?i[a]=s:t===l&&(s=s+1,i[a]=s),u=l;return i}position(e){var t,n;return e.nodeType===ys?(t=e.parentNode.children,t||(t=(0,ni.findChildren)(e.parentNode)),n=Array.prototype.indexOf.call(t,e)):(t=this.textNodes(e.parentNode),n=t.indexOf(e)),n}filteredPosition(e,t){var n,i,s;return e.nodeType===ys?(n=e.parentNode.children,s=this.normalizedMap(n,ys,t)):(n=e.parentNode.childNodes,e.parentNode.classList.contains(t)&&(e=e.parentNode,n=e.parentNode.childNodes),s=this.normalizedMap(n,Or,t)),i=Array.prototype.indexOf.call(n,e),s[i]}stepsToXpath(e){var t=[".","*"];return e.forEach(function(n){var i=n.index+1;n.id?t.push("*[position()="+i+" and @id='"+n.id+"']"):n.type==="text"?t.push("text()["+i+"]"):t.push("*["+i+"]")}),t.join("/")}stepsToQuerySelector(e){var t=["html"];return e.forEach(function(n){var i=n.index+1;n.id?t.push("#"+n.id):n.type==="text"||t.push("*:nth-child("+i+")")}),t.join(">")}textNodes(e,t){return Array.prototype.slice.call(e.childNodes).filter(function(n){return n.nodeType===Or?!0:!!(t&&n.classList.contains(t))})}walkToNode(e,t,n){var i=t||document,s=i.documentElement,a,o,l=e.length,u;for(u=0;u<l&&(o=e[u],o.type==="element"?o.id?s=i.getElementById(o.id):(a=s.children||(0,ni.findChildren)(s),s=a[o.index]):o.type==="text"&&(s=this.textNodes(s,n)[o.index]),!!s);u++);return s}findNode(e,t,n){var i=t||document,s,a;return!n&&typeof i.evaluate<"u"?(a=this.stepsToXpath(e),s=i.evaluate(a,i,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue):n?s=this.walkToNode(e,i,n):s=this.walkToNode(e,i),s}fixMiss(e,t,n,i){var s=this.findNode(e.slice(0,-1),n,i),a=s.childNodes,o=this.normalizedMap(a,Or,i),l,u,c=e[e.length-1].index;for(let f in o){if(!o.hasOwnProperty(f))return;if(o[f]===c)if(l=a[f],u=l.textContent.length,t>u)t=t-u;else{l.nodeType===ys?s=l.childNodes[0]:s=l;break}}return{container:s,offset:t}}toRange(e,t){var n=e||document,i,s,a,o,l,u=this,c,f,h=t?n.querySelector("."+t)!=null:!1,d;if(typeof n.createRange<"u"?i=n.createRange():i=new ni.RangeObject,u.range?(s=u.start,c=u.path.steps.concat(s.steps),o=this.findNode(c,n,h?t:null),a=u.end,f=u.path.steps.concat(a.steps),l=this.findNode(f,n,h?t:null)):(s=u.path,c=u.path.steps,o=this.findNode(u.path.steps,n,h?t:null)),o)try{s.terminal.offset!=null?i.setStart(o,s.terminal.offset):i.setStart(o,0)}catch{d=this.fixMiss(c,s.terminal.offset,n,h?t:null),i.setStart(d.container,d.offset)}else return console.log("No startContainer found for",this.toString()),null;if(l)try{a.terminal.offset!=null?i.setEnd(l,a.terminal.offset):i.setEnd(l,0)}catch{d=this.fixMiss(f,u.end.terminal.offset,n,h?t:null),i.setEnd(d.container,d.offset)}return i}isCfiString(e){return typeof e=="string"&&e.indexOf("epubcfi(")===0&&e[e.length-1]===")"}generateChapterComponent(e,t,n){var i=parseInt(t),s=(e+1)*2,a="/"+s+"/";return a+=(i+1)*2,n&&(a+="["+n+"]"),a}collapse(e){!this.range||(this.range=!1,e?(this.path.steps=this.path.steps.concat(this.start.steps),this.path.terminal=this.start.terminal):(this.path.steps=this.path.steps.concat(this.end.steps),this.path.terminal=this.end.terminal))}}var Xb=Mi;tr.default=Xb;var ia={};Object.defineProperty(ia,"__esModule",{value:!0});ia.default=void 0;class Zb{constructor(e){this.context=e||this,this.hooks=[]}register(){for(var e=0;e<arguments.length;++e)if(typeof arguments[e]=="function")this.hooks.push(arguments[e]);else for(var t=0;t<arguments[e].length;++t)this.hooks.push(arguments[e][t])}deregister(e){let t;for(let n=0;n<this.hooks.length;n++)if(t=this.hooks[n],t===e){this.hooks.splice(n,1);break}}trigger(){var e=arguments,t=this.context,n=[];return this.hooks.forEach(function(i){try{var s=i.apply(t,e)}catch(a){console.log(a)}s&&typeof s.then=="function"&&n.push(s)}),Promise.all(n)}list(){return this.hooks}clear(){return this.hooks=[]}}var Qb=Zb;ia.default=Qb;var Mu={},Rn={};Object.defineProperty(Rn,"__esModule",{value:!0});Rn.replaceBase=eD;Rn.replaceCanonical=tD;Rn.replaceLinks=nD;Rn.replaceMeta=rD;Rn.substitute=iD;var Zi=Ee,Jb=wx(ts);wx(Cn);function wx(r){return r&&r.__esModule?r:{default:r}}function eD(r,e){var t,n,i=e.url,s=i.indexOf("://")>-1;!r||(n=(0,Zi.qs)(r,"head"),t=(0,Zi.qs)(n,"base"),t||(t=r.createElement("base"),n.insertBefore(t,n.firstChild)),!s&&window&&window.location&&(i=window.location.origin+i),t.setAttribute("href",i))}function tD(r,e){var t,n,i=e.canonical;!r||(t=(0,Zi.qs)(r,"head"),n=(0,Zi.qs)(t,"link[rel='canonical']"),n?n.setAttribute("href",i):(n=r.createElement("link"),n.setAttribute("rel","canonical"),n.setAttribute("href",i),t.appendChild(n)))}function rD(r,e){var t,n,i=e.idref;!r||(t=(0,Zi.qs)(r,"head"),n=(0,Zi.qs)(t,"link[property='dc.identifier']"),n?n.setAttribute("content",i):(n=r.createElement("meta"),n.setAttribute("name","dc.identifier"),n.setAttribute("content",i),t.appendChild(n)))}function nD(r,e){var t=r.querySelectorAll("a[href]");if(!!t.length)for(var n=(0,Zi.qs)(r.ownerDocument,"base"),i=n?n.getAttribute("href"):void 0,s=function(o){var l=o.getAttribute("href");if(l.indexOf("mailto:")!==0){var u=l.indexOf("://")>-1;if(u)o.setAttribute("target","_blank");else{var c;try{c=new Jb.default(l,i)}catch{}o.onclick=function(){return c&&c.hash?e(c.Path.path+c.hash):e(c?c.Path.path:l),!1}}}}.bind(this),a=0;a<t.length;a++)s(t[a])}function iD(r,e,t){return e.forEach(function(n,i){n&&t[i]&&(n=n.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),r=r.replace(new RegExp(n,"g"),t[i]))}),r}var rs={};Object.defineProperty(rs,"__esModule",{value:!0});rs.default=void 0;var Es=Ee,sD=aD(Cn);function aD(r){return r&&r.__esModule?r:{default:r}}function oD(r,e,t,n){var i=typeof window<"u"?window.URL:!1,s=i?"blob":"arraybuffer",a=new Es.defer,o=new XMLHttpRequest,l=XMLHttpRequest.prototype,u;"overrideMimeType"in l||Object.defineProperty(l,"overrideMimeType",{value:function(){}}),t&&(o.withCredentials=!0),o.onreadystatechange=f,o.onerror=c,o.open("GET",r,!0);for(u in n)o.setRequestHeader(u,n[u]);e=="json"&&o.setRequestHeader("Accept","application/json"),e||(e=new sD.default(r).extension),e=="blob"&&(o.responseType=s),(0,Es.isXml)(e)&&o.overrideMimeType("text/xml"),e=="binary"&&(o.responseType="arraybuffer"),o.send();function c(h){a.reject(h)}function f(){if(this.readyState===XMLHttpRequest.DONE){var h=!1;if((this.responseType===""||this.responseType==="document")&&(h=this.responseXML),this.status===200||this.status===0||h){var d;if(!this.response&&!h)return a.reject({status:this.status,message:"Empty Response",stack:new Error().stack}),a.promise;if(this.status===403)return a.reject({status:this.status,response:this.response,message:"Forbidden",stack:new Error().stack}),a.promise;h?d=this.responseXML:(0,Es.isXml)(e)?d=(0,Es.parse)(this.response,"text/xml"):e=="xhtml"?d=(0,Es.parse)(this.response,"application/xhtml+xml"):e=="html"||e=="htm"?d=(0,Es.parse)(this.response,"text/html"):e=="json"?d=JSON.parse(this.response):e=="blob"?i?d=this.response:d=new Blob([this.response]):d=this.response,a.resolve(d)}else a.reject({status:this.status,message:this.response,stack:new Error().stack})}}return a.promise}var lD=oD;rs.default=lD;Object.defineProperty(Mu,"__esModule",{value:!0});Mu.default=void 0;var gf=Ee,G0=sp(tr),W0=sp(ia),uD=Rn,cD=sp(rs),fD=To;function sp(r){return r&&r.__esModule?r:{default:r}}class hD{constructor(e,t){this.idref=e.idref,this.linear=e.linear==="yes",this.properties=e.properties,this.index=e.index,this.href=e.href,this.url=e.url,this.canonical=e.canonical,this.next=e.next,this.prev=e.prev,this.cfiBase=e.cfiBase,t?this.hooks=t:(this.hooks={},this.hooks.serialize=new W0.default(this),this.hooks.content=new W0.default(this)),this.document=void 0,this.contents=void 0,this.output=void 0}load(e){var t=e||this.request||cD.default,n=new gf.defer,i=n.promise;return this.contents?n.resolve(this.contents):t(this.url).then(function(s){return this.document=s,this.contents=s.documentElement,this.hooks.content.trigger(this.document,this)}.bind(this)).then(function(){n.resolve(this.contents)}.bind(this)).catch(function(s){n.reject(s)}),i}base(){return(0,uD.replaceBase)(this.document,this)}render(e){var t=new gf.defer,n=t.promise;return this.output,this.load(e).then(function(i){var s=typeof navigator<"u"&&navigator.userAgent||"",a=s.indexOf("Trident")>=0,o;typeof XMLSerializer>"u"||a?o=fD.DOMParser:o=XMLSerializer;var l=new o;return this.output=l.serializeToString(i),this.output}.bind(this)).then(function(){return this.hooks.serialize.trigger(this.output,this)}.bind(this)).then(function(){t.resolve(this.output)}.bind(this)).catch(function(i){t.reject(i)}),n}find(e){var t=this,n=[],i=e.toLowerCase(),s=function(a){for(var o=a.textContent.toLowerCase(),l=t.document.createRange(),u,c,f=-1,h,d=150;c!=-1;)c=o.indexOf(i,f+1),c!=-1&&(l=t.document.createRange(),l.setStart(a,c),l.setEnd(a,c+i.length),u=t.cfiFromRange(l),a.textContent.length<d?h=a.textContent:(h=a.textContent.substring(c-d/2,c+d/2),h="..."+h+"..."),n.push({cfi:u,excerpt:h})),f=c};return(0,gf.sprint)(t.document,function(a){s(a)}),n}search(e,t=5){if(typeof document.createTreeWalker>"u")return this.find(e);let n=[];const i=150,s=this,a=e.toLowerCase(),o=function(f){const m=f.reduce((x,p)=>x+p.textContent,"").toLowerCase().indexOf(a);if(m!=-1){const p=m+a.length;let g=0,v=0;if(m<f[0].length){let E;for(;g<f.length-1&&(v+=f[g].length,!(p<=v));)g+=1;let S=f[0],T=f[g],w=s.document.createRange();w.setStart(S,m);let _=f.slice(0,g).reduce((O,L)=>O+L.textContent.length,0);w.setEnd(T,_>p?p:p-_),E=s.cfiFromRange(w);let C=f.slice(0,g+1).reduce((O,L)=>O+L.textContent,"");C.length>i&&(C=C.substring(m-i/2,m+i/2),C="..."+C+"..."),n.push({cfi:E,excerpt:C})}}},l=document.createTreeWalker(s.document,NodeFilter.SHOW_TEXT,null,!1);let u,c=[];for(;u=l.nextNode();)c.push(u),c.length==t&&(o(c.slice(0,t)),c=c.slice(1,t));return c.length>0&&o(c),n}reconcileLayoutSettings(e){var t={layout:e.layout,spread:e.spread,orientation:e.orientation};return this.properties.forEach(function(n){var i=n.replace("rendition:",""),s=i.indexOf("-"),a,o;s!=-1&&(a=i.slice(0,s),o=i.slice(s+1),t[a]=o)}),t}cfiFromRange(e){return new G0.default(e,this.cfiBase).toString()}cfiFromElement(e){return new G0.default(e,this.cfiBase).toString()}unload(){this.document=void 0,this.contents=void 0,this.output=void 0}destroy(){this.unload(),this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.idref=void 0,this.linear=void 0,this.properties=void 0,this.index=void 0,this.href=void 0,this.url=void 0,this.next=void 0,this.prev=void 0,this.cfiBase=void 0}}var dD=hD;Mu.default=dD;Object.defineProperty(Fu,"__esModule",{value:!0});Fu.default=void 0;var H0=ap(tr),j0=ap(ia),pD=ap(Mu),mf=Rn;function ap(r){return r&&r.__esModule?r:{default:r}}class gD{constructor(){this.spineItems=[],this.spineByHref={},this.spineById={},this.hooks={},this.hooks.serialize=new j0.default,this.hooks.content=new j0.default,this.hooks.content.register(mf.replaceBase),this.hooks.content.register(mf.replaceCanonical),this.hooks.content.register(mf.replaceMeta),this.epubcfi=new H0.default,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0}unpack(e,t,n){this.items=e.spine,this.manifest=e.manifest,this.spineNodeIndex=e.spineNodeIndex,this.baseUrl=e.baseUrl||e.basePath||"",this.length=this.items.length,this.items.forEach((i,s)=>{var a=this.manifest[i.idref],o;i.index=s,i.cfiBase=this.epubcfi.generateChapterComponent(this.spineNodeIndex,i.index,i.id),i.href&&(i.url=t(i.href,!0),i.canonical=n(i.href)),a&&(i.href=a.href,i.url=t(i.href,!0),i.canonical=n(i.href),a.properties.length&&i.properties.push.apply(i.properties,a.properties)),i.linear==="yes"?(i.prev=function(){let l=i.index;for(;l>0;){let u=this.get(l-1);if(u&&u.linear)return u;l-=1}}.bind(this),i.next=function(){let l=i.index;for(;l<this.spineItems.length-1;){let u=this.get(l+1);if(u&&u.linear)return u;l+=1}}.bind(this)):(i.prev=function(){},i.next=function(){}),o=new pD.default(i,this.hooks),this.append(o)}),this.loaded=!0}get(e){var t=0;if(typeof e>"u")for(;t<this.spineItems.length;){let n=this.spineItems[t];if(n&&n.linear)break;t+=1}else this.epubcfi.isCfiString(e)?t=new H0.default(e).spinePos:typeof e=="number"||isNaN(e)===!1?t=e:typeof e=="string"&&e.indexOf("#")===0?t=this.spineById[e.substring(1)]:typeof e=="string"&&(e=e.split("#")[0],t=this.spineByHref[e]||this.spineByHref[encodeURI(e)]);return this.spineItems[t]||null}append(e){var t=this.spineItems.length;return e.index=t,this.spineItems.push(e),this.spineByHref[decodeURI(e.href)]=t,this.spineByHref[encodeURI(e.href)]=t,this.spineByHref[e.href]=t,this.spineById[e.idref]=t,t}prepend(e){return this.spineByHref[e.href]=0,this.spineById[e.idref]=0,this.spineItems.forEach(function(t,n){t.index=n}),0}remove(e){var t=this.spineItems.indexOf(e);if(t>-1)return delete this.spineByHref[e.href],delete this.spineById[e.idref],this.spineItems.splice(t,1)}each(){return this.spineItems.forEach.apply(this.spineItems,arguments)}first(){let e=0;do{let t=this.get(e);if(t&&t.linear)return t;e+=1}while(e<this.spineItems.length)}last(){let e=this.spineItems.length-1;do{let t=this.get(e);if(t&&t.linear)return t;e-=1}while(e>=0)}destroy(){this.each(e=>e.destroy()),this.spineItems=void 0,this.spineByHref=void 0,this.spineById=void 0,this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.epubcfi=void 0,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0}}var mD=gD;Fu.default=mD;var Bu={},Ai={};Object.defineProperty(Ai,"__esModule",{value:!0});Ai.default=Ai.Task=void 0;var dl=Ee;class vD{constructor(e){this._q=[],this.context=e,this.tick=dl.requestAnimationFrame,this.running=!1,this.paused=!1}enqueue(){var e,t,n,i=[].shift.call(arguments),s=arguments;if(!i)throw new Error("No Task Provided");return typeof i=="function"?(e=new dl.defer,t=e.promise,n={task:i,args:s,deferred:e,promise:t}):n={promise:i},this._q.push(n),this.paused==!1&&!this.running&&this.run(),n.promise}dequeue(){var e,t,n;if(this._q.length&&!this.paused){if(e=this._q.shift(),t=e.task,t)return n=t.apply(this.context,e.args),n&&typeof n.then=="function"?n.then(function(){e.deferred.resolve.apply(this.context,arguments)}.bind(this),function(){e.deferred.reject.apply(this.context,arguments)}.bind(this)):(e.deferred.resolve.apply(this.context,n),e.promise);if(e.promise)return e.promise}else return e=new dl.defer,e.deferred.resolve(),e.promise}dump(){for(;this._q.length;)this.dequeue()}run(){return this.running||(this.running=!0,this.defered=new dl.defer),this.tick.call(window,()=>{this._q.length?this.dequeue().then(function(){this.run()}.bind(this)):(this.defered.resolve(),this.running=void 0)}),this.paused==!0&&(this.paused=!1),this.defered.promise}flush(){if(this.running)return this.running;if(this._q.length)return this.running=this.dequeue().then(function(){return this.running=void 0,this.flush()}.bind(this)),this.running}clear(){this._q=[]}length(){return this._q.length}pause(){this.paused=!0}stop(){this._q=[],this.running=!1,this.paused=!0}}class yD{constructor(e,t,n){return function(){var i=arguments||[];return new Promise((s,a)=>{var o=function(l,u){!l&&u?a(u):s(l)};i.push(o),e.apply(n||this,i)})}}}Ai.Task=yD;var ED=vD;Ai.default=ED;var Lt={};Object.defineProperty(Lt,"__esModule",{value:!0});Lt.EVENTS=Lt.EPUBJS_VERSION=Lt.DOM_EVENTS=void 0;const xD="0.3";Lt.EPUBJS_VERSION=xD;const TD=["keydown","keyup","keypressed","mouseup","mousedown","mousemove","click","touchend","touchstart","touchmove"];Lt.DOM_EVENTS=TD;const SD={BOOK:{OPEN_FAILED:"openFailed"},CONTENTS:{EXPAND:"expand",RESIZE:"resize",SELECTED:"selected",SELECTED_RANGE:"selectedRange",LINK_CLICKED:"linkClicked"},LOCATIONS:{CHANGED:"changed"},MANAGERS:{RESIZE:"resize",RESIZED:"resized",ORIENTATION_CHANGE:"orientationchange",ADDED:"added",SCROLL:"scroll",SCROLLED:"scrolled",REMOVED:"removed"},VIEWS:{AXIS:"axis",WRITING_MODE:"writingMode",LOAD_ERROR:"loaderror",RENDERED:"rendered",RESIZED:"resized",DISPLAYED:"displayed",SHOWN:"shown",HIDDEN:"hidden",MARK_CLICKED:"markClicked"},RENDITION:{STARTED:"started",ATTACHED:"attached",DISPLAYED:"displayed",DISPLAY_ERROR:"displayerror",RENDERED:"rendered",REMOVED:"removed",RESIZED:"resized",ORIENTATION_CHANGE:"orientationchange",LOCATION_CHANGED:"locationChanged",RELOCATED:"relocated",MARK_CLICKED:"markClicked",SELECTED:"selected",LAYOUT:"layout"},LAYOUT:{UPDATED:"updated"},ANNOTATION:{ATTACH:"attach",DETACH:"detach"}};Lt.EVENTS=SD;Object.defineProperty(Bu,"__esModule",{value:!0});Bu.default=void 0;var Ii=Ee,wD=op(Ai),ii=op(tr),_D=Lt,AD=op(Hr.exports);function op(r){return r&&r.__esModule?r:{default:r}}class _x{constructor(e,t,n){this.spine=e,this.request=t,this.pause=n||100,this.q=new wD.default(this),this.epubcfi=new ii.default,this._locations=[],this._locationsWords=[],this.total=0,this.break=150,this._current=0,this._wordCounter=0,this.currentLocation="",this._currentCfi="",this.processingTimeout=void 0}generate(e){return e&&(this.break=e),this.q.pause(),this.spine.each(function(t){t.linear&&this.q.enqueue(this.process.bind(this),t)}.bind(this)),this.q.run().then(function(){return this.total=this._locations.length-1,this._currentCfi&&(this.currentLocation=this._currentCfi),this._locations}.bind(this))}createRange(){return{startContainer:void 0,startOffset:void 0,endContainer:void 0,endOffset:void 0}}process(e){return e.load(this.request).then(function(t){var n=new Ii.defer,i=this.parse(t,e.cfiBase);return this._locations=this._locations.concat(i),e.unload(),this.processingTimeout=setTimeout(()=>n.resolve(i),this.pause),n.promise}.bind(this))}parse(e,t,n){var i=[],s,a=e.ownerDocument,o=(0,Ii.qs)(a,"body"),l=0,u,c=n||this.break,f=function(h){var d=h.length,m,x=0;if(h.textContent.trim().length===0)return!1;for(l==0&&(s=this.createRange(),s.startContainer=h,s.startOffset=0),m=c-l,m>d&&(l+=d,x=d);x<d;)if(m=c-l,l===0&&(x+=1,s=this.createRange(),s.startContainer=h,s.startOffset=x),x+m>=d)l+=d-x,x=d;else{x+=m,s.endContainer=h,s.endOffset=x;let p=new ii.default(s,t).toString();i.push(p),l=0}u=h};if((0,Ii.sprint)(o,f.bind(this)),s&&s.startContainer&&u){s.endContainer=u,s.endOffset=u.length;let h=new ii.default(s,t).toString();i.push(h),l=0}return i}generateFromWords(e,t,n){var i=e?new ii.default(e):void 0;return this.q.pause(),this._locationsWords=[],this._wordCounter=0,this.spine.each(function(s){s.linear&&(i?s.index>=i.spinePos&&this.q.enqueue(this.processWords.bind(this),s,t,i,n):this.q.enqueue(this.processWords.bind(this),s,t,i,n))}.bind(this)),this.q.run().then(function(){return this._currentCfi&&(this.currentLocation=this._currentCfi),this._locationsWords}.bind(this))}processWords(e,t,n,i){return i&&this._locationsWords.length>=i?Promise.resolve():e.load(this.request).then(function(s){var a=new Ii.defer,o=this.parseWords(s,e,t,n),l=i-this._locationsWords.length;return this._locationsWords=this._locationsWords.concat(o.length>=i?o.slice(0,l):o),e.unload(),this.processingTimeout=setTimeout(()=>a.resolve(o),this.pause),a.promise}.bind(this))}countWords(e){return e=e.replace(/(^\s*)|(\s*$)/gi,""),e=e.replace(/[ ]{2,}/gi," "),e=e.replace(/\n /,`
`),e.split(" ").length}parseWords(e,t,n,i){var s=t.cfiBase,a=[],o=e.ownerDocument,l=(0,Ii.qs)(o,"body"),u=n,c=i?i.spinePos!==t.index:!0,f;i&&t.index===i.spinePos&&(f=i.findNode(i.range?i.path.steps.concat(i.start.steps):i.path.steps,e.ownerDocument));var h=function(d){if(!c)if(d===f)c=!0;else return!1;if(d.textContent.length<10&&d.textContent.trim().length===0)return!1;var m=this.countWords(d.textContent),x,p=0;if(m===0)return!1;for(x=u-this._wordCounter,x>m&&(this._wordCounter+=m,p=m);p<m;)if(x=u-this._wordCounter,p+x>=m)this._wordCounter+=m-p,p=m;else{p+=x;let g=new ii.default(d,s);a.push({cfi:g.toString(),wordCount:this._wordCounter}),this._wordCounter=0}};return(0,Ii.sprint)(l,h.bind(this)),a}locationFromCfi(e){let t;return ii.default.prototype.isCfiString(e)&&(e=new ii.default(e)),this._locations.length===0?-1:(t=(0,Ii.locationOf)(e,this._locations,this.epubcfi.compare),t>this.total?this.total:t)}percentageFromCfi(e){if(this._locations.length===0)return null;var t=this.locationFromCfi(e);return this.percentageFromLocation(t)}percentageFromLocation(e){return!e||!this.total?0:e/this.total}cfiFromLocation(e){var t=-1;return typeof e!="number"&&(e=parseInt(e)),e>=0&&e<this._locations.length&&(t=this._locations[e]),t}cfiFromPercentage(e){let t;if(e>1&&console.warn("Normalize cfiFromPercentage value to between 0 - 1"),e>=1){let n=new ii.default(this._locations[this.total]);return n.collapse(),n.toString()}return t=Math.ceil(this.total*e),this.cfiFromLocation(t)}load(e){return typeof e=="string"?this._locations=JSON.parse(e):this._locations=e,this.total=this._locations.length-1,this._locations}save(){return JSON.stringify(this._locations)}getCurrent(){return this._current}setCurrent(e){var t;if(typeof e=="string")this._currentCfi=e;else if(typeof e=="number")this._current=e;else return;this._locations.length!==0&&(typeof e=="string"?(t=this.locationFromCfi(e),this._current=t):t=e,this.emit(_D.EVENTS.LOCATIONS.CHANGED,{percentage:this.percentageFromLocation(t)}))}get currentLocation(){return this._current}set currentLocation(e){this.setCurrent(e)}length(){return this._locations.length}destroy(){this.spine=void 0,this.request=void 0,this.pause=void 0,this.q.stop(),this.q=void 0,this.epubcfi=void 0,this._locations=void 0,this.total=void 0,this.break=void 0,this._current=void 0,this.currentLocation=void 0,this._currentCfi=void 0,clearTimeout(this.processingTimeout)}}(0,AD.default)(_x.prototype);var bD=_x;Bu.default=bD;var Uu={};Object.defineProperty(Uu,"__esModule",{value:!0});Uu.default=void 0;var DD=RD(Pu),CD=Ee;function RD(r){return r&&r.__esModule?r:{default:r}}class LD{constructor(e){this.packagePath="",this.directory="",this.encoding="",e&&this.parse(e)}parse(e){var t;if(!e)throw new Error("Container File Not Found");if(t=(0,CD.qs)(e,"rootfile"),!t)throw new Error("No RootFile Found");this.packagePath=t.getAttribute("full-path"),this.directory=DD.default.dirname(this.packagePath),this.encoding=e.xmlEncoding}destroy(){this.packagePath=void 0,this.directory=void 0,this.encoding=void 0}}var ID=LD;Uu.default=ID;var $u={};Object.defineProperty($u,"__esModule",{value:!0});$u.default=void 0;var Nr=Ee;class kD{constructor(e){this.manifest={},this.navPath="",this.ncxPath="",this.coverPath="",this.spineNodeIndex=0,this.spine=[],this.metadata={},e&&this.parse(e)}parse(e){var t,n,i;if(!e)throw new Error("Package File Not Found");if(t=(0,Nr.qs)(e,"metadata"),!t)throw new Error("No Metadata Found");if(n=(0,Nr.qs)(e,"manifest"),!n)throw new Error("No Manifest Found");if(i=(0,Nr.qs)(e,"spine"),!i)throw new Error("No Spine Found");return this.manifest=this.parseManifest(n),this.navPath=this.findNavPath(n),this.ncxPath=this.findNcxPath(n,i),this.coverPath=this.findCoverPath(e),this.spineNodeIndex=(0,Nr.indexOfElementNode)(i),this.spine=this.parseSpine(i,this.manifest),this.uniqueIdentifier=this.findUniqueIdentifier(e),this.metadata=this.parseMetadata(t),this.metadata.direction=i.getAttribute("page-progression-direction"),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex}}parseMetadata(e){var t={};return t.title=this.getElementText(e,"title"),t.creator=this.getElementText(e,"creator"),t.description=this.getElementText(e,"description"),t.pubdate=this.getElementText(e,"date"),t.publisher=this.getElementText(e,"publisher"),t.identifier=this.getElementText(e,"identifier"),t.language=this.getElementText(e,"language"),t.rights=this.getElementText(e,"rights"),t.modified_date=this.getPropertyText(e,"dcterms:modified"),t.layout=this.getPropertyText(e,"rendition:layout"),t.orientation=this.getPropertyText(e,"rendition:orientation"),t.flow=this.getPropertyText(e,"rendition:flow"),t.viewport=this.getPropertyText(e,"rendition:viewport"),t.media_active_class=this.getPropertyText(e,"media:active-class"),t.spread=this.getPropertyText(e,"rendition:spread"),t}parseManifest(e){var t={},n=(0,Nr.qsa)(e,"item"),i=Array.prototype.slice.call(n);return i.forEach(function(s){var a=s.getAttribute("id"),o=s.getAttribute("href")||"",l=s.getAttribute("media-type")||"",u=s.getAttribute("media-overlay")||"",c=s.getAttribute("properties")||"";t[a]={href:o,type:l,overlay:u,properties:c.length?c.split(" "):[]}}),t}parseSpine(e,t){var n=[],i=(0,Nr.qsa)(e,"itemref"),s=Array.prototype.slice.call(i);return s.forEach(function(a,o){var l=a.getAttribute("idref"),u=a.getAttribute("properties")||"",c=u.length?u.split(" "):[],f={id:a.getAttribute("id"),idref:l,linear:a.getAttribute("linear")||"yes",properties:c,index:o};n.push(f)}),n}findUniqueIdentifier(e){var t=e.documentElement.getAttribute("unique-identifier");if(!t)return"";var n=e.getElementById(t);return n&&n.localName==="identifier"&&n.namespaceURI==="http://purl.org/dc/elements/1.1/"&&n.childNodes.length>0?n.childNodes[0].nodeValue.trim():""}findNavPath(e){var t=(0,Nr.qsp)(e,"item",{properties:"nav"});return t?t.getAttribute("href"):!1}findNcxPath(e,t){var n=(0,Nr.qsp)(e,"item",{"media-type":"application/x-dtbncx+xml"}),i;return n||(i=t.getAttribute("toc"),i&&(n=e.querySelector(`#${i}`))),n?n.getAttribute("href"):!1}findCoverPath(e){var t=(0,Nr.qs)(e,"package");t.getAttribute("version");var n=(0,Nr.qsp)(e,"item",{properties:"cover-image"});if(n)return n.getAttribute("href");var i=(0,Nr.qsp)(e,"meta",{name:"cover"});if(i){var s=i.getAttribute("content"),a=e.getElementById(s);return a?a.getAttribute("href"):""}else return!1}getElementText(e,t){var n=e.getElementsByTagNameNS("http://purl.org/dc/elements/1.1/",t),i;return!n||n.length===0?"":(i=n[0],i.childNodes.length?i.childNodes[0].nodeValue:"")}getPropertyText(e,t){var n=(0,Nr.qsp)(e,"meta",{property:t});return n&&n.childNodes.length?n.childNodes[0].nodeValue:""}load(e){this.metadata=e.metadata;let t=e.readingOrder||e.spine;return this.spine=t.map((n,i)=>(n.index=i,n.linear=n.linear||"yes",n)),e.resources.forEach((n,i)=>{this.manifest[i]=n,n.rel&&n.rel[0]==="cover"&&(this.coverPath=n.href)}),this.spineNodeIndex=0,this.toc=e.toc.map((n,i)=>(n.label=n.title,n)),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex,toc:this.toc}}destroy(){this.manifest=void 0,this.navPath=void 0,this.ncxPath=void 0,this.coverPath=void 0,this.spineNodeIndex=void 0,this.spine=void 0,this.metadata=void 0}}var OD=kD;$u.default=OD;var zu={};Object.defineProperty(zu,"__esModule",{value:!0});zu.default=void 0;var xr=Ee;class ND{constructor(e){this.toc=[],this.tocByHref={},this.tocById={},this.landmarks=[],this.landmarksByType={},this.length=0,e&&this.parse(e)}parse(e){let t=e.nodeType,n,i;t&&(n=(0,xr.qs)(e,"html"),i=(0,xr.qs)(e,"ncx")),t?n?(this.toc=this.parseNav(e),this.landmarks=this.parseLandmarks(e)):i&&(this.toc=this.parseNcx(e)):this.toc=this.load(e),this.length=0,this.unpack(this.toc)}unpack(e){for(var t,n=0;n<e.length;n++)t=e[n],t.href&&(this.tocByHref[t.href]=n),t.id&&(this.tocById[t.id]=n),this.length++,t.subitems.length&&this.unpack(t.subitems)}get(e){var t;return e?(e.indexOf("#")===0?t=this.tocById[e.substring(1)]:e in this.tocByHref&&(t=this.tocByHref[e]),this.getByIndex(e,t,this.toc)):this.toc}getByIndex(e,t,n){if(n.length===0)return;const i=n[t];if(i&&(e===i.id||e===i.href))return i;{let s;for(let a=0;a<n.length&&(s=this.getByIndex(e,t,n[a].subitems),!s);++a);return s}}landmark(e){var t;return e?(t=this.landmarksByType[e],this.landmarks[t]):this.landmarks}parseNav(e){var t=(0,xr.querySelectorByType)(e,"nav","toc"),n=[];if(!t)return n;let i=(0,xr.filterChildren)(t,"ol",!0);return i&&(n=this.parseNavList(i)),n}parseNavList(e,t){const n=[];if(!e||!e.children)return n;for(let i=0;i<e.children.length;i++){const s=this.navItem(e.children[i],t);s&&n.push(s)}return n}navItem(e,t){let n=e.getAttribute("id")||void 0,i=(0,xr.filterChildren)(e,"a",!0)||(0,xr.filterChildren)(e,"span",!0);if(!i)return;let s=i.getAttribute("href")||"";n||(n=s);let a=i.textContent||"",o=[],l=(0,xr.filterChildren)(e,"ol",!0);return l&&(o=this.parseNavList(l,n)),{id:n,href:s,label:a,subitems:o,parent:t}}parseLandmarks(e){var t=(0,xr.querySelectorByType)(e,"nav","landmarks"),n=t?(0,xr.qsa)(t,"li"):[],i=n.length,s,a=[],o;if(!n||i===0)return a;for(s=0;s<i;++s)o=this.landmarkItem(n[s]),o&&(a.push(o),this.landmarksByType[o.type]=s);return a}landmarkItem(e){let t=(0,xr.filterChildren)(e,"a",!0);if(!t)return;let n=t.getAttributeNS("http://www.idpf.org/2007/ops","type")||void 0,i=t.getAttribute("href")||"",s=t.textContent||"";return{href:i,label:s,type:n}}parseNcx(e){var t=(0,xr.qsa)(e,"navPoint"),n=t.length,i,s={},a=[],o,l;if(!t||n===0)return a;for(i=0;i<n;++i)o=this.ncxItem(t[i]),s[o.id]=o,o.parent?(l=s[o.parent],l.subitems.push(o)):a.push(o);return a}ncxItem(e){var t=e.getAttribute("id")||!1,n=(0,xr.qs)(e,"content"),i=n.getAttribute("src"),s=(0,xr.qs)(e,"navLabel"),a=s.textContent?s.textContent:"",o=[],l=e.parentNode,u;return l&&(l.nodeName==="navPoint"||l.nodeName.split(":").slice(-1)[0]==="navPoint")&&(u=l.getAttribute("id")),{id:t,href:i,label:a,subitems:o,parent:u}}load(e){return e.map(t=>(t.label=t.title,t.subitems=t.children?this.load(t.children):[],t))}forEach(e){return this.toc.forEach(e)}}var PD=ND;zu.default=PD;var Vu={},sa={};Object.defineProperty(sa,"__esModule",{value:!0});sa.default=void 0;var wa={application:{ecmascript:["es","ecma"],javascript:"js",ogg:"ogx",pdf:"pdf",postscript:["ps","ai","eps","epsi","epsf","eps2","eps3"],"rdf+xml":"rdf",smil:["smi","smil"],"xhtml+xml":["xhtml","xht"],xml:["xml","xsl","xsd","opf","ncx"],zip:"zip","x-httpd-eruby":"rhtml","x-latex":"latex","x-maker":["frm","maker","frame","fm","fb","book","fbdoc"],"x-object":"o","x-shockwave-flash":["swf","swfl"],"x-silverlight":"scr","epub+zip":"epub","font-tdpfr":"pfr","inkml+xml":["ink","inkml"],json:"json","jsonml+json":"jsonml","mathml+xml":"mathml","metalink+xml":"metalink",mp4:"mp4s","omdoc+xml":"omdoc",oxps:"oxps","vnd.amazon.ebook":"azw",widget:"wgt","x-dtbook+xml":"dtb","x-dtbresource+xml":"res","x-font-bdf":"bdf","x-font-ghostscript":"gsf","x-font-linux-psf":"psf","x-font-otf":"otf","x-font-pcf":"pcf","x-font-snf":"snf","x-font-ttf":["ttf","ttc"],"x-font-type1":["pfa","pfb","pfm","afm"],"x-font-woff":"woff","x-mobipocket-ebook":["prc","mobi"],"x-mspublisher":"pub","x-nzb":"nzb","x-tgif":"obj","xaml+xml":"xaml","xml-dtd":"dtd","xproc+xml":"xpl","xslt+xml":"xslt","internet-property-stream":"acx","x-compress":"z","x-compressed":"tgz","x-gzip":"gz"},audio:{flac:"flac",midi:["mid","midi","kar","rmi"],mpeg:["mpga","mpega","mp2","mp3","m4a","mp2a","m2a","m3a"],mpegurl:"m3u",ogg:["oga","ogg","spx"],"x-aiff":["aif","aiff","aifc"],"x-ms-wma":"wma","x-wav":"wav",adpcm:"adp",mp4:"mp4a",webm:"weba","x-aac":"aac","x-caf":"caf","x-matroska":"mka","x-pn-realaudio-plugin":"rmp",xm:"xm",mid:["mid","rmi"]},image:{gif:"gif",ief:"ief",jpeg:["jpeg","jpg","jpe"],pcx:"pcx",png:"png","svg+xml":["svg","svgz"],tiff:["tiff","tif"],"x-icon":"ico",bmp:"bmp",webp:"webp","x-pict":["pic","pct"],"x-tga":"tga","cis-cod":"cod"},text:{"cache-manifest":["manifest","appcache"],css:"css",csv:"csv",html:["html","htm","shtml","stm"],mathml:"mml",plain:["txt","text","brf","conf","def","list","log","in","bas"],richtext:"rtx","tab-separated-values":"tsv","x-bibtex":"bib"},video:{mpeg:["mpeg","mpg","mpe","m1v","m2v","mp2","mpa","mpv2"],mp4:["mp4","mp4v","mpg4"],quicktime:["qt","mov"],ogg:"ogv","vnd.mpegurl":["mxu","m4u"],"x-flv":"flv","x-la-asf":["lsf","lsx"],"x-mng":"mng","x-ms-asf":["asf","asx","asr"],"x-ms-wm":"wm","x-ms-wmv":"wmv","x-ms-wmx":"wmx","x-ms-wvx":"wvx","x-msvideo":"avi","x-sgi-movie":"movie","x-matroska":["mpv","mkv","mk3d","mks"],"3gpp2":"3g2",h261:"h261",h263:"h263",h264:"h264",jpeg:"jpgv",jpm:["jpm","jpgm"],mj2:["mj2","mjp2"],"vnd.ms-playready.media.pyv":"pyv","vnd.uvvu.mp4":["uvu","uvvu"],"vnd.vivo":"viv",webm:"webm","x-f4v":"f4v","x-m4v":"m4v","x-ms-vob":"vob","x-smv":"smv"}},FD=function(){var r,e,t,n,i={};for(r in wa)if(wa.hasOwnProperty(r)){for(e in wa[r])if(wa[r].hasOwnProperty(e))if(t=wa[r][e],typeof t=="string")i[t]=r+"/"+e;else for(n=0;n<t.length;n++)i[t[n]]=r+"/"+e}return i}(),MD="text/plain";function BD(r){return r&&FD[r.split(".").pop().toLowerCase()]||MD}var UD={lookup:BD};sa.default=UD;Object.defineProperty(Vu,"__esModule",{value:!0});Vu.default=void 0;var K0=Rn,_a=Ee,$D=Gu(ts),zD=Gu(sa),q0=Gu(Cn),VD=Gu(Pu);function Gu(r){return r&&r.__esModule?r:{default:r}}class GD{constructor(e,t){this.settings={replacements:t&&t.replacements||"base64",archive:t&&t.archive,resolver:t&&t.resolver,request:t&&t.request},this.process(e)}process(e){this.manifest=e,this.resources=Object.keys(e).map(function(t){return e[t]}),this.replacementUrls=[],this.html=[],this.assets=[],this.css=[],this.urls=[],this.cssUrls=[],this.split(),this.splitUrls()}split(){this.html=this.resources.filter(function(e){if(e.type==="application/xhtml+xml"||e.type==="text/html")return!0}),this.assets=this.resources.filter(function(e){if(e.type!=="application/xhtml+xml"&&e.type!=="text/html")return!0}),this.css=this.resources.filter(function(e){if(e.type==="text/css")return!0})}splitUrls(){this.urls=this.assets.map(function(e){return e.href}.bind(this)),this.cssUrls=this.css.map(function(e){return e.href})}createUrl(e){var t=new $D.default(e),n=zD.default.lookup(t.filename);return this.settings.archive?this.settings.archive.createUrl(e,{base64:this.settings.replacements==="base64"}):this.settings.replacements==="base64"?this.settings.request(e,"blob").then(i=>(0,_a.blob2base64)(i)).then(i=>(0,_a.createBase64Url)(i,n)):this.settings.request(e,"blob").then(i=>(0,_a.createBlobUrl)(i,n))}replacements(){if(this.settings.replacements==="none")return new Promise(function(t){t(this.urls)}.bind(this));var e=this.urls.map(t=>{var n=this.settings.resolver(t);return this.createUrl(n).catch(i=>(console.error(i),null))});return Promise.all(e).then(t=>(this.replacementUrls=t.filter(n=>typeof n=="string"),t))}replaceCss(e,t){var n=[];return e=e||this.settings.archive,t=t||this.settings.resolver,this.cssUrls.forEach(function(i){var s=this.createCssFile(i,e,t).then(function(a){var o=this.urls.indexOf(i);o>-1&&(this.replacementUrls[o]=a)}.bind(this));n.push(s)}.bind(this)),Promise.all(n)}createCssFile(e){var t;if(VD.default.isAbsolute(e))return new Promise(function(a){a()});var n=this.settings.resolver(e),i;this.settings.archive?i=this.settings.archive.getText(n):i=this.settings.request(n,"text");var s=this.urls.map(a=>{var o=this.settings.resolver(a),l=new q0.default(n).relative(o);return l});return i?i.then(a=>(a=(0,K0.substitute)(a,s,this.replacementUrls),this.settings.replacements==="base64"?t=(0,_a.createBase64Url)(a,"text/css"):t=(0,_a.createBlobUrl)(a,"text/css"),t),a=>new Promise(function(o){o()})):new Promise(function(a){a()})}relativeTo(e,t){return t=t||this.settings.resolver,this.urls.map(function(n){var i=t(n),s=new q0.default(e).relative(i);return s}.bind(this))}get(e){var t=this.urls.indexOf(e);if(t!==-1)return this.replacementUrls.length?new Promise(function(n,i){n(this.replacementUrls[t])}.bind(this)):this.createUrl(e)}substitute(e,t){var n;return t?n=this.relativeTo(t):n=this.urls,(0,K0.substitute)(e,n,this.replacementUrls)}destroy(){this.settings=void 0,this.manifest=void 0,this.resources=void 0,this.replacementUrls=void 0,this.html=void 0,this.assets=void 0,this.css=void 0,this.urls=void 0,this.cssUrls=void 0}}var WD=GD;Vu.default=WD;var Wu={};Object.defineProperty(Wu,"__esModule",{value:!0});Wu.default=void 0;var HD=jD(tr),Pr=Ee;function jD(r){return r&&r.__esModule?r:{default:r}}class KD{constructor(e){this.pages=[],this.locations=[],this.epubcfi=new HD.default,this.firstPage=0,this.lastPage=0,this.totalPages=0,this.toc=void 0,this.ncx=void 0,e&&(this.pageList=this.parse(e)),this.pageList&&this.pageList.length&&this.process(this.pageList)}parse(e){var t=(0,Pr.qs)(e,"html"),n=(0,Pr.qs)(e,"ncx");if(t)return this.parseNav(e);if(n)return this.parseNcx(e)}parseNav(e){var t=(0,Pr.querySelectorByType)(e,"nav","page-list"),n=t?(0,Pr.qsa)(t,"li"):[],i=n.length,s,a=[],o;if(!n||i===0)return a;for(s=0;s<i;++s)o=this.item(n[s]),a.push(o);return a}parseNcx(e){var t=[],n=0,i,s,a,o=0;if(s=(0,Pr.qs)(e,"pageList"),!s||(a=(0,Pr.qsa)(s,"pageTarget"),o=a.length,!a||a.length===0))return t;for(n=0;n<o;++n)i=this.ncxItem(a[n]),t.push(i);return t}ncxItem(e){var t=(0,Pr.qs)(e,"navLabel"),n=(0,Pr.qs)(t,"text"),i=n.textContent,s=(0,Pr.qs)(e,"content"),a=s.getAttribute("src"),o=parseInt(i,10);return{href:a,page:o}}item(e){var t=(0,Pr.qs)(e,"a"),n=t.getAttribute("href")||"",i=t.textContent||"",s=parseInt(i),a=n.indexOf("epubcfi"),o,l,u;return a!=-1?(o=n.split("#"),l=o[0],u=o.length>1?o[1]:!1,{cfi:u,href:n,packageUrl:l,page:s}):{href:n,page:s}}process(e){e.forEach(function(t){this.pages.push(t.page),t.cfi&&this.locations.push(t.cfi)},this),this.firstPage=parseInt(this.pages[0]),this.lastPage=parseInt(this.pages[this.pages.length-1]),this.totalPages=this.lastPage-this.firstPage}pageFromCfi(e){var t=-1;if(this.locations.length===0)return-1;var n=(0,Pr.indexOfSorted)(e,this.locations,this.epubcfi.compare);return n!=-1?t=this.pages[n]:(n=(0,Pr.locationOf)(e,this.locations,this.epubcfi.compare),t=n-1>=0?this.pages[n-1]:this.pages[0],t!==void 0||(t=-1)),t}cfiFromPage(e){var t=-1;typeof e!="number"&&(e=parseInt(e));var n=this.pages.indexOf(e);return n!=-1&&(t=this.locations[n]),t}pageFromPercentage(e){var t=Math.round(this.totalPages*e);return t}percentageFromPage(e){var t=(e-this.firstPage)/this.totalPages;return Math.round(t*1e3)/1e3}percentageFromCfi(e){var t=this.pageFromCfi(e),n=this.percentageFromPage(t);return n}destroy(){this.pages=void 0,this.locations=void 0,this.epubcfi=void 0,this.pageList=void 0,this.toc=void 0,this.ncx=void 0}}var qD=KD;Wu.default=qD;var aa={},Do={};Object.defineProperty(Do,"__esModule",{value:!0});Do.default=void 0;var YD=Ee,XD=Lt,ZD=QD(Hr.exports);function QD(r){return r&&r.__esModule?r:{default:r}}class Ax{constructor(e){this.settings=e,this.name=e.layout||"reflowable",this._spread=e.spread!=="none",this._minSpreadWidth=e.minSpreadWidth||800,this._evenSpreads=e.evenSpreads||!1,e.flow==="scrolled"||e.flow==="scrolled-continuous"||e.flow==="scrolled-doc"?this._flow="scrolled":this._flow="paginated",this.width=0,this.height=0,this.spreadWidth=0,this.delta=0,this.columnWidth=0,this.gap=0,this.divisor=1,this.props={name:this.name,spread:this._spread,flow:this._flow,width:0,height:0,spreadWidth:0,delta:0,columnWidth:0,gap:0,divisor:1}}flow(e){return typeof e<"u"&&(e==="scrolled"||e==="scrolled-continuous"||e==="scrolled-doc"?this._flow="scrolled":this._flow="paginated",this.update({flow:this._flow})),this._flow}spread(e,t){return e&&(this._spread=e!=="none",this.update({spread:this._spread})),t>=0&&(this._minSpreadWidth=t),this._spread}calculate(e,t,n){var i=1,s=n||0,a=e,o=t,l=Math.floor(a/12),u,c,f,h;this._spread&&a>=this._minSpreadWidth?i=2:i=1,this.name==="reflowable"&&this._flow==="paginated"&&!(n>=0)&&(s=l%2===0?l:l-1),this.name==="pre-paginated"&&(s=0),i>1?(u=a/i-s,f=u+s):(u=a,f=a),this.name==="pre-paginated"&&i>1&&(a=u),c=u*i+s,h=a,this.width=a,this.height=o,this.spreadWidth=c,this.pageWidth=f,this.delta=h,this.columnWidth=u,this.gap=s,this.divisor=i,this.update({width:a,height:o,spreadWidth:c,pageWidth:f,delta:h,columnWidth:u,gap:s,divisor:i})}format(e,t,n){var i;return this.name==="pre-paginated"?i=e.fit(this.columnWidth,this.height,t):this._flow==="paginated"?i=e.columns(this.width,this.height,this.columnWidth,this.gap,this.settings.direction):n&&n==="horizontal"?i=e.size(null,this.height):i=e.size(this.width,null),i}count(e,t){let n,i;return this.name==="pre-paginated"?(n=1,i=1):this._flow==="paginated"?(t=t||this.delta,n=Math.ceil(e/t),i=n*this.divisor):(t=t||this.height,n=Math.ceil(e/t),i=n),{spreads:n,pages:i}}update(e){if(Object.keys(e).forEach(t=>{this.props[t]===e[t]&&delete e[t]}),Object.keys(e).length>0){let t=(0,YD.extend)(this.props,e);this.emit(XD.EVENTS.LAYOUT.UPDATED,t,e)}}}(0,ZD.default)(Ax.prototype);var JD=Ax;Do.default=JD;var Hu={};Object.defineProperty(Hu,"__esModule",{value:!0});Hu.default=void 0;var eC=tC(ts);function tC(r){return r&&r.__esModule?r:{default:r}}class rC{constructor(e){this.rendition=e,this._themes={default:{rules:{},url:"",serialized:""}},this._overrides={},this._current="default",this._injected=[],this.rendition.hooks.content.register(this.inject.bind(this)),this.rendition.hooks.content.register(this.overrides.bind(this))}register(){if(arguments.length!==0){if(arguments.length===1&&typeof arguments[0]=="object")return this.registerThemes(arguments[0]);if(arguments.length===1&&typeof arguments[0]=="string")return this.default(arguments[0]);if(arguments.length===2&&typeof arguments[1]=="string")return this.registerUrl(arguments[0],arguments[1]);if(arguments.length===2&&typeof arguments[1]=="object")return this.registerRules(arguments[0],arguments[1])}}default(e){if(!!e){if(typeof e=="string")return this.registerUrl("default",e);if(typeof e=="object")return this.registerRules("default",e)}}registerThemes(e){for(var t in e)e.hasOwnProperty(t)&&(typeof e[t]=="string"?this.registerUrl(t,e[t]):this.registerRules(t,e[t]))}registerCss(e,t){this._themes[e]={serialized:t},(this._injected[e]||e=="default")&&this.update(e)}registerUrl(e,t){var n=new eC.default(t);this._themes[e]={url:n.toString()},(this._injected[e]||e=="default")&&this.update(e)}registerRules(e,t){this._themes[e]={rules:t},(this._injected[e]||e=="default")&&this.update(e)}select(e){var t=this._current,n;this._current=e,this.update(e),n=this.rendition.getContents(),n.forEach(i=>{i.removeClass(t),i.addClass(e)})}update(e){var t=this.rendition.getContents();t.forEach(n=>{this.add(e,n)})}inject(e){var t=[],n=this._themes,i;for(var s in n)n.hasOwnProperty(s)&&(s===this._current||s==="default")&&(i=n[s],(i.rules&&Object.keys(i.rules).length>0||i.url&&t.indexOf(i.url)===-1)&&this.add(s,e),this._injected.push(s));this._current!="default"&&e.addClass(this._current)}add(e,t){var n=this._themes[e];!n||!t||(n.url?t.addStylesheet(n.url):n.serialized?(t.addStylesheetCss(n.serialized,e),n.injected=!0):n.rules&&(t.addStylesheetRules(n.rules,e),n.injected=!0))}override(e,t,n){var i=this.rendition.getContents();this._overrides[e]={value:t,priority:n===!0},i.forEach(s=>{s.css(e,this._overrides[e].value,this._overrides[e].priority)})}removeOverride(e){var t=this.rendition.getContents();delete this._overrides[e],t.forEach(n=>{n.css(e)})}overrides(e){var t=this._overrides;for(var n in t)t.hasOwnProperty(n)&&e.css(n,t[n].value,t[n].priority)}fontSize(e){this.override("font-size",e)}font(e){this.override("font-family",e,!0)}destroy(){this.rendition=void 0,this._themes=void 0,this._overrides=void 0,this._current=void 0,this._injected=void 0}}var nC=rC;Hu.default=nC;var ns={},Co={};Object.defineProperty(Co,"__esModule",{value:!0});Co.default=void 0;var pl=iC(tr),Y0=Ee;function iC(r){return r&&r.__esModule?r:{default:r}}class sC{constructor(e,t,n,i=!1){this.layout=e,this.horizontal=n==="horizontal",this.direction=t||"ltr",this._dev=i}section(e){var t=this.findRanges(e),n=this.rangeListToCfiList(e.section.cfiBase,t);return n}page(e,t,n,i){var s=e&&e.document?e.document.body:!1,a;if(!!s){if(a=this.rangePairToCfiPair(t,{start:this.findStart(s,n,i),end:this.findEnd(s,n,i)}),this._dev===!0){let o=e.document,l=new pl.default(a.start).toRange(o),u=new pl.default(a.end).toRange(o),c=o.defaultView.getSelection(),f=o.createRange();c.removeAllRanges(),f.setStart(l.startContainer,l.startOffset),f.setEnd(u.endContainer,u.endOffset),c.addRange(f)}return a}}walk(e,t){if(!(e&&e.nodeType===Node.TEXT_NODE)){var n={acceptNode:function(l){return l.data.trim().length>0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}},i=n.acceptNode;i.acceptNode=n.acceptNode;for(var s=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,i,!1),a,o;(a=s.nextNode())&&(o=t(a),!o););return o}}findRanges(e){for(var t=[],n=e.contents.scrollWidth(),i=Math.ceil(n/this.layout.spreadWidth),s=i*this.layout.divisor,a=this.layout.columnWidth,o=this.layout.gap,l,u,c=0;c<s.pages;c++)l=(a+o)*c,u=a*(c+1)+o*c,t.push({start:this.findStart(e.document.body,l,u),end:this.findEnd(e.document.body,l,u)});return t}findStart(e,t,n){for(var i=[e],s,a,o=e;i.length;)if(s=i.shift(),a=this.walk(s,l=>{var u,c,f,h,d;if(d=(0,Y0.nodeBounds)(l),this.horizontal&&this.direction==="ltr"){if(u=this.horizontal?d.left:d.top,c=this.horizontal?d.right:d.bottom,u>=t&&u<=n)return l;if(c>t)return l;o=l,i.push(l)}else if(this.horizontal&&this.direction==="rtl"){if(u=d.left,c=d.right,c<=n&&c>=t)return l;if(u<n)return l;o=l,i.push(l)}else{if(f=d.top,h=d.bottom,f>=t&&f<=n)return l;if(h>t)return l;o=l,i.push(l)}}),a)return this.findTextStartRange(a,t,n);return this.findTextStartRange(o,t,n)}findEnd(e,t,n){for(var i=[e],s,a=e,o;i.length;)if(s=i.shift(),o=this.walk(s,l=>{var u,c,f,h,d;if(d=(0,Y0.nodeBounds)(l),this.horizontal&&this.direction==="ltr"){if(u=Math.round(d.left),c=Math.round(d.right),u>n&&a)return a;if(c>n)return l;a=l,i.push(l)}else if(this.horizontal&&this.direction==="rtl"){if(u=Math.round(this.horizontal?d.left:d.top),c=Math.round(this.horizontal?d.right:d.bottom),c<t&&a)return a;if(u<t)return l;a=l,i.push(l)}else{if(f=Math.round(d.top),h=Math.round(d.bottom),f>n&&a)return a;if(h>n)return l;a=l,i.push(l)}}),o)return this.findTextEndRange(o,t,n);return this.findTextEndRange(a,t,n)}findTextStartRange(e,t,n){for(var i=this.splitTextNodeIntoRanges(e),s,a,o,l,u,c=0;c<i.length;c++)if(s=i[c],a=s.getBoundingClientRect(),this.horizontal&&this.direction==="ltr"){if(o=a.left,o>=t)return s}else if(this.horizontal&&this.direction==="rtl"){if(u=a.right,u<=n)return s}else if(l=a.top,l>=t)return s;return i[0]}findTextEndRange(e,t,n){for(var i=this.splitTextNodeIntoRanges(e),s,a,o,l,u,c,f,h=0;h<i.length;h++){if(a=i[h],o=a.getBoundingClientRect(),this.horizontal&&this.direction==="ltr"){if(l=o.left,u=o.right,l>n&&s)return s;if(u>n)return a}else if(this.horizontal&&this.direction==="rtl"){if(l=o.left,u=o.right,u<t&&s)return s;if(l<t)return a}else{if(c=o.top,f=o.bottom,c>n&&s)return s;if(f>n)return a}s=a}return i[i.length-1]}splitTextNodeIntoRanges(e,t){var n=[],i=e.textContent||"",s=i.trim(),a,o=e.ownerDocument,l=t||" ",u=s.indexOf(l);if(u===-1||e.nodeType!=Node.TEXT_NODE)return a=o.createRange(),a.selectNodeContents(e),[a];for(a=o.createRange(),a.setStart(e,0),a.setEnd(e,u),n.push(a),a=!1;u!=-1;)u=s.indexOf(l,u+1),u>0&&(a&&(a.setEnd(e,u),n.push(a)),a=o.createRange(),a.setStart(e,u+1));return a&&(a.setEnd(e,s.length),n.push(a)),n}rangePairToCfiPair(e,t){var n=t.start,i=t.end;n.collapse(!0),i.collapse(!1);let s=new pl.default(n,e).toString(),a=new pl.default(i,e).toString();return{start:s,end:a}}rangeListToCfiList(e,t){for(var n=[],i,s=0;s<t.length;s++)i=this.rangePairToCfiPair(e,t[s]),n.push(i);return n}axis(e){return e&&(this.horizontal=e==="horizontal"),this.horizontal}}var aC=sC;Co.default=aC;Object.defineProperty(ns,"__esModule",{value:!0});ns.default=void 0;var oC=lp(Hr.exports),Jr=Ee,xs=lp(tr),X0=lp(Co),lC=Rn,Nn=Lt;function lp(r){return r&&r.__esModule?r:{default:r}}const bx=typeof navigator<"u",uC=bx&&/Chrome/.test(navigator.userAgent),Z0=bx&&!uC&&/AppleWebKit/.test(navigator.userAgent),cC=1;class Dx{constructor(e,t,n,i){this.epubcfi=new xs.default,this.document=e,this.documentElement=this.document.documentElement,this.content=t||this.document.body,this.window=this.document.defaultView,this._size={width:0,height:0},this.sectionIndex=i||0,this.cfiBase=n||"",this.epubReadingSystem("epub.js",Nn.EPUBJS_VERSION),this.called=0,this.active=!0,this.listeners()}static get listenedEvents(){return Nn.DOM_EVENTS}width(e){var t=this.content;return e&&(0,Jr.isNumber)(e)&&(e=e+"px"),e&&(t.style.width=e),parseInt(this.window.getComputedStyle(t).width)}height(e){var t=this.content;return e&&(0,Jr.isNumber)(e)&&(e=e+"px"),e&&(t.style.height=e),parseInt(this.window.getComputedStyle(t).height)}contentWidth(e){var t=this.content||this.document.body;return e&&(0,Jr.isNumber)(e)&&(e=e+"px"),e&&(t.style.width=e),parseInt(this.window.getComputedStyle(t).width)}contentHeight(e){var t=this.content||this.document.body;return e&&(0,Jr.isNumber)(e)&&(e=e+"px"),e&&(t.style.height=e),parseInt(this.window.getComputedStyle(t).height)}textWidth(){let e,t,n=this.document.createRange(),i=this.content||this.document.body,s=(0,Jr.borders)(i);return n.selectNodeContents(i),e=n.getBoundingClientRect(),t=e.width,s&&s.width&&(t+=s.width),Math.round(t)}textHeight(){let e,t,n=this.document.createRange(),i=this.content||this.document.body;return n.selectNodeContents(i),e=n.getBoundingClientRect(),t=e.bottom,Math.round(t)}scrollWidth(){var e=this.documentElement.scrollWidth;return e}scrollHeight(){var e=this.documentElement.scrollHeight;return e}overflow(e){return e&&(this.documentElement.style.overflow=e),this.window.getComputedStyle(this.documentElement).overflow}overflowX(e){return e&&(this.documentElement.style.overflowX=e),this.window.getComputedStyle(this.documentElement).overflowX}overflowY(e){return e&&(this.documentElement.style.overflowY=e),this.window.getComputedStyle(this.documentElement).overflowY}css(e,t,n){var i=this.content||this.document.body;return t?i.style.setProperty(e,t,n?"important":""):i.style.removeProperty(e),this.window.getComputedStyle(i)[e]}viewport(e){var t=this.document.querySelector("meta[name='viewport']"),n={width:void 0,height:void 0,scale:void 0,minimum:void 0,maximum:void 0,scalable:void 0},i=[],s={};if(t&&t.hasAttribute("content")){let a=t.getAttribute("content"),o=a.match(/width\s*=\s*([^,]*)/),l=a.match(/height\s*=\s*([^,]*)/),u=a.match(/initial-scale\s*=\s*([^,]*)/),c=a.match(/minimum-scale\s*=\s*([^,]*)/),f=a.match(/maximum-scale\s*=\s*([^,]*)/),h=a.match(/user-scalable\s*=\s*([^,]*)/);o&&o.length&&typeof o[1]<"u"&&(n.width=o[1]),l&&l.length&&typeof l[1]<"u"&&(n.height=l[1]),u&&u.length&&typeof u[1]<"u"&&(n.scale=u[1]),c&&c.length&&typeof c[1]<"u"&&(n.minimum=c[1]),f&&f.length&&typeof f[1]<"u"&&(n.maximum=f[1]),h&&h.length&&typeof h[1]<"u"&&(n.scalable=h[1])}return s=(0,Jr.defaults)(e||{},n),e&&(s.width&&i.push("width="+s.width),s.height&&i.push("height="+s.height),s.scale&&i.push("initial-scale="+s.scale),s.scalable==="no"?(i.push("minimum-scale="+s.scale),i.push("maximum-scale="+s.scale),i.push("user-scalable="+s.scalable)):(s.scalable&&i.push("user-scalable="+s.scalable),s.minimum&&i.push("minimum-scale="+s.minimum),s.maximum&&i.push("minimum-scale="+s.maximum)),t||(t=this.document.createElement("meta"),t.setAttribute("name","viewport"),this.document.querySelector("head").appendChild(t)),t.setAttribute("content",i.join(", ")),this.window.scrollTo(0,0)),s}expand(){this.emit(Nn.EVENTS.CONTENTS.EXPAND)}listeners(){this.imageLoadListeners(),this.mediaQueryListeners(),this.addEventListeners(),this.addSelectionListeners(),typeof ResizeObserver>"u"?(this.resizeListeners(),this.visibilityListeners()):this.resizeObservers(),this.linksHandler()}removeListeners(){this.removeEventListeners(),this.removeSelectionListeners(),this.observer&&this.observer.disconnect(),clearTimeout(this.expanding)}resizeCheck(){let e=this.textWidth(),t=this.textHeight();(e!=this._size.width||t!=this._size.height)&&(this._size={width:e,height:t},this.onResize&&this.onResize(this._size),this.emit(Nn.EVENTS.CONTENTS.RESIZE,this._size))}resizeListeners(){clearTimeout(this.expanding),requestAnimationFrame(this.resizeCheck.bind(this)),this.expanding=setTimeout(this.resizeListeners.bind(this),350)}visibilityListeners(){document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&this.active===!1?(this.active=!0,this.resizeListeners()):(this.active=!1,clearTimeout(this.expanding))})}transitionListeners(){let e=this.content;e.style.transitionProperty="font, font-size, font-size-adjust, font-stretch, font-variation-settings, font-weight, width, height",e.style.transitionDuration="0.001ms",e.style.transitionTimingFunction="linear",e.style.transitionDelay="0",this._resizeCheck=this.resizeCheck.bind(this),this.document.addEventListener("transitionend",this._resizeCheck)}mediaQueryListeners(){for(var e=this.document.styleSheets,t=function(o){o.matches&&!this._expanding&&setTimeout(this.expand.bind(this),1)}.bind(this),n=0;n<e.length;n+=1){var i;try{i=e[n].cssRules}catch{return}if(!i)return;for(var s=0;s<i.length;s+=1)if(i[s].media){var a=this.window.matchMedia(i[s].media.mediaText);a.addListener(t)}}}resizeObservers(){this.observer=new ResizeObserver(e=>{requestAnimationFrame(this.resizeCheck.bind(this))}),this.observer.observe(this.document.documentElement)}mutationObservers(){this.observer=new MutationObserver(t=>{this.resizeCheck()});let e={attributes:!0,childList:!0,characterData:!0,subtree:!0};this.observer.observe(this.document,e)}imageLoadListeners(){for(var e=this.document.querySelectorAll("img"),t,n=0;n<e.length;n++)t=e[n],typeof t.naturalWidth<"u"&&t.naturalWidth===0&&(t.onload=this.expand.bind(this))}fontLoadListeners(){!this.document||!this.document.fonts||this.document.fonts.ready.then(function(){this.resizeCheck()}.bind(this))}root(){return this.document?this.document.documentElement:null}locationOf(e,t){var n,i={left:0,top:0};if(!this.document)return i;if(this.epubcfi.isCfiString(e)){let s=new xs.default(e).toRange(this.document,t);if(s){try{if(!s.endContainer||s.startContainer==s.endContainer&&s.startOffset==s.endOffset){let a=s.startContainer.textContent.indexOf(" ",s.startOffset);a==-1&&(a=s.startContainer.textContent.length),s.setEnd(s.startContainer,a)}}catch(a){console.error("setting end offset to start container length failed",a)}if(s.startContainer.nodeType===Node.ELEMENT_NODE)n=s.startContainer.getBoundingClientRect(),i.left=n.left,i.top=n.top;else if(Z0){let a=s.startContainer,o=new Range;try{a.nodeType===cC?n=a.getBoundingClientRect():s.startOffset+2<a.length?(o.setStart(a,s.startOffset),o.setEnd(a,s.startOffset+2),n=o.getBoundingClientRect()):s.startOffset-2>0?(o.setStart(a,s.startOffset-2),o.setEnd(a,s.startOffset),n=o.getBoundingClientRect()):n=a.parentNode.getBoundingClientRect()}catch(l){console.error(l,l.stack)}}else n=s.getBoundingClientRect()}}else if(typeof e=="string"&&e.indexOf("#")>-1){let s=e.substring(e.indexOf("#")+1),a=this.document.getElementById(s);if(a)if(Z0){let o=new Range;o.selectNode(a),n=o.getBoundingClientRect()}else n=a.getBoundingClientRect()}return n&&(i.left=n.left,i.top=n.top),i}addStylesheet(e){return new Promise(function(t,n){var i,s=!1;if(!this.document){t(!1);return}if(i=this.document.querySelector("link[href='"+e+"']"),i){t(!0);return}i=this.document.createElement("link"),i.type="text/css",i.rel="stylesheet",i.href=e,i.onload=i.onreadystatechange=function(){!s&&(!this.readyState||this.readyState=="complete")&&(s=!0,setTimeout(()=>{t(!0)},1))},this.document.head.appendChild(i)}.bind(this))}_getStylesheetNode(e){var t;return e="epubjs-inserted-css-"+(e||""),this.document?(t=this.document.getElementById(e),t||(t=this.document.createElement("style"),t.id=e,this.document.head.appendChild(t)),t):!1}addStylesheetCss(e,t){if(!this.document||!e)return!1;var n;return n=this._getStylesheetNode(t),n.innerHTML=e,!0}addStylesheetRules(e,t){var n;if(!(!this.document||!e||e.length===0))if(n=this._getStylesheetNode(t).sheet,Object.prototype.toString.call(e)==="[object Array]")for(var i=0,s=e.length;i<s;i++){var a=1,o=e[i],l=e[i][0],u="";Object.prototype.toString.call(o[1][0])==="[object Array]"&&(o=o[1],a=0);for(var c=o.length;a<c;a++){var f=o[a];u+=f[0]+":"+f[1]+(f[2]?" !important":"")+`;
`}n.insertRule(l+"{"+u+"}",n.cssRules.length)}else Object.keys(e).forEach(d=>{const m=e[d];if(Array.isArray(m))m.forEach(x=>{const g=Object.keys(x).map(v=>`${v}:${x[v]}`).join(";");n.insertRule(`${d}{${g}}`,n.cssRules.length)});else{const p=Object.keys(m).map(g=>`${g}:${m[g]}`).join(";");n.insertRule(`${d}{${p}}`,n.cssRules.length)}})}addScript(e){return new Promise(function(t,n){var i,s=!1;if(!this.document){t(!1);return}i=this.document.createElement("script"),i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){!s&&(!this.readyState||this.readyState=="complete")&&(s=!0,setTimeout(function(){t(!0)},1))},this.document.head.appendChild(i)}.bind(this))}addClass(e){var t;!this.document||(t=this.content||this.document.body,t&&t.classList.add(e))}removeClass(e){var t;!this.document||(t=this.content||this.document.body,t&&t.classList.remove(e))}addEventListeners(){!this.document||(this._triggerEvent=this.triggerEvent.bind(this),Nn.DOM_EVENTS.forEach(function(e){this.document.addEventListener(e,this._triggerEvent,{passive:!0})},this))}removeEventListeners(){!this.document||(Nn.DOM_EVENTS.forEach(function(e){this.document.removeEventListener(e,this._triggerEvent,{passive:!0})},this),this._triggerEvent=void 0)}triggerEvent(e){this.emit(e.type,e)}addSelectionListeners(){!this.document||(this._onSelectionChange=this.onSelectionChange.bind(this),this.document.addEventListener("selectionchange",this._onSelectionChange,{passive:!0}))}removeSelectionListeners(){!this.document||(this.document.removeEventListener("selectionchange",this._onSelectionChange,{passive:!0}),this._onSelectionChange=void 0)}onSelectionChange(e){this.selectionEndTimeout&&clearTimeout(this.selectionEndTimeout),this.selectionEndTimeout=setTimeout(function(){var t=this.window.getSelection();this.triggerSelectedEvent(t)}.bind(this),250)}triggerSelectedEvent(e){var t,n;e&&e.rangeCount>0&&(t=e.getRangeAt(0),t.collapsed||(n=new xs.default(t,this.cfiBase).toString(),this.emit(Nn.EVENTS.CONTENTS.SELECTED,n),this.emit(Nn.EVENTS.CONTENTS.SELECTED_RANGE,t)))}range(e,t){var n=new xs.default(e);return n.toRange(this.document,t)}cfiFromRange(e,t){return new xs.default(e,this.cfiBase,t).toString()}cfiFromNode(e,t){return new xs.default(e,this.cfiBase,t).toString()}map(e){var t=new X0.default(e);return t.section()}size(e,t){var n={scale:1,scalable:"no"};this.layoutStyle("scrolling"),e>=0&&(this.width(e),n.width=e,this.css("padding","0 "+e/12+"px")),t>=0&&(this.height(t),n.height=t),this.css("margin","0"),this.css("box-sizing","border-box"),this.viewport(n)}columns(e,t,n,i,s){let a=(0,Jr.prefixed)("column-axis"),o=(0,Jr.prefixed)("column-gap"),l=(0,Jr.prefixed)("column-width"),u=(0,Jr.prefixed)("column-fill"),f=this.writingMode().indexOf("vertical")===0?"vertical":"horizontal";this.layoutStyle("paginated"),s==="rtl"&&f==="horizontal"&&this.direction(s),this.width(e),this.height(t),this.viewport({width:e,height:t,scale:1,scalable:"no"}),this.css("overflow-y","hidden"),this.css("margin","0",!0),f==="vertical"?(this.css("padding-top",i/2+"px",!0),this.css("padding-bottom",i/2+"px",!0),this.css("padding-left","20px"),this.css("padding-right","20px"),this.css(a,"vertical")):(this.css("padding-top","20px"),this.css("padding-bottom","20px"),this.css("padding-left",i/2+"px",!0),this.css("padding-right",i/2+"px",!0),this.css(a,"horizontal")),this.css("box-sizing","border-box"),this.css("max-width","inherit"),this.css(u,"auto"),this.css(o,i+"px"),this.css(l,n+"px"),this.css("-webkit-line-box-contain","block glyphs replaced")}scaler(e,t,n){var i="scale("+e+")",s="";this.css("transform-origin","top left"),(t>=0||n>=0)&&(s=" translate("+(t||0)+"px, "+(n||0)+"px )"),this.css("transform",i+s)}fit(e,t,n){var i=this.viewport(),s=parseInt(i.width),a=parseInt(i.height),o=e/s,l=t/a,u=o<l?o:l;if(this.layoutStyle("paginated"),this.width(s),this.height(a),this.overflow("hidden"),this.scaler(u,0,0),this.css("background-size",s*u+"px "+a*u+"px"),this.css("background-color","transparent"),n&&n.properties.includes("page-spread-left")){var c=e-s*u;this.css("margin-left",c+"px")}}direction(e){this.documentElement&&(this.documentElement.style.direction=e)}mapPage(e,t,n,i,s){var a=new X0.default(t,s);return a.page(this,e,n,i)}linksHandler(){(0,lC.replaceLinks)(this.content,e=>{this.emit(Nn.EVENTS.CONTENTS.LINK_CLICKED,e)})}writingMode(e){let t=(0,Jr.prefixed)("writing-mode");return e&&this.documentElement&&(this.documentElement.style[t]=e),this.window.getComputedStyle(this.documentElement)[t]||""}layoutStyle(e){return e&&(this._layoutStyle=e,navigator.epubReadingSystem.layoutStyle=this._layoutStyle),this._layoutStyle||"paginated"}epubReadingSystem(e,t){return navigator.epubReadingSystem={name:e,version:t,layoutStyle:this.layoutStyle(),hasFeature:function(n){switch(n){case"dom-manipulation":return!0;case"layout-changes":return!0;case"touch-events":return!0;case"mouse-events":return!0;case"keyboard-events":return!0;case"spine-scripting":return!1;default:return!1}}},navigator.epubReadingSystem}destroy(){this.removeListeners()}}(0,oC.default)(Dx.prototype);var fC=Dx;ns.default=fC;var ju={};Object.defineProperty(ju,"__esModule",{value:!0});ju.default=void 0;var hC=Cx(Hr.exports),dC=Cx(tr),Q0=Lt;function Cx(r){return r&&r.__esModule?r:{default:r}}class pC{constructor(e){this.rendition=e,this.highlights=[],this.underlines=[],this.marks=[],this._annotations={},this._annotationsBySectionIndex={},this.rendition.hooks.render.register(this.inject.bind(this)),this.rendition.hooks.unloaded.register(this.clear.bind(this))}add(e,t,n,i,s,a){let o=encodeURI(t+e),u=new dC.default(t).spinePos,c=new Rx({type:e,cfiRange:t,data:n,sectionIndex:u,cb:i,className:s,styles:a});return this._annotations[o]=c,u in this._annotationsBySectionIndex?this._annotationsBySectionIndex[u].push(o):this._annotationsBySectionIndex[u]=[o],this.rendition.views().forEach(h=>{c.sectionIndex===h.index&&c.attach(h)}),c}remove(e,t){let n=encodeURI(e+t);if(n in this._annotations){let i=this._annotations[n];if(t&&i.type!==t)return;this.rendition.views().forEach(a=>{this._removeFromAnnotationBySectionIndex(i.sectionIndex,n),i.sectionIndex===a.index&&i.detach(a)}),delete this._annotations[n]}}_removeFromAnnotationBySectionIndex(e,t){this._annotationsBySectionIndex[e]=this._annotationsAt(e).filter(n=>n!==t)}_annotationsAt(e){return this._annotationsBySectionIndex[e]}highlight(e,t,n,i,s){return this.add("highlight",e,t,n,i,s)}underline(e,t,n,i,s){return this.add("underline",e,t,n,i,s)}mark(e,t,n){return this.add("mark",e,t,n)}each(){return this._annotations.forEach.apply(this._annotations,arguments)}inject(e){let t=e.index;t in this._annotationsBySectionIndex&&this._annotationsBySectionIndex[t].forEach(i=>{this._annotations[i].attach(e)})}clear(e){let t=e.index;t in this._annotationsBySectionIndex&&this._annotationsBySectionIndex[t].forEach(i=>{this._annotations[i].detach(e)})}show(){}hide(){}}class Rx{constructor({type:e,cfiRange:t,data:n,sectionIndex:i,cb:s,className:a,styles:o}){this.type=e,this.cfiRange=t,this.data=n,this.sectionIndex=i,this.mark=void 0,this.cb=s,this.className=a,this.styles=o}update(e){this.data=e}attach(e){let{cfiRange:t,data:n,type:i,mark:s,cb:a,className:o,styles:l}=this,u;return i==="highlight"?u=e.highlight(t,n,a,o,l):i==="underline"?u=e.underline(t,n,a,o,l):i==="mark"&&(u=e.mark(t,n,a)),this.mark=u,this.emit(Q0.EVENTS.ANNOTATION.ATTACH,u),u}detach(e){let{cfiRange:t,type:n}=this,i;return e&&(n==="highlight"?i=e.unhighlight(t):n==="underline"?i=e.ununderline(t):n==="mark"&&(i=e.unmark(t))),this.mark=void 0,this.emit(Q0.EVENTS.ANNOTATION.DETACH,i),i}text(){}}(0,hC.default)(Rx.prototype);var gC=pC;ju.default=gC;var Ro={},Sn={},Ku={};Object.defineProperty(Ku,"__esModule",{value:!0});Ku.createElement=Lx;function Lx(r){return document.createElementNS("http://www.w3.org/2000/svg",r)}Ku.default={createElement:Lx};var Lo={};Object.defineProperty(Lo,"__esModule",{value:!0});Lo.proxyMouse=Ix;Lo.clone=kx;Lo.default={proxyMouse:Ix};function Ix(r,e){function t(a){for(var o=e.length-1;o>=0;o--){var l=e[o],u=a.clientX,c=a.clientY;if(a.touches&&a.touches.length&&(u=a.touches[0].clientX,c=a.touches[0].clientY),!!mC(l,r,u,c)){l.dispatchEvent(kx(a));break}}}if(r.nodeName==="iframe"||r.nodeName==="IFRAME")try{this.target=r.contentDocument}catch{this.target=r}else this.target=r;for(var n=["mouseup","mousedown","click","touchstart"],i=0;i<n.length;i++){var s=n[i];this.target.addEventListener(s,function(a){return t(a)},!1)}}function kx(r){var e=Object.assign({},r,{bubbles:!1});try{return new MouseEvent(r.type,e)}catch{var t=document.createEvent("MouseEvents");return t.initMouseEvent(r.type,!1,e.cancelable,e.view,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget),t}}function mC(r,e,t,n){var i=e.getBoundingClientRect();function s(c,f,h){var d=c.top-i.top,m=c.left-i.left,x=d+c.height,p=m+c.width;return d<=h&&m<=f&&x>h&&p>f}var a=r.getBoundingClientRect();if(!s(a,t,n))return!1;for(var o=r.getClientRects(),l=0,u=o.length;l<u;l++)if(s(o[l],t,n))return!0;return!1}Object.defineProperty(Sn,"__esModule",{value:!0});Sn.Underline=Sn.Highlight=Sn.Mark=Sn.Pane=void 0;var vC=function r(e,t,n){e===null&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,t);if(i===void 0){var s=Object.getPrototypeOf(e);return s===null?void 0:r(s,t,n)}else{if("value"in i)return i.value;var a=i.get;return a===void 0?void 0:a.call(n)}},qu=function(){function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),yC=Ku,po=Ox(yC),EC=Lo,xC=Ox(EC);function Ox(r){return r&&r.__esModule?r:{default:r}}function Nx(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function Px(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}function Yu(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}Sn.Pane=function(){function r(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document.body;Yu(this,r),this.target=e,this.element=po.default.createElement("svg"),this.marks=[],this.element.style.position="absolute",this.element.setAttribute("pointer-events","none"),xC.default.proxyMouse(this.target,this.marks),this.container=t,this.container.appendChild(this.element),this.render()}return qu(r,[{key:"addMark",value:function(t){var n=po.default.createElement("g");return this.element.appendChild(n),t.bind(n,this.container),this.marks.push(t),t.render(),t}},{key:"removeMark",value:function(t){var n=this.marks.indexOf(t);if(n!==-1){var i=t.unbind();this.element.removeChild(i),this.marks.splice(n,1)}}},{key:"render",value:function(){_C(this.element,wC(this.target,this.container));var t=!0,n=!1,i=void 0;try{for(var s=this.marks[Symbol.iterator](),a;!(t=(a=s.next()).done);t=!0){var o=a.value;o.render()}}catch(l){n=!0,i=l}finally{try{!t&&s.return&&s.return()}finally{if(n)throw i}}}}]),r}();var TC=Sn.Mark=function(){function r(){Yu(this,r),this.element=null}return qu(r,[{key:"bind",value:function(t,n){this.element=t,this.container=n}},{key:"unbind",value:function(){var t=this.element;return this.element=null,t}},{key:"render",value:function(){}},{key:"dispatchEvent",value:function(t){!this.element||this.element.dispatchEvent(t)}},{key:"getBoundingClientRect",value:function(){return this.element.getBoundingClientRect()}},{key:"getClientRects",value:function(){for(var t=[],n=this.element.firstChild;n;)t.push(n.getBoundingClientRect()),n=n.nextSibling;return t}},{key:"filteredRanges",value:function(){var t=Array.from(this.range.getClientRects());return t.filter(function(n){for(var i=0;i<t.length;i++){if(t[i]===n)return!0;var s=AC(t[i],n);if(s)return!1}return!0})}}]),r}(),SC=Sn.Highlight=function(r){Px(e,r);function e(t,n,i,s){Yu(this,e);var a=Nx(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return a.range=t,a.className=n,a.data=i||{},a.attributes=s||{},a}return qu(e,[{key:"bind",value:function(n,i){vC(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"bind",this).call(this,n,i);for(var s in this.data)this.data.hasOwnProperty(s)&&(this.element.dataset[s]=this.data[s]);for(var s in this.attributes)this.attributes.hasOwnProperty(s)&&this.element.setAttribute(s,this.attributes[s]);this.className&&this.element.classList.add(this.className)}},{key:"render",value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var n=this.element.ownerDocument.createDocumentFragment(),i=this.filteredRanges(),s=this.element.getBoundingClientRect(),a=this.container.getBoundingClientRect(),o=0,l=i.length;o<l;o++){var u=i[o],c=po.default.createElement("rect");c.setAttribute("x",u.left-s.left+a.left),c.setAttribute("y",u.top-s.top+a.top),c.setAttribute("height",u.height),c.setAttribute("width",u.width),n.appendChild(c)}this.element.appendChild(n)}}]),e}(TC);Sn.Underline=function(r){Px(e,r);function e(t,n,i,s){return Yu(this,e),Nx(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,i,s))}return qu(e,[{key:"render",value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var n=this.element.ownerDocument.createDocumentFragment(),i=this.filteredRanges(),s=this.element.getBoundingClientRect(),a=this.container.getBoundingClientRect(),o=0,l=i.length;o<l;o++){var u=i[o],c=po.default.createElement("rect");c.setAttribute("x",u.left-s.left+a.left),c.setAttribute("y",u.top-s.top+a.top),c.setAttribute("height",u.height),c.setAttribute("width",u.width),c.setAttribute("fill","none");var f=po.default.createElement("line");f.setAttribute("x1",u.left-s.left+a.left),f.setAttribute("x2",u.left-s.left+a.left+u.width),f.setAttribute("y1",u.top-s.top+a.top+u.height-1),f.setAttribute("y2",u.top-s.top+a.top+u.height-1),f.setAttribute("stroke-width",1),f.setAttribute("stroke","black"),f.setAttribute("stroke-linecap","square"),n.appendChild(c),n.appendChild(f)}this.element.appendChild(n)}}]),e}(SC);function wC(r,e){var t=e.getBoundingClientRect(),n=r.getBoundingClientRect();return{top:n.top-t.top,left:n.left-t.left,height:r.scrollHeight,width:r.scrollWidth}}function _C(r,e){r.style.setProperty("top",e.top+"px","important"),r.style.setProperty("left",e.left+"px","important"),r.style.setProperty("height",e.height+"px","important"),r.style.setProperty("width",e.width+"px","important")}function AC(r,e){return e.right<=r.right&&e.left>=r.left&&e.top>=r.top&&e.bottom<=r.bottom}Object.defineProperty(Ro,"__esModule",{value:!0});Ro.default=void 0;var bC=up(Hr.exports),Ot=Ee,DC=up(tr),CC=up(ns),Tr=Lt,gl=Sn;function up(r){return r&&r.__esModule?r:{default:r}}class Fx{constructor(e,t){this.settings=(0,Ot.extend)({ignoreClass:"",axis:void 0,direction:void 0,width:0,height:0,layout:void 0,globalLayoutProperties:{},method:void 0,forceRight:!1,allowScriptedContent:!1,allowPopups:!1},t||{}),this.id="epubjs-view-"+(0,Ot.uuid)(),this.section=e,this.index=e.index,this.element=this.container(this.settings.axis),this.added=!1,this.displayed=!1,this.rendered=!1,this.fixedWidth=0,this.fixedHeight=0,this.epubcfi=new DC.default,this.layout=this.settings.layout,this.pane=void 0,this.highlights={},this.underlines={},this.marks={}}container(e){var t=document.createElement("div");return t.classList.add("epub-view"),t.style.height="0px",t.style.width="0px",t.style.overflow="hidden",t.style.position="relative",t.style.display="block",e&&e=="horizontal"?t.style.flex="none":t.style.flex="initial",t}create(){return this.iframe?this.iframe:(this.element||(this.element=this.createContainer()),this.iframe=document.createElement("iframe"),this.iframe.id=this.id,this.iframe.scrolling="no",this.iframe.style.overflow="hidden",this.iframe.seamless="seamless",this.iframe.style.border="none",this.iframe.sandbox="allow-same-origin",this.settings.allowScriptedContent&&(this.iframe.sandbox+=" allow-scripts"),this.settings.allowPopups&&(this.iframe.sandbox+=" allow-popups"),this.iframe.setAttribute("enable-annotation","true"),this.resizing=!0,this.element.style.visibility="hidden",this.iframe.style.visibility="hidden",this.iframe.style.width="0",this.iframe.style.height="0",this._width=0,this._height=0,this.element.setAttribute("ref",this.index),this.added=!0,this.elementBounds=(0,Ot.bounds)(this.element),"srcdoc"in this.iframe?this.supportsSrcdoc=!0:this.supportsSrcdoc=!1,this.settings.method||(this.settings.method=this.supportsSrcdoc?"srcdoc":"write"),this.iframe)}render(e,t){return this.create(),this.size(),this.sectionRender||(this.sectionRender=this.section.render(e)),this.sectionRender.then(function(n){return this.load(n)}.bind(this)).then(function(){let n=this.contents.writingMode(),i;return this.settings.flow==="scrolled"?i=n.indexOf("vertical")===0?"horizontal":"vertical":i=n.indexOf("vertical")===0?"vertical":"horizontal",n.indexOf("vertical")===0&&this.settings.flow==="paginated"&&(this.layout.delta=this.layout.height),this.setAxis(i),this.emit(Tr.EVENTS.VIEWS.AXIS,i),this.setWritingMode(n),this.emit(Tr.EVENTS.VIEWS.WRITING_MODE,n),this.layout.format(this.contents,this.section,this.axis),this.addListeners(),new Promise((s,a)=>{this.expand(),this.settings.forceRight&&(this.element.style.marginLeft=this.width()+"px"),s()})}.bind(this),function(n){return this.emit(Tr.EVENTS.VIEWS.LOAD_ERROR,n),new Promise((i,s)=>{s(n)})}.bind(this)).then(function(){this.emit(Tr.EVENTS.VIEWS.RENDERED,this.section)}.bind(this))}reset(){this.iframe&&(this.iframe.style.width="0",this.iframe.style.height="0",this._width=0,this._height=0,this._textWidth=void 0,this._contentWidth=void 0,this._textHeight=void 0,this._contentHeight=void 0),this._needsReframe=!0}size(e,t){var n=e||this.settings.width,i=t||this.settings.height;this.layout.name==="pre-paginated"?this.lock("both",n,i):this.settings.axis==="horizontal"?this.lock("height",n,i):this.lock("width",n,i),this.settings.width=n,this.settings.height=i}lock(e,t,n){var i=(0,Ot.borders)(this.element),s;this.iframe?s=(0,Ot.borders)(this.iframe):s={width:0,height:0},e=="width"&&(0,Ot.isNumber)(t)&&(this.lockedWidth=t-i.width-s.width),e=="height"&&(0,Ot.isNumber)(n)&&(this.lockedHeight=n-i.height-s.height),e==="both"&&(0,Ot.isNumber)(t)&&(0,Ot.isNumber)(n)&&(this.lockedWidth=t-i.width-s.width,this.lockedHeight=n-i.height-s.height),this.displayed&&this.iframe&&this.expand()}expand(e){var t=this.lockedWidth,n=this.lockedHeight,i;!this.iframe||this._expanding||(this._expanding=!0,this.layout.name==="pre-paginated"?(t=this.layout.columnWidth,n=this.layout.height):this.settings.axis==="horizontal"?(t=this.contents.textWidth(),t%this.layout.pageWidth>0&&(t=Math.ceil(t/this.layout.pageWidth)*this.layout.pageWidth),this.settings.forceEvenPages&&(i=t/this.layout.pageWidth,this.layout.divisor>1&&this.layout.name==="reflowable"&&i%2>0&&(t+=this.layout.pageWidth))):this.settings.axis==="vertical"&&(n=this.contents.textHeight(),this.settings.flow==="paginated"&&n%this.layout.height>0&&(n=Math.ceil(n/this.layout.height)*this.layout.height)),(this._needsReframe||t!=this._width||n!=this._height)&&this.reframe(t,n),this._expanding=!1)}reframe(e,t){var n;(0,Ot.isNumber)(e)&&(this.element.style.width=e+"px",this.iframe.style.width=e+"px",this._width=e),(0,Ot.isNumber)(t)&&(this.element.style.height=t+"px",this.iframe.style.height=t+"px",this._height=t);let i=this.prevBounds?e-this.prevBounds.width:e,s=this.prevBounds?t-this.prevBounds.height:t;n={width:e,height:t,widthDelta:i,heightDelta:s},this.pane&&this.pane.render(),requestAnimationFrame(()=>{let a;for(let o in this.marks)this.marks.hasOwnProperty(o)&&(a=this.marks[o],this.placeMark(a.element,a.range))}),this.onResize(this,n),this.emit(Tr.EVENTS.VIEWS.RESIZED,n),this.prevBounds=n,this.elementBounds=(0,Ot.bounds)(this.element)}load(e){var t=new Ot.defer,n=t.promise;if(!this.iframe)return t.reject(new Error("No Iframe Available")),n;if(this.iframe.onload=function(s){this.onLoad(s,t)}.bind(this),this.settings.method==="blobUrl")this.blobUrl=(0,Ot.createBlobUrl)(e,"application/xhtml+xml"),this.iframe.src=this.blobUrl,this.element.appendChild(this.iframe);else if(this.settings.method==="srcdoc")this.iframe.srcdoc=e,this.element.appendChild(this.iframe);else{if(this.element.appendChild(this.iframe),this.document=this.iframe.contentDocument,!this.document)return t.reject(new Error("No Document Available")),n;if(this.iframe.contentDocument.open(),window.MSApp&&MSApp.execUnsafeLocalFunction){var i=this;MSApp.execUnsafeLocalFunction(function(){i.iframe.contentDocument.write(e)})}else this.iframe.contentDocument.write(e);this.iframe.contentDocument.close()}return n}onLoad(e,t){this.window=this.iframe.contentWindow,this.document=this.iframe.contentDocument,this.contents=new CC.default(this.document,this.document.body,this.section.cfiBase,this.section.index),this.rendering=!1;var n=this.document.querySelector("link[rel='canonical']");n?n.setAttribute("href",this.section.canonical):(n=this.document.createElement("link"),n.setAttribute("rel","canonical"),n.setAttribute("href",this.section.canonical),this.document.querySelector("head").appendChild(n)),this.contents.on(Tr.EVENTS.CONTENTS.EXPAND,()=>{this.displayed&&this.iframe&&(this.expand(),this.contents&&this.layout.format(this.contents))}),this.contents.on(Tr.EVENTS.CONTENTS.RESIZE,i=>{this.displayed&&this.iframe&&(this.expand(),this.contents&&this.layout.format(this.contents))}),t.resolve(this.contents)}setLayout(e){this.layout=e,this.contents&&(this.layout.format(this.contents),this.expand())}setAxis(e){this.settings.axis=e,e=="horizontal"?this.element.style.flex="none":this.element.style.flex="initial",this.size()}setWritingMode(e){this.writingMode=e}addListeners(){}removeListeners(e){}display(e){var t=new Ot.defer;return this.displayed?t.resolve(this):this.render(e).then(function(){this.emit(Tr.EVENTS.VIEWS.DISPLAYED,this),this.onDisplayed(this),this.displayed=!0,t.resolve(this)}.bind(this),function(n){t.reject(n,this)}),t.promise}show(){this.element.style.visibility="visible",this.iframe&&(this.iframe.style.visibility="visible",this.iframe.style.transform="translateZ(0)",this.iframe.offsetWidth,this.iframe.style.transform=null),this.emit(Tr.EVENTS.VIEWS.SHOWN,this)}hide(){this.element.style.visibility="hidden",this.iframe.style.visibility="hidden",this.stopExpanding=!0,this.emit(Tr.EVENTS.VIEWS.HIDDEN,this)}offset(){return{top:this.element.offsetTop,left:this.element.offsetLeft}}width(){return this._width}height(){return this._height}position(){return this.element.getBoundingClientRect()}locationOf(e){this.iframe.getBoundingClientRect();var t=this.contents.locationOf(e,this.settings.ignoreClass);return{left:t.left,top:t.top}}onDisplayed(e){}onResize(e,t){}bounds(e){return(e||!this.elementBounds)&&(this.elementBounds=(0,Ot.bounds)(this.element)),this.elementBounds}highlight(e,t={},n,i="epubjs-hl",s={}){if(!this.contents)return;const a=Object.assign({fill:"yellow","fill-opacity":"0.3","mix-blend-mode":"multiply"},s);let o=this.contents.range(e),l=()=>{this.emit(Tr.EVENTS.VIEWS.MARK_CLICKED,e,t)};t.epubcfi=e,this.pane||(this.pane=new gl.Pane(this.iframe,this.element));let u=new gl.Highlight(o,i,t,a),c=this.pane.addMark(u);return this.highlights[e]={mark:c,element:c.element,listeners:[l,n]},c.element.setAttribute("ref",i),c.element.addEventListener("click",l),c.element.addEventListener("touchstart",l),n&&(c.element.addEventListener("click",n),c.element.addEventListener("touchstart",n)),c}underline(e,t={},n,i="epubjs-ul",s={}){if(!this.contents)return;const a=Object.assign({stroke:"black","stroke-opacity":"0.3","mix-blend-mode":"multiply"},s);let o=this.contents.range(e),l=()=>{this.emit(Tr.EVENTS.VIEWS.MARK_CLICKED,e,t)};t.epubcfi=e,this.pane||(this.pane=new gl.Pane(this.iframe,this.element));let u=new gl.Underline(o,i,t,a),c=this.pane.addMark(u);return this.underlines[e]={mark:c,element:c.element,listeners:[l,n]},c.element.setAttribute("ref",i),c.element.addEventListener("click",l),c.element.addEventListener("touchstart",l),n&&(c.element.addEventListener("click",n),c.element.addEventListener("touchstart",n)),c}mark(e,t={},n){if(!this.contents)return;if(e in this.marks)return this.marks[e];let i=this.contents.range(e);if(!i)return;let s=i.commonAncestorContainer,a=s.nodeType===1?s:s.parentNode,o=u=>{this.emit(Tr.EVENTS.VIEWS.MARK_CLICKED,e,t)};i.collapsed&&s.nodeType===1?(i=new Range,i.selectNodeContents(s)):i.collapsed&&(i=new Range,i.selectNodeContents(a));let l=this.document.createElement("a");return l.setAttribute("ref","epubjs-mk"),l.style.position="absolute",l.dataset.epubcfi=e,t&&Object.keys(t).forEach(u=>{l.dataset[u]=t[u]}),n&&(l.addEventListener("click",n),l.addEventListener("touchstart",n)),l.addEventListener("click",o),l.addEventListener("touchstart",o),this.placeMark(l,i),this.element.appendChild(l),this.marks[e]={element:l,range:i,listeners:[o,n]},a}placeMark(e,t){let n,i,s;if(this.layout.name==="pre-paginated"||this.settings.axis!=="horizontal"){let o=t.getBoundingClientRect();n=o.top,i=o.right}else{let o=t.getClientRects(),l;for(var a=0;a!=o.length;a++)l=o[a],(!s||l.left<s)&&(s=l.left,i=Math.ceil(s/this.layout.props.pageWidth)*this.layout.props.pageWidth-this.layout.gap/2,n=l.top)}e.style.top=`${n}px`,e.style.left=`${i}px`}unhighlight(e){let t;e in this.highlights&&(t=this.highlights[e],this.pane.removeMark(t.mark),t.listeners.forEach(n=>{n&&(t.element.removeEventListener("click",n),t.element.removeEventListener("touchstart",n))}),delete this.highlights[e])}ununderline(e){let t;e in this.underlines&&(t=this.underlines[e],this.pane.removeMark(t.mark),t.listeners.forEach(n=>{n&&(t.element.removeEventListener("click",n),t.element.removeEventListener("touchstart",n))}),delete this.underlines[e])}unmark(e){let t;e in this.marks&&(t=this.marks[e],this.element.removeChild(t.element),t.listeners.forEach(n=>{n&&(t.element.removeEventListener("click",n),t.element.removeEventListener("touchstart",n))}),delete this.marks[e])}destroy(){for(let e in this.highlights)this.unhighlight(e);for(let e in this.underlines)this.ununderline(e);for(let e in this.marks)this.unmark(e);this.blobUrl&&(0,Ot.revokeBlobUrl)(this.blobUrl),this.displayed&&(this.displayed=!1,this.removeListeners(),this.contents.destroy(),this.stopExpanding=!0,this.element.removeChild(this.iframe),this.pane&&(this.pane.element.remove(),this.pane=void 0),this.iframe=void 0,this.contents=void 0,this._textWidth=null,this._textHeight=null,this._width=null,this._height=null)}}(0,bC.default)(Fx.prototype);var RC=Fx;Ro.default=RC;var oa={},Xu={};Object.defineProperty(Xu,"__esModule",{value:!0});Xu.createDefiner=Mx;Xu.default=LC;function LC(){var r="reverse",e=Mx();return document.body.appendChild(e),e.scrollLeft>0?r="default":typeof Element<"u"&&Element.prototype.scrollIntoView?(e.children[0].children[1].scrollIntoView(),e.scrollLeft<0&&(r="negative")):(e.scrollLeft=1,e.scrollLeft===0&&(r="negative")),document.body.removeChild(e),r}function Mx(){var r=document.createElement("div");r.dir="rtl",r.style.position="fixed",r.style.width="1px",r.style.height="1px",r.style.top="0px",r.style.left="0px",r.style.overflow="hidden";var e=document.createElement("div");e.style.width="2px";var t=document.createElement("span");t.style.width="1px",t.style.display="inline-block";var n=document.createElement("span");return n.style.width="1px",n.style.display="inline-block",e.appendChild(t),e.appendChild(n),r.appendChild(e),r}var Zu={};function IC(r){var e=typeof r;return r!=null&&(e=="object"||e=="function")}var cp=IC,kC=typeof hr=="object"&&hr&&hr.Object===Object&&hr,OC=kC,NC=OC,PC=typeof self=="object"&&self&&self.Object===Object&&self,FC=NC||PC||Function("return this")(),Bx=FC,MC=Bx,BC=function(){return MC.Date.now()},UC=BC,$C=/\s/;function zC(r){for(var e=r.length;e--&&$C.test(r.charAt(e)););return e}var VC=zC,GC=VC,WC=/^\s+/;function HC(r){return r&&r.slice(0,GC(r)+1).replace(WC,"")}var jC=HC,KC=Bx,qC=KC.Symbol,Ux=qC,J0=Ux,$x=Object.prototype,YC=$x.hasOwnProperty,XC=$x.toString,Aa=J0?J0.toStringTag:void 0;function ZC(r){var e=YC.call(r,Aa),t=r[Aa];try{r[Aa]=void 0;var n=!0}catch{}var i=XC.call(r);return n&&(e?r[Aa]=t:delete r[Aa]),i}var QC=ZC,JC=Object.prototype,eR=JC.toString;function tR(r){return eR.call(r)}var rR=tR,em=Ux,nR=QC,iR=rR,sR="[object Null]",aR="[object Undefined]",tm=em?em.toStringTag:void 0;function oR(r){return r==null?r===void 0?aR:sR:tm&&tm in Object(r)?nR(r):iR(r)}var lR=oR;function uR(r){return r!=null&&typeof r=="object"}var cR=uR,fR=lR,hR=cR,dR="[object Symbol]";function pR(r){return typeof r=="symbol"||hR(r)&&fR(r)==dR}var gR=pR,mR=jC,rm=cp,vR=gR,nm=0/0,yR=/^[-+]0x[0-9a-f]+$/i,ER=/^0b[01]+$/i,xR=/^0o[0-7]+$/i,TR=parseInt;function SR(r){if(typeof r=="number")return r;if(vR(r))return nm;if(rm(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=rm(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=mR(r);var t=ER.test(r);return t||xR.test(r)?TR(r.slice(2),t?2:8):yR.test(r)?nm:+r}var wR=SR,_R=cp,vf=UC,im=wR,AR="Expected a function",bR=Math.max,DR=Math.min;function CR(r,e,t){var n,i,s,a,o,l,u=0,c=!1,f=!1,h=!0;if(typeof r!="function")throw new TypeError(AR);e=im(e)||0,_R(t)&&(c=!!t.leading,f="maxWait"in t,s=f?bR(im(t.maxWait)||0,e):s,h="trailing"in t?!!t.trailing:h);function d(w){var _=n,C=i;return n=i=void 0,u=w,a=r.apply(C,_),a}function m(w){return u=w,o=setTimeout(g,e),c?d(w):a}function x(w){var _=w-l,C=w-u,O=e-_;return f?DR(O,s-C):O}function p(w){var _=w-l,C=w-u;return l===void 0||_>=e||_<0||f&&C>=s}function g(){var w=vf();if(p(w))return v(w);o=setTimeout(g,x(w))}function v(w){return o=void 0,h&&n?d(w):(n=i=void 0,a)}function E(){o!==void 0&&clearTimeout(o),u=0,n=l=i=o=void 0}function S(){return o===void 0?a:v(vf())}function T(){var w=vf(),_=p(w);if(n=arguments,i=this,l=w,_){if(o===void 0)return m(l);if(f)return clearTimeout(o),o=setTimeout(g,e),d(l)}return o===void 0&&(o=setTimeout(g,e)),a}return T.cancel=E,T.flush=S,T}var zx=CR,RR=zx,LR=cp,IR="Expected a function";function kR(r,e,t){var n=!0,i=!0;if(typeof r!="function")throw new TypeError(IR);return LR(t)&&(n="leading"in t?!!t.leading:n,i="trailing"in t?!!t.trailing:i),RR(r,e,{leading:n,maxWait:e,trailing:i})}var OR=kR;Object.defineProperty(Zu,"__esModule",{value:!0});Zu.default=void 0;var Sr=Ee,NR=PR(OR);function PR(r){return r&&r.__esModule?r:{default:r}}class FR{constructor(e){this.settings=e||{},this.id="epubjs-container-"+(0,Sr.uuid)(),this.container=this.create(this.settings),this.settings.hidden&&(this.wrapper=this.wrap(this.container))}create(e){let t=e.height,n=e.width,i=e.overflow||!1,s=e.axis||"vertical",a=e.direction;(0,Sr.extend)(this.settings,e),e.height&&(0,Sr.isNumber)(e.height)&&(t=e.height+"px"),e.width&&(0,Sr.isNumber)(e.width)&&(n=e.width+"px");let o=document.createElement("div");return o.id=this.id,o.classList.add("epub-container"),o.style.wordSpacing="0",o.style.lineHeight="0",o.style.verticalAlign="top",o.style.position="relative",s==="horizontal"&&(o.style.display="flex",o.style.flexDirection="row",o.style.flexWrap="nowrap"),n&&(o.style.width=n),t&&(o.style.height=t),i&&(i==="scroll"&&s==="vertical"?(o.style["overflow-y"]=i,o.style["overflow-x"]="hidden"):i==="scroll"&&s==="horizontal"?(o.style["overflow-y"]="hidden",o.style["overflow-x"]=i):o.style.overflow=i),a&&(o.dir=a,o.style.direction=a),a&&this.settings.fullsize&&(document.body.style.direction=a),o}wrap(e){var t=document.createElement("div");return t.style.visibility="hidden",t.style.overflow="hidden",t.style.width="0",t.style.height="0",t.appendChild(e),t}getElement(e){var t;if((0,Sr.isElement)(e)?t=e:typeof e=="string"&&(t=document.getElementById(e)),!t)throw new Error("Not an Element");return t}attachTo(e){var t=this.getElement(e),n;if(!!t)return this.settings.hidden?n=this.wrapper:n=this.container,t.appendChild(n),this.element=t,t}getContainer(){return this.container}onResize(e){(!(0,Sr.isNumber)(this.settings.width)||!(0,Sr.isNumber)(this.settings.height))&&(this.resizeFunc=(0,NR.default)(e,50),window.addEventListener("resize",this.resizeFunc,!1))}onOrientationChange(e){this.orientationChangeFunc=e,window.addEventListener("orientationchange",this.orientationChangeFunc,!1)}size(e,t){var n;let i=e||this.settings.width,s=t||this.settings.height;e===null?(n=this.element.getBoundingClientRect(),n.width&&(e=Math.floor(n.width),this.container.style.width=e+"px")):(0,Sr.isNumber)(e)?this.container.style.width=e+"px":this.container.style.width=e,t===null?(n=n||this.element.getBoundingClientRect(),n.height&&(t=n.height,this.container.style.height=t+"px")):(0,Sr.isNumber)(t)?this.container.style.height=t+"px":this.container.style.height=t,(0,Sr.isNumber)(e)||(e=this.container.clientWidth),(0,Sr.isNumber)(t)||(t=this.container.clientHeight),this.containerStyles=window.getComputedStyle(this.container),this.containerPadding={left:parseFloat(this.containerStyles["padding-left"])||0,right:parseFloat(this.containerStyles["padding-right"])||0,top:parseFloat(this.containerStyles["padding-top"])||0,bottom:parseFloat(this.containerStyles["padding-bottom"])||0};let a=(0,Sr.windowBounds)(),o=window.getComputedStyle(document.body),l={left:parseFloat(o["padding-left"])||0,right:parseFloat(o["padding-right"])||0,top:parseFloat(o["padding-top"])||0,bottom:parseFloat(o["padding-bottom"])||0};return i||(e=a.width-l.left-l.right),(this.settings.fullsize&&!s||!s)&&(t=a.height-l.top-l.bottom),{width:e-this.containerPadding.left-this.containerPadding.right,height:t-this.containerPadding.top-this.containerPadding.bottom}}bounds(){let e;return this.container.style.overflow!=="visible"&&(e=this.container&&this.container.getBoundingClientRect()),!e||!e.width||!e.height?(0,Sr.windowBounds)():e}getSheet(){var e=document.createElement("style");return e.appendChild(document.createTextNode("")),document.head.appendChild(e),e.sheet}addStyleRules(e,t){var n="#"+this.id+" ",i="";this.sheet||(this.sheet=this.getSheet()),t.forEach(function(s){for(var a in s)s.hasOwnProperty(a)&&(i+=a+":"+s[a]+";")}),this.sheet.insertRule(n+e+" {"+i+"}",0)}axis(e){e==="horizontal"?(this.container.style.display="flex",this.container.style.flexDirection="row",this.container.style.flexWrap="nowrap"):this.container.style.display="block",this.settings.axis=e}direction(e){this.container&&(this.container.dir=e,this.container.style.direction=e),this.settings.fullsize&&(document.body.style.direction=e),this.settings.dir=e}overflow(e){this.container&&(e==="scroll"&&this.settings.axis==="vertical"?(this.container.style["overflow-y"]=e,this.container.style["overflow-x"]="hidden"):e==="scroll"&&this.settings.axis==="horizontal"?(this.container.style["overflow-y"]="hidden",this.container.style["overflow-x"]=e):this.container.style.overflow=e),this.settings.overflow=e}destroy(){this.element&&(this.settings.hidden?this.wrapper:this.container,this.element.contains(this.container)&&this.element.removeChild(this.container),window.removeEventListener("resize",this.resizeFunc),window.removeEventListener("orientationChange",this.orientationChangeFunc))}}var MR=FR;Zu.default=MR;var Qu={};Object.defineProperty(Qu,"__esModule",{value:!0});Qu.default=void 0;class BR{constructor(e){this.container=e,this._views=[],this.length=0,this.hidden=!1}all(){return this._views}first(){return this._views[0]}last(){return this._views[this._views.length-1]}indexOf(e){return this._views.indexOf(e)}slice(){return this._views.slice.apply(this._views,arguments)}get(e){return this._views[e]}append(e){return this._views.push(e),this.container&&this.container.appendChild(e.element),this.length++,e}prepend(e){return this._views.unshift(e),this.container&&this.container.insertBefore(e.element,this.container.firstChild),this.length++,e}insert(e,t){return this._views.splice(t,0,e),this.container&&(t<this.container.children.length?this.container.insertBefore(e.element,this.container.children[t]):this.container.appendChild(e.element)),this.length++,e}remove(e){var t=this._views.indexOf(e);t>-1&&this._views.splice(t,1),this.destroy(e),this.length--}destroy(e){e.displayed&&e.destroy(),this.container&&this.container.removeChild(e.element),e=null}forEach(){return this._views.forEach.apply(this._views,arguments)}clear(){var e,t=this.length;if(!!this.length){for(var n=0;n<t;n++)e=this._views[n],this.destroy(e);this._views=[],this.length=0}}find(e){for(var t,n=this.length,i=0;i<n;i++)if(t=this._views[i],t.displayed&&t.section.index==e.index)return t}displayed(){for(var e=[],t,n=this.length,i=0;i<n;i++)t=this._views[i],t.displayed&&e.push(t);return e}show(){for(var e,t=this.length,n=0;n<t;n++)e=this._views[n],e.displayed&&e.show();this.hidden=!1}hide(){for(var e,t=this.length,n=0;n<t;n++)e=this._views[n],e.displayed&&e.hide();this.hidden=!0}}var UR=BR;Qu.default=UR;Object.defineProperty(oa,"__esModule",{value:!0});oa.default=void 0;var $R=la(Hr.exports),Ts=Ee,zR=la(Xu),sm=la(Co),VR=la(Ai),GR=la(Zu),WR=la(Qu),wr=Lt;function la(r){return r&&r.__esModule?r:{default:r}}class Vx{constructor(e){this.name="default",this.optsSettings=e.settings,this.View=e.view,this.request=e.request,this.renditionQueue=e.queue,this.q=new VR.default(this),this.settings=(0,Ts.extend)(this.settings||{},{infinite:!0,hidden:!1,width:void 0,height:void 0,axis:void 0,writingMode:void 0,flow:"scrolled",ignoreClass:"",fullsize:void 0,allowScriptedContent:!1,allowPopups:!1}),(0,Ts.extend)(this.settings,e.settings||{}),this.viewSettings={ignoreClass:this.settings.ignoreClass,axis:this.settings.axis,flow:this.settings.flow,layout:this.layout,method:this.settings.method,width:0,height:0,forceEvenPages:!0,allowScriptedContent:this.settings.allowScriptedContent,allowPopups:this.settings.allowPopups},this.rendered=!1}render(e,t){let n=e.tagName;typeof this.settings.fullsize>"u"&&n&&(n.toLowerCase()=="body"||n.toLowerCase()=="html")&&(this.settings.fullsize=!0),this.settings.fullsize&&(this.settings.overflow="visible",this.overflow=this.settings.overflow),this.settings.size=t,this.settings.rtlScrollType=(0,zR.default)(),this.stage=new GR.default({width:t.width,height:t.height,overflow:this.overflow,hidden:this.settings.hidden,axis:this.settings.axis,fullsize:this.settings.fullsize,direction:this.settings.direction}),this.stage.attachTo(e),this.container=this.stage.getContainer(),this.views=new WR.default(this.container),this._bounds=this.bounds(),this._stageSize=this.stage.size(),this.viewSettings.width=this._stageSize.width,this.viewSettings.height=this._stageSize.height,this.stage.onResize(this.onResized.bind(this)),this.stage.onOrientationChange(this.onOrientationChange.bind(this)),this.addEventListeners(),this.layout&&this.updateLayout(),this.rendered=!0}addEventListeners(){var e;window.addEventListener("unload",function(t){this.destroy()}.bind(this)),this.settings.fullsize?e=window:e=this.container,this._onScroll=this.onScroll.bind(this),e.addEventListener("scroll",this._onScroll)}removeEventListeners(){var e;this.settings.fullsize?e=window:e=this.container,e.removeEventListener("scroll",this._onScroll),this._onScroll=void 0}destroy(){clearTimeout(this.orientationTimeout),clearTimeout(this.resizeTimeout),clearTimeout(this.afterScrolled),this.clear(),this.removeEventListeners(),this.stage.destroy(),this.rendered=!1}onOrientationChange(e){let{orientation:t}=window;this.optsSettings.resizeOnOrientationChange&&this.resize(),clearTimeout(this.orientationTimeout),this.orientationTimeout=setTimeout(function(){this.orientationTimeout=void 0,this.optsSettings.resizeOnOrientationChange&&this.resize(),this.emit(wr.EVENTS.MANAGERS.ORIENTATION_CHANGE,t)}.bind(this),500)}onResized(e){this.resize()}resize(e,t,n){let i=this.stage.size(e,t);if(this.winBounds=(0,Ts.windowBounds)(),this.orientationTimeout&&this.winBounds.width===this.winBounds.height){this._stageSize=void 0;return}this._stageSize&&this._stageSize.width===i.width&&this._stageSize.height===i.height||(this._stageSize=i,this._bounds=this.bounds(),this.clear(),this.viewSettings.width=this._stageSize.width,this.viewSettings.height=this._stageSize.height,this.updateLayout(),this.emit(wr.EVENTS.MANAGERS.RESIZED,{width:this._stageSize.width,height:this._stageSize.height},n))}createView(e,t){return new this.View(e,(0,Ts.extend)(this.viewSettings,{forceRight:t}))}handleNextPrePaginated(e,t,n){let i;if(this.layout.name==="pre-paginated"&&this.layout.divisor>1){if(e||t.index===0)return;if(i=t.next(),i&&!i.properties.includes("page-spread-left"))return n.call(this,i)}}display(e,t){var n=new Ts.defer,i=n.promise;(t===e.href||(0,Ts.isNumber)(t))&&(t=void 0);var s=this.views.find(e);if(s&&e&&this.layout.name!=="pre-paginated"){let o=s.offset();if(this.settings.direction==="ltr")this.scrollTo(o.left,o.top,!0);else{let l=s.width();this.scrollTo(o.left+l,o.top,!0)}if(t){let l=s.locationOf(t),u=s.width();this.moveTo(l,u)}return n.resolve(),i}this.clear();let a=!1;return this.layout.name==="pre-paginated"&&this.layout.divisor===2&&e.properties.includes("page-spread-right")&&(a=!0),this.add(e,a).then(function(o){if(t){let l=o.locationOf(t),u=o.width();this.moveTo(l,u)}}.bind(this),o=>{n.reject(o)}).then(function(){return this.handleNextPrePaginated(a,e,this.add)}.bind(this)).then(function(){this.views.show(),n.resolve()}.bind(this)),i}afterDisplayed(e){this.emit(wr.EVENTS.MANAGERS.ADDED,e)}afterResized(e){this.emit(wr.EVENTS.MANAGERS.RESIZE,e.section)}moveTo(e,t){var n=0,i=0;this.isPaginated?(n=Math.floor(e.left/this.layout.delta)*this.layout.delta,n+this.layout.delta>this.container.scrollWidth&&(n=this.container.scrollWidth-this.layout.delta),i=Math.floor(e.top/this.layout.delta)*this.layout.delta,i+this.layout.delta>this.container.scrollHeight&&(i=this.container.scrollHeight-this.layout.delta)):i=e.top,this.settings.direction==="rtl"&&(n=n+this.layout.delta,n=n-t),this.scrollTo(n,i,!0)}add(e,t){var n=this.createView(e,t);return this.views.append(n),n.onDisplayed=this.afterDisplayed.bind(this),n.onResize=this.afterResized.bind(this),n.on(wr.EVENTS.VIEWS.AXIS,i=>{this.updateAxis(i)}),n.on(wr.EVENTS.VIEWS.WRITING_MODE,i=>{this.updateWritingMode(i)}),n.display(this.request)}append(e,t){var n=this.createView(e,t);return this.views.append(n),n.onDisplayed=this.afterDisplayed.bind(this),n.onResize=this.afterResized.bind(this),n.on(wr.EVENTS.VIEWS.AXIS,i=>{this.updateAxis(i)}),n.on(wr.EVENTS.VIEWS.WRITING_MODE,i=>{this.updateWritingMode(i)}),n.display(this.request)}prepend(e,t){var n=this.createView(e,t);return n.on(wr.EVENTS.VIEWS.RESIZED,i=>{this.counter(i)}),this.views.prepend(n),n.onDisplayed=this.afterDisplayed.bind(this),n.onResize=this.afterResized.bind(this),n.on(wr.EVENTS.VIEWS.AXIS,i=>{this.updateAxis(i)}),n.on(wr.EVENTS.VIEWS.WRITING_MODE,i=>{this.updateWritingMode(i)}),n.display(this.request)}counter(e){this.settings.axis==="vertical"?this.scrollBy(0,e.heightDelta,!0):this.scrollBy(e.widthDelta,0,!0)}next(){var e,t;let n=this.settings.direction;if(!!this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"&&(!n||n==="ltr")?(this.scrollLeft=this.container.scrollLeft,t=this.container.scrollLeft+this.container.offsetWidth+this.layout.delta,t<=this.container.scrollWidth?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next()):this.isPaginated&&this.settings.axis==="horizontal"&&n==="rtl"?(this.scrollLeft=this.container.scrollLeft,this.settings.rtlScrollType==="default"?(t=this.container.scrollLeft,t>0?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next()):(t=this.container.scrollLeft+this.layout.delta*-1,t>this.container.scrollWidth*-1?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next())):this.isPaginated&&this.settings.axis==="vertical"?(this.scrollTop=this.container.scrollTop,this.container.scrollTop+this.container.offsetHeight<this.container.scrollHeight?this.scrollBy(0,this.layout.height,!0):e=this.views.last().section.next()):e=this.views.last().section.next(),e)){this.clear(),this.updateLayout();let i=!1;return this.layout.name==="pre-paginated"&&this.layout.divisor===2&&e.properties.includes("page-spread-right")&&(i=!0),this.append(e,i).then(function(){return this.handleNextPrePaginated(i,e,this.append)}.bind(this),s=>s).then(function(){!this.isPaginated&&this.settings.axis==="horizontal"&&this.settings.direction==="rtl"&&this.settings.rtlScrollType==="default"&&this.scrollTo(this.container.scrollWidth,0,!0),this.views.show()}.bind(this))}}prev(){var e,t;let n=this.settings.direction;if(!!this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"&&(!n||n==="ltr")?(this.scrollLeft=this.container.scrollLeft,t=this.container.scrollLeft,t>0?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev()):this.isPaginated&&this.settings.axis==="horizontal"&&n==="rtl"?(this.scrollLeft=this.container.scrollLeft,this.settings.rtlScrollType==="default"?(t=this.container.scrollLeft+this.container.offsetWidth,t<this.container.scrollWidth?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev()):(t=this.container.scrollLeft,t<0?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev())):this.isPaginated&&this.settings.axis==="vertical"?(this.scrollTop=this.container.scrollTop,this.container.scrollTop>0?this.scrollBy(0,-this.layout.height,!0):e=this.views.first().section.prev()):e=this.views.first().section.prev(),e)){this.clear(),this.updateLayout();let i=!1;return this.layout.name==="pre-paginated"&&this.layout.divisor===2&&typeof e.prev()!="object"&&(i=!0),this.prepend(e,i).then(function(){var s;if(this.layout.name==="pre-paginated"&&this.layout.divisor>1&&(s=e.prev(),s))return this.prepend(s)}.bind(this),s=>s).then(function(){this.isPaginated&&this.settings.axis==="horizontal"&&(this.settings.direction==="rtl"?this.settings.rtlScrollType==="default"?this.scrollTo(0,0,!0):this.scrollTo(this.container.scrollWidth*-1+this.layout.delta,0,!0):this.scrollTo(this.container.scrollWidth-this.layout.delta,0,!0)),this.views.show()}.bind(this))}}current(){var e=this.visible();return e.length?e[e.length-1]:null}clear(){this.views&&(this.views.hide(),this.scrollTo(0,0,!0),this.views.clear())}currentLocation(){return this.updateLayout(),this.isPaginated&&this.settings.axis==="horizontal"?this.location=this.paginatedLocation():this.location=this.scrolledLocation(),this.location}scrolledLocation(){let e=this.visible(),t=this.container.getBoundingClientRect(),n=t.height<window.innerHeight?t.height:window.innerHeight,i=t.width<window.innerWidth?t.width:window.innerWidth,s=this.settings.axis==="vertical";this.settings.direction;let a=0,o=0;return this.settings.fullsize&&(a=s?window.scrollY:window.scrollX),e.map(u=>{let{index:c,href:f}=u.section,h=u.position(),d=u.width(),m=u.height(),x,p,g,v;s?(x=a+t.top-h.top+o,p=x+n-o,v=this.layout.count(m,n).pages,g=n):(x=a+t.left-h.left+o,p=x+i-o,v=this.layout.count(d,i).pages,g=i);let E=Math.ceil(x/g),S=[],T=Math.ceil(p/g);if(this.settings.direction==="rtl"&&!s){let C=E;E=v-T,T=v-C}S=[];for(var w=E;w<=T;w++){let C=w+1;S.push(C)}let _=this.mapping.page(u.contents,u.section.cfiBase,x,p);return{index:c,href:f,pages:S,totalPages:v,mapping:_}})}paginatedLocation(){let e=this.visible(),t=this.container.getBoundingClientRect(),n=0,i=0;return this.settings.fullsize&&(n=window.scrollX),e.map(a=>{let{index:o,href:l}=a.section,u,c=a.position(),f=a.width(),h,d,m;this.settings.direction==="rtl"?(u=t.right-n,m=Math.min(Math.abs(u-c.left),this.layout.width)-i,d=c.width-(c.right-u)-i,h=d-m):(u=t.left+n,m=Math.min(c.right-u,this.layout.width)-i,h=u-c.left+i,d=h+m),i+=m;let x=this.mapping.page(a.contents,a.section.cfiBase,h,d),p=this.layout.count(f).pages,g=Math.floor(h/this.layout.pageWidth),v=[],E=Math.floor(d/this.layout.pageWidth);if(g<0&&(g=0,E=E+1),this.settings.direction==="rtl"){let T=g;g=p-E,E=p-T}for(var S=g+1;S<=E;S++){let T=S;v.push(T)}return{index:o,href:l,pages:v,totalPages:p,mapping:x}})}isVisible(e,t,n,i){var s=e.position(),a=i||this.bounds();return this.settings.axis==="horizontal"&&s.right>a.left-t&&s.left<a.right+n?!0:this.settings.axis==="vertical"&&s.bottom>a.top-t&&s.top<a.bottom+n}visible(){for(var e=this.bounds(),t=this.views.displayed(),n=t.length,i=[],s,a,o=0;o<n;o++)a=t[o],s=this.isVisible(a,0,0,e),s===!0&&i.push(a);return i}scrollBy(e,t,n){let i=this.settings.direction==="rtl"?-1:1;n&&(this.ignore=!0),this.settings.fullsize?window.scrollBy(e*i,t*i):(e&&(this.container.scrollLeft+=e*i),t&&(this.container.scrollTop+=t)),this.scrolled=!0}scrollTo(e,t,n){n&&(this.ignore=!0),this.settings.fullsize?window.scrollTo(e,t):(this.container.scrollLeft=e,this.container.scrollTop=t),this.scrolled=!0}onScroll(){let e,t;this.settings.fullsize?(e=window.scrollY,t=window.scrollX):(e=this.container.scrollTop,t=this.container.scrollLeft),this.scrollTop=e,this.scrollLeft=t,this.ignore?this.ignore=!1:(this.emit(wr.EVENTS.MANAGERS.SCROLL,{top:e,left:t}),clearTimeout(this.afterScrolled),this.afterScrolled=setTimeout(function(){this.emit(wr.EVENTS.MANAGERS.SCROLLED,{top:this.scrollTop,left:this.scrollLeft})}.bind(this),20))}bounds(){var e;return e=this.stage.bounds(),e}applyLayout(e){this.layout=e,this.updateLayout(),this.views&&this.views.length>0&&this.layout.name==="pre-paginated"&&this.display(this.views.first().section)}updateLayout(){!this.stage||(this._stageSize=this.stage.size(),this.isPaginated?(this.layout.calculate(this._stageSize.width,this._stageSize.height,this.settings.gap),this.settings.offset=this.layout.delta/this.layout.divisor):this.layout.calculate(this._stageSize.width,this._stageSize.height),this.viewSettings.width=this.layout.width,this.viewSettings.height=this.layout.height,this.setLayout(this.layout))}setLayout(e){this.viewSettings.layout=e,this.mapping=new sm.default(e.props,this.settings.direction,this.settings.axis),this.views&&this.views.forEach(function(t){t&&t.setLayout(e)})}updateWritingMode(e){this.writingMode=e}updateAxis(e,t){!t&&e===this.settings.axis||(this.settings.axis=e,this.stage&&this.stage.axis(e),this.viewSettings.axis=e,this.mapping&&(this.mapping=new sm.default(this.layout.props,this.settings.direction,this.settings.axis)),this.layout&&(e==="vertical"?this.layout.spread("none"):this.layout.spread(this.layout.settings.spread)))}updateFlow(e,t="auto"){let n=e==="paginated"||e==="auto";this.isPaginated=n,e==="scrolled-doc"||e==="scrolled-continuous"||e==="scrolled"?this.updateAxis("vertical"):this.updateAxis("horizontal"),this.viewSettings.flow=e,this.settings.overflow?this.overflow=this.settings.overflow:this.overflow=n?"hidden":t,this.stage&&this.stage.overflow(this.overflow),this.updateLayout()}getContents(){var e=[];return this.views&&this.views.forEach(function(t){const n=t&&t.contents;n&&e.push(n)}),e}direction(e="ltr"){this.settings.direction=e,this.stage&&this.stage.direction(e),this.viewSettings.direction=e,this.updateLayout()}isRendered(){return this.rendered}}(0,$R.default)(Vx.prototype);var HR=Vx;oa.default=HR;var Io={},Ju={};Object.defineProperty(Ju,"__esModule",{value:!0});Ju.default=void 0;var am=Ee,om=Lt,jR=KR(Hr.exports);function KR(r){return r&&r.__esModule?r:{default:r}}const qR=Math.PI/2,YR={easeOutSine:function(r){return Math.sin(r*qR)},easeInOutSine:function(r){return-.5*(Math.cos(Math.PI*r)-1)},easeInOutQuint:function(r){return(r/=.5)<1?.5*Math.pow(r,5):.5*(Math.pow(r-2,5)+2)},easeInCubic:function(r){return Math.pow(r,3)}};class Gx{constructor(e,t){this.settings=(0,am.extend)({duration:80,minVelocity:.2,minDistance:10,easing:YR.easeInCubic},t||{}),this.supportsTouch=this.supportsTouch(),this.supportsTouch&&this.setup(e)}setup(e){this.manager=e,this.layout=this.manager.layout,this.fullsize=this.manager.settings.fullsize,this.fullsize?(this.element=this.manager.stage.element,this.scroller=window,this.disableScroll()):(this.element=this.manager.stage.container,this.scroller=this.element,this.element.style.WebkitOverflowScrolling="touch"),this.manager.settings.offset=this.layout.width,this.manager.settings.afterScrolledTimeout=this.settings.duration*2,this.isVertical=this.manager.settings.axis==="vertical",!(!this.manager.isPaginated||this.isVertical)&&(this.touchCanceler=!1,this.resizeCanceler=!1,this.snapping=!1,this.scrollLeft,this.scrollTop,this.startTouchX=void 0,this.startTouchY=void 0,this.startTime=void 0,this.endTouchX=void 0,this.endTouchY=void 0,this.endTime=void 0,this.addListeners())}supportsTouch(){return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)}disableScroll(){this.element.style.overflow="hidden"}enableScroll(){this.element.style.overflow=""}addListeners(){this._onResize=this.onResize.bind(this),window.addEventListener("resize",this._onResize),this._onScroll=this.onScroll.bind(this),this.scroller.addEventListener("scroll",this._onScroll),this._onTouchStart=this.onTouchStart.bind(this),this.scroller.addEventListener("touchstart",this._onTouchStart,{passive:!0}),this.on("touchstart",this._onTouchStart),this._onTouchMove=this.onTouchMove.bind(this),this.scroller.addEventListener("touchmove",this._onTouchMove,{passive:!0}),this.on("touchmove",this._onTouchMove),this._onTouchEnd=this.onTouchEnd.bind(this),this.scroller.addEventListener("touchend",this._onTouchEnd,{passive:!0}),this.on("touchend",this._onTouchEnd),this._afterDisplayed=this.afterDisplayed.bind(this),this.manager.on(om.EVENTS.MANAGERS.ADDED,this._afterDisplayed)}removeListeners(){window.removeEventListener("resize",this._onResize),this._onResize=void 0,this.scroller.removeEventListener("scroll",this._onScroll),this._onScroll=void 0,this.scroller.removeEventListener("touchstart",this._onTouchStart,{passive:!0}),this.off("touchstart",this._onTouchStart),this._onTouchStart=void 0,this.scroller.removeEventListener("touchmove",this._onTouchMove,{passive:!0}),this.off("touchmove",this._onTouchMove),this._onTouchMove=void 0,this.scroller.removeEventListener("touchend",this._onTouchEnd,{passive:!0}),this.off("touchend",this._onTouchEnd),this._onTouchEnd=void 0,this.manager.off(om.EVENTS.MANAGERS.ADDED,this._afterDisplayed),this._afterDisplayed=void 0}afterDisplayed(e){let t=e.contents;["touchstart","touchmove","touchend"].forEach(n=>{t.on(n,i=>this.triggerViewEvent(i,t))})}triggerViewEvent(e,t){this.emit(e.type,e,t)}onScroll(e){this.scrollLeft=this.fullsize?window.scrollX:this.scroller.scrollLeft,this.scrollTop=this.fullsize?window.scrollY:this.scroller.scrollTop}onResize(e){this.resizeCanceler=!0}onTouchStart(e){let{screenX:t,screenY:n}=e.touches[0];this.fullsize&&this.enableScroll(),this.touchCanceler=!0,this.startTouchX||(this.startTouchX=t,this.startTouchY=n,this.startTime=this.now()),this.endTouchX=t,this.endTouchY=n,this.endTime=this.now()}onTouchMove(e){let{screenX:t,screenY:n}=e.touches[0],i=Math.abs(n-this.endTouchY);this.touchCanceler=!0,!this.fullsize&&i<10&&(this.element.scrollLeft-=t-this.endTouchX),this.endTouchX=t,this.endTouchY=n,this.endTime=this.now()}onTouchEnd(e){this.fullsize&&this.disableScroll(),this.touchCanceler=!1;let t=this.wasSwiped();t!==0?this.snap(t):this.snap(),this.startTouchX=void 0,this.startTouchY=void 0,this.startTime=void 0,this.endTouchX=void 0,this.endTouchY=void 0,this.endTime=void 0}wasSwiped(){let e=this.layout.pageWidth*this.layout.divisor,t=this.endTouchX-this.startTouchX,n=Math.abs(t),i=this.endTime-this.startTime,s=t/i,a=this.settings.minVelocity;if(n<=this.settings.minDistance||n>=e)return 0;if(s>a)return-1;if(s<-a)return 1}needsSnap(){let e=this.scrollLeft,t=this.layout.pageWidth*this.layout.divisor;return e%t!==0}snap(e=0){let t=this.scrollLeft,n=this.layout.pageWidth*this.layout.divisor,i=Math.round(t/n)*n;return e&&(i+=e*n),this.smoothScrollTo(i)}smoothScrollTo(e){const t=new am.defer,n=this.scrollLeft,i=this.now(),s=this.settings.duration,a=this.settings.easing;this.snapping=!0;function o(){const l=this.now(),u=Math.min(1,(l-i)/s);if(a(u),this.touchCanceler||this.resizeCanceler){this.resizeCanceler=!1,this.snapping=!1,t.resolve();return}u<1?(window.requestAnimationFrame(o.bind(this)),this.scrollTo(n+(e-n)*u,0)):(this.scrollTo(e,0),this.snapping=!1,t.resolve())}return o.call(this),t.promise}scrollTo(e=0,t=0){this.fullsize?window.scroll(e,t):(this.scroller.scrollLeft=e,this.scroller.scrollTop=t)}now(){return"now"in window.performance?performance.now():new Date().getTime()}destroy(){!this.scroller||(this.fullsize&&this.enableScroll(),this.removeListeners(),this.scroller=void 0)}}(0,jR.default)(Gx.prototype);var XR=Gx;Ju.default=XR;Object.defineProperty(Io,"__esModule",{value:!0});Io.default=void 0;var ki=Ee,lm=fp(oa),um=fp(Ju),Fr=Lt,ZR=fp(zx);function fp(r){return r&&r.__esModule?r:{default:r}}class QR extends lm.default{constructor(e){super(e),this.name="continuous",this.settings=(0,ki.extend)(this.settings||{},{infinite:!0,overflow:void 0,axis:void 0,writingMode:void 0,flow:"scrolled",offset:500,offsetDelta:250,width:void 0,height:void 0,snap:!1,afterScrolledTimeout:10,allowScriptedContent:!1,allowPopups:!1}),(0,ki.extend)(this.settings,e.settings||{}),e.settings.gap!="undefined"&&e.settings.gap===0&&(this.settings.gap=e.settings.gap),this.viewSettings={ignoreClass:this.settings.ignoreClass,axis:this.settings.axis,flow:this.settings.flow,layout:this.layout,width:0,height:0,forceEvenPages:!1,allowScriptedContent:this.settings.allowScriptedContent,allowPopups:this.settings.allowPopups},this.scrollTop=0,this.scrollLeft=0}display(e,t){return lm.default.prototype.display.call(this,e,t).then(function(){return this.fill()}.bind(this))}fill(e){var t=e||new ki.defer;return this.q.enqueue(()=>this.check()).then(n=>{n?this.fill(t):t.resolve()}),t.promise}moveTo(e){var t=0,n=0;this.isPaginated?(t=Math.floor(e.left/this.layout.delta)*this.layout.delta,t+this.settings.offsetDelta):(n=e.top,e.top+this.settings.offsetDelta),(t>0||n>0)&&this.scrollBy(t,n,!0)}afterResized(e){this.emit(Fr.EVENTS.MANAGERS.RESIZE,e.section)}removeShownListeners(e){e.onDisplayed=function(){}}add(e){var t=this.createView(e);return this.views.append(t),t.on(Fr.EVENTS.VIEWS.RESIZED,n=>{t.expanded=!0}),t.on(Fr.EVENTS.VIEWS.AXIS,n=>{this.updateAxis(n)}),t.on(Fr.EVENTS.VIEWS.WRITING_MODE,n=>{this.updateWritingMode(n)}),t.onDisplayed=this.afterDisplayed.bind(this),t.onResize=this.afterResized.bind(this),t.display(this.request)}append(e){var t=this.createView(e);return t.on(Fr.EVENTS.VIEWS.RESIZED,n=>{t.expanded=!0}),t.on(Fr.EVENTS.VIEWS.AXIS,n=>{this.updateAxis(n)}),t.on(Fr.EVENTS.VIEWS.WRITING_MODE,n=>{this.updateWritingMode(n)}),this.views.append(t),t.onDisplayed=this.afterDisplayed.bind(this),t}prepend(e){var t=this.createView(e);return t.on(Fr.EVENTS.VIEWS.RESIZED,n=>{this.counter(n),t.expanded=!0}),t.on(Fr.EVENTS.VIEWS.AXIS,n=>{this.updateAxis(n)}),t.on(Fr.EVENTS.VIEWS.WRITING_MODE,n=>{this.updateWritingMode(n)}),this.views.prepend(t),t.onDisplayed=this.afterDisplayed.bind(this),t}counter(e){this.settings.axis==="vertical"?this.scrollBy(0,e.heightDelta,!0):this.scrollBy(e.widthDelta,0,!0)}update(e){for(var t=this.bounds(),n=this.views.all(),i=n.length,s=typeof e<"u"?e:this.settings.offset||0,a,o,l=new ki.defer,u=[],c=0;c<i;c++)if(o=n[c],a=this.isVisible(o,s,s,t),a===!0)if(o.displayed)o.show();else{let f=o.display(this.request).then(function(h){h.show()},h=>{o.hide()});u.push(f)}else this.q.enqueue(o.destroy.bind(o)),clearTimeout(this.trimTimeout),this.trimTimeout=setTimeout(function(){this.q.enqueue(this.trim.bind(this))}.bind(this),250);return u.length?Promise.all(u).catch(f=>{l.reject(f)}):(l.resolve(),l.promise)}check(e,t){var n=new ki.defer,i=[],s=this.settings.axis==="horizontal",a=this.settings.offset||0;e&&s&&(a=e),t&&!s&&(a=t);var o=this._bounds;let l=s?this.scrollLeft:this.scrollTop,u=s?Math.floor(o.width):o.height,c=s?this.container.scrollWidth:this.container.scrollHeight,f=this.writingMode&&this.writingMode.indexOf("vertical")===0?"vertical":"horizontal",h=this.settings.rtlScrollType,d=this.settings.direction==="rtl";this.settings.fullsize?(s&&d&&h==="negative"||!s&&d&&h==="default")&&(l=l*-1):(d&&h==="default"&&f==="horizontal"&&(l=c-u-l),d&&h==="negative"&&f==="horizontal"&&(l=l*-1));let m=()=>{let E=this.views.first(),S=E&&E.section.prev();S&&i.push(this.prepend(S))},x=()=>{let E=this.views.last(),S=E&&E.section.next();S&&i.push(this.append(S))},p=l+u+a,g=l-a;p>=c&&x(),g<0&&m();let v=i.map(E=>E.display(this.request));return i.length?Promise.all(v).then(()=>this.check()).then(()=>this.update(a),E=>E):(this.q.enqueue(function(){this.update()}.bind(this)),n.resolve(!1),n.promise)}trim(){for(var e=new ki.defer,t=this.views.displayed(),n=t[0],i=t[t.length-1],s=this.views.indexOf(n),a=this.views.indexOf(i),o=this.views.slice(0,s),l=this.views.slice(a+1),u=0;u<o.length-1;u++)this.erase(o[u],o);for(var c=1;c<l.length;c++)this.erase(l[c]);return e.resolve(),e.promise}erase(e,t){var n,i;this.settings.fullsize?(n=window.scrollY,i=window.scrollX):(n=this.container.scrollTop,i=this.container.scrollLeft);var s=e.bounds();this.views.remove(e),t&&(this.settings.axis==="vertical"?this.scrollTo(0,n-s.height,!0):this.settings.direction==="rtl"?this.settings.fullsize?this.scrollTo(i+Math.floor(s.width),0,!0):this.scrollTo(i,0,!0):this.scrollTo(i-Math.floor(s.width),0,!0))}addEventListeners(e){window.addEventListener("unload",function(t){this.ignore=!0,this.destroy()}.bind(this)),this.addScrollListeners(),this.isPaginated&&this.settings.snap&&(this.snapper=new um.default(this,this.settings.snap&&typeof this.settings.snap=="object"&&this.settings.snap))}addScrollListeners(){var e;this.tick=ki.requestAnimationFrame;let t=this.settings.direction==="rtl"&&this.settings.rtlScrollType==="default"?-1:1;this.scrollDeltaVert=0,this.scrollDeltaHorz=0,this.settings.fullsize?(e=window,this.scrollTop=window.scrollY*t,this.scrollLeft=window.scrollX*t):(e=this.container,this.scrollTop=this.container.scrollTop,this.scrollLeft=this.container.scrollLeft),this._onScroll=this.onScroll.bind(this),e.addEventListener("scroll",this._onScroll),this._scrolled=(0,ZR.default)(this.scrolled.bind(this),30),this.didScroll=!1}removeEventListeners(){var e;this.settings.fullsize?e=window:e=this.container,e.removeEventListener("scroll",this._onScroll),this._onScroll=void 0}onScroll(){let e,t,n=this.settings.direction==="rtl"&&this.settings.rtlScrollType==="default"?-1:1;this.settings.fullsize?(e=window.scrollY*n,t=window.scrollX*n):(e=this.container.scrollTop,t=this.container.scrollLeft),this.scrollTop=e,this.scrollLeft=t,this.ignore?this.ignore=!1:this._scrolled(),this.scrollDeltaVert+=Math.abs(e-this.prevScrollTop),this.scrollDeltaHorz+=Math.abs(t-this.prevScrollLeft),this.prevScrollTop=e,this.prevScrollLeft=t,clearTimeout(this.scrollTimeout),this.scrollTimeout=setTimeout(function(){this.scrollDeltaVert=0,this.scrollDeltaHorz=0}.bind(this),150),clearTimeout(this.afterScrolled),this.didScroll=!1}scrolled(){this.q.enqueue(function(){return this.check()}.bind(this)),this.emit(Fr.EVENTS.MANAGERS.SCROLL,{top:this.scrollTop,left:this.scrollLeft}),clearTimeout(this.afterScrolled),this.afterScrolled=setTimeout(function(){this.snapper&&this.snapper.supportsTouch&&this.snapper.needsSnap()||this.emit(Fr.EVENTS.MANAGERS.SCROLLED,{top:this.scrollTop,left:this.scrollLeft})}.bind(this),this.settings.afterScrolledTimeout)}next(){let e=this.layout.props.name==="pre-paginated"&&this.layout.props.spread?this.layout.props.delta*2:this.layout.props.delta;!this.views.length||(this.isPaginated&&this.settings.axis==="horizontal"?this.scrollBy(e,0,!0):this.scrollBy(0,this.layout.height,!0),this.q.enqueue(function(){return this.check()}.bind(this)))}prev(){let e=this.layout.props.name==="pre-paginated"&&this.layout.props.spread?this.layout.props.delta*2:this.layout.props.delta;!this.views.length||(this.isPaginated&&this.settings.axis==="horizontal"?this.scrollBy(-e,0,!0):this.scrollBy(0,-this.layout.height,!0),this.q.enqueue(function(){return this.check()}.bind(this)))}updateFlow(e){this.rendered&&this.snapper&&(this.snapper.destroy(),this.snapper=void 0),super.updateFlow(e,"scroll"),this.rendered&&this.isPaginated&&this.settings.snap&&(this.snapper=new um.default(this,this.settings.snap&&typeof this.settings.snap=="object"&&this.settings.snap))}destroy(){super.destroy(),this.snapper&&this.snapper.destroy()}}var JR=QR;Io.default=JR;Object.defineProperty(aa,"__esModule",{value:!0});aa.default=void 0;var eL=gn(Hr.exports),ba=Ee,Oi=gn(ia),cm=gn(tr),tL=gn(Ai),rL=gn(Do),nL=gn(Hu);gn(ns);var iL=gn(ju),Xe=Lt,sL=gn(Ro),aL=gn(oa),oL=gn(Io);function gn(r){return r&&r.__esModule?r:{default:r}}class Wx{constructor(e,t){this.settings=(0,ba.extend)(this.settings||{},{width:null,height:null,ignoreClass:"",manager:"default",view:"iframe",flow:null,layout:null,spread:null,minSpreadWidth:800,stylesheet:null,resizeOnOrientationChange:!0,script:null,snap:!1,defaultDirection:"ltr",allowScriptedContent:!1,allowPopups:!1}),(0,ba.extend)(this.settings,t),typeof this.settings.manager=="object"&&(this.manager=this.settings.manager),this.book=e,this.hooks={},this.hooks.display=new Oi.default(this),this.hooks.serialize=new Oi.default(this),this.hooks.content=new Oi.default(this),this.hooks.unloaded=new Oi.default(this),this.hooks.layout=new Oi.default(this),this.hooks.render=new Oi.default(this),this.hooks.show=new Oi.default(this),this.hooks.content.register(this.handleLinks.bind(this)),this.hooks.content.register(this.passEvents.bind(this)),this.hooks.content.register(this.adjustImages.bind(this)),this.book.spine.hooks.content.register(this.injectIdentifier.bind(this)),this.settings.stylesheet&&this.book.spine.hooks.content.register(this.injectStylesheet.bind(this)),this.settings.script&&this.book.spine.hooks.content.register(this.injectScript.bind(this)),this.themes=new nL.default(this),this.annotations=new iL.default(this),this.epubcfi=new cm.default,this.q=new tL.default(this),this.location=void 0,this.q.enqueue(this.book.opened),this.starting=new ba.defer,this.started=this.starting.promise,this.q.enqueue(this.start)}setManager(e){this.manager=e}requireManager(e){var t;return typeof e=="string"&&e==="default"?t=aL.default:typeof e=="string"&&e==="continuous"?t=oL.default:t=e,t}requireView(e){var t;return typeof e=="string"&&e==="iframe"?t=sL.default:t=e,t}start(){switch(!this.settings.layout&&(this.book.package.metadata.layout==="pre-paginated"||this.book.displayOptions.fixedLayout==="true")&&(this.settings.layout="pre-paginated"),this.book.package.metadata.spread){case"none":this.settings.spread="none";break;case"both":this.settings.spread=!0;break}this.manager||(this.ViewManager=this.requireManager(this.settings.manager),this.View=this.requireView(this.settings.view),this.manager=new this.ViewManager({view:this.View,queue:this.q,request:this.book.load.bind(this.book),settings:this.settings})),this.direction(this.book.package.metadata.direction||this.settings.defaultDirection),this.settings.globalLayoutProperties=this.determineLayoutProperties(this.book.package.metadata),this.flow(this.settings.globalLayoutProperties.flow),this.layout(this.settings.globalLayoutProperties),this.manager.on(Xe.EVENTS.MANAGERS.ADDED,this.afterDisplayed.bind(this)),this.manager.on(Xe.EVENTS.MANAGERS.REMOVED,this.afterRemoved.bind(this)),this.manager.on(Xe.EVENTS.MANAGERS.RESIZED,this.onResized.bind(this)),this.manager.on(Xe.EVENTS.MANAGERS.ORIENTATION_CHANGE,this.onOrientationChange.bind(this)),this.manager.on(Xe.EVENTS.MANAGERS.SCROLLED,this.reportLocation.bind(this)),this.emit(Xe.EVENTS.RENDITION.STARTED),this.starting.resolve()}attachTo(e){return this.q.enqueue(function(){this.manager.render(e,{width:this.settings.width,height:this.settings.height}),this.emit(Xe.EVENTS.RENDITION.ATTACHED)}.bind(this))}display(e){return this.displaying&&this.displaying.resolve(),this.q.enqueue(this._display,e)}_display(e){if(!!this.book){this.epubcfi.isCfiString(e);var t=new ba.defer,n=t.promise,i;return this.displaying=t,this.book.locations.length()&&(0,ba.isFloat)(e)&&(e=this.book.locations.cfiFromPercentage(parseFloat(e))),i=this.book.spine.get(e),i?(this.manager.display(i,e).then(()=>{t.resolve(i),this.displaying=void 0,this.emit(Xe.EVENTS.RENDITION.DISPLAYED,i),this.reportLocation()},s=>{this.emit(Xe.EVENTS.RENDITION.DISPLAY_ERROR,s)}),n):(t.reject(new Error("No Section Found")),n)}}afterDisplayed(e){e.on(Xe.EVENTS.VIEWS.MARK_CLICKED,(t,n)=>this.triggerMarkEvent(t,n,e.contents)),this.hooks.render.trigger(e,this).then(()=>{e.contents?this.hooks.content.trigger(e.contents,this).then(()=>{this.emit(Xe.EVENTS.RENDITION.RENDERED,e.section,e)}):this.emit(Xe.EVENTS.RENDITION.RENDERED,e.section,e)})}afterRemoved(e){this.hooks.unloaded.trigger(e,this).then(()=>{this.emit(Xe.EVENTS.RENDITION.REMOVED,e.section,e)})}onResized(e,t){this.emit(Xe.EVENTS.RENDITION.RESIZED,{width:e.width,height:e.height},t),this.location&&this.location.start&&this.display(t||this.location.start.cfi)}onOrientationChange(e){this.emit(Xe.EVENTS.RENDITION.ORIENTATION_CHANGE,e)}moveTo(e){this.manager.moveTo(e)}resize(e,t,n){e&&(this.settings.width=e),t&&(this.settings.height=t),this.manager.resize(e,t,n)}clear(){this.manager.clear()}next(){return this.q.enqueue(this.manager.next.bind(this.manager)).then(this.reportLocation.bind(this))}prev(){return this.q.enqueue(this.manager.prev.bind(this.manager)).then(this.reportLocation.bind(this))}determineLayoutProperties(e){var t,n=this.settings.layout||e.layout||"reflowable",i=this.settings.spread||e.spread||"auto",s=this.settings.orientation||e.orientation||"auto",a=this.settings.flow||e.flow||"auto",o=e.viewport||"",l=this.settings.minSpreadWidth||e.minSpreadWidth||800,u=this.settings.direction||e.direction||"ltr";return(this.settings.width===0||this.settings.width>0)&&(this.settings.height===0||this.settings.height>0),t={layout:n,spread:i,orientation:s,flow:a,viewport:o,minSpreadWidth:l,direction:u},t}flow(e){var t=e;(e==="scrolled"||e==="scrolled-doc"||e==="scrolled-continuous")&&(t="scrolled"),(e==="auto"||e==="paginated")&&(t="paginated"),this.settings.flow=e,this._layout&&this._layout.flow(t),this.manager&&this._layout&&this.manager.applyLayout(this._layout),this.manager&&this.manager.updateFlow(t),this.manager&&this.manager.isRendered()&&this.location&&(this.manager.clear(),this.display(this.location.start.cfi))}layout(e){return e&&(this._layout=new rL.default(e),this._layout.spread(e.spread,this.settings.minSpreadWidth),this._layout.on(Xe.EVENTS.LAYOUT.UPDATED,(t,n)=>{this.emit(Xe.EVENTS.RENDITION.LAYOUT,t,n)})),this.manager&&this._layout&&this.manager.applyLayout(this._layout),this._layout}spread(e,t){this.settings.spread=e,t&&(this.settings.minSpreadWidth=t),this._layout&&this._layout.spread(e,t),this.manager&&this.manager.isRendered()&&this.manager.updateLayout()}direction(e){this.settings.direction=e||"ltr",this.manager&&this.manager.direction(this.settings.direction),this.manager&&this.manager.isRendered()&&this.location&&(this.manager.clear(),this.display(this.location.start.cfi))}reportLocation(){return this.q.enqueue(function(){requestAnimationFrame(function(){var n=this.manager.currentLocation();if(n&&n.then&&typeof n.then=="function")n.then(function(i){let s=this.located(i);!s||!s.start||!s.end||(this.location=s,this.emit(Xe.EVENTS.RENDITION.LOCATION_CHANGED,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage}),this.emit(Xe.EVENTS.RENDITION.RELOCATED,this.location))}.bind(this));else if(n){let i=this.located(n);if(!i||!i.start||!i.end)return;this.location=i,this.emit(Xe.EVENTS.RENDITION.LOCATION_CHANGED,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage}),this.emit(Xe.EVENTS.RENDITION.RELOCATED,this.location)}}.bind(this))}.bind(this))}currentLocation(){var e=this.manager.currentLocation();if(e&&e.then&&typeof e.then=="function")e.then(function(t){return this.located(t)}.bind(this));else if(e)return this.located(e)}located(e){if(!e.length)return{};let t=e[0],n=e[e.length-1],i={start:{index:t.index,href:t.href,cfi:t.mapping.start,displayed:{page:t.pages[0]||1,total:t.totalPages}},end:{index:n.index,href:n.href,cfi:n.mapping.end,displayed:{page:n.pages[n.pages.length-1]||1,total:n.totalPages}}},s=this.book.locations.locationFromCfi(t.mapping.start),a=this.book.locations.locationFromCfi(n.mapping.end);s!=null&&(i.start.location=s,i.start.percentage=this.book.locations.percentageFromLocation(s)),a!=null&&(i.end.location=a,i.end.percentage=this.book.locations.percentageFromLocation(a));let o=this.book.pageList.pageFromCfi(t.mapping.start),l=this.book.pageList.pageFromCfi(n.mapping.end);return o!=-1&&(i.start.page=o),l!=-1&&(i.end.page=l),n.index===this.book.spine.last().index&&i.end.displayed.page>=i.end.displayed.total&&(i.atEnd=!0),t.index===this.book.spine.first().index&&i.start.displayed.page===1&&(i.atStart=!0),i}destroy(){this.manager&&this.manager.destroy(),this.book=void 0}passEvents(e){Xe.DOM_EVENTS.forEach(t=>{e.on(t,n=>this.triggerViewEvent(n,e))}),e.on(Xe.EVENTS.CONTENTS.SELECTED,t=>this.triggerSelectedEvent(t,e))}triggerViewEvent(e,t){this.emit(e.type,e,t)}triggerSelectedEvent(e,t){this.emit(Xe.EVENTS.RENDITION.SELECTED,e,t)}triggerMarkEvent(e,t,n){this.emit(Xe.EVENTS.RENDITION.MARK_CLICKED,e,t,n)}getRange(e,t){var n=new cm.default(e),i=this.manager.visible().filter(function(s){if(n.spinePos===s.index)return!0});if(i.length)return i[0].contents.range(n,t)}adjustImages(e){if(this._layout.name==="pre-paginated")return new Promise(function(s){s()});let t=e.window.getComputedStyle(e.content,null),n=(e.content.offsetHeight-(parseFloat(t.paddingTop)+parseFloat(t.paddingBottom)))*.95,i=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight);return e.addStylesheetRules({img:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-i+"px":"100%")+"!important","max-height":n+"px!important","object-fit":"contain","page-break-inside":"avoid","break-inside":"avoid","box-sizing":"border-box"},svg:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-i+"px":"100%")+"!important","max-height":n+"px!important","page-break-inside":"avoid","break-inside":"avoid"}}),new Promise(function(s,a){setTimeout(function(){s()},1)})}getContents(){return this.manager?this.manager.getContents():[]}views(){return(this.manager?this.manager.views:void 0)||[]}handleLinks(e){e&&e.on(Xe.EVENTS.CONTENTS.LINK_CLICKED,t=>{let n=this.book.path.relative(t);this.display(n)})}injectStylesheet(e,t){let n=e.createElement("link");n.setAttribute("type","text/css"),n.setAttribute("rel","stylesheet"),n.setAttribute("href",this.settings.stylesheet),e.getElementsByTagName("head")[0].appendChild(n)}injectScript(e,t){let n=e.createElement("script");n.setAttribute("type","text/javascript"),n.setAttribute("src",this.settings.script),n.textContent=" ",e.getElementsByTagName("head")[0].appendChild(n)}injectIdentifier(e,t){let n=this.book.packaging.metadata.identifier,i=e.createElement("meta");i.setAttribute("name","dc.relation.ispartof"),n&&i.setAttribute("content",n),e.getElementsByTagName("head")[0].appendChild(i)}}(0,eL.default)(Wx.prototype);var lL=Wx;aa.default=lL;var ec={};function pi(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Hx={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(r,e){(function(t){r.exports=t()})(function(){return function t(n,i,s){function a(u,c){if(!i[u]){if(!n[u]){var f=typeof pi=="function"&&pi;if(!c&&f)return f(u,!0);if(o)return o(u,!0);var h=new Error("Cannot find module '"+u+"'");throw h.code="MODULE_NOT_FOUND",h}var d=i[u]={exports:{}};n[u][0].call(d.exports,function(m){var x=n[u][1][m];return a(x||m)},d,d.exports,t,n,i,s)}return i[u].exports}for(var o=typeof pi=="function"&&pi,l=0;l<s.length;l++)a(s[l]);return a}({1:[function(t,n,i){var s=t("./utils"),a=t("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(l){for(var u=[],c,f,h,d,m,x,p,g=0,v=l.length,E=v,S=s.getTypeOf(l)!=="string";g<l.length;)E=v-g,S?(c=l[g++],f=g<v?l[g++]:0,h=g<v?l[g++]:0):(c=l.charCodeAt(g++),f=g<v?l.charCodeAt(g++):0,h=g<v?l.charCodeAt(g++):0),d=c>>2,m=(c&3)<<4|f>>4,x=E>1?(f&15)<<2|h>>6:64,p=E>2?h&63:64,u.push(o.charAt(d)+o.charAt(m)+o.charAt(x)+o.charAt(p));return u.join("")},i.decode=function(l){var u,c,f,h,d,m,x,p=0,g=0,v="data:";if(l.substr(0,v.length)===v)throw new Error("Invalid base64 input, it looks like a data url.");l=l.replace(/[^A-Za-z0-9+/=]/g,"");var E=l.length*3/4;if(l.charAt(l.length-1)===o.charAt(64)&&E--,l.charAt(l.length-2)===o.charAt(64)&&E--,E%1!==0)throw new Error("Invalid base64 input, bad content length.");var S;for(a.uint8array?S=new Uint8Array(E|0):S=new Array(E|0);p<l.length;)h=o.indexOf(l.charAt(p++)),d=o.indexOf(l.charAt(p++)),m=o.indexOf(l.charAt(p++)),x=o.indexOf(l.charAt(p++)),u=h<<2|d>>4,c=(d&15)<<4|m>>2,f=(m&3)<<6|x,S[g++]=u,m!==64&&(S[g++]=c),x!==64&&(S[g++]=f);return S}},{"./support":30,"./utils":32}],2:[function(t,n,i){var s=t("./external"),a=t("./stream/DataWorker"),o=t("./stream/Crc32Probe"),l=t("./stream/DataLengthProbe");function u(c,f,h,d,m){this.compressedSize=c,this.uncompressedSize=f,this.crc32=h,this.compression=d,this.compressedContent=m}u.prototype={getContentWorker:function(){var c=new a(s.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),f=this;return c.on("end",function(){if(this.streamInfo.data_length!==f.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),c},getCompressedWorker:function(){return new a(s.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},u.createWorkerFrom=function(c,f,h){return c.pipe(new o).pipe(new l("uncompressedSize")).pipe(f.compressWorker(h)).pipe(new l("compressedSize")).withStreamInfo("compression",f)},n.exports=u},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,n,i){var s=t("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(){return new s("STORE compression")},uncompressWorker:function(){return new s("STORE decompression")}},i.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,n,i){var s=t("./utils");function a(){for(var c,f=[],h=0;h<256;h++){c=h;for(var d=0;d<8;d++)c=c&1?3988292384^c>>>1:c>>>1;f[h]=c}return f}var o=a();function l(c,f,h,d){var m=o,x=d+h;c=c^-1;for(var p=d;p<x;p++)c=c>>>8^m[(c^f[p])&255];return c^-1}function u(c,f,h,d){var m=o,x=d+h;c=c^-1;for(var p=d;p<x;p++)c=c>>>8^m[(c^f.charCodeAt(p))&255];return c^-1}n.exports=function(f,h){if(typeof f>"u"||!f.length)return 0;var d=s.getTypeOf(f)!=="string";return d?l(h|0,f,f.length,0):u(h|0,f,f.length,0)}},{"./utils":32}],5:[function(t,n,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(t,n,i){var s=null;typeof Promise<"u"?s=Promise:s=t("lie"),n.exports={Promise:s}},{lie:37}],7:[function(t,n,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",a=t("pako"),o=t("./utils"),l=t("./stream/GenericWorker"),u=s?"uint8array":"array";i.magic="\b\0";function c(f,h){l.call(this,"FlateWorker/"+f),this._pako=null,this._pakoAction=f,this._pakoOptions=h,this.meta={}}o.inherits(c,l),c.prototype.processChunk=function(f){this.meta=f.meta,this._pako===null&&this._createPako(),this._pako.push(o.transformTo(u,f.data),!1)},c.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},c.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},c.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var f=this;this._pako.onData=function(h){f.push({data:h,meta:f.meta})}},i.compressWorker=function(f){return new c("Deflate",f)},i.uncompressWorker=function(){return new c("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,n,i){var s=t("../utils"),a=t("../stream/GenericWorker"),o=t("../utf8"),l=t("../crc32"),u=t("../signature"),c=function(g,v){var E="",S;for(S=0;S<v;S++)E+=String.fromCharCode(g&255),g=g>>>8;return E},f=function(g,v){var E=g;return g||(E=v?16893:33204),(E&65535)<<16},h=function(g){return(g||0)&63},d=function(g,v,E,S,T,w){var _=g.file,C=g.compression,O=w!==o.utf8encode,L=s.transformTo("string",w(_.name)),V=s.transformTo("string",o.utf8encode(_.name)),$=_.comment,ne=s.transformTo("string",w($)),me=s.transformTo("string",o.utf8encode($)),H=V.length!==_.name.length,j=me.length!==$.length,X,N,U="",Z="",oe="",re=_.dir,pe=_.date,Te={crc32:0,compressedSize:0,uncompressedSize:0};(!v||E)&&(Te.crc32=g.crc32,Te.compressedSize=g.compressedSize,Te.uncompressedSize=g.uncompressedSize);var Ie=0;v&&(Ie|=8),!O&&(H||j)&&(Ie|=2048);var Le=0,Oe=0;re&&(Le|=16),T==="UNIX"?(Oe=798,Le|=f(_.unixPermissions,re)):(Oe=20,Le|=h(_.dosPermissions)),X=pe.getUTCHours(),X=X<<6,X=X|pe.getUTCMinutes(),X=X<<5,X=X|pe.getUTCSeconds()/2,N=pe.getUTCFullYear()-1980,N=N<<4,N=N|pe.getUTCMonth()+1,N=N<<5,N=N|pe.getUTCDate(),H&&(Z=c(1,1)+c(l(L),4)+V,U+="up"+c(Z.length,2)+Z),j&&(oe=c(1,1)+c(l(ne),4)+me,U+="uc"+c(oe.length,2)+oe);var Re="";Re+=`
\0`,Re+=c(Ie,2),Re+=C.magic,Re+=c(X,2),Re+=c(N,2),Re+=c(Te.crc32,4),Re+=c(Te.compressedSize,4),Re+=c(Te.uncompressedSize,4),Re+=c(L.length,2),Re+=c(U.length,2);var ht=u.LOCAL_FILE_HEADER+Re+L+U,tt=u.CENTRAL_FILE_HEADER+c(Oe,2)+Re+c(ne.length,2)+"\0\0\0\0"+c(Le,4)+c(S,4)+L+U+ne;return{fileRecord:ht,dirRecord:tt}},m=function(g,v,E,S,T){var w="",_=s.transformTo("string",T(S));return w=u.CENTRAL_DIRECTORY_END+"\0\0\0\0"+c(g,2)+c(g,2)+c(v,4)+c(E,4)+c(_.length,2)+_,w},x=function(g){var v="";return v=u.DATA_DESCRIPTOR+c(g.crc32,4)+c(g.compressedSize,4)+c(g.uncompressedSize,4),v};function p(g,v,E,S){a.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=v,this.zipPlatform=E,this.encodeFileName=S,this.streamFiles=g,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}s.inherits(p,a),p.prototype.push=function(g){var v=g.meta.percent||0,E=this.entriesCount,S=this._sources.length;this.accumulate?this.contentBuffer.push(g):(this.bytesWritten+=g.data.length,a.prototype.push.call(this,{data:g.data,meta:{currentFile:this.currentFile,percent:E?(v+100*(E-S-1))/E:100}}))},p.prototype.openedSource=function(g){this.currentSourceOffset=this.bytesWritten,this.currentFile=g.file.name;var v=this.streamFiles&&!g.file.dir;if(v){var E=d(g,v,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:E.fileRecord,meta:{percent:0}})}else this.accumulate=!0},p.prototype.closedSource=function(g){this.accumulate=!1;var v=this.streamFiles&&!g.file.dir,E=d(g,v,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(E.dirRecord),v)this.push({data:x(g),meta:{percent:100}});else for(this.push({data:E.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},p.prototype.flush=function(){for(var g=this.bytesWritten,v=0;v<this.dirRecords.length;v++)this.push({data:this.dirRecords[v],meta:{percent:100}});var E=this.bytesWritten-g,S=m(this.dirRecords.length,E,g,this.zipComment,this.encodeFileName);this.push({data:S,meta:{percent:100}})},p.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},p.prototype.registerPrevious=function(g){this._sources.push(g);var v=this;return g.on("data",function(E){v.processChunk(E)}),g.on("end",function(){v.closedSource(v.previous.streamInfo),v._sources.length?v.prepareNextSource():v.end()}),g.on("error",function(E){v.error(E)}),this},p.prototype.resume=function(){if(!a.prototype.resume.call(this))return!1;if(!this.previous&&this._sources.length)return this.prepareNextSource(),!0;if(!this.previous&&!this._sources.length&&!this.generatedError)return this.end(),!0},p.prototype.error=function(g){var v=this._sources;if(!a.prototype.error.call(this,g))return!1;for(var E=0;E<v.length;E++)try{v[E].error(g)}catch{}return!0},p.prototype.lock=function(){a.prototype.lock.call(this);for(var g=this._sources,v=0;v<g.length;v++)g[v].lock()},n.exports=p},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,n,i){var s=t("../compressions"),a=t("./ZipFileWorker"),o=function(l,u){var c=l||u,f=s[c];if(!f)throw new Error(c+" is not a valid compression method !");return f};i.generateWorker=function(l,u,c){var f=new a(u.streamFiles,c,u.platform,u.encodeFileName),h=0;try{l.forEach(function(d,m){h++;var x=o(m.options.compression,u.compression),p=m.options.compressionOptions||u.compressionOptions||{},g=m.dir,v=m.date;m._compressWorker(x,p).withStreamInfo("file",{name:d,dir:g,date:v,comment:m.comment||"",unixPermissions:m.unixPermissions,dosPermissions:m.dosPermissions}).pipe(f)}),f.entriesCount=h}catch(d){f.error(d)}return f}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,n,i){function s(){if(!(this instanceof s))return new s;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var a=new s;for(var o in this)typeof this[o]!="function"&&(a[o]=this[o]);return a}}s.prototype=t("./object"),s.prototype.loadAsync=t("./load"),s.support=t("./support"),s.defaults=t("./defaults"),s.version="3.10.1",s.loadAsync=function(a,o){return new s().loadAsync(a,o)},s.external=t("./external"),n.exports=s},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,n,i){var s=t("./utils"),a=t("./external"),o=t("./utf8"),l=t("./zipEntries"),u=t("./stream/Crc32Probe"),c=t("./nodejsUtils");function f(h){return new a.Promise(function(d,m){var x=h.decompressed.getContentWorker().pipe(new u);x.on("error",function(p){m(p)}).on("end",function(){x.streamInfo.crc32!==h.decompressed.crc32?m(new Error("Corrupted zip : CRC32 mismatch")):d()}).resume()})}n.exports=function(h,d){var m=this;return d=s.extend(d||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),c.isNode&&c.isStream(h)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):s.prepareContent("the loaded zip file",h,!0,d.optimizedBinaryString,d.base64).then(function(x){var p=new l(d);return p.load(x),p}).then(function(p){var g=[a.Promise.resolve(p)],v=p.files;if(d.checkCRC32)for(var E=0;E<v.length;E++)g.push(f(v[E]));return a.Promise.all(g)}).then(function(p){for(var g=p.shift(),v=g.files,E=0;E<v.length;E++){var S=v[E],T=S.fileNameStr,w=s.resolve(S.fileNameStr);m.file(w,S.decompressed,{binary:!0,optimizedBinaryString:!0,date:S.date,dir:S.dir,comment:S.fileCommentStr.length?S.fileCommentStr:null,unixPermissions:S.unixPermissions,dosPermissions:S.dosPermissions,createFolders:d.createFolders}),S.dir||(m.file(w).unsafeOriginalName=T)}return g.zipComment.length&&(m.comment=g.zipComment),m})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,n,i){var s=t("../utils"),a=t("../stream/GenericWorker");function o(l,u){a.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(u)}s.inherits(o,a),o.prototype._bindStream=function(l){var u=this;this._stream=l,l.pause(),l.on("data",function(c){u.push({data:c,meta:{percent:0}})}).on("error",function(c){u.isPaused?this.generatedError=c:u.error(c)}).on("end",function(){u.isPaused?u._upstreamEnded=!0:u.end()})},o.prototype.pause=function(){return a.prototype.pause.call(this)?(this._stream.pause(),!0):!1},o.prototype.resume=function(){return a.prototype.resume.call(this)?(this._upstreamEnded?this.end():this._stream.resume(),!0):!1},n.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,n,i){var s=t("readable-stream").Readable,a=t("../utils");a.inherits(o,s);function o(l,u,c){s.call(this,u),this._helper=l;var f=this;l.on("data",function(h,d){f.push(h)||f._helper.pause(),c&&c(d)}).on("error",function(h){f.emit("error",h)}).on("end",function(){f.push(null)})}o.prototype._read=function(){this._helper.resume()},n.exports=o},{"../utils":32,"readable-stream":16}],14:[function(t,n,i){n.exports={isNode:typeof Buffer<"u",newBufferFrom:function(s,a){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(s,a);if(typeof s=="number")throw new Error('The "data" argument must not be a number');return new Buffer(s,a)},allocBuffer:function(s){if(Buffer.alloc)return Buffer.alloc(s);var a=new Buffer(s);return a.fill(0),a},isBuffer:function(s){return Buffer.isBuffer(s)},isStream:function(s){return s&&typeof s.on=="function"&&typeof s.pause=="function"&&typeof s.resume=="function"}}},{}],15:[function(t,n,i){var s=t("./utf8"),a=t("./utils"),o=t("./stream/GenericWorker"),l=t("./stream/StreamHelper"),u=t("./defaults"),c=t("./compressedObject"),f=t("./zipObject"),h=t("./generate"),d=t("./nodejsUtils"),m=t("./nodejs/NodejsStreamInputAdapter"),x=function(T,w,_){var C=a.getTypeOf(w),O,L=a.extend(_||{},u);L.date=L.date||new Date,L.compression!==null&&(L.compression=L.compression.toUpperCase()),typeof L.unixPermissions=="string"&&(L.unixPermissions=parseInt(L.unixPermissions,8)),L.unixPermissions&&L.unixPermissions&16384&&(L.dir=!0),L.dosPermissions&&L.dosPermissions&16&&(L.dir=!0),L.dir&&(T=g(T)),L.createFolders&&(O=p(T))&&v.call(this,O,!0);var V=C==="string"&&L.binary===!1&&L.base64===!1;(!_||typeof _.binary>"u")&&(L.binary=!V);var $=w instanceof c&&w.uncompressedSize===0;($||L.dir||!w||w.length===0)&&(L.base64=!1,L.binary=!0,w="",L.compression="STORE",C="string");var ne=null;w instanceof c||w instanceof o?ne=w:d.isNode&&d.isStream(w)?ne=new m(T,w):ne=a.prepareContent(T,w,L.binary,L.optimizedBinaryString,L.base64);var me=new f(T,ne,L);this.files[T]=me},p=function(T){T.slice(-1)==="/"&&(T=T.substring(0,T.length-1));var w=T.lastIndexOf("/");return w>0?T.substring(0,w):""},g=function(T){return T.slice(-1)!=="/"&&(T+="/"),T},v=function(T,w){return w=typeof w<"u"?w:u.createFolders,T=g(T),this.files[T]||x.call(this,T,null,{dir:!0,createFolders:w}),this.files[T]};function E(T){return Object.prototype.toString.call(T)==="[object RegExp]"}var S={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(T){var w,_,C;for(w in this.files)C=this.files[w],_=w.slice(this.root.length,w.length),_&&w.slice(0,this.root.length)===this.root&&T(_,C)},filter:function(T){var w=[];return this.forEach(function(_,C){T(_,C)&&w.push(C)}),w},file:function(T,w,_){if(arguments.length===1)if(E(T)){var C=T;return this.filter(function(L,V){return!V.dir&&C.test(L)})}else{var O=this.files[this.root+T];return O&&!O.dir?O:null}else T=this.root+T,x.call(this,T,w,_);return this},folder:function(T){if(!T)return this;if(E(T))return this.filter(function(O,L){return L.dir&&T.test(O)});var w=this.root+T,_=v.call(this,w),C=this.clone();return C.root=_.name,C},remove:function(T){T=this.root+T;var w=this.files[T];if(w||(T.slice(-1)!=="/"&&(T+="/"),w=this.files[T]),w&&!w.dir)delete this.files[T];else for(var _=this.filter(function(O,L){return L.name.slice(0,T.length)===T}),C=0;C<_.length;C++)delete this.files[_[C].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(T){var w,_={};try{if(_=a.extend(T||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:s.utf8encode}),_.type=_.type.toLowerCase(),_.compression=_.compression.toUpperCase(),_.type==="binarystring"&&(_.type="string"),!_.type)throw new Error("No output type specified.");a.checkSupport(_.type),(_.platform==="darwin"||_.platform==="freebsd"||_.platform==="linux"||_.platform==="sunos")&&(_.platform="UNIX"),_.platform==="win32"&&(_.platform="DOS");var C=_.comment||this.comment||"";w=h.generateWorker(this,_,C)}catch(O){w=new o("error"),w.error(O)}return new l(w,_.type||"string",_.mimeType)},generateAsync:function(T,w){return this.generateInternalStream(T).accumulate(w)},generateNodeStream:function(T,w){return T=T||{},T.type||(T.type="nodebuffer"),this.generateInternalStream(T).toNodejsStream(w)}};n.exports=S},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,n,i){n.exports=t("stream")},{stream:void 0}],17:[function(t,n,i){var s=t("./DataReader"),a=t("../utils");function o(l){s.call(this,l);for(var u=0;u<this.data.length;u++)l[u]=l[u]&255}a.inherits(o,s),o.prototype.byteAt=function(l){return this.data[this.zero+l]},o.prototype.lastIndexOfSignature=function(l){for(var u=l.charCodeAt(0),c=l.charCodeAt(1),f=l.charCodeAt(2),h=l.charCodeAt(3),d=this.length-4;d>=0;--d)if(this.data[d]===u&&this.data[d+1]===c&&this.data[d+2]===f&&this.data[d+3]===h)return d-this.zero;return-1},o.prototype.readAndCheckSignature=function(l){var u=l.charCodeAt(0),c=l.charCodeAt(1),f=l.charCodeAt(2),h=l.charCodeAt(3),d=this.readData(4);return u===d[0]&&c===d[1]&&f===d[2]&&h===d[3]},o.prototype.readData=function(l){if(this.checkOffset(l),l===0)return[];var u=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,u},n.exports=o},{"../utils":32,"./DataReader":18}],18:[function(t,n,i){var s=t("../utils");function a(o){this.data=o,this.length=o.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(o){this.checkIndex(this.index+o)},checkIndex:function(o){if(this.length<this.zero+o||o<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+o+"). Corrupted zip ?")},setIndex:function(o){this.checkIndex(o),this.index=o},skip:function(o){this.setIndex(this.index+o)},byteAt:function(){},readInt:function(o){var l=0,u;for(this.checkOffset(o),u=this.index+o-1;u>=this.index;u--)l=(l<<8)+this.byteAt(u);return this.index+=o,l},readString:function(o){return s.transformTo("string",this.readData(o))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var o=this.readInt(4);return new Date(Date.UTC((o>>25&127)+1980,(o>>21&15)-1,o>>16&31,o>>11&31,o>>5&63,(o&31)<<1))}},n.exports=a},{"../utils":32}],19:[function(t,n,i){var s=t("./Uint8ArrayReader"),a=t("../utils");function o(l){s.call(this,l)}a.inherits(o,s),o.prototype.readData=function(l){this.checkOffset(l);var u=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,u},n.exports=o},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,n,i){var s=t("./DataReader"),a=t("../utils");function o(l){s.call(this,l)}a.inherits(o,s),o.prototype.byteAt=function(l){return this.data.charCodeAt(this.zero+l)},o.prototype.lastIndexOfSignature=function(l){return this.data.lastIndexOf(l)-this.zero},o.prototype.readAndCheckSignature=function(l){var u=this.readData(4);return l===u},o.prototype.readData=function(l){this.checkOffset(l);var u=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,u},n.exports=o},{"../utils":32,"./DataReader":18}],21:[function(t,n,i){var s=t("./ArrayReader"),a=t("../utils");function o(l){s.call(this,l)}a.inherits(o,s),o.prototype.readData=function(l){if(this.checkOffset(l),l===0)return new Uint8Array(0);var u=this.data.subarray(this.zero+this.index,this.zero+this.index+l);return this.index+=l,u},n.exports=o},{"../utils":32,"./ArrayReader":17}],22:[function(t,n,i){var s=t("../utils"),a=t("../support"),o=t("./ArrayReader"),l=t("./StringReader"),u=t("./NodeBufferReader"),c=t("./Uint8ArrayReader");n.exports=function(f){var h=s.getTypeOf(f);return s.checkSupport(h),h==="string"&&!a.uint8array?new l(f):h==="nodebuffer"?new u(f):a.uint8array?new c(s.transformTo("uint8array",f)):new o(s.transformTo("array",f))}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,n,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,n,i){var s=t("./GenericWorker"),a=t("../utils");function o(l){s.call(this,"ConvertWorker to "+l),this.destType=l}a.inherits(o,s),o.prototype.processChunk=function(l){this.push({data:a.transformTo(this.destType,l.data),meta:l.meta})},n.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(t,n,i){var s=t("./GenericWorker"),a=t("../crc32"),o=t("../utils");function l(){s.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}o.inherits(l,s),l.prototype.processChunk=function(u){this.streamInfo.crc32=a(u.data,this.streamInfo.crc32||0),this.push(u)},n.exports=l},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,n,i){var s=t("../utils"),a=t("./GenericWorker");function o(l){a.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}s.inherits(o,a),o.prototype.processChunk=function(l){if(l){var u=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=u+l.data.length}a.prototype.processChunk.call(this,l)},n.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(t,n,i){var s=t("../utils"),a=t("./GenericWorker"),o=16*1024;function l(u){a.call(this,"DataWorker");var c=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,u.then(function(f){c.dataIsReady=!0,c.data=f,c.max=f&&f.length||0,c.type=s.getTypeOf(f),c.isPaused||c._tickAndRepeat()},function(f){c.error(f)})}s.inherits(l,a),l.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},l.prototype.resume=function(){return a.prototype.resume.call(this)?(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,s.delay(this._tickAndRepeat,[],this)),!0):!1},l.prototype._tickAndRepeat=function(){this._tickScheduled=!1,!(this.isPaused||this.isFinished)&&(this._tick(),this.isFinished||(s.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},l.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var u=o,c=null,f=Math.min(this.max,this.index+u);if(this.index>=this.max)return this.end();switch(this.type){case"string":c=this.data.substring(this.index,f);break;case"uint8array":c=this.data.subarray(this.index,f);break;case"array":case"nodebuffer":c=this.data.slice(this.index,f);break}return this.index=f,this.push({data:c,meta:{percent:this.max?this.index/this.max*100:0}})},n.exports=l},{"../utils":32,"./GenericWorker":28}],28:[function(t,n,i){function s(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}s.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return this.isFinished?!1:(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,o){return this._listeners[a].push(o),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,o){if(this._listeners[a])for(var l=0;l<this._listeners[a].length;l++)this._listeners[a][l].call(this,o)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var o=this;return a.on("data",function(l){o.processChunk(l)}),a.on("end",function(){o.end()}),a.on("error",function(l){o.error(l)}),this},pause:function(){return this.isPaused||this.isFinished?!1:(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var a=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,o){return this.extraStreamInfo[a]=o,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)!Object.prototype.hasOwnProperty.call(this.extraStreamInfo,a)||(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},n.exports=s},{}],29:[function(t,n,i){var s=t("../utils"),a=t("./ConvertWorker"),o=t("./GenericWorker"),l=t("../base64"),u=t("../support"),c=t("../external"),f=null;if(u.nodestream)try{f=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function h(p,g,v){switch(p){case"blob":return s.newBlob(s.transformTo("arraybuffer",g),v);case"base64":return l.encode(g);default:return s.transformTo(p,g)}}function d(p,g){var v,E=0,S=null,T=0;for(v=0;v<g.length;v++)T+=g[v].length;switch(p){case"string":return g.join("");case"array":return Array.prototype.concat.apply([],g);case"uint8array":for(S=new Uint8Array(T),v=0;v<g.length;v++)S.set(g[v],E),E+=g[v].length;return S;case"nodebuffer":return Buffer.concat(g);default:throw new Error("concat : unsupported type '"+p+"'")}}function m(p,g){return new c.Promise(function(v,E){var S=[],T=p._internalType,w=p._outputType,_=p._mimeType;p.on("data",function(C,O){S.push(C),g&&g(O)}).on("error",function(C){S=[],E(C)}).on("end",function(){try{var C=h(w,d(T,S),_);v(C)}catch(O){E(O)}S=[]}).resume()})}function x(p,g,v){var E=g;switch(g){case"blob":case"arraybuffer":E="uint8array";break;case"base64":E="string";break}try{this._internalType=E,this._outputType=g,this._mimeType=v,s.checkSupport(E),this._worker=p.pipe(new a(E)),p.lock()}catch(S){this._worker=new o("error"),this._worker.error(S)}}x.prototype={accumulate:function(p){return m(this,p)},on:function(p,g){var v=this;return p==="data"?this._worker.on(p,function(E){g.call(v,E.data,E.meta)}):this._worker.on(p,function(){s.delay(g,arguments,v)}),this},resume:function(){return s.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(p){if(s.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new f(this,{objectMode:this._outputType!=="nodebuffer"},p)}},n.exports=x},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,n,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",i.nodebuffer=typeof Buffer<"u",i.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")i.blob=!1;else{var s=new ArrayBuffer(0);try{i.blob=new Blob([s],{type:"application/zip"}).size===0}catch{try{var a=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,o=new a;o.append(s),i.blob=o.getBlob("application/zip").size===0}catch{i.blob=!1}}}try{i.nodestream=!!t("readable-stream").Readable}catch{i.nodestream=!1}},{"readable-stream":16}],31:[function(t,n,i){for(var s=t("./utils"),a=t("./support"),o=t("./nodejsUtils"),l=t("./stream/GenericWorker"),u=new Array(256),c=0;c<256;c++)u[c]=c>=252?6:c>=248?5:c>=240?4:c>=224?3:c>=192?2:1;u[254]=u[254]=1;var f=function(p){var g,v,E,S,T,w=p.length,_=0;for(S=0;S<w;S++)v=p.charCodeAt(S),(v&64512)===55296&&S+1<w&&(E=p.charCodeAt(S+1),(E&64512)===56320&&(v=65536+(v-55296<<10)+(E-56320),S++)),_+=v<128?1:v<2048?2:v<65536?3:4;for(a.uint8array?g=new Uint8Array(_):g=new Array(_),T=0,S=0;T<_;S++)v=p.charCodeAt(S),(v&64512)===55296&&S+1<w&&(E=p.charCodeAt(S+1),(E&64512)===56320&&(v=65536+(v-55296<<10)+(E-56320),S++)),v<128?g[T++]=v:v<2048?(g[T++]=192|v>>>6,g[T++]=128|v&63):v<65536?(g[T++]=224|v>>>12,g[T++]=128|v>>>6&63,g[T++]=128|v&63):(g[T++]=240|v>>>18,g[T++]=128|v>>>12&63,g[T++]=128|v>>>6&63,g[T++]=128|v&63);return g},h=function(p,g){var v;for(g=g||p.length,g>p.length&&(g=p.length),v=g-1;v>=0&&(p[v]&192)===128;)v--;return v<0||v===0?g:v+u[p[v]]>g?v:g},d=function(p){var g,v,E,S,T=p.length,w=new Array(T*2);for(v=0,g=0;g<T;){if(E=p[g++],E<128){w[v++]=E;continue}if(S=u[E],S>4){w[v++]=65533,g+=S-1;continue}for(E&=S===2?31:S===3?15:7;S>1&&g<T;)E=E<<6|p[g++]&63,S--;if(S>1){w[v++]=65533;continue}E<65536?w[v++]=E:(E-=65536,w[v++]=55296|E>>10&1023,w[v++]=56320|E&1023)}return w.length!==v&&(w.subarray?w=w.subarray(0,v):w.length=v),s.applyFromCharCode(w)};i.utf8encode=function(g){return a.nodebuffer?o.newBufferFrom(g,"utf-8"):f(g)},i.utf8decode=function(g){return a.nodebuffer?s.transformTo("nodebuffer",g).toString("utf-8"):(g=s.transformTo(a.uint8array?"uint8array":"array",g),d(g))};function m(){l.call(this,"utf-8 decode"),this.leftOver=null}s.inherits(m,l),m.prototype.processChunk=function(p){var g=s.transformTo(a.uint8array?"uint8array":"array",p.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var v=g;g=new Uint8Array(v.length+this.leftOver.length),g.set(this.leftOver,0),g.set(v,this.leftOver.length)}else g=this.leftOver.concat(g);this.leftOver=null}var E=h(g),S=g;E!==g.length&&(a.uint8array?(S=g.subarray(0,E),this.leftOver=g.subarray(E,g.length)):(S=g.slice(0,E),this.leftOver=g.slice(E,g.length))),this.push({data:i.utf8decode(S),meta:p.meta})},m.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=m;function x(){l.call(this,"utf-8 encode")}s.inherits(x,l),x.prototype.processChunk=function(p){this.push({data:i.utf8encode(p.data),meta:p.meta})},i.Utf8EncodeWorker=x},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,n,i){var s=t("./support"),a=t("./base64"),o=t("./nodejsUtils"),l=t("./external");t("setimmediate");function u(p){var g=null;return s.uint8array?g=new Uint8Array(p.length):g=new Array(p.length),f(p,g)}i.newBlob=function(p,g){i.checkSupport("blob");try{return new Blob([p],{type:g})}catch{try{var v=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,E=new v;return E.append(p),E.getBlob(g)}catch{throw new Error("Bug : can't construct the Blob.")}}};function c(p){return p}function f(p,g){for(var v=0;v<p.length;++v)g[v]=p.charCodeAt(v)&255;return g}var h={stringifyByChunk:function(p,g,v){var E=[],S=0,T=p.length;if(T<=v)return String.fromCharCode.apply(null,p);for(;S<T;)g==="array"||g==="nodebuffer"?E.push(String.fromCharCode.apply(null,p.slice(S,Math.min(S+v,T)))):E.push(String.fromCharCode.apply(null,p.subarray(S,Math.min(S+v,T)))),S+=v;return E.join("")},stringifyByChar:function(p){for(var g="",v=0;v<p.length;v++)g+=String.fromCharCode(p[v]);return g},applyCanBeUsed:{uint8array:function(){try{return s.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return s.nodebuffer&&String.fromCharCode.apply(null,o.allocBuffer(1)).length===1}catch{return!1}}()}};function d(p){var g=65536,v=i.getTypeOf(p),E=!0;if(v==="uint8array"?E=h.applyCanBeUsed.uint8array:v==="nodebuffer"&&(E=h.applyCanBeUsed.nodebuffer),E)for(;g>1;)try{return h.stringifyByChunk(p,v,g)}catch{g=Math.floor(g/2)}return h.stringifyByChar(p)}i.applyFromCharCode=d;function m(p,g){for(var v=0;v<p.length;v++)g[v]=p[v];return g}var x={};x.string={string:c,array:function(p){return f(p,new Array(p.length))},arraybuffer:function(p){return x.string.uint8array(p).buffer},uint8array:function(p){return f(p,new Uint8Array(p.length))},nodebuffer:function(p){return f(p,o.allocBuffer(p.length))}},x.array={string:d,array:c,arraybuffer:function(p){return new Uint8Array(p).buffer},uint8array:function(p){return new Uint8Array(p)},nodebuffer:function(p){return o.newBufferFrom(p)}},x.arraybuffer={string:function(p){return d(new Uint8Array(p))},array:function(p){return m(new Uint8Array(p),new Array(p.byteLength))},arraybuffer:c,uint8array:function(p){return new Uint8Array(p)},nodebuffer:function(p){return o.newBufferFrom(new Uint8Array(p))}},x.uint8array={string:d,array:function(p){return m(p,new Array(p.length))},arraybuffer:function(p){return p.buffer},uint8array:c,nodebuffer:function(p){return o.newBufferFrom(p)}},x.nodebuffer={string:d,array:function(p){return m(p,new Array(p.length))},arraybuffer:function(p){return x.nodebuffer.uint8array(p).buffer},uint8array:function(p){return m(p,new Uint8Array(p.length))},nodebuffer:c},i.transformTo=function(p,g){if(g||(g=""),!p)return g;i.checkSupport(p);var v=i.getTypeOf(g),E=x[v][p](g);return E},i.resolve=function(p){for(var g=p.split("/"),v=[],E=0;E<g.length;E++){var S=g[E];S==="."||S===""&&E!==0&&E!==g.length-1||(S===".."?v.pop():v.push(S))}return v.join("/")},i.getTypeOf=function(p){if(typeof p=="string")return"string";if(Object.prototype.toString.call(p)==="[object Array]")return"array";if(s.nodebuffer&&o.isBuffer(p))return"nodebuffer";if(s.uint8array&&p instanceof Uint8Array)return"uint8array";if(s.arraybuffer&&p instanceof ArrayBuffer)return"arraybuffer"},i.checkSupport=function(p){var g=s[p.toLowerCase()];if(!g)throw new Error(p+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(p){var g="",v,E;for(E=0;E<(p||"").length;E++)v=p.charCodeAt(E),g+="\\x"+(v<16?"0":"")+v.toString(16).toUpperCase();return g},i.delay=function(p,g,v){setImmediate(function(){p.apply(v||null,g||[])})},i.inherits=function(p,g){var v=function(){};v.prototype=g.prototype,p.prototype=new v},i.extend=function(){var p={},g,v;for(g=0;g<arguments.length;g++)for(v in arguments[g])Object.prototype.hasOwnProperty.call(arguments[g],v)&&typeof p[v]>"u"&&(p[v]=arguments[g][v]);return p},i.prepareContent=function(p,g,v,E,S){var T=l.Promise.resolve(g).then(function(w){var _=s.blob&&(w instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(w))!==-1);return _&&typeof FileReader<"u"?new l.Promise(function(C,O){var L=new FileReader;L.onload=function(V){C(V.target.result)},L.onerror=function(V){O(V.target.error)},L.readAsArrayBuffer(w)}):w});return T.then(function(w){var _=i.getTypeOf(w);return _?(_==="arraybuffer"?w=i.transformTo("uint8array",w):_==="string"&&(S?w=a.decode(w):v&&E!==!0&&(w=u(w))),w):l.Promise.reject(new Error("Can't read the data of '"+p+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,n,i){var s=t("./reader/readerFor"),a=t("./utils"),o=t("./signature"),l=t("./zipEntry"),u=t("./support");function c(f){this.files=[],this.loadOptions=f}c.prototype={checkSignature:function(f){if(!this.reader.readAndCheckSignature(f)){this.reader.index-=4;var h=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(h)+", expected "+a.pretty(f)+")")}},isSignature:function(f,h){var d=this.reader.index;this.reader.setIndex(f);var m=this.reader.readString(4),x=m===h;return this.reader.setIndex(d),x},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var f=this.reader.readData(this.zipCommentLength),h=u.uint8array?"uint8array":"array",d=a.transformTo(h,f);this.zipComment=this.loadOptions.decodeFileName(d)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var f=this.zip64EndOfCentralSize-44,h=0,d,m,x;h<f;)d=this.reader.readInt(2),m=this.reader.readInt(4),x=this.reader.readData(m),this.zip64ExtensibleData[d]={id:d,length:m,value:x}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var f,h;for(f=0;f<this.files.length;f++)h=this.files[f],this.reader.setIndex(h.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),h.readLocalPart(this.reader),h.handleUTF8(),h.processAttributes()},readCentralDir:function(){var f;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)f=new l({zip64:this.zip64},this.loadOptions),f.readCentralPart(this.reader),this.files.push(f);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var f=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(f<0){var h=!this.isSignature(0,o.LOCAL_FILE_HEADER);throw h?new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip: can't find end of central directory")}this.reader.setIndex(f);var d=f;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,f=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),f<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(f),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var m=this.centralDirOffset+this.centralDirSize;this.zip64&&(m+=20,m+=12+this.zip64EndOfCentralSize);var x=d-m;if(x>0)this.isSignature(d,o.CENTRAL_FILE_HEADER)||(this.reader.zero=x);else if(x<0)throw new Error("Corrupted zip: missing "+Math.abs(x)+" bytes.")},prepareReader:function(f){this.reader=s(f)},load:function(f){this.prepareReader(f),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},n.exports=c},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,n,i){var s=t("./reader/readerFor"),a=t("./utils"),o=t("./compressedObject"),l=t("./crc32"),u=t("./utf8"),c=t("./compressions"),f=t("./support"),h=0,d=3,m=function(p){for(var g in c)if(!!Object.prototype.hasOwnProperty.call(c,g)&&c[g].magic===p)return c[g];return null};function x(p,g){this.options=p,this.loadOptions=g}x.prototype={isEncrypted:function(){return(this.bitFlag&1)===1},useUTF8:function(){return(this.bitFlag&2048)===2048},readLocalPart:function(p){var g,v;if(p.skip(22),this.fileNameLength=p.readInt(2),v=p.readInt(2),this.fileName=p.readData(this.fileNameLength),p.skip(v),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(g=m(this.compressionMethod),g===null)throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,g,p.readData(this.compressedSize))},readCentralPart:function(p){this.versionMadeBy=p.readInt(2),p.skip(2),this.bitFlag=p.readInt(2),this.compressionMethod=p.readString(2),this.date=p.readDate(),this.crc32=p.readInt(4),this.compressedSize=p.readInt(4),this.uncompressedSize=p.readInt(4);var g=p.readInt(2);if(this.extraFieldsLength=p.readInt(2),this.fileCommentLength=p.readInt(2),this.diskNumberStart=p.readInt(2),this.internalFileAttributes=p.readInt(2),this.externalFileAttributes=p.readInt(4),this.localHeaderOffset=p.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");p.skip(g),this.readExtraFields(p),this.parseZIP64ExtraField(p),this.fileComment=p.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var p=this.versionMadeBy>>8;this.dir=!!(this.externalFileAttributes&16),p===h&&(this.dosPermissions=this.externalFileAttributes&63),p===d&&(this.unixPermissions=this.externalFileAttributes>>16&65535),!this.dir&&this.fileNameStr.slice(-1)==="/"&&(this.dir=!0)},parseZIP64ExtraField:function(){if(!!this.extraFields[1]){var p=s(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=p.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=p.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=p.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=p.readInt(4))}},readExtraFields:function(p){var g=p.index+this.extraFieldsLength,v,E,S;for(this.extraFields||(this.extraFields={});p.index+4<g;)v=p.readInt(2),E=p.readInt(2),S=p.readData(E),this.extraFields[v]={id:v,length:E,value:S};p.setIndex(g)},handleUTF8:function(){var p=f.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=u.utf8decode(this.fileName),this.fileCommentStr=u.utf8decode(this.fileComment);else{var g=this.findExtraFieldUnicodePath();if(g!==null)this.fileNameStr=g;else{var v=a.transformTo(p,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(v)}var E=this.findExtraFieldUnicodeComment();if(E!==null)this.fileCommentStr=E;else{var S=a.transformTo(p,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(S)}}},findExtraFieldUnicodePath:function(){var p=this.extraFields[28789];if(p){var g=s(p.value);return g.readInt(1)!==1||l(this.fileName)!==g.readInt(4)?null:u.utf8decode(g.readData(p.length-5))}return null},findExtraFieldUnicodeComment:function(){var p=this.extraFields[25461];if(p){var g=s(p.value);return g.readInt(1)!==1||l(this.fileComment)!==g.readInt(4)?null:u.utf8decode(g.readData(p.length-5))}return null}},n.exports=x},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,n,i){var s=t("./stream/StreamHelper"),a=t("./stream/DataWorker"),o=t("./utf8"),l=t("./compressedObject"),u=t("./stream/GenericWorker"),c=function(m,x,p){this.name=m,this.dir=p.dir,this.date=p.date,this.comment=p.comment,this.unixPermissions=p.unixPermissions,this.dosPermissions=p.dosPermissions,this._data=x,this._dataBinary=p.binary,this.options={compression:p.compression,compressionOptions:p.compressionOptions}};c.prototype={internalStream:function(m){var x=null,p="string";try{if(!m)throw new Error("No output type specified.");p=m.toLowerCase();var g=p==="string"||p==="text";(p==="binarystring"||p==="text")&&(p="string"),x=this._decompressWorker();var v=!this._dataBinary;v&&!g&&(x=x.pipe(new o.Utf8EncodeWorker)),!v&&g&&(x=x.pipe(new o.Utf8DecodeWorker))}catch(E){x=new u("error"),x.error(E)}return new s(x,p,"")},async:function(m,x){return this.internalStream(m).accumulate(x)},nodeStream:function(m,x){return this.internalStream(m||"nodebuffer").toNodejsStream(x)},_compressWorker:function(m,x){if(this._data instanceof l&&this._data.compression.magic===m.magic)return this._data.getCompressedWorker();var p=this._decompressWorker();return this._dataBinary||(p=p.pipe(new o.Utf8EncodeWorker)),l.createWorkerFrom(p,m,x)},_decompressWorker:function(){return this._data instanceof l?this._data.getContentWorker():this._data instanceof u?this._data:new a(this._data)}};for(var f=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],h=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},d=0;d<f.length;d++)c.prototype[f[d]]=h;n.exports=c},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,n,i){(function(s){var a=s.MutationObserver||s.WebKitMutationObserver,o;if(a){var l=0,u=new a(m),c=s.document.createTextNode("");u.observe(c,{characterData:!0}),o=function(){c.data=l=++l%2}}else if(!s.setImmediate&&typeof s.MessageChannel<"u"){var f=new s.MessageChannel;f.port1.onmessage=m,o=function(){f.port2.postMessage(0)}}else"document"in s&&"onreadystatechange"in s.document.createElement("script")?o=function(){var p=s.document.createElement("script");p.onreadystatechange=function(){m(),p.onreadystatechange=null,p.parentNode.removeChild(p),p=null},s.document.documentElement.appendChild(p)}:o=function(){setTimeout(m,0)};var h,d=[];function m(){h=!0;for(var p,g,v=d.length;v;){for(g=d,d=[],p=-1;++p<v;)g[p]();v=d.length}h=!1}n.exports=x;function x(p){d.push(p)===1&&!h&&o()}}).call(this,typeof hr<"u"?hr:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,n,i){var s=t("immediate");function a(){}var o={},l=["REJECTED"],u=["FULFILLED"],c=["PENDING"];n.exports=f;function f(T){if(typeof T!="function")throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,T!==a&&x(this,T)}f.prototype.finally=function(T){if(typeof T!="function")return this;var w=this.constructor;return this.then(_,C);function _(O){function L(){return O}return w.resolve(T()).then(L)}function C(O){function L(){throw O}return w.resolve(T()).then(L)}},f.prototype.catch=function(T){return this.then(null,T)},f.prototype.then=function(T,w){if(typeof T!="function"&&this.state===u||typeof w!="function"&&this.state===l)return this;var _=new this.constructor(a);if(this.state!==c){var C=this.state===u?T:w;d(_,C,this.outcome)}else this.queue.push(new h(_,T,w));return _};function h(T,w,_){this.promise=T,typeof w=="function"&&(this.onFulfilled=w,this.callFulfilled=this.otherCallFulfilled),typeof _=="function"&&(this.onRejected=_,this.callRejected=this.otherCallRejected)}h.prototype.callFulfilled=function(T){o.resolve(this.promise,T)},h.prototype.otherCallFulfilled=function(T){d(this.promise,this.onFulfilled,T)},h.prototype.callRejected=function(T){o.reject(this.promise,T)},h.prototype.otherCallRejected=function(T){d(this.promise,this.onRejected,T)};function d(T,w,_){s(function(){var C;try{C=w(_)}catch(O){return o.reject(T,O)}C===T?o.reject(T,new TypeError("Cannot resolve promise with itself")):o.resolve(T,C)})}o.resolve=function(T,w){var _=p(m,w);if(_.status==="error")return o.reject(T,_.value);var C=_.value;if(C)x(T,C);else{T.state=u,T.outcome=w;for(var O=-1,L=T.queue.length;++O<L;)T.queue[O].callFulfilled(w)}return T},o.reject=function(T,w){T.state=l,T.outcome=w;for(var _=-1,C=T.queue.length;++_<C;)T.queue[_].callRejected(w);return T};function m(T){var w=T&&T.then;if(T&&(typeof T=="object"||typeof T=="function")&&typeof w=="function")return function(){w.apply(T,arguments)}}function x(T,w){var _=!1;function C($){_||(_=!0,o.reject(T,$))}function O($){_||(_=!0,o.resolve(T,$))}function L(){w(O,C)}var V=p(L);V.status==="error"&&C(V.value)}function p(T,w){var _={};try{_.value=T(w),_.status="success"}catch(C){_.status="error",_.value=C}return _}f.resolve=g;function g(T){return T instanceof this?T:o.resolve(new this(a),T)}f.reject=v;function v(T){var w=new this(a);return o.reject(w,T)}f.all=E;function E(T){var w=this;if(Object.prototype.toString.call(T)!=="[object Array]")return this.reject(new TypeError("must be an array"));var _=T.length,C=!1;if(!_)return this.resolve([]);for(var O=new Array(_),L=0,V=-1,$=new this(a);++V<_;)ne(T[V],V);return $;function ne(me,H){w.resolve(me).then(j,function(X){C||(C=!0,o.reject($,X))});function j(X){O[H]=X,++L===_&&!C&&(C=!0,o.resolve($,O))}}}f.race=S;function S(T){var w=this;if(Object.prototype.toString.call(T)!=="[object Array]")return this.reject(new TypeError("must be an array"));var _=T.length,C=!1;if(!_)return this.resolve([]);for(var O=-1,L=new this(a);++O<_;)V(T[O]);return L;function V($){w.resolve($).then(function(ne){C||(C=!0,o.resolve(L,ne))},function(ne){C||(C=!0,o.reject(L,ne))})}}},{immediate:36}],38:[function(t,n,i){var s=t("./lib/utils/common").assign,a=t("./lib/deflate"),o=t("./lib/inflate"),l=t("./lib/zlib/constants"),u={};s(u,a,o,l),n.exports=u},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,n,i){var s=t("./zlib/deflate"),a=t("./utils/common"),o=t("./utils/strings"),l=t("./zlib/messages"),u=t("./zlib/zstream"),c=Object.prototype.toString,f=0,h=4,d=0,m=1,x=2,p=-1,g=0,v=8;function E(_){if(!(this instanceof E))return new E(_);this.options=a.assign({level:p,method:v,chunkSize:16384,windowBits:15,memLevel:8,strategy:g,to:""},_||{});var C=this.options;C.raw&&C.windowBits>0?C.windowBits=-C.windowBits:C.gzip&&C.windowBits>0&&C.windowBits<16&&(C.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var O=s.deflateInit2(this.strm,C.level,C.method,C.windowBits,C.memLevel,C.strategy);if(O!==d)throw new Error(l[O]);if(C.header&&s.deflateSetHeader(this.strm,C.header),C.dictionary){var L;if(typeof C.dictionary=="string"?L=o.string2buf(C.dictionary):c.call(C.dictionary)==="[object ArrayBuffer]"?L=new Uint8Array(C.dictionary):L=C.dictionary,O=s.deflateSetDictionary(this.strm,L),O!==d)throw new Error(l[O]);this._dict_set=!0}}E.prototype.push=function(_,C){var O=this.strm,L=this.options.chunkSize,V,$;if(this.ended)return!1;$=C===~~C?C:C===!0?h:f,typeof _=="string"?O.input=o.string2buf(_):c.call(_)==="[object ArrayBuffer]"?O.input=new Uint8Array(_):O.input=_,O.next_in=0,O.avail_in=O.input.length;do{if(O.avail_out===0&&(O.output=new a.Buf8(L),O.next_out=0,O.avail_out=L),V=s.deflate(O,$),V!==m&&V!==d)return this.onEnd(V),this.ended=!0,!1;(O.avail_out===0||O.avail_in===0&&($===h||$===x))&&(this.options.to==="string"?this.onData(o.buf2binstring(a.shrinkBuf(O.output,O.next_out))):this.onData(a.shrinkBuf(O.output,O.next_out)))}while((O.avail_in>0||O.avail_out===0)&&V!==m);return $===h?(V=s.deflateEnd(this.strm),this.onEnd(V),this.ended=!0,V===d):($===x&&(this.onEnd(d),O.avail_out=0),!0)},E.prototype.onData=function(_){this.chunks.push(_)},E.prototype.onEnd=function(_){_===d&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=_,this.msg=this.strm.msg};function S(_,C){var O=new E(C);if(O.push(_,!0),O.err)throw O.msg||l[O.err];return O.result}function T(_,C){return C=C||{},C.raw=!0,S(_,C)}function w(_,C){return C=C||{},C.gzip=!0,S(_,C)}i.Deflate=E,i.deflate=S,i.deflateRaw=T,i.gzip=w},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,n,i){var s=t("./zlib/inflate"),a=t("./utils/common"),o=t("./utils/strings"),l=t("./zlib/constants"),u=t("./zlib/messages"),c=t("./zlib/zstream"),f=t("./zlib/gzheader"),h=Object.prototype.toString;function d(p){if(!(this instanceof d))return new d(p);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},p||{});var g=this.options;g.raw&&g.windowBits>=0&&g.windowBits<16&&(g.windowBits=-g.windowBits,g.windowBits===0&&(g.windowBits=-15)),g.windowBits>=0&&g.windowBits<16&&!(p&&p.windowBits)&&(g.windowBits+=32),g.windowBits>15&&g.windowBits<48&&(g.windowBits&15)===0&&(g.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var v=s.inflateInit2(this.strm,g.windowBits);if(v!==l.Z_OK)throw new Error(u[v]);this.header=new f,s.inflateGetHeader(this.strm,this.header)}d.prototype.push=function(p,g){var v=this.strm,E=this.options.chunkSize,S=this.options.dictionary,T,w,_,C,O,L,V=!1;if(this.ended)return!1;w=g===~~g?g:g===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof p=="string"?v.input=o.binstring2buf(p):h.call(p)==="[object ArrayBuffer]"?v.input=new Uint8Array(p):v.input=p,v.next_in=0,v.avail_in=v.input.length;do{if(v.avail_out===0&&(v.output=new a.Buf8(E),v.next_out=0,v.avail_out=E),T=s.inflate(v,l.Z_NO_FLUSH),T===l.Z_NEED_DICT&&S&&(typeof S=="string"?L=o.string2buf(S):h.call(S)==="[object ArrayBuffer]"?L=new Uint8Array(S):L=S,T=s.inflateSetDictionary(this.strm,L)),T===l.Z_BUF_ERROR&&V===!0&&(T=l.Z_OK,V=!1),T!==l.Z_STREAM_END&&T!==l.Z_OK)return this.onEnd(T),this.ended=!0,!1;v.next_out&&(v.avail_out===0||T===l.Z_STREAM_END||v.avail_in===0&&(w===l.Z_FINISH||w===l.Z_SYNC_FLUSH))&&(this.options.to==="string"?(_=o.utf8border(v.output,v.next_out),C=v.next_out-_,O=o.buf2string(v.output,_),v.next_out=C,v.avail_out=E-C,C&&a.arraySet(v.output,v.output,_,C,0),this.onData(O)):this.onData(a.shrinkBuf(v.output,v.next_out))),v.avail_in===0&&v.avail_out===0&&(V=!0)}while((v.avail_in>0||v.avail_out===0)&&T!==l.Z_STREAM_END);return T===l.Z_STREAM_END&&(w=l.Z_FINISH),w===l.Z_FINISH?(T=s.inflateEnd(this.strm),this.onEnd(T),this.ended=!0,T===l.Z_OK):(w===l.Z_SYNC_FLUSH&&(this.onEnd(l.Z_OK),v.avail_out=0),!0)},d.prototype.onData=function(p){this.chunks.push(p)},d.prototype.onEnd=function(p){p===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=p,this.msg=this.strm.msg};function m(p,g){var v=new d(g);if(v.push(p,!0),v.err)throw v.msg||u[v.err];return v.result}function x(p,g){return g=g||{},g.raw=!0,m(p,g)}i.Inflate=d,i.inflate=m,i.inflateRaw=x,i.ungzip=m},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,n,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";i.assign=function(l){for(var u=Array.prototype.slice.call(arguments,1);u.length;){var c=u.shift();if(!!c){if(typeof c!="object")throw new TypeError(c+"must be non-object");for(var f in c)c.hasOwnProperty(f)&&(l[f]=c[f])}}return l},i.shrinkBuf=function(l,u){return l.length===u?l:l.subarray?l.subarray(0,u):(l.length=u,l)};var a={arraySet:function(l,u,c,f,h){if(u.subarray&&l.subarray){l.set(u.subarray(c,c+f),h);return}for(var d=0;d<f;d++)l[h+d]=u[c+d]},flattenChunks:function(l){var u,c,f,h,d,m;for(f=0,u=0,c=l.length;u<c;u++)f+=l[u].length;for(m=new Uint8Array(f),h=0,u=0,c=l.length;u<c;u++)d=l[u],m.set(d,h),h+=d.length;return m}},o={arraySet:function(l,u,c,f,h){for(var d=0;d<f;d++)l[h+d]=u[c+d]},flattenChunks:function(l){return[].concat.apply([],l)}};i.setTyped=function(l){l?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,a)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,o))},i.setTyped(s)},{}],42:[function(t,n,i){var s=t("./common"),a=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch{a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{o=!1}for(var l=new s.Buf8(256),u=0;u<256;u++)l[u]=u>=252?6:u>=248?5:u>=240?4:u>=224?3:u>=192?2:1;l[254]=l[254]=1,i.string2buf=function(f){var h,d,m,x,p,g=f.length,v=0;for(x=0;x<g;x++)d=f.charCodeAt(x),(d&64512)===55296&&x+1<g&&(m=f.charCodeAt(x+1),(m&64512)===56320&&(d=65536+(d-55296<<10)+(m-56320),x++)),v+=d<128?1:d<2048?2:d<65536?3:4;for(h=new s.Buf8(v),p=0,x=0;p<v;x++)d=f.charCodeAt(x),(d&64512)===55296&&x+1<g&&(m=f.charCodeAt(x+1),(m&64512)===56320&&(d=65536+(d-55296<<10)+(m-56320),x++)),d<128?h[p++]=d:d<2048?(h[p++]=192|d>>>6,h[p++]=128|d&63):d<65536?(h[p++]=224|d>>>12,h[p++]=128|d>>>6&63,h[p++]=128|d&63):(h[p++]=240|d>>>18,h[p++]=128|d>>>12&63,h[p++]=128|d>>>6&63,h[p++]=128|d&63);return h};function c(f,h){if(h<65537&&(f.subarray&&o||!f.subarray&&a))return String.fromCharCode.apply(null,s.shrinkBuf(f,h));for(var d="",m=0;m<h;m++)d+=String.fromCharCode(f[m]);return d}i.buf2binstring=function(f){return c(f,f.length)},i.binstring2buf=function(f){for(var h=new s.Buf8(f.length),d=0,m=h.length;d<m;d++)h[d]=f.charCodeAt(d);return h},i.buf2string=function(f,h){var d,m,x,p,g=h||f.length,v=new Array(g*2);for(m=0,d=0;d<g;){if(x=f[d++],x<128){v[m++]=x;continue}if(p=l[x],p>4){v[m++]=65533,d+=p-1;continue}for(x&=p===2?31:p===3?15:7;p>1&&d<g;)x=x<<6|f[d++]&63,p--;if(p>1){v[m++]=65533;continue}x<65536?v[m++]=x:(x-=65536,v[m++]=55296|x>>10&1023,v[m++]=56320|x&1023)}return c(v,m)},i.utf8border=function(f,h){var d;for(h=h||f.length,h>f.length&&(h=f.length),d=h-1;d>=0&&(f[d]&192)===128;)d--;return d<0||d===0?h:d+l[f[d]]>h?d:h}},{"./common":41}],43:[function(t,n,i){function s(a,o,l,u){for(var c=a&65535|0,f=a>>>16&65535|0,h=0;l!==0;){h=l>2e3?2e3:l,l-=h;do c=c+o[u++]|0,f=f+c|0;while(--h);c%=65521,f%=65521}return c|f<<16|0}n.exports=s},{}],44:[function(t,n,i){n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,n,i){function s(){for(var l,u=[],c=0;c<256;c++){l=c;for(var f=0;f<8;f++)l=l&1?3988292384^l>>>1:l>>>1;u[c]=l}return u}var a=s();function o(l,u,c,f){var h=a,d=f+c;l^=-1;for(var m=f;m<d;m++)l=l>>>8^h[(l^u[m])&255];return l^-1}n.exports=o},{}],46:[function(t,n,i){var s=t("../utils/common"),a=t("./trees"),o=t("./adler32"),l=t("./crc32"),u=t("./messages"),c=0,f=1,h=3,d=4,m=5,x=0,p=1,g=-2,v=-3,E=-5,S=-1,T=1,w=2,_=3,C=4,O=0,L=2,V=8,$=9,ne=15,me=8,H=29,j=256,X=j+1+H,N=30,U=19,Z=2*X+1,oe=15,re=3,pe=258,Te=pe+re+1,Ie=32,Le=42,Oe=69,Re=73,ht=91,tt=103,Ge=113,rt=666,$e=1,bt=2,dt=3,rr=4,Ve=3;function xt(y,Y){return y.msg=u[Y],Y}function jr(y){return(y<<1)-(y>4?9:0)}function Ut(y){for(var Y=y.length;--Y>=0;)y[Y]=0}function kt(y){var Y=y.state,Q=Y.pending;Q>y.avail_out&&(Q=y.avail_out),Q!==0&&(s.arraySet(y.output,Y.pending_buf,Y.pending_out,Q,y.next_out),y.next_out+=Q,Y.pending_out+=Q,y.total_out+=Q,y.avail_out-=Q,Y.pending-=Q,Y.pending===0&&(Y.pending_out=0))}function Ye(y,Y){a._tr_flush_block(y,y.block_start>=0?y.block_start:-1,y.strstart-y.block_start,Y),y.block_start=y.strstart,kt(y.strm)}function ke(y,Y){y.pending_buf[y.pending++]=Y}function qt(y,Y){y.pending_buf[y.pending++]=Y>>>8&255,y.pending_buf[y.pending++]=Y&255}function Ln(y,Y,Q,D){var F=y.avail_in;return F>D&&(F=D),F===0?0:(y.avail_in-=F,s.arraySet(Y,y.input,y.next_in,F,Q),y.state.wrap===1?y.adler=o(y.adler,Y,F,Q):y.state.wrap===2&&(y.adler=l(y.adler,Y,F,Q)),y.next_in+=F,y.total_in+=F,F)}function Kr(y,Y){var Q=y.max_chain_length,D=y.strstart,F,K,Se=y.prev_length,ge=y.nice_match,ye=y.strstart>y.w_size-Te?y.strstart-(y.w_size-Te):0,Pe=y.window,Xr=y.w_mask,nt=y.prev,Me=y.strstart+pe,pt=Pe[D+Se-1],Dt=Pe[D+Se];y.prev_length>=y.good_match&&(Q>>=2),ge>y.lookahead&&(ge=y.lookahead);do if(F=Y,!(Pe[F+Se]!==Dt||Pe[F+Se-1]!==pt||Pe[F]!==Pe[D]||Pe[++F]!==Pe[D+1])){D+=2,F++;do;while(Pe[++D]===Pe[++F]&&Pe[++D]===Pe[++F]&&Pe[++D]===Pe[++F]&&Pe[++D]===Pe[++F]&&Pe[++D]===Pe[++F]&&Pe[++D]===Pe[++F]&&Pe[++D]===Pe[++F]&&Pe[++D]===Pe[++F]&&D<Me);if(K=pe-(Me-D),D=Me-pe,K>Se){if(y.match_start=Y,Se=K,K>=ge)break;pt=Pe[D+Se-1],Dt=Pe[D+Se]}}while((Y=nt[Y&Xr])>ye&&--Q!==0);return Se<=y.lookahead?Se:y.lookahead}function Yt(y){var Y=y.w_size,Q,D,F,K,Se;do{if(K=y.window_size-y.lookahead-y.strstart,y.strstart>=Y+(Y-Te)){s.arraySet(y.window,y.window,Y,Y,0),y.match_start-=Y,y.strstart-=Y,y.block_start-=Y,D=y.hash_size,Q=D;do F=y.head[--Q],y.head[Q]=F>=Y?F-Y:0;while(--D);D=Y,Q=D;do F=y.prev[--Q],y.prev[Q]=F>=Y?F-Y:0;while(--D);K+=Y}if(y.strm.avail_in===0)break;if(D=Ln(y.strm,y.window,y.strstart+y.lookahead,K),y.lookahead+=D,y.lookahead+y.insert>=re)for(Se=y.strstart-y.insert,y.ins_h=y.window[Se],y.ins_h=(y.ins_h<<y.hash_shift^y.window[Se+1])&y.hash_mask;y.insert&&(y.ins_h=(y.ins_h<<y.hash_shift^y.window[Se+re-1])&y.hash_mask,y.prev[Se&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=Se,Se++,y.insert--,!(y.lookahead+y.insert<re)););}while(y.lookahead<Te&&y.strm.avail_in!==0)}function In(y,Y){var Q=65535;for(Q>y.pending_buf_size-5&&(Q=y.pending_buf_size-5);;){if(y.lookahead<=1){if(Yt(y),y.lookahead===0&&Y===c)return $e;if(y.lookahead===0)break}y.strstart+=y.lookahead,y.lookahead=0;var D=y.block_start+Q;if((y.strstart===0||y.strstart>=D)&&(y.lookahead=y.strstart-D,y.strstart=D,Ye(y,!1),y.strm.avail_out===0)||y.strstart-y.block_start>=y.w_size-Te&&(Ye(y,!1),y.strm.avail_out===0))return $e}return y.insert=0,Y===d?(Ye(y,!0),y.strm.avail_out===0?dt:rr):(y.strstart>y.block_start&&(Ye(y,!1),y.strm.avail_out===0),$e)}function qr(y,Y){for(var Q,D;;){if(y.lookahead<Te){if(Yt(y),y.lookahead<Te&&Y===c)return $e;if(y.lookahead===0)break}if(Q=0,y.lookahead>=re&&(y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+re-1])&y.hash_mask,Q=y.prev[y.strstart&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=y.strstart),Q!==0&&y.strstart-Q<=y.w_size-Te&&(y.match_length=Kr(y,Q)),y.match_length>=re)if(D=a._tr_tally(y,y.strstart-y.match_start,y.match_length-re),y.lookahead-=y.match_length,y.match_length<=y.max_lazy_match&&y.lookahead>=re){y.match_length--;do y.strstart++,y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+re-1])&y.hash_mask,Q=y.prev[y.strstart&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=y.strstart;while(--y.match_length!==0);y.strstart++}else y.strstart+=y.match_length,y.match_length=0,y.ins_h=y.window[y.strstart],y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+1])&y.hash_mask;else D=a._tr_tally(y,0,y.window[y.strstart]),y.lookahead--,y.strstart++;if(D&&(Ye(y,!1),y.strm.avail_out===0))return $e}return y.insert=y.strstart<re-1?y.strstart:re-1,Y===d?(Ye(y,!0),y.strm.avail_out===0?dt:rr):y.last_lit&&(Ye(y,!1),y.strm.avail_out===0)?$e:bt}function nr(y,Y){for(var Q,D,F;;){if(y.lookahead<Te){if(Yt(y),y.lookahead<Te&&Y===c)return $e;if(y.lookahead===0)break}if(Q=0,y.lookahead>=re&&(y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+re-1])&y.hash_mask,Q=y.prev[y.strstart&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=y.strstart),y.prev_length=y.match_length,y.prev_match=y.match_start,y.match_length=re-1,Q!==0&&y.prev_length<y.max_lazy_match&&y.strstart-Q<=y.w_size-Te&&(y.match_length=Kr(y,Q),y.match_length<=5&&(y.strategy===T||y.match_length===re&&y.strstart-y.match_start>4096)&&(y.match_length=re-1)),y.prev_length>=re&&y.match_length<=y.prev_length){F=y.strstart+y.lookahead-re,D=a._tr_tally(y,y.strstart-1-y.prev_match,y.prev_length-re),y.lookahead-=y.prev_length-1,y.prev_length-=2;do++y.strstart<=F&&(y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+re-1])&y.hash_mask,Q=y.prev[y.strstart&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=y.strstart);while(--y.prev_length!==0);if(y.match_available=0,y.match_length=re-1,y.strstart++,D&&(Ye(y,!1),y.strm.avail_out===0))return $e}else if(y.match_available){if(D=a._tr_tally(y,0,y.window[y.strstart-1]),D&&Ye(y,!1),y.strstart++,y.lookahead--,y.strm.avail_out===0)return $e}else y.match_available=1,y.strstart++,y.lookahead--}return y.match_available&&(D=a._tr_tally(y,0,y.window[y.strstart-1]),y.match_available=0),y.insert=y.strstart<re-1?y.strstart:re-1,Y===d?(Ye(y,!0),y.strm.avail_out===0?dt:rr):y.last_lit&&(Ye(y,!1),y.strm.avail_out===0)?$e:bt}function kn(y,Y){for(var Q,D,F,K,Se=y.window;;){if(y.lookahead<=pe){if(Yt(y),y.lookahead<=pe&&Y===c)return $e;if(y.lookahead===0)break}if(y.match_length=0,y.lookahead>=re&&y.strstart>0&&(F=y.strstart-1,D=Se[F],D===Se[++F]&&D===Se[++F]&&D===Se[++F])){K=y.strstart+pe;do;while(D===Se[++F]&&D===Se[++F]&&D===Se[++F]&&D===Se[++F]&&D===Se[++F]&&D===Se[++F]&&D===Se[++F]&&D===Se[++F]&&F<K);y.match_length=pe-(K-F),y.match_length>y.lookahead&&(y.match_length=y.lookahead)}if(y.match_length>=re?(Q=a._tr_tally(y,1,y.match_length-re),y.lookahead-=y.match_length,y.strstart+=y.match_length,y.match_length=0):(Q=a._tr_tally(y,0,y.window[y.strstart]),y.lookahead--,y.strstart++),Q&&(Ye(y,!1),y.strm.avail_out===0))return $e}return y.insert=0,Y===d?(Ye(y,!0),y.strm.avail_out===0?dt:rr):y.last_lit&&(Ye(y,!1),y.strm.avail_out===0)?$e:bt}function Yr(y,Y){for(var Q;;){if(y.lookahead===0&&(Yt(y),y.lookahead===0)){if(Y===c)return $e;break}if(y.match_length=0,Q=a._tr_tally(y,0,y.window[y.strstart]),y.lookahead--,y.strstart++,Q&&(Ye(y,!1),y.strm.avail_out===0))return $e}return y.insert=0,Y===d?(Ye(y,!0),y.strm.avail_out===0?dt:rr):y.last_lit&&(Ye(y,!1),y.strm.avail_out===0)?$e:bt}function Tt(y,Y,Q,D,F){this.good_length=y,this.max_lazy=Y,this.nice_length=Q,this.max_chain=D,this.func=F}var ir;ir=[new Tt(0,0,0,0,In),new Tt(4,4,8,4,qr),new Tt(4,5,16,8,qr),new Tt(4,6,32,32,qr),new Tt(4,4,16,16,nr),new Tt(8,16,32,32,nr),new Tt(8,16,128,128,nr),new Tt(8,32,128,256,nr),new Tt(32,128,258,1024,nr),new Tt(32,258,258,4096,nr)];function Jn(y){y.window_size=2*y.w_size,Ut(y.head),y.max_lazy_match=ir[y.level].max_lazy,y.good_match=ir[y.level].good_length,y.nice_match=ir[y.level].nice_length,y.max_chain_length=ir[y.level].max_chain,y.strstart=0,y.block_start=0,y.lookahead=0,y.insert=0,y.match_length=y.prev_length=re-1,y.match_available=0,y.ins_h=0}function I(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=V,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new s.Buf16(Z*2),this.dyn_dtree=new s.Buf16((2*N+1)*2),this.bl_tree=new s.Buf16((2*U+1)*2),Ut(this.dyn_ltree),Ut(this.dyn_dtree),Ut(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new s.Buf16(oe+1),this.heap=new s.Buf16(2*X+1),Ut(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new s.Buf16(2*X+1),Ut(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ie(y){var Y;return!y||!y.state?xt(y,g):(y.total_in=y.total_out=0,y.data_type=L,Y=y.state,Y.pending=0,Y.pending_out=0,Y.wrap<0&&(Y.wrap=-Y.wrap),Y.status=Y.wrap?Le:Ge,y.adler=Y.wrap===2?0:1,Y.last_flush=c,a._tr_init(Y),x)}function ue(y){var Y=ie(y);return Y===x&&Jn(y.state),Y}function ve(y,Y){return!y||!y.state||y.state.wrap!==2?g:(y.state.gzhead=Y,x)}function M(y,Y,Q,D,F,K){if(!y)return g;var Se=1;if(Y===S&&(Y=6),D<0?(Se=0,D=-D):D>15&&(Se=2,D-=16),F<1||F>$||Q!==V||D<8||D>15||Y<0||Y>9||K<0||K>C)return xt(y,g);D===8&&(D=9);var ge=new I;return y.state=ge,ge.strm=y,ge.wrap=Se,ge.gzhead=null,ge.w_bits=D,ge.w_size=1<<ge.w_bits,ge.w_mask=ge.w_size-1,ge.hash_bits=F+7,ge.hash_size=1<<ge.hash_bits,ge.hash_mask=ge.hash_size-1,ge.hash_shift=~~((ge.hash_bits+re-1)/re),ge.window=new s.Buf8(ge.w_size*2),ge.head=new s.Buf16(ge.hash_size),ge.prev=new s.Buf16(ge.w_size),ge.lit_bufsize=1<<F+6,ge.pending_buf_size=ge.lit_bufsize*4,ge.pending_buf=new s.Buf8(ge.pending_buf_size),ge.d_buf=1*ge.lit_bufsize,ge.l_buf=(1+2)*ge.lit_bufsize,ge.level=Y,ge.strategy=K,ge.method=Q,ue(y)}function ee(y,Y){return M(y,Y,V,ne,me,O)}function b(y,Y){var Q,D,F,K;if(!y||!y.state||Y>m||Y<0)return y?xt(y,g):g;if(D=y.state,!y.output||!y.input&&y.avail_in!==0||D.status===rt&&Y!==d)return xt(y,y.avail_out===0?E:g);if(D.strm=y,Q=D.last_flush,D.last_flush=Y,D.status===Le)if(D.wrap===2)y.adler=0,ke(D,31),ke(D,139),ke(D,8),D.gzhead?(ke(D,(D.gzhead.text?1:0)+(D.gzhead.hcrc?2:0)+(D.gzhead.extra?4:0)+(D.gzhead.name?8:0)+(D.gzhead.comment?16:0)),ke(D,D.gzhead.time&255),ke(D,D.gzhead.time>>8&255),ke(D,D.gzhead.time>>16&255),ke(D,D.gzhead.time>>24&255),ke(D,D.level===9?2:D.strategy>=w||D.level<2?4:0),ke(D,D.gzhead.os&255),D.gzhead.extra&&D.gzhead.extra.length&&(ke(D,D.gzhead.extra.length&255),ke(D,D.gzhead.extra.length>>8&255)),D.gzhead.hcrc&&(y.adler=l(y.adler,D.pending_buf,D.pending,0)),D.gzindex=0,D.status=Oe):(ke(D,0),ke(D,0),ke(D,0),ke(D,0),ke(D,0),ke(D,D.level===9?2:D.strategy>=w||D.level<2?4:0),ke(D,Ve),D.status=Ge);else{var Se=V+(D.w_bits-8<<4)<<8,ge=-1;D.strategy>=w||D.level<2?ge=0:D.level<6?ge=1:D.level===6?ge=2:ge=3,Se|=ge<<6,D.strstart!==0&&(Se|=Ie),Se+=31-Se%31,D.status=Ge,qt(D,Se),D.strstart!==0&&(qt(D,y.adler>>>16),qt(D,y.adler&65535)),y.adler=1}if(D.status===Oe)if(D.gzhead.extra){for(F=D.pending;D.gzindex<(D.gzhead.extra.length&65535)&&!(D.pending===D.pending_buf_size&&(D.gzhead.hcrc&&D.pending>F&&(y.adler=l(y.adler,D.pending_buf,D.pending-F,F)),kt(y),F=D.pending,D.pending===D.pending_buf_size));)ke(D,D.gzhead.extra[D.gzindex]&255),D.gzindex++;D.gzhead.hcrc&&D.pending>F&&(y.adler=l(y.adler,D.pending_buf,D.pending-F,F)),D.gzindex===D.gzhead.extra.length&&(D.gzindex=0,D.status=Re)}else D.status=Re;if(D.status===Re)if(D.gzhead.name){F=D.pending;do{if(D.pending===D.pending_buf_size&&(D.gzhead.hcrc&&D.pending>F&&(y.adler=l(y.adler,D.pending_buf,D.pending-F,F)),kt(y),F=D.pending,D.pending===D.pending_buf_size)){K=1;break}D.gzindex<D.gzhead.name.length?K=D.gzhead.name.charCodeAt(D.gzindex++)&255:K=0,ke(D,K)}while(K!==0);D.gzhead.hcrc&&D.pending>F&&(y.adler=l(y.adler,D.pending_buf,D.pending-F,F)),K===0&&(D.gzindex=0,D.status=ht)}else D.status=ht;if(D.status===ht)if(D.gzhead.comment){F=D.pending;do{if(D.pending===D.pending_buf_size&&(D.gzhead.hcrc&&D.pending>F&&(y.adler=l(y.adler,D.pending_buf,D.pending-F,F)),kt(y),F=D.pending,D.pending===D.pending_buf_size)){K=1;break}D.gzindex<D.gzhead.comment.length?K=D.gzhead.comment.charCodeAt(D.gzindex++)&255:K=0,ke(D,K)}while(K!==0);D.gzhead.hcrc&&D.pending>F&&(y.adler=l(y.adler,D.pending_buf,D.pending-F,F)),K===0&&(D.status=tt)}else D.status=tt;if(D.status===tt&&(D.gzhead.hcrc?(D.pending+2>D.pending_buf_size&&kt(y),D.pending+2<=D.pending_buf_size&&(ke(D,y.adler&255),ke(D,y.adler>>8&255),y.adler=0,D.status=Ge)):D.status=Ge),D.pending!==0){if(kt(y),y.avail_out===0)return D.last_flush=-1,x}else if(y.avail_in===0&&jr(Y)<=jr(Q)&&Y!==d)return xt(y,E);if(D.status===rt&&y.avail_in!==0)return xt(y,E);if(y.avail_in!==0||D.lookahead!==0||Y!==c&&D.status!==rt){var ye=D.strategy===w?Yr(D,Y):D.strategy===_?kn(D,Y):ir[D.level].func(D,Y);if((ye===dt||ye===rr)&&(D.status=rt),ye===$e||ye===dt)return y.avail_out===0&&(D.last_flush=-1),x;if(ye===bt&&(Y===f?a._tr_align(D):Y!==m&&(a._tr_stored_block(D,0,0,!1),Y===h&&(Ut(D.head),D.lookahead===0&&(D.strstart=0,D.block_start=0,D.insert=0))),kt(y),y.avail_out===0))return D.last_flush=-1,x}return Y!==d?x:D.wrap<=0?p:(D.wrap===2?(ke(D,y.adler&255),ke(D,y.adler>>8&255),ke(D,y.adler>>16&255),ke(D,y.adler>>24&255),ke(D,y.total_in&255),ke(D,y.total_in>>8&255),ke(D,y.total_in>>16&255),ke(D,y.total_in>>24&255)):(qt(D,y.adler>>>16),qt(D,y.adler&65535)),kt(y),D.wrap>0&&(D.wrap=-D.wrap),D.pending!==0?x:p)}function ae(y){var Y;return!y||!y.state?g:(Y=y.state.status,Y!==Le&&Y!==Oe&&Y!==Re&&Y!==ht&&Y!==tt&&Y!==Ge&&Y!==rt?xt(y,g):(y.state=null,Y===Ge?xt(y,v):x))}function Ae(y,Y){var Q=Y.length,D,F,K,Se,ge,ye,Pe,Xr;if(!y||!y.state||(D=y.state,Se=D.wrap,Se===2||Se===1&&D.status!==Le||D.lookahead))return g;for(Se===1&&(y.adler=o(y.adler,Y,Q,0)),D.wrap=0,Q>=D.w_size&&(Se===0&&(Ut(D.head),D.strstart=0,D.block_start=0,D.insert=0),Xr=new s.Buf8(D.w_size),s.arraySet(Xr,Y,Q-D.w_size,D.w_size,0),Y=Xr,Q=D.w_size),ge=y.avail_in,ye=y.next_in,Pe=y.input,y.avail_in=Q,y.next_in=0,y.input=Y,Yt(D);D.lookahead>=re;){F=D.strstart,K=D.lookahead-(re-1);do D.ins_h=(D.ins_h<<D.hash_shift^D.window[F+re-1])&D.hash_mask,D.prev[F&D.w_mask]=D.head[D.ins_h],D.head[D.ins_h]=F,F++;while(--K);D.strstart=F,D.lookahead=re-1,Yt(D)}return D.strstart+=D.lookahead,D.block_start=D.strstart,D.insert=D.lookahead,D.lookahead=0,D.match_length=D.prev_length=re-1,D.match_available=0,y.next_in=ye,y.input=Pe,y.avail_in=ge,D.wrap=Se,x}i.deflateInit=ee,i.deflateInit2=M,i.deflateReset=ue,i.deflateResetKeep=ie,i.deflateSetHeader=ve,i.deflate=b,i.deflateEnd=ae,i.deflateSetDictionary=Ae,i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,n,i){function s(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}n.exports=s},{}],48:[function(t,n,i){var s=30,a=12;n.exports=function(l,u){var c,f,h,d,m,x,p,g,v,E,S,T,w,_,C,O,L,V,$,ne,me,H,j,X,N;c=l.state,f=l.next_in,X=l.input,h=f+(l.avail_in-5),d=l.next_out,N=l.output,m=d-(u-l.avail_out),x=d+(l.avail_out-257),p=c.dmax,g=c.wsize,v=c.whave,E=c.wnext,S=c.window,T=c.hold,w=c.bits,_=c.lencode,C=c.distcode,O=(1<<c.lenbits)-1,L=(1<<c.distbits)-1;e:do{w<15&&(T+=X[f++]<<w,w+=8,T+=X[f++]<<w,w+=8),V=_[T&O];t:for(;;){if($=V>>>24,T>>>=$,w-=$,$=V>>>16&255,$===0)N[d++]=V&65535;else if($&16){ne=V&65535,$&=15,$&&(w<$&&(T+=X[f++]<<w,w+=8),ne+=T&(1<<$)-1,T>>>=$,w-=$),w<15&&(T+=X[f++]<<w,w+=8,T+=X[f++]<<w,w+=8),V=C[T&L];r:for(;;){if($=V>>>24,T>>>=$,w-=$,$=V>>>16&255,$&16){if(me=V&65535,$&=15,w<$&&(T+=X[f++]<<w,w+=8,w<$&&(T+=X[f++]<<w,w+=8)),me+=T&(1<<$)-1,me>p){l.msg="invalid distance too far back",c.mode=s;break e}if(T>>>=$,w-=$,$=d-m,me>$){if($=me-$,$>v&&c.sane){l.msg="invalid distance too far back",c.mode=s;break e}if(H=0,j=S,E===0){if(H+=g-$,$<ne){ne-=$;do N[d++]=S[H++];while(--$);H=d-me,j=N}}else if(E<$){if(H+=g+E-$,$-=E,$<ne){ne-=$;do N[d++]=S[H++];while(--$);if(H=0,E<ne){$=E,ne-=$;do N[d++]=S[H++];while(--$);H=d-me,j=N}}}else if(H+=E-$,$<ne){ne-=$;do N[d++]=S[H++];while(--$);H=d-me,j=N}for(;ne>2;)N[d++]=j[H++],N[d++]=j[H++],N[d++]=j[H++],ne-=3;ne&&(N[d++]=j[H++],ne>1&&(N[d++]=j[H++]))}else{H=d-me;do N[d++]=N[H++],N[d++]=N[H++],N[d++]=N[H++],ne-=3;while(ne>2);ne&&(N[d++]=N[H++],ne>1&&(N[d++]=N[H++]))}}else if(($&64)===0){V=C[(V&65535)+(T&(1<<$)-1)];continue r}else{l.msg="invalid distance code",c.mode=s;break e}break}}else if(($&64)===0){V=_[(V&65535)+(T&(1<<$)-1)];continue t}else if($&32){c.mode=a;break e}else{l.msg="invalid literal/length code",c.mode=s;break e}break}}while(f<h&&d<x);ne=w>>3,f-=ne,w-=ne<<3,T&=(1<<w)-1,l.next_in=f,l.next_out=d,l.avail_in=f<h?5+(h-f):5-(f-h),l.avail_out=d<x?257+(x-d):257-(d-x),c.hold=T,c.bits=w}},{}],49:[function(t,n,i){var s=t("../utils/common"),a=t("./adler32"),o=t("./crc32"),l=t("./inffast"),u=t("./inftrees"),c=0,f=1,h=2,d=4,m=5,x=6,p=0,g=1,v=2,E=-2,S=-3,T=-4,w=-5,_=8,C=1,O=2,L=3,V=4,$=5,ne=6,me=7,H=8,j=9,X=10,N=11,U=12,Z=13,oe=14,re=15,pe=16,Te=17,Ie=18,Le=19,Oe=20,Re=21,ht=22,tt=23,Ge=24,rt=25,$e=26,bt=27,dt=28,rr=29,Ve=30,xt=31,jr=32,Ut=852,kt=592,Ye=15,ke=Ye;function qt(M){return(M>>>24&255)+(M>>>8&65280)+((M&65280)<<8)+((M&255)<<24)}function Ln(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function Kr(M){var ee;return!M||!M.state?E:(ee=M.state,M.total_in=M.total_out=ee.total=0,M.msg="",ee.wrap&&(M.adler=ee.wrap&1),ee.mode=C,ee.last=0,ee.havedict=0,ee.dmax=32768,ee.head=null,ee.hold=0,ee.bits=0,ee.lencode=ee.lendyn=new s.Buf32(Ut),ee.distcode=ee.distdyn=new s.Buf32(kt),ee.sane=1,ee.back=-1,p)}function Yt(M){var ee;return!M||!M.state?E:(ee=M.state,ee.wsize=0,ee.whave=0,ee.wnext=0,Kr(M))}function In(M,ee){var b,ae;return!M||!M.state||(ae=M.state,ee<0?(b=0,ee=-ee):(b=(ee>>4)+1,ee<48&&(ee&=15)),ee&&(ee<8||ee>15))?E:(ae.window!==null&&ae.wbits!==ee&&(ae.window=null),ae.wrap=b,ae.wbits=ee,Yt(M))}function qr(M,ee){var b,ae;return M?(ae=new Ln,M.state=ae,ae.window=null,b=In(M,ee),b!==p&&(M.state=null),b):E}function nr(M){return qr(M,ke)}var kn=!0,Yr,Tt;function ir(M){if(kn){var ee;for(Yr=new s.Buf32(512),Tt=new s.Buf32(32),ee=0;ee<144;)M.lens[ee++]=8;for(;ee<256;)M.lens[ee++]=9;for(;ee<280;)M.lens[ee++]=7;for(;ee<288;)M.lens[ee++]=8;for(u(f,M.lens,0,288,Yr,0,M.work,{bits:9}),ee=0;ee<32;)M.lens[ee++]=5;u(h,M.lens,0,32,Tt,0,M.work,{bits:5}),kn=!1}M.lencode=Yr,M.lenbits=9,M.distcode=Tt,M.distbits=5}function Jn(M,ee,b,ae){var Ae,y=M.state;return y.window===null&&(y.wsize=1<<y.wbits,y.wnext=0,y.whave=0,y.window=new s.Buf8(y.wsize)),ae>=y.wsize?(s.arraySet(y.window,ee,b-y.wsize,y.wsize,0),y.wnext=0,y.whave=y.wsize):(Ae=y.wsize-y.wnext,Ae>ae&&(Ae=ae),s.arraySet(y.window,ee,b-ae,Ae,y.wnext),ae-=Ae,ae?(s.arraySet(y.window,ee,b-ae,ae,0),y.wnext=ae,y.whave=y.wsize):(y.wnext+=Ae,y.wnext===y.wsize&&(y.wnext=0),y.whave<y.wsize&&(y.whave+=Ae))),0}function I(M,ee){var b,ae,Ae,y,Y,Q,D,F,K,Se,ge,ye,Pe,Xr,nt=0,Me,pt,Dt,$t,as,os,ct,sr,St=new s.Buf8(4),Zr,Lr,Po=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!M||!M.state||!M.output||!M.input&&M.avail_in!==0)return E;b=M.state,b.mode===U&&(b.mode=Z),Y=M.next_out,Ae=M.output,D=M.avail_out,y=M.next_in,ae=M.input,Q=M.avail_in,F=b.hold,K=b.bits,Se=Q,ge=D,sr=p;e:for(;;)switch(b.mode){case C:if(b.wrap===0){b.mode=Z;break}for(;K<16;){if(Q===0)break e;Q--,F+=ae[y++]<<K,K+=8}if(b.wrap&2&&F===35615){b.check=0,St[0]=F&255,St[1]=F>>>8&255,b.check=o(b.check,St,2,0),F=0,K=0,b.mode=O;break}if(b.flags=0,b.head&&(b.head.done=!1),!(b.wrap&1)||(((F&255)<<8)+(F>>8))%31){M.msg="incorrect header check",b.mode=Ve;break}if((F&15)!==_){M.msg="unknown compression method",b.mode=Ve;break}if(F>>>=4,K-=4,ct=(F&15)+8,b.wbits===0)b.wbits=ct;else if(ct>b.wbits){M.msg="invalid window size",b.mode=Ve;break}b.dmax=1<<ct,M.adler=b.check=1,b.mode=F&512?X:U,F=0,K=0;break;case O:for(;K<16;){if(Q===0)break e;Q--,F+=ae[y++]<<K,K+=8}if(b.flags=F,(b.flags&255)!==_){M.msg="unknown compression method",b.mode=Ve;break}if(b.flags&57344){M.msg="unknown header flags set",b.mode=Ve;break}b.head&&(b.head.text=F>>8&1),b.flags&512&&(St[0]=F&255,St[1]=F>>>8&255,b.check=o(b.check,St,2,0)),F=0,K=0,b.mode=L;case L:for(;K<32;){if(Q===0)break e;Q--,F+=ae[y++]<<K,K+=8}b.head&&(b.head.time=F),b.flags&512&&(St[0]=F&255,St[1]=F>>>8&255,St[2]=F>>>16&255,St[3]=F>>>24&255,b.check=o(b.check,St,4,0)),F=0,K=0,b.mode=V;case V:for(;K<16;){if(Q===0)break e;Q--,F+=ae[y++]<<K,K+=8}b.head&&(b.head.xflags=F&255,b.head.os=F>>8),b.flags&512&&(St[0]=F&255,St[1]=F>>>8&255,b.check=o(b.check,St,2,0)),F=0,K=0,b.mode=$;case $:if(b.flags&1024){for(;K<16;){if(Q===0)break e;Q--,F+=ae[y++]<<K,K+=8}b.length=F,b.head&&(b.head.extra_len=F),b.flags&512&&(St[0]=F&255,St[1]=F>>>8&255,b.check=o(b.check,St,2,0)),F=0,K=0}else b.head&&(b.head.extra=null);b.mode=ne;case ne:if(b.flags&1024&&(ye=b.length,ye>Q&&(ye=Q),ye&&(b.head&&(ct=b.head.extra_len-b.length,b.head.extra||(b.head.extra=new Array(b.head.extra_len)),s.arraySet(b.head.extra,ae,y,ye,ct)),b.flags&512&&(b.check=o(b.check,ae,ye,y)),Q-=ye,y+=ye,b.length-=ye),b.length))break e;b.length=0,b.mode=me;case me:if(b.flags&2048){if(Q===0)break e;ye=0;do ct=ae[y+ye++],b.head&&ct&&b.length<65536&&(b.head.name+=String.fromCharCode(ct));while(ct&&ye<Q);if(b.flags&512&&(b.check=o(b.check,ae,ye,y)),Q-=ye,y+=ye,ct)break e}else b.head&&(b.head.name=null);b.length=0,b.mode=H;case H:if(b.flags&4096){if(Q===0)break e;ye=0;do ct=ae[y+ye++],b.head&&ct&&b.length<65536&&(b.head.comment+=String.fromCharCode(ct));while(ct&&ye<Q);if(b.flags&512&&(b.check=o(b.check,ae,ye,y)),Q-=ye,y+=ye,ct)break e}else b.head&&(b.head.comment=null);b.mode=j;case j:if(b.flags&512){for(;K<16;){if(Q===0)break e;Q--,F+=ae[y++]<<K,K+=8}if(F!==(b.check&65535)){M.msg="header crc mismatch",b.mode=Ve;break}F=0,K=0}b.head&&(b.head.hcrc=b.flags>>9&1,b.head.done=!0),M.adler=b.check=0,b.mode=U;break;case X:for(;K<32;){if(Q===0)break e;Q--,F+=ae[y++]<<K,K+=8}M.adler=b.check=qt(F),F=0,K=0,b.mode=N;case N:if(b.havedict===0)return M.next_out=Y,M.avail_out=D,M.next_in=y,M.avail_in=Q,b.hold=F,b.bits=K,v;M.adler=b.check=1,b.mode=U;case U:if(ee===m||ee===x)break e;case Z:if(b.last){F>>>=K&7,K-=K&7,b.mode=bt;break}for(;K<3;){if(Q===0)break e;Q--,F+=ae[y++]<<K,K+=8}switch(b.last=F&1,F>>>=1,K-=1,F&3){case 0:b.mode=oe;break;case 1:if(ir(b),b.mode=Oe,ee===x){F>>>=2,K-=2;break e}break;case 2:b.mode=Te;break;case 3:M.msg="invalid block type",b.mode=Ve}F>>>=2,K-=2;break;case oe:for(F>>>=K&7,K-=K&7;K<32;){if(Q===0)break e;Q--,F+=ae[y++]<<K,K+=8}if((F&65535)!==(F>>>16^65535)){M.msg="invalid stored block lengths",b.mode=Ve;break}if(b.length=F&65535,F=0,K=0,b.mode=re,ee===x)break e;case re:b.mode=pe;case pe:if(ye=b.length,ye){if(ye>Q&&(ye=Q),ye>D&&(ye=D),ye===0)break e;s.arraySet(Ae,ae,y,ye,Y),Q-=ye,y+=ye,D-=ye,Y+=ye,b.length-=ye;break}b.mode=U;break;case Te:for(;K<14;){if(Q===0)break e;Q--,F+=ae[y++]<<K,K+=8}if(b.nlen=(F&31)+257,F>>>=5,K-=5,b.ndist=(F&31)+1,F>>>=5,K-=5,b.ncode=(F&15)+4,F>>>=4,K-=4,b.nlen>286||b.ndist>30){M.msg="too many length or distance symbols",b.mode=Ve;break}b.have=0,b.mode=Ie;case Ie:for(;b.have<b.ncode;){for(;K<3;){if(Q===0)break e;Q--,F+=ae[y++]<<K,K+=8}b.lens[Po[b.have++]]=F&7,F>>>=3,K-=3}for(;b.have<19;)b.lens[Po[b.have++]]=0;if(b.lencode=b.lendyn,b.lenbits=7,Zr={bits:b.lenbits},sr=u(c,b.lens,0,19,b.lencode,0,b.work,Zr),b.lenbits=Zr.bits,sr){M.msg="invalid code lengths set",b.mode=Ve;break}b.have=0,b.mode=Le;case Le:for(;b.have<b.nlen+b.ndist;){for(;nt=b.lencode[F&(1<<b.lenbits)-1],Me=nt>>>24,pt=nt>>>16&255,Dt=nt&65535,!(Me<=K);){if(Q===0)break e;Q--,F+=ae[y++]<<K,K+=8}if(Dt<16)F>>>=Me,K-=Me,b.lens[b.have++]=Dt;else{if(Dt===16){for(Lr=Me+2;K<Lr;){if(Q===0)break e;Q--,F+=ae[y++]<<K,K+=8}if(F>>>=Me,K-=Me,b.have===0){M.msg="invalid bit length repeat",b.mode=Ve;break}ct=b.lens[b.have-1],ye=3+(F&3),F>>>=2,K-=2}else if(Dt===17){for(Lr=Me+3;K<Lr;){if(Q===0)break e;Q--,F+=ae[y++]<<K,K+=8}F>>>=Me,K-=Me,ct=0,ye=3+(F&7),F>>>=3,K-=3}else{for(Lr=Me+7;K<Lr;){if(Q===0)break e;Q--,F+=ae[y++]<<K,K+=8}F>>>=Me,K-=Me,ct=0,ye=11+(F&127),F>>>=7,K-=7}if(b.have+ye>b.nlen+b.ndist){M.msg="invalid bit length repeat",b.mode=Ve;break}for(;ye--;)b.lens[b.have++]=ct}}if(b.mode===Ve)break;if(b.lens[256]===0){M.msg="invalid code -- missing end-of-block",b.mode=Ve;break}if(b.lenbits=9,Zr={bits:b.lenbits},sr=u(f,b.lens,0,b.nlen,b.lencode,0,b.work,Zr),b.lenbits=Zr.bits,sr){M.msg="invalid literal/lengths set",b.mode=Ve;break}if(b.distbits=6,b.distcode=b.distdyn,Zr={bits:b.distbits},sr=u(h,b.lens,b.nlen,b.ndist,b.distcode,0,b.work,Zr),b.distbits=Zr.bits,sr){M.msg="invalid distances set",b.mode=Ve;break}if(b.mode=Oe,ee===x)break e;case Oe:b.mode=Re;case Re:if(Q>=6&&D>=258){M.next_out=Y,M.avail_out=D,M.next_in=y,M.avail_in=Q,b.hold=F,b.bits=K,l(M,ge),Y=M.next_out,Ae=M.output,D=M.avail_out,y=M.next_in,ae=M.input,Q=M.avail_in,F=b.hold,K=b.bits,b.mode===U&&(b.back=-1);break}for(b.back=0;nt=b.lencode[F&(1<<b.lenbits)-1],Me=nt>>>24,pt=nt>>>16&255,Dt=nt&65535,!(Me<=K);){if(Q===0)break e;Q--,F+=ae[y++]<<K,K+=8}if(pt&&(pt&240)===0){for($t=Me,as=pt,os=Dt;nt=b.lencode[os+((F&(1<<$t+as)-1)>>$t)],Me=nt>>>24,pt=nt>>>16&255,Dt=nt&65535,!($t+Me<=K);){if(Q===0)break e;Q--,F+=ae[y++]<<K,K+=8}F>>>=$t,K-=$t,b.back+=$t}if(F>>>=Me,K-=Me,b.back+=Me,b.length=Dt,pt===0){b.mode=$e;break}if(pt&32){b.back=-1,b.mode=U;break}if(pt&64){M.msg="invalid literal/length code",b.mode=Ve;break}b.extra=pt&15,b.mode=ht;case ht:if(b.extra){for(Lr=b.extra;K<Lr;){if(Q===0)break e;Q--,F+=ae[y++]<<K,K+=8}b.length+=F&(1<<b.extra)-1,F>>>=b.extra,K-=b.extra,b.back+=b.extra}b.was=b.length,b.mode=tt;case tt:for(;nt=b.distcode[F&(1<<b.distbits)-1],Me=nt>>>24,pt=nt>>>16&255,Dt=nt&65535,!(Me<=K);){if(Q===0)break e;Q--,F+=ae[y++]<<K,K+=8}if((pt&240)===0){for($t=Me,as=pt,os=Dt;nt=b.distcode[os+((F&(1<<$t+as)-1)>>$t)],Me=nt>>>24,pt=nt>>>16&255,Dt=nt&65535,!($t+Me<=K);){if(Q===0)break e;Q--,F+=ae[y++]<<K,K+=8}F>>>=$t,K-=$t,b.back+=$t}if(F>>>=Me,K-=Me,b.back+=Me,pt&64){M.msg="invalid distance code",b.mode=Ve;break}b.offset=Dt,b.extra=pt&15,b.mode=Ge;case Ge:if(b.extra){for(Lr=b.extra;K<Lr;){if(Q===0)break e;Q--,F+=ae[y++]<<K,K+=8}b.offset+=F&(1<<b.extra)-1,F>>>=b.extra,K-=b.extra,b.back+=b.extra}if(b.offset>b.dmax){M.msg="invalid distance too far back",b.mode=Ve;break}b.mode=rt;case rt:if(D===0)break e;if(ye=ge-D,b.offset>ye){if(ye=b.offset-ye,ye>b.whave&&b.sane){M.msg="invalid distance too far back",b.mode=Ve;break}ye>b.wnext?(ye-=b.wnext,Pe=b.wsize-ye):Pe=b.wnext-ye,ye>b.length&&(ye=b.length),Xr=b.window}else Xr=Ae,Pe=Y-b.offset,ye=b.length;ye>D&&(ye=D),D-=ye,b.length-=ye;do Ae[Y++]=Xr[Pe++];while(--ye);b.length===0&&(b.mode=Re);break;case $e:if(D===0)break e;Ae[Y++]=b.length,D--,b.mode=Re;break;case bt:if(b.wrap){for(;K<32;){if(Q===0)break e;Q--,F|=ae[y++]<<K,K+=8}if(ge-=D,M.total_out+=ge,b.total+=ge,ge&&(M.adler=b.check=b.flags?o(b.check,Ae,ge,Y-ge):a(b.check,Ae,ge,Y-ge)),ge=D,(b.flags?F:qt(F))!==b.check){M.msg="incorrect data check",b.mode=Ve;break}F=0,K=0}b.mode=dt;case dt:if(b.wrap&&b.flags){for(;K<32;){if(Q===0)break e;Q--,F+=ae[y++]<<K,K+=8}if(F!==(b.total&4294967295)){M.msg="incorrect length check",b.mode=Ve;break}F=0,K=0}b.mode=rr;case rr:sr=g;break e;case Ve:sr=S;break e;case xt:return T;case jr:default:return E}return M.next_out=Y,M.avail_out=D,M.next_in=y,M.avail_in=Q,b.hold=F,b.bits=K,(b.wsize||ge!==M.avail_out&&b.mode<Ve&&(b.mode<bt||ee!==d))&&Jn(M,M.output,M.next_out,ge-M.avail_out),Se-=M.avail_in,ge-=M.avail_out,M.total_in+=Se,M.total_out+=ge,b.total+=ge,b.wrap&&ge&&(M.adler=b.check=b.flags?o(b.check,Ae,ge,M.next_out-ge):a(b.check,Ae,ge,M.next_out-ge)),M.data_type=b.bits+(b.last?64:0)+(b.mode===U?128:0)+(b.mode===Oe||b.mode===re?256:0),(Se===0&&ge===0||ee===d)&&sr===p&&(sr=w),sr}function ie(M){if(!M||!M.state)return E;var ee=M.state;return ee.window&&(ee.window=null),M.state=null,p}function ue(M,ee){var b;return!M||!M.state||(b=M.state,(b.wrap&2)===0)?E:(b.head=ee,ee.done=!1,p)}function ve(M,ee){var b=ee.length,ae,Ae,y;return!M||!M.state||(ae=M.state,ae.wrap!==0&&ae.mode!==N)?E:ae.mode===N&&(Ae=1,Ae=a(Ae,ee,b,0),Ae!==ae.check)?S:(y=Jn(M,ee,b,b),y?(ae.mode=xt,T):(ae.havedict=1,p))}i.inflateReset=Yt,i.inflateReset2=In,i.inflateResetKeep=Kr,i.inflateInit=nr,i.inflateInit2=qr,i.inflate=I,i.inflateEnd=ie,i.inflateGetHeader=ue,i.inflateSetDictionary=ve,i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,n,i){var s=t("../utils/common"),a=15,o=852,l=592,u=0,c=1,f=2,h=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],d=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],m=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],x=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(g,v,E,S,T,w,_,C){var O=C.bits,L=0,V=0,$=0,ne=0,me=0,H=0,j=0,X=0,N=0,U=0,Z,oe,re,pe,Te,Ie=null,Le=0,Oe,Re=new s.Buf16(a+1),ht=new s.Buf16(a+1),tt=null,Ge=0,rt,$e,bt;for(L=0;L<=a;L++)Re[L]=0;for(V=0;V<S;V++)Re[v[E+V]]++;for(me=O,ne=a;ne>=1&&Re[ne]===0;ne--);if(me>ne&&(me=ne),ne===0)return T[w++]=1<<24|64<<16|0,T[w++]=1<<24|64<<16|0,C.bits=1,0;for($=1;$<ne&&Re[$]===0;$++);for(me<$&&(me=$),X=1,L=1;L<=a;L++)if(X<<=1,X-=Re[L],X<0)return-1;if(X>0&&(g===u||ne!==1))return-1;for(ht[1]=0,L=1;L<a;L++)ht[L+1]=ht[L]+Re[L];for(V=0;V<S;V++)v[E+V]!==0&&(_[ht[v[E+V]]++]=V);if(g===u?(Ie=tt=_,Oe=19):g===c?(Ie=h,Le-=257,tt=d,Ge-=257,Oe=256):(Ie=m,tt=x,Oe=-1),U=0,V=0,L=$,Te=w,H=me,j=0,re=-1,N=1<<me,pe=N-1,g===c&&N>o||g===f&&N>l)return 1;for(;;){rt=L-j,_[V]<Oe?($e=0,bt=_[V]):_[V]>Oe?($e=tt[Ge+_[V]],bt=Ie[Le+_[V]]):($e=32+64,bt=0),Z=1<<L-j,oe=1<<H,$=oe;do oe-=Z,T[Te+(U>>j)+oe]=rt<<24|$e<<16|bt|0;while(oe!==0);for(Z=1<<L-1;U&Z;)Z>>=1;if(Z!==0?(U&=Z-1,U+=Z):U=0,V++,--Re[L]===0){if(L===ne)break;L=v[E+_[V]]}if(L>me&&(U&pe)!==re){for(j===0&&(j=me),Te+=$,H=L-j,X=1<<H;H+j<ne&&(X-=Re[H+j],!(X<=0));)H++,X<<=1;if(N+=1<<H,g===c&&N>o||g===f&&N>l)return 1;re=U&pe,T[re]=me<<24|H<<16|Te-w|0}}return U!==0&&(T[Te+U]=L-j<<24|64<<16|0),C.bits=me,0}},{"../utils/common":41}],51:[function(t,n,i){n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,n,i){var s=t("../utils/common"),a=4,o=0,l=1,u=2;function c(I){for(var ie=I.length;--ie>=0;)I[ie]=0}var f=0,h=1,d=2,m=3,x=258,p=29,g=256,v=g+1+p,E=30,S=19,T=2*v+1,w=15,_=16,C=7,O=256,L=16,V=17,$=18,ne=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],me=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],H=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],j=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],X=512,N=new Array((v+2)*2);c(N);var U=new Array(E*2);c(U);var Z=new Array(X);c(Z);var oe=new Array(x-m+1);c(oe);var re=new Array(p);c(re);var pe=new Array(E);c(pe);function Te(I,ie,ue,ve,M){this.static_tree=I,this.extra_bits=ie,this.extra_base=ue,this.elems=ve,this.max_length=M,this.has_stree=I&&I.length}var Ie,Le,Oe;function Re(I,ie){this.dyn_tree=I,this.max_code=0,this.stat_desc=ie}function ht(I){return I<256?Z[I]:Z[256+(I>>>7)]}function tt(I,ie){I.pending_buf[I.pending++]=ie&255,I.pending_buf[I.pending++]=ie>>>8&255}function Ge(I,ie,ue){I.bi_valid>_-ue?(I.bi_buf|=ie<<I.bi_valid&65535,tt(I,I.bi_buf),I.bi_buf=ie>>_-I.bi_valid,I.bi_valid+=ue-_):(I.bi_buf|=ie<<I.bi_valid&65535,I.bi_valid+=ue)}function rt(I,ie,ue){Ge(I,ue[ie*2],ue[ie*2+1])}function $e(I,ie){var ue=0;do ue|=I&1,I>>>=1,ue<<=1;while(--ie>0);return ue>>>1}function bt(I){I.bi_valid===16?(tt(I,I.bi_buf),I.bi_buf=0,I.bi_valid=0):I.bi_valid>=8&&(I.pending_buf[I.pending++]=I.bi_buf&255,I.bi_buf>>=8,I.bi_valid-=8)}function dt(I,ie){var ue=ie.dyn_tree,ve=ie.max_code,M=ie.stat_desc.static_tree,ee=ie.stat_desc.has_stree,b=ie.stat_desc.extra_bits,ae=ie.stat_desc.extra_base,Ae=ie.stat_desc.max_length,y,Y,Q,D,F,K,Se=0;for(D=0;D<=w;D++)I.bl_count[D]=0;for(ue[I.heap[I.heap_max]*2+1]=0,y=I.heap_max+1;y<T;y++)Y=I.heap[y],D=ue[ue[Y*2+1]*2+1]+1,D>Ae&&(D=Ae,Se++),ue[Y*2+1]=D,!(Y>ve)&&(I.bl_count[D]++,F=0,Y>=ae&&(F=b[Y-ae]),K=ue[Y*2],I.opt_len+=K*(D+F),ee&&(I.static_len+=K*(M[Y*2+1]+F)));if(Se!==0){do{for(D=Ae-1;I.bl_count[D]===0;)D--;I.bl_count[D]--,I.bl_count[D+1]+=2,I.bl_count[Ae]--,Se-=2}while(Se>0);for(D=Ae;D!==0;D--)for(Y=I.bl_count[D];Y!==0;)Q=I.heap[--y],!(Q>ve)&&(ue[Q*2+1]!==D&&(I.opt_len+=(D-ue[Q*2+1])*ue[Q*2],ue[Q*2+1]=D),Y--)}}function rr(I,ie,ue){var ve=new Array(w+1),M=0,ee,b;for(ee=1;ee<=w;ee++)ve[ee]=M=M+ue[ee-1]<<1;for(b=0;b<=ie;b++){var ae=I[b*2+1];ae!==0&&(I[b*2]=$e(ve[ae]++,ae))}}function Ve(){var I,ie,ue,ve,M,ee=new Array(w+1);for(ue=0,ve=0;ve<p-1;ve++)for(re[ve]=ue,I=0;I<1<<ne[ve];I++)oe[ue++]=ve;for(oe[ue-1]=ve,M=0,ve=0;ve<16;ve++)for(pe[ve]=M,I=0;I<1<<me[ve];I++)Z[M++]=ve;for(M>>=7;ve<E;ve++)for(pe[ve]=M<<7,I=0;I<1<<me[ve]-7;I++)Z[256+M++]=ve;for(ie=0;ie<=w;ie++)ee[ie]=0;for(I=0;I<=143;)N[I*2+1]=8,I++,ee[8]++;for(;I<=255;)N[I*2+1]=9,I++,ee[9]++;for(;I<=279;)N[I*2+1]=7,I++,ee[7]++;for(;I<=287;)N[I*2+1]=8,I++,ee[8]++;for(rr(N,v+1,ee),I=0;I<E;I++)U[I*2+1]=5,U[I*2]=$e(I,5);Ie=new Te(N,ne,g+1,v,w),Le=new Te(U,me,0,E,w),Oe=new Te(new Array(0),H,0,S,C)}function xt(I){var ie;for(ie=0;ie<v;ie++)I.dyn_ltree[ie*2]=0;for(ie=0;ie<E;ie++)I.dyn_dtree[ie*2]=0;for(ie=0;ie<S;ie++)I.bl_tree[ie*2]=0;I.dyn_ltree[O*2]=1,I.opt_len=I.static_len=0,I.last_lit=I.matches=0}function jr(I){I.bi_valid>8?tt(I,I.bi_buf):I.bi_valid>0&&(I.pending_buf[I.pending++]=I.bi_buf),I.bi_buf=0,I.bi_valid=0}function Ut(I,ie,ue,ve){jr(I),ve&&(tt(I,ue),tt(I,~ue)),s.arraySet(I.pending_buf,I.window,ie,ue,I.pending),I.pending+=ue}function kt(I,ie,ue,ve){var M=ie*2,ee=ue*2;return I[M]<I[ee]||I[M]===I[ee]&&ve[ie]<=ve[ue]}function Ye(I,ie,ue){for(var ve=I.heap[ue],M=ue<<1;M<=I.heap_len&&(M<I.heap_len&&kt(ie,I.heap[M+1],I.heap[M],I.depth)&&M++,!kt(ie,ve,I.heap[M],I.depth));)I.heap[ue]=I.heap[M],ue=M,M<<=1;I.heap[ue]=ve}function ke(I,ie,ue){var ve,M,ee=0,b,ae;if(I.last_lit!==0)do ve=I.pending_buf[I.d_buf+ee*2]<<8|I.pending_buf[I.d_buf+ee*2+1],M=I.pending_buf[I.l_buf+ee],ee++,ve===0?rt(I,M,ie):(b=oe[M],rt(I,b+g+1,ie),ae=ne[b],ae!==0&&(M-=re[b],Ge(I,M,ae)),ve--,b=ht(ve),rt(I,b,ue),ae=me[b],ae!==0&&(ve-=pe[b],Ge(I,ve,ae)));while(ee<I.last_lit);rt(I,O,ie)}function qt(I,ie){var ue=ie.dyn_tree,ve=ie.stat_desc.static_tree,M=ie.stat_desc.has_stree,ee=ie.stat_desc.elems,b,ae,Ae=-1,y;for(I.heap_len=0,I.heap_max=T,b=0;b<ee;b++)ue[b*2]!==0?(I.heap[++I.heap_len]=Ae=b,I.depth[b]=0):ue[b*2+1]=0;for(;I.heap_len<2;)y=I.heap[++I.heap_len]=Ae<2?++Ae:0,ue[y*2]=1,I.depth[y]=0,I.opt_len--,M&&(I.static_len-=ve[y*2+1]);for(ie.max_code=Ae,b=I.heap_len>>1;b>=1;b--)Ye(I,ue,b);y=ee;do b=I.heap[1],I.heap[1]=I.heap[I.heap_len--],Ye(I,ue,1),ae=I.heap[1],I.heap[--I.heap_max]=b,I.heap[--I.heap_max]=ae,ue[y*2]=ue[b*2]+ue[ae*2],I.depth[y]=(I.depth[b]>=I.depth[ae]?I.depth[b]:I.depth[ae])+1,ue[b*2+1]=ue[ae*2+1]=y,I.heap[1]=y++,Ye(I,ue,1);while(I.heap_len>=2);I.heap[--I.heap_max]=I.heap[1],dt(I,ie),rr(ue,Ae,I.bl_count)}function Ln(I,ie,ue){var ve,M=-1,ee,b=ie[0*2+1],ae=0,Ae=7,y=4;for(b===0&&(Ae=138,y=3),ie[(ue+1)*2+1]=65535,ve=0;ve<=ue;ve++)ee=b,b=ie[(ve+1)*2+1],!(++ae<Ae&&ee===b)&&(ae<y?I.bl_tree[ee*2]+=ae:ee!==0?(ee!==M&&I.bl_tree[ee*2]++,I.bl_tree[L*2]++):ae<=10?I.bl_tree[V*2]++:I.bl_tree[$*2]++,ae=0,M=ee,b===0?(Ae=138,y=3):ee===b?(Ae=6,y=3):(Ae=7,y=4))}function Kr(I,ie,ue){var ve,M=-1,ee,b=ie[0*2+1],ae=0,Ae=7,y=4;for(b===0&&(Ae=138,y=3),ve=0;ve<=ue;ve++)if(ee=b,b=ie[(ve+1)*2+1],!(++ae<Ae&&ee===b)){if(ae<y)do rt(I,ee,I.bl_tree);while(--ae!==0);else ee!==0?(ee!==M&&(rt(I,ee,I.bl_tree),ae--),rt(I,L,I.bl_tree),Ge(I,ae-3,2)):ae<=10?(rt(I,V,I.bl_tree),Ge(I,ae-3,3)):(rt(I,$,I.bl_tree),Ge(I,ae-11,7));ae=0,M=ee,b===0?(Ae=138,y=3):ee===b?(Ae=6,y=3):(Ae=7,y=4)}}function Yt(I){var ie;for(Ln(I,I.dyn_ltree,I.l_desc.max_code),Ln(I,I.dyn_dtree,I.d_desc.max_code),qt(I,I.bl_desc),ie=S-1;ie>=3&&I.bl_tree[j[ie]*2+1]===0;ie--);return I.opt_len+=3*(ie+1)+5+5+4,ie}function In(I,ie,ue,ve){var M;for(Ge(I,ie-257,5),Ge(I,ue-1,5),Ge(I,ve-4,4),M=0;M<ve;M++)Ge(I,I.bl_tree[j[M]*2+1],3);Kr(I,I.dyn_ltree,ie-1),Kr(I,I.dyn_dtree,ue-1)}function qr(I){var ie=4093624447,ue;for(ue=0;ue<=31;ue++,ie>>>=1)if(ie&1&&I.dyn_ltree[ue*2]!==0)return o;if(I.dyn_ltree[9*2]!==0||I.dyn_ltree[10*2]!==0||I.dyn_ltree[13*2]!==0)return l;for(ue=32;ue<g;ue++)if(I.dyn_ltree[ue*2]!==0)return l;return o}var nr=!1;function kn(I){nr||(Ve(),nr=!0),I.l_desc=new Re(I.dyn_ltree,Ie),I.d_desc=new Re(I.dyn_dtree,Le),I.bl_desc=new Re(I.bl_tree,Oe),I.bi_buf=0,I.bi_valid=0,xt(I)}function Yr(I,ie,ue,ve){Ge(I,(f<<1)+(ve?1:0),3),Ut(I,ie,ue,!0)}function Tt(I){Ge(I,h<<1,3),rt(I,O,N),bt(I)}function ir(I,ie,ue,ve){var M,ee,b=0;I.level>0?(I.strm.data_type===u&&(I.strm.data_type=qr(I)),qt(I,I.l_desc),qt(I,I.d_desc),b=Yt(I),M=I.opt_len+3+7>>>3,ee=I.static_len+3+7>>>3,ee<=M&&(M=ee)):M=ee=ue+5,ue+4<=M&&ie!==-1?Yr(I,ie,ue,ve):I.strategy===a||ee===M?(Ge(I,(h<<1)+(ve?1:0),3),ke(I,N,U)):(Ge(I,(d<<1)+(ve?1:0),3),In(I,I.l_desc.max_code+1,I.d_desc.max_code+1,b+1),ke(I,I.dyn_ltree,I.dyn_dtree)),xt(I),ve&&jr(I)}function Jn(I,ie,ue){return I.pending_buf[I.d_buf+I.last_lit*2]=ie>>>8&255,I.pending_buf[I.d_buf+I.last_lit*2+1]=ie&255,I.pending_buf[I.l_buf+I.last_lit]=ue&255,I.last_lit++,ie===0?I.dyn_ltree[ue*2]++:(I.matches++,ie--,I.dyn_ltree[(oe[ue]+g+1)*2]++,I.dyn_dtree[ht(ie)*2]++),I.last_lit===I.lit_bufsize-1}i._tr_init=kn,i._tr_stored_block=Yr,i._tr_flush_block=ir,i._tr_tally=Jn,i._tr_align=Tt},{"../utils/common":41}],53:[function(t,n,i){function s(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}n.exports=s},{}],54:[function(t,n,i){(function(s){(function(a,o){if(a.setImmediate)return;var l=1,u={},c=!1,f=a.document,h;function d(C){typeof C!="function"&&(C=new Function(""+C));for(var O=new Array(arguments.length-1),L=0;L<O.length;L++)O[L]=arguments[L+1];var V={callback:C,args:O};return u[l]=V,h(l),l++}function m(C){delete u[C]}function x(C){var O=C.callback,L=C.args;switch(L.length){case 0:O();break;case 1:O(L[0]);break;case 2:O(L[0],L[1]);break;case 3:O(L[0],L[1],L[2]);break;default:O.apply(o,L);break}}function p(C){if(c)setTimeout(p,0,C);else{var O=u[C];if(O){c=!0;try{x(O)}finally{m(C),c=!1}}}}function g(){h=function(C){process.nextTick(function(){p(C)})}}function v(){if(a.postMessage&&!a.importScripts){var C=!0,O=a.onmessage;return a.onmessage=function(){C=!1},a.postMessage("","*"),a.onmessage=O,C}}function E(){var C="setImmediate$"+Math.random()+"$",O=function(L){L.source===a&&typeof L.data=="string"&&L.data.indexOf(C)===0&&p(+L.data.slice(C.length))};a.addEventListener?a.addEventListener("message",O,!1):a.attachEvent("onmessage",O),h=function(L){a.postMessage(C+L,"*")}}function S(){var C=new MessageChannel;C.port1.onmessage=function(O){var L=O.data;p(L)},h=function(O){C.port2.postMessage(O)}}function T(){var C=f.documentElement;h=function(O){var L=f.createElement("script");L.onreadystatechange=function(){p(O),L.onreadystatechange=null,C.removeChild(L),L=null},C.appendChild(L)}}function w(){h=function(C){setTimeout(p,0,C)}}var _=Object.getPrototypeOf&&Object.getPrototypeOf(a);_=_&&_.setTimeout?_:a,{}.toString.call(a.process)==="[object process]"?g():v()?E():a.MessageChannel?S():f&&"onreadystatechange"in f.createElement("script")?T():w(),_.setImmediate=d,_.clearImmediate=m})(typeof self>"u"?typeof s>"u"?this:s:self)}).call(this,typeof hr<"u"?hr:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(Hx);Object.defineProperty(ec,"__esModule",{value:!0});ec.default=void 0;var Ss=Ee,uL=tc(rs),fm=tc(sa),cL=tc(Cn),fL=tc(Hx.exports);function tc(r){return r&&r.__esModule?r:{default:r}}class hL{constructor(){this.zip=void 0,this.urlCache={},this.checkRequirements()}checkRequirements(){try{this.zip=new fL.default}catch{throw new Error("JSZip lib not loaded")}}open(e,t){return this.zip.loadAsync(e,{base64:t})}openUrl(e,t){return(0,uL.default)(e,"binary").then(function(n){return this.zip.loadAsync(n,{base64:t})}.bind(this))}request(e,t){var n=new Ss.defer,i,s=new cL.default(e);return t||(t=s.extension),t=="blob"?i=this.getBlob(e):i=this.getText(e),i?i.then(function(a){let o=this.handleResponse(a,t);n.resolve(o)}.bind(this)):n.reject({message:"File not found in the epub: "+e,stack:new Error().stack}),n.promise}handleResponse(e,t){var n;return t=="json"?n=JSON.parse(e):(0,Ss.isXml)(t)?n=(0,Ss.parse)(e,"text/xml"):t=="xhtml"?n=(0,Ss.parse)(e,"application/xhtml+xml"):t=="html"||t=="htm"?n=(0,Ss.parse)(e,"text/html"):n=e,n}getBlob(e,t){var n=window.decodeURIComponent(e.substr(1)),i=this.zip.file(n);if(i)return t=t||fm.default.lookup(i.name),i.async("uint8array").then(function(s){return new Blob([s],{type:t})})}getText(e,t){var n=window.decodeURIComponent(e.substr(1)),i=this.zip.file(n);if(i)return i.async("string").then(function(s){return s})}getBase64(e,t){var n=window.decodeURIComponent(e.substr(1)),i=this.zip.file(n);if(i)return t=t||fm.default.lookup(i.name),i.async("base64").then(function(s){return"data:"+t+";base64,"+s})}createUrl(e,t){var n=new Ss.defer,i=window.URL||window.webkitURL||window.mozURL,s,a,o=t&&t.base64;return e in this.urlCache?(n.resolve(this.urlCache[e]),n.promise):(o?(a=this.getBase64(e),a&&a.then(function(l){this.urlCache[e]=l,n.resolve(l)}.bind(this))):(a=this.getBlob(e),a&&a.then(function(l){s=i.createObjectURL(l),this.urlCache[e]=s,n.resolve(s)}.bind(this))),a||n.reject({message:"File not found in the epub: "+e,stack:new Error().stack}),n.promise)}revokeUrl(e){var t=window.URL||window.webkitURL||window.mozURL,n=this.urlCache[e];n&&t.revokeObjectURL(n)}destroy(){var e=window.URL||window.webkitURL||window.mozURL;for(let t in this.urlCache)e.revokeObjectURL(t);this.zip=void 0,this.urlCache={}}}var dL=hL;ec.default=dL;var rc={},jx={exports:{}};/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/(function(r,e){(function(t){r.exports=t()})(function(){return function t(n,i,s){function a(u,c){if(!i[u]){if(!n[u]){var f=typeof pi=="function"&&pi;if(!c&&f)return f(u,!0);if(o)return o(u,!0);var h=new Error("Cannot find module '"+u+"'");throw h.code="MODULE_NOT_FOUND",h}var d=i[u]={exports:{}};n[u][0].call(d.exports,function(m){var x=n[u][1][m];return a(x||m)},d,d.exports,t,n,i,s)}return i[u].exports}for(var o=typeof pi=="function"&&pi,l=0;l<s.length;l++)a(s[l]);return a}({1:[function(t,n,i){(function(s){var a=s.MutationObserver||s.WebKitMutationObserver,o;if(a){var l=0,u=new a(m),c=s.document.createTextNode("");u.observe(c,{characterData:!0}),o=function(){c.data=l=++l%2}}else if(!s.setImmediate&&typeof s.MessageChannel<"u"){var f=new s.MessageChannel;f.port1.onmessage=m,o=function(){f.port2.postMessage(0)}}else"document"in s&&"onreadystatechange"in s.document.createElement("script")?o=function(){var p=s.document.createElement("script");p.onreadystatechange=function(){m(),p.onreadystatechange=null,p.parentNode.removeChild(p),p=null},s.document.documentElement.appendChild(p)}:o=function(){setTimeout(m,0)};var h,d=[];function m(){h=!0;for(var p,g,v=d.length;v;){for(g=d,d=[],p=-1;++p<v;)g[p]();v=d.length}h=!1}n.exports=x;function x(p){d.push(p)===1&&!h&&o()}}).call(this,typeof hr<"u"?hr:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(t,n,i){var s=t(1);function a(){}var o={},l=["REJECTED"],u=["FULFILLED"],c=["PENDING"];n.exports=f;function f(T){if(typeof T!="function")throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,T!==a&&x(this,T)}f.prototype.catch=function(T){return this.then(null,T)},f.prototype.then=function(T,w){if(typeof T!="function"&&this.state===u||typeof w!="function"&&this.state===l)return this;var _=new this.constructor(a);if(this.state!==c){var C=this.state===u?T:w;d(_,C,this.outcome)}else this.queue.push(new h(_,T,w));return _};function h(T,w,_){this.promise=T,typeof w=="function"&&(this.onFulfilled=w,this.callFulfilled=this.otherCallFulfilled),typeof _=="function"&&(this.onRejected=_,this.callRejected=this.otherCallRejected)}h.prototype.callFulfilled=function(T){o.resolve(this.promise,T)},h.prototype.otherCallFulfilled=function(T){d(this.promise,this.onFulfilled,T)},h.prototype.callRejected=function(T){o.reject(this.promise,T)},h.prototype.otherCallRejected=function(T){d(this.promise,this.onRejected,T)};function d(T,w,_){s(function(){var C;try{C=w(_)}catch(O){return o.reject(T,O)}C===T?o.reject(T,new TypeError("Cannot resolve promise with itself")):o.resolve(T,C)})}o.resolve=function(T,w){var _=p(m,w);if(_.status==="error")return o.reject(T,_.value);var C=_.value;if(C)x(T,C);else{T.state=u,T.outcome=w;for(var O=-1,L=T.queue.length;++O<L;)T.queue[O].callFulfilled(w)}return T},o.reject=function(T,w){T.state=l,T.outcome=w;for(var _=-1,C=T.queue.length;++_<C;)T.queue[_].callRejected(w);return T};function m(T){var w=T&&T.then;if(T&&(typeof T=="object"||typeof T=="function")&&typeof w=="function")return function(){w.apply(T,arguments)}}function x(T,w){var _=!1;function C($){_||(_=!0,o.reject(T,$))}function O($){_||(_=!0,o.resolve(T,$))}function L(){w(O,C)}var V=p(L);V.status==="error"&&C(V.value)}function p(T,w){var _={};try{_.value=T(w),_.status="success"}catch(C){_.status="error",_.value=C}return _}f.resolve=g;function g(T){return T instanceof this?T:o.resolve(new this(a),T)}f.reject=v;function v(T){var w=new this(a);return o.reject(w,T)}f.all=E;function E(T){var w=this;if(Object.prototype.toString.call(T)!=="[object Array]")return this.reject(new TypeError("must be an array"));var _=T.length,C=!1;if(!_)return this.resolve([]);for(var O=new Array(_),L=0,V=-1,$=new this(a);++V<_;)ne(T[V],V);return $;function ne(me,H){w.resolve(me).then(j,function(X){C||(C=!0,o.reject($,X))});function j(X){O[H]=X,++L===_&&!C&&(C=!0,o.resolve($,O))}}}f.race=S;function S(T){var w=this;if(Object.prototype.toString.call(T)!=="[object Array]")return this.reject(new TypeError("must be an array"));var _=T.length,C=!1;if(!_)return this.resolve([]);for(var O=-1,L=new this(a);++O<_;)V(T[O]);return L;function V($){w.resolve($).then(function(ne){C||(C=!0,o.resolve(L,ne))},function(ne){C||(C=!0,o.reject(L,ne))})}}},{1:1}],3:[function(t,n,i){(function(s){typeof s.Promise!="function"&&(s.Promise=t(2))}).call(this,typeof hr<"u"?hr:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(t,n,i){var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R};function a(R,P){if(!(R instanceof P))throw new TypeError("Cannot call a class as a function")}function o(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var l=o();function u(){try{if(!l||!l.open)return!1;var R=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),P=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!R||P)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function c(R,P){R=R||[],P=P||{};try{return new Blob(R,P)}catch(B){if(B.name!=="TypeError")throw B;for(var k=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,z=new k,W=0;W<R.length;W+=1)z.append(R[W]);return z.getBlob(P.type)}}typeof Promise>"u"&&t(3);var f=Promise;function h(R,P){P&&R.then(function(k){P(null,k)},function(k){P(k)})}function d(R,P,k){typeof P=="function"&&R.then(P),typeof k=="function"&&R.catch(k)}function m(R){return typeof R!="string"&&(console.warn(R+" used as a key, but it is not a string."),R=String(R)),R}function x(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var p="local-forage-detect-blob-support",g=void 0,v={},E=Object.prototype.toString,S="readonly",T="readwrite";function w(R){for(var P=R.length,k=new ArrayBuffer(P),z=new Uint8Array(k),W=0;W<P;W++)z[W]=R.charCodeAt(W);return k}function _(R){return new f(function(P){var k=R.transaction(p,T),z=c([""]);k.objectStore(p).put(z,"key"),k.onabort=function(W){W.preventDefault(),W.stopPropagation(),P(!1)},k.oncomplete=function(){var W=navigator.userAgent.match(/Chrome\/(\d+)/),B=navigator.userAgent.match(/Edge\//);P(B||!W||parseInt(W[1],10)>=43)}}).catch(function(){return!1})}function C(R){return typeof g=="boolean"?f.resolve(g):_(R).then(function(P){return g=P,g})}function O(R){var P=v[R.name],k={};k.promise=new f(function(z,W){k.resolve=z,k.reject=W}),P.deferredOperations.push(k),P.dbReady?P.dbReady=P.dbReady.then(function(){return k.promise}):P.dbReady=k.promise}function L(R){var P=v[R.name],k=P.deferredOperations.pop();if(k)return k.resolve(),k.promise}function V(R,P){var k=v[R.name],z=k.deferredOperations.pop();if(z)return z.reject(P),z.promise}function $(R,P){return new f(function(k,z){if(v[R.name]=v[R.name]||re(),R.db)if(P)O(R),R.db.close();else return k(R.db);var W=[R.name];P&&W.push(R.version);var B=l.open.apply(l,W);P&&(B.onupgradeneeded=function(te){var le=B.result;try{le.createObjectStore(R.storeName),te.oldVersion<=1&&le.createObjectStore(p)}catch(fe){if(fe.name==="ConstraintError")console.warn('The database "'+R.name+'" has been upgraded from version '+te.oldVersion+" to version "+te.newVersion+', but the storage "'+R.storeName+'" already exists.');else throw fe}}),B.onerror=function(te){te.preventDefault(),z(B.error)},B.onsuccess=function(){var te=B.result;te.onversionchange=function(le){le.target.close()},k(te),L(R)}})}function ne(R){return $(R,!1)}function me(R){return $(R,!0)}function H(R,P){if(!R.db)return!0;var k=!R.db.objectStoreNames.contains(R.storeName),z=R.version<R.db.version,W=R.version>R.db.version;if(z&&(R.version!==P&&console.warn('The database "'+R.name+`" can't be downgraded from version `+R.db.version+" to version "+R.version+"."),R.version=R.db.version),W||k){if(k){var B=R.db.version+1;B>R.version&&(R.version=B)}return!0}return!1}function j(R){return new f(function(P,k){var z=new FileReader;z.onerror=k,z.onloadend=function(W){var B=btoa(W.target.result||"");P({__local_forage_encoded_blob:!0,data:B,type:R.type})},z.readAsBinaryString(R)})}function X(R){var P=w(atob(R.data));return c([P],{type:R.type})}function N(R){return R&&R.__local_forage_encoded_blob}function U(R){var P=this,k=P._initReady().then(function(){var z=v[P._dbInfo.name];if(z&&z.dbReady)return z.dbReady});return d(k,R,R),k}function Z(R){O(R);for(var P=v[R.name],k=P.forages,z=0;z<k.length;z++){var W=k[z];W._dbInfo.db&&(W._dbInfo.db.close(),W._dbInfo.db=null)}return R.db=null,ne(R).then(function(B){return R.db=B,H(R)?me(R):B}).then(function(B){R.db=P.db=B;for(var te=0;te<k.length;te++)k[te]._dbInfo.db=B}).catch(function(B){throw V(R,B),B})}function oe(R,P,k,z){z===void 0&&(z=1);try{var W=R.db.transaction(R.storeName,P);k(null,W)}catch(B){if(z>0&&(!R.db||B.name==="InvalidStateError"||B.name==="NotFoundError"))return f.resolve().then(function(){if(!R.db||B.name==="NotFoundError"&&!R.db.objectStoreNames.contains(R.storeName)&&R.version<=R.db.version)return R.db&&(R.version=R.db.version+1),me(R)}).then(function(){return Z(R).then(function(){oe(R,P,k,z-1)})}).catch(k);k(B)}}function re(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function pe(R){var P=this,k={db:null};if(R)for(var z in R)k[z]=R[z];var W=v[k.name];W||(W=re(),v[k.name]=W),W.forages.push(P),P._initReady||(P._initReady=P.ready,P.ready=U);var B=[];function te(){return f.resolve()}for(var le=0;le<W.forages.length;le++){var fe=W.forages[le];fe!==P&&B.push(fe._initReady().catch(te))}var he=W.forages.slice(0);return f.all(B).then(function(){return k.db=W.db,ne(k)}).then(function(de){return k.db=de,H(k,P._defaultConfig.version)?me(k):de}).then(function(de){k.db=W.db=de,P._dbInfo=k;for(var we=0;we<he.length;we++){var Ne=he[we];Ne!==P&&(Ne._dbInfo.db=k.db,Ne._dbInfo.version=k.version)}})}function Te(R,P){var k=this;R=m(R);var z=new f(function(W,B){k.ready().then(function(){oe(k._dbInfo,S,function(te,le){if(te)return B(te);try{var fe=le.objectStore(k._dbInfo.storeName),he=fe.get(R);he.onsuccess=function(){var de=he.result;de===void 0&&(de=null),N(de)&&(de=X(de)),W(de)},he.onerror=function(){B(he.error)}}catch(de){B(de)}})}).catch(B)});return h(z,P),z}function Ie(R,P){var k=this,z=new f(function(W,B){k.ready().then(function(){oe(k._dbInfo,S,function(te,le){if(te)return B(te);try{var fe=le.objectStore(k._dbInfo.storeName),he=fe.openCursor(),de=1;he.onsuccess=function(){var we=he.result;if(we){var Ne=we.value;N(Ne)&&(Ne=X(Ne));var We=R(Ne,we.key,de++);We!==void 0?W(We):we.continue()}else W()},he.onerror=function(){B(he.error)}}catch(we){B(we)}})}).catch(B)});return h(z,P),z}function Le(R,P,k){var z=this;R=m(R);var W=new f(function(B,te){var le;z.ready().then(function(){return le=z._dbInfo,E.call(P)==="[object Blob]"?C(le.db).then(function(fe){return fe?P:j(P)}):P}).then(function(fe){oe(z._dbInfo,T,function(he,de){if(he)return te(he);try{var we=de.objectStore(z._dbInfo.storeName);fe===null&&(fe=void 0);var Ne=we.put(fe,R);de.oncomplete=function(){fe===void 0&&(fe=null),B(fe)},de.onabort=de.onerror=function(){var We=Ne.error?Ne.error:Ne.transaction.error;te(We)}}catch(We){te(We)}})}).catch(te)});return h(W,k),W}function Oe(R,P){var k=this;R=m(R);var z=new f(function(W,B){k.ready().then(function(){oe(k._dbInfo,T,function(te,le){if(te)return B(te);try{var fe=le.objectStore(k._dbInfo.storeName),he=fe.delete(R);le.oncomplete=function(){W()},le.onerror=function(){B(he.error)},le.onabort=function(){var de=he.error?he.error:he.transaction.error;B(de)}}catch(de){B(de)}})}).catch(B)});return h(z,P),z}function Re(R){var P=this,k=new f(function(z,W){P.ready().then(function(){oe(P._dbInfo,T,function(B,te){if(B)return W(B);try{var le=te.objectStore(P._dbInfo.storeName),fe=le.clear();te.oncomplete=function(){z()},te.onabort=te.onerror=function(){var he=fe.error?fe.error:fe.transaction.error;W(he)}}catch(he){W(he)}})}).catch(W)});return h(k,R),k}function ht(R){var P=this,k=new f(function(z,W){P.ready().then(function(){oe(P._dbInfo,S,function(B,te){if(B)return W(B);try{var le=te.objectStore(P._dbInfo.storeName),fe=le.count();fe.onsuccess=function(){z(fe.result)},fe.onerror=function(){W(fe.error)}}catch(he){W(he)}})}).catch(W)});return h(k,R),k}function tt(R,P){var k=this,z=new f(function(W,B){if(R<0){W(null);return}k.ready().then(function(){oe(k._dbInfo,S,function(te,le){if(te)return B(te);try{var fe=le.objectStore(k._dbInfo.storeName),he=!1,de=fe.openKeyCursor();de.onsuccess=function(){var we=de.result;if(!we){W(null);return}R===0||he?W(we.key):(he=!0,we.advance(R))},de.onerror=function(){B(de.error)}}catch(we){B(we)}})}).catch(B)});return h(z,P),z}function Ge(R){var P=this,k=new f(function(z,W){P.ready().then(function(){oe(P._dbInfo,S,function(B,te){if(B)return W(B);try{var le=te.objectStore(P._dbInfo.storeName),fe=le.openKeyCursor(),he=[];fe.onsuccess=function(){var de=fe.result;if(!de){z(he);return}he.push(de.key),de.continue()},fe.onerror=function(){W(fe.error)}}catch(de){W(de)}})}).catch(W)});return h(k,R),k}function rt(R,P){P=x.apply(this,arguments);var k=this.config();R=typeof R!="function"&&R||{},R.name||(R.name=R.name||k.name,R.storeName=R.storeName||k.storeName);var z=this,W;if(!R.name)W=f.reject("Invalid arguments");else{var B=R.name===k.name&&z._dbInfo.db,te=B?f.resolve(z._dbInfo.db):ne(R).then(function(le){var fe=v[R.name],he=fe.forages;fe.db=le;for(var de=0;de<he.length;de++)he[de]._dbInfo.db=le;return le});R.storeName?W=te.then(function(le){if(!!le.objectStoreNames.contains(R.storeName)){var fe=le.version+1;O(R);var he=v[R.name],de=he.forages;le.close();for(var we=0;we<de.length;we++){var Ne=de[we];Ne._dbInfo.db=null,Ne._dbInfo.version=fe}var We=new f(function(He,yt){var gt=l.open(R.name,fe);gt.onerror=function(Ir){var ca=gt.result;ca.close(),yt(Ir)},gt.onupgradeneeded=function(){var Ir=gt.result;Ir.deleteObjectStore(R.storeName)},gt.onsuccess=function(){var Ir=gt.result;Ir.close(),He(Ir)}});return We.then(function(He){he.db=He;for(var yt=0;yt<de.length;yt++){var gt=de[yt];gt._dbInfo.db=He,L(gt._dbInfo)}}).catch(function(He){throw(V(R,He)||f.resolve()).catch(function(){}),He})}}):W=te.then(function(le){O(R);var fe=v[R.name],he=fe.forages;le.close();for(var de=0;de<he.length;de++){var we=he[de];we._dbInfo.db=null}var Ne=new f(function(We,He){var yt=l.deleteDatabase(R.name);yt.onerror=function(){var gt=yt.result;gt&&gt.close(),He(yt.error)},yt.onblocked=function(){console.warn('dropInstance blocked for database "'+R.name+'" until all open connections are closed')},yt.onsuccess=function(){var gt=yt.result;gt&&gt.close(),We(gt)}});return Ne.then(function(We){fe.db=We;for(var He=0;He<he.length;He++){var yt=he[He];L(yt._dbInfo)}}).catch(function(We){throw(V(R,We)||f.resolve()).catch(function(){}),We})})}return h(W,P),W}var $e={_driver:"asyncStorage",_initStorage:pe,_support:u(),iterate:Ie,getItem:Te,setItem:Le,removeItem:Oe,clear:Re,length:ht,key:tt,keys:Ge,dropInstance:rt};function bt(){return typeof openDatabase=="function"}var dt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",rr="~~local_forage_type~",Ve=/^~~local_forage_type~([^~]+)~/,xt="__lfsc__:",jr=xt.length,Ut="arbf",kt="blob",Ye="si08",ke="ui08",qt="uic8",Ln="si16",Kr="si32",Yt="ur16",In="ui32",qr="fl32",nr="fl64",kn=jr+Ut.length,Yr=Object.prototype.toString;function Tt(R){var P=R.length*.75,k=R.length,z,W=0,B,te,le,fe;R[R.length-1]==="="&&(P--,R[R.length-2]==="="&&P--);var he=new ArrayBuffer(P),de=new Uint8Array(he);for(z=0;z<k;z+=4)B=dt.indexOf(R[z]),te=dt.indexOf(R[z+1]),le=dt.indexOf(R[z+2]),fe=dt.indexOf(R[z+3]),de[W++]=B<<2|te>>4,de[W++]=(te&15)<<4|le>>2,de[W++]=(le&3)<<6|fe&63;return he}function ir(R){var P=new Uint8Array(R),k="",z;for(z=0;z<P.length;z+=3)k+=dt[P[z]>>2],k+=dt[(P[z]&3)<<4|P[z+1]>>4],k+=dt[(P[z+1]&15)<<2|P[z+2]>>6],k+=dt[P[z+2]&63];return P.length%3===2?k=k.substring(0,k.length-1)+"=":P.length%3===1&&(k=k.substring(0,k.length-2)+"=="),k}function Jn(R,P){var k="";if(R&&(k=Yr.call(R)),R&&(k==="[object ArrayBuffer]"||R.buffer&&Yr.call(R.buffer)==="[object ArrayBuffer]")){var z,W=xt;R instanceof ArrayBuffer?(z=R,W+=Ut):(z=R.buffer,k==="[object Int8Array]"?W+=Ye:k==="[object Uint8Array]"?W+=ke:k==="[object Uint8ClampedArray]"?W+=qt:k==="[object Int16Array]"?W+=Ln:k==="[object Uint16Array]"?W+=Yt:k==="[object Int32Array]"?W+=Kr:k==="[object Uint32Array]"?W+=In:k==="[object Float32Array]"?W+=qr:k==="[object Float64Array]"?W+=nr:P(new Error("Failed to get type for BinaryArray"))),P(W+ir(z))}else if(k==="[object Blob]"){var B=new FileReader;B.onload=function(){var te=rr+R.type+"~"+ir(this.result);P(xt+kt+te)},B.readAsArrayBuffer(R)}else try{P(JSON.stringify(R))}catch(te){console.error("Couldn't convert value into a JSON string: ",R),P(null,te)}}function I(R){if(R.substring(0,jr)!==xt)return JSON.parse(R);var P=R.substring(kn),k=R.substring(jr,kn),z;if(k===kt&&Ve.test(P)){var W=P.match(Ve);z=W[1],P=P.substring(W[0].length)}var B=Tt(P);switch(k){case Ut:return B;case kt:return c([B],{type:z});case Ye:return new Int8Array(B);case ke:return new Uint8Array(B);case qt:return new Uint8ClampedArray(B);case Ln:return new Int16Array(B);case Yt:return new Uint16Array(B);case Kr:return new Int32Array(B);case In:return new Uint32Array(B);case qr:return new Float32Array(B);case nr:return new Float64Array(B);default:throw new Error("Unkown type: "+k)}}var ie={serialize:Jn,deserialize:I,stringToBuffer:Tt,bufferToString:ir};function ue(R,P,k,z){R.executeSql("CREATE TABLE IF NOT EXISTS "+P.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],k,z)}function ve(R){var P=this,k={db:null};if(R)for(var z in R)k[z]=typeof R[z]!="string"?R[z].toString():R[z];var W=new f(function(B,te){try{k.db=openDatabase(k.name,String(k.version),k.description,k.size)}catch(le){return te(le)}k.db.transaction(function(le){ue(le,k,function(){P._dbInfo=k,B()},function(fe,he){te(he)})},te)});return k.serializer=ie,W}function M(R,P,k,z,W,B){R.executeSql(k,z,W,function(te,le){le.code===le.SYNTAX_ERR?te.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[P.storeName],function(fe,he){he.rows.length?B(fe,le):ue(fe,P,function(){fe.executeSql(k,z,W,B)},B)},B):B(te,le)},B)}function ee(R,P){var k=this;R=m(R);var z=new f(function(W,B){k.ready().then(function(){var te=k._dbInfo;te.db.transaction(function(le){M(le,te,"SELECT * FROM "+te.storeName+" WHERE key = ? LIMIT 1",[R],function(fe,he){var de=he.rows.length?he.rows.item(0).value:null;de&&(de=te.serializer.deserialize(de)),W(de)},function(fe,he){B(he)})})}).catch(B)});return h(z,P),z}function b(R,P){var k=this,z=new f(function(W,B){k.ready().then(function(){var te=k._dbInfo;te.db.transaction(function(le){M(le,te,"SELECT * FROM "+te.storeName,[],function(fe,he){for(var de=he.rows,we=de.length,Ne=0;Ne<we;Ne++){var We=de.item(Ne),He=We.value;if(He&&(He=te.serializer.deserialize(He)),He=R(He,We.key,Ne+1),He!==void 0){W(He);return}}W()},function(fe,he){B(he)})})}).catch(B)});return h(z,P),z}function ae(R,P,k,z){var W=this;R=m(R);var B=new f(function(te,le){W.ready().then(function(){P===void 0&&(P=null);var fe=P,he=W._dbInfo;he.serializer.serialize(P,function(de,we){we?le(we):he.db.transaction(function(Ne){M(Ne,he,"INSERT OR REPLACE INTO "+he.storeName+" (key, value) VALUES (?, ?)",[R,de],function(){te(fe)},function(We,He){le(He)})},function(Ne){if(Ne.code===Ne.QUOTA_ERR){if(z>0){te(ae.apply(W,[R,fe,k,z-1]));return}le(Ne)}})})}).catch(le)});return h(B,k),B}function Ae(R,P,k){return ae.apply(this,[R,P,k,1])}function y(R,P){var k=this;R=m(R);var z=new f(function(W,B){k.ready().then(function(){var te=k._dbInfo;te.db.transaction(function(le){M(le,te,"DELETE FROM "+te.storeName+" WHERE key = ?",[R],function(){W()},function(fe,he){B(he)})})}).catch(B)});return h(z,P),z}function Y(R){var P=this,k=new f(function(z,W){P.ready().then(function(){var B=P._dbInfo;B.db.transaction(function(te){M(te,B,"DELETE FROM "+B.storeName,[],function(){z()},function(le,fe){W(fe)})})}).catch(W)});return h(k,R),k}function Q(R){var P=this,k=new f(function(z,W){P.ready().then(function(){var B=P._dbInfo;B.db.transaction(function(te){M(te,B,"SELECT COUNT(key) as c FROM "+B.storeName,[],function(le,fe){var he=fe.rows.item(0).c;z(he)},function(le,fe){W(fe)})})}).catch(W)});return h(k,R),k}function D(R,P){var k=this,z=new f(function(W,B){k.ready().then(function(){var te=k._dbInfo;te.db.transaction(function(le){M(le,te,"SELECT key FROM "+te.storeName+" WHERE id = ? LIMIT 1",[R+1],function(fe,he){var de=he.rows.length?he.rows.item(0).key:null;W(de)},function(fe,he){B(he)})})}).catch(B)});return h(z,P),z}function F(R){var P=this,k=new f(function(z,W){P.ready().then(function(){var B=P._dbInfo;B.db.transaction(function(te){M(te,B,"SELECT key FROM "+B.storeName,[],function(le,fe){for(var he=[],de=0;de<fe.rows.length;de++)he.push(fe.rows.item(de).key);z(he)},function(le,fe){W(fe)})})}).catch(W)});return h(k,R),k}function K(R){return new f(function(P,k){R.transaction(function(z){z.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(W,B){for(var te=[],le=0;le<B.rows.length;le++)te.push(B.rows.item(le).name);P({db:R,storeNames:te})},function(W,B){k(B)})},function(z){k(z)})})}function Se(R,P){P=x.apply(this,arguments);var k=this.config();R=typeof R!="function"&&R||{},R.name||(R.name=R.name||k.name,R.storeName=R.storeName||k.storeName);var z=this,W;return R.name?W=new f(function(B){var te;R.name===k.name?te=z._dbInfo.db:te=openDatabase(R.name,"","",0),R.storeName?B({db:te,storeNames:[R.storeName]}):B(K(te))}).then(function(B){return new f(function(te,le){B.db.transaction(function(fe){function he(We){return new f(function(He,yt){fe.executeSql("DROP TABLE IF EXISTS "+We,[],function(){He()},function(gt,Ir){yt(Ir)})})}for(var de=[],we=0,Ne=B.storeNames.length;we<Ne;we++)de.push(he(B.storeNames[we]));f.all(de).then(function(){te()}).catch(function(We){le(We)})},function(fe){le(fe)})})}):W=f.reject("Invalid arguments"),h(W,P),W}var ge={_driver:"webSQLStorage",_initStorage:ve,_support:bt(),iterate:b,getItem:ee,setItem:Ae,removeItem:y,clear:Y,length:Q,key:D,keys:F,dropInstance:Se};function ye(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function Pe(R,P){var k=R.name+"/";return R.storeName!==P.storeName&&(k+=R.storeName+"/"),k}function Xr(){var R="_localforage_support_test";try{return localStorage.setItem(R,!0),localStorage.removeItem(R),!1}catch{return!0}}function nt(){return!Xr()||localStorage.length>0}function Me(R){var P=this,k={};if(R)for(var z in R)k[z]=R[z];return k.keyPrefix=Pe(R,P._defaultConfig),nt()?(P._dbInfo=k,k.serializer=ie,f.resolve()):f.reject()}function pt(R){var P=this,k=P.ready().then(function(){for(var z=P._dbInfo.keyPrefix,W=localStorage.length-1;W>=0;W--){var B=localStorage.key(W);B.indexOf(z)===0&&localStorage.removeItem(B)}});return h(k,R),k}function Dt(R,P){var k=this;R=m(R);var z=k.ready().then(function(){var W=k._dbInfo,B=localStorage.getItem(W.keyPrefix+R);return B&&(B=W.serializer.deserialize(B)),B});return h(z,P),z}function $t(R,P){var k=this,z=k.ready().then(function(){for(var W=k._dbInfo,B=W.keyPrefix,te=B.length,le=localStorage.length,fe=1,he=0;he<le;he++){var de=localStorage.key(he);if(de.indexOf(B)===0){var we=localStorage.getItem(de);if(we&&(we=W.serializer.deserialize(we)),we=R(we,de.substring(te),fe++),we!==void 0)return we}}});return h(z,P),z}function as(R,P){var k=this,z=k.ready().then(function(){var W=k._dbInfo,B;try{B=localStorage.key(R)}catch{B=null}return B&&(B=B.substring(W.keyPrefix.length)),B});return h(z,P),z}function os(R){var P=this,k=P.ready().then(function(){for(var z=P._dbInfo,W=localStorage.length,B=[],te=0;te<W;te++){var le=localStorage.key(te);le.indexOf(z.keyPrefix)===0&&B.push(le.substring(z.keyPrefix.length))}return B});return h(k,R),k}function ct(R){var P=this,k=P.keys().then(function(z){return z.length});return h(k,R),k}function sr(R,P){var k=this;R=m(R);var z=k.ready().then(function(){var W=k._dbInfo;localStorage.removeItem(W.keyPrefix+R)});return h(z,P),z}function St(R,P,k){var z=this;R=m(R);var W=z.ready().then(function(){P===void 0&&(P=null);var B=P;return new f(function(te,le){var fe=z._dbInfo;fe.serializer.serialize(P,function(he,de){if(de)le(de);else try{localStorage.setItem(fe.keyPrefix+R,he),te(B)}catch(we){(we.name==="QuotaExceededError"||we.name==="NS_ERROR_DOM_QUOTA_REACHED")&&le(we),le(we)}})})});return h(W,k),W}function Zr(R,P){if(P=x.apply(this,arguments),R=typeof R!="function"&&R||{},!R.name){var k=this.config();R.name=R.name||k.name,R.storeName=R.storeName||k.storeName}var z=this,W;return R.name?W=new f(function(B){R.storeName?B(Pe(R,z._defaultConfig)):B(R.name+"/")}).then(function(B){for(var te=localStorage.length-1;te>=0;te--){var le=localStorage.key(te);le.indexOf(B)===0&&localStorage.removeItem(le)}}):W=f.reject("Invalid arguments"),h(W,P),W}var Lr={_driver:"localStorageWrapper",_initStorage:Me,_support:ye(),iterate:$t,getItem:Dt,setItem:St,removeItem:sr,clear:pt,length:ct,key:as,keys:os,dropInstance:Zr},Po=function(P,k){return P===k||typeof P=="number"&&typeof k=="number"&&isNaN(P)&&isNaN(k)},aT=function(P,k){for(var z=P.length,W=0;W<z;){if(Po(P[W],k))return!0;W++}return!1},dp=Array.isArray||function(R){return Object.prototype.toString.call(R)==="[object Array]"},ua={},pp={},ls={INDEXEDDB:$e,WEBSQL:ge,LOCALSTORAGE:Lr},oT=[ls.INDEXEDDB._driver,ls.WEBSQL._driver,ls.LOCALSTORAGE._driver],Fo=["dropInstance"],sc=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Fo),lT={description:"",driver:oT.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function uT(R,P){R[P]=function(){var k=arguments;return R.ready().then(function(){return R[P].apply(R,k)})}}function ac(){for(var R=1;R<arguments.length;R++){var P=arguments[R];if(P)for(var k in P)P.hasOwnProperty(k)&&(dp(P[k])?arguments[0][k]=P[k].slice():arguments[0][k]=P[k])}return arguments[0]}var cT=function(){function R(P){a(this,R);for(var k in ls)if(ls.hasOwnProperty(k)){var z=ls[k],W=z._driver;this[k]=W,ua[W]||this.defineDriver(z)}this._defaultConfig=ac({},lT),this._config=ac({},this._defaultConfig,P),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return R.prototype.config=function(k){if((typeof k>"u"?"undefined":s(k))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var z in k){if(z==="storeName"&&(k[z]=k[z].replace(/\W/g,"_")),z==="version"&&typeof k[z]!="number")return new Error("Database version must be a number.");this._config[z]=k[z]}return"driver"in k&&k.driver?this.setDriver(this._config.driver):!0}else return typeof k=="string"?this._config[k]:this._config},R.prototype.defineDriver=function(k,z,W){var B=new f(function(te,le){try{var fe=k._driver,he=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!k._driver){le(he);return}for(var de=sc.concat("_initStorage"),we=0,Ne=de.length;we<Ne;we++){var We=de[we],He=!aT(Fo,We);if((He||k[We])&&typeof k[We]!="function"){le(he);return}}var yt=function(){for(var ca=function(dT){return function(){var pT=new Error("Method "+dT+" is not implemented by the current driver"),gp=f.reject(pT);return h(gp,arguments[arguments.length-1]),gp}},oc=0,hT=Fo.length;oc<hT;oc++){var lc=Fo[oc];k[lc]||(k[lc]=ca(lc))}};yt();var gt=function(ca){ua[fe]&&console.info("Redefining LocalForage driver: "+fe),ua[fe]=k,pp[fe]=ca,te()};"_support"in k?k._support&&typeof k._support=="function"?k._support().then(gt,le):gt(!!k._support):gt(!0)}catch(Ir){le(Ir)}});return d(B,z,W),B},R.prototype.driver=function(){return this._driver||null},R.prototype.getDriver=function(k,z,W){var B=ua[k]?f.resolve(ua[k]):f.reject(new Error("Driver not found."));return d(B,z,W),B},R.prototype.getSerializer=function(k){var z=f.resolve(ie);return d(z,k),z},R.prototype.ready=function(k){var z=this,W=z._driverSet.then(function(){return z._ready===null&&(z._ready=z._initDriver()),z._ready});return d(W,k,k),W},R.prototype.setDriver=function(k,z,W){var B=this;dp(k)||(k=[k]);var te=this._getSupportedDrivers(k);function le(){B._config.driver=B.driver()}function fe(we){return B._extend(we),le(),B._ready=B._initStorage(B._config),B._ready}function he(we){return function(){var Ne=0;function We(){for(;Ne<we.length;){var He=we[Ne];return Ne++,B._dbInfo=null,B._ready=null,B.getDriver(He).then(fe).catch(We)}le();var yt=new Error("No available storage method found.");return B._driverSet=f.reject(yt),B._driverSet}return We()}}var de=this._driverSet!==null?this._driverSet.catch(function(){return f.resolve()}):f.resolve();return this._driverSet=de.then(function(){var we=te[0];return B._dbInfo=null,B._ready=null,B.getDriver(we).then(function(Ne){B._driver=Ne._driver,le(),B._wrapLibraryMethodsWithReady(),B._initDriver=he(te)})}).catch(function(){le();var we=new Error("No available storage method found.");return B._driverSet=f.reject(we),B._driverSet}),d(this._driverSet,z,W),this._driverSet},R.prototype.supports=function(k){return!!pp[k]},R.prototype._extend=function(k){ac(this,k)},R.prototype._getSupportedDrivers=function(k){for(var z=[],W=0,B=k.length;W<B;W++){var te=k[W];this.supports(te)&&z.push(te)}return z},R.prototype._wrapLibraryMethodsWithReady=function(){for(var k=0,z=sc.length;k<z;k++)uT(this,sc[k])},R.prototype.createInstance=function(k){return new R(k)},R}(),fT=new cT;n.exports=fT},{3:3}]},{},[4])(4)})})(jx);Object.defineProperty(rc,"__esModule",{value:!0});rc.default=void 0;var Pn=Ee,pL=ko(rs),yf=ko(sa),gL=ko(Cn),mL=ko(Hr.exports),hm=ko(jx.exports);function ko(r){return r&&r.__esModule?r:{default:r}}class Kx{constructor(e,t,n){this.urlCache={},this.storage=void 0,this.name=e,this.requester=t||pL.default,this.resolver=n,this.online=!0,this.checkRequirements(),this.addListeners()}checkRequirements(){try{let e;typeof hm.default>"u"&&(e=hm.default),this.storage=e.createInstance({name:this.name})}catch{throw new Error("localForage lib not loaded")}}addListeners(){this._status=this.status.bind(this),window.addEventListener("online",this._status),window.addEventListener("offline",this._status)}removeListeners(){window.removeEventListener("online",this._status),window.removeEventListener("offline",this._status),this._status=void 0}status(e){let t=navigator.onLine;this.online=t,t?this.emit("online",this):this.emit("offline",this)}add(e,t){let n=e.resources.map(i=>{let{href:s}=i,a=this.resolver(s),o=window.encodeURIComponent(a);return this.storage.getItem(o).then(l=>!l||t?this.requester(a,"binary").then(u=>this.storage.setItem(o,u)):l)});return Promise.all(n)}put(e,t,n){let i=window.encodeURIComponent(e);return this.storage.getItem(i).then(s=>s||this.requester(e,"binary",t,n).then(a=>this.storage.setItem(i,a)))}request(e,t,n,i){return this.online?this.requester(e,t,n,i).then(s=>(this.put(e),s)):this.retrieve(e,t)}retrieve(e,t){new Pn.defer;var n,i=new gL.default(e);return t||(t=i.extension),t=="blob"?n=this.getBlob(e):n=this.getText(e),n.then(s=>{var a=new Pn.defer,o;return s?(o=this.handleResponse(s,t),a.resolve(o)):a.reject({message:"File not found in storage: "+e,stack:new Error().stack}),a.promise})}handleResponse(e,t){var n;return t=="json"?n=JSON.parse(e):(0,Pn.isXml)(t)?n=(0,Pn.parse)(e,"text/xml"):t=="xhtml"?n=(0,Pn.parse)(e,"application/xhtml+xml"):t=="html"||t=="htm"?n=(0,Pn.parse)(e,"text/html"):n=e,n}getBlob(e,t){let n=window.encodeURIComponent(e);return this.storage.getItem(n).then(function(i){if(!!i)return t=t||yf.default.lookup(e),new Blob([i],{type:t})})}getText(e,t){let n=window.encodeURIComponent(e);return t=t||yf.default.lookup(e),this.storage.getItem(n).then(function(i){var s=new Pn.defer,a=new FileReader,o;if(!!i)return o=new Blob([i],{type:t}),a.addEventListener("loadend",()=>{s.resolve(a.result)}),a.readAsText(o,t),s.promise})}getBase64(e,t){let n=window.encodeURIComponent(e);return t=t||yf.default.lookup(e),this.storage.getItem(n).then(i=>{var s=new Pn.defer,a=new FileReader,o;if(!!i)return o=new Blob([i],{type:t}),a.addEventListener("loadend",()=>{s.resolve(a.result)}),a.readAsDataURL(o,t),s.promise})}createUrl(e,t){var n=new Pn.defer,i=window.URL||window.webkitURL||window.mozURL,s,a,o=t&&t.base64;return e in this.urlCache?(n.resolve(this.urlCache[e]),n.promise):(o?(a=this.getBase64(e),a&&a.then(function(l){this.urlCache[e]=l,n.resolve(l)}.bind(this))):(a=this.getBlob(e),a&&a.then(function(l){s=i.createObjectURL(l),this.urlCache[e]=s,n.resolve(s)}.bind(this))),a||n.reject({message:"File not found in storage: "+e,stack:new Error().stack}),n.promise)}revokeUrl(e){var t=window.URL||window.webkitURL||window.mozURL,n=this.urlCache[e];n&&t.revokeObjectURL(n)}destroy(){var e=window.URL||window.webkitURL||window.mozURL;for(let t in this.urlCache)e.revokeObjectURL(t);this.urlCache={},this.removeListeners()}}(0,mL.default)(Kx.prototype);var vL=Kx;rc.default=vL;var nc={};Object.defineProperty(nc,"__esModule",{value:!0});nc.default=void 0;var dm=Ee;class yL{constructor(e){this.interactive="",this.fixedLayout="",this.openToSpread="",this.orientationLock="",e&&this.parse(e)}parse(e){if(!e)return this;const t=(0,dm.qs)(e,"display_options");return t?((0,dm.qsa)(t,"option").forEach(i=>{let s="";switch(i.childNodes.length&&(s=i.childNodes[0].nodeValue),i.attributes.name.value){case"interactive":this.interactive=s;break;case"fixed-layout":this.fixedLayout=s;break;case"open-to-spread":this.openToSpread=s;break;case"orientation-lock":this.orientationLock=s;break}}),this):this}destroy(){this.interactive=void 0,this.fixedLayout=void 0,this.openToSpread=void 0,this.orientationLock=void 0}}var EL=yL;nc.default=EL;Object.defineProperty(xo,"__esModule",{value:!0});xo.default=void 0;var xL=Kt(Hr.exports),en=Ee,si=Kt(ts),pm=Kt(Cn),TL=Kt(Fu),SL=Kt(Bu),wL=Kt(Uu),gm=Kt($u),Ef=Kt(zu),_L=Kt(Vu),xf=Kt(Wu),AL=Kt(aa),bL=Kt(ec),mm=Kt(rs),DL=Kt(tr),CL=Kt(rc),Tf=Kt(nc),vm=Lt;function Kt(r){return r&&r.__esModule?r:{default:r}}const ym="META-INF/container.xml",RL="META-INF/com.apple.ibooks.display-options.xml",tn={BINARY:"binary",BASE64:"base64",EPUB:"epub",OPF:"opf",MANIFEST:"json",DIRECTORY:"directory"};class qx{constructor(e,t){typeof t>"u"&&typeof e!="string"&&!(e instanceof Blob)&&!(e instanceof ArrayBuffer)&&(t=e,e=void 0),this.settings=(0,en.extend)(this.settings||{},{requestMethod:void 0,requestCredentials:void 0,requestHeaders:void 0,encoding:void 0,replacements:void 0,canonical:void 0,openAs:void 0,store:void 0}),(0,en.extend)(this.settings,t),this.opening=new en.defer,this.opened=this.opening.promise,this.isOpen=!1,this.loading={manifest:new en.defer,spine:new en.defer,metadata:new en.defer,cover:new en.defer,navigation:new en.defer,pageList:new en.defer,resources:new en.defer,displayOptions:new en.defer},this.loaded={manifest:this.loading.manifest.promise,spine:this.loading.spine.promise,metadata:this.loading.metadata.promise,cover:this.loading.cover.promise,navigation:this.loading.navigation.promise,pageList:this.loading.pageList.promise,resources:this.loading.resources.promise,displayOptions:this.loading.displayOptions.promise},this.ready=Promise.all([this.loaded.manifest,this.loaded.spine,this.loaded.metadata,this.loaded.cover,this.loaded.navigation,this.loaded.resources,this.loaded.displayOptions]),this.isRendered=!1,this.request=this.settings.requestMethod||mm.default,this.spine=new TL.default,this.locations=new SL.default(this.spine,this.load.bind(this)),this.navigation=void 0,this.pageList=void 0,this.url=void 0,this.path=void 0,this.archived=!1,this.archive=void 0,this.storage=void 0,this.resources=void 0,this.rendition=void 0,this.container=void 0,this.packaging=void 0,this.displayOptions=void 0,this.settings.store&&this.store(this.settings.store),e&&this.open(e,this.settings.openAs).catch(n=>{var i=new Error("Cannot load book at "+e);this.emit(vm.EVENTS.BOOK.OPEN_FAILED,i)})}open(e,t){var n,i=t||this.determineType(e);return i===tn.BINARY?(this.archived=!0,this.url=new si.default("/",""),n=this.openEpub(e)):i===tn.BASE64?(this.archived=!0,this.url=new si.default("/",""),n=this.openEpub(e,i)):i===tn.EPUB?(this.archived=!0,this.url=new si.default("/",""),n=this.request(e,"binary",this.settings.requestCredentials,this.settings.requestHeaders).then(this.openEpub.bind(this))):i==tn.OPF?(this.url=new si.default(e),n=this.openPackaging(this.url.Path.toString())):i==tn.MANIFEST?(this.url=new si.default(e),n=this.openManifest(this.url.Path.toString())):(this.url=new si.default(e),n=this.openContainer(ym).then(this.openPackaging.bind(this))),n}openEpub(e,t){return this.unarchive(e,t||this.settings.encoding).then(()=>this.openContainer(ym)).then(n=>this.openPackaging(n))}openContainer(e){return this.load(e).then(t=>(this.container=new wL.default(t),this.resolve(this.container.packagePath)))}openPackaging(e){return this.path=new pm.default(e),this.load(e).then(t=>(this.packaging=new gm.default(t),this.unpack(this.packaging)))}openManifest(e){return this.path=new pm.default(e),this.load(e).then(t=>(this.packaging=new gm.default,this.packaging.load(t),this.unpack(this.packaging)))}load(e){var t=this.resolve(e);return this.archived?this.archive.request(t):this.request(t,null,this.settings.requestCredentials,this.settings.requestHeaders)}resolve(e,t){if(!!e){var n=e,i=e.indexOf("://")>-1;return i?e:(this.path&&(n=this.path.resolve(e)),t!=!1&&this.url&&(n=this.url.resolve(n)),n)}}canonical(e){var t=e;return e?(this.settings.canonical?t=this.settings.canonical(e):t=this.resolve(e,!0),t):""}determineType(e){var t,n,i;if(this.settings.encoding==="base64")return tn.BASE64;if(typeof e!="string")return tn.BINARY;if(t=new si.default(e),n=t.path(),i=n.extension,i&&(i=i.replace(/\?.*$/,"")),!i)return tn.DIRECTORY;if(i==="epub")return tn.EPUB;if(i==="opf")return tn.OPF;if(i==="json")return tn.MANIFEST}unpack(e){this.package=e,this.packaging.metadata.layout===""?this.load(this.url.resolve(RL)).then(t=>{this.displayOptions=new Tf.default(t),this.loading.displayOptions.resolve(this.displayOptions)}).catch(t=>{this.displayOptions=new Tf.default,this.loading.displayOptions.resolve(this.displayOptions)}):(this.displayOptions=new Tf.default,this.loading.displayOptions.resolve(this.displayOptions)),this.spine.unpack(this.packaging,this.resolve.bind(this),this.canonical.bind(this)),this.resources=new _L.default(this.packaging.manifest,{archive:this.archive,resolver:this.resolve.bind(this),request:this.request.bind(this),replacements:this.settings.replacements||(this.archived?"blobUrl":"base64")}),this.loadNavigation(this.packaging).then(()=>{this.loading.navigation.resolve(this.navigation)}),this.packaging.coverPath&&(this.cover=this.resolve(this.packaging.coverPath)),this.loading.manifest.resolve(this.packaging.manifest),this.loading.metadata.resolve(this.packaging.metadata),this.loading.spine.resolve(this.spine),this.loading.cover.resolve(this.cover),this.loading.resources.resolve(this.resources),this.loading.pageList.resolve(this.pageList),this.isOpen=!0,this.archived||this.settings.replacements&&this.settings.replacements!="none"?this.replacements().then(()=>{this.loaded.displayOptions.then(()=>{this.opening.resolve(this)})}).catch(t=>{console.error(t)}):this.loaded.displayOptions.then(()=>{this.opening.resolve(this)})}loadNavigation(e){let t=e.navPath||e.ncxPath,n=e.toc;return n?new Promise((i,s)=>{this.navigation=new Ef.default(n),e.pageList&&(this.pageList=new xf.default(e.pageList)),i(this.navigation)}):t?this.load(t,"xml").then(i=>(this.navigation=new Ef.default(i),this.pageList=new xf.default(i),this.navigation)):new Promise((i,s)=>{this.navigation=new Ef.default,this.pageList=new xf.default,i(this.navigation)})}section(e){return this.spine.get(e)}renderTo(e,t){return this.rendition=new AL.default(this,t),this.rendition.attachTo(e),this.rendition}setRequestCredentials(e){this.settings.requestCredentials=e}setRequestHeaders(e){this.settings.requestHeaders=e}unarchive(e,t){return this.archive=new bL.default,this.archive.open(e,t)}store(e){let t=this.settings.replacements&&this.settings.replacements!=="none",n=this.url,i=this.settings.requestMethod||mm.default.bind(this);return this.storage=new CL.default(e,i,this.resolve.bind(this)),this.request=this.storage.request.bind(this.storage),this.opened.then(()=>{this.archived&&(this.storage.requester=this.archive.request.bind(this.archive));let s=(a,o)=>{o.output=this.resources.substitute(a,o.url)};this.resources.settings.replacements=t||"blobUrl",this.resources.replacements().then(()=>this.resources.replaceCss()),this.storage.on("offline",()=>{this.url=new si.default("/",""),this.spine.hooks.serialize.register(s)}),this.storage.on("online",()=>{this.url=n,this.spine.hooks.serialize.deregister(s)})}),this.storage}coverUrl(){return this.loaded.cover.then(()=>this.cover?this.archived?this.archive.createUrl(this.cover):this.cover:null)}replacements(){return this.spine.hooks.serialize.register((e,t)=>{t.output=this.resources.substitute(e,t.url)}),this.resources.replacements().then(()=>this.resources.replaceCss())}getRange(e){var t=new DL.default(e),n=this.spine.get(t.spinePos),i=this.load.bind(this);return n?n.load(i).then(function(s){var a=t.toRange(n.document);return a}):new Promise((s,a)=>{a("CFI could not be found")})}key(e){var t=e||this.packaging.metadata.identifier||this.url.filename;return`epubjs:${vm.EPUBJS_VERSION}:${t}`}destroy(){this.opened=void 0,this.loading=void 0,this.loaded=void 0,this.ready=void 0,this.isOpen=!1,this.isRendered=!1,this.spine&&this.spine.destroy(),this.locations&&this.locations.destroy(),this.pageList&&this.pageList.destroy(),this.archive&&this.archive.destroy(),this.resources&&this.resources.destroy(),this.container&&this.container.destroy(),this.packaging&&this.packaging.destroy(),this.rendition&&this.rendition.destroy(),this.displayOptions&&this.displayOptions.destroy(),this.spine=void 0,this.locations=void 0,this.pageList=void 0,this.archive=void 0,this.resources=void 0,this.container=void 0,this.packaging=void 0,this.rendition=void 0,this.navigation=void 0,this.url=void 0,this.path=void 0,this.archived=!1}}(0,xL.default)(qx.prototype);var LL=qx;xo.default=LL;var ic={};Object.defineProperty(ic,"__esModule",{value:!0});ic.default=void 0;var Yx=is(xo),IL=is(aa),kL=is(tr),OL=is(ns),NL=PL(Ee),Xx=Lt;is(Ro);is(oa);is(Io);function Zx(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(Zx=function(n){return n?t:e})(r)}function PL(r,e){if(!e&&r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=Zx(e);if(t&&t.has(r))return t.get(r);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in r)if(s!=="default"&&Object.prototype.hasOwnProperty.call(r,s)){var a=i?Object.getOwnPropertyDescriptor(r,s):null;a&&(a.get||a.set)?Object.defineProperty(n,s,a):n[s]=r[s]}return n.default=r,t&&t.set(r,n),n}function is(r){return r&&r.__esModule?r:{default:r}}function ss(r,e){return new Yx.default(r,e)}ss.VERSION=Xx.EPUBJS_VERSION;typeof hr<"u"&&(hr.EPUBJS_VERSION=Xx.EPUBJS_VERSION);ss.Book=Yx.default;ss.Rendition=IL.default;ss.Contents=OL.default;ss.CFI=kL.default;ss.utils=NL;var FL=ss;ic.default=FL;(function(r){Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"Book",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(r,"Contents",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(r,"EpubCFI",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(r,"Layout",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(r,"Rendition",{enumerable:!0,get:function(){return n.default}}),r.default=void 0;var e=o(xo),t=o(tr),n=o(aa),i=o(ns),s=o(Do),a=o(ic);function o(u){return u&&u.__esModule?u:{default:u}}var l=a.default;r.default=l})(PE);var Oo={};Object.defineProperty(Oo,"__esModule",{value:!0});Oo.EpubViewStyle=void 0;var ML={viewHolder:{position:"relative",height:"100%",width:"100%"},view:{height:"100%"}};Oo.EpubViewStyle=ML;Object.defineProperty(ku,"__esModule",{value:!0});ku.default=void 0;var ml=$L(cn.exports),Xt=Qx(Wd.exports),BL=Qx(PE),UL=Oo;function Qx(r){return r&&r.__esModule?r:{default:r}}function Jx(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(Jx=function(i){return i?t:e})(r)}function $L(r,e){if(!e&&r&&r.__esModule)return r;if(r===null||Qi(r)!=="object"&&typeof r!="function")return{default:r};var t=Jx(e);if(t&&t.has(r))return t.get(r);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in r)if(s!=="default"&&Object.prototype.hasOwnProperty.call(r,s)){var a=i?Object.getOwnPropertyDescriptor(r,s):null;a&&(a.get||a.set)?Object.defineProperty(n,s,a):n[s]=r[s]}return n.default=r,t&&t.set(r,n),n}function Qi(r){return Qi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qi(r)}function Em(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function zL(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Em(Object(t),!0).forEach(function(n){kh(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Em(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function VL(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function xm(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,eT(n.key),n)}}function GL(r,e,t){return e&&xm(r.prototype,e),t&&xm(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function WL(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&Lh(r,e)}function Lh(r,e){return Lh=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Lh(r,e)}function HL(r){var e=KL();return function(){var n=du(r),i;if(e){var s=du(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return jL(this,i)}}function jL(r,e){if(e&&(Qi(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ih(r)}function Ih(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function KL(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function du(r){return du=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},du(r)}function kh(r,e,t){return e=eT(e),e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function eT(r){var e=qL(r,"string");return Qi(e)==="symbol"?e:String(e)}function qL(r,e){if(Qi(r)!=="object"||r===null)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(Qi(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var hp=function(r){WL(t,r);var e=HL(t);function t(n){var i;return VL(this,t),i=e.call(this,n),kh(Ih(i),"onLocationChange",function(s){var a=i.props,o=a.location,l=a.locationChanged,u=s&&s.start;o!==u&&(i.location=u,l&&l(u))}),kh(Ih(i),"handleKeyPress",function(s){var a=s.key;a&&a==="ArrowRight"&&i.nextPage(),a&&a==="ArrowLeft"&&i.prevPage()}),i.state={isLoaded:!1,toc:[]},i.viewerRef=ml.default.createRef(),i.location=n.location,i.book=i.rendition=i.prevPage=i.nextPage=null,i}return GL(t,[{key:"componentDidMount",value:function(){this.initBook(!0),document.addEventListener("keyup",this.handleKeyPress,!1)}},{key:"initBook",value:function(){var i=this,s=this.props,a=s.url,o=s.tocChanged,l=s.epubInitOptions;this.book&&this.book.destroy(),this.book=new BL.default(a,l),this.book.loaded.navigation.then(function(u){var c=u.toc;i.setState({isLoaded:!0,toc:c},function(){o&&o(c),i.initReader()})})}},{key:"componentWillUnmount",value:function(){this.book&&this.book.destroy(),this.book=this.rendition=this.prevPage=this.nextPage=null,document.removeEventListener("keyup",this.handleKeyPress,!1)}},{key:"shouldComponentUpdate",value:function(i){return!this.state.isLoaded||i.location!==this.props.location||i.location!==this.props.location}},{key:"componentDidUpdate",value:function(i){i.location!==this.props.location&&this.location!==this.props.location&&this.rendition.display(this.props.location),i.url!==this.props.url&&this.initBook()}},{key:"initReader",value:function(){var i=this,s=this.state.toc,a=this.props,o=a.location,l=a.epubOptions,u=a.getRendition,c=this.viewerRef.current;this.rendition=this.book.renderTo(c,zL({contained:!0,width:"100%",height:"100%"},l)),this.prevPage=function(){i.rendition.prev()},this.nextPage=function(){i.rendition.next()},this.registerEvents(),u&&u(this.rendition),typeof o=="string"||typeof o=="number"?this.rendition.display(o):s.length>0&&s[0].href?this.rendition.display(s[0].href):this.rendition.display()}},{key:"registerEvents",value:function(){var i=this.props,s=i.handleKeyPress,a=i.handleTextSelected;this.rendition.on("locationChanged",this.onLocationChange),this.rendition.on("keyup",s||this.handleKeyPress),a&&this.rendition.on("selected",a)}},{key:"renderBook",value:function(){var i=this.props.epubViewStyles;return ml.default.createElement("div",{ref:this.viewerRef,style:i.view})}},{key:"render",value:function(){var i=this.state.isLoaded,s=this.props,a=s.loadingView,o=s.epubViewStyles;return ml.default.createElement("div",{style:o.viewHolder},i&&this.renderBook()||a)}}]),t}(ml.Component);hp.defaultProps={loadingView:null,locationChanged:null,tocChanged:null,epubViewStyles:UL.EpubViewStyle,epubOptions:{},epubInitOptions:{}};hp.propTypes={url:Xt.default.oneOfType([Xt.default.string,Xt.default.instanceOf(ArrayBuffer)]),loadingView:Xt.default.element,location:Xt.default.oneOfType([Xt.default.string,Xt.default.number]),locationChanged:Xt.default.func,tocChanged:Xt.default.func,epubViewStyles:Xt.default.object,epubInitOptions:Xt.default.object,epubOptions:Xt.default.object,getRendition:Xt.default.func,handleKeyPress:Xt.default.func,handleTextSelected:Xt.default.func};var YL=hp;ku.default=YL;var Da={};const tT="Left",rT="Right",nT="Up",iT="Down",Ms={delta:10,preventScrollOnSwipe:!1,rotationAngle:0,trackMouse:!1,trackTouch:!0,swipeDuration:1/0,touchEventOptions:{passive:!0}},Oh={first:!0,initial:[0,0],start:0,swiping:!1,xy:[0,0]},Tm="mousemove",Sm="mouseup",XL="touchend",ZL="touchmove",QL="touchstart";function JL(r,e,t,n){return r>e?t>0?rT:tT:n>0?iT:nT}function wm(r,e){if(e===0)return r;const t=Math.PI/180*e,n=r[0]*Math.cos(t)+r[1]*Math.sin(t),i=r[1]*Math.cos(t)-r[0]*Math.sin(t);return[n,i]}function eI(r,e){const t=c=>{const f="touches"in c;f&&c.touches.length>1||r((h,d)=>{d.trackMouse&&!f&&(document.addEventListener(Tm,n),document.addEventListener(Sm,a));const{clientX:m,clientY:x}=f?c.touches[0]:c,p=wm([m,x],d.rotationAngle);return d.onTouchStartOrOnMouseDown&&d.onTouchStartOrOnMouseDown({event:c}),Object.assign(Object.assign(Object.assign({},h),Oh),{initial:p.slice(),xy:p,start:c.timeStamp||0})})},n=c=>{r((f,h)=>{const d="touches"in c;if(d&&c.touches.length>1)return f;if(c.timeStamp-f.start>h.swipeDuration)return f.swiping?Object.assign(Object.assign({},f),{swiping:!1}):f;const{clientX:m,clientY:x}=d?c.touches[0]:c,[p,g]=wm([m,x],h.rotationAngle),v=p-f.xy[0],E=g-f.xy[1],S=Math.abs(v),T=Math.abs(E),w=(c.timeStamp||0)-f.start,_=Math.sqrt(S*S+T*T)/(w||1),C=[v/(w||1),E/(w||1)],O=JL(S,T,v,E),L=typeof h.delta=="number"?h.delta:h.delta[O.toLowerCase()]||Ms.delta;if(S<L&&T<L&&!f.swiping)return f;const V={absX:S,absY:T,deltaX:v,deltaY:E,dir:O,event:c,first:f.first,initial:f.initial,velocity:_,vxvy:C};V.first&&h.onSwipeStart&&h.onSwipeStart(V),h.onSwiping&&h.onSwiping(V);let $=!1;return(h.onSwiping||h.onSwiped||h[`onSwiped${O}`])&&($=!0),$&&h.preventScrollOnSwipe&&h.trackTouch&&c.cancelable&&c.preventDefault(),Object.assign(Object.assign({},f),{first:!1,eventData:V,swiping:!0})})},i=c=>{r((f,h)=>{let d;if(f.swiping&&f.eventData){if(c.timeStamp-f.start<h.swipeDuration){d=Object.assign(Object.assign({},f.eventData),{event:c}),h.onSwiped&&h.onSwiped(d);const m=h[`onSwiped${d.dir}`];m&&m(d)}}else h.onTap&&h.onTap({event:c});return h.onTouchEndOrOnMouseUp&&h.onTouchEndOrOnMouseUp({event:c}),Object.assign(Object.assign(Object.assign({},f),Oh),{eventData:d})})},s=()=>{document.removeEventListener(Tm,n),document.removeEventListener(Sm,a)},a=c=>{s(),i(c)},o=(c,f)=>{let h=()=>{};if(c&&c.addEventListener){const d=Object.assign(Object.assign({},Ms.touchEventOptions),f.touchEventOptions),m=[[QL,t,d],[ZL,n,Object.assign(Object.assign({},d),f.preventScrollOnSwipe?{passive:!1}:{})],[XL,i,d]];m.forEach(([x,p,g])=>c.addEventListener(x,p,g)),h=()=>m.forEach(([x,p])=>c.removeEventListener(x,p))}return h},u={ref:c=>{c!==null&&r((f,h)=>{if(f.el===c)return f;const d={};return f.el&&f.el!==c&&f.cleanUpTouch&&(f.cleanUpTouch(),d.cleanUpTouch=void 0),h.trackTouch&&c&&(d.cleanUpTouch=o(c,h)),Object.assign(Object.assign(Object.assign({},f),{el:c}),d)})}};return e.trackMouse&&(u.onMouseDown=t),[u,o]}function tI(r,e,t,n){return!e.trackTouch||!r.el?(r.cleanUpTouch&&r.cleanUpTouch(),Object.assign(Object.assign({},r),{cleanUpTouch:void 0})):r.cleanUpTouch?e.preventScrollOnSwipe!==t.preventScrollOnSwipe||e.touchEventOptions.passive!==t.touchEventOptions.passive?(r.cleanUpTouch(),Object.assign(Object.assign({},r),{cleanUpTouch:n(r.el,e)})):r:Object.assign(Object.assign({},r),{cleanUpTouch:n(r.el,e)})}function rI(r){const{trackMouse:e}=r,t=cn.exports.useRef(Object.assign({},Oh)),n=cn.exports.useRef(Object.assign({},Ms)),i=cn.exports.useRef(Object.assign({},n.current));i.current=Object.assign({},n.current),n.current=Object.assign(Object.assign({},Ms),r);let s;for(s in Ms)n.current[s]===void 0&&(n.current[s]=Ms[s]);const[a,o]=cn.exports.useMemo(()=>eI(l=>t.current=l(t.current,n.current),{trackMouse:e}),[e]);return t.current=tI(t.current,n.current,i.current,o),a}const nI=Object.freeze(Object.defineProperty({__proto__:null,DOWN:iT,LEFT:tT,RIGHT:rT,UP:nT,useSwipeable:rI},Symbol.toStringTag,{value:"Module"})),iI=mT(nI);var No={};Object.defineProperty(No,"__esModule",{value:!0});No.ReactReaderStyle=void 0;var sI={container:{overflow:"hidden",position:"relative",height:"100%"},readerArea:{position:"relative",zIndex:1,height:"100%",width:"100%",backgroundColor:"#fff",transition:"all .3s ease"},containerExpanded:{transform:"translateX(256px)"},titleArea:{position:"absolute",top:20,left:50,right:50,textAlign:"center",color:"#999"},reader:{position:"absolute",top:50,left:50,bottom:20,right:50},swipeWrapper:{position:"absolute",top:0,left:0,bottom:0,right:0,zIndex:200},prev:{left:1},next:{right:1},arrow:{outline:"none",border:"none",background:"none",position:"absolute",top:"50%",marginTop:-32,fontSize:64,padding:"0 10px",color:"#E2E2E2",fontFamily:"arial, sans-serif",cursor:"pointer",userSelect:"none",appearance:"none",fontWeight:"normal"},arrowHover:{color:"#777"},tocBackground:{position:"absolute",left:256,top:0,bottom:0,right:0,zIndex:1},tocArea:{position:"absolute",left:0,top:0,bottom:0,zIndex:0,width:256,overflowY:"auto",WebkitOverflowScrolling:"touch",background:"#f2f2f2",padding:"10px 0"},tocAreaButton:{userSelect:"none",appearance:"none",background:"none",border:"none",display:"block",fontFamily:"sans-serif",width:"100%",fontSize:".9em",textAlign:"left",padding:".9em 1em",borderBottom:"1px solid #ddd",color:"#aaa",boxSizing:"border-box",outline:"none",cursor:"pointer"},tocButton:{background:"none",border:"none",width:32,height:32,position:"absolute",top:10,left:10,borderRadius:2,outline:"none",cursor:"pointer"},tocButtonExpanded:{background:"#f2f2f2"},tocButtonBar:{position:"absolute",width:"60%",background:"#ccc",height:2,left:"50%",margin:"-1px -30%",top:"50%",transition:"all .5s ease"},tocButtonBarTop:{top:"35%"},tocButtonBottom:{top:"66%"},loadingView:{position:"absolute",top:"50%",left:"10%",right:"10%",color:"#ccc",textAlign:"center",margintop:"-.5em"}};No.ReactReaderStyle=sI;var _m;function aI(){if(_m)return Da;_m=1;function r(H){return r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(j){return typeof j}:function(j){return j&&typeof Symbol=="function"&&j.constructor===Symbol&&j!==Symbol.prototype?"symbol":typeof j},r(H)}Object.defineProperty(Da,"__esModule",{value:!0}),Da.default=void 0;var e=c(cn.exports),t=l(Wd.exports),n=iI,i=sT(),s=No,a=["children"],o=["title","showToc","loadingView","readerStyles","locationChanged","swipeable","epubViewStyles"];function l(H){return H&&H.__esModule?H:{default:H}}function u(H){if(typeof WeakMap!="function")return null;var j=new WeakMap,X=new WeakMap;return(u=function(U){return U?X:j})(H)}function c(H,j){if(!j&&H&&H.__esModule)return H;if(H===null||r(H)!=="object"&&typeof H!="function")return{default:H};var X=u(j);if(X&&X.has(H))return X.get(H);var N={},U=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Z in H)if(Z!=="default"&&Object.prototype.hasOwnProperty.call(H,Z)){var oe=U?Object.getOwnPropertyDescriptor(H,Z):null;oe&&(oe.get||oe.set)?Object.defineProperty(N,Z,oe):N[Z]=H[Z]}return N.default=H,X&&X.set(H,N),N}function f(){return f=Object.assign?Object.assign.bind():function(H){for(var j=1;j<arguments.length;j++){var X=arguments[j];for(var N in X)Object.prototype.hasOwnProperty.call(X,N)&&(H[N]=X[N])}return H},f.apply(this,arguments)}function h(H,j){if(!(H instanceof j))throw new TypeError("Cannot call a class as a function")}function d(H,j){for(var X=0;X<j.length;X++){var N=j[X];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(H,_(N.key),N)}}function m(H,j,X){return j&&d(H.prototype,j),X&&d(H,X),Object.defineProperty(H,"prototype",{writable:!1}),H}function x(H,j){if(typeof j!="function"&&j!==null)throw new TypeError("Super expression must either be null or a function");H.prototype=Object.create(j&&j.prototype,{constructor:{value:H,writable:!0,configurable:!0}}),Object.defineProperty(H,"prototype",{writable:!1}),j&&p(H,j)}function p(H,j){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(N,U){return N.__proto__=U,N},p(H,j)}function g(H){var j=S();return function(){var N=T(H),U;if(j){var Z=T(this).constructor;U=Reflect.construct(N,arguments,Z)}else U=N.apply(this,arguments);return v(this,U)}}function v(H,j){if(j&&(r(j)==="object"||typeof j=="function"))return j;if(j!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return E(H)}function E(H){if(H===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return H}function S(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function T(H){return T=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(X){return X.__proto__||Object.getPrototypeOf(X)},T(H)}function w(H,j,X){return j=_(j),j in H?Object.defineProperty(H,j,{value:X,enumerable:!0,configurable:!0,writable:!0}):H[j]=X,H}function _(H){var j=C(H,"string");return r(j)==="symbol"?j:String(j)}function C(H,j){if(r(H)!=="object"||H===null)return H;var X=H[Symbol.toPrimitive];if(X!==void 0){var N=X.call(H,j||"default");if(r(N)!=="object")return N;throw new TypeError("@@toPrimitive must return a primitive value.")}return(j==="string"?String:Number)(H)}function O(H,j){if(H==null)return{};var X=L(H,j),N,U;if(Object.getOwnPropertySymbols){var Z=Object.getOwnPropertySymbols(H);for(U=0;U<Z.length;U++)N=Z[U],!(j.indexOf(N)>=0)&&(!Object.prototype.propertyIsEnumerable.call(H,N)||(X[N]=H[N]))}return X}function L(H,j){if(H==null)return{};var X={},N=Object.keys(H),U,Z;for(Z=0;Z<N.length;Z++)U=N[Z],!(j.indexOf(U)>=0)&&(X[U]=H[U]);return X}var V=function(j){var X=j.children,N=O(j,a),U=(0,n.useSwipeable)(N);return e.default.createElement("div",U,X)},$=function(H){x(X,H);var j=g(X);function X(){var N;h(this,X);for(var U=arguments.length,Z=new Array(U),oe=0;oe<U;oe++)Z[oe]=arguments[oe];return N=j.call.apply(j,[this].concat(Z)),w(E(N),"setLocation",function(){N.props.setLocation(N.props.href)}),N}return m(X,[{key:"render",value:function(){var U=this,Z=this.props,oe=Z.label,re=Z.styles,pe=Z.subitems;return e.default.createElement("div",null,e.default.createElement("button",{onClick:this.setLocation,style:re},oe),pe&&pe.length>0&&e.default.createElement("div",{style:{paddingLeft:10}},pe.map(function(Te,Ie){return e.default.createElement(X,f({key:Ie},U.props,Te))})))}}]),X}(e.PureComponent);$.propTypes={label:t.default.string,href:t.default.string,setLocation:t.default.func,styles:t.default.object};var ne=function(H){x(X,H);var j=g(X);function X(N){var U;return h(this,X),U=j.call(this,N),w(E(U),"toggleToc",function(){U.setState({expandedToc:!U.state.expandedToc})}),w(E(U),"next",function(){var Z=U.readerRef.current;Z.nextPage()}),w(E(U),"prev",function(){var Z=U.readerRef.current;Z.prevPage()}),w(E(U),"onTocChange",function(Z){var oe=U.props.tocChanged;U.setState({toc:Z},function(){return oe&&oe(Z)})}),w(E(U),"setLocation",function(Z){var oe=U.props.locationChanged;U.setState({expandedToc:!1},function(){return oe&&oe(Z)})}),U.readerRef=e.default.createRef(),U.state={expandedToc:!1,toc:!1},U}return m(X,[{key:"renderToc",value:function(){var U=this,Z=this.state,oe=Z.toc,re=Z.expandedToc,pe=this.props.readerStyles;return e.default.createElement("div",null,e.default.createElement("div",{style:pe.tocArea},e.default.createElement("div",{style:pe.toc},oe.map(function(Te,Ie){return e.default.createElement($,f({},Te,{key:Ie,setLocation:U.setLocation,styles:pe.tocAreaButton}))}))),re&&e.default.createElement("div",{style:pe.tocBackground,onClick:this.toggleToc}))}},{key:"renderTocToggle",value:function(){var U=this.state.expandedToc,Z=this.props.readerStyles;return e.default.createElement("button",{style:Object.assign({},Z.tocButton,U?Z.tocButtonExpanded:{}),onClick:this.toggleToc},e.default.createElement("span",{style:Object.assign({},Z.tocButtonBar,Z.tocButtonBarTop)}),e.default.createElement("span",{style:Object.assign({},Z.tocButtonBar,Z.tocButtonBottom)}))}},{key:"render",value:function(){var U=this.props,Z=U.title,oe=U.showToc,re=U.loadingView,pe=U.readerStyles,Te=U.locationChanged,Ie=U.swipeable,Le=U.epubViewStyles,Oe=O(U,o),Re=this.state,ht=Re.toc,tt=Re.expandedToc;return e.default.createElement("div",{style:pe.container},e.default.createElement("div",{style:Object.assign({},pe.readerArea,tt?pe.containerExpanded:{})},oe&&this.renderTocToggle(),e.default.createElement("div",{style:pe.titleArea},Z),e.default.createElement(V,{onSwipedRight:this.prev,onSwipedLeft:this.next,trackMouse:!0},e.default.createElement("div",{style:pe.reader},e.default.createElement(i.EpubView,f({ref:this.readerRef,loadingView:re,epubViewStyles:Le},Oe,{tocChanged:this.onTocChange,locationChanged:Te})),Ie&&e.default.createElement("div",{style:pe.swipeWrapper}))),e.default.createElement("button",{style:Object.assign({},pe.arrow,pe.prev),onClick:this.prev},"\u2039"),e.default.createElement("button",{style:Object.assign({},pe.arrow,pe.next),onClick:this.next},"\u203A")),oe&&ht&&this.renderToc())}}]),X}(e.PureComponent);ne.defaultProps={loadingView:e.default.createElement("div",{style:s.ReactReaderStyle.loadingView},"Loading\u2026"),locationChanged:null,tocChanged:null,showToc:!0,readerStyles:s.ReactReaderStyle},ne.propTypes={title:t.default.string,loadingView:t.default.element,showToc:t.default.bool,locationChanged:t.default.func,tocChanged:t.default.func,readerStyles:t.default.object,epubViewStyles:t.default.object,swipeable:t.default.bool};var me=ne;return Da.default=me,Da}var Am;function sT(){return Am||(Am=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"EpubView",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(r,"EpubViewStyle",{enumerable:!0,get:function(){return t.EpubViewStyle}}),Object.defineProperty(r,"ReactReader",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(r,"ReactReaderStyle",{enumerable:!0,get:function(){return i.ReactReaderStyle}});var e=s(ku),t=Oo,n=s(aI()),i=No;function s(a){return a&&a.__esModule?a:{default:a}}}(af)),af}var oI=sT();const lI=()=>{const[r,e]=cn.exports.useState(""),t=n=>{e(n)};return $r.createElement("div",{style:{height:"100vh"}},$r.createElement(oI.ReactReader,{location:r,locationChanged:t,url:"https://s3.amazonaws.com/moby-dick/moby-dick.epub"}))};function uI(){return $r.createElement($r.Fragment,null,$r.createElement(nA,null),$r.createElement(lI,null))}Sf.createRoot(document.getElementById("root")).render($r.createElement($r.StrictMode,null,$r.createElement(uI,null)));
