/*! For license information please see index.js.LICENSE.txt */
(()=>{var e,t,n={124:(e,t,n)=>{var i=n(9325);e.exports=function(){return i.Date.now()}},148:(e,t,n)=>{"use strict";var i=n(9762),r=Array.prototype.forEach,s=Object.create;e.exports=function(e){var t=s(null);return r.call(arguments,function(e){i(e)&&function(e,t){var n;for(n in e)t[n]=e[n]}(Object(e),t)}),t}},181:(e,t,n)=>{"use strict";var i=n(8175),r={object:!0,function:!0,undefined:!0};e.exports=function(e){return!!i(e)&&hasOwnProperty.call(r,typeof e)}},188:(e,t,n)=>{"use strict";n.r(t),n.d(t,{DOWN:()=>o,LEFT:()=>r,RIGHT:()=>s,UP:()=>a,useSwipeable:()=>m});var i=n(6540);const r="Left",s="Right",a="Up",o="Down",l={delta:10,preventScrollOnSwipe:!1,rotationAngle:0,trackMouse:!1,trackTouch:!0,swipeDuration:1/0,touchEventOptions:{passive:!0}},c={first:!0,initial:[0,0],start:0,swiping:!1,xy:[0,0]},u="mousemove",h="mouseup",d="touchend",f="touchmove",p="touchstart";function g(e,t){if(0===t)return e;const n=Math.PI/180*t;return[e[0]*Math.cos(n)+e[1]*Math.sin(n),e[1]*Math.cos(n)-e[0]*Math.sin(n)]}function m(e){const{trackMouse:t}=e,n=i.useRef(Object.assign({},c)),m=i.useRef(Object.assign({},l)),v=i.useRef(Object.assign({},m.current));let y;for(y in v.current=Object.assign({},m.current),m.current=Object.assign(Object.assign({},l),e),l)void 0===m.current[y]&&(m.current[y]=l[y]);const[b,E]=i.useMemo(()=>function(e,t){const n=t=>{const n="touches"in t;n&&t.touches.length>1||e((e,r)=>{r.trackMouse&&!n&&(document.addEventListener(u,i),document.addEventListener(h,v));const{clientX:s,clientY:a}=n?t.touches[0]:t,o=g([s,a],r.rotationAngle);return r.onTouchStartOrOnMouseDown&&r.onTouchStartOrOnMouseDown({event:t}),Object.assign(Object.assign(Object.assign({},e),c),{initial:o.slice(),xy:o,start:t.timeStamp||0})})},i=t=>{e((e,n)=>{const i="touches"in t;if(i&&t.touches.length>1)return e;if(t.timeStamp-e.start>n.swipeDuration)return e.swiping?Object.assign(Object.assign({},e),{swiping:!1}):e;const{clientX:c,clientY:u}=i?t.touches[0]:t,[h,d]=g([c,u],n.rotationAngle),f=h-e.xy[0],p=d-e.xy[1],m=Math.abs(f),v=Math.abs(p),y=(t.timeStamp||0)-e.start,b=Math.sqrt(m*m+v*v)/(y||1),E=[f/(y||1),p/(y||1)],S=function(e,t,n,i){return e>t?n>0?s:r:i>0?o:a}(m,v,f,p),w="number"==typeof n.delta?n.delta:n.delta[S.toLowerCase()]||l.delta;if(m<w&&v<w&&!e.swiping)return e;const T={absX:m,absY:v,deltaX:f,deltaY:p,dir:S,event:t,first:e.first,initial:e.initial,velocity:b,vxvy:E};T.first&&n.onSwipeStart&&n.onSwipeStart(T),n.onSwiping&&n.onSwiping(T);let k=!1;return(n.onSwiping||n.onSwiped||n[`onSwiped${S}`])&&(k=!0),k&&n.preventScrollOnSwipe&&n.trackTouch&&t.cancelable&&t.preventDefault(),Object.assign(Object.assign({},e),{first:!1,eventData:T,swiping:!0})})},m=t=>{e((e,n)=>{let i;if(e.swiping&&e.eventData){if(t.timeStamp-e.start<n.swipeDuration){i=Object.assign(Object.assign({},e.eventData),{event:t}),n.onSwiped&&n.onSwiped(i);const r=n[`onSwiped${i.dir}`];r&&r(i)}}else n.onTap&&n.onTap({event:t});return n.onTouchEndOrOnMouseUp&&n.onTouchEndOrOnMouseUp({event:t}),Object.assign(Object.assign(Object.assign({},e),c),{eventData:i})})},v=e=>{document.removeEventListener(u,i),document.removeEventListener(h,v),m(e)},y=(e,t)=>{let r=()=>{};if(e&&e.addEventListener){const s=Object.assign(Object.assign({},l.touchEventOptions),t.touchEventOptions),a=[[p,n,s],[f,i,Object.assign(Object.assign({},s),t.preventScrollOnSwipe?{passive:!1}:{})],[d,m,s]];a.forEach(([t,n,i])=>e.addEventListener(t,n,i)),r=()=>a.forEach(([t,n])=>e.removeEventListener(t,n))}return r},b={ref:t=>{null!==t&&e((e,n)=>{if(e.el===t)return e;const i={};return e.el&&e.el!==t&&e.cleanUpTouch&&(e.cleanUpTouch(),i.cleanUpTouch=void 0),n.trackTouch&&t&&(i.cleanUpTouch=y(t,n)),Object.assign(Object.assign(Object.assign({},e),{el:t}),i)})}};return t.trackMouse&&(b.onMouseDown=n),[b,y]}(e=>n.current=e(n.current,m.current),{trackMouse:t}),[t]);return n.current=function(e,t,n,i){return t.trackTouch&&e.el?e.cleanUpTouch?t.preventScrollOnSwipe!==n.preventScrollOnSwipe||t.touchEventOptions.passive!==n.touchEventOptions.passive?(e.cleanUpTouch(),Object.assign(Object.assign({},e),{cleanUpTouch:i(e.el,t)})):e:Object.assign(Object.assign({},e),{cleanUpTouch:i(e.el,t)}):(e.cleanUpTouch&&e.cleanUpTouch(),Object.assign(Object.assign({},e),{cleanUpTouch:void 0}))}(n.current,m.current,v.current,E),b}},194:(e,t,n)=>{"use strict";e.exports=n(8731)},214:(e,t,n)=>{"use strict";e.exports=n(525)()?String.prototype.contains:n(1521)},327:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!==c(e)&&"function"!=typeof e)return{default:e};var n=l(t);if(n&&n.has(e))return n.get(e);var i={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var a=r?Object.getOwnPropertyDescriptor(e,s):null;a&&(a.get||a.set)?Object.defineProperty(i,s,a):i[s]=e[s]}return i.default=e,n&&n.set(e,i),i}(n(6540)),r=o(n(5556)),s=o(n(3184)),a=n(5487);function o(e){return e&&e.__esModule?e:{default:e}}function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(l=function(e){return e?n:t})(e)}function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function h(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,m(i.key),i)}}function d(e,t){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},d(e,t)}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}function g(e,t,n){return(t=m(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m(e){var t=function(e){if("object"!==c(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!==c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===c(t)?t:String(t)}var v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(l,e);var t,n,r,a,o=(r=l,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,t=p(r);if(a){var n=p(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===c(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return f(e)}(this,e)});function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),g(f(t=o.call(this,e)),"onLocationChange",function(e){var n=t.props,i=n.location,r=n.locationChanged,s=e&&e.start;i!==s&&(t.location=s,r&&r(s))}),g(f(t),"handleKeyPress",function(e){var n=e.key;n&&"ArrowRight"===n&&t.nextPage(),n&&"ArrowLeft"===n&&t.prevPage()}),t.state={isLoaded:!1,toc:[]},t.viewerRef=i.default.createRef(),t.location=e.location,t.book=t.rendition=t.prevPage=t.nextPage=null,t}return t=l,n=[{key:"componentDidMount",value:function(){this.initBook(!0),document.addEventListener("keyup",this.handleKeyPress,!1)}},{key:"initBook",value:function(){var e=this,t=this.props,n=t.url,i=t.tocChanged,r=t.epubInitOptions;this.book&&this.book.destroy(),this.book=new s.default(n,r),this.book.loaded.navigation.then(function(t){var n=t.toc;e.setState({isLoaded:!0,toc:n},function(){i&&i(n),e.initReader()})})}},{key:"componentWillUnmount",value:function(){this.book&&this.book.destroy(),this.book=this.rendition=this.prevPage=this.nextPage=null,document.removeEventListener("keyup",this.handleKeyPress,!1)}},{key:"shouldComponentUpdate",value:function(e){return!this.state.isLoaded||e.location!==this.props.location||e.url!==this.props.url}},{key:"componentDidUpdate",value:function(e){e.location!==this.props.location&&this.location!==this.props.location&&this.rendition.display(this.props.location),e.url!==this.props.url&&this.initBook()}},{key:"initReader",value:function(){var e=this,t=this.state.toc,n=this.props,i=n.location,r=n.epubOptions,s=n.getRendition,a=this.viewerRef.current;this.rendition=this.book.renderTo(a,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach(function(t){g(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({contained:!0,width:"100%",height:"100%"},r)),this.prevPage=function(){e.rendition.prev()},this.nextPage=function(){e.rendition.next()},this.registerEvents(),s&&s(this.rendition),"string"==typeof i||"number"==typeof i?this.rendition.display(i):t.length>0&&t[0].href?this.rendition.display(t[0].href):this.rendition.display()}},{key:"registerEvents",value:function(){var e=this.props,t=e.handleKeyPress,n=e.handleTextSelected;this.rendition.on("locationChanged",this.onLocationChange),this.rendition.on("keyup",t||this.handleKeyPress),n&&this.rendition.on("selected",n)}},{key:"renderBook",value:function(){var e=this.props.epubViewStyles;return i.default.createElement("div",{ref:this.viewerRef,style:e.view})}},{key:"render",value:function(){var e=this.state.isLoaded,t=this.props,n=t.loadingView,r=t.epubViewStyles;return i.default.createElement("div",{style:r.viewHolder},e&&this.renderBook()||n)}}],n&&h(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(i.Component);v.defaultProps={loadingView:null,locationChanged:null,tocChanged:null,epubViewStyles:a.EpubViewStyle,epubOptions:{},epubInitOptions:{}},v.propTypes={url:r.default.oneOfType([r.default.string,r.default.instanceOf(ArrayBuffer)]),loadingView:r.default.element,location:r.default.oneOfType([r.default.string,r.default.number]),locationChanged:r.default.func,tocChanged:r.default.func,epubViewStyles:r.default.object,epubInitOptions:r.default.object,epubOptions:r.default.object,getRendition:r.default.func,handleKeyPress:r.default.func,handleTextSelected:r.default.func};var y=v;t.default=y},334:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReactReaderStyle=void 0,t.ReactReaderStyle={container:{overflow:"hidden",position:"relative",height:"100%"},readerArea:{position:"relative",zIndex:1,height:"100%",width:"100%",backgroundColor:"#fff",transition:"all .3s ease"},containerExpanded:{transform:"translateX(256px)"},titleArea:{position:"absolute",top:20,left:50,right:50,textAlign:"center",color:"#999"},reader:{position:"absolute",top:50,left:50,bottom:20,right:50},swipeWrapper:{position:"absolute",top:0,left:0,bottom:0,right:0,zIndex:200},prev:{left:1},next:{right:1},arrow:{outline:"none",border:"none",background:"none",position:"absolute",top:"50%",marginTop:-32,fontSize:64,padding:"0 10px",color:"#E2E2E2",fontFamily:"arial, sans-serif",cursor:"pointer",userSelect:"none",appearance:"none",fontWeight:"normal"},arrowHover:{color:"#777"},tocBackground:{position:"absolute",left:256,top:0,bottom:0,right:0,zIndex:1},tocArea:{position:"absolute",left:0,top:0,bottom:0,zIndex:0,width:256,overflowY:"auto",WebkitOverflowScrolling:"touch",background:"#f2f2f2",padding:"10px 0"},tocAreaButton:{userSelect:"none",appearance:"none",background:"none",border:"none",display:"block",fontFamily:"sans-serif",width:"100%",fontSize:".9em",textAlign:"left",padding:".9em 1em",borderBottom:"1px solid #ddd",color:"#aaa",boxSizing:"border-box",outline:"none",cursor:"pointer"},tocButton:{background:"none",border:"none",width:32,height:32,position:"absolute",top:10,left:10,borderRadius:2,outline:"none",cursor:"pointer"},tocButtonExpanded:{background:"#f2f2f2"},tocButtonBar:{position:"absolute",width:"60%",background:"#ccc",height:2,left:"50%",margin:"-1px -30%",top:"50%",transition:"all .5s ease"},tocButtonBarTop:{top:"35%"},tocButtonBottom:{top:"66%"},loadingView:{position:"absolute",top:"50%",left:"10%",right:"10%",color:"#ccc",textAlign:"center",margintop:"-.5em"}}},346:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},429:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.replaceBase=function(e,t){var n,r,s=t.url,a=s.indexOf("://")>-1;e&&(r=(0,i.qs)(e,"head"),(n=(0,i.qs)(r,"base"))||(n=e.createElement("base"),r.insertBefore(n,r.firstChild)),!a&&window&&window.location&&(s=window.location.origin+s),n.setAttribute("href",s))},t.replaceCanonical=function(e,t){var n,r,s=t.canonical;e&&(n=(0,i.qs)(e,"head"),(r=(0,i.qs)(n,"link[rel='canonical']"))?r.setAttribute("href",s):((r=e.createElement("link")).setAttribute("rel","canonical"),r.setAttribute("href",s),n.appendChild(r)))},t.replaceLinks=function(e,t){var n=e.querySelectorAll("a[href]");if(n.length)for(var s=(0,i.qs)(e.ownerDocument,"base"),a=s?s.getAttribute("href"):void 0,o=function(e){var n=e.getAttribute("href");if(0!==n.indexOf("mailto:"))if(n.indexOf("://")>-1)e.setAttribute("target","_blank");else{var i;try{i=new r.default(n,a)}catch(e){}e.onclick=function(){return i&&i.hash?t(i.Path.path+i.hash):t(i?i.Path.path:n),!1}}}.bind(this),l=0;l<n.length;l++)o(n[l])},t.replaceMeta=function(e,t){var n,r,s=t.idref;e&&(n=(0,i.qs)(e,"head"),(r=(0,i.qs)(n,"link[property='dc.identifier']"))?r.setAttribute("content",s):((r=e.createElement("meta")).setAttribute("name","dc.identifier"),r.setAttribute("content",s),n.appendChild(r)))},t.substitute=function(e,t,n){return t.forEach(function(t,i){t&&n[i]&&(t=t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),e=e.replace(new RegExp(t,"g"),n[i]))}),e};var i=n(3575),r=s(n(2259));function s(e){return e&&e.__esModule?e:{default:e}}s(n(3859))},525:e=>{"use strict";var t="razdwatrzy";e.exports=function(){return"function"==typeof t.contains&&!0===t.contains("dwa")&&!1===t.contains("foo")}},540:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},659:(e,t,n)=>{var i=n(1873),r=Object.prototype,s=r.hasOwnProperty,a=r.toString,o=i?i.toStringTag:void 0;e.exports=function(e){var t=s.call(e,o),n=e[o];try{e[o]=void 0;var i=!0}catch(e){}var r=a.call(e);return i&&(t?e[o]=n:delete e[o]),r}},721:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(3575),r=l(n(7983)),s=l(n(3463)),a=n(4083),o=l(n(8221));function l(e){return e&&e.__esModule?e:{default:e}}class c extends r.default{constructor(e){super(e),this.name="continuous",this.settings=(0,i.extend)(this.settings||{},{infinite:!0,overflow:void 0,axis:void 0,writingMode:void 0,flow:"scrolled",offset:500,offsetDelta:250,width:void 0,height:void 0,snap:!1,afterScrolledTimeout:10,allowScriptedContent:!1,allowPopups:!1}),(0,i.extend)(this.settings,e.settings||{}),"undefined"!=e.settings.gap&&0===e.settings.gap&&(this.settings.gap=e.settings.gap),this.viewSettings={ignoreClass:this.settings.ignoreClass,axis:this.settings.axis,flow:this.settings.flow,layout:this.layout,width:0,height:0,forceEvenPages:!1,allowScriptedContent:this.settings.allowScriptedContent,allowPopups:this.settings.allowPopups},this.scrollTop=0,this.scrollLeft=0}display(e,t){return r.default.prototype.display.call(this,e,t).then(function(){return this.fill()}.bind(this))}fill(e){var t=e||new i.defer;return this.q.enqueue(()=>this.check()).then(e=>{e?this.fill(t):t.resolve()}),t.promise}moveTo(e){var t=0,n=0;this.isPaginated?(t=Math.floor(e.left/this.layout.delta)*this.layout.delta,this.settings.offsetDelta):(n=e.top,e.top,this.settings.offsetDelta),(t>0||n>0)&&this.scrollBy(t,n,!0)}afterResized(e){this.emit(a.EVENTS.MANAGERS.RESIZE,e.section)}removeShownListeners(e){e.onDisplayed=function(){}}add(e){var t=this.createView(e);return this.views.append(t),t.on(a.EVENTS.VIEWS.RESIZED,e=>{t.expanded=!0}),t.on(a.EVENTS.VIEWS.AXIS,e=>{this.updateAxis(e)}),t.on(a.EVENTS.VIEWS.WRITING_MODE,e=>{this.updateWritingMode(e)}),t.onDisplayed=this.afterDisplayed.bind(this),t.onResize=this.afterResized.bind(this),t.display(this.request)}append(e){var t=this.createView(e);return t.on(a.EVENTS.VIEWS.RESIZED,e=>{t.expanded=!0}),t.on(a.EVENTS.VIEWS.AXIS,e=>{this.updateAxis(e)}),t.on(a.EVENTS.VIEWS.WRITING_MODE,e=>{this.updateWritingMode(e)}),this.views.append(t),t.onDisplayed=this.afterDisplayed.bind(this),t}prepend(e){var t=this.createView(e);return t.on(a.EVENTS.VIEWS.RESIZED,e=>{this.counter(e),t.expanded=!0}),t.on(a.EVENTS.VIEWS.AXIS,e=>{this.updateAxis(e)}),t.on(a.EVENTS.VIEWS.WRITING_MODE,e=>{this.updateWritingMode(e)}),this.views.prepend(t),t.onDisplayed=this.afterDisplayed.bind(this),t}counter(e){"vertical"===this.settings.axis?this.scrollBy(0,e.heightDelta,!0):this.scrollBy(e.widthDelta,0,!0)}update(e){for(var t,n=this.bounds(),r=this.views.all(),s=r.length,a=[],o=void 0!==e?e:this.settings.offset||0,l=new i.defer,c=[],u=0;u<s;u++)if(t=r[u],!0===this.isVisible(t,o,o,n)){if(t.displayed)t.show();else{let e=t.display(this.request).then(function(e){e.show()},e=>{t.hide()});c.push(e)}a.push(t)}else this.q.enqueue(t.destroy.bind(t)),clearTimeout(this.trimTimeout),this.trimTimeout=setTimeout(function(){this.q.enqueue(this.trim.bind(this))}.bind(this),250);return c.length?Promise.all(c).catch(e=>{l.reject(e)}):(l.resolve(),l.promise)}check(e,t){var n=new i.defer,r=[],s="horizontal"===this.settings.axis,a=this.settings.offset||0;e&&s&&(a=e),t&&!s&&(a=t);var o=this._bounds;let l=s?this.scrollLeft:this.scrollTop,c=s?Math.floor(o.width):o.height,u=s?this.container.scrollWidth:this.container.scrollHeight,h=this.writingMode&&0===this.writingMode.indexOf("vertical")?"vertical":"horizontal",d=this.settings.rtlScrollType,f="rtl"===this.settings.direction;this.settings.fullsize?(s&&f&&"negative"===d||!s&&f&&"default"===d)&&(l*=-1):(f&&"default"===d&&"horizontal"===h&&(l=u-c-l),f&&"negative"===d&&"horizontal"===h&&(l*=-1));let p=l-a;l+c+a>=u&&(()=>{let e=this.views.last(),t=e&&e.section.next();t&&r.push(this.append(t))})(),p<0&&(()=>{let e=this.views.first(),t=e&&e.section.prev();t&&r.push(this.prepend(t))})();let g=r.map(e=>e.display(this.request));return r.length?Promise.all(g).then(()=>this.check()).then(()=>this.update(a),e=>e):(this.q.enqueue(function(){this.update()}.bind(this)),n.resolve(!1),n.promise)}trim(){for(var e=new i.defer,t=this.views.displayed(),n=t[0],r=t[t.length-1],s=this.views.indexOf(n),a=this.views.indexOf(r),o=this.views.slice(0,s),l=this.views.slice(a+1),c=0;c<o.length-1;c++)this.erase(o[c],o);for(var u=1;u<l.length;u++)this.erase(l[u]);return e.resolve(),e.promise}erase(e,t){var n,i;this.settings.fullsize?(n=window.scrollY,i=window.scrollX):(n=this.container.scrollTop,i=this.container.scrollLeft);var r=e.bounds();this.views.remove(e),t&&("vertical"===this.settings.axis?this.scrollTo(0,n-r.height,!0):"rtl"===this.settings.direction?this.settings.fullsize?this.scrollTo(i+Math.floor(r.width),0,!0):this.scrollTo(i,0,!0):this.scrollTo(i-Math.floor(r.width),0,!0))}addEventListeners(e){window.addEventListener("unload",function(e){this.ignore=!0,this.destroy()}.bind(this)),this.addScrollListeners(),this.isPaginated&&this.settings.snap&&(this.snapper=new s.default(this,this.settings.snap&&"object"==typeof this.settings.snap&&this.settings.snap))}addScrollListeners(){var e;this.tick=i.requestAnimationFrame;let t="rtl"===this.settings.direction&&"default"===this.settings.rtlScrollType?-1:1;this.scrollDeltaVert=0,this.scrollDeltaHorz=0,this.settings.fullsize?(e=window,this.scrollTop=window.scrollY*t,this.scrollLeft=window.scrollX*t):(e=this.container,this.scrollTop=this.container.scrollTop,this.scrollLeft=this.container.scrollLeft),this._onScroll=this.onScroll.bind(this),e.addEventListener("scroll",this._onScroll),this._scrolled=(0,o.default)(this.scrolled.bind(this),30),this.didScroll=!1}removeEventListeners(){(this.settings.fullsize?window:this.container).removeEventListener("scroll",this._onScroll),this._onScroll=void 0}onScroll(){let e,t,n="rtl"===this.settings.direction&&"default"===this.settings.rtlScrollType?-1:1;this.settings.fullsize?(e=window.scrollY*n,t=window.scrollX*n):(e=this.container.scrollTop,t=this.container.scrollLeft),this.scrollTop=e,this.scrollLeft=t,this.ignore?this.ignore=!1:this._scrolled(),this.scrollDeltaVert+=Math.abs(e-this.prevScrollTop),this.scrollDeltaHorz+=Math.abs(t-this.prevScrollLeft),this.prevScrollTop=e,this.prevScrollLeft=t,clearTimeout(this.scrollTimeout),this.scrollTimeout=setTimeout(function(){this.scrollDeltaVert=0,this.scrollDeltaHorz=0}.bind(this),150),clearTimeout(this.afterScrolled),this.didScroll=!1}scrolled(){this.q.enqueue(function(){return this.check()}.bind(this)),this.emit(a.EVENTS.MANAGERS.SCROLL,{top:this.scrollTop,left:this.scrollLeft}),clearTimeout(this.afterScrolled),this.afterScrolled=setTimeout(function(){this.snapper&&this.snapper.supportsTouch&&this.snapper.needsSnap()||this.emit(a.EVENTS.MANAGERS.SCROLLED,{top:this.scrollTop,left:this.scrollLeft})}.bind(this),this.settings.afterScrolledTimeout)}next(){let e="pre-paginated"===this.layout.props.name&&this.layout.props.spread?2*this.layout.props.delta:this.layout.props.delta;this.views.length&&(this.isPaginated&&"horizontal"===this.settings.axis?this.scrollBy(e,0,!0):this.scrollBy(0,this.layout.height,!0),this.q.enqueue(function(){return this.check()}.bind(this)))}prev(){let e="pre-paginated"===this.layout.props.name&&this.layout.props.spread?2*this.layout.props.delta:this.layout.props.delta;this.views.length&&(this.isPaginated&&"horizontal"===this.settings.axis?this.scrollBy(-e,0,!0):this.scrollBy(0,-this.layout.height,!0),this.q.enqueue(function(){return this.check()}.bind(this)))}updateFlow(e){this.rendered&&this.snapper&&(this.snapper.destroy(),this.snapper=void 0),super.updateFlow(e,"scroll"),this.rendered&&this.isPaginated&&this.settings.snap&&(this.snapper=new s.default(this,this.settings.snap&&"object"==typeof this.settings.snap&&this.settings.snap))}destroy(){super.destroy(),this.snapper&&this.snapper.destroy()}}var u=c;t.default=u},771:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(3575);t.default=class{constructor(e){this.manifest={},this.navPath="",this.ncxPath="",this.coverPath="",this.spineNodeIndex=0,this.spine=[],this.metadata={},e&&this.parse(e)}parse(e){var t,n,r;if(!e)throw new Error("Package File Not Found");if(!(t=(0,i.qs)(e,"metadata")))throw new Error("No Metadata Found");if(!(n=(0,i.qs)(e,"manifest")))throw new Error("No Manifest Found");if(!(r=(0,i.qs)(e,"spine")))throw new Error("No Spine Found");return this.manifest=this.parseManifest(n),this.navPath=this.findNavPath(n),this.ncxPath=this.findNcxPath(n,r),this.coverPath=this.findCoverPath(e),this.spineNodeIndex=(0,i.indexOfElementNode)(r),this.spine=this.parseSpine(r,this.manifest),this.uniqueIdentifier=this.findUniqueIdentifier(e),this.metadata=this.parseMetadata(t),this.metadata.direction=r.getAttribute("page-progression-direction"),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex}}parseMetadata(e){var t={};return t.title=this.getElementText(e,"title"),t.creator=this.getElementText(e,"creator"),t.description=this.getElementText(e,"description"),t.pubdate=this.getElementText(e,"date"),t.publisher=this.getElementText(e,"publisher"),t.identifier=this.getElementText(e,"identifier"),t.language=this.getElementText(e,"language"),t.rights=this.getElementText(e,"rights"),t.modified_date=this.getPropertyText(e,"dcterms:modified"),t.layout=this.getPropertyText(e,"rendition:layout"),t.orientation=this.getPropertyText(e,"rendition:orientation"),t.flow=this.getPropertyText(e,"rendition:flow"),t.viewport=this.getPropertyText(e,"rendition:viewport"),t.media_active_class=this.getPropertyText(e,"media:active-class"),t.spread=this.getPropertyText(e,"rendition:spread"),t}parseManifest(e){var t={},n=(0,i.qsa)(e,"item");return Array.prototype.slice.call(n).forEach(function(e){var n=e.getAttribute("id"),i=e.getAttribute("href")||"",r=e.getAttribute("media-type")||"",s=e.getAttribute("media-overlay")||"",a=e.getAttribute("properties")||"";t[n]={href:i,type:r,overlay:s,properties:a.length?a.split(" "):[]}}),t}parseSpine(e,t){var n=[],r=(0,i.qsa)(e,"itemref");return Array.prototype.slice.call(r).forEach(function(e,t){var i=e.getAttribute("idref"),r=e.getAttribute("properties")||"",s=r.length?r.split(" "):[],a={id:e.getAttribute("id"),idref:i,linear:e.getAttribute("linear")||"yes",properties:s,index:t};n.push(a)}),n}findUniqueIdentifier(e){var t=e.documentElement.getAttribute("unique-identifier");if(!t)return"";var n=e.getElementById(t);return n&&"identifier"===n.localName&&"http://purl.org/dc/elements/1.1/"===n.namespaceURI&&n.childNodes.length>0?n.childNodes[0].nodeValue.trim():""}findNavPath(e){var t=(0,i.qsp)(e,"item",{properties:"nav"});return!!t&&t.getAttribute("href")}findNcxPath(e,t){var n,r=(0,i.qsp)(e,"item",{"media-type":"application/x-dtbncx+xml"});return r||(n=t.getAttribute("toc"))&&(r=e.querySelector(`#${n}`)),!!r&&r.getAttribute("href")}findCoverPath(e){(0,i.qs)(e,"package").getAttribute("version");var t=(0,i.qsp)(e,"item",{properties:"cover-image"});if(t)return t.getAttribute("href");var n=(0,i.qsp)(e,"meta",{name:"cover"});if(n){var r=n.getAttribute("content"),s=e.getElementById(r);return s?s.getAttribute("href"):""}return!1}getElementText(e,t){var n,i=e.getElementsByTagNameNS("http://purl.org/dc/elements/1.1/",t);return i&&0!==i.length&&(n=i[0]).childNodes.length?n.childNodes[0].nodeValue:""}getPropertyText(e,t){var n=(0,i.qsp)(e,"meta",{property:t});return n&&n.childNodes.length?n.childNodes[0].nodeValue:""}load(e){this.metadata=e.metadata;let t=e.readingOrder||e.spine;return this.spine=t.map((e,t)=>(e.index=t,e.linear=e.linear||"yes",e)),e.resources.forEach((e,t)=>{this.manifest[t]=e,e.rel&&"cover"===e.rel[0]&&(this.coverPath=e.href)}),this.spineNodeIndex=0,this.toc=e.toc.map((e,t)=>(e.label=e.title,e)),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex,toc:this.toc}}destroy(){this.manifest=void 0,this.navPath=void 0,this.ncxPath=void 0,this.coverPath=void 0,this.spineNodeIndex=void 0,this.spine=void 0,this.metadata=void 0}}},961:(e,t,n)=>{"use strict";!function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(e){console.error(e)}}(),e.exports=n(2551)},1020:(e,t,n)=>{"use strict";var i=n(6540),r=Symbol.for("react.element"),s=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,o=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var i,s={},c=null,u=null;for(i in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)a.call(t,i)&&!l.hasOwnProperty(i)&&(s[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps)void 0===s[i]&&(s[i]=t[i]);return{$$typeof:r,type:e,key:c,ref:u,props:s,_owner:o.current}}t.Fragment=s,t.jsx=c,t.jsxs=c},1029:(e,t,n)=>{"use strict";n.d(t,{A:()=>d});var i=n(1601),r=n.n(i),s=n(6314),a=n.n(s),o=n(4417),l=n.n(o),c=new URL(n(6025),n.b),u=a()(r()),h=l()(c);u.push([e.id,`.star {\n  display: inline-block;\n  background: url(${h}) no-repeat;\n  width: 55px;\n  height: 11px;\n  margin: 0 3px 0 0;\n  overflow: hidden;\n  margin-top: 10px;\n}\n.star50 {\n  background-position: 0 0px;\n}\n.star45 {\n  background-position: 0 -11px;\n}\n.star40 {\n  background-position: 0 -22px;\n}\n.star35 {\n  background-position: 0 -33px;\n}\n.star30 {\n  background-position: 0 -44px;\n}\n.star25 {\n  background-position: 0 -55px;\n}\n.star20 {\n  background-position: 0 -66px;\n}\n.star15 {\n  background-position: 0 -77px;\n}\n.star10 {\n  background-position: 0 -88px;\n}\n.star5 {\n  background-position: 0 -99px;\n}\n`,""]);const d=u},1081:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var i=n(1601),r=n.n(i),s=n(6314),a=n.n(s)()(r());a.push([e.id,"main {\n  text-align: center;\n  vertical-align: center;\n  line-height: 100vh;\n}\n",""]);const o=a},1106:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var i=n(1601),r=n.n(i),s=n(6314),a=n.n(s)()(r());a.push([e.id,".simple-card {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n}\n.simple-card .cover {\n  display: block;\n  cursor: pointer;\n}\n.simple-card .title {\n  color: #555;\n  cursor: pointer;\n}\n.simple-card .title:hover {\n  color: #ec2d7a;\n}\n",""]);const o=a},1113:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},1521:e=>{"use strict";var t=String.prototype.indexOf;e.exports=function(e){return t.call(this,e,arguments[1])>-1}},1601:e=>{"use strict";e.exports=function(e){return e[1]}},1800:e=>{var t=/\s/;e.exports=function(e){for(var n=e.length;n--&&t.test(e.charAt(n)););return n}},1832:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n={application:{ecmascript:["es","ecma"],javascript:"js",ogg:"ogx",pdf:"pdf",postscript:["ps","ai","eps","epsi","epsf","eps2","eps3"],"rdf+xml":"rdf",smil:["smi","smil"],"xhtml+xml":["xhtml","xht"],xml:["xml","xsl","xsd","opf","ncx"],zip:"zip","x-httpd-eruby":"rhtml","x-latex":"latex","x-maker":["frm","maker","frame","fm","fb","book","fbdoc"],"x-object":"o","x-shockwave-flash":["swf","swfl"],"x-silverlight":"scr","epub+zip":"epub","font-tdpfr":"pfr","inkml+xml":["ink","inkml"],json:"json","jsonml+json":"jsonml","mathml+xml":"mathml","metalink+xml":"metalink",mp4:"mp4s","omdoc+xml":"omdoc",oxps:"oxps","vnd.amazon.ebook":"azw",widget:"wgt","x-dtbook+xml":"dtb","x-dtbresource+xml":"res","x-font-bdf":"bdf","x-font-ghostscript":"gsf","x-font-linux-psf":"psf","x-font-otf":"otf","x-font-pcf":"pcf","x-font-snf":"snf","x-font-ttf":["ttf","ttc"],"x-font-type1":["pfa","pfb","pfm","afm"],"x-font-woff":"woff","x-mobipocket-ebook":["prc","mobi"],"x-mspublisher":"pub","x-nzb":"nzb","x-tgif":"obj","xaml+xml":"xaml","xml-dtd":"dtd","xproc+xml":"xpl","xslt+xml":"xslt","internet-property-stream":"acx","x-compress":"z","x-compressed":"tgz","x-gzip":"gz"},audio:{flac:"flac",midi:["mid","midi","kar","rmi"],mpeg:["mpga","mpega","mp2","mp3","m4a","mp2a","m2a","m3a"],mpegurl:"m3u",ogg:["oga","ogg","spx"],"x-aiff":["aif","aiff","aifc"],"x-ms-wma":"wma","x-wav":"wav",adpcm:"adp",mp4:"mp4a",webm:"weba","x-aac":"aac","x-caf":"caf","x-matroska":"mka","x-pn-realaudio-plugin":"rmp",xm:"xm",mid:["mid","rmi"]},image:{gif:"gif",ief:"ief",jpeg:["jpeg","jpg","jpe"],pcx:"pcx",png:"png","svg+xml":["svg","svgz"],tiff:["tiff","tif"],"x-icon":"ico",bmp:"bmp",webp:"webp","x-pict":["pic","pct"],"x-tga":"tga","cis-cod":"cod"},text:{"cache-manifest":["manifest","appcache"],css:"css",csv:"csv",html:["html","htm","shtml","stm"],mathml:"mml",plain:["txt","text","brf","conf","def","list","log","in","bas"],richtext:"rtx","tab-separated-values":"tsv","x-bibtex":"bib"},video:{mpeg:["mpeg","mpg","mpe","m1v","m2v","mp2","mpa","mpv2"],mp4:["mp4","mp4v","mpg4"],quicktime:["qt","mov"],ogg:"ogv","vnd.mpegurl":["mxu","m4u"],"x-flv":"flv","x-la-asf":["lsf","lsx"],"x-mng":"mng","x-ms-asf":["asf","asx","asr"],"x-ms-wm":"wm","x-ms-wmv":"wmv","x-ms-wmx":"wmx","x-ms-wvx":"wvx","x-msvideo":"avi","x-sgi-movie":"movie","x-matroska":["mpv","mkv","mk3d","mks"],"3gpp2":"3g2",h261:"h261",h263:"h263",h264:"h264",jpeg:"jpgv",jpm:["jpm","jpgm"],mj2:["mj2","mjp2"],"vnd.ms-playready.media.pyv":"pyv","vnd.uvvu.mp4":["uvu","uvvu"],"vnd.vivo":"viv",webm:"webm","x-f4v":"f4v","x-m4v":"m4v","x-ms-vob":"vob","x-smv":"smv"}},i=function(){var e,t,i,r,s={};for(e in n)if(n.hasOwnProperty(e))for(t in n[e])if(n[e].hasOwnProperty(t))if("string"==typeof(i=n[e][t]))s[i]=e+"/"+t;else for(r=0;r<i.length;r++)s[i[r]]=e+"/"+t;return s}(),r={lookup:function(e){return e&&i[e.split(".").pop().toLowerCase()]||"text/plain"}};t.default=r},1873:(e,t,n)=>{var i=n(9325).Symbol;e.exports=i},2054:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var i=n(1601),r=n.n(i),s=n(6314),a=n.n(s)()(r());a.push([e.id,'.category {\n  display: flex;\n  justify-content: space-around;\n  list-style: none;\n  font-size: 18px;\n  padding: 20px 0px;\n}\n.category li {\n  cursor: pointer;\n}\n.category .active {\n  color: #ec2d7a;\n  position: relative;\n}\n.category .active::after {\n  content: "";\n  position: absolute;\n  bottom: -10px;\n  left: 50%;\n  margin-left: -9px;\n  width: 18px;\n  height: 2px;\n  background-color: #ec2d7a;\n}\n',""]);const o=a},2093:(e,t,n)=>{"use strict";e.exports=n(3380)()?Object.keys:n(4232)},2161:(e,t)=>{"use strict";function n(e,t){function n(n){for(var s=t.length-1;s>=0;s--){var a=t[s],o=n.clientX,l=n.clientY;if(n.touches&&n.touches.length&&(o=n.touches[0].clientX,l=n.touches[0].clientY),r(a,e,o,l)){a.dispatchEvent(i(n));break}}}if("iframe"===e.nodeName||"IFRAME"===e.nodeName)try{this.target=e.contentDocument}catch(t){this.target=e}else this.target=e;for(var s=["mouseup","mousedown","click","touchstart"],a=0;a<s.length;a++){var o=s[a];this.target.addEventListener(o,function(e){return n(e)},!1)}}function i(e){var t=Object.assign({},e,{bubbles:!1});try{return new MouseEvent(e.type,t)}catch(i){var n=document.createEvent("MouseEvents");return n.initMouseEvent(e.type,!1,t.cancelable,t.view,t.detail,t.screenX,t.screenY,t.clientX,t.clientY,t.ctrlKey,t.altKey,t.shiftKey,t.metaKey,t.button,t.relatedTarget),n}}function r(e,t,n,i){var r=t.getBoundingClientRect();function s(e,t,n){var i=e.top-r.top,s=e.left-r.left,a=i+e.height,o=s+e.width;return i<=n&&s<=t&&a>n&&o>t}if(!s(e.getBoundingClientRect(),n,i))return!1;for(var a=e.getClientRects(),o=0,l=a.length;o<l;o++)if(s(a[o],n,i))return!0;return!1}Object.defineProperty(t,"__esModule",{value:!0}),t.proxyMouse=n,t.clone=i,t.default={proxyMouse:n}},2222:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(3575),r=l(n(8779)),s=l(n(1832)),a=l(n(3859)),o=l(n(9932));function l(e){return e&&e.__esModule?e:{default:e}}t.default=class{constructor(){this.zip=void 0,this.urlCache={},this.checkRequirements()}checkRequirements(){try{this.zip=new o.default}catch(e){throw new Error("JSZip lib not loaded")}}open(e,t){return this.zip.loadAsync(e,{base64:t})}openUrl(e,t){return(0,r.default)(e,"binary").then(function(e){return this.zip.loadAsync(e,{base64:t})}.bind(this))}request(e,t){var n,r=new i.defer,s=new a.default(e);return t||(t=s.extension),(n="blob"==t?this.getBlob(e):this.getText(e))?n.then(function(e){let n=this.handleResponse(e,t);r.resolve(n)}.bind(this)):r.reject({message:"File not found in the epub: "+e,stack:(new Error).stack}),r.promise}handleResponse(e,t){return"json"==t?JSON.parse(e):(0,i.isXml)(t)?(0,i.parse)(e,"text/xml"):"xhtml"==t?(0,i.parse)(e,"application/xhtml+xml"):"html"==t||"htm"==t?(0,i.parse)(e,"text/html"):e}getBlob(e,t){var n=window.decodeURIComponent(e.substr(1)),i=this.zip.file(n);if(i)return t=t||s.default.lookup(i.name),i.async("uint8array").then(function(e){return new Blob([e],{type:t})})}getText(e,t){var n=window.decodeURIComponent(e.substr(1)),i=this.zip.file(n);if(i)return i.async("string").then(function(e){return e})}getBase64(e,t){var n=window.decodeURIComponent(e.substr(1)),i=this.zip.file(n);if(i)return t=t||s.default.lookup(i.name),i.async("base64").then(function(e){return"data:"+t+";base64,"+e})}createUrl(e,t){var n,r,s=new i.defer,a=window.URL||window.webkitURL||window.mozURL,o=t&&t.base64;return e in this.urlCache?(s.resolve(this.urlCache[e]),s.promise):(o?(r=this.getBase64(e))&&r.then(function(t){this.urlCache[e]=t,s.resolve(t)}.bind(this)):(r=this.getBlob(e))&&r.then(function(t){n=a.createObjectURL(t),this.urlCache[e]=n,s.resolve(n)}.bind(this)),r||s.reject({message:"File not found in the epub: "+e,stack:(new Error).stack}),s.promise)}revokeUrl(e){var t=window.URL||window.webkitURL||window.mozURL,n=this.urlCache[e];n&&t.revokeObjectURL(n)}destroy(){var e=window.URL||window.webkitURL||window.mozURL;for(let t in this.urlCache)e.revokeObjectURL(t);this.zip=void 0,this.urlCache={}}}},2259:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(n(3859)),r=s(n(6841));function s(e){return e&&e.__esModule?e:{default:e}}t.default=class{constructor(e,t){var n=e.indexOf("://")>-1,r=e;if(this.Url=void 0,this.href=e,this.protocol="",this.origin="",this.hash="",this.hash="",this.search="",this.base=t,!n&&!1!==t&&"string"!=typeof t&&window&&window.location&&(this.base=window.location.href),n||this.base)try{this.base?this.Url=new URL(e,this.base):this.Url=new URL(e),this.href=this.Url.href,this.protocol=this.Url.protocol,this.origin=this.Url.origin,this.hash=this.Url.hash,this.search=this.Url.search,r=this.Url.pathname+(this.Url.search?this.Url.search:"")}catch(e){this.Url=void 0,this.base&&(r=new i.default(this.base).resolve(r))}this.Path=new i.default(r),this.directory=this.Path.directory,this.filename=this.Path.filename,this.extension=this.Path.extension}path(){return this.Path}resolve(e){var t;return e.indexOf("://")>-1?e:(t=r.default.resolve(this.directory,e),this.origin+t)}relative(e){return r.default.relative(e,this.directory)}toString(){return this.href}}},2551:(e,t,n)=>{"use strict";var i=n(6540),r=n(194);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,o={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(o[e]=t,e=0;e<t.length;e++)a.add(t[e])}var u=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function g(e,t,n,i,r,s,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=a}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){m[e]=new g(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];m[t]=new g(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){m[e]=new g(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){m[e]=new g(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){m[e]=new g(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){m[e]=new g(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){m[e]=new g(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){m[e]=new g(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){m[e]=new g(e,5,!1,e.toLowerCase(),null,!1,!1)});var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,n,i){var r=m.hasOwnProperty(t)?m[t]:null;(null!==r?0!==r.type:i||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,i){if(null==t||function(e,t,n,i){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!i&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,i))return!0;if(i)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,r,i)&&(n=null),i||null===r?function(e){return!!h.call(p,e)||!h.call(f,e)&&(d.test(e)?p[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):r.mustUseProperty?e[r.propertyName]=null===n?3!==r.type&&"":n:(t=r.attributeName,i=r.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(r=r.type)||4===r&&!0===n?"":""+n,i?e.setAttributeNS(i,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(v,y);m[t]=new g(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(v,y);m[t]=new g(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(v,y);m[t]=new g(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){m[e]=new g(e,1,!1,e.toLowerCase(),null,!1,!1)}),m.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){m[e]=new g(e,1,!1,e.toLowerCase(),null,!0,!0)});var E=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,S=Symbol.for("react.element"),w=Symbol.for("react.portal"),T=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),_=Symbol.for("react.profiler"),x=Symbol.for("react.provider"),L=Symbol.for("react.context"),A=Symbol.for("react.forward_ref"),R=Symbol.for("react.suspense"),I=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),D=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var P=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var O=Symbol.iterator;function N(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=O&&e[O]||e["@@iterator"])?e:null}var M,F=Object.assign;function B(e){if(void 0===M)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);M=t&&t[1]||""}return"\n"+M+e}var U=!1;function $(e,t){if(!e||U)return"";U=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(e){var i=e}Reflect.construct(e,[],t)}else{try{t.call()}catch(e){i=e}e.call(t.prototype)}else{try{throw Error()}catch(e){i=e}e()}}catch(t){if(t&&i&&"string"==typeof t.stack){for(var r=t.stack.split("\n"),s=i.stack.split("\n"),a=r.length-1,o=s.length-1;1<=a&&0<=o&&r[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(r[a]!==s[o]){if(1!==a||1!==o)do{if(a--,0>--o||r[a]!==s[o]){var l="\n"+r[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=a&&0<=o);break}}}finally{U=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?B(e):""}function j(e){switch(e.tag){case 5:return B(e.type);case 16:return B("Lazy");case 13:return B("Suspense");case 19:return B("SuspenseList");case 0:case 2:case 15:return $(e.type,!1);case 11:return $(e.type.render,!1);case 1:return $(e.type,!0);default:return""}}function z(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case T:return"Fragment";case w:return"Portal";case _:return"Profiler";case k:return"StrictMode";case R:return"Suspense";case I:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case L:return(e.displayName||"Context")+".Consumer";case x:return(e._context.displayName||"Context")+".Provider";case A:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case C:return null!==(t=e.displayName||null)?t:z(e.type)||"Memo";case D:t=e._payload,e=e._init;try{return z(e(t))}catch(e){}}return null}function G(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return z(t);case 8:return t===k?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t}return null}function V(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function q(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function H(e){e._valueTracker||(e._valueTracker=function(e){var t=q(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var r=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){i=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(e){i=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function W(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=q(e)?e.checked?"true":"false":e.value),(e=i)!==n&&(t.setValue(e),!0)}function K(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Y(e,t){var n=t.checked;return F({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function X(e,t){var n=null==t.defaultValue?"":t.defaultValue,i=null!=t.checked?t.checked:t.defaultChecked;n=V(null!=t.value?t.value:n),e._wrapperState={initialChecked:i,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Q(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function Z(e,t){Q(e,t);var n=V(t.value),i=t.type;if(null!=n)"number"===i?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===i||"reset"===i)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,V(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function J(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!("submit"!==i&&"reset"!==i||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&K(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,i){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&i&&(e[n].defaultSelected=!0)}else{for(n=""+V(n),t=null,r=0;r<e.length;r++){if(e[r].value===n)return e[r].selected=!0,void(i&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function ie(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return F({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function re(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(s(92));if(te(n)){if(1<n.length)throw Error(s(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:V(n)}}function se(e,t){var n=V(t.value),i=V(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=i&&(e.defaultValue=""+i)}function ae(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,he=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,i){MSApp.execUnsafeLocalFunction(function(){return ue(e,t)})}:ue);function de(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function ge(e,t,n){return null==t||"boolean"==typeof t||""===t?"":n||"number"!=typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function me(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var i=0===n.indexOf("--"),r=ge(n,t[n],i);"float"===n&&(n="cssFloat"),i?e.setProperty(n,r):e[n]=r}}Object.keys(fe).forEach(function(e){pe.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]})});var ve=F({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!=typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(s(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ee=null;function Se(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var we=null,Te=null,ke=null;function _e(e){if(e=br(e)){if("function"!=typeof we)throw Error(s(280));var t=e.stateNode;t&&(t=Sr(t),we(e.stateNode,e.type,t))}}function xe(e){Te?ke?ke.push(e):ke=[e]:Te=e}function Le(){if(Te){var e=Te,t=ke;if(ke=Te=null,_e(e),t)for(e=0;e<t.length;e++)_e(t[e])}}function Ae(e,t){return e(t)}function Re(){}var Ie=!1;function Ce(e,t,n){if(Ie)return e(t,n);Ie=!0;try{return Ae(e,t,n)}finally{Ie=!1,(null!==Te||null!==ke)&&(Re(),Le())}}function De(e,t){var n=e.stateNode;if(null===n)return null;var i=Sr(n);if(null===i)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!i;break e;default:e=!1}if(e)return null;if(n&&"function"!=typeof n)throw Error(s(231,t,typeof n));return n}var Pe=!1;if(u)try{var Oe={};Object.defineProperty(Oe,"passive",{get:function(){Pe=!0}}),window.addEventListener("test",Oe,Oe),window.removeEventListener("test",Oe,Oe)}catch(ue){Pe=!1}function Ne(e,t,n,i,r,s,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(e){this.onError(e)}}var Me=!1,Fe=null,Be=!1,Ue=null,$e={onError:function(e){Me=!0,Fe=e}};function je(e,t,n,i,r,s,a,o,l){Me=!1,Fe=null,Ne.apply($e,arguments)}function ze(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{!!(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Ge(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&null!==(e=e.alternate)&&(t=e.memoizedState),null!==t)return t.dehydrated}return null}function Ve(e){if(ze(e)!==e)throw Error(s(188))}function qe(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=ze(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,i=t;;){var r=n.return;if(null===r)break;var a=r.alternate;if(null===a){if(null!==(i=r.return)){n=i;continue}break}if(r.child===a.child){for(a=r.child;a;){if(a===n)return Ve(r),e;if(a===i)return Ve(r),t;a=a.sibling}throw Error(s(188))}if(n.return!==i.return)n=r,i=a;else{for(var o=!1,l=r.child;l;){if(l===n){o=!0,n=r,i=a;break}if(l===i){o=!0,i=r,n=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===n){o=!0,n=a,i=r;break}if(l===i){o=!0,i=a,n=r;break}l=l.sibling}if(!o)throw Error(s(189))}}if(n.alternate!==i)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(e))?He(e):null}function He(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=He(e);if(null!==t)return t;e=e.sibling}return null}var We=r.unstable_scheduleCallback,Ke=r.unstable_cancelCallback,Ye=r.unstable_shouldYield,Xe=r.unstable_requestPaint,Qe=r.unstable_now,Ze=r.unstable_getCurrentPriorityLevel,Je=r.unstable_ImmediatePriority,et=r.unstable_UserBlockingPriority,tt=r.unstable_NormalPriority,nt=r.unstable_LowPriority,it=r.unstable_IdlePriority,rt=null,st=null,at=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(ot(e)/lt|0)|0},ot=Math.log,lt=Math.LN2,ct=64,ut=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function dt(e,t){var n=e.pendingLanes;if(0===n)return 0;var i=0,r=e.suspendedLanes,s=e.pingedLanes,a=268435455&n;if(0!==a){var o=a&~r;0!==o?i=ht(o):0!==(s&=a)&&(i=ht(s))}else 0!==(a=n&~r)?i=ht(a):0!==s&&(i=ht(s));if(0===i)return 0;if(0!==t&&t!==i&&0===(t&r)&&((r=i&-i)>=(s=t&-t)||16===r&&4194240&s))return t;if(4&i&&(i|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=i;0<t;)r=1<<(n=31-at(t)),i|=e[n],t&=~r;return i}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!=(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function gt(){var e=ct;return!(4194240&(ct<<=1))&&(ct=64),e}function mt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-at(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-at(n),r=1<<i;r&t|e[i]&t&&(e[i]|=t),n&=~r}}var bt=0;function Et(e){return 1<(e&=-e)?4<e?268435455&e?16:536870912:4:1}var St,wt,Tt,kt,_t,xt=!1,Lt=[],At=null,Rt=null,It=null,Ct=new Map,Dt=new Map,Pt=[],Ot="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Nt(e,t){switch(e){case"focusin":case"focusout":At=null;break;case"dragenter":case"dragleave":Rt=null;break;case"mouseover":case"mouseout":It=null;break;case"pointerover":case"pointerout":Ct.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Dt.delete(t.pointerId)}}function Mt(e,t,n,i,r,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},null!==t&&null!==(t=br(t))&&wt(t),e):(e.eventSystemFlags|=i,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function Ft(e){var t=yr(e.target);if(null!==t){var n=ze(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Ge(n)))return e.blockedOn=t,void _t(e.priority,function(){Tt(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Bt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=br(n))&&wt(t),e.blockedOn=n,!1;var i=new(n=e.nativeEvent).constructor(n.type,n);Ee=i,n.target.dispatchEvent(i),Ee=null,t.shift()}return!0}function Ut(e,t,n){Bt(e)&&n.delete(t)}function $t(){xt=!1,null!==At&&Bt(At)&&(At=null),null!==Rt&&Bt(Rt)&&(Rt=null),null!==It&&Bt(It)&&(It=null),Ct.forEach(Ut),Dt.forEach(Ut)}function jt(e,t){e.blockedOn===t&&(e.blockedOn=null,xt||(xt=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,$t)))}function zt(e){function t(t){return jt(t,e)}if(0<Lt.length){jt(Lt[0],e);for(var n=1;n<Lt.length;n++){var i=Lt[n];i.blockedOn===e&&(i.blockedOn=null)}}for(null!==At&&jt(At,e),null!==Rt&&jt(Rt,e),null!==It&&jt(It,e),Ct.forEach(t),Dt.forEach(t),n=0;n<Pt.length;n++)(i=Pt[n]).blockedOn===e&&(i.blockedOn=null);for(;0<Pt.length&&null===(n=Pt[0]).blockedOn;)Ft(n),null===n.blockedOn&&Pt.shift()}var Gt=E.ReactCurrentBatchConfig,Vt=!0;function qt(e,t,n,i){var r=bt,s=Gt.transition;Gt.transition=null;try{bt=1,Wt(e,t,n,i)}finally{bt=r,Gt.transition=s}}function Ht(e,t,n,i){var r=bt,s=Gt.transition;Gt.transition=null;try{bt=4,Wt(e,t,n,i)}finally{bt=r,Gt.transition=s}}function Wt(e,t,n,i){if(Vt){var r=Yt(e,t,n,i);if(null===r)Vi(e,t,i,Kt,n),Nt(e,i);else if(function(e,t,n,i,r){switch(t){case"focusin":return At=Mt(At,e,t,n,i,r),!0;case"dragenter":return Rt=Mt(Rt,e,t,n,i,r),!0;case"mouseover":return It=Mt(It,e,t,n,i,r),!0;case"pointerover":var s=r.pointerId;return Ct.set(s,Mt(Ct.get(s)||null,e,t,n,i,r)),!0;case"gotpointercapture":return s=r.pointerId,Dt.set(s,Mt(Dt.get(s)||null,e,t,n,i,r)),!0}return!1}(r,e,t,n,i))i.stopPropagation();else if(Nt(e,i),4&t&&-1<Ot.indexOf(e)){for(;null!==r;){var s=br(r);if(null!==s&&St(s),null===(s=Yt(e,t,n,i))&&Vi(e,t,i,Kt,n),s===r)break;r=s}null!==r&&i.stopPropagation()}else Vi(e,t,i,null,n)}}var Kt=null;function Yt(e,t,n,i){if(Kt=null,null!==(e=yr(e=Se(i))))if(null===(t=ze(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Ge(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Kt=e,null}function Xt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ze()){case Je:return 1;case et:return 4;case tt:case nt:return 16;case it:return 536870912;default:return 16}default:return 16}}var Qt=null,Zt=null,Jt=null;function en(){if(Jt)return Jt;var e,t,n=Zt,i=n.length,r="value"in Qt?Qt.value:Qt.textContent,s=r.length;for(e=0;e<i&&n[e]===r[e];e++);var a=i-e;for(t=1;t<=a&&n[i-t]===r[s-t];t++);return Jt=r.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function sn(e){function t(t,n,i,r,s){for(var a in this._reactName=t,this._targetInst=i,this.type=n,this.nativeEvent=r,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(r):r[a]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return F(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var an,on,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=sn(cn),hn=F({},cn,{view:0,detail:0}),dn=sn(hn),fn=F({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_n,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(an=e.screenX-ln.screenX,on=e.screenY-ln.screenY):on=an=0,ln=e),an)},movementY:function(e){return"movementY"in e?e.movementY:on}}),pn=sn(fn),gn=sn(F({},fn,{dataTransfer:0})),mn=sn(F({},hn,{relatedTarget:0})),vn=sn(F({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=F({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=sn(yn),En=sn(F({},cn,{data:0})),Sn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Tn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function kn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Tn[e])&&!!t[e]}function _n(){return kn}var xn=F({},hn,{key:function(e){if(e.key){var t=Sn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?wn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_n,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Ln=sn(xn),An=sn(F({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Rn=sn(F({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_n})),In=sn(F({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Cn=F({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Dn=sn(Cn),Pn=[9,13,27,32],On=u&&"CompositionEvent"in window,Nn=null;u&&"documentMode"in document&&(Nn=document.documentMode);var Mn=u&&"TextEvent"in window&&!Nn,Fn=u&&(!On||Nn&&8<Nn&&11>=Nn),Bn=String.fromCharCode(32),Un=!1;function $n(e,t){switch(e){case"keyup":return-1!==Pn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function jn(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var zn=!1,Gn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Gn[e.type]:"textarea"===t}function qn(e,t,n,i){xe(i),0<(t=Hi(t,"onChange")).length&&(n=new un("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var Hn=null,Wn=null;function Kn(e){Bi(e,0)}function Yn(e){if(W(Er(e)))return e}function Xn(e,t){if("change"===e)return t}var Qn=!1;if(u){var Zn;if(u){var Jn="oninput"in document;if(!Jn){var ei=document.createElement("div");ei.setAttribute("oninput","return;"),Jn="function"==typeof ei.oninput}Zn=Jn}else Zn=!1;Qn=Zn&&(!document.documentMode||9<document.documentMode)}function ti(){Hn&&(Hn.detachEvent("onpropertychange",ni),Wn=Hn=null)}function ni(e){if("value"===e.propertyName&&Yn(Wn)){var t=[];qn(t,Wn,e,Se(e)),Ce(Kn,t)}}function ii(e,t,n){"focusin"===e?(ti(),Wn=n,(Hn=t).attachEvent("onpropertychange",ni)):"focusout"===e&&ti()}function ri(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Yn(Wn)}function si(e,t){if("click"===e)return Yn(t)}function ai(e,t){if("input"===e||"change"===e)return Yn(t)}var oi="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t};function li(e,t){if(oi(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!h.call(t,r)||!oi(e[r],t[r]))return!1}return!0}function ci(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ui(e,t){var n,i=ci(e);for(e=0;i;){if(3===i.nodeType){if(n=e+i.textContent.length,e<=t&&n>=t)return{node:i,offset:t-e};e=n}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=ci(i)}}function hi(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hi(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function di(){for(var e=window,t=K();t instanceof e.HTMLIFrameElement;){try{var n="string"==typeof t.contentWindow.location.href}catch(e){n=!1}if(!n)break;t=K((e=t.contentWindow).document)}return t}function fi(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pi(e){var t=di(),n=e.focusedElem,i=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&hi(n.ownerDocument.documentElement,n)){if(null!==i&&fi(n))if(t=i.start,void 0===(e=i.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var r=n.textContent.length,s=Math.min(i.start,r);i=void 0===i.end?s:Math.min(i.end,r),!e.extend&&s>i&&(r=i,i=s,s=r),r=ui(n,s);var a=ui(n,i);r&&a&&(1!==e.rangeCount||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&((t=t.createRange()).setStart(r.node,r.offset),e.removeAllRanges(),s>i?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"==typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var gi=u&&"documentMode"in document&&11>=document.documentMode,mi=null,vi=null,yi=null,bi=!1;function Ei(e,t,n){var i=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;bi||null==mi||mi!==K(i)||(i="selectionStart"in(i=mi)&&fi(i)?{start:i.selectionStart,end:i.selectionEnd}:{anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},yi&&li(yi,i)||(yi=i,0<(i=Hi(vi,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=mi)))}function Si(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var wi={animationend:Si("Animation","AnimationEnd"),animationiteration:Si("Animation","AnimationIteration"),animationstart:Si("Animation","AnimationStart"),transitionend:Si("Transition","TransitionEnd")},Ti={},ki={};function _i(e){if(Ti[e])return Ti[e];if(!wi[e])return e;var t,n=wi[e];for(t in n)if(n.hasOwnProperty(t)&&t in ki)return Ti[e]=n[t];return e}u&&(ki=document.createElement("div").style,"AnimationEvent"in window||(delete wi.animationend.animation,delete wi.animationiteration.animation,delete wi.animationstart.animation),"TransitionEvent"in window||delete wi.transitionend.transition);var xi=_i("animationend"),Li=_i("animationiteration"),Ai=_i("animationstart"),Ri=_i("transitionend"),Ii=new Map,Ci="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Di(e,t){Ii.set(e,t),l(t,[e])}for(var Pi=0;Pi<Ci.length;Pi++){var Oi=Ci[Pi];Di(Oi.toLowerCase(),"on"+(Oi[0].toUpperCase()+Oi.slice(1)))}Di(xi,"onAnimationEnd"),Di(Li,"onAnimationIteration"),Di(Ai,"onAnimationStart"),Di("dblclick","onDoubleClick"),Di("focusin","onFocus"),Di("focusout","onBlur"),Di(Ri,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ni="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Mi=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ni));function Fi(e,t,n){var i=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,i,r,a,o,l,c){if(je.apply(this,arguments),Me){if(!Me)throw Error(s(198));var u=Fe;Me=!1,Fe=null,Be||(Be=!0,Ue=u)}}(i,t,void 0,e),e.currentTarget=null}function Bi(e,t){t=!!(4&t);for(var n=0;n<e.length;n++){var i=e[n],r=i.event;i=i.listeners;e:{var s=void 0;if(t)for(var a=i.length-1;0<=a;a--){var o=i[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&r.isPropagationStopped())break e;Fi(r,o,c),s=l}else for(a=0;a<i.length;a++){if(l=(o=i[a]).instance,c=o.currentTarget,o=o.listener,l!==s&&r.isPropagationStopped())break e;Fi(r,o,c),s=l}}}if(Be)throw e=Ue,Be=!1,Ue=null,e}function Ui(e,t){var n=t[gr];void 0===n&&(n=t[gr]=new Set);var i=e+"__bubble";n.has(i)||(Gi(t,e,2,!1),n.add(i))}function $i(e,t,n){var i=0;t&&(i|=4),Gi(n,e,i,t)}var ji="_reactListening"+Math.random().toString(36).slice(2);function zi(e){if(!e[ji]){e[ji]=!0,a.forEach(function(t){"selectionchange"!==t&&(Mi.has(t)||$i(t,!1,e),$i(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[ji]||(t[ji]=!0,$i("selectionchange",!1,t))}}function Gi(e,t,n,i){switch(Xt(t)){case 1:var r=qt;break;case 4:r=Ht;break;default:r=Wt}n=r.bind(null,t,n,e),r=void 0,!Pe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),i?void 0!==r?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):void 0!==r?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function Vi(e,t,n,i,r){var s=i;if(!(1&t||2&t||null===i))e:for(;;){if(null===i)return;var a=i.tag;if(3===a||4===a){var o=i.stateNode.containerInfo;if(o===r||8===o.nodeType&&o.parentNode===r)break;if(4===a)for(a=i.return;null!==a;){var l=a.tag;if((3===l||4===l)&&((l=a.stateNode.containerInfo)===r||8===l.nodeType&&l.parentNode===r))return;a=a.return}for(;null!==o;){if(null===(a=yr(o)))return;if(5===(l=a.tag)||6===l){i=s=a;continue e}o=o.parentNode}}i=i.return}Ce(function(){var i=s,r=Se(n),a=[];e:{var o=Ii.get(e);if(void 0!==o){var l=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=Ln;break;case"focusin":c="focus",l=mn;break;case"focusout":c="blur",l=mn;break;case"beforeblur":case"afterblur":l=mn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=gn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Rn;break;case xi:case Li:case Ai:l=vn;break;case Ri:l=In;break;case"scroll":l=dn;break;case"wheel":l=Dn;break;case"copy":case"cut":case"paste":l=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=An}var u=!!(4&t),h=!u&&"scroll"===e,d=u?null!==o?o+"Capture":null:o;u=[];for(var f,p=i;null!==p;){var g=(f=p).stateNode;if(5===f.tag&&null!==g&&(f=g,null!==d&&null!=(g=De(p,d))&&u.push(qi(p,g,f))),h)break;p=p.return}0<u.length&&(o=new l(o,c,null,n,r),a.push({event:o,listeners:u}))}}if(!(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===Ee||!(c=n.relatedTarget||n.fromElement)||!yr(c)&&!c[pr])&&(l||o)&&(o=r.window===r?r:(o=r.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=i,null!==(c=(c=n.relatedTarget||n.toElement)?yr(c):null)&&(c!==(h=ze(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=i),l!==c)){if(u=pn,g="onMouseLeave",d="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(u=An,g="onPointerLeave",d="onPointerEnter",p="pointer"),h=null==l?o:Er(l),f=null==c?o:Er(c),(o=new u(g,p+"leave",l,n,r)).target=h,o.relatedTarget=f,g=null,yr(r)===i&&((u=new u(d,p+"enter",c,n,r)).target=f,u.relatedTarget=h,g=u),h=g,l&&c)e:{for(d=c,p=0,f=u=l;f;f=Wi(f))p++;for(f=0,g=d;g;g=Wi(g))f++;for(;0<p-f;)u=Wi(u),p--;for(;0<f-p;)d=Wi(d),f--;for(;p--;){if(u===d||null!==d&&u===d.alternate)break e;u=Wi(u),d=Wi(d)}u=null}else u=null;null!==l&&Ki(a,o,l,u,!1),null!==c&&null!==h&&Ki(a,h,c,u,!0)}if("select"===(l=(o=i?Er(i):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var m=Xn;else if(Vn(o))if(Qn)m=ai;else{m=ri;var v=ii}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(m=si);switch(m&&(m=m(e,i))?qn(a,m,n,r):(v&&v(e,o,i),"focusout"===e&&(v=o._wrapperState)&&v.controlled&&"number"===o.type&&ee(o,"number",o.value)),v=i?Er(i):window,e){case"focusin":(Vn(v)||"true"===v.contentEditable)&&(mi=v,vi=i,yi=null);break;case"focusout":yi=vi=mi=null;break;case"mousedown":bi=!0;break;case"contextmenu":case"mouseup":case"dragend":bi=!1,Ei(a,n,r);break;case"selectionchange":if(gi)break;case"keydown":case"keyup":Ei(a,n,r)}var y;if(On)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else zn?$n(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Fn&&"ko"!==n.locale&&(zn||"onCompositionStart"!==b?"onCompositionEnd"===b&&zn&&(y=en()):(Zt="value"in(Qt=r)?Qt.value:Qt.textContent,zn=!0)),0<(v=Hi(i,b)).length&&(b=new En(b,e,null,n,r),a.push({event:b,listeners:v}),(y||null!==(y=jn(n)))&&(b.data=y))),(y=Mn?function(e,t){switch(e){case"compositionend":return jn(t);case"keypress":return 32!==t.which?null:(Un=!0,Bn);case"textInput":return(e=t.data)===Bn&&Un?null:e;default:return null}}(e,n):function(e,t){if(zn)return"compositionend"===e||!On&&$n(e,t)?(e=en(),Jt=Zt=Qt=null,zn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Fn&&"ko"!==t.locale?null:t.data}}(e,n))&&0<(i=Hi(i,"onBeforeInput")).length&&(r=new En("onBeforeInput","beforeinput",null,n,r),a.push({event:r,listeners:i}),r.data=y)}Bi(a,t)})}function qi(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Hi(e,t){for(var n=t+"Capture",i=[];null!==e;){var r=e,s=r.stateNode;5===r.tag&&null!==s&&(r=s,null!=(s=De(e,n))&&i.unshift(qi(e,s,r)),null!=(s=De(e,t))&&i.push(qi(e,s,r))),e=e.return}return i}function Wi(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Ki(e,t,n,i,r){for(var s=t._reactName,a=[];null!==n&&n!==i;){var o=n,l=o.alternate,c=o.stateNode;if(null!==l&&l===i)break;5===o.tag&&null!==c&&(o=c,r?null!=(l=De(n,s))&&a.unshift(qi(n,l,o)):r||null!=(l=De(n,s))&&a.push(qi(n,l,o))),n=n.return}0!==a.length&&e.push({event:t,listeners:a})}var Yi=/\r\n?/g,Xi=/\u0000|\uFFFD/g;function Qi(e){return("string"==typeof e?e:""+e).replace(Yi,"\n").replace(Xi,"")}function Zi(e,t,n){if(t=Qi(t),Qi(e)!==t&&n)throw Error(s(425))}function Ji(){}var er=null,tr=null;function nr(e,t){return"textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ir="function"==typeof setTimeout?setTimeout:void 0,rr="function"==typeof clearTimeout?clearTimeout:void 0,sr="function"==typeof Promise?Promise:void 0,ar="function"==typeof queueMicrotask?queueMicrotask:void 0!==sr?function(e){return sr.resolve(null).then(e).catch(or)}:ir;function or(e){setTimeout(function(){throw e})}function lr(e,t){var n=t,i=0;do{var r=n.nextSibling;if(e.removeChild(n),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0===i)return e.removeChild(r),void zt(t);i--}else"$"!==n&&"$?"!==n&&"$!"!==n||i++;n=r}while(n);zt(t)}function cr(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ur(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var hr=Math.random().toString(36).slice(2),dr="__reactFiber$"+hr,fr="__reactProps$"+hr,pr="__reactContainer$"+hr,gr="__reactEvents$"+hr,mr="__reactListeners$"+hr,vr="__reactHandles$"+hr;function yr(e){var t=e[dr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[pr]||n[dr]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ur(e);null!==e;){if(n=e[dr])return n;e=ur(e)}return t}n=(e=n).parentNode}return null}function br(e){return!(e=e[dr]||e[pr])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function Er(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function Sr(e){return e[fr]||null}var wr=[],Tr=-1;function kr(e){return{current:e}}function _r(e){0>Tr||(e.current=wr[Tr],wr[Tr]=null,Tr--)}function xr(e,t){Tr++,wr[Tr]=e.current,e.current=t}var Lr={},Ar=kr(Lr),Rr=kr(!1),Ir=Lr;function Cr(e,t){var n=e.type.contextTypes;if(!n)return Lr;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var r,s={};for(r in n)s[r]=t[r];return i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Dr(e){return null!=e.childContextTypes}function Pr(){_r(Rr),_r(Ar)}function Or(e,t,n){if(Ar.current!==Lr)throw Error(s(168));xr(Ar,t),xr(Rr,n)}function Nr(e,t,n){var i=e.stateNode;if(t=t.childContextTypes,"function"!=typeof i.getChildContext)return n;for(var r in i=i.getChildContext())if(!(r in t))throw Error(s(108,G(e)||"Unknown",r));return F({},n,i)}function Mr(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Lr,Ir=Ar.current,xr(Ar,e),xr(Rr,Rr.current),!0}function Fr(e,t,n){var i=e.stateNode;if(!i)throw Error(s(169));n?(e=Nr(e,t,Ir),i.__reactInternalMemoizedMergedChildContext=e,_r(Rr),_r(Ar),xr(Ar,e)):_r(Rr),xr(Rr,n)}var Br=null,Ur=!1,$r=!1;function jr(e){null===Br?Br=[e]:Br.push(e)}function zr(){if(!$r&&null!==Br){$r=!0;var e=0,t=bt;try{var n=Br;for(bt=1;e<n.length;e++){var i=n[e];do{i=i(!0)}while(null!==i)}Br=null,Ur=!1}catch(t){throw null!==Br&&(Br=Br.slice(e+1)),We(Je,zr),t}finally{bt=t,$r=!1}}return null}var Gr=[],Vr=0,qr=null,Hr=0,Wr=[],Kr=0,Yr=null,Xr=1,Qr="";function Zr(e,t){Gr[Vr++]=Hr,Gr[Vr++]=qr,qr=e,Hr=t}function Jr(e,t,n){Wr[Kr++]=Xr,Wr[Kr++]=Qr,Wr[Kr++]=Yr,Yr=e;var i=Xr;e=Qr;var r=32-at(i)-1;i&=~(1<<r),n+=1;var s=32-at(t)+r;if(30<s){var a=r-r%5;s=(i&(1<<a)-1).toString(32),i>>=a,r-=a,Xr=1<<32-at(t)+r|n<<r|i,Qr=s+e}else Xr=1<<s|n<<r|i,Qr=e}function es(e){null!==e.return&&(Zr(e,1),Jr(e,1,0))}function ts(e){for(;e===qr;)qr=Gr[--Vr],Gr[Vr]=null,Hr=Gr[--Vr],Gr[Vr]=null;for(;e===Yr;)Yr=Wr[--Kr],Wr[Kr]=null,Qr=Wr[--Kr],Wr[Kr]=null,Xr=Wr[--Kr],Wr[Kr]=null}var ns=null,is=null,rs=!1,ss=null;function as(e,t){var n=Cc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function os(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ns=e,is=cr(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ns=e,is=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Yr?{id:Xr,overflow:Qr}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Cc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ns=e,is=null,!0);default:return!1}}function ls(e){return!(!(1&e.mode)||128&e.flags)}function cs(e){if(rs){var t=is;if(t){var n=t;if(!os(e,t)){if(ls(e))throw Error(s(418));t=cr(n.nextSibling);var i=ns;t&&os(e,t)?as(i,n):(e.flags=-4097&e.flags|2,rs=!1,ns=e)}}else{if(ls(e))throw Error(s(418));e.flags=-4097&e.flags|2,rs=!1,ns=e}}}function us(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ns=e}function hs(e){if(e!==ns)return!1;if(!rs)return us(e),rs=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!nr(e.type,e.memoizedProps)),t&&(t=is)){if(ls(e))throw ds(),Error(s(418));for(;t;)as(e,t),t=cr(t.nextSibling)}if(us(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){is=cr(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}is=null}}else is=ns?cr(e.stateNode.nextSibling):null;return!0}function ds(){for(var e=is;e;)e=cr(e.nextSibling)}function fs(){is=ns=null,rs=!1}function ps(e){null===ss?ss=[e]:ss.push(e)}var gs=E.ReactCurrentBatchConfig;function ms(e,t,n){if(null!==(e=n.ref)&&"function"!=typeof e&&"object"!=typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var i=n.stateNode}if(!i)throw Error(s(147,e));var r=i,a=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===a?t.ref:(t=function(e){var t=r.refs;null===e?delete t[a]:t[a]=e},t._stringRef=a,t)}if("string"!=typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function vs(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ys(e){return(0,e._init)(e._payload)}function bs(e){function t(t,n){if(e){var i=t.deletions;null===i?(t.deletions=[n],t.flags|=16):i.push(n)}}function n(n,i){if(!e)return null;for(;null!==i;)t(n,i),i=i.sibling;return null}function i(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function r(e,t){return(e=Pc(e,t)).index=0,e.sibling=null,e}function a(t,n,i){return t.index=i,e?null!==(i=t.alternate)?(i=i.index)<n?(t.flags|=2,n):i:(t.flags|=2,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,i){return null===t||6!==t.tag?((t=Fc(n,e.mode,i)).return=e,t):((t=r(t,n)).return=e,t)}function c(e,t,n,i){var s=n.type;return s===T?h(e,t,n.props.children,i,n.key):null!==t&&(t.elementType===s||"object"==typeof s&&null!==s&&s.$$typeof===D&&ys(s)===t.type)?((i=r(t,n.props)).ref=ms(e,t,n),i.return=e,i):((i=Oc(n.type,n.key,n.props,null,e.mode,i)).ref=ms(e,t,n),i.return=e,i)}function u(e,t,n,i){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Bc(n,e.mode,i)).return=e,t):((t=r(t,n.children||[])).return=e,t)}function h(e,t,n,i,s){return null===t||7!==t.tag?((t=Nc(n,e.mode,i,s)).return=e,t):((t=r(t,n)).return=e,t)}function d(e,t,n){if("string"==typeof t&&""!==t||"number"==typeof t)return(t=Fc(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case S:return(n=Oc(t.type,t.key,t.props,null,e.mode,n)).ref=ms(e,null,t),n.return=e,n;case w:return(t=Bc(t,e.mode,n)).return=e,t;case D:return d(e,(0,t._init)(t._payload),n)}if(te(t)||N(t))return(t=Nc(t,e.mode,n,null)).return=e,t;vs(e,t)}return null}function f(e,t,n,i){var r=null!==t?t.key:null;if("string"==typeof n&&""!==n||"number"==typeof n)return null!==r?null:l(e,t,""+n,i);if("object"==typeof n&&null!==n){switch(n.$$typeof){case S:return n.key===r?c(e,t,n,i):null;case w:return n.key===r?u(e,t,n,i):null;case D:return f(e,t,(r=n._init)(n._payload),i)}if(te(n)||N(n))return null!==r?null:h(e,t,n,i,null);vs(e,n)}return null}function p(e,t,n,i,r){if("string"==typeof i&&""!==i||"number"==typeof i)return l(t,e=e.get(n)||null,""+i,r);if("object"==typeof i&&null!==i){switch(i.$$typeof){case S:return c(t,e=e.get(null===i.key?n:i.key)||null,i,r);case w:return u(t,e=e.get(null===i.key?n:i.key)||null,i,r);case D:return p(e,t,n,(0,i._init)(i._payload),r)}if(te(i)||N(i))return h(t,e=e.get(n)||null,i,r,null);vs(t,i)}return null}function g(r,s,o,l){for(var c=null,u=null,h=s,g=s=0,m=null;null!==h&&g<o.length;g++){h.index>g?(m=h,h=null):m=h.sibling;var v=f(r,h,o[g],l);if(null===v){null===h&&(h=m);break}e&&h&&null===v.alternate&&t(r,h),s=a(v,s,g),null===u?c=v:u.sibling=v,u=v,h=m}if(g===o.length)return n(r,h),rs&&Zr(r,g),c;if(null===h){for(;g<o.length;g++)null!==(h=d(r,o[g],l))&&(s=a(h,s,g),null===u?c=h:u.sibling=h,u=h);return rs&&Zr(r,g),c}for(h=i(r,h);g<o.length;g++)null!==(m=p(h,r,g,o[g],l))&&(e&&null!==m.alternate&&h.delete(null===m.key?g:m.key),s=a(m,s,g),null===u?c=m:u.sibling=m,u=m);return e&&h.forEach(function(e){return t(r,e)}),rs&&Zr(r,g),c}function m(r,o,l,c){var u=N(l);if("function"!=typeof u)throw Error(s(150));if(null==(l=u.call(l)))throw Error(s(151));for(var h=u=null,g=o,m=o=0,v=null,y=l.next();null!==g&&!y.done;m++,y=l.next()){g.index>m?(v=g,g=null):v=g.sibling;var b=f(r,g,y.value,c);if(null===b){null===g&&(g=v);break}e&&g&&null===b.alternate&&t(r,g),o=a(b,o,m),null===h?u=b:h.sibling=b,h=b,g=v}if(y.done)return n(r,g),rs&&Zr(r,m),u;if(null===g){for(;!y.done;m++,y=l.next())null!==(y=d(r,y.value,c))&&(o=a(y,o,m),null===h?u=y:h.sibling=y,h=y);return rs&&Zr(r,m),u}for(g=i(r,g);!y.done;m++,y=l.next())null!==(y=p(g,r,m,y.value,c))&&(e&&null!==y.alternate&&g.delete(null===y.key?m:y.key),o=a(y,o,m),null===h?u=y:h.sibling=y,h=y);return e&&g.forEach(function(e){return t(r,e)}),rs&&Zr(r,m),u}return function e(i,s,a,l){if("object"==typeof a&&null!==a&&a.type===T&&null===a.key&&(a=a.props.children),"object"==typeof a&&null!==a){switch(a.$$typeof){case S:e:{for(var c=a.key,u=s;null!==u;){if(u.key===c){if((c=a.type)===T){if(7===u.tag){n(i,u.sibling),(s=r(u,a.props.children)).return=i,i=s;break e}}else if(u.elementType===c||"object"==typeof c&&null!==c&&c.$$typeof===D&&ys(c)===u.type){n(i,u.sibling),(s=r(u,a.props)).ref=ms(i,u,a),s.return=i,i=s;break e}n(i,u);break}t(i,u),u=u.sibling}a.type===T?((s=Nc(a.props.children,i.mode,l,a.key)).return=i,i=s):((l=Oc(a.type,a.key,a.props,null,i.mode,l)).ref=ms(i,s,a),l.return=i,i=l)}return o(i);case w:e:{for(u=a.key;null!==s;){if(s.key===u){if(4===s.tag&&s.stateNode.containerInfo===a.containerInfo&&s.stateNode.implementation===a.implementation){n(i,s.sibling),(s=r(s,a.children||[])).return=i,i=s;break e}n(i,s);break}t(i,s),s=s.sibling}(s=Bc(a,i.mode,l)).return=i,i=s}return o(i);case D:return e(i,s,(u=a._init)(a._payload),l)}if(te(a))return g(i,s,a,l);if(N(a))return m(i,s,a,l);vs(i,a)}return"string"==typeof a&&""!==a||"number"==typeof a?(a=""+a,null!==s&&6===s.tag?(n(i,s.sibling),(s=r(s,a)).return=i,i=s):(n(i,s),(s=Fc(a,i.mode,l)).return=i,i=s),o(i)):n(i,s)}}var Es=bs(!0),Ss=bs(!1),ws=kr(null),Ts=null,ks=null,_s=null;function xs(){_s=ks=Ts=null}function Ls(e){var t=ws.current;_r(ws),e._currentValue=t}function As(e,t,n){for(;null!==e;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==i&&(i.childLanes|=t)):null!==i&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function Rs(e,t){Ts=e,_s=ks=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(bo=!0),e.firstContext=null)}function Is(e){var t=e._currentValue;if(_s!==e)if(e={context:e,memoizedValue:t,next:null},null===ks){if(null===Ts)throw Error(s(308));ks=e,Ts.dependencies={lanes:0,firstContext:e}}else ks=ks.next=e;return t}var Cs=null;function Ds(e){null===Cs?Cs=[e]:Cs.push(e)}function Ps(e,t,n,i){var r=t.interleaved;return null===r?(n.next=n,Ds(t)):(n.next=r.next,r.next=n),t.interleaved=n,Os(e,i)}function Os(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Ns=!1;function Ms(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Fs(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Bs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Us(e,t,n){var i=e.updateQueue;if(null===i)return null;if(i=i.shared,2&Al){var r=i.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),i.pending=t,Os(e,n)}return null===(r=i.interleaved)?(t.next=t,Ds(i)):(t.next=r.next,r.next=t),i.interleaved=t,Os(e,n)}function $s(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,4194240&n)){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,yt(e,n)}}function js(e,t){var n=e.updateQueue,i=e.alternate;if(null!==i&&n===(i=i.updateQueue)){var r=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===s?r=s=a:s=s.next=a,n=n.next}while(null!==n);null===s?r=s=t:s=s.next=t}else r=s=t;return n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function zs(e,t,n,i){var r=e.updateQueue;Ns=!1;var s=r.firstBaseUpdate,a=r.lastBaseUpdate,o=r.shared.pending;if(null!==o){r.shared.pending=null;var l=o,c=l.next;l.next=null,null===a?s=c:a.next=c,a=l;var u=e.alternate;null!==u&&(o=(u=u.updateQueue).lastBaseUpdate)!==a&&(null===o?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l)}if(null!==s){var h=r.baseState;for(a=0,u=c=l=null,o=s;;){var d=o.lane,f=o.eventTime;if((i&d)===d){null!==u&&(u=u.next={eventTime:f,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var p=e,g=o;switch(d=t,f=n,g.tag){case 1:if("function"==typeof(p=g.payload)){h=p.call(f,h,d);break e}h=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null==(d="function"==typeof(p=g.payload)?p.call(f,h,d):p))break e;h=F({},h,d);break e;case 2:Ns=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(d=r.effects)?r.effects=[o]:d.push(o))}else f={eventTime:f,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===u?(c=u=f,l=h):u=u.next=f,a|=d;if(null===(o=o.next)){if(null===(o=r.shared.pending))break;o=(d=o).next,d.next=null,r.lastBaseUpdate=d,r.shared.pending=null}}if(null===u&&(l=h),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=u,null!==(t=r.shared.interleaved)){r=t;do{a|=r.lane,r=r.next}while(r!==t)}else null===s&&(r.shared.lanes=0);Ml|=a,e.lanes=a,e.memoizedState=h}}function Gs(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var i=e[t],r=i.callback;if(null!==r){if(i.callback=null,i=n,"function"!=typeof r)throw Error(s(191,r));r.call(i)}}}var Vs={},qs=kr(Vs),Hs=kr(Vs),Ws=kr(Vs);function Ks(e){if(e===Vs)throw Error(s(174));return e}function Ys(e,t){switch(xr(Ws,t),xr(Hs,e),xr(qs,Vs),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}_r(qs),xr(qs,t)}function Xs(){_r(qs),_r(Hs),_r(Ws)}function Qs(e){Ks(Ws.current);var t=Ks(qs.current),n=le(t,e.type);t!==n&&(xr(Hs,e),xr(qs,n))}function Zs(e){Hs.current===e&&(_r(qs),_r(Hs))}var Js=kr(0);function ea(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(128&t.flags)return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ta=[];function na(){for(var e=0;e<ta.length;e++)ta[e]._workInProgressVersionPrimary=null;ta.length=0}var ia=E.ReactCurrentDispatcher,ra=E.ReactCurrentBatchConfig,sa=0,aa=null,oa=null,la=null,ca=!1,ua=!1,ha=0,da=0;function fa(){throw Error(s(321))}function pa(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!oi(e[n],t[n]))return!1;return!0}function ga(e,t,n,i,r,a){if(sa=a,aa=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ia.current=null===e||null===e.memoizedState?Za:Ja,e=n(i,r),ua){a=0;do{if(ua=!1,ha=0,25<=a)throw Error(s(301));a+=1,la=oa=null,t.updateQueue=null,ia.current=eo,e=n(i,r)}while(ua)}if(ia.current=Qa,t=null!==oa&&null!==oa.next,sa=0,la=oa=aa=null,ca=!1,t)throw Error(s(300));return e}function ma(){var e=0!==ha;return ha=0,e}function va(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===la?aa.memoizedState=la=e:la=la.next=e,la}function ya(){if(null===oa){var e=aa.alternate;e=null!==e?e.memoizedState:null}else e=oa.next;var t=null===la?aa.memoizedState:la.next;if(null!==t)la=t,oa=e;else{if(null===e)throw Error(s(310));e={memoizedState:(oa=e).memoizedState,baseState:oa.baseState,baseQueue:oa.baseQueue,queue:oa.queue,next:null},null===la?aa.memoizedState=la=e:la=la.next=e}return la}function ba(e,t){return"function"==typeof t?t(e):t}function Ea(e){var t=ya(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var i=oa,r=i.baseQueue,a=n.pending;if(null!==a){if(null!==r){var o=r.next;r.next=a.next,a.next=o}i.baseQueue=r=a,n.pending=null}if(null!==r){a=r.next,i=i.baseState;var l=o=null,c=null,u=a;do{var h=u.lane;if((sa&h)===h)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),i=u.hasEagerState?u.eagerState:e(i,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=d,o=i):c=c.next=d,aa.lanes|=h,Ml|=h}u=u.next}while(null!==u&&u!==a);null===c?o=i:c.next=l,oi(i,t.memoizedState)||(bo=!0),t.memoizedState=i,t.baseState=o,t.baseQueue=c,n.lastRenderedState=i}if(null!==(e=n.interleaved)){r=e;do{a=r.lane,aa.lanes|=a,Ml|=a,r=r.next}while(r!==e)}else null===r&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Sa(e){var t=ya(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var i=n.dispatch,r=n.pending,a=t.memoizedState;if(null!==r){n.pending=null;var o=r=r.next;do{a=e(a,o.action),o=o.next}while(o!==r);oi(a,t.memoizedState)||(bo=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),n.lastRenderedState=a}return[a,i]}function wa(){}function Ta(e,t){var n=aa,i=ya(),r=t(),a=!oi(i.memoizedState,r);if(a&&(i.memoizedState=r,bo=!0),i=i.queue,Na(xa.bind(null,n,i,e),[e]),i.getSnapshot!==t||a||null!==la&&1&la.memoizedState.tag){if(n.flags|=2048,Ia(9,_a.bind(null,n,i,r,t),void 0,null),null===Rl)throw Error(s(349));30&sa||ka(n,t,r)}return r}function ka(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=aa.updateQueue)?(t={lastEffect:null,stores:null},aa.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function _a(e,t,n,i){t.value=n,t.getSnapshot=i,La(t)&&Aa(e)}function xa(e,t,n){return n(function(){La(t)&&Aa(e)})}function La(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!oi(e,n)}catch(e){return!0}}function Aa(e){var t=Os(e,1);null!==t&&nc(t,e,1,-1)}function Ra(e){var t=va();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ba,lastRenderedState:e},t.queue=e,e=e.dispatch=Wa.bind(null,aa,e),[t.memoizedState,e]}function Ia(e,t,n,i){return e={tag:e,create:t,destroy:n,deps:i,next:null},null===(t=aa.updateQueue)?(t={lastEffect:null,stores:null},aa.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function Ca(){return ya().memoizedState}function Da(e,t,n,i){var r=va();aa.flags|=e,r.memoizedState=Ia(1|t,n,void 0,void 0===i?null:i)}function Pa(e,t,n,i){var r=ya();i=void 0===i?null:i;var s=void 0;if(null!==oa){var a=oa.memoizedState;if(s=a.destroy,null!==i&&pa(i,a.deps))return void(r.memoizedState=Ia(t,n,s,i))}aa.flags|=e,r.memoizedState=Ia(1|t,n,s,i)}function Oa(e,t){return Da(8390656,8,e,t)}function Na(e,t){return Pa(2048,8,e,t)}function Ma(e,t){return Pa(4,2,e,t)}function Fa(e,t){return Pa(4,4,e,t)}function Ba(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ua(e,t,n){return n=null!=n?n.concat([e]):null,Pa(4,4,Ba.bind(null,t,e),n)}function $a(){}function ja(e,t){var n=ya();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&pa(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function za(e,t){var n=ya();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&pa(t,i[1])?i[0]:(e=e(),n.memoizedState=[e,t],e)}function Ga(e,t,n){return 21&sa?(oi(n,t)||(n=gt(),aa.lanes|=n,Ml|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,bo=!0),e.memoizedState=n)}function Va(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var i=ra.transition;ra.transition={};try{e(!1),t()}finally{bt=n,ra.transition=i}}function qa(){return ya().memoizedState}function Ha(e,t,n){var i=tc(e);n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},Ka(e)?Ya(t,n):null!==(n=Ps(e,t,n,i))&&(nc(n,e,i,ec()),Xa(n,t,i))}function Wa(e,t,n){var i=tc(e),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ka(e))Ya(t,r);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var a=t.lastRenderedState,o=s(a,n);if(r.hasEagerState=!0,r.eagerState=o,oi(o,a)){var l=t.interleaved;return null===l?(r.next=r,Ds(t)):(r.next=l.next,l.next=r),void(t.interleaved=r)}}catch(e){}null!==(n=Ps(e,t,r,i))&&(nc(n,e,i,r=ec()),Xa(n,t,i))}}function Ka(e){var t=e.alternate;return e===aa||null!==t&&t===aa}function Ya(e,t){ua=ca=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Xa(e,t,n){if(4194240&n){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,yt(e,n)}}var Qa={readContext:Is,useCallback:fa,useContext:fa,useEffect:fa,useImperativeHandle:fa,useInsertionEffect:fa,useLayoutEffect:fa,useMemo:fa,useReducer:fa,useRef:fa,useState:fa,useDebugValue:fa,useDeferredValue:fa,useTransition:fa,useMutableSource:fa,useSyncExternalStore:fa,useId:fa,unstable_isNewReconciler:!1},Za={readContext:Is,useCallback:function(e,t){return va().memoizedState=[e,void 0===t?null:t],e},useContext:Is,useEffect:Oa,useImperativeHandle:function(e,t,n){return n=null!=n?n.concat([e]):null,Da(4194308,4,Ba.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Da(4194308,4,e,t)},useInsertionEffect:function(e,t){return Da(4,2,e,t)},useMemo:function(e,t){var n=va();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var i=va();return t=void 0!==n?n(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=Ha.bind(null,aa,e),[i.memoizedState,e]},useRef:function(e){return e={current:e},va().memoizedState=e},useState:Ra,useDebugValue:$a,useDeferredValue:function(e){return va().memoizedState=e},useTransition:function(){var e=Ra(!1),t=e[0];return e=Va.bind(null,e[1]),va().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var i=aa,r=va();if(rs){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===Rl)throw Error(s(349));30&sa||ka(i,t,n)}r.memoizedState=n;var a={value:n,getSnapshot:t};return r.queue=a,Oa(xa.bind(null,i,a,e),[e]),i.flags|=2048,Ia(9,_a.bind(null,i,a,n,t),void 0,null),n},useId:function(){var e=va(),t=Rl.identifierPrefix;if(rs){var n=Qr;t=":"+t+"R"+(n=(Xr&~(1<<32-at(Xr)-1)).toString(32)+n),0<(n=ha++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=da++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Ja={readContext:Is,useCallback:ja,useContext:Is,useEffect:Na,useImperativeHandle:Ua,useInsertionEffect:Ma,useLayoutEffect:Fa,useMemo:za,useReducer:Ea,useRef:Ca,useState:function(){return Ea(ba)},useDebugValue:$a,useDeferredValue:function(e){return Ga(ya(),oa.memoizedState,e)},useTransition:function(){return[Ea(ba)[0],ya().memoizedState]},useMutableSource:wa,useSyncExternalStore:Ta,useId:qa,unstable_isNewReconciler:!1},eo={readContext:Is,useCallback:ja,useContext:Is,useEffect:Na,useImperativeHandle:Ua,useInsertionEffect:Ma,useLayoutEffect:Fa,useMemo:za,useReducer:Sa,useRef:Ca,useState:function(){return Sa(ba)},useDebugValue:$a,useDeferredValue:function(e){var t=ya();return null===oa?t.memoizedState=e:Ga(t,oa.memoizedState,e)},useTransition:function(){return[Sa(ba)[0],ya().memoizedState]},useMutableSource:wa,useSyncExternalStore:Ta,useId:qa,unstable_isNewReconciler:!1};function to(e,t){if(e&&e.defaultProps){for(var n in t=F({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function no(e,t,n,i){n=null==(n=n(i,t=e.memoizedState))?t:F({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var io={isMounted:function(e){return!!(e=e._reactInternals)&&ze(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var i=ec(),r=tc(e),s=Bs(i,r);s.payload=t,null!=n&&(s.callback=n),null!==(t=Us(e,s,r))&&(nc(t,e,r,i),$s(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=ec(),r=tc(e),s=Bs(i,r);s.tag=1,s.payload=t,null!=n&&(s.callback=n),null!==(t=Us(e,s,r))&&(nc(t,e,r,i),$s(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ec(),i=tc(e),r=Bs(n,i);r.tag=2,null!=t&&(r.callback=t),null!==(t=Us(e,r,i))&&(nc(t,e,i,n),$s(t,e,i))}};function ro(e,t,n,i,r,s,a){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(i,s,a):!(t.prototype&&t.prototype.isPureReactComponent&&li(n,i)&&li(r,s))}function so(e,t,n){var i=!1,r=Lr,s=t.contextType;return"object"==typeof s&&null!==s?s=Is(s):(r=Dr(t)?Ir:Ar.current,s=(i=null!=(i=t.contextTypes))?Cr(e,r):Lr),t=new t(n,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=io,e.stateNode=t,t._reactInternals=e,i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=s),t}function ao(e,t,n,i){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,i),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&io.enqueueReplaceState(t,t.state,null)}function oo(e,t,n,i){var r=e.stateNode;r.props=n,r.state=e.memoizedState,r.refs={},Ms(e);var s=t.contextType;"object"==typeof s&&null!==s?r.context=Is(s):(s=Dr(t)?Ir:Ar.current,r.context=Cr(e,s)),r.state=e.memoizedState,"function"==typeof(s=t.getDerivedStateFromProps)&&(no(e,t,s,n),r.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof r.getSnapshotBeforeUpdate||"function"!=typeof r.UNSAFE_componentWillMount&&"function"!=typeof r.componentWillMount||(t=r.state,"function"==typeof r.componentWillMount&&r.componentWillMount(),"function"==typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),t!==r.state&&io.enqueueReplaceState(r,r.state,null),zs(e,n,r,i),r.state=e.memoizedState),"function"==typeof r.componentDidMount&&(e.flags|=4194308)}function lo(e,t){try{var n="",i=t;do{n+=j(i),i=i.return}while(i);var r=n}catch(e){r="\nError generating stack: "+e.message+"\n"+e.stack}return{value:e,source:t,stack:r,digest:null}}function co(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function uo(e,t){try{console.error(t.value)}catch(e){setTimeout(function(){throw e})}}var ho="function"==typeof WeakMap?WeakMap:Map;function fo(e,t,n){(n=Bs(-1,n)).tag=3,n.payload={element:null};var i=t.value;return n.callback=function(){Vl||(Vl=!0,ql=i),uo(0,t)},n}function po(e,t,n){(n=Bs(-1,n)).tag=3;var i=e.type.getDerivedStateFromError;if("function"==typeof i){var r=t.value;n.payload=function(){return i(r)},n.callback=function(){uo(0,t)}}var s=e.stateNode;return null!==s&&"function"==typeof s.componentDidCatch&&(n.callback=function(){uo(0,t),"function"!=typeof i&&(null===Hl?Hl=new Set([this]):Hl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function go(e,t,n){var i=e.pingCache;if(null===i){i=e.pingCache=new ho;var r=new Set;i.set(t,r)}else void 0===(r=i.get(t))&&(r=new Set,i.set(t,r));r.has(n)||(r.add(n),e=_c.bind(null,e,t,n),t.then(e,e))}function mo(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function vo(e,t,n,i,r){return 1&e.mode?(e.flags|=65536,e.lanes=r,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Bs(-1,1)).tag=2,Us(n,t,1))),n.lanes|=1),e)}var yo=E.ReactCurrentOwner,bo=!1;function Eo(e,t,n,i){t.child=null===e?Ss(t,null,n,i):Es(t,e.child,n,i)}function So(e,t,n,i,r){n=n.render;var s=t.ref;return Rs(t,r),i=ga(e,t,n,i,s,r),n=ma(),null===e||bo?(rs&&n&&es(t),t.flags|=1,Eo(e,t,i,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Vo(e,t,r))}function wo(e,t,n,i,r){if(null===e){var s=n.type;return"function"!=typeof s||Dc(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Oc(n.type,null,i,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,To(e,t,s,i,r))}if(s=e.child,0===(e.lanes&r)){var a=s.memoizedProps;if((n=null!==(n=n.compare)?n:li)(a,i)&&e.ref===t.ref)return Vo(e,t,r)}return t.flags|=1,(e=Pc(s,i)).ref=t.ref,e.return=t,t.child=e}function To(e,t,n,i,r){if(null!==e){var s=e.memoizedProps;if(li(s,i)&&e.ref===t.ref){if(bo=!1,t.pendingProps=i=s,0===(e.lanes&r))return t.lanes=e.lanes,Vo(e,t,r);131072&e.flags&&(bo=!0)}}return xo(e,t,n,i,r)}function ko(e,t,n){var i=t.pendingProps,r=i.children,s=null!==e?e.memoizedState:null;if("hidden"===i.mode)if(1&t.mode){if(!(1073741824&n))return e=null!==s?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,xr(Pl,Dl),Dl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=null!==s?s.baseLanes:n,xr(Pl,Dl),Dl|=i}else t.memoizedState={baseLanes:0,cachePool:null,transitions:null},xr(Pl,Dl),Dl|=n;else null!==s?(i=s.baseLanes|n,t.memoizedState=null):i=n,xr(Pl,Dl),Dl|=i;return Eo(e,t,r,n),t.child}function _o(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function xo(e,t,n,i,r){var s=Dr(n)?Ir:Ar.current;return s=Cr(t,s),Rs(t,r),n=ga(e,t,n,i,s,r),i=ma(),null===e||bo?(rs&&i&&es(t),t.flags|=1,Eo(e,t,n,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Vo(e,t,r))}function Lo(e,t,n,i,r){if(Dr(n)){var s=!0;Mr(t)}else s=!1;if(Rs(t,r),null===t.stateNode)Go(e,t),so(t,n,i),oo(t,n,i,r),i=!0;else if(null===e){var a=t.stateNode,o=t.memoizedProps;a.props=o;var l=a.context,c=n.contextType;c="object"==typeof c&&null!==c?Is(c):Cr(t,c=Dr(n)?Ir:Ar.current);var u=n.getDerivedStateFromProps,h="function"==typeof u||"function"==typeof a.getSnapshotBeforeUpdate;h||"function"!=typeof a.UNSAFE_componentWillReceiveProps&&"function"!=typeof a.componentWillReceiveProps||(o!==i||l!==c)&&ao(t,a,i,c),Ns=!1;var d=t.memoizedState;a.state=d,zs(t,i,a,r),l=t.memoizedState,o!==i||d!==l||Rr.current||Ns?("function"==typeof u&&(no(t,n,u,i),l=t.memoizedState),(o=Ns||ro(t,n,o,i,d,l,c))?(h||"function"!=typeof a.UNSAFE_componentWillMount&&"function"!=typeof a.componentWillMount||("function"==typeof a.componentWillMount&&a.componentWillMount(),"function"==typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"==typeof a.componentDidMount&&(t.flags|=4194308)):("function"==typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=l),a.props=i,a.state=l,a.context=c,i=o):("function"==typeof a.componentDidMount&&(t.flags|=4194308),i=!1)}else{a=t.stateNode,Fs(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:to(t.type,o),a.props=c,h=t.pendingProps,d=a.context,l="object"==typeof(l=n.contextType)&&null!==l?Is(l):Cr(t,l=Dr(n)?Ir:Ar.current);var f=n.getDerivedStateFromProps;(u="function"==typeof f||"function"==typeof a.getSnapshotBeforeUpdate)||"function"!=typeof a.UNSAFE_componentWillReceiveProps&&"function"!=typeof a.componentWillReceiveProps||(o!==h||d!==l)&&ao(t,a,i,l),Ns=!1,d=t.memoizedState,a.state=d,zs(t,i,a,r);var p=t.memoizedState;o!==h||d!==p||Rr.current||Ns?("function"==typeof f&&(no(t,n,f,i),p=t.memoizedState),(c=Ns||ro(t,n,c,i,d,p,l)||!1)?(u||"function"!=typeof a.UNSAFE_componentWillUpdate&&"function"!=typeof a.componentWillUpdate||("function"==typeof a.componentWillUpdate&&a.componentWillUpdate(i,p,l),"function"==typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(i,p,l)),"function"==typeof a.componentDidUpdate&&(t.flags|=4),"function"==typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof a.componentDidUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!=typeof a.getSnapshotBeforeUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=p),a.props=i,a.state=p,a.context=l,i=c):("function"!=typeof a.componentDidUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!=typeof a.getSnapshotBeforeUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),i=!1)}return Ao(e,t,n,i,s,r)}function Ao(e,t,n,i,r,s){_o(e,t);var a=!!(128&t.flags);if(!i&&!a)return r&&Fr(t,n,!1),Vo(e,t,s);i=t.stateNode,yo.current=t;var o=a&&"function"!=typeof n.getDerivedStateFromError?null:i.render();return t.flags|=1,null!==e&&a?(t.child=Es(t,e.child,null,s),t.child=Es(t,null,o,s)):Eo(e,t,o,s),t.memoizedState=i.state,r&&Fr(t,n,!0),t.child}function Ro(e){var t=e.stateNode;t.pendingContext?Or(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Or(0,t.context,!1),Ys(e,t.containerInfo)}function Io(e,t,n,i,r){return fs(),ps(r),t.flags|=256,Eo(e,t,n,i),t.child}var Co,Do,Po,Oo,No={dehydrated:null,treeContext:null,retryLane:0};function Mo(e){return{baseLanes:e,cachePool:null,transitions:null}}function Fo(e,t,n){var i,r=t.pendingProps,a=Js.current,o=!1,l=!!(128&t.flags);if((i=l)||(i=(null===e||null!==e.memoizedState)&&!!(2&a)),i?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(a|=1),xr(Js,1&a),null===e)return cs(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(1&t.mode?"$!"===e.data?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=r.children,e=r.fallback,o?(r=t.mode,o=t.child,l={mode:"hidden",children:l},1&r||null===o?o=Mc(l,r,0,null):(o.childLanes=0,o.pendingProps=l),e=Nc(e,r,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Mo(n),t.memoizedState=No,e):Bo(t,l));if(null!==(a=e.memoizedState)&&null!==(i=a.dehydrated))return function(e,t,n,i,r,a,o){if(n)return 256&t.flags?(t.flags&=-257,Uo(e,t,o,i=co(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(a=i.fallback,r=t.mode,i=Mc({mode:"visible",children:i.children},r,0,null),(a=Nc(a,r,o,null)).flags|=2,i.return=t,a.return=t,i.sibling=a,t.child=i,1&t.mode&&Es(t,e.child,null,o),t.child.memoizedState=Mo(o),t.memoizedState=No,a);if(!(1&t.mode))return Uo(e,t,o,null);if("$!"===r.data){if(i=r.nextSibling&&r.nextSibling.dataset)var l=i.dgst;return i=l,Uo(e,t,o,i=co(a=Error(s(419)),i,void 0))}if(l=0!==(o&e.childLanes),bo||l){if(null!==(i=Rl)){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}0!==(r=0!==(r&(i.suspendedLanes|o))?0:r)&&r!==a.retryLane&&(a.retryLane=r,Os(e,r),nc(i,e,r,-1))}return gc(),Uo(e,t,o,i=co(Error(s(421))))}return"$?"===r.data?(t.flags|=128,t.child=e.child,t=Lc.bind(null,e),r._reactRetry=t,null):(e=a.treeContext,is=cr(r.nextSibling),ns=t,rs=!0,ss=null,null!==e&&(Wr[Kr++]=Xr,Wr[Kr++]=Qr,Wr[Kr++]=Yr,Xr=e.id,Qr=e.overflow,Yr=t),(t=Bo(t,i.children)).flags|=4096,t)}(e,t,l,r,i,a,n);if(o){o=r.fallback,l=t.mode,i=(a=e.child).sibling;var c={mode:"hidden",children:r.children};return 1&l||t.child===a?(r=Pc(a,c)).subtreeFlags=14680064&a.subtreeFlags:((r=t.child).childLanes=0,r.pendingProps=c,t.deletions=null),null!==i?o=Pc(i,o):(o=Nc(o,l,n,null)).flags|=2,o.return=t,r.return=t,r.sibling=o,t.child=r,r=o,o=t.child,l=null===(l=e.child.memoizedState)?Mo(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~n,t.memoizedState=No,r}return e=(o=e.child).sibling,r=Pc(o,{mode:"visible",children:r.children}),!(1&t.mode)&&(r.lanes=n),r.return=t,r.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Bo(e,t){return(t=Mc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Uo(e,t,n,i){return null!==i&&ps(i),Es(t,e.child,null,n),(e=Bo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function $o(e,t,n){e.lanes|=t;var i=e.alternate;null!==i&&(i.lanes|=t),As(e.return,t,n)}function jo(e,t,n,i,r){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function zo(e,t,n){var i=t.pendingProps,r=i.revealOrder,s=i.tail;if(Eo(e,t,i.children,n),2&(i=Js.current))i=1&i|2,t.flags|=128;else{if(null!==e&&128&e.flags)e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&$o(e,n,t);else if(19===e.tag)$o(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(xr(Js,i),1&t.mode)switch(r){case"forwards":for(n=t.child,r=null;null!==n;)null!==(e=n.alternate)&&null===ea(e)&&(r=n),n=n.sibling;null===(n=r)?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),jo(t,!1,r,n,s);break;case"backwards":for(n=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===ea(e)){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}jo(t,!0,n,null,s);break;case"together":jo(t,!1,null,null,void 0);break;default:t.memoizedState=null}else t.memoizedState=null;return t.child}function Go(e,t){!(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Vo(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ml|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Pc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Pc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function qo(e,t){if(!rs)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?t||null===e.tail?e.tail=null:e.tail.sibling=null:i.sibling=null}}function Ho(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,i=0;if(t)for(var r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=14680064&r.subtreeFlags,i|=14680064&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function Wo(e,t,n){var i=t.pendingProps;switch(ts(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ho(t),null;case 1:case 17:return Dr(t.type)&&Pr(),Ho(t),null;case 3:return i=t.stateNode,Xs(),_r(Rr),_r(Ar),na(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==e&&null!==e.child||(hs(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&!(256&t.flags)||(t.flags|=1024,null!==ss&&(ac(ss),ss=null))),Do(e,t),Ho(t),null;case 5:Zs(t);var r=Ks(Ws.current);if(n=t.type,null!==e&&null!=t.stateNode)Po(e,t,n,i,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(null===t.stateNode)throw Error(s(166));return Ho(t),null}if(e=Ks(qs.current),hs(t)){i=t.stateNode,n=t.type;var a=t.memoizedProps;switch(i[dr]=t,i[fr]=a,e=!!(1&t.mode),n){case"dialog":Ui("cancel",i),Ui("close",i);break;case"iframe":case"object":case"embed":Ui("load",i);break;case"video":case"audio":for(r=0;r<Ni.length;r++)Ui(Ni[r],i);break;case"source":Ui("error",i);break;case"img":case"image":case"link":Ui("error",i),Ui("load",i);break;case"details":Ui("toggle",i);break;case"input":X(i,a),Ui("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!a.multiple},Ui("invalid",i);break;case"textarea":re(i,a),Ui("invalid",i)}for(var l in ye(n,a),r=null,a)if(a.hasOwnProperty(l)){var c=a[l];"children"===l?"string"==typeof c?i.textContent!==c&&(!0!==a.suppressHydrationWarning&&Zi(i.textContent,c,e),r=["children",c]):"number"==typeof c&&i.textContent!==""+c&&(!0!==a.suppressHydrationWarning&&Zi(i.textContent,c,e),r=["children",""+c]):o.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Ui("scroll",i)}switch(n){case"input":H(i),J(i,a,!0);break;case"textarea":H(i),ae(i);break;case"select":case"option":break;default:"function"==typeof a.onClick&&(i.onclick=Ji)}i=r,t.updateQueue=i,null!==i&&(t.flags|=4)}else{l=9===r.nodeType?r:r.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof i.is?e=l.createElement(n,{is:i.is}):(e=l.createElement(n),"select"===n&&(l=e,i.multiple?l.multiple=!0:i.size&&(l.size=i.size))):e=l.createElementNS(e,n),e[dr]=t,e[fr]=i,Co(e,t,!1,!1),t.stateNode=e;e:{switch(l=be(n,i),n){case"dialog":Ui("cancel",e),Ui("close",e),r=i;break;case"iframe":case"object":case"embed":Ui("load",e),r=i;break;case"video":case"audio":for(r=0;r<Ni.length;r++)Ui(Ni[r],e);r=i;break;case"source":Ui("error",e),r=i;break;case"img":case"image":case"link":Ui("error",e),Ui("load",e),r=i;break;case"details":Ui("toggle",e),r=i;break;case"input":X(e,i),r=Y(e,i),Ui("invalid",e);break;case"option":default:r=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},r=F({},i,{value:void 0}),Ui("invalid",e);break;case"textarea":re(e,i),r=ie(e,i),Ui("invalid",e)}for(a in ye(n,r),c=r)if(c.hasOwnProperty(a)){var u=c[a];"style"===a?me(e,u):"dangerouslySetInnerHTML"===a?null!=(u=u?u.__html:void 0)&&he(e,u):"children"===a?"string"==typeof u?("textarea"!==n||""!==u)&&de(e,u):"number"==typeof u&&de(e,""+u):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(o.hasOwnProperty(a)?null!=u&&"onScroll"===a&&Ui("scroll",e):null!=u&&b(e,a,u,l))}switch(n){case"input":H(e),J(e,i,!1);break;case"textarea":H(e),ae(e);break;case"option":null!=i.value&&e.setAttribute("value",""+V(i.value));break;case"select":e.multiple=!!i.multiple,null!=(a=i.value)?ne(e,!!i.multiple,a,!1):null!=i.defaultValue&&ne(e,!!i.multiple,i.defaultValue,!0);break;default:"function"==typeof r.onClick&&(e.onclick=Ji)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Ho(t),null;case 6:if(e&&null!=t.stateNode)Oo(e,t,e.memoizedProps,i);else{if("string"!=typeof i&&null===t.stateNode)throw Error(s(166));if(n=Ks(Ws.current),Ks(qs.current),hs(t)){if(i=t.stateNode,n=t.memoizedProps,i[dr]=t,(a=i.nodeValue!==n)&&null!==(e=ns))switch(e.tag){case 3:Zi(i.nodeValue,n,!!(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Zi(i.nodeValue,n,!!(1&e.mode))}a&&(t.flags|=4)}else(i=(9===n.nodeType?n:n.ownerDocument).createTextNode(i))[dr]=t,t.stateNode=i}return Ho(t),null;case 13:if(_r(Js),i=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(rs&&null!==is&&1&t.mode&&!(128&t.flags))ds(),fs(),t.flags|=98560,a=!1;else if(a=hs(t),null!==i&&null!==i.dehydrated){if(null===e){if(!a)throw Error(s(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(s(317));a[dr]=t}else fs(),!(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Ho(t),a=!1}else null!==ss&&(ac(ss),ss=null),a=!0;if(!a)return 65536&t.flags?t:null}return 128&t.flags?(t.lanes=n,t):((i=null!==i)!=(null!==e&&null!==e.memoizedState)&&i&&(t.child.flags|=8192,1&t.mode&&(null===e||1&Js.current?0===Ol&&(Ol=3):gc())),null!==t.updateQueue&&(t.flags|=4),Ho(t),null);case 4:return Xs(),Do(e,t),null===e&&zi(t.stateNode.containerInfo),Ho(t),null;case 10:return Ls(t.type._context),Ho(t),null;case 19:if(_r(Js),null===(a=t.memoizedState))return Ho(t),null;if(i=!!(128&t.flags),null===(l=a.rendering))if(i)qo(a,!1);else{if(0!==Ol||null!==e&&128&e.flags)for(e=t.child;null!==e;){if(null!==(l=ea(e))){for(t.flags|=128,qo(a,!1),null!==(i=l.updateQueue)&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=n,n=t.child;null!==n;)e=i,(a=n).flags&=14680066,null===(l=a.alternate)?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,e=l.dependencies,a.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return xr(Js,1&Js.current|2),t.child}e=e.sibling}null!==a.tail&&Qe()>zl&&(t.flags|=128,i=!0,qo(a,!1),t.lanes=4194304)}else{if(!i)if(null!==(e=ea(l))){if(t.flags|=128,i=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),qo(a,!0),null===a.tail&&"hidden"===a.tailMode&&!l.alternate&&!rs)return Ho(t),null}else 2*Qe()-a.renderingStartTime>zl&&1073741824!==n&&(t.flags|=128,i=!0,qo(a,!1),t.lanes=4194304);a.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=a.last)?n.sibling=l:t.child=l,a.last=l)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Qe(),t.sibling=null,n=Js.current,xr(Js,i?1&n|2:1&n),t):(Ho(t),null);case 22:case 23:return hc(),i=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==i&&(t.flags|=8192),i&&1&t.mode?!!(1073741824&Dl)&&(Ho(t),6&t.subtreeFlags&&(t.flags|=8192)):Ho(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function Ko(e,t){switch(ts(t),t.tag){case 1:return Dr(t.type)&&Pr(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Xs(),_r(Rr),_r(Ar),na(),65536&(e=t.flags)&&!(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Zs(t),null;case 13:if(_r(Js),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));fs()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return _r(Js),null;case 4:return Xs(),null;case 10:return Ls(t.type._context),null;case 22:case 23:return hc(),null;default:return null}}Co=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Do=function(){},Po=function(e,t,n,i){var r=e.memoizedProps;if(r!==i){e=t.stateNode,Ks(qs.current);var s,a=null;switch(n){case"input":r=Y(e,r),i=Y(e,i),a=[];break;case"select":r=F({},r,{value:void 0}),i=F({},i,{value:void 0}),a=[];break;case"textarea":r=ie(e,r),i=ie(e,i),a=[];break;default:"function"!=typeof r.onClick&&"function"==typeof i.onClick&&(e.onclick=Ji)}for(u in ye(n,i),n=null,r)if(!i.hasOwnProperty(u)&&r.hasOwnProperty(u)&&null!=r[u])if("style"===u){var l=r[u];for(s in l)l.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(o.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in i){var c=i[u];if(l=null!=r?r[u]:void 0,i.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(s in l)!l.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in c)c.hasOwnProperty(s)&&l[s]!==c[s]&&(n||(n={}),n[s]=c[s])}else n||(a||(a=[]),a.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(a=a||[]).push(u,c)):"children"===u?"string"!=typeof c&&"number"!=typeof c||(a=a||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(o.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Ui("scroll",e),a||l===c||(a=[])):(a=a||[]).push(u,c))}n&&(a=a||[]).push("style",n);var u=a;(t.updateQueue=u)&&(t.flags|=4)}},Oo=function(e,t,n,i){n!==i&&(t.flags|=4)};var Yo=!1,Xo=!1,Qo="function"==typeof WeakSet?WeakSet:Set,Zo=null;function Jo(e,t){var n=e.ref;if(null!==n)if("function"==typeof n)try{n(null)}catch(n){kc(e,t,n)}else n.current=null}function el(e,t,n){try{n()}catch(n){kc(e,t,n)}}var tl=!1;function nl(e,t,n){var i=t.updateQueue;if(null!==(i=null!==i?i.lastEffect:null)){var r=i=i.next;do{if((r.tag&e)===e){var s=r.destroy;r.destroy=void 0,void 0!==s&&el(t,n,s)}r=r.next}while(r!==i)}}function il(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var i=n.create;n.destroy=i()}n=n.next}while(n!==t)}}function rl(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"==typeof t?t(e):t.current=e}}function sl(e){var t=e.alternate;null!==t&&(e.alternate=null,sl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&null!==(t=e.stateNode)&&(delete t[dr],delete t[fr],delete t[gr],delete t[mr],delete t[vr]),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function al(e){return 5===e.tag||3===e.tag||4===e.tag}function ol(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||al(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!=(n=n._reactRootContainer)||null!==t.onclick||(t.onclick=Ji));else if(4!==i&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}function cl(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==i&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}var ul=null,hl=!1;function dl(e,t,n){for(n=n.child;null!==n;)fl(e,t,n),n=n.sibling}function fl(e,t,n){if(st&&"function"==typeof st.onCommitFiberUnmount)try{st.onCommitFiberUnmount(rt,n)}catch(e){}switch(n.tag){case 5:Xo||Jo(n,t);case 6:var i=ul,r=hl;ul=null,dl(e,t,n),hl=r,null!==(ul=i)&&(hl?(e=ul,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):ul.removeChild(n.stateNode));break;case 18:null!==ul&&(hl?(e=ul,n=n.stateNode,8===e.nodeType?lr(e.parentNode,n):1===e.nodeType&&lr(e,n),zt(e)):lr(ul,n.stateNode));break;case 4:i=ul,r=hl,ul=n.stateNode.containerInfo,hl=!0,dl(e,t,n),ul=i,hl=r;break;case 0:case 11:case 14:case 15:if(!Xo&&null!==(i=n.updateQueue)&&null!==(i=i.lastEffect)){r=i=i.next;do{var s=r,a=s.destroy;s=s.tag,void 0!==a&&(2&s||4&s)&&el(n,t,a),r=r.next}while(r!==i)}dl(e,t,n);break;case 1:if(!Xo&&(Jo(n,t),"function"==typeof(i=n.stateNode).componentWillUnmount))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(e){kc(n,t,e)}dl(e,t,n);break;case 21:dl(e,t,n);break;case 22:1&n.mode?(Xo=(i=Xo)||null!==n.memoizedState,dl(e,t,n),Xo=i):dl(e,t,n);break;default:dl(e,t,n)}}function pl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Qo),t.forEach(function(t){var i=Ac.bind(null,e,t);n.has(t)||(n.add(t),t.then(i,i))})}}function gl(e,t){var n=t.deletions;if(null!==n)for(var i=0;i<n.length;i++){var r=n[i];try{var a=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,hl=!1;break e;case 3:case 4:ul=l.stateNode.containerInfo,hl=!0;break e}l=l.return}if(null===ul)throw Error(s(160));fl(a,o,r),ul=null,hl=!1;var c=r.alternate;null!==c&&(c.return=null),r.return=null}catch(e){kc(r,t,e)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)ml(t,e),t=t.sibling}function ml(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(gl(t,e),vl(e),4&i){try{nl(3,e,e.return),il(3,e)}catch(t){kc(e,e.return,t)}try{nl(5,e,e.return)}catch(t){kc(e,e.return,t)}}break;case 1:gl(t,e),vl(e),512&i&&null!==n&&Jo(n,n.return);break;case 5:if(gl(t,e),vl(e),512&i&&null!==n&&Jo(n,n.return),32&e.flags){var r=e.stateNode;try{de(r,"")}catch(t){kc(e,e.return,t)}}if(4&i&&null!=(r=e.stateNode)){var a=e.memoizedProps,o=null!==n?n.memoizedProps:a,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===a.type&&null!=a.name&&Q(r,a),be(l,o);var u=be(l,a);for(o=0;o<c.length;o+=2){var h=c[o],d=c[o+1];"style"===h?me(r,d):"dangerouslySetInnerHTML"===h?he(r,d):"children"===h?de(r,d):b(r,h,d,u)}switch(l){case"input":Z(r,a);break;case"textarea":se(r,a);break;case"select":var f=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!a.multiple;var p=a.value;null!=p?ne(r,!!a.multiple,p,!1):f!==!!a.multiple&&(null!=a.defaultValue?ne(r,!!a.multiple,a.defaultValue,!0):ne(r,!!a.multiple,a.multiple?[]:"",!1))}r[fr]=a}catch(t){kc(e,e.return,t)}}break;case 6:if(gl(t,e),vl(e),4&i){if(null===e.stateNode)throw Error(s(162));r=e.stateNode,a=e.memoizedProps;try{r.nodeValue=a}catch(t){kc(e,e.return,t)}}break;case 3:if(gl(t,e),vl(e),4&i&&null!==n&&n.memoizedState.isDehydrated)try{zt(t.containerInfo)}catch(t){kc(e,e.return,t)}break;case 4:default:gl(t,e),vl(e);break;case 13:gl(t,e),vl(e),8192&(r=e.child).flags&&(a=null!==r.memoizedState,r.stateNode.isHidden=a,!a||null!==r.alternate&&null!==r.alternate.memoizedState||(jl=Qe())),4&i&&pl(e);break;case 22:if(h=null!==n&&null!==n.memoizedState,1&e.mode?(Xo=(u=Xo)||h,gl(t,e),Xo=u):gl(t,e),vl(e),8192&i){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!h&&1&e.mode)for(Zo=e,h=e.child;null!==h;){for(d=Zo=h;null!==Zo;){switch(p=(f=Zo).child,f.tag){case 0:case 11:case 14:case 15:nl(4,f,f.return);break;case 1:Jo(f,f.return);var g=f.stateNode;if("function"==typeof g.componentWillUnmount){i=f,n=f.return;try{t=i,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(e){kc(i,n,e)}}break;case 5:Jo(f,f.return);break;case 22:if(null!==f.memoizedState){Sl(d);continue}}null!==p?(p.return=f,Zo=p):Sl(d)}h=h.sibling}e:for(h=null,d=e;;){if(5===d.tag){if(null===h){h=d;try{r=d.stateNode,u?"function"==typeof(a=r.style).setProperty?a.setProperty("display","none","important"):a.display="none":(l=d.stateNode,o=null!=(c=d.memoizedProps.style)&&c.hasOwnProperty("display")?c.display:null,l.style.display=ge("display",o))}catch(t){kc(e,e.return,t)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(t){kc(e,e.return,t)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===e)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;null===d.sibling;){if(null===d.return||d.return===e)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:gl(t,e),vl(e),4&i&&pl(e);case 21:}}function vl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(al(n)){var i=n;break e}n=n.return}throw Error(s(160))}switch(i.tag){case 5:var r=i.stateNode;32&i.flags&&(de(r,""),i.flags&=-33),cl(e,ol(e),r);break;case 3:case 4:var a=i.stateNode.containerInfo;ll(e,ol(e),a);break;default:throw Error(s(161))}}catch(t){kc(e,e.return,t)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function yl(e,t,n){Zo=e,bl(e,t,n)}function bl(e,t,n){for(var i=!!(1&e.mode);null!==Zo;){var r=Zo,s=r.child;if(22===r.tag&&i){var a=null!==r.memoizedState||Yo;if(!a){var o=r.alternate,l=null!==o&&null!==o.memoizedState||Xo;o=Yo;var c=Xo;if(Yo=a,(Xo=l)&&!c)for(Zo=r;null!==Zo;)l=(a=Zo).child,22===a.tag&&null!==a.memoizedState?wl(r):null!==l?(l.return=a,Zo=l):wl(r);for(;null!==s;)Zo=s,bl(s,t,n),s=s.sibling;Zo=r,Yo=o,Xo=c}El(e)}else 8772&r.subtreeFlags&&null!==s?(s.return=r,Zo=s):El(e)}}function El(e){for(;null!==Zo;){var t=Zo;if(8772&t.flags){var n=t.alternate;try{if(8772&t.flags)switch(t.tag){case 0:case 11:case 15:Xo||il(5,t);break;case 1:var i=t.stateNode;if(4&t.flags&&!Xo)if(null===n)i.componentDidMount();else{var r=t.elementType===t.type?n.memoizedProps:to(t.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;null!==a&&Gs(t,a,i);break;case 3:var o=t.updateQueue;if(null!==o){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Gs(t,o,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var h=u.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&zt(d)}}}break;default:throw Error(s(163))}Xo||512&t.flags&&rl(t)}catch(e){kc(t,t.return,e)}}if(t===e){Zo=null;break}if(null!==(n=t.sibling)){n.return=t.return,Zo=n;break}Zo=t.return}}function Sl(e){for(;null!==Zo;){var t=Zo;if(t===e){Zo=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Zo=n;break}Zo=t.return}}function wl(e){for(;null!==Zo;){var t=Zo;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{il(4,t)}catch(e){kc(t,n,e)}break;case 1:var i=t.stateNode;if("function"==typeof i.componentDidMount){var r=t.return;try{i.componentDidMount()}catch(e){kc(t,r,e)}}var s=t.return;try{rl(t)}catch(e){kc(t,s,e)}break;case 5:var a=t.return;try{rl(t)}catch(e){kc(t,a,e)}}}catch(e){kc(t,t.return,e)}if(t===e){Zo=null;break}var o=t.sibling;if(null!==o){o.return=t.return,Zo=o;break}Zo=t.return}}var Tl,kl=Math.ceil,_l=E.ReactCurrentDispatcher,xl=E.ReactCurrentOwner,Ll=E.ReactCurrentBatchConfig,Al=0,Rl=null,Il=null,Cl=0,Dl=0,Pl=kr(0),Ol=0,Nl=null,Ml=0,Fl=0,Bl=0,Ul=null,$l=null,jl=0,zl=1/0,Gl=null,Vl=!1,ql=null,Hl=null,Wl=!1,Kl=null,Yl=0,Xl=0,Ql=null,Zl=-1,Jl=0;function ec(){return 6&Al?Qe():-1!==Zl?Zl:Zl=Qe()}function tc(e){return 1&e.mode?2&Al&&0!==Cl?Cl&-Cl:null!==gs.transition?(0===Jl&&(Jl=gt()),Jl):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Xt(e.type):1}function nc(e,t,n,i){if(50<Xl)throw Xl=0,Ql=null,Error(s(185));vt(e,n,i),2&Al&&e===Rl||(e===Rl&&(!(2&Al)&&(Fl|=n),4===Ol&&oc(e,Cl)),ic(e,i),1===n&&0===Al&&!(1&t.mode)&&(zl=Qe()+500,Ur&&zr()))}function ic(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,r=e.expirationTimes,s=e.pendingLanes;0<s;){var a=31-at(s),o=1<<a,l=r[a];-1===l?0!==(o&n)&&0===(o&i)||(r[a]=ft(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}(e,t);var i=dt(e,e===Rl?Cl:0);if(0===i)null!==n&&Ke(n),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(null!=n&&Ke(n),1===t)0===e.tag?function(e){Ur=!0,jr(e)}(lc.bind(null,e)):jr(lc.bind(null,e)),ar(function(){!(6&Al)&&zr()}),n=null;else{switch(Et(i)){case 1:n=Je;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=it}n=Rc(n,rc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function rc(e,t){if(Zl=-1,Jl=0,6&Al)throw Error(s(327));var n=e.callbackNode;if(wc()&&e.callbackNode!==n)return null;var i=dt(e,e===Rl?Cl:0);if(0===i)return null;if(30&i||0!==(i&e.expiredLanes)||t)t=mc(e,i);else{t=i;var r=Al;Al|=2;var a=pc();for(Rl===e&&Cl===t||(Gl=null,zl=Qe()+500,dc(e,t));;)try{yc();break}catch(t){fc(e,t)}xs(),_l.current=a,Al=r,null!==Il?t=0:(Rl=null,Cl=0,t=Ol)}if(0!==t){if(2===t&&0!==(r=pt(e))&&(i=r,t=sc(e,r)),1===t)throw n=Nl,dc(e,0),oc(e,i),ic(e,Qe()),n;if(6===t)oc(e,i);else{if(r=e.current.alternate,!(30&i||function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!oi(s(),r))return!1}catch(e){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(r)||(t=mc(e,i),2===t&&(a=pt(e),0!==a&&(i=a,t=sc(e,a))),1!==t)))throw n=Nl,dc(e,0),oc(e,i),ic(e,Qe()),n;switch(e.finishedWork=r,e.finishedLanes=i,t){case 0:case 1:throw Error(s(345));case 2:case 5:Sc(e,$l,Gl);break;case 3:if(oc(e,i),(130023424&i)===i&&10<(t=jl+500-Qe())){if(0!==dt(e,0))break;if(((r=e.suspendedLanes)&i)!==i){ec(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=ir(Sc.bind(null,e,$l,Gl),t);break}Sc(e,$l,Gl);break;case 4:if(oc(e,i),(4194240&i)===i)break;for(t=e.eventTimes,r=-1;0<i;){var o=31-at(i);a=1<<o,(o=t[o])>r&&(r=o),i&=~a}if(i=r,10<(i=(120>(i=Qe()-i)?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*kl(i/1960))-i)){e.timeoutHandle=ir(Sc.bind(null,e,$l,Gl),i);break}Sc(e,$l,Gl);break;default:throw Error(s(329))}}}return ic(e,Qe()),e.callbackNode===n?rc.bind(null,e):null}function sc(e,t){var n=Ul;return e.current.memoizedState.isDehydrated&&(dc(e,t).flags|=256),2!==(e=mc(e,t))&&(t=$l,$l=n,null!==t&&ac(t)),e}function ac(e){null===$l?$l=e:$l.push.apply($l,e)}function oc(e,t){for(t&=~Bl,t&=~Fl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-at(t),i=1<<n;e[n]=-1,t&=~i}}function lc(e){if(6&Al)throw Error(s(327));wc();var t=dt(e,0);if(!(1&t))return ic(e,Qe()),null;var n=mc(e,t);if(0!==e.tag&&2===n){var i=pt(e);0!==i&&(t=i,n=sc(e,i))}if(1===n)throw n=Nl,dc(e,0),oc(e,t),ic(e,Qe()),n;if(6===n)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Sc(e,$l,Gl),ic(e,Qe()),null}function cc(e,t){var n=Al;Al|=1;try{return e(t)}finally{0===(Al=n)&&(zl=Qe()+500,Ur&&zr())}}function uc(e){null!==Kl&&0===Kl.tag&&!(6&Al)&&wc();var t=Al;Al|=1;var n=Ll.transition,i=bt;try{if(Ll.transition=null,bt=1,e)return e()}finally{bt=i,Ll.transition=n,!(6&(Al=t))&&zr()}}function hc(){Dl=Pl.current,_r(Pl)}function dc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,rr(n)),null!==Il)for(n=Il.return;null!==n;){var i=n;switch(ts(i),i.tag){case 1:null!=(i=i.type.childContextTypes)&&Pr();break;case 3:Xs(),_r(Rr),_r(Ar),na();break;case 5:Zs(i);break;case 4:Xs();break;case 13:case 19:_r(Js);break;case 10:Ls(i.type._context);break;case 22:case 23:hc()}n=n.return}if(Rl=e,Il=e=Pc(e.current,null),Cl=Dl=t,Ol=0,Nl=null,Bl=Fl=Ml=0,$l=Ul=null,null!==Cs){for(t=0;t<Cs.length;t++)if(null!==(i=(n=Cs[t]).interleaved)){n.interleaved=null;var r=i.next,s=n.pending;if(null!==s){var a=s.next;s.next=r,i.next=a}n.pending=i}Cs=null}return e}function fc(e,t){for(;;){var n=Il;try{if(xs(),ia.current=Qa,ca){for(var i=aa.memoizedState;null!==i;){var r=i.queue;null!==r&&(r.pending=null),i=i.next}ca=!1}if(sa=0,la=oa=aa=null,ua=!1,ha=0,xl.current=null,null===n||null===n.return){Ol=1,Nl=t,Il=null;break}e:{var a=e,o=n.return,l=n,c=t;if(t=Cl,l.flags|=32768,null!==c&&"object"==typeof c&&"function"==typeof c.then){var u=c,h=l,d=h.tag;if(!(1&h.mode||0!==d&&11!==d&&15!==d)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=mo(o);if(null!==p){p.flags&=-257,vo(p,o,l,0,t),1&p.mode&&go(a,u,t),c=u;var g=(t=p).updateQueue;if(null===g){var m=new Set;m.add(c),t.updateQueue=m}else g.add(c);break e}if(!(1&t)){go(a,u,t),gc();break e}c=Error(s(426))}else if(rs&&1&l.mode){var v=mo(o);if(null!==v){!(65536&v.flags)&&(v.flags|=256),vo(v,o,l,0,t),ps(lo(c,l));break e}}a=c=lo(c,l),4!==Ol&&(Ol=2),null===Ul?Ul=[a]:Ul.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t,js(a,fo(0,c,t));break e;case 1:l=c;var y=a.type,b=a.stateNode;if(!(128&a.flags||"function"!=typeof y.getDerivedStateFromError&&(null===b||"function"!=typeof b.componentDidCatch||null!==Hl&&Hl.has(b)))){a.flags|=65536,t&=-t,a.lanes|=t,js(a,po(a,l,t));break e}}a=a.return}while(null!==a)}Ec(n)}catch(e){t=e,Il===n&&null!==n&&(Il=n=n.return);continue}break}}function pc(){var e=_l.current;return _l.current=Qa,null===e?Qa:e}function gc(){0!==Ol&&3!==Ol&&2!==Ol||(Ol=4),null===Rl||!(268435455&Ml)&&!(268435455&Fl)||oc(Rl,Cl)}function mc(e,t){var n=Al;Al|=2;var i=pc();for(Rl===e&&Cl===t||(Gl=null,dc(e,t));;)try{vc();break}catch(t){fc(e,t)}if(xs(),Al=n,_l.current=i,null!==Il)throw Error(s(261));return Rl=null,Cl=0,Ol}function vc(){for(;null!==Il;)bc(Il)}function yc(){for(;null!==Il&&!Ye();)bc(Il)}function bc(e){var t=Tl(e.alternate,e,Dl);e.memoizedProps=e.pendingProps,null===t?Ec(e):Il=t,xl.current=null}function Ec(e){var t=e;do{var n=t.alternate;if(e=t.return,32768&t.flags){if(null!==(n=Ko(n,t)))return n.flags&=32767,void(Il=n);if(null===e)return Ol=6,void(Il=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}else if(null!==(n=Wo(n,t,Dl)))return void(Il=n);if(null!==(t=t.sibling))return void(Il=t);Il=t=e}while(null!==t);0===Ol&&(Ol=5)}function Sc(e,t,n){var i=bt,r=Ll.transition;try{Ll.transition=null,bt=1,function(e,t,n,i){do{wc()}while(null!==Kl);if(6&Al)throw Error(s(327));n=e.finishedWork;var r=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<n;){var r=31-at(n),s=1<<r;t[r]=0,i[r]=-1,e[r]=-1,n&=~s}}(e,a),e===Rl&&(Il=Rl=null,Cl=0),!(2064&n.subtreeFlags)&&!(2064&n.flags)||Wl||(Wl=!0,Rc(tt,function(){return wc(),null})),a=!!(15990&n.flags),15990&n.subtreeFlags||a){a=Ll.transition,Ll.transition=null;var o=bt;bt=1;var l=Al;Al|=4,xl.current=null,function(e,t){if(er=Vt,fi(e=di())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var i=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(i&&0!==i.rangeCount){n=i.anchorNode;var r=i.anchorOffset,a=i.focusNode;i=i.focusOffset;try{n.nodeType,a.nodeType}catch(e){n=null;break e}var o=0,l=-1,c=-1,u=0,h=0,d=e,f=null;t:for(;;){for(var p;d!==n||0!==r&&3!==d.nodeType||(l=o+r),d!==a||0!==i&&3!==d.nodeType||(c=o+i),3===d.nodeType&&(o+=d.nodeValue.length),null!==(p=d.firstChild);)f=d,d=p;for(;;){if(d===e)break t;if(f===n&&++u===r&&(l=o),f===a&&++h===i&&(c=o),null!==(p=d.nextSibling))break;f=(d=f).parentNode}d=p}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(tr={focusedElem:e,selectionRange:n},Vt=!1,Zo=t;null!==Zo;)if(e=(t=Zo).child,1028&t.subtreeFlags&&null!==e)e.return=t,Zo=e;else for(;null!==Zo;){t=Zo;try{var g=t.alternate;if(1024&t.flags)switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==g){var m=g.memoizedProps,v=g.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?m:to(t.type,m),v);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var E=t.stateNode.containerInfo;1===E.nodeType?E.textContent="":9===E.nodeType&&E.documentElement&&E.removeChild(E.documentElement);break;default:throw Error(s(163))}}catch(e){kc(t,t.return,e)}if(null!==(e=t.sibling)){e.return=t.return,Zo=e;break}Zo=t.return}g=tl,tl=!1}(e,n),ml(n,e),pi(tr),Vt=!!er,tr=er=null,e.current=n,yl(n,e,r),Xe(),Al=l,bt=o,Ll.transition=a}else e.current=n;if(Wl&&(Wl=!1,Kl=e,Yl=r),0===(a=e.pendingLanes)&&(Hl=null),function(e){if(st&&"function"==typeof st.onCommitFiberRoot)try{st.onCommitFiberRoot(rt,e,void 0,!(128&~e.current.flags))}catch(e){}}(n.stateNode),ic(e,Qe()),null!==t)for(i=e.onRecoverableError,n=0;n<t.length;n++)i((r=t[n]).value,{componentStack:r.stack,digest:r.digest});if(Vl)throw Vl=!1,e=ql,ql=null,e;!!(1&Yl)&&0!==e.tag&&wc(),1&(a=e.pendingLanes)?e===Ql?Xl++:(Xl=0,Ql=e):Xl=0,zr()}(e,t,n,i)}finally{Ll.transition=r,bt=i}return null}function wc(){if(null!==Kl){var e=Et(Yl),t=Ll.transition,n=bt;try{if(Ll.transition=null,bt=16>e?16:e,null===Kl)var i=!1;else{if(e=Kl,Kl=null,Yl=0,6&Al)throw Error(s(331));var r=Al;for(Al|=4,Zo=e.current;null!==Zo;){var a=Zo,o=a.child;if(16&Zo.flags){var l=a.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Zo=u;null!==Zo;){var h=Zo;switch(h.tag){case 0:case 11:case 15:nl(8,h,a)}var d=h.child;if(null!==d)d.return=h,Zo=d;else for(;null!==Zo;){var f=(h=Zo).sibling,p=h.return;if(sl(h),h===u){Zo=null;break}if(null!==f){f.return=p,Zo=f;break}Zo=p}}}var g=a.alternate;if(null!==g){var m=g.child;if(null!==m){g.child=null;do{var v=m.sibling;m.sibling=null,m=v}while(null!==m)}}Zo=a}}if(2064&a.subtreeFlags&&null!==o)o.return=a,Zo=o;else e:for(;null!==Zo;){if(2048&(a=Zo).flags)switch(a.tag){case 0:case 11:case 15:nl(9,a,a.return)}var y=a.sibling;if(null!==y){y.return=a.return,Zo=y;break e}Zo=a.return}}var b=e.current;for(Zo=b;null!==Zo;){var E=(o=Zo).child;if(2064&o.subtreeFlags&&null!==E)E.return=o,Zo=E;else e:for(o=b;null!==Zo;){if(2048&(l=Zo).flags)try{switch(l.tag){case 0:case 11:case 15:il(9,l)}}catch(e){kc(l,l.return,e)}if(l===o){Zo=null;break e}var S=l.sibling;if(null!==S){S.return=l.return,Zo=S;break e}Zo=l.return}}if(Al=r,zr(),st&&"function"==typeof st.onPostCommitFiberRoot)try{st.onPostCommitFiberRoot(rt,e)}catch(e){}i=!0}return i}finally{bt=n,Ll.transition=t}}return!1}function Tc(e,t,n){e=Us(e,t=fo(0,t=lo(n,t),1),1),t=ec(),null!==e&&(vt(e,1,t),ic(e,t))}function kc(e,t,n){if(3===e.tag)Tc(e,e,n);else for(;null!==t;){if(3===t.tag){Tc(t,e,n);break}if(1===t.tag){var i=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof i.componentDidCatch&&(null===Hl||!Hl.has(i))){t=Us(t,e=po(t,e=lo(n,e),1),1),e=ec(),null!==t&&(vt(t,1,e),ic(t,e));break}}t=t.return}}function _c(e,t,n){var i=e.pingCache;null!==i&&i.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&n,Rl===e&&(Cl&n)===n&&(4===Ol||3===Ol&&(130023424&Cl)===Cl&&500>Qe()-jl?dc(e,0):Bl|=n),ic(e,t)}function xc(e,t){0===t&&(1&e.mode?(t=ut,!(130023424&(ut<<=1))&&(ut=4194304)):t=1);var n=ec();null!==(e=Os(e,t))&&(vt(e,t,n),ic(e,n))}function Lc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),xc(e,n)}function Ac(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,r=e.memoizedState;null!==r&&(n=r.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(s(314))}null!==i&&i.delete(t),xc(e,n)}function Rc(e,t){return We(e,t)}function Ic(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Cc(e,t,n,i){return new Ic(e,t,n,i)}function Dc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Pc(e,t){var n=e.alternate;return null===n?((n=Cc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Oc(e,t,n,i,r,a){var o=2;if(i=e,"function"==typeof e)Dc(e)&&(o=1);else if("string"==typeof e)o=5;else e:switch(e){case T:return Nc(n.children,r,a,t);case k:o=8,r|=8;break;case _:return(e=Cc(12,n,t,2|r)).elementType=_,e.lanes=a,e;case R:return(e=Cc(13,n,t,r)).elementType=R,e.lanes=a,e;case I:return(e=Cc(19,n,t,r)).elementType=I,e.lanes=a,e;case P:return Mc(n,r,a,t);default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case x:o=10;break e;case L:o=9;break e;case A:o=11;break e;case C:o=14;break e;case D:o=16,i=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Cc(o,n,t,r)).elementType=e,t.type=i,t.lanes=a,t}function Nc(e,t,n,i){return(e=Cc(7,e,i,t)).lanes=n,e}function Mc(e,t,n,i){return(e=Cc(22,e,i,t)).elementType=P,e.lanes=n,e.stateNode={isHidden:!1},e}function Fc(e,t,n){return(e=Cc(6,e,null,t)).lanes=n,e}function Bc(e,t,n){return(t=Cc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Uc(e,t,n,i,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mt(0),this.expirationTimes=mt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mt(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function $c(e,t,n,i,r,s,a,o,l){return e=new Uc(e,t,n,o,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=Cc(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ms(s),e}function jc(e){if(!e)return Lr;e:{if(ze(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Dr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var n=e.type;if(Dr(n))return Nr(e,n,t)}return t}function zc(e,t,n,i,r,s,a,o,l){return(e=$c(n,i,!0,e,0,s,0,o,l)).context=jc(null),n=e.current,(s=Bs(i=ec(),r=tc(n))).callback=null!=t?t:null,Us(n,s,r),e.current.lanes=r,vt(e,r,i),ic(e,i),e}function Gc(e,t,n,i){var r=t.current,s=ec(),a=tc(r);return n=jc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Bs(s,a)).payload={element:e},null!==(i=void 0===i?null:i)&&(t.callback=i),null!==(e=Us(r,t,a))&&(nc(e,r,a,s),$s(e,r,a)),a}function Vc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function qc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Hc(e,t){qc(e,t),(e=e.alternate)&&qc(e,t)}Tl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Rr.current)bo=!0;else{if(0===(e.lanes&n)&&!(128&t.flags))return bo=!1,function(e,t,n){switch(t.tag){case 3:Ro(t),fs();break;case 5:Qs(t);break;case 1:Dr(t.type)&&Mr(t);break;case 4:Ys(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,r=t.memoizedProps.value;xr(ws,i._currentValue),i._currentValue=r;break;case 13:if(null!==(i=t.memoizedState))return null!==i.dehydrated?(xr(Js,1&Js.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Fo(e,t,n):(xr(Js,1&Js.current),null!==(e=Vo(e,t,n))?e.sibling:null);xr(Js,1&Js.current);break;case 19:if(i=0!==(n&t.childLanes),128&e.flags){if(i)return zo(e,t,n);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),xr(Js,Js.current),i)break;return null;case 22:case 23:return t.lanes=0,ko(e,t,n)}return Vo(e,t,n)}(e,t,n);bo=!!(131072&e.flags)}else bo=!1,rs&&1048576&t.flags&&Jr(t,Hr,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;Go(e,t),e=t.pendingProps;var r=Cr(t,Ar.current);Rs(t,n),r=ga(null,t,i,e,r,n);var a=ma();return t.flags|=1,"object"==typeof r&&null!==r&&"function"==typeof r.render&&void 0===r.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Dr(i)?(a=!0,Mr(t)):a=!1,t.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,Ms(t),r.updater=io,t.stateNode=r,r._reactInternals=t,oo(t,i,e,n),t=Ao(null,t,i,!0,a,n)):(t.tag=0,rs&&a&&es(t),Eo(null,t,r,n),t=t.child),t;case 16:i=t.elementType;e:{switch(Go(e,t),e=t.pendingProps,i=(r=i._init)(i._payload),t.type=i,r=t.tag=function(e){if("function"==typeof e)return Dc(e)?1:0;if(null!=e){if((e=e.$$typeof)===A)return 11;if(e===C)return 14}return 2}(i),e=to(i,e),r){case 0:t=xo(null,t,i,e,n);break e;case 1:t=Lo(null,t,i,e,n);break e;case 11:t=So(null,t,i,e,n);break e;case 14:t=wo(null,t,i,to(i.type,e),n);break e}throw Error(s(306,i,""))}return t;case 0:return i=t.type,r=t.pendingProps,xo(e,t,i,r=t.elementType===i?r:to(i,r),n);case 1:return i=t.type,r=t.pendingProps,Lo(e,t,i,r=t.elementType===i?r:to(i,r),n);case 3:e:{if(Ro(t),null===e)throw Error(s(387));i=t.pendingProps,r=(a=t.memoizedState).element,Fs(e,t),zs(t,i,null,n);var o=t.memoizedState;if(i=o.element,a.isDehydrated){if(a={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=Io(e,t,i,n,r=lo(Error(s(423)),t));break e}if(i!==r){t=Io(e,t,i,n,r=lo(Error(s(424)),t));break e}for(is=cr(t.stateNode.containerInfo.firstChild),ns=t,rs=!0,ss=null,n=Ss(t,null,i,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fs(),i===r){t=Vo(e,t,n);break e}Eo(e,t,i,n)}t=t.child}return t;case 5:return Qs(t),null===e&&cs(t),i=t.type,r=t.pendingProps,a=null!==e?e.memoizedProps:null,o=r.children,nr(i,r)?o=null:null!==a&&nr(i,a)&&(t.flags|=32),_o(e,t),Eo(e,t,o,n),t.child;case 6:return null===e&&cs(t),null;case 13:return Fo(e,t,n);case 4:return Ys(t,t.stateNode.containerInfo),i=t.pendingProps,null===e?t.child=Es(t,null,i,n):Eo(e,t,i,n),t.child;case 11:return i=t.type,r=t.pendingProps,So(e,t,i,r=t.elementType===i?r:to(i,r),n);case 7:return Eo(e,t,t.pendingProps,n),t.child;case 8:case 12:return Eo(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(i=t.type._context,r=t.pendingProps,a=t.memoizedProps,o=r.value,xr(ws,i._currentValue),i._currentValue=o,null!==a)if(oi(a.value,o)){if(a.children===r.children&&!Rr.current){t=Vo(e,t,n);break e}}else for(null!==(a=t.child)&&(a.return=t);null!==a;){var l=a.dependencies;if(null!==l){o=a.child;for(var c=l.firstContext;null!==c;){if(c.context===i){if(1===a.tag){(c=Bs(-1,n&-n)).tag=2;var u=a.updateQueue;if(null!==u){var h=(u=u.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}a.lanes|=n,null!==(c=a.alternate)&&(c.lanes|=n),As(a.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===a.tag)o=a.type===t.type?null:a.child;else if(18===a.tag){if(null===(o=a.return))throw Error(s(341));o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),As(o,n,t),o=a.sibling}else o=a.child;if(null!==o)o.return=a;else for(o=a;null!==o;){if(o===t){o=null;break}if(null!==(a=o.sibling)){a.return=o.return,o=a;break}o=o.return}a=o}Eo(e,t,r.children,n),t=t.child}return t;case 9:return r=t.type,i=t.pendingProps.children,Rs(t,n),i=i(r=Is(r)),t.flags|=1,Eo(e,t,i,n),t.child;case 14:return r=to(i=t.type,t.pendingProps),wo(e,t,i,r=to(i.type,r),n);case 15:return To(e,t,t.type,t.pendingProps,n);case 17:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:to(i,r),Go(e,t),t.tag=1,Dr(i)?(e=!0,Mr(t)):e=!1,Rs(t,n),so(t,i,r),oo(t,i,r,n),Ao(null,t,i,!0,e,n);case 19:return zo(e,t,n);case 22:return ko(e,t,n)}throw Error(s(156,t.tag))};var Wc="function"==typeof reportError?reportError:function(e){console.error(e)};function Kc(e){this._internalRoot=e}function Yc(e){this._internalRoot=e}function Xc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Qc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Zc(){}function Jc(e,t,n,i,r){var s=n._reactRootContainer;if(s){var a=s;if("function"==typeof r){var o=r;r=function(){var e=Vc(a);o.call(e)}}Gc(t,a,e,r)}else a=function(e,t,n,i,r){if(r){if("function"==typeof i){var s=i;i=function(){var e=Vc(a);s.call(e)}}var a=zc(t,i,e,0,null,!1,0,"",Zc);return e._reactRootContainer=a,e[pr]=a.current,zi(8===e.nodeType?e.parentNode:e),uc(),a}for(;r=e.lastChild;)e.removeChild(r);if("function"==typeof i){var o=i;i=function(){var e=Vc(l);o.call(e)}}var l=$c(e,0,!1,null,0,!1,0,"",Zc);return e._reactRootContainer=l,e[pr]=l.current,zi(8===e.nodeType?e.parentNode:e),uc(function(){Gc(t,l,n,i)}),l}(n,t,e,r,i);return Vc(a)}Yc.prototype.render=Kc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));Gc(e,t,null,null)},Yc.prototype.unmount=Kc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc(function(){Gc(null,e,null,null)}),t[pr]=null}},Yc.prototype.unstable_scheduleHydration=function(e){if(e){var t=kt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Pt.length&&0!==t&&t<Pt[n].priority;n++);Pt.splice(n,0,e),0===n&&Ft(e)}},St=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ht(t.pendingLanes);0!==n&&(yt(t,1|n),ic(t,Qe()),!(6&Al)&&(zl=Qe()+500,zr()))}break;case 13:uc(function(){var t=Os(e,1);if(null!==t){var n=ec();nc(t,e,1,n)}}),Hc(e,1)}},wt=function(e){if(13===e.tag){var t=Os(e,134217728);null!==t&&nc(t,e,134217728,ec()),Hc(e,134217728)}},Tt=function(e){if(13===e.tag){var t=tc(e),n=Os(e,t);null!==n&&nc(n,e,t,ec()),Hc(e,t)}},kt=function(){return bt},_t=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},we=function(e,t,n){switch(t){case"input":if(Z(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var r=Sr(i);if(!r)throw Error(s(90));W(i),Z(i,r)}}}break;case"textarea":se(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ae=cc,Re=uc;var eu={usingClientEntryPoint:!1,Events:[br,Er,Sr,xe,Le,cc]},tu={findFiberByHostInstance:yr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nu={bundleType:tu.bundleType,version:tu.version,rendererPackageName:tu.rendererPackageName,rendererConfig:tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:E.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=qe(e))?null:e.stateNode},findFiberByHostInstance:tu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var iu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!iu.isDisabled&&iu.supportsFiber)try{rt=iu.inject(nu),st=iu}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Xc(t))throw Error(s(200));return function(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:w,key:null==i?null:""+i,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Xc(e))throw Error(s(299));var n=!1,i="",r=Wc;return null!=t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(i=t.identifierPrefix),void 0!==t.onRecoverableError&&(r=t.onRecoverableError)),t=$c(e,1,!1,null,0,n,0,i,r),e[pr]=t.current,zi(8===e.nodeType?e.parentNode:e),new Kc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return null===(e=qe(t))?null:e.stateNode},t.flushSync=function(e){return uc(e)},t.hydrate=function(e,t,n){if(!Qc(t))throw Error(s(200));return Jc(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Xc(e))throw Error(s(405));var i=null!=n&&n.hydratedSources||null,r=!1,a="",o=Wc;if(null!=n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(a=n.identifierPrefix),void 0!==n.onRecoverableError&&(o=n.onRecoverableError)),t=zc(t,null,e,1,null!=n?n:null,r,0,a,o),e[pr]=t.current,zi(e),i)for(e=0;e<i.length;e++)r=(r=(n=i[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,r]:t.mutableSourceEagerHydrationData.push(n,r);return new Yc(t)},t.render=function(e,t,n){if(!Qc(t))throw Error(s(200));return Jc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Qc(e))throw Error(s(40));return!!e._reactRootContainer&&(uc(function(){Jc(null,null,e,!1,function(){e._reactRootContainer=null,e[pr]=null})}),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,i){if(!Qc(n))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return Jc(e,t,n,!1,i)},t.version="18.3.1-next-f1338f8080-20240426"},2552:(e,t,n)=>{var i=n(1873),r=n(659),s=n(9350),a=i?i.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":a&&a in Object(e)?r(e):s(e)}},2597:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,r=n(3575),s=(i=n(7350))&&i.__esModule?i:{default:i};t.default=class{constructor(e){this.settings=e||{},this.id="epubjs-container-"+(0,r.uuid)(),this.container=this.create(this.settings),this.settings.hidden&&(this.wrapper=this.wrap(this.container))}create(e){let t=e.height,n=e.width,i=e.overflow||!1,s=e.axis||"vertical",a=e.direction;(0,r.extend)(this.settings,e),e.height&&(0,r.isNumber)(e.height)&&(t=e.height+"px"),e.width&&(0,r.isNumber)(e.width)&&(n=e.width+"px");let o=document.createElement("div");return o.id=this.id,o.classList.add("epub-container"),o.style.wordSpacing="0",o.style.lineHeight="0",o.style.verticalAlign="top",o.style.position="relative","horizontal"===s&&(o.style.display="flex",o.style.flexDirection="row",o.style.flexWrap="nowrap"),n&&(o.style.width=n),t&&(o.style.height=t),i&&("scroll"===i&&"vertical"===s?(o.style["overflow-y"]=i,o.style["overflow-x"]="hidden"):"scroll"===i&&"horizontal"===s?(o.style["overflow-y"]="hidden",o.style["overflow-x"]=i):o.style.overflow=i),a&&(o.dir=a,o.style.direction=a),a&&this.settings.fullsize&&(document.body.style.direction=a),o}wrap(e){var t=document.createElement("div");return t.style.visibility="hidden",t.style.overflow="hidden",t.style.width="0",t.style.height="0",t.appendChild(e),t}getElement(e){var t;if((0,r.isElement)(e)?t=e:"string"==typeof e&&(t=document.getElementById(e)),!t)throw new Error("Not an Element");return t}attachTo(e){var t,n=this.getElement(e);if(n)return t=this.settings.hidden?this.wrapper:this.container,n.appendChild(t),this.element=n,n}getContainer(){return this.container}onResize(e){(0,r.isNumber)(this.settings.width)&&(0,r.isNumber)(this.settings.height)||(this.resizeFunc=(0,s.default)(e,50),window.addEventListener("resize",this.resizeFunc,!1))}onOrientationChange(e){this.orientationChangeFunc=e,window.addEventListener("orientationchange",this.orientationChangeFunc,!1)}size(e,t){var n;let i=e||this.settings.width,s=t||this.settings.height;null===e?(n=this.element.getBoundingClientRect()).width&&(e=Math.floor(n.width),this.container.style.width=e+"px"):(0,r.isNumber)(e)?this.container.style.width=e+"px":this.container.style.width=e,null===t?(n=n||this.element.getBoundingClientRect()).height&&(t=n.height,this.container.style.height=t+"px"):(0,r.isNumber)(t)?this.container.style.height=t+"px":this.container.style.height=t,(0,r.isNumber)(e)||(e=this.container.clientWidth),(0,r.isNumber)(t)||(t=this.container.clientHeight),this.containerStyles=window.getComputedStyle(this.container),this.containerPadding={left:parseFloat(this.containerStyles["padding-left"])||0,right:parseFloat(this.containerStyles["padding-right"])||0,top:parseFloat(this.containerStyles["padding-top"])||0,bottom:parseFloat(this.containerStyles["padding-bottom"])||0};let a=(0,r.windowBounds)(),o=window.getComputedStyle(document.body),l=parseFloat(o["padding-left"])||0,c=parseFloat(o["padding-right"])||0,u=parseFloat(o["padding-top"])||0,h=parseFloat(o["padding-bottom"])||0;return i||(e=a.width-l-c),(this.settings.fullsize&&!s||!s)&&(t=a.height-u-h),{width:e-this.containerPadding.left-this.containerPadding.right,height:t-this.containerPadding.top-this.containerPadding.bottom}}bounds(){let e;return"visible"!==this.container.style.overflow&&(e=this.container&&this.container.getBoundingClientRect()),e&&e.width&&e.height?e:(0,r.windowBounds)()}getSheet(){var e=document.createElement("style");return e.appendChild(document.createTextNode("")),document.head.appendChild(e),e.sheet}addStyleRules(e,t){var n="#"+this.id+" ",i="";this.sheet||(this.sheet=this.getSheet()),t.forEach(function(e){for(var t in e)e.hasOwnProperty(t)&&(i+=t+":"+e[t]+";")}),this.sheet.insertRule(n+e+" {"+i+"}",0)}axis(e){"horizontal"===e?(this.container.style.display="flex",this.container.style.flexDirection="row",this.container.style.flexWrap="nowrap"):this.container.style.display="block",this.settings.axis=e}direction(e){this.container&&(this.container.dir=e,this.container.style.direction=e),this.settings.fullsize&&(document.body.style.direction=e),this.settings.dir=e}overflow(e){this.container&&("scroll"===e&&"vertical"===this.settings.axis?(this.container.style["overflow-y"]=e,this.container.style["overflow-x"]="hidden"):"scroll"===e&&"horizontal"===this.settings.axis?(this.container.style["overflow-y"]="hidden",this.container.style["overflow-x"]=e):this.container.style.overflow=e),this.settings.overflow=e}destroy(){this.element&&(this.settings.hidden?this.wrapper:this.container,this.element.contains(this.container)&&this.element.removeChild(this.container),window.removeEventListener("resize",this.resizeFunc),window.removeEventListener("orientationChange",this.orientationChangeFunc))}}},2694:(e,t,n)=>{"use strict";var i=n(6925);function r(){}function s(){}s.resetWarningCache=r,e.exports=function(){function e(e,t,n,r,s,a){if(a!==i){var o=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw o.name="Invariant Violation",o}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:s,resetWarningCache:r};return n.PropTypes=n,n}},2723:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=class{constructor(e){this.context=e||this,this.hooks=[]}register(){for(var e=0;e<arguments.length;++e)if("function"==typeof arguments[e])this.hooks.push(arguments[e]);else for(var t=0;t<arguments[e].length;++t)this.hooks.push(arguments[e][t])}deregister(e){let t;for(let n=0;n<this.hooks.length;n++)if(t=this.hooks[n],t===e){this.hooks.splice(n,1);break}}trigger(){var e=arguments,t=this.context,n=[];return this.hooks.forEach(function(i){try{var r=i.apply(t,e)}catch(e){console.log(e)}r&&"function"==typeof r.then&&n.push(r)}),Promise.all(n)}list(){return this.hooks}clear(){return this.hooks=[]}}},3068:(e,t,n)=>{"use strict";var i,r,s,a,o,l,c,u=n(8263),h=n(5499),d=Function.prototype.apply,f=Function.prototype.call,p=Object.create,g=Object.defineProperty,m=Object.defineProperties,v=Object.prototype.hasOwnProperty,y={configurable:!0,enumerable:!1,writable:!0};r=function(e,t){var n,r;return h(t),r=this,i.call(this,e,n=function(){s.call(r,e,n),d.call(t,this,arguments)}),n.__eeOnceListener__=t,this},o={on:i=function(e,t){var n;return h(t),v.call(this,"__ee__")?n=this.__ee__:(n=y.value=p(null),g(this,"__ee__",y),y.value=null),n[e]?"object"==typeof n[e]?n[e].push(t):n[e]=[n[e],t]:n[e]=t,this},once:r,off:s=function(e,t){var n,i,r,s;if(h(t),!v.call(this,"__ee__"))return this;if(!(n=this.__ee__)[e])return this;if("object"==typeof(i=n[e]))for(s=0;r=i[s];++s)r!==t&&r.__eeOnceListener__!==t||(2===i.length?n[e]=i[s?0:1]:i.splice(s,1));else i!==t&&i.__eeOnceListener__!==t||delete n[e];return this},emit:a=function(e){var t,n,i,r,s;if(v.call(this,"__ee__")&&(r=this.__ee__[e]))if("object"==typeof r){for(n=arguments.length,s=new Array(n-1),t=1;t<n;++t)s[t-1]=arguments[t];for(r=r.slice(),t=0;i=r[t];++t)d.call(i,this,s)}else switch(arguments.length){case 1:f.call(r,this);break;case 2:f.call(r,this,arguments[1]);break;case 3:f.call(r,this,arguments[1],arguments[2]);break;default:for(n=arguments.length,s=new Array(n-1),t=1;t<n;++t)s[t-1]=arguments[t];d.call(r,this,s)}}},l={on:u(i),once:u(r),off:u(s),emit:u(a)},c=m({},l),e.exports=t=function(e){return null==e?p(c):m(Object(e),l)},t.methods=o},3184:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Book",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"Contents",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"EpubCFI",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"Layout",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"Rendition",{enumerable:!0,get:function(){return s.default}}),t.default=void 0;var i=l(n(9047)),r=l(n(4166)),s=l(n(4064)),a=l(n(4216)),o=l(n(6812));function l(e){return e&&e.__esModule?e:{default:e}}var c=l(n(9732)).default;t.default=c},3380:e=>{"use strict";e.exports=function(){try{return Object.keys("primitive"),!0}catch(e){return!1}}},3463:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,r=n(3575),s=n(4083),a=(i=n(3068))&&i.__esModule?i:{default:i};const o=Math.PI/2,l={easeOutSine:function(e){return Math.sin(e*o)},easeInOutSine:function(e){return-.5*(Math.cos(Math.PI*e)-1)},easeInOutQuint:function(e){return(e/=.5)<1?.5*Math.pow(e,5):.5*(Math.pow(e-2,5)+2)},easeInCubic:function(e){return Math.pow(e,3)}};class c{constructor(e,t){this.settings=(0,r.extend)({duration:80,minVelocity:.2,minDistance:10,easing:l.easeInCubic},t||{}),this.supportsTouch=this.supportsTouch(),this.supportsTouch&&this.setup(e)}setup(e){this.manager=e,this.layout=this.manager.layout,this.fullsize=this.manager.settings.fullsize,this.fullsize?(this.element=this.manager.stage.element,this.scroller=window,this.disableScroll()):(this.element=this.manager.stage.container,this.scroller=this.element,this.element.style.WebkitOverflowScrolling="touch"),this.manager.settings.offset=this.layout.width,this.manager.settings.afterScrolledTimeout=2*this.settings.duration,this.isVertical="vertical"===this.manager.settings.axis,this.manager.isPaginated&&!this.isVertical&&(this.touchCanceler=!1,this.resizeCanceler=!1,this.snapping=!1,this.scrollLeft,this.scrollTop,this.startTouchX=void 0,this.startTouchY=void 0,this.startTime=void 0,this.endTouchX=void 0,this.endTouchY=void 0,this.endTime=void 0,this.addListeners())}supportsTouch(){return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)}disableScroll(){this.element.style.overflow="hidden"}enableScroll(){this.element.style.overflow=""}addListeners(){this._onResize=this.onResize.bind(this),window.addEventListener("resize",this._onResize),this._onScroll=this.onScroll.bind(this),this.scroller.addEventListener("scroll",this._onScroll),this._onTouchStart=this.onTouchStart.bind(this),this.scroller.addEventListener("touchstart",this._onTouchStart,{passive:!0}),this.on("touchstart",this._onTouchStart),this._onTouchMove=this.onTouchMove.bind(this),this.scroller.addEventListener("touchmove",this._onTouchMove,{passive:!0}),this.on("touchmove",this._onTouchMove),this._onTouchEnd=this.onTouchEnd.bind(this),this.scroller.addEventListener("touchend",this._onTouchEnd,{passive:!0}),this.on("touchend",this._onTouchEnd),this._afterDisplayed=this.afterDisplayed.bind(this),this.manager.on(s.EVENTS.MANAGERS.ADDED,this._afterDisplayed)}removeListeners(){window.removeEventListener("resize",this._onResize),this._onResize=void 0,this.scroller.removeEventListener("scroll",this._onScroll),this._onScroll=void 0,this.scroller.removeEventListener("touchstart",this._onTouchStart,{passive:!0}),this.off("touchstart",this._onTouchStart),this._onTouchStart=void 0,this.scroller.removeEventListener("touchmove",this._onTouchMove,{passive:!0}),this.off("touchmove",this._onTouchMove),this._onTouchMove=void 0,this.scroller.removeEventListener("touchend",this._onTouchEnd,{passive:!0}),this.off("touchend",this._onTouchEnd),this._onTouchEnd=void 0,this.manager.off(s.EVENTS.MANAGERS.ADDED,this._afterDisplayed),this._afterDisplayed=void 0}afterDisplayed(e){let t=e.contents;["touchstart","touchmove","touchend"].forEach(e=>{t.on(e,e=>this.triggerViewEvent(e,t))})}triggerViewEvent(e,t){this.emit(e.type,e,t)}onScroll(e){this.scrollLeft=this.fullsize?window.scrollX:this.scroller.scrollLeft,this.scrollTop=this.fullsize?window.scrollY:this.scroller.scrollTop}onResize(e){this.resizeCanceler=!0}onTouchStart(e){let{screenX:t,screenY:n}=e.touches[0];this.fullsize&&this.enableScroll(),this.touchCanceler=!0,this.startTouchX||(this.startTouchX=t,this.startTouchY=n,this.startTime=this.now()),this.endTouchX=t,this.endTouchY=n,this.endTime=this.now()}onTouchMove(e){let{screenX:t,screenY:n}=e.touches[0],i=Math.abs(n-this.endTouchY);this.touchCanceler=!0,!this.fullsize&&i<10&&(this.element.scrollLeft-=t-this.endTouchX),this.endTouchX=t,this.endTouchY=n,this.endTime=this.now()}onTouchEnd(e){this.fullsize&&this.disableScroll(),this.touchCanceler=!1;let t=this.wasSwiped();0!==t?this.snap(t):this.snap(),this.startTouchX=void 0,this.startTouchY=void 0,this.startTime=void 0,this.endTouchX=void 0,this.endTouchY=void 0,this.endTime=void 0}wasSwiped(){let e=this.layout.pageWidth*this.layout.divisor,t=this.endTouchX-this.startTouchX,n=Math.abs(t),i=t/(this.endTime-this.startTime),r=this.settings.minVelocity;return n<=this.settings.minDistance||n>=e?0:i>r?-1:i<-r?1:void 0}needsSnap(){return this.scrollLeft%(this.layout.pageWidth*this.layout.divisor)!==0}snap(e=0){let t=this.scrollLeft,n=this.layout.pageWidth*this.layout.divisor,i=Math.round(t/n)*n;return e&&(i+=e*n),this.smoothScrollTo(i)}smoothScrollTo(e){const t=new r.defer,n=this.scrollLeft,i=this.now(),s=this.settings.duration,a=this.settings.easing;return this.snapping=!0,function r(){const o=this.now(),l=Math.min(1,(o-i)/s);if(a(l),this.touchCanceler||this.resizeCanceler)return this.resizeCanceler=!1,this.snapping=!1,void t.resolve();l<1?(window.requestAnimationFrame(r.bind(this)),this.scrollTo(n+(e-n)*l,0)):(this.scrollTo(e,0),this.snapping=!1,t.resolve())}.call(this),t.promise}scrollTo(e=0,t=0){this.fullsize?window.scroll(e,t):(this.scroller.scrollLeft=e,this.scroller.scrollTop=t)}now(){return"now"in window.performance?performance.now():(new Date).getTime()}destroy(){this.scroller&&(this.fullsize&&this.enableScroll(),this.removeListeners(),this.scroller=void 0)}}(0,a.default)(c.prototype);var u=c;t.default=u},3575:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RangeObject=void 0,t.blob2base64=function(e){return new Promise(function(t,n){var i=new FileReader;i.readAsDataURL(e),i.onloadend=function(){t(i.result)}})},t.borders=function(e){var t=window.getComputedStyle(e),n=0,i=0;return["paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"].forEach(function(e){n+=parseFloat(t[e])||0}),["paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"].forEach(function(e){i+=parseFloat(t[e])||0}),{height:i,width:n}},t.bounds=function(e){var t=window.getComputedStyle(e),n=0,i=0;return["width","paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"].forEach(function(e){n+=parseFloat(t[e])||0}),["height","paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"].forEach(function(e){i+=parseFloat(t[e])||0}),{height:i,width:n}},t.createBase64Url=function(e,t){if("string"==typeof e)return"data:"+t+";base64,"+btoa(e)},t.createBlob=d,t.createBlobUrl=function(e,t){var n=d(e,t);return o.createObjectURL(n)},t.defaults=function(e){for(var t=1,n=arguments.length;t<n;t++){var i=arguments[t];for(var r in i)void 0===e[r]&&(e[r]=i[r])}return e},t.defer=function(){this.resolve=null,this.reject=null,this.id=l(),this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t}),Object.freeze(this)},t.documentHeight=function(){return Math.max(document.documentElement.clientHeight,document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight)},t.extend=function(e){return[].slice.call(arguments,1).forEach(function(t){t&&Object.getOwnPropertyNames(t).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}),e},t.filterChildren=function(e,t,n){for(var i=[],r=e.childNodes,s=0;s<r.length;s++){let e=r[s];if(1===e.nodeType&&e.nodeName.toLowerCase()===t){if(n)return e;i.push(e)}}if(!n)return i},t.findChildren=function(e){for(var t=[],n=e.childNodes,i=0;i<n.length;i++){let e=n[i];1===e.nodeType&&t.push(e)}return t},t.getParentByTagName=function(e,t){let n;if(null!==e&&""!==t)for(n=e.parentNode;1===n.nodeType;){if(n.tagName.toLowerCase()===t)return n;n=n.parentNode}},t.indexOfElementNode=function(e){return h(e,s)},t.indexOfNode=h,t.indexOfSorted=function e(t,n,i,r,s){var a,o=r||0,l=s||n.length,c=parseInt(o+(l-o)/2);return i||(i=function(e,t){return e>t?1:e<t?-1:e==t?0:void 0}),l-o<=0?-1:(a=i(n[c],t),l-o===1?0===a?c:-1:0===a?c:-1===a?e(t,n,i,c,l):e(t,n,i,o,c))},t.indexOfTextNode=function(e){return h(e,a)},t.insert=function(e,t,n){var i=u(e,t,n);return t.splice(i,0,e),i},t.isElement=function(e){return!(!e||1!=e.nodeType)},t.isFloat=function(e){let t=parseFloat(e);return!1!==c(e)&&("string"==typeof e&&e.indexOf(".")>-1||Math.floor(t)!==t)},t.isNumber=c,t.isXml=function(e){return["xml","opf","ncx"].indexOf(e)>-1},t.locationOf=u,t.nodeBounds=function(e){let t,n=e.ownerDocument;if(e.nodeType==Node.TEXT_NODE){let i=n.createRange();i.selectNodeContents(e),t=i.getBoundingClientRect()}else t=e.getBoundingClientRect();return t},t.parents=m,t.parse=function(e,t,n){var r;return r="undefined"==typeof DOMParser||n?i.DOMParser:DOMParser,65279===e.charCodeAt(0)&&(e=e.slice(1)),(new r).parseFromString(e,t)},t.prefixed=function(e){var t=["-webkit-","-webkit-","-moz-","-o-","-ms-"],n=e.toLowerCase();if("undefined"==typeof document||void 0!==document.body.style[n])return e;for(var i=0;i<5;i++)if(void 0!==document.body.style[t[i]+n])return t[i]+n;return e},t.qs=function(e,t){var n;if(!e)throw new Error("No Element Provided");return void 0!==e.querySelector?e.querySelector(t):(n=e.getElementsByTagName(t)).length?n[0]:void 0},t.qsa=f,t.qsp=function(e,t,n){var i,r;if(void 0!==e.querySelector){for(var s in t+="[",n)t+=s+"~='"+n[s]+"'";return t+="]",e.querySelector(t)}if(i=e.getElementsByTagName(t),r=Array.prototype.slice.call(i,0).filter(function(e){for(var t in n)if(e.getAttribute(t)===n[t])return!0;return!1}),r)return r[0]},t.querySelectorByType=function(e,t,n){var i;if(void 0!==e.querySelector&&(i=e.querySelector(`${t}[*|type="${n}"]`)),i&&0!==i.length)return i;i=f(e,t);for(var r=0;r<i.length;r++)if(i[r].getAttributeNS("http://www.idpf.org/2007/ops","type")===n||i[r].getAttribute("epub:type")===n)return i[r]},t.requestAnimationFrame=void 0,t.revokeBlobUrl=function(e){return o.revokeObjectURL(e)},t.sprint=function(e,t){void 0!==(e.ownerDocument||e).createTreeWalker?p(e,t,NodeFilter.SHOW_TEXT):g(e,function(e){e&&3===e.nodeType&&t(e)})},t.treeWalker=p,t.type=function(e){return Object.prototype.toString.call(e).slice(8,-1)},t.uuid=l,t.walk=g,t.windowBounds=function(){var e=window.innerWidth,t=window.innerHeight;return{top:0,left:0,right:e,bottom:t,width:e,height:t}};var i=n(8978);const r="undefined"!=typeof window&&(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame);t.requestAnimationFrame=r;const s=1,a=3,o="undefined"!=typeof URL?URL:"undefined"!=typeof window?window.URL||window.webkitURL||window.mozURL:void 0;function l(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:7&n|8).toString(16)})}function c(e){return!isNaN(parseFloat(e))&&isFinite(e)}function u(e,t,n,i,r){var s,a=i||0,o=r||t.length,l=parseInt(a+(o-a)/2);return n||(n=function(e,t){return e>t?1:e<t?-1:e==t?0:void 0}),o-a<=0?l:(s=n(t[l],e),o-a===1?s>=0?l:l+1:0===s?l:-1===s?u(e,t,n,l,o):u(e,t,n,a,l))}function h(e,t){for(var n,i=e.parentNode.childNodes,r=-1,s=0;s<i.length&&((n=i[s]).nodeType===t&&r++,n!=e);s++);return r}function d(e,t){return new Blob([e],{type:t})}function f(e,t){return void 0!==e.querySelector?e.querySelectorAll(t):e.getElementsByTagName(t)}function p(e,t,n){var i=document.createTreeWalker(e,n,null,!1);let r;for(;r=i.nextNode();)t(r)}function g(e,t){if(t(e))return!0;if(e=e.firstChild)do{if(g(e,t))return!0;e=e.nextSibling}while(e)}function m(e){for(var t=[e];e;e=e.parentNode)t.unshift(e);return t}t.RangeObject=class{constructor(){this.collapsed=!1,this.commonAncestorContainer=void 0,this.endContainer=void 0,this.endOffset=void 0,this.startContainer=void 0,this.startOffset=void 0}setStart(e,t){this.startContainer=e,this.startOffset=t,this.endContainer?this.commonAncestorContainer=this._commonAncestorContainer():this.collapse(!0),this._checkCollapsed()}setEnd(e,t){this.endContainer=e,this.endOffset=t,this.startContainer?(this.collapsed=!1,this.commonAncestorContainer=this._commonAncestorContainer()):this.collapse(!1),this._checkCollapsed()}collapse(e){this.collapsed=!0,e?(this.endContainer=this.startContainer,this.endOffset=this.startOffset,this.commonAncestorContainer=this.startContainer.parentNode):(this.startContainer=this.endContainer,this.startOffset=this.endOffset,this.commonAncestorContainer=this.endOffset.parentNode)}selectNode(e){let t=e.parentNode,n=Array.prototype.indexOf.call(t.childNodes,e);this.setStart(t,n),this.setEnd(t,n+1)}selectNodeContents(e){e.childNodes[e.childNodes-1];let t=3===e.nodeType?e.textContent.length:parent.childNodes.length;this.setStart(e,0),this.setEnd(e,t)}_commonAncestorContainer(e,t){var n=m(e||this.startContainer),i=m(t||this.endContainer);if(n[0]==i[0])for(var r=0;r<n.length;r++)if(n[r]!=i[r])return n[r-1]}_checkCollapsed(){this.startContainer===this.endContainer&&this.startOffset===this.endOffset?this.collapsed=!0:this.collapsed=!1}toString(){}}},3595:(e,t,n)=>{"use strict";var i=n(2093),r=n(7134),s=Math.max;e.exports=function(e,t){var n,a,o,l=s(arguments.length,2);for(e=Object(r(e)),o=function(i){try{e[i]=t[i]}catch(e){n||(n=e)}},a=1;a<l;++a)i(t=arguments[a]).forEach(o);if(void 0!==n)throw n;return e}},3644:(e,t)=>{"use strict";function n(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}Object.defineProperty(t,"__esModule",{value:!0}),t.createElement=n,t.default={createElement:n}},3781:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,r=(i=n(4166))&&i.__esModule?i:{default:i},s=n(3575);t.default=class{constructor(e){this.pages=[],this.locations=[],this.epubcfi=new r.default,this.firstPage=0,this.lastPage=0,this.totalPages=0,this.toc=void 0,this.ncx=void 0,e&&(this.pageList=this.parse(e)),this.pageList&&this.pageList.length&&this.process(this.pageList)}parse(e){var t=(0,s.qs)(e,"html"),n=(0,s.qs)(e,"ncx");return t?this.parseNav(e):n?this.parseNcx(e):void 0}parseNav(e){var t,n,i=(0,s.querySelectorByType)(e,"nav","page-list"),r=i?(0,s.qsa)(i,"li"):[],a=r.length,o=[];if(!r||0===a)return o;for(t=0;t<a;++t)n=this.item(r[t]),o.push(n);return o}parseNcx(e){var t,n,i,r,a=[],o=0;if(!(n=(0,s.qs)(e,"pageList")))return a;if(r=(i=(0,s.qsa)(n,"pageTarget")).length,!i||0===i.length)return a;for(o=0;o<r;++o)t=this.ncxItem(i[o]),a.push(t);return a}ncxItem(e){var t=(0,s.qs)(e,"navLabel"),n=(0,s.qs)(t,"text").textContent;return{href:(0,s.qs)(e,"content").getAttribute("src"),page:parseInt(n,10)}}item(e){var t,n,i=(0,s.qs)(e,"a"),r=i.getAttribute("href")||"",a=i.textContent||"",o=parseInt(a);return-1!=r.indexOf("epubcfi")?(n=(t=r.split("#"))[0],{cfi:t.length>1&&t[1],href:r,packageUrl:n,page:o}):{href:r,page:o}}process(e){e.forEach(function(e){this.pages.push(e.page),e.cfi&&this.locations.push(e.cfi)},this),this.firstPage=parseInt(this.pages[0]),this.lastPage=parseInt(this.pages[this.pages.length-1]),this.totalPages=this.lastPage-this.firstPage}pageFromCfi(e){var t=-1;if(0===this.locations.length)return-1;var n=(0,s.indexOfSorted)(e,this.locations,this.epubcfi.compare);return-1!=n?t=this.pages[n]:void 0!==(t=(n=(0,s.locationOf)(e,this.locations,this.epubcfi.compare))-1>=0?this.pages[n-1]:this.pages[0])||(t=-1),t}cfiFromPage(e){var t=-1;"number"!=typeof e&&(e=parseInt(e));var n=this.pages.indexOf(e);return-1!=n&&(t=this.locations[n]),t}pageFromPercentage(e){return Math.round(this.totalPages*e)}percentageFromPage(e){var t=(e-this.firstPage)/this.totalPages;return Math.round(1e3*t)/1e3}percentageFromCfi(e){var t=this.pageFromCfi(e);return this.percentageFromPage(t)}destroy(){this.pages=void 0,this.locations=void 0,this.epubcfi=void 0,this.pageList=void 0,this.toc=void 0,this.ncx=void 0}}},3790:(e,t,n)=>{e.exports=function e(t,n,i){function r(a,o){if(!n[a]){if(!t[a]){if(s)return s(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[a]={exports:{}};t[a][0].call(c.exports,function(e){return r(t[a][1][e]||e)},c,c.exports,e,t,n,i)}return n[a].exports}for(var s=void 0,a=0;a<i.length;a++)r(i[a]);return r}({1:[function(e,t,i){(function(e){"use strict";var n,i,r=e.MutationObserver||e.WebKitMutationObserver;if(r){var s=0,a=new r(u),o=e.document.createTextNode("");a.observe(o,{characterData:!0}),n=function(){o.data=s=++s%2}}else if(e.setImmediate||void 0===e.MessageChannel)n="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){u(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(u,0)};else{var l=new e.MessageChannel;l.port1.onmessage=u,n=function(){l.port2.postMessage(0)}}var c=[];function u(){var e,t;i=!0;for(var n=c.length;n;){for(t=c,c=[],e=-1;++e<n;)t[e]();n=c.length}i=!1}t.exports=function(e){1!==c.push(e)||i||n()}}).call(this,void 0!==n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,n){"use strict";var i=e(1);function r(){}var s={},a=["REJECTED"],o=["FULFILLED"],l=["PENDING"];function c(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,e!==r&&f(this,e)}function u(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function h(e,t,n){i(function(){var i;try{i=t(n)}catch(t){return s.reject(e,t)}i===e?s.reject(e,new TypeError("Cannot resolve promise with itself")):s.resolve(e,i)})}function d(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function f(e,t){var n=!1;function i(t){n||(n=!0,s.reject(e,t))}function r(t){n||(n=!0,s.resolve(e,t))}var a=p(function(){t(r,i)});"error"===a.status&&i(a.value)}function p(e,t){var n={};try{n.value=e(t),n.status="success"}catch(e){n.status="error",n.value=e}return n}t.exports=c,c.prototype.catch=function(e){return this.then(null,e)},c.prototype.then=function(e,t){if("function"!=typeof e&&this.state===o||"function"!=typeof t&&this.state===a)return this;var n=new this.constructor(r);return this.state!==l?h(n,this.state===o?e:t,this.outcome):this.queue.push(new u(n,e,t)),n},u.prototype.callFulfilled=function(e){s.resolve(this.promise,e)},u.prototype.otherCallFulfilled=function(e){h(this.promise,this.onFulfilled,e)},u.prototype.callRejected=function(e){s.reject(this.promise,e)},u.prototype.otherCallRejected=function(e){h(this.promise,this.onRejected,e)},s.resolve=function(e,t){var n=p(d,t);if("error"===n.status)return s.reject(e,n.value);var i=n.value;if(i)f(e,i);else{e.state=o,e.outcome=t;for(var r=-1,a=e.queue.length;++r<a;)e.queue[r].callFulfilled(t)}return e},s.reject=function(e,t){e.state=a,e.outcome=t;for(var n=-1,i=e.queue.length;++n<i;)e.queue[n].callRejected(t);return e},c.resolve=function(e){return e instanceof this?e:s.resolve(new this(r),e)},c.reject=function(e){var t=new this(r);return s.reject(t,e)},c.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,i=!1;if(!n)return this.resolve([]);for(var a=new Array(n),o=0,l=-1,c=new this(r);++l<n;)u(e[l],l);return c;function u(e,r){t.resolve(e).then(function(e){a[r]=e,++o!==n||i||(i=!0,s.resolve(c,a))},function(e){i||(i=!0,s.reject(c,e))})}},c.race=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,i=!1;if(!n)return this.resolve([]);for(var a=-1,o=new this(r);++a<n;)l(e[a]);return o;function l(e){t.resolve(e).then(function(e){i||(i=!0,s.resolve(o,e))},function(e){i||(i=!0,s.reject(o,e))})}}},{1:1}],3:[function(e,t,i){(function(t){"use strict";"function"!=typeof t.Promise&&(t.Promise=e(2))}).call(this,void 0!==n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(e,t,n){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var r=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){return}}();function s(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(r){if("TypeError"!==r.name)throw r;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),i=0;i<e.length;i+=1)n.append(e[i]);return n.getBlob(t.type)}}"undefined"==typeof Promise&&e(3);var a=Promise;function o(e,t){t&&e.then(function(e){t(null,e)},function(e){t(e)})}function l(e,t,n){"function"==typeof t&&e.then(t),"function"==typeof n&&e.catch(n)}function c(e){return"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function u(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var h="local-forage-detect-blob-support",d=void 0,f={},p=Object.prototype.toString,g="readonly",m="readwrite";function v(e){for(var t=e.length,n=new ArrayBuffer(t),i=new Uint8Array(n),r=0;r<t;r++)i[r]=e.charCodeAt(r);return n}function y(e){return"boolean"==typeof d?a.resolve(d):function(e){return new a(function(t){var n=e.transaction(h,m),i=s([""]);n.objectStore(h).put(i,"key"),n.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},n.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);t(n||!e||parseInt(e[1],10)>=43)}}).catch(function(){return!1})}(e).then(function(e){return d=e})}function b(e){var t=f[e.name],n={};n.promise=new a(function(e,t){n.resolve=e,n.reject=t}),t.deferredOperations.push(n),t.dbReady?t.dbReady=t.dbReady.then(function(){return n.promise}):t.dbReady=n.promise}function E(e){var t=f[e.name].deferredOperations.pop();if(t)return t.resolve(),t.promise}function S(e,t){var n=f[e.name].deferredOperations.pop();if(n)return n.reject(t),n.promise}function w(e,t){return new a(function(n,i){if(f[e.name]=f[e.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},e.db){if(!t)return n(e.db);b(e),e.db.close()}var s=[e.name];t&&s.push(e.version);var a=r.open.apply(r,s);t&&(a.onupgradeneeded=function(t){var n=a.result;try{n.createObjectStore(e.storeName),t.oldVersion<=1&&n.createObjectStore(h)}catch(n){if("ConstraintError"!==n.name)throw n;console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),a.onerror=function(e){e.preventDefault(),i(a.error)},a.onsuccess=function(){var t=a.result;t.onversionchange=function(e){e.target.close()},n(t),E(e)}})}function T(e){return w(e,!1)}function k(e){return w(e,!0)}function _(e,t){if(!e.db)return!0;var n=!e.db.objectStoreNames.contains(e.storeName),i=e.version<e.db.version,r=e.version>e.db.version;if(i&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),r||n){if(n){var s=e.db.version+1;s>e.version&&(e.version=s)}return!0}return!1}function x(e){return s([v(atob(e.data))],{type:e.type})}function L(e){return e&&e.__local_forage_encoded_blob}function A(e){var t=this,n=t._initReady().then(function(){var e=f[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady});return l(n,e,e),n}function R(e,t,n,i){void 0===i&&(i=1);try{var r=e.db.transaction(e.storeName,t);n(null,r)}catch(r){if(i>0&&(!e.db||"InvalidStateError"===r.name||"NotFoundError"===r.name))return a.resolve().then(function(){if(!e.db||"NotFoundError"===r.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),k(e)}).then(function(){return function(e){b(e);for(var t=f[e.name],n=t.forages,i=0;i<n.length;i++){var r=n[i];r._dbInfo.db&&(r._dbInfo.db.close(),r._dbInfo.db=null)}return e.db=null,T(e).then(function(t){return e.db=t,_(e)?k(e):t}).then(function(i){e.db=t.db=i;for(var r=0;r<n.length;r++)n[r]._dbInfo.db=i}).catch(function(t){throw S(e,t),t})}(e).then(function(){R(e,t,n,i-1)})}).catch(n);n(r)}}var I={_driver:"asyncStorage",_initStorage:function(e){var t=this,n={db:null};if(e)for(var i in e)n[i]=e[i];var r=f[n.name];r||(r={forages:[],db:null,dbReady:null,deferredOperations:[]},f[n.name]=r),r.forages.push(t),t._initReady||(t._initReady=t.ready,t.ready=A);var s=[];function o(){return a.resolve()}for(var l=0;l<r.forages.length;l++){var c=r.forages[l];c!==t&&s.push(c._initReady().catch(o))}var u=r.forages.slice(0);return a.all(s).then(function(){return n.db=r.db,T(n)}).then(function(e){return n.db=e,_(n,t._defaultConfig.version)?k(n):e}).then(function(e){n.db=r.db=e,t._dbInfo=n;for(var i=0;i<u.length;i++){var s=u[i];s!==t&&(s._dbInfo.db=n.db,s._dbInfo.version=n.version)}})},_support:function(){try{if(!r||!r.open)return!1;var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}(),iterate:function(e,t){var n=this,i=new a(function(t,i){n.ready().then(function(){R(n._dbInfo,g,function(r,s){if(r)return i(r);try{var a=s.objectStore(n._dbInfo.storeName).openCursor(),o=1;a.onsuccess=function(){var n=a.result;if(n){var i=n.value;L(i)&&(i=x(i));var r=e(i,n.key,o++);void 0!==r?t(r):n.continue()}else t()},a.onerror=function(){i(a.error)}}catch(e){i(e)}})}).catch(i)});return o(i,t),i},getItem:function(e,t){var n=this;e=c(e);var i=new a(function(t,i){n.ready().then(function(){R(n._dbInfo,g,function(r,s){if(r)return i(r);try{var a=s.objectStore(n._dbInfo.storeName).get(e);a.onsuccess=function(){var e=a.result;void 0===e&&(e=null),L(e)&&(e=x(e)),t(e)},a.onerror=function(){i(a.error)}}catch(e){i(e)}})}).catch(i)});return o(i,t),i},setItem:function(e,t,n){var i=this;e=c(e);var r=new a(function(n,r){var s;i.ready().then(function(){return s=i._dbInfo,"[object Blob]"===p.call(t)?y(s.db).then(function(e){return e?t:(n=t,new a(function(e,t){var i=new FileReader;i.onerror=t,i.onloadend=function(t){var i=btoa(t.target.result||"");e({__local_forage_encoded_blob:!0,data:i,type:n.type})},i.readAsBinaryString(n)}));var n}):t}).then(function(t){R(i._dbInfo,m,function(s,a){if(s)return r(s);try{var o=a.objectStore(i._dbInfo.storeName);null===t&&(t=void 0);var l=o.put(t,e);a.oncomplete=function(){void 0===t&&(t=null),n(t)},a.onabort=a.onerror=function(){var e=l.error?l.error:l.transaction.error;r(e)}}catch(e){r(e)}})}).catch(r)});return o(r,n),r},removeItem:function(e,t){var n=this;e=c(e);var i=new a(function(t,i){n.ready().then(function(){R(n._dbInfo,m,function(r,s){if(r)return i(r);try{var a=s.objectStore(n._dbInfo.storeName).delete(e);s.oncomplete=function(){t()},s.onerror=function(){i(a.error)},s.onabort=function(){var e=a.error?a.error:a.transaction.error;i(e)}}catch(e){i(e)}})}).catch(i)});return o(i,t),i},clear:function(e){var t=this,n=new a(function(e,n){t.ready().then(function(){R(t._dbInfo,m,function(i,r){if(i)return n(i);try{var s=r.objectStore(t._dbInfo.storeName).clear();r.oncomplete=function(){e()},r.onabort=r.onerror=function(){var e=s.error?s.error:s.transaction.error;n(e)}}catch(e){n(e)}})}).catch(n)});return o(n,e),n},length:function(e){var t=this,n=new a(function(e,n){t.ready().then(function(){R(t._dbInfo,g,function(i,r){if(i)return n(i);try{var s=r.objectStore(t._dbInfo.storeName).count();s.onsuccess=function(){e(s.result)},s.onerror=function(){n(s.error)}}catch(e){n(e)}})}).catch(n)});return o(n,e),n},key:function(e,t){var n=this,i=new a(function(t,i){e<0?t(null):n.ready().then(function(){R(n._dbInfo,g,function(r,s){if(r)return i(r);try{var a=s.objectStore(n._dbInfo.storeName),o=!1,l=a.openKeyCursor();l.onsuccess=function(){var n=l.result;n?0===e||o?t(n.key):(o=!0,n.advance(e)):t(null)},l.onerror=function(){i(l.error)}}catch(e){i(e)}})}).catch(i)});return o(i,t),i},keys:function(e){var t=this,n=new a(function(e,n){t.ready().then(function(){R(t._dbInfo,g,function(i,r){if(i)return n(i);try{var s=r.objectStore(t._dbInfo.storeName).openKeyCursor(),a=[];s.onsuccess=function(){var t=s.result;t?(a.push(t.key),t.continue()):e(a)},s.onerror=function(){n(s.error)}}catch(e){n(e)}})}).catch(n)});return o(n,e),n},dropInstance:function(e,t){t=u.apply(this,arguments);var n,i=this.config();if((e="function"!=typeof e&&e||{}).name||(e.name=e.name||i.name,e.storeName=e.storeName||i.storeName),e.name){var s=e.name===i.name&&this._dbInfo.db?a.resolve(this._dbInfo.db):T(e).then(function(t){var n=f[e.name],i=n.forages;n.db=t;for(var r=0;r<i.length;r++)i[r]._dbInfo.db=t;return t});n=e.storeName?s.then(function(t){if(t.objectStoreNames.contains(e.storeName)){var n=t.version+1;b(e);var i=f[e.name],s=i.forages;t.close();for(var o=0;o<s.length;o++){var l=s[o];l._dbInfo.db=null,l._dbInfo.version=n}var c=new a(function(t,i){var s=r.open(e.name,n);s.onerror=function(e){s.result.close(),i(e)},s.onupgradeneeded=function(){s.result.deleteObjectStore(e.storeName)},s.onsuccess=function(){var e=s.result;e.close(),t(e)}});return c.then(function(e){i.db=e;for(var t=0;t<s.length;t++){var n=s[t];n._dbInfo.db=e,E(n._dbInfo)}}).catch(function(t){throw(S(e,t)||a.resolve()).catch(function(){}),t})}}):s.then(function(t){b(e);var n=f[e.name],i=n.forages;t.close();for(var s=0;s<i.length;s++)i[s]._dbInfo.db=null;var o=new a(function(t,n){var i=r.deleteDatabase(e.name);i.onerror=function(){var e=i.result;e&&e.close(),n(i.error)},i.onblocked=function(){console.warn('dropInstance blocked for database "'+e.name+'" until all open connections are closed')},i.onsuccess=function(){var e=i.result;e&&e.close(),t(e)}});return o.then(function(e){n.db=e;for(var t=0;t<i.length;t++)E(i[t]._dbInfo)}).catch(function(t){throw(S(e,t)||a.resolve()).catch(function(){}),t})})}else n=a.reject("Invalid arguments");return o(n,t),n}};var C="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",D=/^~~local_forage_type~([^~]+)~/,P="__lfsc__:",O="arbf",N="blob",M="si08",F="ui08",B="uic8",U="si16",$="si32",j="ur16",z="ui32",G="fl32",V="fl64",q=Object.prototype.toString;function H(e){var t,n,i,r,s,a=.75*e.length,o=e.length,l=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);var c=new ArrayBuffer(a),u=new Uint8Array(c);for(t=0;t<o;t+=4)n=C.indexOf(e[t]),i=C.indexOf(e[t+1]),r=C.indexOf(e[t+2]),s=C.indexOf(e[t+3]),u[l++]=n<<2|i>>4,u[l++]=(15&i)<<4|r>>2,u[l++]=(3&r)<<6|63&s;return c}function W(e){var t,n=new Uint8Array(e),i="";for(t=0;t<n.length;t+=3)i+=C[n[t]>>2],i+=C[(3&n[t])<<4|n[t+1]>>4],i+=C[(15&n[t+1])<<2|n[t+2]>>6],i+=C[63&n[t+2]];return n.length%3==2?i=i.substring(0,i.length-1)+"=":n.length%3==1&&(i=i.substring(0,i.length-2)+"=="),i}var K={serialize:function(e,t){var n="";if(e&&(n=q.call(e)),e&&("[object ArrayBuffer]"===n||e.buffer&&"[object ArrayBuffer]"===q.call(e.buffer))){var i,r=P;e instanceof ArrayBuffer?(i=e,r+=O):(i=e.buffer,"[object Int8Array]"===n?r+=M:"[object Uint8Array]"===n?r+=F:"[object Uint8ClampedArray]"===n?r+=B:"[object Int16Array]"===n?r+=U:"[object Uint16Array]"===n?r+=j:"[object Int32Array]"===n?r+=$:"[object Uint32Array]"===n?r+=z:"[object Float32Array]"===n?r+=G:"[object Float64Array]"===n?r+=V:t(new Error("Failed to get type for BinaryArray"))),t(r+W(i))}else if("[object Blob]"===n){var s=new FileReader;s.onload=function(){var n="~~local_forage_type~"+e.type+"~"+W(this.result);t(P+N+n)},s.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(n){console.error("Couldn't convert value into a JSON string: ",e),t(null,n)}},deserialize:function(e){if(e.substring(0,9)!==P)return JSON.parse(e);var t,n=e.substring(13),i=e.substring(9,13);if(i===N&&D.test(n)){var r=n.match(D);t=r[1],n=n.substring(r[0].length)}var a=H(n);switch(i){case O:return a;case N:return s([a],{type:t});case M:return new Int8Array(a);case F:return new Uint8Array(a);case B:return new Uint8ClampedArray(a);case U:return new Int16Array(a);case j:return new Uint16Array(a);case $:return new Int32Array(a);case z:return new Uint32Array(a);case G:return new Float32Array(a);case V:return new Float64Array(a);default:throw new Error("Unkown type: "+i)}},stringToBuffer:H,bufferToString:W};function Y(e,t,n,i){e.executeSql("CREATE TABLE IF NOT EXISTS "+t.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],n,i)}function X(e,t,n,i,r,s){e.executeSql(n,i,r,function(e,a){a.code===a.SYNTAX_ERR?e.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[t.storeName],function(e,o){o.rows.length?s(e,a):Y(e,t,function(){e.executeSql(n,i,r,s)},s)},s):s(e,a)},s)}function Q(e,t,n,i){var r=this;e=c(e);var s=new a(function(s,a){r.ready().then(function(){void 0===t&&(t=null);var o=t,l=r._dbInfo;l.serializer.serialize(t,function(t,c){c?a(c):l.db.transaction(function(n){X(n,l,"INSERT OR REPLACE INTO "+l.storeName+" (key, value) VALUES (?, ?)",[e,t],function(){s(o)},function(e,t){a(t)})},function(t){if(t.code===t.QUOTA_ERR){if(i>0)return void s(Q.apply(r,[e,o,n,i-1]));a(t)}})})}).catch(a)});return o(s,n),s}var Z={_driver:"webSQLStorage",_initStorage:function(e){var t=this,n={db:null};if(e)for(var i in e)n[i]="string"!=typeof e[i]?e[i].toString():e[i];var r=new a(function(e,i){try{n.db=openDatabase(n.name,String(n.version),n.description,n.size)}catch(e){return i(e)}n.db.transaction(function(r){Y(r,n,function(){t._dbInfo=n,e()},function(e,t){i(t)})},i)});return n.serializer=K,r},_support:"function"==typeof openDatabase,iterate:function(e,t){var n=this,i=new a(function(t,i){n.ready().then(function(){var r=n._dbInfo;r.db.transaction(function(n){X(n,r,"SELECT * FROM "+r.storeName,[],function(n,i){for(var s=i.rows,a=s.length,o=0;o<a;o++){var l=s.item(o),c=l.value;if(c&&(c=r.serializer.deserialize(c)),void 0!==(c=e(c,l.key,o+1)))return void t(c)}t()},function(e,t){i(t)})})}).catch(i)});return o(i,t),i},getItem:function(e,t){var n=this;e=c(e);var i=new a(function(t,i){n.ready().then(function(){var r=n._dbInfo;r.db.transaction(function(n){X(n,r,"SELECT * FROM "+r.storeName+" WHERE key = ? LIMIT 1",[e],function(e,n){var i=n.rows.length?n.rows.item(0).value:null;i&&(i=r.serializer.deserialize(i)),t(i)},function(e,t){i(t)})})}).catch(i)});return o(i,t),i},setItem:function(e,t,n){return Q.apply(this,[e,t,n,1])},removeItem:function(e,t){var n=this;e=c(e);var i=new a(function(t,i){n.ready().then(function(){var r=n._dbInfo;r.db.transaction(function(n){X(n,r,"DELETE FROM "+r.storeName+" WHERE key = ?",[e],function(){t()},function(e,t){i(t)})})}).catch(i)});return o(i,t),i},clear:function(e){var t=this,n=new a(function(e,n){t.ready().then(function(){var i=t._dbInfo;i.db.transaction(function(t){X(t,i,"DELETE FROM "+i.storeName,[],function(){e()},function(e,t){n(t)})})}).catch(n)});return o(n,e),n},length:function(e){var t=this,n=new a(function(e,n){t.ready().then(function(){var i=t._dbInfo;i.db.transaction(function(t){X(t,i,"SELECT COUNT(key) as c FROM "+i.storeName,[],function(t,n){var i=n.rows.item(0).c;e(i)},function(e,t){n(t)})})}).catch(n)});return o(n,e),n},key:function(e,t){var n=this,i=new a(function(t,i){n.ready().then(function(){var r=n._dbInfo;r.db.transaction(function(n){X(n,r,"SELECT key FROM "+r.storeName+" WHERE id = ? LIMIT 1",[e+1],function(e,n){var i=n.rows.length?n.rows.item(0).key:null;t(i)},function(e,t){i(t)})})}).catch(i)});return o(i,t),i},keys:function(e){var t=this,n=new a(function(e,n){t.ready().then(function(){var i=t._dbInfo;i.db.transaction(function(t){X(t,i,"SELECT key FROM "+i.storeName,[],function(t,n){for(var i=[],r=0;r<n.rows.length;r++)i.push(n.rows.item(r).key);e(i)},function(e,t){n(t)})})}).catch(n)});return o(n,e),n},dropInstance:function(e,t){t=u.apply(this,arguments);var n=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||n.name,e.storeName=e.storeName||n.storeName);var i,r=this;return o(i=e.name?new a(function(t){var i;i=e.name===n.name?r._dbInfo.db:openDatabase(e.name,"","",0),e.storeName?t({db:i,storeNames:[e.storeName]}):t(function(e){return new a(function(t,n){e.transaction(function(i){i.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(n,i){for(var r=[],s=0;s<i.rows.length;s++)r.push(i.rows.item(s).name);t({db:e,storeNames:r})},function(e,t){n(t)})},function(e){n(e)})})}(i))}).then(function(e){return new a(function(t,n){e.db.transaction(function(i){function r(e){return new a(function(t,n){i.executeSql("DROP TABLE IF EXISTS "+e,[],function(){t()},function(e,t){n(t)})})}for(var s=[],o=0,l=e.storeNames.length;o<l;o++)s.push(r(e.storeNames[o]));a.all(s).then(function(){t()}).catch(function(e){n(e)})},function(e){n(e)})})}):a.reject("Invalid arguments"),t),i}};function J(e,t){var n=e.name+"/";return e.storeName!==t.storeName&&(n+=e.storeName+"/"),n}function ee(){return!function(){var e="_localforage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch(e){return!0}}()||localStorage.length>0}var te={_driver:"localStorageWrapper",_initStorage:function(e){var t={};if(e)for(var n in e)t[n]=e[n];return t.keyPrefix=J(e,this._defaultConfig),ee()?(this._dbInfo=t,t.serializer=K,a.resolve()):a.reject()},_support:function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}(),iterate:function(e,t){var n=this,i=n.ready().then(function(){for(var t=n._dbInfo,i=t.keyPrefix,r=i.length,s=localStorage.length,a=1,o=0;o<s;o++){var l=localStorage.key(o);if(0===l.indexOf(i)){var c=localStorage.getItem(l);if(c&&(c=t.serializer.deserialize(c)),void 0!==(c=e(c,l.substring(r),a++)))return c}}});return o(i,t),i},getItem:function(e,t){var n=this;e=c(e);var i=n.ready().then(function(){var t=n._dbInfo,i=localStorage.getItem(t.keyPrefix+e);return i&&(i=t.serializer.deserialize(i)),i});return o(i,t),i},setItem:function(e,t,n){var i=this;e=c(e);var r=i.ready().then(function(){void 0===t&&(t=null);var n=t;return new a(function(r,s){var a=i._dbInfo;a.serializer.serialize(t,function(t,i){if(i)s(i);else try{localStorage.setItem(a.keyPrefix+e,t),r(n)}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||s(e),s(e)}})})});return o(r,n),r},removeItem:function(e,t){var n=this;e=c(e);var i=n.ready().then(function(){var t=n._dbInfo;localStorage.removeItem(t.keyPrefix+e)});return o(i,t),i},clear:function(e){var t=this,n=t.ready().then(function(){for(var e=t._dbInfo.keyPrefix,n=localStorage.length-1;n>=0;n--){var i=localStorage.key(n);0===i.indexOf(e)&&localStorage.removeItem(i)}});return o(n,e),n},length:function(e){var t=this.keys().then(function(e){return e.length});return o(t,e),t},key:function(e,t){var n=this,i=n.ready().then(function(){var t,i=n._dbInfo;try{t=localStorage.key(e)}catch(e){t=null}return t&&(t=t.substring(i.keyPrefix.length)),t});return o(i,t),i},keys:function(e){var t=this,n=t.ready().then(function(){for(var e=t._dbInfo,n=localStorage.length,i=[],r=0;r<n;r++){var s=localStorage.key(r);0===s.indexOf(e.keyPrefix)&&i.push(s.substring(e.keyPrefix.length))}return i});return o(n,e),n},dropInstance:function(e,t){if(t=u.apply(this,arguments),!(e="function"!=typeof e&&e||{}).name){var n=this.config();e.name=e.name||n.name,e.storeName=e.storeName||n.storeName}var i,r=this;return i=e.name?new a(function(t){e.storeName?t(J(e,r._defaultConfig)):t(e.name+"/")}).then(function(e){for(var t=localStorage.length-1;t>=0;t--){var n=localStorage.key(t);0===n.indexOf(e)&&localStorage.removeItem(n)}}):a.reject("Invalid arguments"),o(i,t),i}},ne=function(e,t){return e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)},ie=function(e,t){for(var n=e.length,i=0;i<n;){if(ne(e[i],t))return!0;i++}return!1},re=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},se={},ae={},oe={INDEXEDDB:I,WEBSQL:Z,LOCALSTORAGE:te},le=[oe.INDEXEDDB._driver,oe.WEBSQL._driver,oe.LOCALSTORAGE._driver],ce=["dropInstance"],ue=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(ce),he={description:"",driver:le.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function de(e,t){e[t]=function(){var n=arguments;return e.ready().then(function(){return e[t].apply(e,n)})}}function fe(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var n in t)t.hasOwnProperty(n)&&(re(t[n])?arguments[0][n]=t[n].slice():arguments[0][n]=t[n])}return arguments[0]}var pe=function(){function e(t){for(var n in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),oe)if(oe.hasOwnProperty(n)){var i=oe[n],r=i._driver;this[n]=r,se[r]||this.defineDriver(i)}this._defaultConfig=fe({},he),this._config=fe({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return e.prototype.config=function(e){if("object"===(void 0===e?"undefined":i(e))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var t in e){if("storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),"version"===t&&"number"!=typeof e[t])return new Error("Database version must be a number.");this._config[t]=e[t]}return!("driver"in e)||!e.driver||this.setDriver(this._config.driver)}return"string"==typeof e?this._config[e]:this._config},e.prototype.defineDriver=function(e,t,n){var i=new a(function(t,n){try{var i=e._driver,r=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!e._driver)return void n(r);for(var s=ue.concat("_initStorage"),l=0,c=s.length;l<c;l++){var u=s[l];if((!ie(ce,u)||e[u])&&"function"!=typeof e[u])return void n(r)}!function(){for(var t=function(e){return function(){var t=new Error("Method "+e+" is not implemented by the current driver"),n=a.reject(t);return o(n,arguments[arguments.length-1]),n}},n=0,i=ce.length;n<i;n++){var r=ce[n];e[r]||(e[r]=t(r))}}();var h=function(n){se[i]&&console.info("Redefining LocalForage driver: "+i),se[i]=e,ae[i]=n,t()};"_support"in e?e._support&&"function"==typeof e._support?e._support().then(h,n):h(!!e._support):h(!0)}catch(e){n(e)}});return l(i,t,n),i},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(e,t,n){var i=se[e]?a.resolve(se[e]):a.reject(new Error("Driver not found."));return l(i,t,n),i},e.prototype.getSerializer=function(e){var t=a.resolve(K);return l(t,e),t},e.prototype.ready=function(e){var t=this,n=t._driverSet.then(function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready});return l(n,e,e),n},e.prototype.setDriver=function(e,t,n){var i=this;re(e)||(e=[e]);var r=this._getSupportedDrivers(e);function s(){i._config.driver=i.driver()}function o(e){return i._extend(e),s(),i._ready=i._initStorage(i._config),i._ready}var c=null!==this._driverSet?this._driverSet.catch(function(){return a.resolve()}):a.resolve();return this._driverSet=c.then(function(){var e=r[0];return i._dbInfo=null,i._ready=null,i.getDriver(e).then(function(e){i._driver=e._driver,s(),i._wrapLibraryMethodsWithReady(),i._initDriver=function(e){return function(){var t=0;return function n(){for(;t<e.length;){var r=e[t];return t++,i._dbInfo=null,i._ready=null,i.getDriver(r).then(o).catch(n)}s();var l=new Error("No available storage method found.");return i._driverSet=a.reject(l),i._driverSet}()}}(r)})}).catch(function(){s();var e=new Error("No available storage method found.");return i._driverSet=a.reject(e),i._driverSet}),l(this._driverSet,t,n),this._driverSet},e.prototype.supports=function(e){return!!ae[e]},e.prototype._extend=function(e){fe(this,e)},e.prototype._getSupportedDrivers=function(e){for(var t=[],n=0,i=e.length;n<i;n++){var r=e[n];this.supports(r)&&t.push(r)}return t},e.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0,t=ue.length;e<t;e++)de(this,ue[e])},e.prototype.createInstance=function(t){return new e(t)},e}(),ge=new pe;t.exports=ge},{3:3}]},{},[4])(4)},3805:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},3859:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,r=(i=n(6841))&&i.__esModule?i:{default:i};t.default=class{constructor(e){var t;e.indexOf("://")>-1&&(e=new URL(e).pathname),t=this.parse(e),this.path=e,this.isDirectory(e)?this.directory=e:this.directory=t.dir+"/",this.filename=t.base,this.extension=t.ext.slice(1)}parse(e){return r.default.parse(e)}isAbsolute(e){return r.default.isAbsolute(e||this.path)}isDirectory(e){return"/"===e.charAt(e.length-1)}resolve(e){return r.default.resolve(this.directory,e)}relative(e){return e&&e.indexOf("://")>-1?e:r.default.relative(this.directory,e)}splitPath(e){return this.splitPathRe.exec(e).slice(1)}toString(){return this.path}}},4064:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=g(n(3068)),r=n(3575),s=g(n(2723)),a=g(n(4166)),o=g(n(7613)),l=g(n(6812)),c=g(n(6120)),u=(g(n(4216)),g(n(5722))),h=n(4083),d=g(n(8598)),f=g(n(7983)),p=g(n(721));function g(e){return e&&e.__esModule?e:{default:e}}class m{constructor(e,t){this.settings=(0,r.extend)(this.settings||{},{width:null,height:null,ignoreClass:"",manager:"default",view:"iframe",flow:null,layout:null,spread:null,minSpreadWidth:800,stylesheet:null,resizeOnOrientationChange:!0,script:null,snap:!1,defaultDirection:"ltr",allowScriptedContent:!1,allowPopups:!1}),(0,r.extend)(this.settings,t),"object"==typeof this.settings.manager&&(this.manager=this.settings.manager),this.book=e,this.hooks={},this.hooks.display=new s.default(this),this.hooks.serialize=new s.default(this),this.hooks.content=new s.default(this),this.hooks.unloaded=new s.default(this),this.hooks.layout=new s.default(this),this.hooks.render=new s.default(this),this.hooks.show=new s.default(this),this.hooks.content.register(this.handleLinks.bind(this)),this.hooks.content.register(this.passEvents.bind(this)),this.hooks.content.register(this.adjustImages.bind(this)),this.book.spine.hooks.content.register(this.injectIdentifier.bind(this)),this.settings.stylesheet&&this.book.spine.hooks.content.register(this.injectStylesheet.bind(this)),this.settings.script&&this.book.spine.hooks.content.register(this.injectScript.bind(this)),this.themes=new c.default(this),this.annotations=new u.default(this),this.epubcfi=new a.default,this.q=new o.default(this),this.location=void 0,this.q.enqueue(this.book.opened),this.starting=new r.defer,this.started=this.starting.promise,this.q.enqueue(this.start)}setManager(e){this.manager=e}requireManager(e){return"string"==typeof e&&"default"===e?f.default:"string"==typeof e&&"continuous"===e?p.default:e}requireView(e){return"string"==typeof e&&"iframe"===e?d.default:e}start(){switch(this.settings.layout||"pre-paginated"!==this.book.package.metadata.layout&&"true"!==this.book.displayOptions.fixedLayout||(this.settings.layout="pre-paginated"),this.book.package.metadata.spread){case"none":this.settings.spread="none";break;case"both":this.settings.spread=!0}this.manager||(this.ViewManager=this.requireManager(this.settings.manager),this.View=this.requireView(this.settings.view),this.manager=new this.ViewManager({view:this.View,queue:this.q,request:this.book.load.bind(this.book),settings:this.settings})),this.direction(this.book.package.metadata.direction||this.settings.defaultDirection),this.settings.globalLayoutProperties=this.determineLayoutProperties(this.book.package.metadata),this.flow(this.settings.globalLayoutProperties.flow),this.layout(this.settings.globalLayoutProperties),this.manager.on(h.EVENTS.MANAGERS.ADDED,this.afterDisplayed.bind(this)),this.manager.on(h.EVENTS.MANAGERS.REMOVED,this.afterRemoved.bind(this)),this.manager.on(h.EVENTS.MANAGERS.RESIZED,this.onResized.bind(this)),this.manager.on(h.EVENTS.MANAGERS.ORIENTATION_CHANGE,this.onOrientationChange.bind(this)),this.manager.on(h.EVENTS.MANAGERS.SCROLLED,this.reportLocation.bind(this)),this.emit(h.EVENTS.RENDITION.STARTED),this.starting.resolve()}attachTo(e){return this.q.enqueue(function(){this.manager.render(e,{width:this.settings.width,height:this.settings.height}),this.emit(h.EVENTS.RENDITION.ATTACHED)}.bind(this))}display(e){return this.displaying&&this.displaying.resolve(),this.q.enqueue(this._display,e)}_display(e){if(this.book){this.epubcfi.isCfiString(e);var t,n=new r.defer,i=n.promise;return this.displaying=n,this.book.locations.length()&&(0,r.isFloat)(e)&&(e=this.book.locations.cfiFromPercentage(parseFloat(e))),(t=this.book.spine.get(e))?(this.manager.display(t,e).then(()=>{n.resolve(t),this.displaying=void 0,this.emit(h.EVENTS.RENDITION.DISPLAYED,t),this.reportLocation()},e=>{this.emit(h.EVENTS.RENDITION.DISPLAY_ERROR,e)}),i):(n.reject(new Error("No Section Found")),i)}}afterDisplayed(e){e.on(h.EVENTS.VIEWS.MARK_CLICKED,(t,n)=>this.triggerMarkEvent(t,n,e.contents)),this.hooks.render.trigger(e,this).then(()=>{e.contents?this.hooks.content.trigger(e.contents,this).then(()=>{this.emit(h.EVENTS.RENDITION.RENDERED,e.section,e)}):this.emit(h.EVENTS.RENDITION.RENDERED,e.section,e)})}afterRemoved(e){this.hooks.unloaded.trigger(e,this).then(()=>{this.emit(h.EVENTS.RENDITION.REMOVED,e.section,e)})}onResized(e,t){this.emit(h.EVENTS.RENDITION.RESIZED,{width:e.width,height:e.height},t),this.location&&this.location.start&&this.display(t||this.location.start.cfi)}onOrientationChange(e){this.emit(h.EVENTS.RENDITION.ORIENTATION_CHANGE,e)}moveTo(e){this.manager.moveTo(e)}resize(e,t,n){e&&(this.settings.width=e),t&&(this.settings.height=t),this.manager.resize(e,t,n)}clear(){this.manager.clear()}next(){return this.q.enqueue(this.manager.next.bind(this.manager)).then(this.reportLocation.bind(this))}prev(){return this.q.enqueue(this.manager.prev.bind(this.manager)).then(this.reportLocation.bind(this))}determineLayoutProperties(e){var t=this.settings.layout||e.layout||"reflowable",n=this.settings.spread||e.spread||"auto",i=this.settings.orientation||e.orientation||"auto",r=this.settings.flow||e.flow||"auto",s=e.viewport||"",a=this.settings.minSpreadWidth||e.minSpreadWidth||800,o=this.settings.direction||e.direction||"ltr";return(0===this.settings.width||this.settings.width>0)&&(0===this.settings.height||this.settings.height),{layout:t,spread:n,orientation:i,flow:r,viewport:s,minSpreadWidth:a,direction:o}}flow(e){var t=e;"scrolled"!==e&&"scrolled-doc"!==e&&"scrolled-continuous"!==e||(t="scrolled"),"auto"!==e&&"paginated"!==e||(t="paginated"),this.settings.flow=e,this._layout&&this._layout.flow(t),this.manager&&this._layout&&this.manager.applyLayout(this._layout),this.manager&&this.manager.updateFlow(t),this.manager&&this.manager.isRendered()&&this.location&&(this.manager.clear(),this.display(this.location.start.cfi))}layout(e){return e&&(this._layout=new l.default(e),this._layout.spread(e.spread,this.settings.minSpreadWidth),this._layout.on(h.EVENTS.LAYOUT.UPDATED,(e,t)=>{this.emit(h.EVENTS.RENDITION.LAYOUT,e,t)})),this.manager&&this._layout&&this.manager.applyLayout(this._layout),this._layout}spread(e,t){this.settings.spread=e,t&&(this.settings.minSpreadWidth=t),this._layout&&this._layout.spread(e,t),this.manager&&this.manager.isRendered()&&this.manager.updateLayout()}direction(e){this.settings.direction=e||"ltr",this.manager&&this.manager.direction(this.settings.direction),this.manager&&this.manager.isRendered()&&this.location&&(this.manager.clear(),this.display(this.location.start.cfi))}reportLocation(){return this.q.enqueue(function(){requestAnimationFrame(function(){var e=this.manager.currentLocation();if(e&&e.then&&"function"==typeof e.then)e.then(function(e){let t=this.located(e);t&&t.start&&t.end&&(this.location=t,this.emit(h.EVENTS.RENDITION.LOCATION_CHANGED,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage}),this.emit(h.EVENTS.RENDITION.RELOCATED,this.location))}.bind(this));else if(e){let t=this.located(e);if(!t||!t.start||!t.end)return;this.location=t,this.emit(h.EVENTS.RENDITION.LOCATION_CHANGED,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage}),this.emit(h.EVENTS.RENDITION.RELOCATED,this.location)}}.bind(this))}.bind(this))}currentLocation(){var e=this.manager.currentLocation();if(e&&e.then&&"function"==typeof e.then)e.then(function(e){return this.located(e)}.bind(this));else if(e)return this.located(e)}located(e){if(!e.length)return{};let t=e[0],n=e[e.length-1],i={start:{index:t.index,href:t.href,cfi:t.mapping.start,displayed:{page:t.pages[0]||1,total:t.totalPages}},end:{index:n.index,href:n.href,cfi:n.mapping.end,displayed:{page:n.pages[n.pages.length-1]||1,total:n.totalPages}}},r=this.book.locations.locationFromCfi(t.mapping.start),s=this.book.locations.locationFromCfi(n.mapping.end);null!=r&&(i.start.location=r,i.start.percentage=this.book.locations.percentageFromLocation(r)),null!=s&&(i.end.location=s,i.end.percentage=this.book.locations.percentageFromLocation(s));let a=this.book.pageList.pageFromCfi(t.mapping.start),o=this.book.pageList.pageFromCfi(n.mapping.end);return-1!=a&&(i.start.page=a),-1!=o&&(i.end.page=o),n.index===this.book.spine.last().index&&i.end.displayed.page>=i.end.displayed.total&&(i.atEnd=!0),t.index===this.book.spine.first().index&&1===i.start.displayed.page&&(i.atStart=!0),i}destroy(){this.manager&&this.manager.destroy(),this.book=void 0}passEvents(e){h.DOM_EVENTS.forEach(t=>{e.on(t,t=>this.triggerViewEvent(t,e))}),e.on(h.EVENTS.CONTENTS.SELECTED,t=>this.triggerSelectedEvent(t,e))}triggerViewEvent(e,t){this.emit(e.type,e,t)}triggerSelectedEvent(e,t){this.emit(h.EVENTS.RENDITION.SELECTED,e,t)}triggerMarkEvent(e,t,n){this.emit(h.EVENTS.RENDITION.MARK_CLICKED,e,t,n)}getRange(e,t){var n=new a.default(e),i=this.manager.visible().filter(function(e){if(n.spinePos===e.index)return!0});if(i.length)return i[0].contents.range(n,t)}adjustImages(e){if("pre-paginated"===this._layout.name)return new Promise(function(e){e()});let t=e.window.getComputedStyle(e.content,null),n=.95*(e.content.offsetHeight-(parseFloat(t.paddingTop)+parseFloat(t.paddingBottom))),i=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight);return e.addStylesheetRules({img:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-i+"px":"100%")+"!important","max-height":n+"px!important","object-fit":"contain","page-break-inside":"avoid","break-inside":"avoid","box-sizing":"border-box"},svg:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-i+"px":"100%")+"!important","max-height":n+"px!important","page-break-inside":"avoid","break-inside":"avoid"}}),new Promise(function(e,t){setTimeout(function(){e()},1)})}getContents(){return this.manager?this.manager.getContents():[]}views(){return(this.manager?this.manager.views:void 0)||[]}handleLinks(e){e&&e.on(h.EVENTS.CONTENTS.LINK_CLICKED,e=>{let t=this.book.path.relative(e);this.display(t)})}injectStylesheet(e,t){let n=e.createElement("link");n.setAttribute("type","text/css"),n.setAttribute("rel","stylesheet"),n.setAttribute("href",this.settings.stylesheet),e.getElementsByTagName("head")[0].appendChild(n)}injectScript(e,t){let n=e.createElement("script");n.setAttribute("type","text/javascript"),n.setAttribute("src",this.settings.script),n.textContent=" ",e.getElementsByTagName("head")[0].appendChild(n)}injectIdentifier(e,t){let n=this.book.packaging.metadata.identifier,i=e.createElement("meta");i.setAttribute("name","dc.relation.ispartof"),n&&i.setAttribute("content",n),e.getElementsByTagName("head")[0].appendChild(i)}}(0,i.default)(m.prototype);var v=m;t.default=v},4080:(e,t,n)=>{"use strict";var i=n(9202);e.exports=function(e){if("function"!=typeof e)return!1;if(!hasOwnProperty.call(e,"length"))return!1;try{if("number"!=typeof e.length)return!1;if("function"!=typeof e.call)return!1;if("function"!=typeof e.apply)return!1}catch(e){return!1}return!i(e)}},4083:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EVENTS=t.EPUBJS_VERSION=t.DOM_EVENTS=void 0,t.EPUBJS_VERSION="0.3",t.DOM_EVENTS=["keydown","keyup","keypressed","mouseup","mousedown","mousemove","click","touchend","touchstart","touchmove"],t.EVENTS={BOOK:{OPEN_FAILED:"openFailed"},CONTENTS:{EXPAND:"expand",RESIZE:"resize",SELECTED:"selected",SELECTED_RANGE:"selectedRange",LINK_CLICKED:"linkClicked"},LOCATIONS:{CHANGED:"changed"},MANAGERS:{RESIZE:"resize",RESIZED:"resized",ORIENTATION_CHANGE:"orientationchange",ADDED:"added",SCROLL:"scroll",SCROLLED:"scrolled",REMOVED:"removed"},VIEWS:{AXIS:"axis",WRITING_MODE:"writingMode",LOAD_ERROR:"loaderror",RENDERED:"rendered",RESIZED:"resized",DISPLAYED:"displayed",SHOWN:"shown",HIDDEN:"hidden",MARK_CLICKED:"markClicked"},RENDITION:{STARTED:"started",ATTACHED:"attached",DISPLAYED:"displayed",DISPLAY_ERROR:"displayerror",RENDERED:"rendered",REMOVED:"removed",RESIZED:"resized",ORIENTATION_CHANGE:"orientationchange",LOCATION_CHANGED:"locationChanged",RELOCATED:"relocated",MARK_CLICKED:"markClicked",SELECTED:"selected",LAYOUT:"layout"},LAYOUT:{UPDATED:"updated"},ANNOTATION:{ATTACH:"attach",DETACH:"detach"}}},4128:(e,t,n)=>{var i=n(1800),r=/^\s+/;e.exports=function(e){return e?e.slice(0,i(e)+1).replace(r,""):e}},4166:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(3575);class r{constructor(e,t,n){var s;if(this.str="",this.base={},this.spinePos=0,this.range=!1,this.path={},this.start=null,this.end=null,!(this instanceof r))return new r(e,t,n);if("string"==typeof t?this.base=this.parseComponent(t):"object"==typeof t&&t.steps&&(this.base=t),"string"===(s=this.checkType(e)))return this.str=e,(0,i.extend)(this,this.parse(e));if("range"===s)return(0,i.extend)(this,this.fromRange(e,this.base,n));if("node"===s)return(0,i.extend)(this,this.fromNode(e,this.base,n));if("EpubCFI"===s&&e.path)return e;if(e)throw new TypeError("not a valid argument for EpubCFI");return this}checkType(e){return this.isCfiString(e)?"string":!e||"object"!=typeof e||"Range"!==(0,i.type)(e)&&void 0===e.startContainer?e&&"object"==typeof e&&void 0!==e.nodeType?"node":!!(e&&"object"==typeof e&&e instanceof r)&&"EpubCFI":"range"}parse(e){var t,n,i,r={spinePos:-1,range:!1,base:{},path:{},start:null,end:null};return"string"!=typeof e?{spinePos:-1}:(0===e.indexOf("epubcfi(")&&")"===e[e.length-1]&&(e=e.slice(8,e.length-1)),(t=this.getChapterComponent(e))?(r.base=this.parseComponent(t),n=this.getPathComponent(e),r.path=this.parseComponent(n),(i=this.getRange(e))&&(r.range=!0,r.start=this.parseComponent(i[0]),r.end=this.parseComponent(i[1])),r.spinePos=r.base.steps[1].index,r):{spinePos:-1})}parseComponent(e){var t,n={steps:[],terminal:{offset:null,assertion:null}},i=e.split(":"),r=i[0].split("/");return i.length>1&&(t=i[1],n.terminal=this.parseTerminal(t)),""===r[0]&&r.shift(),n.steps=r.map(function(e){return this.parseStep(e)}.bind(this)),n}parseStep(e){var t,n,i,r,s;if((r=e.match(/\[(.*)\]/))&&r[1]&&(s=r[1]),n=parseInt(e),!isNaN(n))return n%2==0?(t="element",i=n/2-1):(t="text",i=(n-1)/2),{type:t,index:i,id:s||null}}parseTerminal(e){var t,n,r=e.match(/\[(.*)\]/);return r&&r[1]?(t=parseInt(e.split("[")[0]),n=r[1]):t=parseInt(e),(0,i.isNumber)(t)||(t=null),{offset:t,assertion:n}}getChapterComponent(e){return e.split("!")[0]}getPathComponent(e){var t=e.split("!");if(t[1])return t[1].split(",")[0]}getRange(e){var t=e.split(",");return 3===t.length&&[t[1],t[2]]}getCharecterOffsetComponent(e){return e.split(":")[1]||""}joinSteps(e){return e?e.map(function(e){var t="";return"element"===e.type&&(t+=2*(e.index+1)),"text"===e.type&&(t+=1+2*e.index),e.id&&(t+="["+e.id+"]"),t}).join("/"):""}segmentString(e){var t="/";return t+=this.joinSteps(e.steps),e.terminal&&null!=e.terminal.offset&&(t+=":"+e.terminal.offset),e.terminal&&null!=e.terminal.assertion&&(t+="["+e.terminal.assertion+"]"),t}toString(){var e="epubcfi(";return e+=this.segmentString(this.base),e+="!",e+=this.segmentString(this.path),this.range&&this.start&&(e+=",",e+=this.segmentString(this.start)),this.range&&this.end&&(e+=",",e+=this.segmentString(this.end)),e+")"}compare(e,t){var n,i,s,a;if("string"==typeof e&&(e=new r(e)),"string"==typeof t&&(t=new r(t)),e.spinePos>t.spinePos)return 1;if(e.spinePos<t.spinePos)return-1;e.range?(n=e.path.steps.concat(e.start.steps),s=e.start.terminal):(n=e.path.steps,s=e.path.terminal),t.range?(i=t.path.steps.concat(t.start.steps),a=t.start.terminal):(i=t.path.steps,a=t.path.terminal);for(var o=0;o<n.length;o++){if(!n[o])return-1;if(!i[o])return 1;if(n[o].index>i[o].index)return 1;if(n[o].index<i[o].index)return-1}return n.length<i.length?-1:s.offset>a.offset?1:s.offset<a.offset?-1:0}step(e){var t=3===e.nodeType?"text":"element";return{id:e.id,tagName:e.tagName,type:t,index:this.position(e)}}filteredStep(e,t){var n,i=this.filter(e,t);if(i)return n=3===i.nodeType?"text":"element",{id:i.id,tagName:i.tagName,type:n,index:this.filteredPosition(i,t)}}pathTo(e,t,n){for(var i,r={steps:[],terminal:{offset:null,assertion:null}},s=e;s&&s.parentNode&&9!=s.parentNode.nodeType;)(i=n?this.filteredStep(s,n):this.step(s))&&r.steps.unshift(i),s=s.parentNode;return null!=t&&t>=0&&(r.terminal.offset=t,"text"!=r.steps[r.steps.length-1].type&&r.steps.push({type:"text",index:0})),r}equalStep(e,t){return!(!e||!t)&&e.index===t.index&&e.id===t.id&&e.type===t.type}fromRange(e,t,n){var i={range:!1,base:{},path:{},start:null,end:null},r=e.startContainer,s=e.endContainer,a=e.startOffset,o=e.endOffset,l=!1;if(n&&(l=null!=r.ownerDocument.querySelector("."+n)),"string"==typeof t?(i.base=this.parseComponent(t),i.spinePos=i.base.steps[1].index):"object"==typeof t&&(i.base=t),e.collapsed)l&&(a=this.patchOffset(r,a,n)),i.path=this.pathTo(r,a,n);else{i.range=!0,l&&(a=this.patchOffset(r,a,n)),i.start=this.pathTo(r,a,n),l&&(o=this.patchOffset(s,o,n)),i.end=this.pathTo(s,o,n),i.path={steps:[],terminal:null};var c,u=i.start.steps.length;for(c=0;c<u&&this.equalStep(i.start.steps[c],i.end.steps[c]);c++)c===u-1?i.start.terminal===i.end.terminal&&(i.path.steps.push(i.start.steps[c]),i.range=!1):i.path.steps.push(i.start.steps[c]);i.start.steps=i.start.steps.slice(i.path.steps.length),i.end.steps=i.end.steps.slice(i.path.steps.length)}return i}fromNode(e,t,n){var i={range:!1,base:{},path:{},start:null,end:null};return"string"==typeof t?(i.base=this.parseComponent(t),i.spinePos=i.base.steps[1].index):"object"==typeof t&&(i.base=t),i.path=this.pathTo(e,null,n),i}filter(e,t){var n,i,r,s,a,o=!1;return 3===e.nodeType?(o=!0,r=e.parentNode,n=e.parentNode.classList.contains(t)):(o=!1,n=e.classList.contains(t)),n&&o?(s=r.previousSibling,a=r.nextSibling,s&&3===s.nodeType?i=s:a&&3===a.nodeType&&(i=a),i||e):!(n&&!o)&&e}patchOffset(e,t,n){if(3!=e.nodeType)throw new Error("Anchor must be a text node");var i=e,r=t;for(e.parentNode.classList.contains(n)&&(i=e.parentNode);i.previousSibling;){if(1===i.previousSibling.nodeType){if(!i.previousSibling.classList.contains(n))break;r+=i.previousSibling.textContent.length}else r+=i.previousSibling.textContent.length;i=i.previousSibling}return r}normalizedMap(e,t,n){var i,r,s,a={},o=-1,l=e.length;for(i=0;i<l;i++)1===(r=e[i].nodeType)&&e[i].classList.contains(n)&&(r=3),i>0&&3===r&&3===s?a[i]=o:t===r&&(o+=1,a[i]=o),s=r;return a}position(e){var t,n;return 1===e.nodeType?((t=e.parentNode.children)||(t=(0,i.findChildren)(e.parentNode)),n=Array.prototype.indexOf.call(t,e)):n=(t=this.textNodes(e.parentNode)).indexOf(e),n}filteredPosition(e,t){var n,i;return 1===e.nodeType?(n=e.parentNode.children,i=this.normalizedMap(n,1,t)):(n=e.parentNode.childNodes,e.parentNode.classList.contains(t)&&(n=(e=e.parentNode).parentNode.childNodes),i=this.normalizedMap(n,3,t)),i[Array.prototype.indexOf.call(n,e)]}stepsToXpath(e){var t=[".","*"];return e.forEach(function(e){var n=e.index+1;e.id?t.push("*[position()="+n+" and @id='"+e.id+"']"):"text"===e.type?t.push("text()["+n+"]"):t.push("*["+n+"]")}),t.join("/")}stepsToQuerySelector(e){var t=["html"];return e.forEach(function(e){var n=e.index+1;e.id?t.push("#"+e.id):"text"===e.type||t.push("*:nth-child("+n+")")}),t.join(">")}textNodes(e,t){return Array.prototype.slice.call(e.childNodes).filter(function(e){return 3===e.nodeType||!(!t||!e.classList.contains(t))})}walkToNode(e,t,n){var r,s,a=t||document,o=a.documentElement,l=e.length;for(s=0;s<l&&("element"===(r=e[s]).type?o=r.id?a.getElementById(r.id):(o.children||(0,i.findChildren)(o))[r.index]:"text"===r.type&&(o=this.textNodes(o,n)[r.index]),o);s++);return o}findNode(e,t,n){var i,r,s=t||document;return n||void 0===s.evaluate?i=n?this.walkToNode(e,s,n):this.walkToNode(e,s):(r=this.stepsToXpath(e),i=s.evaluate(r,s,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue),i}fixMiss(e,t,n,i){var r,s,a=this.findNode(e.slice(0,-1),n,i),o=a.childNodes,l=this.normalizedMap(o,3,i),c=e[e.length-1].index;for(let e in l){if(!l.hasOwnProperty(e))return;if(l[e]===c){if(!(t>(s=(r=o[e]).textContent.length))){a=1===r.nodeType?r.childNodes[0]:r;break}t-=s}}return{container:a,offset:t}}toRange(e,t){var n,r,s,a,o,l,c,u,h=e||document,d=this,f=!!t&&null!=h.querySelector("."+t);if(n=void 0!==h.createRange?h.createRange():new i.RangeObject,d.range?(r=d.start,l=d.path.steps.concat(r.steps),a=this.findNode(l,h,f?t:null),s=d.end,c=d.path.steps.concat(s.steps),o=this.findNode(c,h,f?t:null)):(r=d.path,l=d.path.steps,a=this.findNode(d.path.steps,h,f?t:null)),!a)return console.log("No startContainer found for",this.toString()),null;try{null!=r.terminal.offset?n.setStart(a,r.terminal.offset):n.setStart(a,0)}catch(e){u=this.fixMiss(l,r.terminal.offset,h,f?t:null),n.setStart(u.container,u.offset)}if(o)try{null!=s.terminal.offset?n.setEnd(o,s.terminal.offset):n.setEnd(o,0)}catch(e){u=this.fixMiss(c,d.end.terminal.offset,h,f?t:null),n.setEnd(u.container,u.offset)}return n}isCfiString(e){return"string"==typeof e&&0===e.indexOf("epubcfi(")&&")"===e[e.length-1]}generateChapterComponent(e,t,n){var i="/"+2*(e+1)+"/";return i+=2*(parseInt(t)+1),n&&(i+="["+n+"]"),i}collapse(e){this.range&&(this.range=!1,e?(this.path.steps=this.path.steps.concat(this.start.steps),this.path.terminal=this.start.terminal):(this.path.steps=this.path.steps.concat(this.end.steps),this.path.terminal=this.end.terminal))}}var s=r;t.default=s},4216:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=c(n(3068)),r=n(3575),s=c(n(4166)),a=c(n(5446)),o=n(429),l=n(4083);function c(e){return e&&e.__esModule?e:{default:e}}const u="undefined"!=typeof navigator,h=u&&/Chrome/.test(navigator.userAgent),d=u&&!h&&/AppleWebKit/.test(navigator.userAgent);class f{constructor(e,t,n,i){this.epubcfi=new s.default,this.document=e,this.documentElement=this.document.documentElement,this.content=t||this.document.body,this.window=this.document.defaultView,this._size={width:0,height:0},this.sectionIndex=i||0,this.cfiBase=n||"",this.epubReadingSystem("epub.js",l.EPUBJS_VERSION),this.called=0,this.active=!0,this.listeners()}static get listenedEvents(){return l.DOM_EVENTS}width(e){var t=this.content;return e&&(0,r.isNumber)(e)&&(e+="px"),e&&(t.style.width=e),parseInt(this.window.getComputedStyle(t).width)}height(e){var t=this.content;return e&&(0,r.isNumber)(e)&&(e+="px"),e&&(t.style.height=e),parseInt(this.window.getComputedStyle(t).height)}contentWidth(e){var t=this.content||this.document.body;return e&&(0,r.isNumber)(e)&&(e+="px"),e&&(t.style.width=e),parseInt(this.window.getComputedStyle(t).width)}contentHeight(e){var t=this.content||this.document.body;return e&&(0,r.isNumber)(e)&&(e+="px"),e&&(t.style.height=e),parseInt(this.window.getComputedStyle(t).height)}textWidth(){let e,t,n=this.document.createRange(),i=this.content||this.document.body,s=(0,r.borders)(i);return n.selectNodeContents(i),e=n.getBoundingClientRect(),t=e.width,s&&s.width&&(t+=s.width),Math.round(t)}textHeight(){let e,t,n=this.document.createRange(),i=this.content||this.document.body;return n.selectNodeContents(i),e=n.getBoundingClientRect(),t=e.bottom,Math.round(t)}scrollWidth(){return this.documentElement.scrollWidth}scrollHeight(){return this.documentElement.scrollHeight}overflow(e){return e&&(this.documentElement.style.overflow=e),this.window.getComputedStyle(this.documentElement).overflow}overflowX(e){return e&&(this.documentElement.style.overflowX=e),this.window.getComputedStyle(this.documentElement).overflowX}overflowY(e){return e&&(this.documentElement.style.overflowY=e),this.window.getComputedStyle(this.documentElement).overflowY}css(e,t,n){var i=this.content||this.document.body;return t?i.style.setProperty(e,t,n?"important":""):i.style.removeProperty(e),this.window.getComputedStyle(i)[e]}viewport(e){var t,n=this.document.querySelector("meta[name='viewport']"),i={width:void 0,height:void 0,scale:void 0,minimum:void 0,maximum:void 0,scalable:void 0},s=[];if(n&&n.hasAttribute("content")){let e=n.getAttribute("content"),t=e.match(/width\s*=\s*([^,]*)/),r=e.match(/height\s*=\s*([^,]*)/),s=e.match(/initial-scale\s*=\s*([^,]*)/),a=e.match(/minimum-scale\s*=\s*([^,]*)/),o=e.match(/maximum-scale\s*=\s*([^,]*)/),l=e.match(/user-scalable\s*=\s*([^,]*)/);t&&t.length&&void 0!==t[1]&&(i.width=t[1]),r&&r.length&&void 0!==r[1]&&(i.height=r[1]),s&&s.length&&void 0!==s[1]&&(i.scale=s[1]),a&&a.length&&void 0!==a[1]&&(i.minimum=a[1]),o&&o.length&&void 0!==o[1]&&(i.maximum=o[1]),l&&l.length&&void 0!==l[1]&&(i.scalable=l[1])}return t=(0,r.defaults)(e||{},i),e&&(t.width&&s.push("width="+t.width),t.height&&s.push("height="+t.height),t.scale&&s.push("initial-scale="+t.scale),"no"===t.scalable?(s.push("minimum-scale="+t.scale),s.push("maximum-scale="+t.scale),s.push("user-scalable="+t.scalable)):(t.scalable&&s.push("user-scalable="+t.scalable),t.minimum&&s.push("minimum-scale="+t.minimum),t.maximum&&s.push("minimum-scale="+t.maximum)),n||((n=this.document.createElement("meta")).setAttribute("name","viewport"),this.document.querySelector("head").appendChild(n)),n.setAttribute("content",s.join(", ")),this.window.scrollTo(0,0)),t}expand(){this.emit(l.EVENTS.CONTENTS.EXPAND)}listeners(){this.imageLoadListeners(),this.mediaQueryListeners(),this.addEventListeners(),this.addSelectionListeners(),"undefined"==typeof ResizeObserver?(this.resizeListeners(),this.visibilityListeners()):this.resizeObservers(),this.linksHandler()}removeListeners(){this.removeEventListeners(),this.removeSelectionListeners(),this.observer&&this.observer.disconnect(),clearTimeout(this.expanding)}resizeCheck(){let e=this.textWidth(),t=this.textHeight();e==this._size.width&&t==this._size.height||(this._size={width:e,height:t},this.onResize&&this.onResize(this._size),this.emit(l.EVENTS.CONTENTS.RESIZE,this._size))}resizeListeners(){clearTimeout(this.expanding),requestAnimationFrame(this.resizeCheck.bind(this)),this.expanding=setTimeout(this.resizeListeners.bind(this),350)}visibilityListeners(){document.addEventListener("visibilitychange",()=>{"visible"===document.visibilityState&&!1===this.active?(this.active=!0,this.resizeListeners()):(this.active=!1,clearTimeout(this.expanding))})}transitionListeners(){let e=this.content;e.style.transitionProperty="font, font-size, font-size-adjust, font-stretch, font-variation-settings, font-weight, width, height",e.style.transitionDuration="0.001ms",e.style.transitionTimingFunction="linear",e.style.transitionDelay="0",this._resizeCheck=this.resizeCheck.bind(this),this.document.addEventListener("transitionend",this._resizeCheck)}mediaQueryListeners(){for(var e=this.document.styleSheets,t=function(e){e.matches&&!this._expanding&&setTimeout(this.expand.bind(this),1)}.bind(this),n=0;n<e.length;n+=1){var i;try{i=e[n].cssRules}catch(e){return}if(!i)return;for(var r=0;r<i.length;r+=1)i[r].media&&this.window.matchMedia(i[r].media.mediaText).addListener(t)}}resizeObservers(){this.observer=new ResizeObserver(e=>{requestAnimationFrame(this.resizeCheck.bind(this))}),this.observer.observe(this.document.documentElement)}mutationObservers(){this.observer=new MutationObserver(e=>{this.resizeCheck()}),this.observer.observe(this.document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})}imageLoadListeners(){for(var e,t=this.document.querySelectorAll("img"),n=0;n<t.length;n++)void 0!==(e=t[n]).naturalWidth&&0===e.naturalWidth&&(e.onload=this.expand.bind(this))}fontLoadListeners(){this.document&&this.document.fonts&&this.document.fonts.ready.then(function(){this.resizeCheck()}.bind(this))}root(){return this.document?this.document.documentElement:null}locationOf(e,t){var n,i={left:0,top:0};if(!this.document)return i;if(this.epubcfi.isCfiString(e)){let r=new s.default(e).toRange(this.document,t);if(r){try{if(!r.endContainer||r.startContainer==r.endContainer&&r.startOffset==r.endOffset){let e=r.startContainer.textContent.indexOf(" ",r.startOffset);-1==e&&(e=r.startContainer.textContent.length),r.setEnd(r.startContainer,e)}}catch(e){console.error("setting end offset to start container length failed",e)}if(r.startContainer.nodeType===Node.ELEMENT_NODE)n=r.startContainer.getBoundingClientRect(),i.left=n.left,i.top=n.top;else if(d){let e=r.startContainer,t=new Range;try{1===e.nodeType?n=e.getBoundingClientRect():r.startOffset+2<e.length?(t.setStart(e,r.startOffset),t.setEnd(e,r.startOffset+2),n=t.getBoundingClientRect()):r.startOffset-2>0?(t.setStart(e,r.startOffset-2),t.setEnd(e,r.startOffset),n=t.getBoundingClientRect()):n=e.parentNode.getBoundingClientRect()}catch(e){console.error(e,e.stack)}}else n=r.getBoundingClientRect()}}else if("string"==typeof e&&e.indexOf("#")>-1){let t=e.substring(e.indexOf("#")+1),i=this.document.getElementById(t);if(i)if(d){let e=new Range;e.selectNode(i),n=e.getBoundingClientRect()}else n=i.getBoundingClientRect()}return n&&(i.left=n.left,i.top=n.top),i}addStylesheet(e){return new Promise(function(t,n){var i,r=!1;this.document?(i=this.document.querySelector("link[href='"+e+"']"))?t(!0):((i=this.document.createElement("link")).type="text/css",i.rel="stylesheet",i.href=e,i.onload=i.onreadystatechange=function(){r||this.readyState&&"complete"!=this.readyState||(r=!0,setTimeout(()=>{t(!0)},1))},this.document.head.appendChild(i)):t(!1)}.bind(this))}_getStylesheetNode(e){var t;return e="epubjs-inserted-css-"+(e||""),!!this.document&&((t=this.document.getElementById(e))||((t=this.document.createElement("style")).id=e,this.document.head.appendChild(t)),t)}addStylesheetCss(e,t){return!(!this.document||!e||(this._getStylesheetNode(t).innerHTML=e,0))}addStylesheetRules(e,t){var n;if(this.document&&e&&0!==e.length)if(n=this._getStylesheetNode(t).sheet,"[object Array]"===Object.prototype.toString.call(e))for(var i=0,r=e.length;i<r;i++){var s=1,a=e[i],o=e[i][0],l="";"[object Array]"===Object.prototype.toString.call(a[1][0])&&(a=a[1],s=0);for(var c=a.length;s<c;s++){var u=a[s];l+=u[0]+":"+u[1]+(u[2]?" !important":"")+";\n"}n.insertRule(o+"{"+l+"}",n.cssRules.length)}else Object.keys(e).forEach(t=>{const i=e[t];if(Array.isArray(i))i.forEach(e=>{const i=Object.keys(e).map(t=>`${t}:${e[t]}`).join(";");n.insertRule(`${t}{${i}}`,n.cssRules.length)});else{const e=Object.keys(i).map(e=>`${e}:${i[e]}`).join(";");n.insertRule(`${t}{${e}}`,n.cssRules.length)}})}addScript(e){return new Promise(function(t,n){var i,r=!1;this.document?((i=this.document.createElement("script")).type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){r||this.readyState&&"complete"!=this.readyState||(r=!0,setTimeout(function(){t(!0)},1))},this.document.head.appendChild(i)):t(!1)}.bind(this))}addClass(e){var t;this.document&&(t=this.content||this.document.body)&&t.classList.add(e)}removeClass(e){var t;this.document&&(t=this.content||this.document.body)&&t.classList.remove(e)}addEventListeners(){this.document&&(this._triggerEvent=this.triggerEvent.bind(this),l.DOM_EVENTS.forEach(function(e){this.document.addEventListener(e,this._triggerEvent,{passive:!0})},this))}removeEventListeners(){this.document&&(l.DOM_EVENTS.forEach(function(e){this.document.removeEventListener(e,this._triggerEvent,{passive:!0})},this),this._triggerEvent=void 0)}triggerEvent(e){this.emit(e.type,e)}addSelectionListeners(){this.document&&(this._onSelectionChange=this.onSelectionChange.bind(this),this.document.addEventListener("selectionchange",this._onSelectionChange,{passive:!0}))}removeSelectionListeners(){this.document&&(this.document.removeEventListener("selectionchange",this._onSelectionChange,{passive:!0}),this._onSelectionChange=void 0)}onSelectionChange(e){this.selectionEndTimeout&&clearTimeout(this.selectionEndTimeout),this.selectionEndTimeout=setTimeout(function(){var e=this.window.getSelection();this.triggerSelectedEvent(e)}.bind(this),250)}triggerSelectedEvent(e){var t,n;e&&e.rangeCount>0&&((t=e.getRangeAt(0)).collapsed||(n=new s.default(t,this.cfiBase).toString(),this.emit(l.EVENTS.CONTENTS.SELECTED,n),this.emit(l.EVENTS.CONTENTS.SELECTED_RANGE,t)))}range(e,t){return new s.default(e).toRange(this.document,t)}cfiFromRange(e,t){return new s.default(e,this.cfiBase,t).toString()}cfiFromNode(e,t){return new s.default(e,this.cfiBase,t).toString()}map(e){return new a.default(e).section()}size(e,t){var n={scale:1,scalable:"no"};this.layoutStyle("scrolling"),e>=0&&(this.width(e),n.width=e,this.css("padding","0 "+e/12+"px")),t>=0&&(this.height(t),n.height=t),this.css("margin","0"),this.css("box-sizing","border-box"),this.viewport(n)}columns(e,t,n,i,s){let a=(0,r.prefixed)("column-axis"),o=(0,r.prefixed)("column-gap"),l=(0,r.prefixed)("column-width"),c=(0,r.prefixed)("column-fill"),u=0===this.writingMode().indexOf("vertical")?"vertical":"horizontal";this.layoutStyle("paginated"),"rtl"===s&&"horizontal"===u&&this.direction(s),this.width(e),this.height(t),this.viewport({width:e,height:t,scale:1,scalable:"no"}),this.css("overflow-y","hidden"),this.css("margin","0",!0),"vertical"===u?(this.css("padding-top",i/2+"px",!0),this.css("padding-bottom",i/2+"px",!0),this.css("padding-left","20px"),this.css("padding-right","20px"),this.css(a,"vertical")):(this.css("padding-top","20px"),this.css("padding-bottom","20px"),this.css("padding-left",i/2+"px",!0),this.css("padding-right",i/2+"px",!0),this.css(a,"horizontal")),this.css("box-sizing","border-box"),this.css("max-width","inherit"),this.css(c,"auto"),this.css(o,i+"px"),this.css(l,n+"px"),this.css("-webkit-line-box-contain","block glyphs replaced")}scaler(e,t,n){var i="scale("+e+")",r="";this.css("transform-origin","top left"),(t>=0||n>=0)&&(r=" translate("+(t||0)+"px, "+(n||0)+"px )"),this.css("transform",i+r)}fit(e,t,n){var i=this.viewport(),r=parseInt(i.width),s=parseInt(i.height),a=e/r,o=t/s,l=a<o?a:o;if(this.layoutStyle("paginated"),this.width(r),this.height(s),this.overflow("hidden"),this.scaler(l,0,0),this.css("background-size",r*l+"px "+s*l+"px"),this.css("background-color","transparent"),n&&n.properties.includes("page-spread-left")){var c=e-r*l;this.css("margin-left",c+"px")}}direction(e){this.documentElement&&(this.documentElement.style.direction=e)}mapPage(e,t,n,i,r){return new a.default(t,r).page(this,e,n,i)}linksHandler(){(0,o.replaceLinks)(this.content,e=>{this.emit(l.EVENTS.CONTENTS.LINK_CLICKED,e)})}writingMode(e){let t=(0,r.prefixed)("writing-mode");return e&&this.documentElement&&(this.documentElement.style[t]=e),this.window.getComputedStyle(this.documentElement)[t]||""}layoutStyle(e){return e&&(this._layoutStyle=e,navigator.epubReadingSystem.layoutStyle=this._layoutStyle),this._layoutStyle||"paginated"}epubReadingSystem(e,t){return navigator.epubReadingSystem={name:e,version:t,layoutStyle:this.layoutStyle(),hasFeature:function(e){switch(e){case"dom-manipulation":case"layout-changes":case"touch-events":case"mouse-events":case"keyboard-events":return!0;default:return!1}}},navigator.epubReadingSystem}destroy(){this.removeListeners()}}(0,i.default)(f.prototype);var p=f;t.default=p},4232:(e,t,n)=>{"use strict";var i=n(9762),r=Object.keys;e.exports=function(e){return r(i(e)?Object(e):e)}},4368:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"EpubView",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"EpubViewStyle",{enumerable:!0,get:function(){return r.EpubViewStyle}}),Object.defineProperty(t,"ReactReader",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"ReactReaderStyle",{enumerable:!0,get:function(){return a.ReactReaderStyle}});var i=o(n(327)),r=n(5487),s=o(n(7223)),a=n(334);function o(e){return e&&e.__esModule?e:{default:e}}},4394:(e,t,n)=>{var i=n(2552),r=n(346);e.exports=function(e){return"symbol"==typeof e||r(e)&&"[object Symbol]"==i(e)}},4417:e=>{"use strict";e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]|(%20)/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e):e}},4466:(e,t,n)=>{var i=n(4582).NAMESPACE,r=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,s=new RegExp("[\\-\\.0-9"+r.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),a=new RegExp("^"+r.source+s.source+"*(?::"+r.source+s.source+"*)?$");function o(e,t){this.message=e,this.locator=t,Error.captureStackTrace&&Error.captureStackTrace(this,o)}function l(){}function c(e,t){return t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber,t}function u(e,t,n,r,s,a){function o(e,t,i){n.attributeNames.hasOwnProperty(e)&&a.fatalError("Attribute "+e+" redefined"),n.addValue(e,t,i)}for(var l,c=++t,u=0;;){var h=e.charAt(c);switch(h){case"=":if(1===u)l=e.slice(t,c),u=3;else{if(2!==u)throw new Error("attribute equal must after attrName");u=3}break;case"'":case'"':if(3===u||1===u){if(1===u&&(a.warning('attribute value must after "="'),l=e.slice(t,c)),t=c+1,!((c=e.indexOf(h,t))>0))throw new Error("attribute value no end '"+h+"' match");o(l,d=e.slice(t,c).replace(/&#?\w+;/g,s),t-1),u=5}else{if(4!=u)throw new Error('attribute value must after "="');o(l,d=e.slice(t,c).replace(/&#?\w+;/g,s),t),a.warning('attribute "'+l+'" missed start quot('+h+")!!"),t=c+1,u=5}break;case"/":switch(u){case 0:n.setTagName(e.slice(t,c));case 5:case 6:case 7:u=7,n.closed=!0;case 4:case 1:break;case 2:n.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return a.error("unexpected end of input"),0==u&&n.setTagName(e.slice(t,c)),c;case">":switch(u){case 0:n.setTagName(e.slice(t,c));case 5:case 6:case 7:break;case 4:case 1:"/"===(d=e.slice(t,c)).slice(-1)&&(n.closed=!0,d=d.slice(0,-1));case 2:2===u&&(d=l),4==u?(a.warning('attribute "'+d+'" missed quot(")!'),o(l,d.replace(/&#?\w+;/g,s),t)):(i.isHTML(r[""])&&d.match(/^(?:disabled|checked|selected)$/i)||a.warning('attribute "'+d+'" missed value!! "'+d+'" instead!!'),o(d,d,t));break;case 3:throw new Error("attribute value missed!!")}return c;case"":h=" ";default:if(h<=" ")switch(u){case 0:n.setTagName(e.slice(t,c)),u=6;break;case 1:l=e.slice(t,c),u=2;break;case 4:var d=e.slice(t,c).replace(/&#?\w+;/g,s);a.warning('attribute "'+d+'" missed quot(")!!'),o(l,d,t);case 5:u=6}else switch(u){case 2:n.tagName,i.isHTML(r[""])&&l.match(/^(?:disabled|checked|selected)$/i)||a.warning('attribute "'+l+'" missed value!! "'+l+'" instead2!!'),o(l,l,t),t=c,u=1;break;case 5:a.warning('attribute space is required"'+l+'"!!');case 6:u=1,t=c;break;case 3:u=4,t=c;break;case 7:throw new Error("elements closed character '/' and '>' must be connected to")}}c++}}function h(e,t,n){for(var r=e.tagName,s=null,a=e.length;a--;){var o=e[a],l=o.qName,c=o.value;if((f=l.indexOf(":"))>0)var u=o.prefix=l.slice(0,f),h=l.slice(f+1),d="xmlns"===u&&h;else h=l,u=null,d="xmlns"===l&&"";o.localName=h,!1!==d&&(null==s&&(s={},p(n,n={})),n[d]=s[d]=c,o.uri=i.XMLNS,t.startPrefixMapping(d,c))}for(a=e.length;a--;)(u=(o=e[a]).prefix)&&("xml"===u&&(o.uri=i.XML),"xmlns"!==u&&(o.uri=n[u||""]));var f;(f=r.indexOf(":"))>0?(u=e.prefix=r.slice(0,f),h=e.localName=r.slice(f+1)):(u=null,h=e.localName=r);var g=e.uri=n[u||""];if(t.startElement(g,h,r,e),!e.closed)return e.currentNSMap=n,e.localNSMap=s,!0;if(t.endElement(g,h,r),s)for(u in s)Object.prototype.hasOwnProperty.call(s,u)&&t.endPrefixMapping(u)}function d(e,t,n,i,r){if(/^(?:script|textarea)$/i.test(n)){var s=e.indexOf("</"+n+">",t),a=e.substring(t+1,s);if(/[&<]/.test(a))return/^script$/i.test(n)?(r.characters(a,0,a.length),s):(a=a.replace(/&#?\w+;/g,i),r.characters(a,0,a.length),s)}return t+1}function f(e,t,n,i){var r=i[n];return null==r&&((r=e.lastIndexOf("</"+n+">"))<t&&(r=e.lastIndexOf("</"+n)),i[n]=r),r<t}function p(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}function g(e,t,n,i){if("-"===e.charAt(t+2))return"-"===e.charAt(t+3)?(r=e.indexOf("--\x3e",t+4))>t?(n.comment(e,t+4,r-t-4),r+3):(i.error("Unclosed comment"),-1):-1;if("CDATA["==e.substr(t+3,6)){var r=e.indexOf("]]>",t+9);return n.startCDATA(),n.characters(e,t+9,r-t-9),n.endCDATA(),r+3}var s=function(e,t){var n,i=[],r=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(r.lastIndex=t,r.exec(e);n=r.exec(e);)if(i.push(n),n[1])return i}(e,t),a=s.length;if(a>1&&/!doctype/i.test(s[0][0])){var o=s[1][0],l=!1,c=!1;a>3&&(/^public$/i.test(s[2][0])?(l=s[3][0],c=a>4&&s[4][0]):/^system$/i.test(s[2][0])&&(c=s[3][0]));var u=s[a-1];return n.startDTD(o,l,c),n.endDTD(),u.index+u[0].length}return-1}function m(e,t,n){var i=e.indexOf("?>",t);if(i){var r=e.substring(t,i).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);return r?(r[0].length,n.processingInstruction(r[1],r[2]),i+2):-1}return-1}function v(){this.attributeNames={}}o.prototype=new Error,o.prototype.name=o.name,l.prototype={parse:function(e,t,n){var r=this.domBuilder;r.startDocument(),p(t,t={}),function(e,t,n,r,s){function a(e){var t=e.slice(1,-1);return t in n?n[t]:"#"===t.charAt(0)?function(e){if(e>65535){var t=55296+((e-=65536)>>10),n=56320+(1023&e);return String.fromCharCode(t,n)}return String.fromCharCode(e)}(parseInt(t.substr(1).replace("x","0x"))):(s.error("entity not found:"+e),e)}function l(t){if(t>k){var n=e.substring(k,t).replace(/&#?\w+;/g,a);S&&p(k),r.characters(n,0,t-k),k=t}}function p(t,n){for(;t>=b&&(n=E.exec(e));)y=n.index,b=y+n[0].length,S.lineNumber++;S.columnNumber=t-y+1}for(var y=0,b=0,E=/.*(?:\r\n?|\n)|.*$/g,S=r.locator,w=[{currentNSMap:t}],T={},k=0;;){try{var _=e.indexOf("<",k);if(_<0){if(!e.substr(k).match(/^\s*$/)){var x=r.doc,L=x.createTextNode(e.substr(k));x.appendChild(L),r.currentElement=L}return}switch(_>k&&l(_),e.charAt(_+1)){case"/":var A=e.indexOf(">",_+3),R=e.substring(_+2,A).replace(/[ \t\n\r]+$/g,""),I=w.pop();A<0?(R=e.substring(_+2).replace(/[\s<].*/,""),s.error("end tag name: "+R+" is not complete:"+I.tagName),A=_+1+R.length):R.match(/\s</)&&(R=R.replace(/[\s<].*/,""),s.error("end tag name: "+R+" maybe not complete"),A=_+1+R.length);var C=I.localNSMap,D=I.tagName==R;if(D||I.tagName&&I.tagName.toLowerCase()==R.toLowerCase()){if(r.endElement(I.uri,I.localName,R),C)for(var P in C)Object.prototype.hasOwnProperty.call(C,P)&&r.endPrefixMapping(P);D||s.fatalError("end tag name: "+R+" is not match the current start tagName:"+I.tagName)}else w.push(I);A++;break;case"?":S&&p(_),A=m(e,_,r);break;case"!":S&&p(_),A=g(e,_,r,s);break;default:S&&p(_);var O=new v,N=w[w.length-1].currentNSMap,M=(A=u(e,_,O,N,a,s),O.length);if(!O.closed&&f(e,A,O.tagName,T)&&(O.closed=!0,n.nbsp||s.warning("unclosed xml attribute")),S&&M){for(var F=c(S,{}),B=0;B<M;B++){var U=O[B];p(U.offset),U.locator=c(S,{})}r.locator=F,h(O,r,N)&&w.push(O),r.locator=S}else h(O,r,N)&&w.push(O);i.isHTML(O.uri)&&!O.closed?A=d(e,A,O.tagName,a,r):A++}}catch(e){if(e instanceof o)throw e;s.error("element parse error: "+e),A=-1}A>k?k=A:l(Math.max(_,k)+1)}}(e,t,n,r,this.errorHandler),r.endDocument()}},v.prototype={setTagName:function(e){if(!a.test(e))throw new Error("invalid tagName:"+e);this.tagName=e},addValue:function(e,t,n){if(!a.test(e))throw new Error("invalid attribute:"+e);this.attributeNames[e]=this.length,this[this.length++]={qName:e,value:t,offset:n}},length:0,getLocalName:function(e){return this[e].localName},getLocator:function(e){return this[e].locator},getQName:function(e){return this[e].qName},getURI:function(e){return this[e].uri},getValue:function(e){return this[e].value}},t.XMLReader=l,t.ParseError=o},4582:(e,t)=>{"use strict";function n(e,t){return void 0===t&&(t=Object),t&&"function"==typeof t.freeze?t.freeze(e):e}var i=n({HTML:"text/html",isHTML:function(e){return e===i.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),r=n({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(e){return e===r.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});t.find=function(e,t,n){if(void 0===n&&(n=Array.prototype),e&&"function"==typeof n.find)return n.find.call(e,t);for(var i=0;i<e.length;i++)if(Object.prototype.hasOwnProperty.call(e,i)){var r=e[i];if(t.call(void 0,r,i,e))return r}},t.freeze=n,t.MIME_TYPE=i,t.NAMESPACE=r},4722:(e,t,n)=>{var i=n(4582),r=i.find,s=i.NAMESPACE;function a(e){return""!==e}function o(e,t){return e.hasOwnProperty(t)||(e[t]=!0),e}function l(e){if(!e)return[];var t=function(e){return e?e.split(/[\t\n\f\r ]+/).filter(a):[]}(e);return Object.keys(t.reduce(o,{}))}function c(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}function u(e,t){var n=e.prototype;if(!(n instanceof t)){function i(){}i.prototype=t.prototype,c(n,i=new i),e.prototype=n=i}n.constructor!=e&&("function"!=typeof e&&console.error("unknown Class:"+e),n.constructor=e)}var h={},d=h.ELEMENT_NODE=1,f=h.ATTRIBUTE_NODE=2,p=h.TEXT_NODE=3,g=h.CDATA_SECTION_NODE=4,m=h.ENTITY_REFERENCE_NODE=5,v=h.ENTITY_NODE=6,y=h.PROCESSING_INSTRUCTION_NODE=7,b=h.COMMENT_NODE=8,E=h.DOCUMENT_NODE=9,S=h.DOCUMENT_TYPE_NODE=10,w=h.DOCUMENT_FRAGMENT_NODE=11,T=h.NOTATION_NODE=12,k={},_={},x=(k.INDEX_SIZE_ERR=(_[1]="Index size error",1),k.DOMSTRING_SIZE_ERR=(_[2]="DOMString size error",2),k.HIERARCHY_REQUEST_ERR=(_[3]="Hierarchy request error",3)),L=(k.WRONG_DOCUMENT_ERR=(_[4]="Wrong document",4),k.INVALID_CHARACTER_ERR=(_[5]="Invalid character",5),k.NO_DATA_ALLOWED_ERR=(_[6]="No data allowed",6),k.NO_MODIFICATION_ALLOWED_ERR=(_[7]="No modification allowed",7),k.NOT_FOUND_ERR=(_[8]="Not found",8)),A=(k.NOT_SUPPORTED_ERR=(_[9]="Not supported",9),k.INUSE_ATTRIBUTE_ERR=(_[10]="Attribute in use",10));function R(e,t){if(t instanceof Error)var n=t;else n=this,Error.call(this,_[e]),this.message=_[e],Error.captureStackTrace&&Error.captureStackTrace(this,R);return n.code=e,t&&(this.message=this.message+": "+t),n}function I(){}function C(e,t){this._node=e,this._refresh=t,D(this)}function D(e){var t=e._node._inc||e._node.ownerDocument._inc;if(e._inc!==t){var n=e._refresh(e._node);if(ye(e,"length",n.length),!e.$$length||n.length<e.$$length)for(var i=n.length;i in e;i++)Object.prototype.hasOwnProperty.call(e,i)&&delete e[i];c(n,e),e._inc=t}}function P(){}function O(e,t){for(var n=e.length;n--;)if(e[n]===t)return n}function N(e,t,n,i){if(i?t[O(t,i)]=n:t[t.length++]=n,e){n.ownerElement=e;var r=e.ownerDocument;r&&(i&&z(r,e,i),function(e,t,n){e&&e._inc++,n.namespaceURI===s.XMLNS&&(t._nsMap[n.prefix?n.localName:""]=n.value)}(r,e,n))}}function M(e,t,n){var i=O(t,n);if(!(i>=0))throw new R(L,new Error(e.tagName+"@"+n));for(var r=t.length-1;i<r;)t[i]=t[++i];if(t.length=r,e){var s=e.ownerDocument;s&&(z(s,e,n),n.ownerElement=null)}}function F(){}function B(){}function U(e){return("<"==e?"&lt;":">"==e&&"&gt;")||"&"==e&&"&amp;"||'"'==e&&"&quot;"||"&#"+e.charCodeAt()+";"}function $(e,t){if(t(e))return!0;if(e=e.firstChild)do{if($(e,t))return!0}while(e=e.nextSibling)}function j(){this.ownerDocument=this}function z(e,t,n,i){e&&e._inc++,n.namespaceURI===s.XMLNS&&delete t._nsMap[n.prefix?n.localName:""]}function G(e,t,n){if(e&&e._inc){e._inc++;var i=t.childNodes;if(n)i[i.length++]=n;else{for(var r=t.firstChild,s=0;r;)i[s++]=r,r=r.nextSibling;i.length=s,delete i[i.length]}}}function V(e,t){var n=t.previousSibling,i=t.nextSibling;return n?n.nextSibling=i:e.firstChild=i,i?i.previousSibling=n:e.lastChild=n,t.parentNode=null,t.previousSibling=null,t.nextSibling=null,G(e.ownerDocument,e),t}function q(e){return e&&e.nodeType===B.DOCUMENT_TYPE_NODE}function H(e){return e&&e.nodeType===B.ELEMENT_NODE}function W(e){return e&&e.nodeType===B.TEXT_NODE}function K(e,t){var n=e.childNodes||[];if(r(n,H)||q(t))return!1;var i=r(n,q);return!(t&&i&&n.indexOf(i)>n.indexOf(t))}function Y(e,t){var n=e.childNodes||[];if(r(n,function(e){return H(e)&&e!==t}))return!1;var i=r(n,q);return!(t&&i&&n.indexOf(i)>n.indexOf(t))}function X(e,t,n){var i=e.childNodes||[],s=t.childNodes||[];if(t.nodeType===B.DOCUMENT_FRAGMENT_NODE){var a=s.filter(H);if(a.length>1||r(s,W))throw new R(x,"More than one element or text in fragment");if(1===a.length&&!K(e,n))throw new R(x,"Element in fragment can not be inserted before doctype")}if(H(t)&&!K(e,n))throw new R(x,"Only one element can be added and only after doctype");if(q(t)){if(r(i,q))throw new R(x,"Only one doctype is allowed");var o=r(i,H);if(n&&i.indexOf(o)<i.indexOf(n))throw new R(x,"Doctype can only be inserted before an element");if(!n&&o)throw new R(x,"Doctype can not be appended since element is present")}}function Q(e,t,n){var i=e.childNodes||[],s=t.childNodes||[];if(t.nodeType===B.DOCUMENT_FRAGMENT_NODE){var a=s.filter(H);if(a.length>1||r(s,W))throw new R(x,"More than one element or text in fragment");if(1===a.length&&!Y(e,n))throw new R(x,"Element in fragment can not be inserted before doctype")}if(H(t)&&!Y(e,n))throw new R(x,"Only one element can be added and only after doctype");if(q(t)){if(r(i,function(e){return q(e)&&e!==n}))throw new R(x,"Only one doctype is allowed");var o=r(i,H);if(n&&i.indexOf(o)<i.indexOf(n))throw new R(x,"Doctype can only be inserted before an element")}}function Z(e,t,n,i){(function(e,t,n){if(!function(e){return e&&(e.nodeType===B.DOCUMENT_NODE||e.nodeType===B.DOCUMENT_FRAGMENT_NODE||e.nodeType===B.ELEMENT_NODE)}(e))throw new R(x,"Unexpected parent node type "+e.nodeType);if(n&&n.parentNode!==e)throw new R(L,"child not in parent");if(!function(e){return e&&(H(e)||W(e)||q(e)||e.nodeType===B.DOCUMENT_FRAGMENT_NODE||e.nodeType===B.COMMENT_NODE||e.nodeType===B.PROCESSING_INSTRUCTION_NODE)}(t)||q(t)&&e.nodeType!==B.DOCUMENT_NODE)throw new R(x,"Unexpected node type "+t.nodeType+" for parent node type "+e.nodeType)})(e,t,n),e.nodeType===B.DOCUMENT_NODE&&(i||X)(e,t,n);var r=t.parentNode;if(r&&r.removeChild(t),t.nodeType===w){var s=t.firstChild;if(null==s)return t;var a=t.lastChild}else s=a=t;var o=n?n.previousSibling:e.lastChild;s.previousSibling=o,a.nextSibling=n,o?o.nextSibling=s:e.firstChild=s,null==n?e.lastChild=a:n.previousSibling=a;do{s.parentNode=e}while(s!==a&&(s=s.nextSibling));return G(e.ownerDocument||e,e),t.nodeType==w&&(t.firstChild=t.lastChild=null),t}function J(){this._nsMap={}}function ee(){}function te(){}function ne(){}function ie(){}function re(){}function se(){}function ae(){}function oe(){}function le(){}function ce(){}function ue(){}function he(){}function de(e,t){var n=[],i=9==this.nodeType&&this.documentElement||this,r=i.prefix,s=i.namespaceURI;if(s&&null==r&&null==(r=i.lookupPrefix(s)))var a=[{namespace:s,prefix:null}];return ge(this,n,e,t,a),n.join("")}function fe(e,t,n){var i=e.prefix||"",r=e.namespaceURI;if(!r)return!1;if("xml"===i&&r===s.XML||r===s.XMLNS)return!1;for(var a=n.length;a--;){var o=n[a];if(o.prefix===i)return o.namespace!==r}return!0}function pe(e,t,n){e.push(" ",t,'="',n.replace(/[<&"]/g,U),'"')}function ge(e,t,n,i,r){if(r||(r=[]),i){if(!(e=i(e)))return;if("string"==typeof e)return void t.push(e)}switch(e.nodeType){case d:var a=e.attributes,o=a.length,l=e.firstChild,c=e.tagName,u=c;if(!(n=s.isHTML(e.namespaceURI)||n)&&!e.prefix&&e.namespaceURI){for(var h,v=0;v<a.length;v++)if("xmlns"===a.item(v).name){h=a.item(v).value;break}if(!h)for(var T=r.length-1;T>=0;T--)if(""===(k=r[T]).prefix&&k.namespace===e.namespaceURI){h=k.namespace;break}if(h!==e.namespaceURI)for(T=r.length-1;T>=0;T--){var k;if((k=r[T]).namespace===e.namespaceURI){k.prefix&&(u=k.prefix+":"+c);break}}}t.push("<",u);for(var _=0;_<o;_++)"xmlns"==(x=a.item(_)).prefix?r.push({prefix:x.localName,namespace:x.value}):"xmlns"==x.nodeName&&r.push({prefix:"",namespace:x.value});for(_=0;_<o;_++){var x,L,A;fe(x=a.item(_),0,r)&&(pe(t,(L=x.prefix||"")?"xmlns:"+L:"xmlns",A=x.namespaceURI),r.push({prefix:L,namespace:A})),ge(x,t,n,i,r)}if(c===u&&fe(e,0,r)&&(pe(t,(L=e.prefix||"")?"xmlns:"+L:"xmlns",A=e.namespaceURI),r.push({prefix:L,namespace:A})),l||n&&!/^(?:meta|link|img|br|hr|input)$/i.test(c)){if(t.push(">"),n&&/^script$/i.test(c))for(;l;)l.data?t.push(l.data):ge(l,t,n,i,r.slice()),l=l.nextSibling;else for(;l;)ge(l,t,n,i,r.slice()),l=l.nextSibling;t.push("</",u,">")}else t.push("/>");return;case E:case w:for(l=e.firstChild;l;)ge(l,t,n,i,r.slice()),l=l.nextSibling;return;case f:return pe(t,e.name,e.value);case p:return t.push(e.data.replace(/[<&]/g,U).replace(/]]>/g,"]]&gt;"));case g:return t.push("<![CDATA[",e.data,"]]>");case b:return t.push("\x3c!--",e.data,"--\x3e");case S:var R=e.publicId,I=e.systemId;if(t.push("<!DOCTYPE ",e.name),R)t.push(" PUBLIC ",R),I&&"."!=I&&t.push(" ",I),t.push(">");else if(I&&"."!=I)t.push(" SYSTEM ",I,">");else{var C=e.internalSubset;C&&t.push(" [",C,"]"),t.push(">")}return;case y:return t.push("<?",e.target," ",e.data,"?>");case m:return t.push("&",e.nodeName,";");default:t.push("??",e.nodeName)}}function me(e,t,n){var i;switch(t.nodeType){case d:(i=t.cloneNode(!1)).ownerDocument=e;case w:break;case f:n=!0}if(i||(i=t.cloneNode(!1)),i.ownerDocument=e,i.parentNode=null,n)for(var r=t.firstChild;r;)i.appendChild(me(e,r,n)),r=r.nextSibling;return i}function ve(e,t,n){var i=new t.constructor;for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var s=t[r];"object"!=typeof s&&s!=i[r]&&(i[r]=s)}switch(t.childNodes&&(i.childNodes=new I),i.ownerDocument=e,i.nodeType){case d:var a=t.attributes,o=i.attributes=new P,l=a.length;o._ownerElement=i;for(var c=0;c<l;c++)i.setAttributeNode(ve(e,a.item(c),!0));break;case f:n=!0}if(n)for(var u=t.firstChild;u;)i.appendChild(ve(e,u,n)),u=u.nextSibling;return i}function ye(e,t,n){e[t]=n}k.INVALID_STATE_ERR=(_[11]="Invalid state",11),k.SYNTAX_ERR=(_[12]="Syntax error",12),k.INVALID_MODIFICATION_ERR=(_[13]="Invalid modification",13),k.NAMESPACE_ERR=(_[14]="Invalid namespace",14),k.INVALID_ACCESS_ERR=(_[15]="Invalid access",15),R.prototype=Error.prototype,c(k,R),I.prototype={length:0,item:function(e){return e>=0&&e<this.length?this[e]:null},toString:function(e,t){for(var n=[],i=0;i<this.length;i++)ge(this[i],n,e,t);return n.join("")},filter:function(e){return Array.prototype.filter.call(this,e)},indexOf:function(e){return Array.prototype.indexOf.call(this,e)}},C.prototype.item=function(e){return D(this),this[e]||null},u(C,I),P.prototype={length:0,item:I.prototype.item,getNamedItem:function(e){for(var t=this.length;t--;){var n=this[t];if(n.nodeName==e)return n}},setNamedItem:function(e){var t=e.ownerElement;if(t&&t!=this._ownerElement)throw new R(A);var n=this.getNamedItem(e.nodeName);return N(this._ownerElement,this,e,n),n},setNamedItemNS:function(e){var t,n=e.ownerElement;if(n&&n!=this._ownerElement)throw new R(A);return t=this.getNamedItemNS(e.namespaceURI,e.localName),N(this._ownerElement,this,e,t),t},removeNamedItem:function(e){var t=this.getNamedItem(e);return M(this._ownerElement,this,t),t},removeNamedItemNS:function(e,t){var n=this.getNamedItemNS(e,t);return M(this._ownerElement,this,n),n},getNamedItemNS:function(e,t){for(var n=this.length;n--;){var i=this[n];if(i.localName==t&&i.namespaceURI==e)return i}return null}},F.prototype={hasFeature:function(e,t){return!0},createDocument:function(e,t,n){var i=new j;if(i.implementation=this,i.childNodes=new I,i.doctype=n||null,n&&i.appendChild(n),t){var r=i.createElementNS(e,t);i.appendChild(r)}return i},createDocumentType:function(e,t,n){var i=new se;return i.name=e,i.nodeName=e,i.publicId=t||"",i.systemId=n||"",i}},B.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(e,t){return Z(this,e,t)},replaceChild:function(e,t){Z(this,e,t,Q),t&&this.removeChild(t)},removeChild:function(e){return V(this,e)},appendChild:function(e){return this.insertBefore(e,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(e){return ve(this.ownerDocument||this,this,e)},normalize:function(){for(var e=this.firstChild;e;){var t=e.nextSibling;t&&t.nodeType==p&&e.nodeType==p?(this.removeChild(t),e.appendData(t.data)):(e.normalize(),e=t)}},isSupported:function(e,t){return this.ownerDocument.implementation.hasFeature(e,t)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(e){for(var t=this;t;){var n=t._nsMap;if(n)for(var i in n)if(Object.prototype.hasOwnProperty.call(n,i)&&n[i]===e)return i;t=t.nodeType==f?t.ownerDocument:t.parentNode}return null},lookupNamespaceURI:function(e){for(var t=this;t;){var n=t._nsMap;if(n&&e in n&&Object.prototype.hasOwnProperty.call(n,e))return n[e];t=t.nodeType==f?t.ownerDocument:t.parentNode}return null},isDefaultNamespace:function(e){return null==this.lookupPrefix(e)}},c(h,B),c(h,B.prototype),j.prototype={nodeName:"#document",nodeType:E,doctype:null,documentElement:null,_inc:1,insertBefore:function(e,t){if(e.nodeType==w){for(var n=e.firstChild;n;){var i=n.nextSibling;this.insertBefore(n,t),n=i}return e}return Z(this,e,t),e.ownerDocument=this,null===this.documentElement&&e.nodeType===d&&(this.documentElement=e),e},removeChild:function(e){return this.documentElement==e&&(this.documentElement=null),V(this,e)},replaceChild:function(e,t){Z(this,e,t,Q),e.ownerDocument=this,t&&this.removeChild(t),H(e)&&(this.documentElement=e)},importNode:function(e,t){return me(this,e,t)},getElementById:function(e){var t=null;return $(this.documentElement,function(n){if(n.nodeType==d&&n.getAttribute("id")==e)return t=n,!0}),t},getElementsByClassName:function(e){var t=l(e);return new C(this,function(n){var i=[];return t.length>0&&$(n.documentElement,function(r){if(r!==n&&r.nodeType===d){var s=r.getAttribute("class");if(s){var a=e===s;if(!a){var o=l(s);a=t.every((c=o,function(e){return c&&-1!==c.indexOf(e)}))}a&&i.push(r)}}var c}),i})},createElement:function(e){var t=new J;return t.ownerDocument=this,t.nodeName=e,t.tagName=e,t.localName=e,t.childNodes=new I,(t.attributes=new P)._ownerElement=t,t},createDocumentFragment:function(){var e=new ce;return e.ownerDocument=this,e.childNodes=new I,e},createTextNode:function(e){var t=new ne;return t.ownerDocument=this,t.appendData(e),t},createComment:function(e){var t=new ie;return t.ownerDocument=this,t.appendData(e),t},createCDATASection:function(e){var t=new re;return t.ownerDocument=this,t.appendData(e),t},createProcessingInstruction:function(e,t){var n=new ue;return n.ownerDocument=this,n.tagName=n.nodeName=n.target=e,n.nodeValue=n.data=t,n},createAttribute:function(e){var t=new ee;return t.ownerDocument=this,t.name=e,t.nodeName=e,t.localName=e,t.specified=!0,t},createEntityReference:function(e){var t=new le;return t.ownerDocument=this,t.nodeName=e,t},createElementNS:function(e,t){var n=new J,i=t.split(":"),r=n.attributes=new P;return n.childNodes=new I,n.ownerDocument=this,n.nodeName=t,n.tagName=t,n.namespaceURI=e,2==i.length?(n.prefix=i[0],n.localName=i[1]):n.localName=t,r._ownerElement=n,n},createAttributeNS:function(e,t){var n=new ee,i=t.split(":");return n.ownerDocument=this,n.nodeName=t,n.name=t,n.namespaceURI=e,n.specified=!0,2==i.length?(n.prefix=i[0],n.localName=i[1]):n.localName=t,n}},u(j,B),J.prototype={nodeType:d,hasAttribute:function(e){return null!=this.getAttributeNode(e)},getAttribute:function(e){var t=this.getAttributeNode(e);return t&&t.value||""},getAttributeNode:function(e){return this.attributes.getNamedItem(e)},setAttribute:function(e,t){var n=this.ownerDocument.createAttribute(e);n.value=n.nodeValue=""+t,this.setAttributeNode(n)},removeAttribute:function(e){var t=this.getAttributeNode(e);t&&this.removeAttributeNode(t)},appendChild:function(e){return e.nodeType===w?this.insertBefore(e,null):function(e,t){return t.parentNode&&t.parentNode.removeChild(t),t.parentNode=e,t.previousSibling=e.lastChild,t.nextSibling=null,t.previousSibling?t.previousSibling.nextSibling=t:e.firstChild=t,e.lastChild=t,G(e.ownerDocument,e,t),t}(this,e)},setAttributeNode:function(e){return this.attributes.setNamedItem(e)},setAttributeNodeNS:function(e){return this.attributes.setNamedItemNS(e)},removeAttributeNode:function(e){return this.attributes.removeNamedItem(e.nodeName)},removeAttributeNS:function(e,t){var n=this.getAttributeNodeNS(e,t);n&&this.removeAttributeNode(n)},hasAttributeNS:function(e,t){return null!=this.getAttributeNodeNS(e,t)},getAttributeNS:function(e,t){var n=this.getAttributeNodeNS(e,t);return n&&n.value||""},setAttributeNS:function(e,t,n){var i=this.ownerDocument.createAttributeNS(e,t);i.value=i.nodeValue=""+n,this.setAttributeNode(i)},getAttributeNodeNS:function(e,t){return this.attributes.getNamedItemNS(e,t)},getElementsByTagName:function(e){return new C(this,function(t){var n=[];return $(t,function(i){i===t||i.nodeType!=d||"*"!==e&&i.tagName!=e||n.push(i)}),n})},getElementsByTagNameNS:function(e,t){return new C(this,function(n){var i=[];return $(n,function(r){r===n||r.nodeType!==d||"*"!==e&&r.namespaceURI!==e||"*"!==t&&r.localName!=t||i.push(r)}),i})}},j.prototype.getElementsByTagName=J.prototype.getElementsByTagName,j.prototype.getElementsByTagNameNS=J.prototype.getElementsByTagNameNS,u(J,B),ee.prototype.nodeType=f,u(ee,B),te.prototype={data:"",substringData:function(e,t){return this.data.substring(e,e+t)},appendData:function(e){e=this.data+e,this.nodeValue=this.data=e,this.length=e.length},insertData:function(e,t){this.replaceData(e,0,t)},appendChild:function(e){throw new Error(_[x])},deleteData:function(e,t){this.replaceData(e,t,"")},replaceData:function(e,t,n){n=this.data.substring(0,e)+n+this.data.substring(e+t),this.nodeValue=this.data=n,this.length=n.length}},u(te,B),ne.prototype={nodeName:"#text",nodeType:p,splitText:function(e){var t=this.data,n=t.substring(e);t=t.substring(0,e),this.data=this.nodeValue=t,this.length=t.length;var i=this.ownerDocument.createTextNode(n);return this.parentNode&&this.parentNode.insertBefore(i,this.nextSibling),i}},u(ne,te),ie.prototype={nodeName:"#comment",nodeType:b},u(ie,te),re.prototype={nodeName:"#cdata-section",nodeType:g},u(re,te),se.prototype.nodeType=S,u(se,B),ae.prototype.nodeType=T,u(ae,B),oe.prototype.nodeType=v,u(oe,B),le.prototype.nodeType=m,u(le,B),ce.prototype.nodeName="#document-fragment",ce.prototype.nodeType=w,u(ce,B),ue.prototype.nodeType=y,u(ue,B),he.prototype.serializeToString=function(e,t,n){return de.call(e,t,n)},B.prototype.toString=de;try{if(Object.defineProperty){function be(e){switch(e.nodeType){case d:case w:var t=[];for(e=e.firstChild;e;)7!==e.nodeType&&8!==e.nodeType&&t.push(be(e)),e=e.nextSibling;return t.join("");default:return e.nodeValue}}Object.defineProperty(C.prototype,"length",{get:function(){return D(this),this.$$length}}),Object.defineProperty(B.prototype,"textContent",{get:function(){return be(this)},set:function(e){switch(this.nodeType){case d:case w:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),ye=function(e,t,n){e["$$"+t]=n}}}catch(Ee){}t.DocumentType=se,t.DOMException=R,t.DOMImplementation=F,t.Element=J,t.Node=B,t.NodeList=I,t.XMLSerializer=he},4840:(e,t,n)=>{var i="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g;e.exports=i},4848:(e,t,n)=>{"use strict";e.exports=n(1020)},5056:(e,t,n)=>{"use strict";e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},5072:e=>{"use strict";var t=[];function n(e){for(var n=-1,i=0;i<t.length;i++)if(t[i].identifier===e){n=i;break}return n}function i(e,i){for(var s={},a=[],o=0;o<e.length;o++){var l=e[o],c=i.base?l[0]+i.base:l[0],u=s[c]||0,h="".concat(c," ").concat(u);s[c]=u+1;var d=n(h),f={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==d)t[d].references++,t[d].updater(f);else{var p=r(f,i);i.byIndex=o,t.splice(o,0,{identifier:h,updater:p,references:1})}a.push(h)}return a}function r(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,r){var s=i(e=e||[],r=r||{});return function(e){e=e||[];for(var a=0;a<s.length;a++){var o=n(s[a]);t[o].references--}for(var l=i(e,r),c=0;c<s.length;c++){var u=n(s[c]);0===t[u].references&&(t[u].updater(),t.splice(u,1))}s=l}}},5287:(e,t)=>{"use strict";var n=Symbol.for("react.element"),i=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator,p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,m={};function v(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var E=b.prototype=new y;E.constructor=b,g(E,v.prototype),E.isPureReactComponent=!0;var S=Array.isArray,w=Object.prototype.hasOwnProperty,T={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function _(e,t,i){var r,s={},a=null,o=null;if(null!=t)for(r in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(a=""+t.key),t)w.call(t,r)&&!k.hasOwnProperty(r)&&(s[r]=t[r]);var l=arguments.length-2;if(1===l)s.children=i;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps)void 0===s[r]&&(s[r]=l[r]);return{$$typeof:n,type:e,key:a,ref:o,props:s,_owner:T.current}}function x(e){return"object"==typeof e&&null!==e&&e.$$typeof===n}var L=/\/+/g;function A(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function R(e,t,r,s,a){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case i:l=!0}}if(l)return a=a(l=e),e=""===s?"."+A(l,0):s,S(a)?(r="",null!=e&&(r=e.replace(L,"$&/")+"/"),R(a,t,r,"",function(e){return e})):null!=a&&(x(a)&&(a=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(a,r+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(L,"$&/")+"/")+e)),t.push(a)),1;if(l=0,s=""===s?".":s+":",S(e))for(var c=0;c<e.length;c++){var u=s+A(o=e[c],c);l+=R(o,t,r,u,a)}else if(u=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"==typeof u)for(e=u.call(e),c=0;!(o=e.next()).done;)l+=R(o=o.value,t,r,u=s+A(o,c++),a);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function I(e,t,n){if(null==e)return e;var i=[],r=0;return R(e,i,"","",function(e){return t.call(n,e,r++)}),i}function C(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var D={current:null},P={transition:null},O={ReactCurrentDispatcher:D,ReactCurrentBatchConfig:P,ReactCurrentOwner:T};function N(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:I,forEach:function(e,t,n){I(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return I(e,function(){t++}),t},toArray:function(e){return I(e,function(e){return e})||[]},only:function(e){if(!x(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=r,t.Profiler=a,t.PureComponent=b,t.StrictMode=s,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=O,t.act=N,t.cloneElement=function(e,t,i){if(null==e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=g({},e.props),s=e.key,a=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(a=t.ref,o=T.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)w.call(t,c)&&!k.hasOwnProperty(c)&&(r[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)r.children=i;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:n,type:e.type,key:s,ref:a,props:r,_owner:o}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=_,t.createFactory=function(e){var t=_.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=x,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:C}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=P.transition;P.transition={};try{e()}finally{P.transition=t}},t.unstable_act=N,t.useCallback=function(e,t){return D.current.useCallback(e,t)},t.useContext=function(e){return D.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return D.current.useDeferredValue(e)},t.useEffect=function(e,t){return D.current.useEffect(e,t)},t.useId=function(){return D.current.useId()},t.useImperativeHandle=function(e,t,n){return D.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return D.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return D.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return D.current.useMemo(e,t)},t.useReducer=function(e,t,n){return D.current.useReducer(e,t,n)},t.useRef=function(e){return D.current.useRef(e)},t.useState=function(e){return D.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return D.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return D.current.useTransition()},t.version="18.3.1"},5338:(e,t,n)=>{"use strict";var i=n(961);t.createRoot=i.createRoot,t.hydrateRoot=i.hydrateRoot},5339:e=>{"use strict";e.exports=function(){var e,t=Object.assign;return"function"==typeof t&&(t(e={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")}},5446:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,r=(i=n(4166))&&i.__esModule?i:{default:i},s=n(3575);t.default=class{constructor(e,t,n,i=!1){this.layout=e,this.horizontal="horizontal"===n,this.direction=t||"ltr",this._dev=i}section(e){var t=this.findRanges(e);return this.rangeListToCfiList(e.section.cfiBase,t)}page(e,t,n,i){var s,a=!(!e||!e.document)&&e.document.body;if(a){if(s=this.rangePairToCfiPair(t,{start:this.findStart(a,n,i),end:this.findEnd(a,n,i)}),!0===this._dev){let t=e.document,n=new r.default(s.start).toRange(t),i=new r.default(s.end).toRange(t),a=t.defaultView.getSelection(),o=t.createRange();a.removeAllRanges(),o.setStart(n.startContainer,n.startOffset),o.setEnd(i.endContainer,i.endOffset),a.addRange(o)}return s}}walk(e,t){if(!e||e.nodeType!==Node.TEXT_NODE){var n=function(e){return e.data.trim().length>0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT},i=n;i.acceptNode=n;for(var r,s,a=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,i,!1);(r=a.nextNode())&&!(s=t(r)););return s}}findRanges(e){for(var t,n,i=[],r=e.contents.scrollWidth(),s=Math.ceil(r/this.layout.spreadWidth)*this.layout.divisor,a=this.layout.columnWidth,o=this.layout.gap,l=0;l<s.pages;l++)t=(a+o)*l,n=a*(l+1)+o*l,i.push({start:this.findStart(e.document.body,t,n),end:this.findEnd(e.document.body,t,n)});return i}findStart(e,t,n){for(var i,r,a=[e],o=e;a.length;)if(i=a.shift(),r=this.walk(i,e=>{var i,r,l,c,u;if(u=(0,s.nodeBounds)(e),this.horizontal&&"ltr"===this.direction){if(i=this.horizontal?u.left:u.top,r=this.horizontal?u.right:u.bottom,i>=t&&i<=n)return e;if(r>t)return e;o=e,a.push(e)}else if(this.horizontal&&"rtl"===this.direction){if(i=u.left,(r=u.right)<=n&&r>=t)return e;if(i<n)return e;o=e,a.push(e)}else{if(l=u.top,c=u.bottom,l>=t&&l<=n)return e;if(c>t)return e;o=e,a.push(e)}}))return this.findTextStartRange(r,t,n);return this.findTextStartRange(o,t,n)}findEnd(e,t,n){for(var i,r,a=[e],o=e;a.length;)if(i=a.shift(),r=this.walk(i,e=>{var i,r,l,c,u;if(u=(0,s.nodeBounds)(e),this.horizontal&&"ltr"===this.direction){if(i=Math.round(u.left),r=Math.round(u.right),i>n&&o)return o;if(r>n)return e;o=e,a.push(e)}else if(this.horizontal&&"rtl"===this.direction){if(i=Math.round(this.horizontal?u.left:u.top),(r=Math.round(this.horizontal?u.right:u.bottom))<t&&o)return o;if(i<t)return e;o=e,a.push(e)}else{if(l=Math.round(u.top),c=Math.round(u.bottom),l>n&&o)return o;if(c>n)return e;o=e,a.push(e)}}))return this.findTextEndRange(r,t,n);return this.findTextEndRange(o,t,n)}findTextStartRange(e,t,n){for(var i,r,s=this.splitTextNodeIntoRanges(e),a=0;a<s.length;a++)if(r=(i=s[a]).getBoundingClientRect(),this.horizontal&&"ltr"===this.direction){if(r.left>=t)return i}else if(this.horizontal&&"rtl"===this.direction){if(r.right<=n)return i}else if(r.top>=t)return i;return s[0]}findTextEndRange(e,t,n){for(var i,r,s,a,o,l,c,u=this.splitTextNodeIntoRanges(e),h=0;h<u.length;h++){if(s=(r=u[h]).getBoundingClientRect(),this.horizontal&&"ltr"===this.direction){if(a=s.left,o=s.right,a>n&&i)return i;if(o>n)return r}else if(this.horizontal&&"rtl"===this.direction){if(a=s.left,(o=s.right)<t&&i)return i;if(a<t)return r}else{if(l=s.top,c=s.bottom,l>n&&i)return i;if(c>n)return r}i=r}return u[u.length-1]}splitTextNodeIntoRanges(e,t){var n,i=[],r=(e.textContent||"").trim(),s=e.ownerDocument,a=t||" ",o=r.indexOf(a);if(-1===o||e.nodeType!=Node.TEXT_NODE)return(n=s.createRange()).selectNodeContents(e),[n];for((n=s.createRange()).setStart(e,0),n.setEnd(e,o),i.push(n),n=!1;-1!=o;)(o=r.indexOf(a,o+1))>0&&(n&&(n.setEnd(e,o),i.push(n)),(n=s.createRange()).setStart(e,o+1));return n&&(n.setEnd(e,r.length),i.push(n)),i}rangePairToCfiPair(e,t){var n=t.start,i=t.end;return n.collapse(!0),i.collapse(!1),{start:new r.default(n,e).toString(),end:new r.default(i,e).toString()}}rangeListToCfiList(e,t){for(var n,i=[],r=0;r<t.length;r++)n=this.rangePairToCfiPair(e,t[r]),i.push(n);return i}axis(e){return e&&(this.horizontal="horizontal"===e),this.horizontal}}},5487:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EpubViewStyle=void 0,t.EpubViewStyle={viewHolder:{position:"relative",height:"100%",width:"100%"},view:{height:"100%"}}},5499:e=>{"use strict";e.exports=function(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return e}},5556:(e,t,n)=>{e.exports=n(2694)()},5722:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n(3068)),r=a(n(4166)),s=n(4083);function a(e){return e&&e.__esModule?e:{default:e}}class o{constructor({type:e,cfiRange:t,data:n,sectionIndex:i,cb:r,className:s,styles:a}){this.type=e,this.cfiRange=t,this.data=n,this.sectionIndex=i,this.mark=void 0,this.cb=r,this.className=s,this.styles=a}update(e){this.data=e}attach(e){let t,{cfiRange:n,data:i,type:r,mark:a,cb:o,className:l,styles:c}=this;return"highlight"===r?t=e.highlight(n,i,o,l,c):"underline"===r?t=e.underline(n,i,o,l,c):"mark"===r&&(t=e.mark(n,i,o)),this.mark=t,this.emit(s.EVENTS.ANNOTATION.ATTACH,t),t}detach(e){let t,{cfiRange:n,type:i}=this;return e&&("highlight"===i?t=e.unhighlight(n):"underline"===i?t=e.ununderline(n):"mark"===i&&(t=e.unmark(n))),this.mark=void 0,this.emit(s.EVENTS.ANNOTATION.DETACH,t),t}text(){}}(0,i.default)(o.prototype);t.default=class{constructor(e){this.rendition=e,this.highlights=[],this.underlines=[],this.marks=[],this._annotations={},this._annotationsBySectionIndex={},this.rendition.hooks.render.register(this.inject.bind(this)),this.rendition.hooks.unloaded.register(this.clear.bind(this))}add(e,t,n,i,s,a){let l=encodeURI(t+e),c=new r.default(t).spinePos,u=new o({type:e,cfiRange:t,data:n,sectionIndex:c,cb:i,className:s,styles:a});return this._annotations[l]=u,c in this._annotationsBySectionIndex?this._annotationsBySectionIndex[c].push(l):this._annotationsBySectionIndex[c]=[l],this.rendition.views().forEach(e=>{u.sectionIndex===e.index&&u.attach(e)}),u}remove(e,t){let n=encodeURI(e+t);if(n in this._annotations){let e=this._annotations[n];if(t&&e.type!==t)return;this.rendition.views().forEach(t=>{this._removeFromAnnotationBySectionIndex(e.sectionIndex,n),e.sectionIndex===t.index&&e.detach(t)}),delete this._annotations[n]}}_removeFromAnnotationBySectionIndex(e,t){this._annotationsBySectionIndex[e]=this._annotationsAt(e).filter(e=>e!==t)}_annotationsAt(e){return this._annotationsBySectionIndex[e]}highlight(e,t,n,i,r){return this.add("highlight",e,t,n,i,r)}underline(e,t,n,i,r){return this.add("underline",e,t,n,i,r)}mark(e,t,n){return this.add("mark",e,t,n)}each(){return this._annotations.forEach.apply(this._annotations,arguments)}inject(e){let t=e.index;t in this._annotationsBySectionIndex&&this._annotationsBySectionIndex[t].forEach(t=>{this._annotations[t].attach(e)})}clear(e){let t=e.index;t in this._annotationsBySectionIndex&&this._annotationsBySectionIndex[t].forEach(t=>{this._annotations[t].detach(e)})}show(){}hide(){}}},5752:(e,t,n)=>{var i=n(4582),r=n(4722),s=n(6559),a=n(4466),o=r.DOMImplementation,l=i.NAMESPACE,c=a.ParseError,u=a.XMLReader;function h(e){this.options=e||{locator:{}}}function d(){this.cdata=!1}function f(e,t){t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber}function p(e){if(e)return"\n@"+(e.systemId||"")+"#[line:"+e.lineNumber+",col:"+e.columnNumber+"]"}function g(e,t,n){return"string"==typeof e?e.substr(t,n):e.length>=t+n||t?new java.lang.String(e,t,n)+"":e}function m(e,t){e.currentElement?e.currentElement.appendChild(t):e.doc.appendChild(t)}h.prototype.parseFromString=function(e,t){var n=this.options,i=new u,r=n.domBuilder||new d,a=n.errorHandler,o=n.locator,c=n.xmlns||{},h=/\/x?html?$/.test(t),f=h?s.HTML_ENTITIES:s.XML_ENTITIES;return o&&r.setDocumentLocator(o),i.errorHandler=function(e,t,n){if(!e){if(t instanceof d)return t;e=t}var i={},r=e instanceof Function;function s(t){var s=e[t];!s&&r&&(s=2==e.length?function(n){e(t,n)}:e),i[t]=s&&function(e){s("[xmldom "+t+"]\t"+e+p(n))}||function(){}}return n=n||{},s("warning"),s("error"),s("fatalError"),i}(a,r,o),i.domBuilder=n.domBuilder||r,h&&(c[""]=l.HTML),c.xml=c.xml||l.XML,e&&"string"==typeof e?i.parse(e,c,f):i.errorHandler.error("invalid doc source"),r.doc},d.prototype={startDocument:function(){this.doc=(new o).createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(e,t,n,i){var r=this.doc,s=r.createElementNS(e,n||t),a=i.length;m(this,s),this.currentElement=s,this.locator&&f(this.locator,s);for(var o=0;o<a;o++){e=i.getURI(o);var l=i.getValue(o),c=(n=i.getQName(o),r.createAttributeNS(e,n));this.locator&&f(i.getLocator(o),c),c.value=c.nodeValue=l,s.setAttributeNode(c)}},endElement:function(e,t,n){var i=this.currentElement;i.tagName,this.currentElement=i.parentNode},startPrefixMapping:function(e,t){},endPrefixMapping:function(e){},processingInstruction:function(e,t){var n=this.doc.createProcessingInstruction(e,t);this.locator&&f(this.locator,n),m(this,n)},ignorableWhitespace:function(e,t,n){},characters:function(e,t,n){if(e=g.apply(this,arguments)){if(this.cdata)var i=this.doc.createCDATASection(e);else i=this.doc.createTextNode(e);this.currentElement?this.currentElement.appendChild(i):/^\s*$/.test(e)&&this.doc.appendChild(i),this.locator&&f(this.locator,i)}},skippedEntity:function(e){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(e){(this.locator=e)&&(e.lineNumber=0)},comment:function(e,t,n){e=g.apply(this,arguments);var i=this.doc.createComment(e);this.locator&&f(this.locator,i),m(this,i)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(e,t,n){var i=this.doc.implementation;if(i&&i.createDocumentType){var r=i.createDocumentType(e,t,n);this.locator&&f(this.locator,r),m(this,r),this.doc.doctype=r}},warning:function(e){console.warn("[xmldom warning]\t"+e,p(this.locator))},error:function(e){console.error("[xmldom error]\t"+e,p(this.locator))},fatalError:function(e){throw new c(e,this.locator)}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(e){d.prototype[e]=function(){return null}}),t.DOMParser=h,r.DOMImplementation,r.XMLSerializer},5836:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(3575),r=l(n(7613)),s=l(n(4166)),a=n(4083),o=l(n(3068));function l(e){return e&&e.__esModule?e:{default:e}}class c{constructor(e,t,n){this.spine=e,this.request=t,this.pause=n||100,this.q=new r.default(this),this.epubcfi=new s.default,this._locations=[],this._locationsWords=[],this.total=0,this.break=150,this._current=0,this._wordCounter=0,this.currentLocation="",this._currentCfi="",this.processingTimeout=void 0}generate(e){return e&&(this.break=e),this.q.pause(),this.spine.each(function(e){e.linear&&this.q.enqueue(this.process.bind(this),e)}.bind(this)),this.q.run().then(function(){return this.total=this._locations.length-1,this._currentCfi&&(this.currentLocation=this._currentCfi),this._locations}.bind(this))}createRange(){return{startContainer:void 0,startOffset:void 0,endContainer:void 0,endOffset:void 0}}process(e){return e.load(this.request).then(function(t){var n=new i.defer,r=this.parse(t,e.cfiBase);return this._locations=this._locations.concat(r),e.unload(),this.processingTimeout=setTimeout(()=>n.resolve(r),this.pause),n.promise}.bind(this))}parse(e,t,n){var r,a,o=[],l=e.ownerDocument,c=(0,i.qs)(l,"body"),u=0,h=n||this.break;if((0,i.sprint)(c,function(e){var n,i=e.length,l=0;if(0===e.textContent.trim().length)return!1;for(0==u&&((r=this.createRange()).startContainer=e,r.startOffset=0),(n=h-u)>i&&(u+=i,l=i);l<i;)if(n=h-u,0===u&&(l+=1,(r=this.createRange()).startContainer=e,r.startOffset=l),l+n>=i)u+=i-l,l=i;else{l+=n,r.endContainer=e,r.endOffset=l;let i=new s.default(r,t).toString();o.push(i),u=0}a=e}.bind(this)),r&&r.startContainer&&a){r.endContainer=a,r.endOffset=a.length;let e=new s.default(r,t).toString();o.push(e),u=0}return o}generateFromWords(e,t,n){var i=e?new s.default(e):void 0;return this.q.pause(),this._locationsWords=[],this._wordCounter=0,this.spine.each(function(e){e.linear&&(i?e.index>=i.spinePos&&this.q.enqueue(this.processWords.bind(this),e,t,i,n):this.q.enqueue(this.processWords.bind(this),e,t,i,n))}.bind(this)),this.q.run().then(function(){return this._currentCfi&&(this.currentLocation=this._currentCfi),this._locationsWords}.bind(this))}processWords(e,t,n,r){return r&&this._locationsWords.length>=r?Promise.resolve():e.load(this.request).then(function(s){var a=new i.defer,o=this.parseWords(s,e,t,n),l=r-this._locationsWords.length;return this._locationsWords=this._locationsWords.concat(o.length>=r?o.slice(0,l):o),e.unload(),this.processingTimeout=setTimeout(()=>a.resolve(o),this.pause),a.promise}.bind(this))}countWords(e){return(e=(e=(e=e.replace(/(^\s*)|(\s*$)/gi,"")).replace(/[ ]{2,}/gi," ")).replace(/\n /,"\n")).split(" ").length}parseWords(e,t,n,r){var a,o=t.cfiBase,l=[],c=e.ownerDocument,u=(0,i.qs)(c,"body"),h=n,d=!r||r.spinePos!==t.index;return r&&t.index===r.spinePos&&(a=r.findNode(r.range?r.path.steps.concat(r.start.steps):r.path.steps,e.ownerDocument)),(0,i.sprint)(u,function(e){if(!d){if(e!==a)return!1;d=!0}if(e.textContent.length<10&&0===e.textContent.trim().length)return!1;var t,n=this.countWords(e.textContent),i=0;if(0===n)return!1;for((t=h-this._wordCounter)>n&&(this._wordCounter+=n,i=n);i<n;)if(i+(t=h-this._wordCounter)>=n)this._wordCounter+=n-i,i=n;else{i+=t;let n=new s.default(e,o);l.push({cfi:n.toString(),wordCount:this._wordCounter}),this._wordCounter=0}}.bind(this)),l}locationFromCfi(e){let t;return s.default.prototype.isCfiString(e)&&(e=new s.default(e)),0===this._locations.length?-1:(t=(0,i.locationOf)(e,this._locations,this.epubcfi.compare),t>this.total?this.total:t)}percentageFromCfi(e){if(0===this._locations.length)return null;var t=this.locationFromCfi(e);return this.percentageFromLocation(t)}percentageFromLocation(e){return e&&this.total?e/this.total:0}cfiFromLocation(e){var t=-1;return"number"!=typeof e&&(e=parseInt(e)),e>=0&&e<this._locations.length&&(t=this._locations[e]),t}cfiFromPercentage(e){let t;if(e>1&&console.warn("Normalize cfiFromPercentage value to between 0 - 1"),e>=1){let e=new s.default(this._locations[this.total]);return e.collapse(),e.toString()}return t=Math.ceil(this.total*e),this.cfiFromLocation(t)}load(e){return this._locations="string"==typeof e?JSON.parse(e):e,this.total=this._locations.length-1,this._locations}save(){return JSON.stringify(this._locations)}getCurrent(){return this._current}setCurrent(e){var t;if("string"==typeof e)this._currentCfi=e;else{if("number"!=typeof e)return;this._current=e}0!==this._locations.length&&("string"==typeof e?(t=this.locationFromCfi(e),this._current=t):t=e,this.emit(a.EVENTS.LOCATIONS.CHANGED,{percentage:this.percentageFromLocation(t)}))}get currentLocation(){return this._current}set currentLocation(e){this.setCurrent(e)}length(){return this._locations.length}destroy(){this.spine=void 0,this.request=void 0,this.pause=void 0,this.q.stop(),this.q=void 0,this.epubcfi=void 0,this._locations=void 0,this.total=void 0,this.break=void 0,this._current=void 0,this.currentLocation=void 0,this._currentCfi=void 0,clearTimeout(this.processingTimeout)}}(0,o.default)(c.prototype);var u=c;t.default=u},6011:e=>{"use strict";e.exports=function(){}},6025:(e,t,n)=>{"use strict";e.exports=n.p+"de2ad6c266643a5f9b17.png"},6046:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var i=n(1601),r=n.n(i),s=n(6314),a=n.n(s)()(r());a.push([e.id,".block {\n  display: grid;\n  grid-template-columns: 25% 25% 25% 25%;\n}\n.block .card-wrap {\n  margin: 10px;\n}\n.block .card-wrap img {\n  max-width: 100%;\n}\n",""]);const o=a},6120:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,r=(i=n(2259))&&i.__esModule?i:{default:i};t.default=class{constructor(e){this.rendition=e,this._themes={default:{rules:{},url:"",serialized:""}},this._overrides={},this._current="default",this._injected=[],this.rendition.hooks.content.register(this.inject.bind(this)),this.rendition.hooks.content.register(this.overrides.bind(this))}register(){if(0!==arguments.length)return 1===arguments.length&&"object"==typeof arguments[0]?this.registerThemes(arguments[0]):1===arguments.length&&"string"==typeof arguments[0]?this.default(arguments[0]):2===arguments.length&&"string"==typeof arguments[1]?this.registerUrl(arguments[0],arguments[1]):2===arguments.length&&"object"==typeof arguments[1]?this.registerRules(arguments[0],arguments[1]):void 0}default(e){if(e)return"string"==typeof e?this.registerUrl("default",e):"object"==typeof e?this.registerRules("default",e):void 0}registerThemes(e){for(var t in e)e.hasOwnProperty(t)&&("string"==typeof e[t]?this.registerUrl(t,e[t]):this.registerRules(t,e[t]))}registerCss(e,t){this._themes[e]={serialized:t},(this._injected[e]||"default"==e)&&this.update(e)}registerUrl(e,t){var n=new r.default(t);this._themes[e]={url:n.toString()},(this._injected[e]||"default"==e)&&this.update(e)}registerRules(e,t){this._themes[e]={rules:t},(this._injected[e]||"default"==e)&&this.update(e)}select(e){var t=this._current;this._current=e,this.update(e),this.rendition.getContents().forEach(n=>{n.removeClass(t),n.addClass(e)})}update(e){this.rendition.getContents().forEach(t=>{this.add(e,t)})}inject(e){var t,n=[],i=this._themes;for(var r in i)!i.hasOwnProperty(r)||r!==this._current&&"default"!==r||(((t=i[r]).rules&&Object.keys(t.rules).length>0||t.url&&-1===n.indexOf(t.url))&&this.add(r,e),this._injected.push(r));"default"!=this._current&&e.addClass(this._current)}add(e,t){var n=this._themes[e];n&&t&&(n.url?t.addStylesheet(n.url):n.serialized?(t.addStylesheetCss(n.serialized,e),n.injected=!0):n.rules&&(t.addStylesheetRules(n.rules,e),n.injected=!0))}override(e,t,n){var i=this.rendition.getContents();this._overrides[e]={value:t,priority:!0===n},i.forEach(t=>{t.css(e,this._overrides[e].value,this._overrides[e].priority)})}removeOverride(e){var t=this.rendition.getContents();delete this._overrides[e],t.forEach(t=>{t.css(e)})}overrides(e){var t=this._overrides;for(var n in t)t.hasOwnProperty(n)&&e.css(n,t[n].value,t[n].priority)}fontSize(e){this.override("font-size",e)}font(e){this.override("font-family",e,!0)}destroy(){this.rendition=void 0,this._themes=void 0,this._overrides=void 0,this._current=void 0,this._injected=void 0}}},6314:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var n="",i=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),i&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),i&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n}).join("")},t.i=function(e,n,i,r,s){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(i)for(var o=0;o<this.length;o++){var l=this[o][0];null!=l&&(a[l]=!0)}for(var c=0;c<e.length;c++){var u=[].concat(e[c]);i&&a[u[0]]||(void 0!==s&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=s),n&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=n):u[2]=n),r&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=r):u[4]="".concat(r)),t.push(u))}},t}},6540:(e,t,n)=>{"use strict";e.exports=n(5287)},6559:(e,t,n)=>{"use strict";var i=n(4582).freeze;t.XML_ENTITIES=i({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),t.HTML_ENTITIES=i({Aacute:"Á",aacute:"á",Abreve:"Ă",abreve:"ă",ac:"∾",acd:"∿",acE:"∾̳",Acirc:"Â",acirc:"â",acute:"´",Acy:"А",acy:"а",AElig:"Æ",aelig:"æ",af:"⁡",Afr:"𝔄",afr:"𝔞",Agrave:"À",agrave:"à",alefsym:"ℵ",aleph:"ℵ",Alpha:"Α",alpha:"α",Amacr:"Ā",amacr:"ā",amalg:"⨿",AMP:"&",amp:"&",And:"⩓",and:"∧",andand:"⩕",andd:"⩜",andslope:"⩘",andv:"⩚",ang:"∠",ange:"⦤",angle:"∠",angmsd:"∡",angmsdaa:"⦨",angmsdab:"⦩",angmsdac:"⦪",angmsdad:"⦫",angmsdae:"⦬",angmsdaf:"⦭",angmsdag:"⦮",angmsdah:"⦯",angrt:"∟",angrtvb:"⊾",angrtvbd:"⦝",angsph:"∢",angst:"Å",angzarr:"⍼",Aogon:"Ą",aogon:"ą",Aopf:"𝔸",aopf:"𝕒",ap:"≈",apacir:"⩯",apE:"⩰",ape:"≊",apid:"≋",apos:"'",ApplyFunction:"⁡",approx:"≈",approxeq:"≊",Aring:"Å",aring:"å",Ascr:"𝒜",ascr:"𝒶",Assign:"≔",ast:"*",asymp:"≈",asympeq:"≍",Atilde:"Ã",atilde:"ã",Auml:"Ä",auml:"ä",awconint:"∳",awint:"⨑",backcong:"≌",backepsilon:"϶",backprime:"‵",backsim:"∽",backsimeq:"⋍",Backslash:"∖",Barv:"⫧",barvee:"⊽",Barwed:"⌆",barwed:"⌅",barwedge:"⌅",bbrk:"⎵",bbrktbrk:"⎶",bcong:"≌",Bcy:"Б",bcy:"б",bdquo:"„",becaus:"∵",Because:"∵",because:"∵",bemptyv:"⦰",bepsi:"϶",bernou:"ℬ",Bernoullis:"ℬ",Beta:"Β",beta:"β",beth:"ℶ",between:"≬",Bfr:"𝔅",bfr:"𝔟",bigcap:"⋂",bigcirc:"◯",bigcup:"⋃",bigodot:"⨀",bigoplus:"⨁",bigotimes:"⨂",bigsqcup:"⨆",bigstar:"★",bigtriangledown:"▽",bigtriangleup:"△",biguplus:"⨄",bigvee:"⋁",bigwedge:"⋀",bkarow:"⤍",blacklozenge:"⧫",blacksquare:"▪",blacktriangle:"▴",blacktriangledown:"▾",blacktriangleleft:"◂",blacktriangleright:"▸",blank:"␣",blk12:"▒",blk14:"░",blk34:"▓",block:"█",bne:"=⃥",bnequiv:"≡⃥",bNot:"⫭",bnot:"⌐",Bopf:"𝔹",bopf:"𝕓",bot:"⊥",bottom:"⊥",bowtie:"⋈",boxbox:"⧉",boxDL:"╗",boxDl:"╖",boxdL:"╕",boxdl:"┐",boxDR:"╔",boxDr:"╓",boxdR:"╒",boxdr:"┌",boxH:"═",boxh:"─",boxHD:"╦",boxHd:"╤",boxhD:"╥",boxhd:"┬",boxHU:"╩",boxHu:"╧",boxhU:"╨",boxhu:"┴",boxminus:"⊟",boxplus:"⊞",boxtimes:"⊠",boxUL:"╝",boxUl:"╜",boxuL:"╛",boxul:"┘",boxUR:"╚",boxUr:"╙",boxuR:"╘",boxur:"└",boxV:"║",boxv:"│",boxVH:"╬",boxVh:"╫",boxvH:"╪",boxvh:"┼",boxVL:"╣",boxVl:"╢",boxvL:"╡",boxvl:"┤",boxVR:"╠",boxVr:"╟",boxvR:"╞",boxvr:"├",bprime:"‵",Breve:"˘",breve:"˘",brvbar:"¦",Bscr:"ℬ",bscr:"𝒷",bsemi:"⁏",bsim:"∽",bsime:"⋍",bsol:"\\",bsolb:"⧅",bsolhsub:"⟈",bull:"•",bullet:"•",bump:"≎",bumpE:"⪮",bumpe:"≏",Bumpeq:"≎",bumpeq:"≏",Cacute:"Ć",cacute:"ć",Cap:"⋒",cap:"∩",capand:"⩄",capbrcup:"⩉",capcap:"⩋",capcup:"⩇",capdot:"⩀",CapitalDifferentialD:"ⅅ",caps:"∩︀",caret:"⁁",caron:"ˇ",Cayleys:"ℭ",ccaps:"⩍",Ccaron:"Č",ccaron:"č",Ccedil:"Ç",ccedil:"ç",Ccirc:"Ĉ",ccirc:"ĉ",Cconint:"∰",ccups:"⩌",ccupssm:"⩐",Cdot:"Ċ",cdot:"ċ",cedil:"¸",Cedilla:"¸",cemptyv:"⦲",cent:"¢",CenterDot:"·",centerdot:"·",Cfr:"ℭ",cfr:"𝔠",CHcy:"Ч",chcy:"ч",check:"✓",checkmark:"✓",Chi:"Χ",chi:"χ",cir:"○",circ:"ˆ",circeq:"≗",circlearrowleft:"↺",circlearrowright:"↻",circledast:"⊛",circledcirc:"⊚",circleddash:"⊝",CircleDot:"⊙",circledR:"®",circledS:"Ⓢ",CircleMinus:"⊖",CirclePlus:"⊕",CircleTimes:"⊗",cirE:"⧃",cire:"≗",cirfnint:"⨐",cirmid:"⫯",cirscir:"⧂",ClockwiseContourIntegral:"∲",CloseCurlyDoubleQuote:"”",CloseCurlyQuote:"’",clubs:"♣",clubsuit:"♣",Colon:"∷",colon:":",Colone:"⩴",colone:"≔",coloneq:"≔",comma:",",commat:"@",comp:"∁",compfn:"∘",complement:"∁",complexes:"ℂ",cong:"≅",congdot:"⩭",Congruent:"≡",Conint:"∯",conint:"∮",ContourIntegral:"∮",Copf:"ℂ",copf:"𝕔",coprod:"∐",Coproduct:"∐",COPY:"©",copy:"©",copysr:"℗",CounterClockwiseContourIntegral:"∳",crarr:"↵",Cross:"⨯",cross:"✗",Cscr:"𝒞",cscr:"𝒸",csub:"⫏",csube:"⫑",csup:"⫐",csupe:"⫒",ctdot:"⋯",cudarrl:"⤸",cudarrr:"⤵",cuepr:"⋞",cuesc:"⋟",cularr:"↶",cularrp:"⤽",Cup:"⋓",cup:"∪",cupbrcap:"⩈",CupCap:"≍",cupcap:"⩆",cupcup:"⩊",cupdot:"⊍",cupor:"⩅",cups:"∪︀",curarr:"↷",curarrm:"⤼",curlyeqprec:"⋞",curlyeqsucc:"⋟",curlyvee:"⋎",curlywedge:"⋏",curren:"¤",curvearrowleft:"↶",curvearrowright:"↷",cuvee:"⋎",cuwed:"⋏",cwconint:"∲",cwint:"∱",cylcty:"⌭",Dagger:"‡",dagger:"†",daleth:"ℸ",Darr:"↡",dArr:"⇓",darr:"↓",dash:"‐",Dashv:"⫤",dashv:"⊣",dbkarow:"⤏",dblac:"˝",Dcaron:"Ď",dcaron:"ď",Dcy:"Д",dcy:"д",DD:"ⅅ",dd:"ⅆ",ddagger:"‡",ddarr:"⇊",DDotrahd:"⤑",ddotseq:"⩷",deg:"°",Del:"∇",Delta:"Δ",delta:"δ",demptyv:"⦱",dfisht:"⥿",Dfr:"𝔇",dfr:"𝔡",dHar:"⥥",dharl:"⇃",dharr:"⇂",DiacriticalAcute:"´",DiacriticalDot:"˙",DiacriticalDoubleAcute:"˝",DiacriticalGrave:"`",DiacriticalTilde:"˜",diam:"⋄",Diamond:"⋄",diamond:"⋄",diamondsuit:"♦",diams:"♦",die:"¨",DifferentialD:"ⅆ",digamma:"ϝ",disin:"⋲",div:"÷",divide:"÷",divideontimes:"⋇",divonx:"⋇",DJcy:"Ђ",djcy:"ђ",dlcorn:"⌞",dlcrop:"⌍",dollar:"$",Dopf:"𝔻",dopf:"𝕕",Dot:"¨",dot:"˙",DotDot:"⃜",doteq:"≐",doteqdot:"≑",DotEqual:"≐",dotminus:"∸",dotplus:"∔",dotsquare:"⊡",doublebarwedge:"⌆",DoubleContourIntegral:"∯",DoubleDot:"¨",DoubleDownArrow:"⇓",DoubleLeftArrow:"⇐",DoubleLeftRightArrow:"⇔",DoubleLeftTee:"⫤",DoubleLongLeftArrow:"⟸",DoubleLongLeftRightArrow:"⟺",DoubleLongRightArrow:"⟹",DoubleRightArrow:"⇒",DoubleRightTee:"⊨",DoubleUpArrow:"⇑",DoubleUpDownArrow:"⇕",DoubleVerticalBar:"∥",DownArrow:"↓",Downarrow:"⇓",downarrow:"↓",DownArrowBar:"⤓",DownArrowUpArrow:"⇵",DownBreve:"̑",downdownarrows:"⇊",downharpoonleft:"⇃",downharpoonright:"⇂",DownLeftRightVector:"⥐",DownLeftTeeVector:"⥞",DownLeftVector:"↽",DownLeftVectorBar:"⥖",DownRightTeeVector:"⥟",DownRightVector:"⇁",DownRightVectorBar:"⥗",DownTee:"⊤",DownTeeArrow:"↧",drbkarow:"⤐",drcorn:"⌟",drcrop:"⌌",Dscr:"𝒟",dscr:"𝒹",DScy:"Ѕ",dscy:"ѕ",dsol:"⧶",Dstrok:"Đ",dstrok:"đ",dtdot:"⋱",dtri:"▿",dtrif:"▾",duarr:"⇵",duhar:"⥯",dwangle:"⦦",DZcy:"Џ",dzcy:"џ",dzigrarr:"⟿",Eacute:"É",eacute:"é",easter:"⩮",Ecaron:"Ě",ecaron:"ě",ecir:"≖",Ecirc:"Ê",ecirc:"ê",ecolon:"≕",Ecy:"Э",ecy:"э",eDDot:"⩷",Edot:"Ė",eDot:"≑",edot:"ė",ee:"ⅇ",efDot:"≒",Efr:"𝔈",efr:"𝔢",eg:"⪚",Egrave:"È",egrave:"è",egs:"⪖",egsdot:"⪘",el:"⪙",Element:"∈",elinters:"⏧",ell:"ℓ",els:"⪕",elsdot:"⪗",Emacr:"Ē",emacr:"ē",empty:"∅",emptyset:"∅",EmptySmallSquare:"◻",emptyv:"∅",EmptyVerySmallSquare:"▫",emsp:" ",emsp13:" ",emsp14:" ",ENG:"Ŋ",eng:"ŋ",ensp:" ",Eogon:"Ę",eogon:"ę",Eopf:"𝔼",eopf:"𝕖",epar:"⋕",eparsl:"⧣",eplus:"⩱",epsi:"ε",Epsilon:"Ε",epsilon:"ε",epsiv:"ϵ",eqcirc:"≖",eqcolon:"≕",eqsim:"≂",eqslantgtr:"⪖",eqslantless:"⪕",Equal:"⩵",equals:"=",EqualTilde:"≂",equest:"≟",Equilibrium:"⇌",equiv:"≡",equivDD:"⩸",eqvparsl:"⧥",erarr:"⥱",erDot:"≓",Escr:"ℰ",escr:"ℯ",esdot:"≐",Esim:"⩳",esim:"≂",Eta:"Η",eta:"η",ETH:"Ð",eth:"ð",Euml:"Ë",euml:"ë",euro:"€",excl:"!",exist:"∃",Exists:"∃",expectation:"ℰ",ExponentialE:"ⅇ",exponentiale:"ⅇ",fallingdotseq:"≒",Fcy:"Ф",fcy:"ф",female:"♀",ffilig:"ﬃ",fflig:"ﬀ",ffllig:"ﬄ",Ffr:"𝔉",ffr:"𝔣",filig:"ﬁ",FilledSmallSquare:"◼",FilledVerySmallSquare:"▪",fjlig:"fj",flat:"♭",fllig:"ﬂ",fltns:"▱",fnof:"ƒ",Fopf:"𝔽",fopf:"𝕗",ForAll:"∀",forall:"∀",fork:"⋔",forkv:"⫙",Fouriertrf:"ℱ",fpartint:"⨍",frac12:"½",frac13:"⅓",frac14:"¼",frac15:"⅕",frac16:"⅙",frac18:"⅛",frac23:"⅔",frac25:"⅖",frac34:"¾",frac35:"⅗",frac38:"⅜",frac45:"⅘",frac56:"⅚",frac58:"⅝",frac78:"⅞",frasl:"⁄",frown:"⌢",Fscr:"ℱ",fscr:"𝒻",gacute:"ǵ",Gamma:"Γ",gamma:"γ",Gammad:"Ϝ",gammad:"ϝ",gap:"⪆",Gbreve:"Ğ",gbreve:"ğ",Gcedil:"Ģ",Gcirc:"Ĝ",gcirc:"ĝ",Gcy:"Г",gcy:"г",Gdot:"Ġ",gdot:"ġ",gE:"≧",ge:"≥",gEl:"⪌",gel:"⋛",geq:"≥",geqq:"≧",geqslant:"⩾",ges:"⩾",gescc:"⪩",gesdot:"⪀",gesdoto:"⪂",gesdotol:"⪄",gesl:"⋛︀",gesles:"⪔",Gfr:"𝔊",gfr:"𝔤",Gg:"⋙",gg:"≫",ggg:"⋙",gimel:"ℷ",GJcy:"Ѓ",gjcy:"ѓ",gl:"≷",gla:"⪥",glE:"⪒",glj:"⪤",gnap:"⪊",gnapprox:"⪊",gnE:"≩",gne:"⪈",gneq:"⪈",gneqq:"≩",gnsim:"⋧",Gopf:"𝔾",gopf:"𝕘",grave:"`",GreaterEqual:"≥",GreaterEqualLess:"⋛",GreaterFullEqual:"≧",GreaterGreater:"⪢",GreaterLess:"≷",GreaterSlantEqual:"⩾",GreaterTilde:"≳",Gscr:"𝒢",gscr:"ℊ",gsim:"≳",gsime:"⪎",gsiml:"⪐",Gt:"≫",GT:">",gt:">",gtcc:"⪧",gtcir:"⩺",gtdot:"⋗",gtlPar:"⦕",gtquest:"⩼",gtrapprox:"⪆",gtrarr:"⥸",gtrdot:"⋗",gtreqless:"⋛",gtreqqless:"⪌",gtrless:"≷",gtrsim:"≳",gvertneqq:"≩︀",gvnE:"≩︀",Hacek:"ˇ",hairsp:" ",half:"½",hamilt:"ℋ",HARDcy:"Ъ",hardcy:"ъ",hArr:"⇔",harr:"↔",harrcir:"⥈",harrw:"↭",Hat:"^",hbar:"ℏ",Hcirc:"Ĥ",hcirc:"ĥ",hearts:"♥",heartsuit:"♥",hellip:"…",hercon:"⊹",Hfr:"ℌ",hfr:"𝔥",HilbertSpace:"ℋ",hksearow:"⤥",hkswarow:"⤦",hoarr:"⇿",homtht:"∻",hookleftarrow:"↩",hookrightarrow:"↪",Hopf:"ℍ",hopf:"𝕙",horbar:"―",HorizontalLine:"─",Hscr:"ℋ",hscr:"𝒽",hslash:"ℏ",Hstrok:"Ħ",hstrok:"ħ",HumpDownHump:"≎",HumpEqual:"≏",hybull:"⁃",hyphen:"‐",Iacute:"Í",iacute:"í",ic:"⁣",Icirc:"Î",icirc:"î",Icy:"И",icy:"и",Idot:"İ",IEcy:"Е",iecy:"е",iexcl:"¡",iff:"⇔",Ifr:"ℑ",ifr:"𝔦",Igrave:"Ì",igrave:"ì",ii:"ⅈ",iiiint:"⨌",iiint:"∭",iinfin:"⧜",iiota:"℩",IJlig:"Ĳ",ijlig:"ĳ",Im:"ℑ",Imacr:"Ī",imacr:"ī",image:"ℑ",ImaginaryI:"ⅈ",imagline:"ℐ",imagpart:"ℑ",imath:"ı",imof:"⊷",imped:"Ƶ",Implies:"⇒",in:"∈",incare:"℅",infin:"∞",infintie:"⧝",inodot:"ı",Int:"∬",int:"∫",intcal:"⊺",integers:"ℤ",Integral:"∫",intercal:"⊺",Intersection:"⋂",intlarhk:"⨗",intprod:"⨼",InvisibleComma:"⁣",InvisibleTimes:"⁢",IOcy:"Ё",iocy:"ё",Iogon:"Į",iogon:"į",Iopf:"𝕀",iopf:"𝕚",Iota:"Ι",iota:"ι",iprod:"⨼",iquest:"¿",Iscr:"ℐ",iscr:"𝒾",isin:"∈",isindot:"⋵",isinE:"⋹",isins:"⋴",isinsv:"⋳",isinv:"∈",it:"⁢",Itilde:"Ĩ",itilde:"ĩ",Iukcy:"І",iukcy:"і",Iuml:"Ï",iuml:"ï",Jcirc:"Ĵ",jcirc:"ĵ",Jcy:"Й",jcy:"й",Jfr:"𝔍",jfr:"𝔧",jmath:"ȷ",Jopf:"𝕁",jopf:"𝕛",Jscr:"𝒥",jscr:"𝒿",Jsercy:"Ј",jsercy:"ј",Jukcy:"Є",jukcy:"є",Kappa:"Κ",kappa:"κ",kappav:"ϰ",Kcedil:"Ķ",kcedil:"ķ",Kcy:"К",kcy:"к",Kfr:"𝔎",kfr:"𝔨",kgreen:"ĸ",KHcy:"Х",khcy:"х",KJcy:"Ќ",kjcy:"ќ",Kopf:"𝕂",kopf:"𝕜",Kscr:"𝒦",kscr:"𝓀",lAarr:"⇚",Lacute:"Ĺ",lacute:"ĺ",laemptyv:"⦴",lagran:"ℒ",Lambda:"Λ",lambda:"λ",Lang:"⟪",lang:"⟨",langd:"⦑",langle:"⟨",lap:"⪅",Laplacetrf:"ℒ",laquo:"«",Larr:"↞",lArr:"⇐",larr:"←",larrb:"⇤",larrbfs:"⤟",larrfs:"⤝",larrhk:"↩",larrlp:"↫",larrpl:"⤹",larrsim:"⥳",larrtl:"↢",lat:"⪫",lAtail:"⤛",latail:"⤙",late:"⪭",lates:"⪭︀",lBarr:"⤎",lbarr:"⤌",lbbrk:"❲",lbrace:"{",lbrack:"[",lbrke:"⦋",lbrksld:"⦏",lbrkslu:"⦍",Lcaron:"Ľ",lcaron:"ľ",Lcedil:"Ļ",lcedil:"ļ",lceil:"⌈",lcub:"{",Lcy:"Л",lcy:"л",ldca:"⤶",ldquo:"“",ldquor:"„",ldrdhar:"⥧",ldrushar:"⥋",ldsh:"↲",lE:"≦",le:"≤",LeftAngleBracket:"⟨",LeftArrow:"←",Leftarrow:"⇐",leftarrow:"←",LeftArrowBar:"⇤",LeftArrowRightArrow:"⇆",leftarrowtail:"↢",LeftCeiling:"⌈",LeftDoubleBracket:"⟦",LeftDownTeeVector:"⥡",LeftDownVector:"⇃",LeftDownVectorBar:"⥙",LeftFloor:"⌊",leftharpoondown:"↽",leftharpoonup:"↼",leftleftarrows:"⇇",LeftRightArrow:"↔",Leftrightarrow:"⇔",leftrightarrow:"↔",leftrightarrows:"⇆",leftrightharpoons:"⇋",leftrightsquigarrow:"↭",LeftRightVector:"⥎",LeftTee:"⊣",LeftTeeArrow:"↤",LeftTeeVector:"⥚",leftthreetimes:"⋋",LeftTriangle:"⊲",LeftTriangleBar:"⧏",LeftTriangleEqual:"⊴",LeftUpDownVector:"⥑",LeftUpTeeVector:"⥠",LeftUpVector:"↿",LeftUpVectorBar:"⥘",LeftVector:"↼",LeftVectorBar:"⥒",lEg:"⪋",leg:"⋚",leq:"≤",leqq:"≦",leqslant:"⩽",les:"⩽",lescc:"⪨",lesdot:"⩿",lesdoto:"⪁",lesdotor:"⪃",lesg:"⋚︀",lesges:"⪓",lessapprox:"⪅",lessdot:"⋖",lesseqgtr:"⋚",lesseqqgtr:"⪋",LessEqualGreater:"⋚",LessFullEqual:"≦",LessGreater:"≶",lessgtr:"≶",LessLess:"⪡",lesssim:"≲",LessSlantEqual:"⩽",LessTilde:"≲",lfisht:"⥼",lfloor:"⌊",Lfr:"𝔏",lfr:"𝔩",lg:"≶",lgE:"⪑",lHar:"⥢",lhard:"↽",lharu:"↼",lharul:"⥪",lhblk:"▄",LJcy:"Љ",ljcy:"љ",Ll:"⋘",ll:"≪",llarr:"⇇",llcorner:"⌞",Lleftarrow:"⇚",llhard:"⥫",lltri:"◺",Lmidot:"Ŀ",lmidot:"ŀ",lmoust:"⎰",lmoustache:"⎰",lnap:"⪉",lnapprox:"⪉",lnE:"≨",lne:"⪇",lneq:"⪇",lneqq:"≨",lnsim:"⋦",loang:"⟬",loarr:"⇽",lobrk:"⟦",LongLeftArrow:"⟵",Longleftarrow:"⟸",longleftarrow:"⟵",LongLeftRightArrow:"⟷",Longleftrightarrow:"⟺",longleftrightarrow:"⟷",longmapsto:"⟼",LongRightArrow:"⟶",Longrightarrow:"⟹",longrightarrow:"⟶",looparrowleft:"↫",looparrowright:"↬",lopar:"⦅",Lopf:"𝕃",lopf:"𝕝",loplus:"⨭",lotimes:"⨴",lowast:"∗",lowbar:"_",LowerLeftArrow:"↙",LowerRightArrow:"↘",loz:"◊",lozenge:"◊",lozf:"⧫",lpar:"(",lparlt:"⦓",lrarr:"⇆",lrcorner:"⌟",lrhar:"⇋",lrhard:"⥭",lrm:"‎",lrtri:"⊿",lsaquo:"‹",Lscr:"ℒ",lscr:"𝓁",Lsh:"↰",lsh:"↰",lsim:"≲",lsime:"⪍",lsimg:"⪏",lsqb:"[",lsquo:"‘",lsquor:"‚",Lstrok:"Ł",lstrok:"ł",Lt:"≪",LT:"<",lt:"<",ltcc:"⪦",ltcir:"⩹",ltdot:"⋖",lthree:"⋋",ltimes:"⋉",ltlarr:"⥶",ltquest:"⩻",ltri:"◃",ltrie:"⊴",ltrif:"◂",ltrPar:"⦖",lurdshar:"⥊",luruhar:"⥦",lvertneqq:"≨︀",lvnE:"≨︀",macr:"¯",male:"♂",malt:"✠",maltese:"✠",Map:"⤅",map:"↦",mapsto:"↦",mapstodown:"↧",mapstoleft:"↤",mapstoup:"↥",marker:"▮",mcomma:"⨩",Mcy:"М",mcy:"м",mdash:"—",mDDot:"∺",measuredangle:"∡",MediumSpace:" ",Mellintrf:"ℳ",Mfr:"𝔐",mfr:"𝔪",mho:"℧",micro:"µ",mid:"∣",midast:"*",midcir:"⫰",middot:"·",minus:"−",minusb:"⊟",minusd:"∸",minusdu:"⨪",MinusPlus:"∓",mlcp:"⫛",mldr:"…",mnplus:"∓",models:"⊧",Mopf:"𝕄",mopf:"𝕞",mp:"∓",Mscr:"ℳ",mscr:"𝓂",mstpos:"∾",Mu:"Μ",mu:"μ",multimap:"⊸",mumap:"⊸",nabla:"∇",Nacute:"Ń",nacute:"ń",nang:"∠⃒",nap:"≉",napE:"⩰̸",napid:"≋̸",napos:"ŉ",napprox:"≉",natur:"♮",natural:"♮",naturals:"ℕ",nbsp:" ",nbump:"≎̸",nbumpe:"≏̸",ncap:"⩃",Ncaron:"Ň",ncaron:"ň",Ncedil:"Ņ",ncedil:"ņ",ncong:"≇",ncongdot:"⩭̸",ncup:"⩂",Ncy:"Н",ncy:"н",ndash:"–",ne:"≠",nearhk:"⤤",neArr:"⇗",nearr:"↗",nearrow:"↗",nedot:"≐̸",NegativeMediumSpace:"​",NegativeThickSpace:"​",NegativeThinSpace:"​",NegativeVeryThinSpace:"​",nequiv:"≢",nesear:"⤨",nesim:"≂̸",NestedGreaterGreater:"≫",NestedLessLess:"≪",NewLine:"\n",nexist:"∄",nexists:"∄",Nfr:"𝔑",nfr:"𝔫",ngE:"≧̸",nge:"≱",ngeq:"≱",ngeqq:"≧̸",ngeqslant:"⩾̸",nges:"⩾̸",nGg:"⋙̸",ngsim:"≵",nGt:"≫⃒",ngt:"≯",ngtr:"≯",nGtv:"≫̸",nhArr:"⇎",nharr:"↮",nhpar:"⫲",ni:"∋",nis:"⋼",nisd:"⋺",niv:"∋",NJcy:"Њ",njcy:"њ",nlArr:"⇍",nlarr:"↚",nldr:"‥",nlE:"≦̸",nle:"≰",nLeftarrow:"⇍",nleftarrow:"↚",nLeftrightarrow:"⇎",nleftrightarrow:"↮",nleq:"≰",nleqq:"≦̸",nleqslant:"⩽̸",nles:"⩽̸",nless:"≮",nLl:"⋘̸",nlsim:"≴",nLt:"≪⃒",nlt:"≮",nltri:"⋪",nltrie:"⋬",nLtv:"≪̸",nmid:"∤",NoBreak:"⁠",NonBreakingSpace:" ",Nopf:"ℕ",nopf:"𝕟",Not:"⫬",not:"¬",NotCongruent:"≢",NotCupCap:"≭",NotDoubleVerticalBar:"∦",NotElement:"∉",NotEqual:"≠",NotEqualTilde:"≂̸",NotExists:"∄",NotGreater:"≯",NotGreaterEqual:"≱",NotGreaterFullEqual:"≧̸",NotGreaterGreater:"≫̸",NotGreaterLess:"≹",NotGreaterSlantEqual:"⩾̸",NotGreaterTilde:"≵",NotHumpDownHump:"≎̸",NotHumpEqual:"≏̸",notin:"∉",notindot:"⋵̸",notinE:"⋹̸",notinva:"∉",notinvb:"⋷",notinvc:"⋶",NotLeftTriangle:"⋪",NotLeftTriangleBar:"⧏̸",NotLeftTriangleEqual:"⋬",NotLess:"≮",NotLessEqual:"≰",NotLessGreater:"≸",NotLessLess:"≪̸",NotLessSlantEqual:"⩽̸",NotLessTilde:"≴",NotNestedGreaterGreater:"⪢̸",NotNestedLessLess:"⪡̸",notni:"∌",notniva:"∌",notnivb:"⋾",notnivc:"⋽",NotPrecedes:"⊀",NotPrecedesEqual:"⪯̸",NotPrecedesSlantEqual:"⋠",NotReverseElement:"∌",NotRightTriangle:"⋫",NotRightTriangleBar:"⧐̸",NotRightTriangleEqual:"⋭",NotSquareSubset:"⊏̸",NotSquareSubsetEqual:"⋢",NotSquareSuperset:"⊐̸",NotSquareSupersetEqual:"⋣",NotSubset:"⊂⃒",NotSubsetEqual:"⊈",NotSucceeds:"⊁",NotSucceedsEqual:"⪰̸",NotSucceedsSlantEqual:"⋡",NotSucceedsTilde:"≿̸",NotSuperset:"⊃⃒",NotSupersetEqual:"⊉",NotTilde:"≁",NotTildeEqual:"≄",NotTildeFullEqual:"≇",NotTildeTilde:"≉",NotVerticalBar:"∤",npar:"∦",nparallel:"∦",nparsl:"⫽⃥",npart:"∂̸",npolint:"⨔",npr:"⊀",nprcue:"⋠",npre:"⪯̸",nprec:"⊀",npreceq:"⪯̸",nrArr:"⇏",nrarr:"↛",nrarrc:"⤳̸",nrarrw:"↝̸",nRightarrow:"⇏",nrightarrow:"↛",nrtri:"⋫",nrtrie:"⋭",nsc:"⊁",nsccue:"⋡",nsce:"⪰̸",Nscr:"𝒩",nscr:"𝓃",nshortmid:"∤",nshortparallel:"∦",nsim:"≁",nsime:"≄",nsimeq:"≄",nsmid:"∤",nspar:"∦",nsqsube:"⋢",nsqsupe:"⋣",nsub:"⊄",nsubE:"⫅̸",nsube:"⊈",nsubset:"⊂⃒",nsubseteq:"⊈",nsubseteqq:"⫅̸",nsucc:"⊁",nsucceq:"⪰̸",nsup:"⊅",nsupE:"⫆̸",nsupe:"⊉",nsupset:"⊃⃒",nsupseteq:"⊉",nsupseteqq:"⫆̸",ntgl:"≹",Ntilde:"Ñ",ntilde:"ñ",ntlg:"≸",ntriangleleft:"⋪",ntrianglelefteq:"⋬",ntriangleright:"⋫",ntrianglerighteq:"⋭",Nu:"Ν",nu:"ν",num:"#",numero:"№",numsp:" ",nvap:"≍⃒",nVDash:"⊯",nVdash:"⊮",nvDash:"⊭",nvdash:"⊬",nvge:"≥⃒",nvgt:">⃒",nvHarr:"⤄",nvinfin:"⧞",nvlArr:"⤂",nvle:"≤⃒",nvlt:"<⃒",nvltrie:"⊴⃒",nvrArr:"⤃",nvrtrie:"⊵⃒",nvsim:"∼⃒",nwarhk:"⤣",nwArr:"⇖",nwarr:"↖",nwarrow:"↖",nwnear:"⤧",Oacute:"Ó",oacute:"ó",oast:"⊛",ocir:"⊚",Ocirc:"Ô",ocirc:"ô",Ocy:"О",ocy:"о",odash:"⊝",Odblac:"Ő",odblac:"ő",odiv:"⨸",odot:"⊙",odsold:"⦼",OElig:"Œ",oelig:"œ",ofcir:"⦿",Ofr:"𝔒",ofr:"𝔬",ogon:"˛",Ograve:"Ò",ograve:"ò",ogt:"⧁",ohbar:"⦵",ohm:"Ω",oint:"∮",olarr:"↺",olcir:"⦾",olcross:"⦻",oline:"‾",olt:"⧀",Omacr:"Ō",omacr:"ō",Omega:"Ω",omega:"ω",Omicron:"Ο",omicron:"ο",omid:"⦶",ominus:"⊖",Oopf:"𝕆",oopf:"𝕠",opar:"⦷",OpenCurlyDoubleQuote:"“",OpenCurlyQuote:"‘",operp:"⦹",oplus:"⊕",Or:"⩔",or:"∨",orarr:"↻",ord:"⩝",order:"ℴ",orderof:"ℴ",ordf:"ª",ordm:"º",origof:"⊶",oror:"⩖",orslope:"⩗",orv:"⩛",oS:"Ⓢ",Oscr:"𝒪",oscr:"ℴ",Oslash:"Ø",oslash:"ø",osol:"⊘",Otilde:"Õ",otilde:"õ",Otimes:"⨷",otimes:"⊗",otimesas:"⨶",Ouml:"Ö",ouml:"ö",ovbar:"⌽",OverBar:"‾",OverBrace:"⏞",OverBracket:"⎴",OverParenthesis:"⏜",par:"∥",para:"¶",parallel:"∥",parsim:"⫳",parsl:"⫽",part:"∂",PartialD:"∂",Pcy:"П",pcy:"п",percnt:"%",period:".",permil:"‰",perp:"⊥",pertenk:"‱",Pfr:"𝔓",pfr:"𝔭",Phi:"Φ",phi:"φ",phiv:"ϕ",phmmat:"ℳ",phone:"☎",Pi:"Π",pi:"π",pitchfork:"⋔",piv:"ϖ",planck:"ℏ",planckh:"ℎ",plankv:"ℏ",plus:"+",plusacir:"⨣",plusb:"⊞",pluscir:"⨢",plusdo:"∔",plusdu:"⨥",pluse:"⩲",PlusMinus:"±",plusmn:"±",plussim:"⨦",plustwo:"⨧",pm:"±",Poincareplane:"ℌ",pointint:"⨕",Popf:"ℙ",popf:"𝕡",pound:"£",Pr:"⪻",pr:"≺",prap:"⪷",prcue:"≼",prE:"⪳",pre:"⪯",prec:"≺",precapprox:"⪷",preccurlyeq:"≼",Precedes:"≺",PrecedesEqual:"⪯",PrecedesSlantEqual:"≼",PrecedesTilde:"≾",preceq:"⪯",precnapprox:"⪹",precneqq:"⪵",precnsim:"⋨",precsim:"≾",Prime:"″",prime:"′",primes:"ℙ",prnap:"⪹",prnE:"⪵",prnsim:"⋨",prod:"∏",Product:"∏",profalar:"⌮",profline:"⌒",profsurf:"⌓",prop:"∝",Proportion:"∷",Proportional:"∝",propto:"∝",prsim:"≾",prurel:"⊰",Pscr:"𝒫",pscr:"𝓅",Psi:"Ψ",psi:"ψ",puncsp:" ",Qfr:"𝔔",qfr:"𝔮",qint:"⨌",Qopf:"ℚ",qopf:"𝕢",qprime:"⁗",Qscr:"𝒬",qscr:"𝓆",quaternions:"ℍ",quatint:"⨖",quest:"?",questeq:"≟",QUOT:'"',quot:'"',rAarr:"⇛",race:"∽̱",Racute:"Ŕ",racute:"ŕ",radic:"√",raemptyv:"⦳",Rang:"⟫",rang:"⟩",rangd:"⦒",range:"⦥",rangle:"⟩",raquo:"»",Rarr:"↠",rArr:"⇒",rarr:"→",rarrap:"⥵",rarrb:"⇥",rarrbfs:"⤠",rarrc:"⤳",rarrfs:"⤞",rarrhk:"↪",rarrlp:"↬",rarrpl:"⥅",rarrsim:"⥴",Rarrtl:"⤖",rarrtl:"↣",rarrw:"↝",rAtail:"⤜",ratail:"⤚",ratio:"∶",rationals:"ℚ",RBarr:"⤐",rBarr:"⤏",rbarr:"⤍",rbbrk:"❳",rbrace:"}",rbrack:"]",rbrke:"⦌",rbrksld:"⦎",rbrkslu:"⦐",Rcaron:"Ř",rcaron:"ř",Rcedil:"Ŗ",rcedil:"ŗ",rceil:"⌉",rcub:"}",Rcy:"Р",rcy:"р",rdca:"⤷",rdldhar:"⥩",rdquo:"”",rdquor:"”",rdsh:"↳",Re:"ℜ",real:"ℜ",realine:"ℛ",realpart:"ℜ",reals:"ℝ",rect:"▭",REG:"®",reg:"®",ReverseElement:"∋",ReverseEquilibrium:"⇋",ReverseUpEquilibrium:"⥯",rfisht:"⥽",rfloor:"⌋",Rfr:"ℜ",rfr:"𝔯",rHar:"⥤",rhard:"⇁",rharu:"⇀",rharul:"⥬",Rho:"Ρ",rho:"ρ",rhov:"ϱ",RightAngleBracket:"⟩",RightArrow:"→",Rightarrow:"⇒",rightarrow:"→",RightArrowBar:"⇥",RightArrowLeftArrow:"⇄",rightarrowtail:"↣",RightCeiling:"⌉",RightDoubleBracket:"⟧",RightDownTeeVector:"⥝",RightDownVector:"⇂",RightDownVectorBar:"⥕",RightFloor:"⌋",rightharpoondown:"⇁",rightharpoonup:"⇀",rightleftarrows:"⇄",rightleftharpoons:"⇌",rightrightarrows:"⇉",rightsquigarrow:"↝",RightTee:"⊢",RightTeeArrow:"↦",RightTeeVector:"⥛",rightthreetimes:"⋌",RightTriangle:"⊳",RightTriangleBar:"⧐",RightTriangleEqual:"⊵",RightUpDownVector:"⥏",RightUpTeeVector:"⥜",RightUpVector:"↾",RightUpVectorBar:"⥔",RightVector:"⇀",RightVectorBar:"⥓",ring:"˚",risingdotseq:"≓",rlarr:"⇄",rlhar:"⇌",rlm:"‏",rmoust:"⎱",rmoustache:"⎱",rnmid:"⫮",roang:"⟭",roarr:"⇾",robrk:"⟧",ropar:"⦆",Ropf:"ℝ",ropf:"𝕣",roplus:"⨮",rotimes:"⨵",RoundImplies:"⥰",rpar:")",rpargt:"⦔",rppolint:"⨒",rrarr:"⇉",Rrightarrow:"⇛",rsaquo:"›",Rscr:"ℛ",rscr:"𝓇",Rsh:"↱",rsh:"↱",rsqb:"]",rsquo:"’",rsquor:"’",rthree:"⋌",rtimes:"⋊",rtri:"▹",rtrie:"⊵",rtrif:"▸",rtriltri:"⧎",RuleDelayed:"⧴",ruluhar:"⥨",rx:"℞",Sacute:"Ś",sacute:"ś",sbquo:"‚",Sc:"⪼",sc:"≻",scap:"⪸",Scaron:"Š",scaron:"š",sccue:"≽",scE:"⪴",sce:"⪰",Scedil:"Ş",scedil:"ş",Scirc:"Ŝ",scirc:"ŝ",scnap:"⪺",scnE:"⪶",scnsim:"⋩",scpolint:"⨓",scsim:"≿",Scy:"С",scy:"с",sdot:"⋅",sdotb:"⊡",sdote:"⩦",searhk:"⤥",seArr:"⇘",searr:"↘",searrow:"↘",sect:"§",semi:";",seswar:"⤩",setminus:"∖",setmn:"∖",sext:"✶",Sfr:"𝔖",sfr:"𝔰",sfrown:"⌢",sharp:"♯",SHCHcy:"Щ",shchcy:"щ",SHcy:"Ш",shcy:"ш",ShortDownArrow:"↓",ShortLeftArrow:"←",shortmid:"∣",shortparallel:"∥",ShortRightArrow:"→",ShortUpArrow:"↑",shy:"­",Sigma:"Σ",sigma:"σ",sigmaf:"ς",sigmav:"ς",sim:"∼",simdot:"⩪",sime:"≃",simeq:"≃",simg:"⪞",simgE:"⪠",siml:"⪝",simlE:"⪟",simne:"≆",simplus:"⨤",simrarr:"⥲",slarr:"←",SmallCircle:"∘",smallsetminus:"∖",smashp:"⨳",smeparsl:"⧤",smid:"∣",smile:"⌣",smt:"⪪",smte:"⪬",smtes:"⪬︀",SOFTcy:"Ь",softcy:"ь",sol:"/",solb:"⧄",solbar:"⌿",Sopf:"𝕊",sopf:"𝕤",spades:"♠",spadesuit:"♠",spar:"∥",sqcap:"⊓",sqcaps:"⊓︀",sqcup:"⊔",sqcups:"⊔︀",Sqrt:"√",sqsub:"⊏",sqsube:"⊑",sqsubset:"⊏",sqsubseteq:"⊑",sqsup:"⊐",sqsupe:"⊒",sqsupset:"⊐",sqsupseteq:"⊒",squ:"□",Square:"□",square:"□",SquareIntersection:"⊓",SquareSubset:"⊏",SquareSubsetEqual:"⊑",SquareSuperset:"⊐",SquareSupersetEqual:"⊒",SquareUnion:"⊔",squarf:"▪",squf:"▪",srarr:"→",Sscr:"𝒮",sscr:"𝓈",ssetmn:"∖",ssmile:"⌣",sstarf:"⋆",Star:"⋆",star:"☆",starf:"★",straightepsilon:"ϵ",straightphi:"ϕ",strns:"¯",Sub:"⋐",sub:"⊂",subdot:"⪽",subE:"⫅",sube:"⊆",subedot:"⫃",submult:"⫁",subnE:"⫋",subne:"⊊",subplus:"⪿",subrarr:"⥹",Subset:"⋐",subset:"⊂",subseteq:"⊆",subseteqq:"⫅",SubsetEqual:"⊆",subsetneq:"⊊",subsetneqq:"⫋",subsim:"⫇",subsub:"⫕",subsup:"⫓",succ:"≻",succapprox:"⪸",succcurlyeq:"≽",Succeeds:"≻",SucceedsEqual:"⪰",SucceedsSlantEqual:"≽",SucceedsTilde:"≿",succeq:"⪰",succnapprox:"⪺",succneqq:"⪶",succnsim:"⋩",succsim:"≿",SuchThat:"∋",Sum:"∑",sum:"∑",sung:"♪",Sup:"⋑",sup:"⊃",sup1:"¹",sup2:"²",sup3:"³",supdot:"⪾",supdsub:"⫘",supE:"⫆",supe:"⊇",supedot:"⫄",Superset:"⊃",SupersetEqual:"⊇",suphsol:"⟉",suphsub:"⫗",suplarr:"⥻",supmult:"⫂",supnE:"⫌",supne:"⊋",supplus:"⫀",Supset:"⋑",supset:"⊃",supseteq:"⊇",supseteqq:"⫆",supsetneq:"⊋",supsetneqq:"⫌",supsim:"⫈",supsub:"⫔",supsup:"⫖",swarhk:"⤦",swArr:"⇙",swarr:"↙",swarrow:"↙",swnwar:"⤪",szlig:"ß",Tab:"\t",target:"⌖",Tau:"Τ",tau:"τ",tbrk:"⎴",Tcaron:"Ť",tcaron:"ť",Tcedil:"Ţ",tcedil:"ţ",Tcy:"Т",tcy:"т",tdot:"⃛",telrec:"⌕",Tfr:"𝔗",tfr:"𝔱",there4:"∴",Therefore:"∴",therefore:"∴",Theta:"Θ",theta:"θ",thetasym:"ϑ",thetav:"ϑ",thickapprox:"≈",thicksim:"∼",ThickSpace:"  ",thinsp:" ",ThinSpace:" ",thkap:"≈",thksim:"∼",THORN:"Þ",thorn:"þ",Tilde:"∼",tilde:"˜",TildeEqual:"≃",TildeFullEqual:"≅",TildeTilde:"≈",times:"×",timesb:"⊠",timesbar:"⨱",timesd:"⨰",tint:"∭",toea:"⤨",top:"⊤",topbot:"⌶",topcir:"⫱",Topf:"𝕋",topf:"𝕥",topfork:"⫚",tosa:"⤩",tprime:"‴",TRADE:"™",trade:"™",triangle:"▵",triangledown:"▿",triangleleft:"◃",trianglelefteq:"⊴",triangleq:"≜",triangleright:"▹",trianglerighteq:"⊵",tridot:"◬",trie:"≜",triminus:"⨺",TripleDot:"⃛",triplus:"⨹",trisb:"⧍",tritime:"⨻",trpezium:"⏢",Tscr:"𝒯",tscr:"𝓉",TScy:"Ц",tscy:"ц",TSHcy:"Ћ",tshcy:"ћ",Tstrok:"Ŧ",tstrok:"ŧ",twixt:"≬",twoheadleftarrow:"↞",twoheadrightarrow:"↠",Uacute:"Ú",uacute:"ú",Uarr:"↟",uArr:"⇑",uarr:"↑",Uarrocir:"⥉",Ubrcy:"Ў",ubrcy:"ў",Ubreve:"Ŭ",ubreve:"ŭ",Ucirc:"Û",ucirc:"û",Ucy:"У",ucy:"у",udarr:"⇅",Udblac:"Ű",udblac:"ű",udhar:"⥮",ufisht:"⥾",Ufr:"𝔘",ufr:"𝔲",Ugrave:"Ù",ugrave:"ù",uHar:"⥣",uharl:"↿",uharr:"↾",uhblk:"▀",ulcorn:"⌜",ulcorner:"⌜",ulcrop:"⌏",ultri:"◸",Umacr:"Ū",umacr:"ū",uml:"¨",UnderBar:"_",UnderBrace:"⏟",UnderBracket:"⎵",UnderParenthesis:"⏝",Union:"⋃",UnionPlus:"⊎",Uogon:"Ų",uogon:"ų",Uopf:"𝕌",uopf:"𝕦",UpArrow:"↑",Uparrow:"⇑",uparrow:"↑",UpArrowBar:"⤒",UpArrowDownArrow:"⇅",UpDownArrow:"↕",Updownarrow:"⇕",updownarrow:"↕",UpEquilibrium:"⥮",upharpoonleft:"↿",upharpoonright:"↾",uplus:"⊎",UpperLeftArrow:"↖",UpperRightArrow:"↗",Upsi:"ϒ",upsi:"υ",upsih:"ϒ",Upsilon:"Υ",upsilon:"υ",UpTee:"⊥",UpTeeArrow:"↥",upuparrows:"⇈",urcorn:"⌝",urcorner:"⌝",urcrop:"⌎",Uring:"Ů",uring:"ů",urtri:"◹",Uscr:"𝒰",uscr:"𝓊",utdot:"⋰",Utilde:"Ũ",utilde:"ũ",utri:"▵",utrif:"▴",uuarr:"⇈",Uuml:"Ü",uuml:"ü",uwangle:"⦧",vangrt:"⦜",varepsilon:"ϵ",varkappa:"ϰ",varnothing:"∅",varphi:"ϕ",varpi:"ϖ",varpropto:"∝",vArr:"⇕",varr:"↕",varrho:"ϱ",varsigma:"ς",varsubsetneq:"⊊︀",varsubsetneqq:"⫋︀",varsupsetneq:"⊋︀",varsupsetneqq:"⫌︀",vartheta:"ϑ",vartriangleleft:"⊲",vartriangleright:"⊳",Vbar:"⫫",vBar:"⫨",vBarv:"⫩",Vcy:"В",vcy:"в",VDash:"⊫",Vdash:"⊩",vDash:"⊨",vdash:"⊢",Vdashl:"⫦",Vee:"⋁",vee:"∨",veebar:"⊻",veeeq:"≚",vellip:"⋮",Verbar:"‖",verbar:"|",Vert:"‖",vert:"|",VerticalBar:"∣",VerticalLine:"|",VerticalSeparator:"❘",VerticalTilde:"≀",VeryThinSpace:" ",Vfr:"𝔙",vfr:"𝔳",vltri:"⊲",vnsub:"⊂⃒",vnsup:"⊃⃒",Vopf:"𝕍",vopf:"𝕧",vprop:"∝",vrtri:"⊳",Vscr:"𝒱",vscr:"𝓋",vsubnE:"⫋︀",vsubne:"⊊︀",vsupnE:"⫌︀",vsupne:"⊋︀",Vvdash:"⊪",vzigzag:"⦚",Wcirc:"Ŵ",wcirc:"ŵ",wedbar:"⩟",Wedge:"⋀",wedge:"∧",wedgeq:"≙",weierp:"℘",Wfr:"𝔚",wfr:"𝔴",Wopf:"𝕎",wopf:"𝕨",wp:"℘",wr:"≀",wreath:"≀",Wscr:"𝒲",wscr:"𝓌",xcap:"⋂",xcirc:"◯",xcup:"⋃",xdtri:"▽",Xfr:"𝔛",xfr:"𝔵",xhArr:"⟺",xharr:"⟷",Xi:"Ξ",xi:"ξ",xlArr:"⟸",xlarr:"⟵",xmap:"⟼",xnis:"⋻",xodot:"⨀",Xopf:"𝕏",xopf:"𝕩",xoplus:"⨁",xotime:"⨂",xrArr:"⟹",xrarr:"⟶",Xscr:"𝒳",xscr:"𝓍",xsqcup:"⨆",xuplus:"⨄",xutri:"△",xvee:"⋁",xwedge:"⋀",Yacute:"Ý",yacute:"ý",YAcy:"Я",yacy:"я",Ycirc:"Ŷ",ycirc:"ŷ",Ycy:"Ы",ycy:"ы",yen:"¥",Yfr:"𝔜",yfr:"𝔶",YIcy:"Ї",yicy:"ї",Yopf:"𝕐",yopf:"𝕪",Yscr:"𝒴",yscr:"𝓎",YUcy:"Ю",yucy:"ю",Yuml:"Ÿ",yuml:"ÿ",Zacute:"Ź",zacute:"ź",Zcaron:"Ž",zcaron:"ž",Zcy:"З",zcy:"з",Zdot:"Ż",zdot:"ż",zeetrf:"ℨ",ZeroWidthSpace:"​",Zeta:"Ζ",zeta:"ζ",Zfr:"ℨ",zfr:"𝔷",ZHcy:"Ж",zhcy:"ж",zigrarr:"⇝",Zopf:"ℤ",zopf:"𝕫",Zscr:"𝒵",zscr:"𝓏",zwj:"‍",zwnj:"‌"}),t.entityMap=t.HTML_ENTITIES},6596:(e,t,n)=>{"use strict";e.exports=n(5339)()?Object.assign:n(3595)},6628:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Underline=t.Highlight=t.Mark=t.Pane=void 0;var i=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var s=Object.getPrototypeOf(t);return null===s?void 0:e(s,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=o(n(3644)),a=o(n(2161));function o(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.Pane=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.body;u(this,e),this.target=t,this.element=s.default.createElement("svg"),this.marks=[],this.element.style.position="absolute",this.element.setAttribute("pointer-events","none"),a.default.proxyMouse(this.target,this.marks),this.container=n,this.container.appendChild(this.element),this.render()}return r(e,[{key:"addMark",value:function(e){var t=s.default.createElement("g");return this.element.appendChild(t),e.bind(t,this.container),this.marks.push(e),e.render(),e}},{key:"removeMark",value:function(e){var t=this.marks.indexOf(e);if(-1!==t){var n=e.unbind();this.element.removeChild(n),this.marks.splice(t,1)}}},{key:"render",value:function(){var e,t,n,i;!function(e,t){e.style.setProperty("top",t.top+"px","important"),e.style.setProperty("left",t.left+"px","important"),e.style.setProperty("height",t.height+"px","important"),e.style.setProperty("width",t.width+"px","important")}(this.element,(e=this.target,t=this.container,n=t.getBoundingClientRect(),i=e.getBoundingClientRect(),{top:i.top-n.top,left:i.left-n.left,height:e.scrollHeight,width:e.scrollWidth}));var r=!0,s=!1,a=void 0;try{for(var o,l=this.marks[Symbol.iterator]();!(r=(o=l.next()).done);r=!0)o.value.render()}catch(e){s=!0,a=e}finally{try{!r&&l.return&&l.return()}finally{if(s)throw a}}}}]),e}();var h=t.Mark=function(){function e(){u(this,e),this.element=null}return r(e,[{key:"bind",value:function(e,t){this.element=e,this.container=t}},{key:"unbind",value:function(){var e=this.element;return this.element=null,e}},{key:"render",value:function(){}},{key:"dispatchEvent",value:function(e){this.element&&this.element.dispatchEvent(e)}},{key:"getBoundingClientRect",value:function(){return this.element.getBoundingClientRect()}},{key:"getClientRects",value:function(){for(var e=[],t=this.element.firstChild;t;)e.push(t.getBoundingClientRect()),t=t.nextSibling;return e}},{key:"filteredRanges",value:function(){var e=Array.from(this.range.getClientRects());return e.filter(function(t){for(var n=0;n<e.length;n++){if(e[n]===t)return!0;if(f(e[n],t))return!1}return!0})}}]),e}(),d=t.Highlight=function(e){function t(e,n,i,r){u(this,t);var s=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return s.range=e,s.className=n,s.data=i||{},s.attributes=r||{},s}return c(t,e),r(t,[{key:"bind",value:function(e,n){for(var r in i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"bind",this).call(this,e,n),this.data)this.data.hasOwnProperty(r)&&(this.element.dataset[r]=this.data[r]);for(var r in this.attributes)this.attributes.hasOwnProperty(r)&&this.element.setAttribute(r,this.attributes[r]);this.className&&this.element.classList.add(this.className)}},{key:"render",value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var e=this.element.ownerDocument.createDocumentFragment(),t=this.filteredRanges(),n=this.element.getBoundingClientRect(),i=this.container.getBoundingClientRect(),r=0,a=t.length;r<a;r++){var o=t[r],l=s.default.createElement("rect");l.setAttribute("x",o.left-n.left+i.left),l.setAttribute("y",o.top-n.top+i.top),l.setAttribute("height",o.height),l.setAttribute("width",o.width),e.appendChild(l)}this.element.appendChild(e)}}]),t}(h);function f(e,t){return t.right<=e.right&&t.left>=e.left&&t.top>=e.top&&t.bottom<=e.bottom}t.Underline=function(e){function t(e,n,i,r){return u(this,t),l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,i,r))}return c(t,e),r(t,[{key:"render",value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var e=this.element.ownerDocument.createDocumentFragment(),t=this.filteredRanges(),n=this.element.getBoundingClientRect(),i=this.container.getBoundingClientRect(),r=0,a=t.length;r<a;r++){var o=t[r],l=s.default.createElement("rect");l.setAttribute("x",o.left-n.left+i.left),l.setAttribute("y",o.top-n.top+i.top),l.setAttribute("height",o.height),l.setAttribute("width",o.width),l.setAttribute("fill","none");var c=s.default.createElement("line");c.setAttribute("x1",o.left-n.left+i.left),c.setAttribute("x2",o.left-n.left+i.left+o.width),c.setAttribute("y1",o.top-n.top+i.top+o.height-1),c.setAttribute("y2",o.top-n.top+i.top+o.height-1),c.setAttribute("stroke-width",1),c.setAttribute("stroke","black"),c.setAttribute("stroke-linecap","square"),e.appendChild(l),e.appendChild(c)}this.element.appendChild(e)}}]),t}(d)},6812:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,r=n(3575),s=n(4083),a=(i=n(3068))&&i.__esModule?i:{default:i};class o{constructor(e){this.settings=e,this.name=e.layout||"reflowable",this._spread="none"!==e.spread,this._minSpreadWidth=e.minSpreadWidth||800,this._evenSpreads=e.evenSpreads||!1,"scrolled"===e.flow||"scrolled-continuous"===e.flow||"scrolled-doc"===e.flow?this._flow="scrolled":this._flow="paginated",this.width=0,this.height=0,this.spreadWidth=0,this.delta=0,this.columnWidth=0,this.gap=0,this.divisor=1,this.props={name:this.name,spread:this._spread,flow:this._flow,width:0,height:0,spreadWidth:0,delta:0,columnWidth:0,gap:0,divisor:1}}flow(e){return void 0!==e&&(this._flow="scrolled"===e||"scrolled-continuous"===e||"scrolled-doc"===e?"scrolled":"paginated",this.update({flow:this._flow})),this._flow}spread(e,t){return e&&(this._spread="none"!==e,this.update({spread:this._spread})),t>=0&&(this._minSpreadWidth=t),this._spread}calculate(e,t,n){var i,r,s,a,o,l=n||0,c=e,u=t,h=Math.floor(c/12);o=this._spread&&c>=this._minSpreadWidth?2:1,"reflowable"!==this.name||"paginated"!==this._flow||n>=0||(l=h%2==0?h:h-1),"pre-paginated"===this.name&&(l=0),o>1?s=(i=c/o-l)+l:(i=c,s=c),"pre-paginated"===this.name&&o>1&&(c=i),r=i*o+l,a=c,this.width=c,this.height=u,this.spreadWidth=r,this.pageWidth=s,this.delta=a,this.columnWidth=i,this.gap=l,this.divisor=o,this.update({width:c,height:u,spreadWidth:r,pageWidth:s,delta:a,columnWidth:i,gap:l,divisor:o})}format(e,t,n){return"pre-paginated"===this.name?e.fit(this.columnWidth,this.height,t):"paginated"===this._flow?e.columns(this.width,this.height,this.columnWidth,this.gap,this.settings.direction):n&&"horizontal"===n?e.size(null,this.height):e.size(this.width,null)}count(e,t){let n,i;return"pre-paginated"===this.name?(n=1,i=1):"paginated"===this._flow?(t=t||this.delta,n=Math.ceil(e/t),i=n*this.divisor):(t=t||this.height,n=Math.ceil(e/t),i=n),{spreads:n,pages:i}}update(e){if(Object.keys(e).forEach(t=>{this.props[t]===e[t]&&delete e[t]}),Object.keys(e).length>0){let t=(0,r.extend)(this.props,e);this.emit(s.EVENTS.LAYOUT.UPDATED,t,e)}}}(0,a.default)(o.prototype);var l=o;t.default=l},6841:e=>{"use strict";if(!t)var t={cwd:function(){return"/"}};function n(e){if("string"!=typeof e)throw new TypeError("Path must be a string. Received "+e)}function i(e,t){for(var n,i="",r=-1,s=0,a=0;a<=e.length;++a){if(a<e.length)n=e.charCodeAt(a);else{if(47===n)break;n=47}if(47===n){if(r===a-1||1===s);else if(r!==a-1&&2===s){if(i.length<2||46!==i.charCodeAt(i.length-1)||46!==i.charCodeAt(i.length-2))if(i.length>2){for(var o=i.length-1,l=o;l>=0&&47!==i.charCodeAt(l);--l);if(l!==o){i=-1===l?"":i.slice(0,l),r=a,s=0;continue}}else if(2===i.length||1===i.length){i="",r=a,s=0;continue}t&&(i.length>0?i+="/..":i="..")}else i.length>0?i+="/"+e.slice(r+1,a):i=e.slice(r+1,a);r=a,s=0}else 46===n&&-1!==s?++s:s=-1}return i}var r={resolve:function(){for(var e,r="",s=!1,a=arguments.length-1;a>=-1&&!s;a--){var o;a>=0?o=arguments[a]:(void 0===e&&(e=t.cwd()),o=e),n(o),0!==o.length&&(r=o+"/"+r,s=47===o.charCodeAt(0))}return r=i(r,!s),s?r.length>0?"/"+r:"/":r.length>0?r:"."},normalize:function(e){if(n(e),0===e.length)return".";var t=47===e.charCodeAt(0),r=47===e.charCodeAt(e.length-1);return 0!==(e=i(e,!t)).length||t||(e="."),e.length>0&&r&&(e+="/"),t?"/"+e:e},isAbsolute:function(e){return n(e),e.length>0&&47===e.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var e,t=0;t<arguments.length;++t){var i=arguments[t];n(i),i.length>0&&(void 0===e?e=i:e+="/"+i)}return void 0===e?".":r.normalize(e)},relative:function(e,t){if(n(e),n(t),e===t)return"";if((e=r.resolve(e))===(t=r.resolve(t)))return"";for(var i=1;i<e.length&&47===e.charCodeAt(i);++i);for(var s=e.length,a=s-i,o=1;o<t.length&&47===t.charCodeAt(o);++o);for(var l=t.length-o,c=a<l?a:l,u=-1,h=0;h<=c;++h){if(h===c){if(l>c){if(47===t.charCodeAt(o+h))return t.slice(o+h+1);if(0===h)return t.slice(o+h)}else a>c&&(47===e.charCodeAt(i+h)?u=h:0===h&&(u=0));break}var d=e.charCodeAt(i+h);if(d!==t.charCodeAt(o+h))break;47===d&&(u=h)}var f="";for(h=i+u+1;h<=s;++h)h!==s&&47!==e.charCodeAt(h)||(0===f.length?f+="..":f+="/..");return f.length>0?f+t.slice(o+u):(o+=u,47===t.charCodeAt(o)&&++o,t.slice(o))},_makeLong:function(e){return e},dirname:function(e){if(n(e),0===e.length)return".";for(var t=e.charCodeAt(0),i=47===t,r=-1,s=!0,a=e.length-1;a>=1;--a)if(47===(t=e.charCodeAt(a))){if(!s){r=a;break}}else s=!1;return-1===r?i?"/":".":i&&1===r?"//":e.slice(0,r)},basename:function(e,t){if(void 0!==t&&"string"!=typeof t)throw new TypeError('"ext" argument must be a string');n(e);var i,r=0,s=-1,a=!0;if(void 0!==t&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var o=t.length-1,l=-1;for(i=e.length-1;i>=0;--i){var c=e.charCodeAt(i);if(47===c){if(!a){r=i+1;break}}else-1===l&&(a=!1,l=i+1),o>=0&&(c===t.charCodeAt(o)?-1===--o&&(s=i):(o=-1,s=l))}return r===s?s=l:-1===s&&(s=e.length),e.slice(r,s)}for(i=e.length-1;i>=0;--i)if(47===e.charCodeAt(i)){if(!a){r=i+1;break}}else-1===s&&(a=!1,s=i+1);return-1===s?"":e.slice(r,s)},extname:function(e){n(e);for(var t=-1,i=0,r=-1,s=!0,a=0,o=e.length-1;o>=0;--o){var l=e.charCodeAt(o);if(47!==l)-1===r&&(s=!1,r=o+1),46===l?-1===t?t=o:1!==a&&(a=1):-1!==t&&(a=-1);else if(!s){i=o+1;break}}return-1===t||-1===r||0===a||1===a&&t===r-1&&t===i+1?"":e.slice(t,r)},format:function(e){if(null===e||"object"!=typeof e)throw new TypeError('Parameter "pathObject" must be an object, not '+typeof e);return function(e,t){var n=t.dir||t.root,i=t.base||(t.name||"")+(t.ext||"");return n?n===t.root?n+i:n+"/"+i:i}(0,e)},parse:function(e){n(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return t;var i,r=e.charCodeAt(0),s=47===r;s?(t.root="/",i=1):i=0;for(var a=-1,o=0,l=-1,c=!0,u=e.length-1,h=0;u>=i;--u)if(47!==(r=e.charCodeAt(u)))-1===l&&(c=!1,l=u+1),46===r?-1===a?a=u:1!==h&&(h=1):-1!==a&&(h=-1);else if(!c){o=u+1;break}return-1===a||-1===l||0===h||1===h&&a===l-1&&a===o+1?-1!==l&&(t.base=t.name=0===o&&s?e.slice(1,l):e.slice(o,l)):(0===o&&s?(t.name=e.slice(1,a),t.base=e.slice(1,l)):(t.name=e.slice(o,a),t.base=e.slice(o,l)),t.ext=e.slice(a,l)),o>0?t.dir=e.slice(0,o-1):s&&(t.dir="/"),t},sep:"/",delimiter:":",posix:null};e.exports=r},6856:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(3575);t.default=class{constructor(e){this.toc=[],this.tocByHref={},this.tocById={},this.landmarks=[],this.landmarksByType={},this.length=0,e&&this.parse(e)}parse(e){let t,n,r=e.nodeType;r&&(t=(0,i.qs)(e,"html"),n=(0,i.qs)(e,"ncx")),r?t?(this.toc=this.parseNav(e),this.landmarks=this.parseLandmarks(e)):n&&(this.toc=this.parseNcx(e)):this.toc=this.load(e),this.length=0,this.unpack(this.toc)}unpack(e){for(var t,n=0;n<e.length;n++)(t=e[n]).href&&(this.tocByHref[t.href]=n),t.id&&(this.tocById[t.id]=n),this.length++,t.subitems.length&&this.unpack(t.subitems)}get(e){var t;return e?(0===e.indexOf("#")?t=this.tocById[e.substring(1)]:e in this.tocByHref&&(t=this.tocByHref[e]),this.getByIndex(e,t,this.toc)):this.toc}getByIndex(e,t,n){if(0===n.length)return;const i=n[t];if(!i||e!==i.id&&e!==i.href){let i;for(let r=0;r<n.length&&(i=this.getByIndex(e,t,n[r].subitems),!i);++r);return i}return i}landmark(e){var t;return e?(t=this.landmarksByType[e],this.landmarks[t]):this.landmarks}parseNav(e){var t=(0,i.querySelectorByType)(e,"nav","toc"),n=[];if(!t)return n;let r=(0,i.filterChildren)(t,"ol",!0);return r?n=this.parseNavList(r):n}parseNavList(e,t){const n=[];if(!e)return n;if(!e.children)return n;for(let i=0;i<e.children.length;i++){const r=this.navItem(e.children[i],t);r&&n.push(r)}return n}navItem(e,t){let n=e.getAttribute("id")||void 0,r=(0,i.filterChildren)(e,"a",!0)||(0,i.filterChildren)(e,"span",!0);if(!r)return;let s=r.getAttribute("href")||"";n||(n=s);let a=r.textContent||"",o=[],l=(0,i.filterChildren)(e,"ol",!0);return l&&(o=this.parseNavList(l,n)),{id:n,href:s,label:a,subitems:o,parent:t}}parseLandmarks(e){var t,n,r=(0,i.querySelectorByType)(e,"nav","landmarks"),s=r?(0,i.qsa)(r,"li"):[],a=s.length,o=[];if(!s||0===a)return o;for(t=0;t<a;++t)(n=this.landmarkItem(s[t]))&&(o.push(n),this.landmarksByType[n.type]=t);return o}landmarkItem(e){let t=(0,i.filterChildren)(e,"a",!0);if(!t)return;let n=t.getAttributeNS("http://www.idpf.org/2007/ops","type")||void 0;return{href:t.getAttribute("href")||"",label:t.textContent||"",type:n}}parseNcx(e){var t,n,r=(0,i.qsa)(e,"navPoint"),s=r.length,a={},o=[];if(!r||0===s)return o;for(t=0;t<s;++t)a[(n=this.ncxItem(r[t])).id]=n,n.parent?a[n.parent].subitems.push(n):o.push(n);return o}ncxItem(e){var t,n=e.getAttribute("id")||!1,r=(0,i.qs)(e,"content").getAttribute("src"),s=(0,i.qs)(e,"navLabel"),a=s.textContent?s.textContent:"",o=e.parentNode;return!o||"navPoint"!==o.nodeName&&"navPoint"!==o.nodeName.split(":").slice(-1)[0]||(t=o.getAttribute("id")),{id:n,href:r,label:a,subitems:[],parent:t}}load(e){return e.map(e=>(e.label=e.title,e.subitems=e.children?this.load(e.children):[],e))}forEach(e){return this.toc.forEach(e)}}},6873:(e,t,n)=>{"use strict";var i=n(4080),r=/^\s*class[\s{/}]/,s=Function.prototype.toString;e.exports=function(e){return!!i(e)&&!r.test(s.call(e))}},6925:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},6985:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(3575),r=c(n(8779)),s=c(n(1832)),a=c(n(3859)),o=c(n(3068)),l=c(n(3790));function c(e){return e&&e.__esModule?e:{default:e}}class u{constructor(e,t,n){this.urlCache={},this.storage=void 0,this.name=e,this.requester=t||r.default,this.resolver=n,this.online=!0,this.checkRequirements(),this.addListeners()}checkRequirements(){try{let e;void 0===l.default&&(e=l.default),this.storage=e.createInstance({name:this.name})}catch(e){throw new Error("localForage lib not loaded")}}addListeners(){this._status=this.status.bind(this),window.addEventListener("online",this._status),window.addEventListener("offline",this._status)}removeListeners(){window.removeEventListener("online",this._status),window.removeEventListener("offline",this._status),this._status=void 0}status(e){let t=navigator.onLine;this.online=t,t?this.emit("online",this):this.emit("offline",this)}add(e,t){let n=e.resources.map(e=>{let{href:n}=e,i=this.resolver(n),r=window.encodeURIComponent(i);return this.storage.getItem(r).then(e=>!e||t?this.requester(i,"binary").then(e=>this.storage.setItem(r,e)):e)});return Promise.all(n)}put(e,t,n){let i=window.encodeURIComponent(e);return this.storage.getItem(i).then(r=>r||this.requester(e,"binary",t,n).then(e=>this.storage.setItem(i,e)))}request(e,t,n,i){return this.online?this.requester(e,t,n,i).then(t=>(this.put(e),t)):this.retrieve(e,t)}retrieve(e,t){new i.defer;var n=new a.default(e);return t||(t=n.extension),("blob"==t?this.getBlob(e):this.getText(e)).then(n=>{var r,s=new i.defer;return n?(r=this.handleResponse(n,t),s.resolve(r)):s.reject({message:"File not found in storage: "+e,stack:(new Error).stack}),s.promise})}handleResponse(e,t){return"json"==t?JSON.parse(e):(0,i.isXml)(t)?(0,i.parse)(e,"text/xml"):"xhtml"==t?(0,i.parse)(e,"application/xhtml+xml"):"html"==t||"htm"==t?(0,i.parse)(e,"text/html"):e}getBlob(e,t){let n=window.encodeURIComponent(e);return this.storage.getItem(n).then(function(n){if(n)return t=t||s.default.lookup(e),new Blob([n],{type:t})})}getText(e,t){let n=window.encodeURIComponent(e);return t=t||s.default.lookup(e),this.storage.getItem(n).then(function(e){var n,r=new i.defer,s=new FileReader;if(e)return n=new Blob([e],{type:t}),s.addEventListener("loadend",()=>{r.resolve(s.result)}),s.readAsText(n,t),r.promise})}getBase64(e,t){let n=window.encodeURIComponent(e);return t=t||s.default.lookup(e),this.storage.getItem(n).then(e=>{var n,r=new i.defer,s=new FileReader;if(e)return n=new Blob([e],{type:t}),s.addEventListener("loadend",()=>{r.resolve(s.result)}),s.readAsDataURL(n,t),r.promise})}createUrl(e,t){var n,r,s=new i.defer,a=window.URL||window.webkitURL||window.mozURL,o=t&&t.base64;return e in this.urlCache?(s.resolve(this.urlCache[e]),s.promise):(o?(r=this.getBase64(e))&&r.then(function(t){this.urlCache[e]=t,s.resolve(t)}.bind(this)):(r=this.getBlob(e))&&r.then(function(t){n=a.createObjectURL(t),this.urlCache[e]=n,s.resolve(n)}.bind(this)),r||s.reject({message:"File not found in storage: "+e,stack:(new Error).stack}),s.promise)}revokeUrl(e){var t=window.URL||window.webkitURL||window.mozURL,n=this.urlCache[e];n&&t.revokeObjectURL(n)}destroy(){var e=window.URL||window.webkitURL||window.mozURL;for(let t in this.urlCache)e.revokeObjectURL(t);this.urlCache={},this.removeListeners()}}(0,o.default)(u.prototype);var h=u;t.default=h},7134:(e,t,n)=>{"use strict";var i=n(9762);e.exports=function(e){if(!i(e))throw new TypeError("Cannot use null or undefined");return e}},7223:(e,t,n)=>{"use strict";function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,s=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var n=d(t);if(n&&n.has(e))return n.get(e);var r={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=s?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(r,a,o):r[a]=e[a]}return r.default=e,n&&n.set(e,r),r}(n(6540)),a=(r=n(5556))&&r.__esModule?r:{default:r},o=n(188),l=n(4368),c=n(334),u=["children"],h=["title","showToc","loadingView","readerStyles","locationChanged","swipeable","epubViewStyles"];function d(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(d=function(e){return e?n:t})(e)}function f(){return f=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},f.apply(this,arguments)}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,T(i.key),i)}}function m(e,t,n){return t&&g(e.prototype,t),n&&g(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function v(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}function y(e,t){return y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},y(e,t)}function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=S(e);if(t){var s=S(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return E(e)}(this,n)}}function E(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function S(e){return S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},S(e)}function w(e,t,n){return(t=T(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function T(e){var t=function(e){if("object"!==i(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!==i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===i(t)?t:String(t)}function k(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},s=Object.keys(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var _=function(e){var t=e.children,n=k(e,u),i=(0,o.useSwipeable)(n);return s.default.createElement("div",i,t)},x=function(e){v(n,e);var t=b(n);function n(){var e;p(this,n);for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return w(E(e=t.call.apply(t,[this].concat(r))),"setLocation",function(){e.props.setLocation(e.props.href)}),e}return m(n,[{key:"render",value:function(){var e=this,t=this.props,i=t.label,r=t.styles,a=t.subitems;return s.default.createElement("div",null,s.default.createElement("button",{onClick:this.setLocation,style:r},i),a&&a.length>0&&s.default.createElement("div",{style:{paddingLeft:10}},a.map(function(t,i){return s.default.createElement(n,f({key:i},e.props,t))})))}}]),n}(s.PureComponent);x.propTypes={label:a.default.string,href:a.default.string,setLocation:a.default.func,styles:a.default.object};var L=function(e){v(n,e);var t=b(n);function n(e){var i;return p(this,n),w(E(i=t.call(this,e)),"toggleToc",function(){i.setState({expandedToc:!i.state.expandedToc})}),w(E(i),"next",function(){i.readerRef.current.nextPage()}),w(E(i),"prev",function(){i.readerRef.current.prevPage()}),w(E(i),"onTocChange",function(e){var t=i.props.tocChanged;i.setState({toc:e},function(){return t&&t(e)})}),w(E(i),"setLocation",function(e){var t=i.props.locationChanged;i.setState({expandedToc:!1},function(){return t&&t(e)})}),i.readerRef=s.default.createRef(),i.state={expandedToc:!1,toc:!1},i}return m(n,[{key:"renderToc",value:function(){var e=this,t=this.state,n=t.toc,i=t.expandedToc,r=this.props.readerStyles;return s.default.createElement("div",null,s.default.createElement("div",{style:r.tocArea},s.default.createElement("div",{style:r.toc},n.map(function(t,n){return s.default.createElement(x,f({},t,{key:n,setLocation:e.setLocation,styles:r.tocAreaButton}))}))),i&&s.default.createElement("div",{style:r.tocBackground,onClick:this.toggleToc}))}},{key:"renderTocToggle",value:function(){var e=this.state.expandedToc,t=this.props.readerStyles;return s.default.createElement("button",{style:Object.assign({},t.tocButton,e?t.tocButtonExpanded:{}),onClick:this.toggleToc},s.default.createElement("span",{style:Object.assign({},t.tocButtonBar,t.tocButtonBarTop)}),s.default.createElement("span",{style:Object.assign({},t.tocButtonBar,t.tocButtonBottom)}))}},{key:"render",value:function(){var e=this.props,t=e.title,n=e.showToc,i=e.loadingView,r=e.readerStyles,a=e.locationChanged,o=e.swipeable,c=e.epubViewStyles,u=k(e,h),d=this.state,p=d.toc,g=d.expandedToc;return s.default.createElement("div",{style:r.container},s.default.createElement("div",{style:Object.assign({},r.readerArea,g?r.containerExpanded:{})},n&&this.renderTocToggle(),s.default.createElement("div",{style:r.titleArea},t),s.default.createElement(_,{onSwipedRight:this.prev,onSwipedLeft:this.next,trackMouse:!0},s.default.createElement("div",{style:r.reader},s.default.createElement(l.EpubView,f({ref:this.readerRef,loadingView:i,epubViewStyles:c},u,{tocChanged:this.onTocChange,locationChanged:a})),o&&s.default.createElement("div",{style:r.swipeWrapper}))),s.default.createElement("button",{style:Object.assign({},r.arrow,r.prev),onClick:this.prev},"‹"),s.default.createElement("button",{style:Object.assign({},r.arrow,r.next),onClick:this.next},"›")),n&&p&&this.renderToc())}}]),n}(s.PureComponent);L.defaultProps={loadingView:s.default.createElement("div",{style:c.ReactReaderStyle.loadingView},"Loading…"),locationChanged:null,tocChanged:null,showToc:!0,readerStyles:c.ReactReaderStyle},L.propTypes={title:a.default.string,loadingView:a.default.element,showToc:a.default.bool,locationChanged:a.default.func,tocChanged:a.default.func,readerStyles:a.default.object,epubViewStyles:a.default.object,swipeable:a.default.bool};var A=L;t.default=A},7297:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var i=n(1601),r=n.n(i),s=n(6314),a=n.n(s)()(r());a.push([e.id,".video-card {\n  display: flex;\n  align-items: start;\n  padding: 10px;\n}\n.info .title {\n  font-size: 20px;\n  display: inline;\n}\n.info .date {\n  font-size: 20px;\n  color: #888;\n}\n.info .property {\n  padding: 10px 0px;\n}\n.info .property .key {\n  font-size: 14px;\n  color: #999;\n}\n.info .property .value {\n  font-size: 14px;\n  color: #555;\n}\n",""]);const o=a},7350:(e,t,n)=>{var i=n(8221),r=n(3805);e.exports=function(e,t,n){var s=!0,a=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return r(n)&&(s="leading"in n?!!n.leading:s,a="trailing"in n?!!n.trailing:a),i(e,t,{leading:s,maxWait:t,trailing:a})}},7575:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,r=(i=n(6841))&&i.__esModule?i:{default:i},s=n(3575);t.default=class{constructor(e){this.packagePath="",this.directory="",this.encoding="",e&&this.parse(e)}parse(e){var t;if(!e)throw new Error("Container File Not Found");if(!(t=(0,s.qs)(e,"rootfile")))throw new Error("No RootFile Found");this.packagePath=t.getAttribute("full-path"),this.directory=r.default.dirname(this.packagePath),this.encoding=e.xmlEncoding}destroy(){this.packagePath=void 0,this.directory=void 0,this.encoding=void 0}}},7613:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.Task=void 0;var i=n(3575);t.Task=class{constructor(e,t,n){return function(){var t=arguments||[];return new Promise((i,r)=>{t.push(function(e,t){!e&&t?r(t):i(e)}),e.apply(n||this,t)})}}};t.default=class{constructor(e){this._q=[],this.context=e,this.tick=i.requestAnimationFrame,this.running=!1,this.paused=!1}enqueue(){var e,t,n=[].shift.call(arguments),r=arguments;if(!n)throw new Error("No Task Provided");return t="function"==typeof n?{task:n,args:r,deferred:e=new i.defer,promise:e.promise}:{promise:n},this._q.push(t),0!=this.paused||this.running||this.run(),t.promise}dequeue(){var e,t,n;return!this._q.length||this.paused?((e=new i.defer).deferred.resolve(),e.promise):(t=(e=this._q.shift()).task)?(n=t.apply(this.context,e.args))&&"function"==typeof n.then?n.then(function(){e.deferred.resolve.apply(this.context,arguments)}.bind(this),function(){e.deferred.reject.apply(this.context,arguments)}.bind(this)):(e.deferred.resolve.apply(this.context,n),e.promise):e.promise?e.promise:void 0}dump(){for(;this._q.length;)this.dequeue()}run(){return this.running||(this.running=!0,this.defered=new i.defer),this.tick.call(window,()=>{this._q.length?this.dequeue().then(function(){this.run()}.bind(this)):(this.defered.resolve(),this.running=void 0)}),1==this.paused&&(this.paused=!1),this.defered.promise}flush(){return this.running?this.running:this._q.length?(this.running=this.dequeue().then(function(){return this.running=void 0,this.flush()}.bind(this)),this.running):void 0}clear(){this._q=[]}length(){return this._q.length}pause(){this.paused=!0}stop(){this._q=[],this.running=!1,this.paused=!0}}},7659:e=>{"use strict";var t={};e.exports=function(e,n){var i=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},7825:e=>{"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,r&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var s=n.sourceMap;s&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),t.styleTagTransform(i,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},7867:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(3575),r=c(n(4166)),s=c(n(2723)),a=n(429),o=c(n(8779)),l=n(8978);function c(e){return e&&e.__esModule?e:{default:e}}t.default=class{constructor(e,t){this.idref=e.idref,this.linear="yes"===e.linear,this.properties=e.properties,this.index=e.index,this.href=e.href,this.url=e.url,this.canonical=e.canonical,this.next=e.next,this.prev=e.prev,this.cfiBase=e.cfiBase,t?this.hooks=t:(this.hooks={},this.hooks.serialize=new s.default(this),this.hooks.content=new s.default(this)),this.document=void 0,this.contents=void 0,this.output=void 0}load(e){var t=e||this.request||o.default,n=new i.defer,r=n.promise;return this.contents?n.resolve(this.contents):t(this.url).then(function(e){return this.document=e,this.contents=e.documentElement,this.hooks.content.trigger(this.document,this)}.bind(this)).then(function(){n.resolve(this.contents)}.bind(this)).catch(function(e){n.reject(e)}),r}base(){return(0,a.replaceBase)(this.document,this)}render(e){var t=new i.defer,n=t.promise;return this.output,this.load(e).then(function(e){var t=("undefined"!=typeof navigator&&navigator.userAgent||"").indexOf("Trident")>=0,n=new("undefined"==typeof XMLSerializer||t?l.DOMParser:XMLSerializer);return this.output=n.serializeToString(e),this.output}.bind(this)).then(function(){return this.hooks.serialize.trigger(this.output,this)}.bind(this)).then(function(){t.resolve(this.output)}.bind(this)).catch(function(e){t.reject(e)}),n}find(e){var t=this,n=[],r=e.toLowerCase();return(0,i.sprint)(t.document,function(e){!function(e){for(var i,s,a,o=e.textContent.toLowerCase(),l=t.document.createRange(),c=-1;-1!=s;)-1!=(s=o.indexOf(r,c+1))&&((l=t.document.createRange()).setStart(e,s),l.setEnd(e,s+r.length),i=t.cfiFromRange(l),a=e.textContent.length<150?e.textContent:"..."+(a=e.textContent.substring(s-75,s+75))+"...",n.push({cfi:i,excerpt:a})),c=s}(e)}),n}search(e,t=5){if(void 0===document.createTreeWalker)return this.find(e);let n=[];const i=this,r=e.toLowerCase(),s=function(e){const t=e.reduce((e,t)=>e+t.textContent,"").toLowerCase().indexOf(r);if(-1!=t){const s=0,a=t+r.length;let o=0,l=0;if(t<e[s].length){let r;for(;o<e.length-1&&(l+=e[o].length,!(a<=l));)o+=1;let c=e[s],u=e[o],h=i.document.createRange();h.setStart(c,t);let d=e.slice(0,o).reduce((e,t)=>e+t.textContent.length,0);h.setEnd(u,d>a?a:a-d),r=i.cfiFromRange(h);let f=e.slice(0,o+1).reduce((e,t)=>e+t.textContent,"");f.length>150&&(f=f.substring(t-75,t+75),f="..."+f+"..."),n.push({cfi:r,excerpt:f})}}},a=document.createTreeWalker(i.document,NodeFilter.SHOW_TEXT,null,!1);let o,l=[];for(;o=a.nextNode();)l.push(o),l.length==t&&(s(l.slice(0,t)),l=l.slice(1,t));return l.length>0&&s(l),n}reconcileLayoutSettings(e){var t={layout:e.layout,spread:e.spread,orientation:e.orientation};return this.properties.forEach(function(e){var n,i,r=e.replace("rendition:",""),s=r.indexOf("-");-1!=s&&(n=r.slice(0,s),i=r.slice(s+1),t[n]=i)}),t}cfiFromRange(e){return new r.default(e,this.cfiBase).toString()}cfiFromElement(e){return new r.default(e,this.cfiBase).toString()}unload(){this.document=void 0,this.contents=void 0,this.output=void 0}destroy(){this.unload(),this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.idref=void 0,this.linear=void 0,this.properties=void 0,this.index=void 0,this.href=void 0,this.url=void 0,this.next=void 0,this.prev=void 0,this.cfiBase=void 0}}},7983:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=h(n(3068)),r=n(3575),s=h(n(8949)),a=h(n(5446)),o=h(n(7613)),l=h(n(2597)),c=h(n(8125)),u=n(4083);function h(e){return e&&e.__esModule?e:{default:e}}class d{constructor(e){this.name="default",this.optsSettings=e.settings,this.View=e.view,this.request=e.request,this.renditionQueue=e.queue,this.q=new o.default(this),this.settings=(0,r.extend)(this.settings||{},{infinite:!0,hidden:!1,width:void 0,height:void 0,axis:void 0,writingMode:void 0,flow:"scrolled",ignoreClass:"",fullsize:void 0,allowScriptedContent:!1,allowPopups:!1}),(0,r.extend)(this.settings,e.settings||{}),this.viewSettings={ignoreClass:this.settings.ignoreClass,axis:this.settings.axis,flow:this.settings.flow,layout:this.layout,method:this.settings.method,width:0,height:0,forceEvenPages:!0,allowScriptedContent:this.settings.allowScriptedContent,allowPopups:this.settings.allowPopups},this.rendered=!1}render(e,t){let n=e.tagName;void 0!==this.settings.fullsize||!n||"body"!=n.toLowerCase()&&"html"!=n.toLowerCase()||(this.settings.fullsize=!0),this.settings.fullsize&&(this.settings.overflow="visible",this.overflow=this.settings.overflow),this.settings.size=t,this.settings.rtlScrollType=(0,s.default)(),this.stage=new l.default({width:t.width,height:t.height,overflow:this.overflow,hidden:this.settings.hidden,axis:this.settings.axis,fullsize:this.settings.fullsize,direction:this.settings.direction}),this.stage.attachTo(e),this.container=this.stage.getContainer(),this.views=new c.default(this.container),this._bounds=this.bounds(),this._stageSize=this.stage.size(),this.viewSettings.width=this._stageSize.width,this.viewSettings.height=this._stageSize.height,this.stage.onResize(this.onResized.bind(this)),this.stage.onOrientationChange(this.onOrientationChange.bind(this)),this.addEventListeners(),this.layout&&this.updateLayout(),this.rendered=!0}addEventListeners(){var e;window.addEventListener("unload",function(e){this.destroy()}.bind(this)),e=this.settings.fullsize?window:this.container,this._onScroll=this.onScroll.bind(this),e.addEventListener("scroll",this._onScroll)}removeEventListeners(){(this.settings.fullsize?window:this.container).removeEventListener("scroll",this._onScroll),this._onScroll=void 0}destroy(){clearTimeout(this.orientationTimeout),clearTimeout(this.resizeTimeout),clearTimeout(this.afterScrolled),this.clear(),this.removeEventListeners(),this.stage.destroy(),this.rendered=!1}onOrientationChange(e){let{orientation:t}=window;this.optsSettings.resizeOnOrientationChange&&this.resize(),clearTimeout(this.orientationTimeout),this.orientationTimeout=setTimeout(function(){this.orientationTimeout=void 0,this.optsSettings.resizeOnOrientationChange&&this.resize(),this.emit(u.EVENTS.MANAGERS.ORIENTATION_CHANGE,t)}.bind(this),500)}onResized(e){this.resize()}resize(e,t,n){let i=this.stage.size(e,t);this.winBounds=(0,r.windowBounds)(),this.orientationTimeout&&this.winBounds.width===this.winBounds.height?this._stageSize=void 0:this._stageSize&&this._stageSize.width===i.width&&this._stageSize.height===i.height||(this._stageSize=i,this._bounds=this.bounds(),this.clear(),this.viewSettings.width=this._stageSize.width,this.viewSettings.height=this._stageSize.height,this.updateLayout(),this.emit(u.EVENTS.MANAGERS.RESIZED,{width:this._stageSize.width,height:this._stageSize.height},n))}createView(e,t){return new this.View(e,(0,r.extend)(this.viewSettings,{forceRight:t}))}handleNextPrePaginated(e,t,n){let i;if("pre-paginated"===this.layout.name&&this.layout.divisor>1){if(e||0===t.index)return;if(i=t.next(),i&&!i.properties.includes("page-spread-left"))return n.call(this,i)}}display(e,t){var n=new r.defer,i=n.promise;(t===e.href||(0,r.isNumber)(t))&&(t=void 0);var s=this.views.find(e);if(s&&e&&"pre-paginated"!==this.layout.name){let e=s.offset();if("ltr"===this.settings.direction)this.scrollTo(e.left,e.top,!0);else{let t=s.width();this.scrollTo(e.left+t,e.top,!0)}if(t){let e=s.locationOf(t),n=s.width();this.moveTo(e,n)}return n.resolve(),i}this.clear();let a=!1;return"pre-paginated"===this.layout.name&&2===this.layout.divisor&&e.properties.includes("page-spread-right")&&(a=!0),this.add(e,a).then(function(e){if(t){let n=e.locationOf(t),i=e.width();this.moveTo(n,i)}}.bind(this),e=>{n.reject(e)}).then(function(){return this.handleNextPrePaginated(a,e,this.add)}.bind(this)).then(function(){this.views.show(),n.resolve()}.bind(this)),i}afterDisplayed(e){this.emit(u.EVENTS.MANAGERS.ADDED,e)}afterResized(e){this.emit(u.EVENTS.MANAGERS.RESIZE,e.section)}moveTo(e,t){var n=0,i=0;this.isPaginated?((n=Math.floor(e.left/this.layout.delta)*this.layout.delta)+this.layout.delta>this.container.scrollWidth&&(n=this.container.scrollWidth-this.layout.delta),(i=Math.floor(e.top/this.layout.delta)*this.layout.delta)+this.layout.delta>this.container.scrollHeight&&(i=this.container.scrollHeight-this.layout.delta)):i=e.top,"rtl"===this.settings.direction&&(n+=this.layout.delta,n-=t),this.scrollTo(n,i,!0)}add(e,t){var n=this.createView(e,t);return this.views.append(n),n.onDisplayed=this.afterDisplayed.bind(this),n.onResize=this.afterResized.bind(this),n.on(u.EVENTS.VIEWS.AXIS,e=>{this.updateAxis(e)}),n.on(u.EVENTS.VIEWS.WRITING_MODE,e=>{this.updateWritingMode(e)}),n.display(this.request)}append(e,t){var n=this.createView(e,t);return this.views.append(n),n.onDisplayed=this.afterDisplayed.bind(this),n.onResize=this.afterResized.bind(this),n.on(u.EVENTS.VIEWS.AXIS,e=>{this.updateAxis(e)}),n.on(u.EVENTS.VIEWS.WRITING_MODE,e=>{this.updateWritingMode(e)}),n.display(this.request)}prepend(e,t){var n=this.createView(e,t);return n.on(u.EVENTS.VIEWS.RESIZED,e=>{this.counter(e)}),this.views.prepend(n),n.onDisplayed=this.afterDisplayed.bind(this),n.onResize=this.afterResized.bind(this),n.on(u.EVENTS.VIEWS.AXIS,e=>{this.updateAxis(e)}),n.on(u.EVENTS.VIEWS.WRITING_MODE,e=>{this.updateWritingMode(e)}),n.display(this.request)}counter(e){"vertical"===this.settings.axis?this.scrollBy(0,e.heightDelta,!0):this.scrollBy(e.widthDelta,0,!0)}next(){var e;let t=this.settings.direction;if(this.views.length&&(!this.isPaginated||"horizontal"!==this.settings.axis||t&&"ltr"!==t?this.isPaginated&&"horizontal"===this.settings.axis&&"rtl"===t?(this.scrollLeft=this.container.scrollLeft,"default"===this.settings.rtlScrollType?this.container.scrollLeft>0?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next():this.container.scrollLeft+-1*this.layout.delta>-1*this.container.scrollWidth?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next()):this.isPaginated&&"vertical"===this.settings.axis?(this.scrollTop=this.container.scrollTop,this.container.scrollTop+this.container.offsetHeight<this.container.scrollHeight?this.scrollBy(0,this.layout.height,!0):e=this.views.last().section.next()):e=this.views.last().section.next():(this.scrollLeft=this.container.scrollLeft,this.container.scrollLeft+this.container.offsetWidth+this.layout.delta<=this.container.scrollWidth?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next()),e)){this.clear(),this.updateLayout();let t=!1;return"pre-paginated"===this.layout.name&&2===this.layout.divisor&&e.properties.includes("page-spread-right")&&(t=!0),this.append(e,t).then(function(){return this.handleNextPrePaginated(t,e,this.append)}.bind(this),e=>e).then(function(){this.isPaginated||"horizontal"!==this.settings.axis||"rtl"!==this.settings.direction||"default"!==this.settings.rtlScrollType||this.scrollTo(this.container.scrollWidth,0,!0),this.views.show()}.bind(this))}}prev(){var e;let t=this.settings.direction;if(this.views.length&&(!this.isPaginated||"horizontal"!==this.settings.axis||t&&"ltr"!==t?this.isPaginated&&"horizontal"===this.settings.axis&&"rtl"===t?(this.scrollLeft=this.container.scrollLeft,"default"===this.settings.rtlScrollType?this.container.scrollLeft+this.container.offsetWidth<this.container.scrollWidth?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev():this.container.scrollLeft<0?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev()):this.isPaginated&&"vertical"===this.settings.axis?(this.scrollTop=this.container.scrollTop,this.container.scrollTop>0?this.scrollBy(0,-this.layout.height,!0):e=this.views.first().section.prev()):e=this.views.first().section.prev():(this.scrollLeft=this.container.scrollLeft,this.container.scrollLeft>0?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev()),e)){this.clear(),this.updateLayout();let t=!1;return"pre-paginated"===this.layout.name&&2===this.layout.divisor&&"object"!=typeof e.prev()&&(t=!0),this.prepend(e,t).then(function(){var t;if("pre-paginated"===this.layout.name&&this.layout.divisor>1&&(t=e.prev()))return this.prepend(t)}.bind(this),e=>e).then(function(){this.isPaginated&&"horizontal"===this.settings.axis&&("rtl"===this.settings.direction?"default"===this.settings.rtlScrollType?this.scrollTo(0,0,!0):this.scrollTo(-1*this.container.scrollWidth+this.layout.delta,0,!0):this.scrollTo(this.container.scrollWidth-this.layout.delta,0,!0)),this.views.show()}.bind(this))}}current(){var e=this.visible();return e.length?e[e.length-1]:null}clear(){this.views&&(this.views.hide(),this.scrollTo(0,0,!0),this.views.clear())}currentLocation(){return this.updateLayout(),this.isPaginated&&"horizontal"===this.settings.axis?this.location=this.paginatedLocation():this.location=this.scrolledLocation(),this.location}scrolledLocation(){let e=this.visible(),t=this.container.getBoundingClientRect(),n=t.height<window.innerHeight?t.height:window.innerHeight,i=t.width<window.innerWidth?t.width:window.innerWidth,r="vertical"===this.settings.axis,s=(this.settings.direction,0);return this.settings.fullsize&&(s=r?window.scrollY:window.scrollX),e.map(e=>{let a,o,l,c,{index:u,href:h}=e.section,d=e.position(),f=e.width(),p=e.height();r?(a=s+t.top-d.top+0,o=a+n-0,c=this.layout.count(p,n).pages,l=n):(a=s+t.left-d.left+0,o=a+i-0,c=this.layout.count(f,i).pages,l=i);let g=Math.ceil(a/l),m=[],v=Math.ceil(o/l);if("rtl"===this.settings.direction&&!r){let e=g;g=c-v,v=c-e}m=[];for(var y=g;y<=v;y++){let e=y+1;m.push(e)}return{index:u,href:h,pages:m,totalPages:c,mapping:this.mapping.page(e.contents,e.section.cfiBase,a,o)}})}paginatedLocation(){let e=this.visible(),t=this.container.getBoundingClientRect(),n=0,i=0;return this.settings.fullsize&&(n=window.scrollX),e.map(e=>{let r,s,a,o,{index:l,href:c}=e.section,u=e.position(),h=e.width();"rtl"===this.settings.direction?(r=t.right-n,o=Math.min(Math.abs(r-u.left),this.layout.width)-i,a=u.width-(u.right-r)-i,s=a-o):(r=t.left+n,o=Math.min(u.right-r,this.layout.width)-i,s=r-u.left+i,a=s+o),i+=o;let d=this.mapping.page(e.contents,e.section.cfiBase,s,a),f=this.layout.count(h).pages,p=Math.floor(s/this.layout.pageWidth),g=[],m=Math.floor(a/this.layout.pageWidth);if(p<0&&(p=0,m+=1),"rtl"===this.settings.direction){let e=p;p=f-m,m=f-e}for(var v=p+1;v<=m;v++){let e=v;g.push(e)}return{index:l,href:c,pages:g,totalPages:f,mapping:d}})}isVisible(e,t,n,i){var r=e.position(),s=i||this.bounds();return"horizontal"===this.settings.axis&&r.right>s.left-t&&r.left<s.right+n||"vertical"===this.settings.axis&&r.bottom>s.top-t&&r.top<s.bottom+n}visible(){for(var e,t=this.bounds(),n=this.views.displayed(),i=n.length,r=[],s=0;s<i;s++)e=n[s],!0===this.isVisible(e,0,0,t)&&r.push(e);return r}scrollBy(e,t,n){let i="rtl"===this.settings.direction?-1:1;n&&(this.ignore=!0),this.settings.fullsize?window.scrollBy(e*i,t*i):(e&&(this.container.scrollLeft+=e*i),t&&(this.container.scrollTop+=t)),this.scrolled=!0}scrollTo(e,t,n){n&&(this.ignore=!0),this.settings.fullsize?window.scrollTo(e,t):(this.container.scrollLeft=e,this.container.scrollTop=t),this.scrolled=!0}onScroll(){let e,t;this.settings.fullsize?(e=window.scrollY,t=window.scrollX):(e=this.container.scrollTop,t=this.container.scrollLeft),this.scrollTop=e,this.scrollLeft=t,this.ignore?this.ignore=!1:(this.emit(u.EVENTS.MANAGERS.SCROLL,{top:e,left:t}),clearTimeout(this.afterScrolled),this.afterScrolled=setTimeout(function(){this.emit(u.EVENTS.MANAGERS.SCROLLED,{top:this.scrollTop,left:this.scrollLeft})}.bind(this),20))}bounds(){return this.stage.bounds()}applyLayout(e){this.layout=e,this.updateLayout(),this.views&&this.views.length>0&&"pre-paginated"===this.layout.name&&this.display(this.views.first().section)}updateLayout(){this.stage&&(this._stageSize=this.stage.size(),this.isPaginated?(this.layout.calculate(this._stageSize.width,this._stageSize.height,this.settings.gap),this.settings.offset=this.layout.delta/this.layout.divisor):this.layout.calculate(this._stageSize.width,this._stageSize.height),this.viewSettings.width=this.layout.width,this.viewSettings.height=this.layout.height,this.setLayout(this.layout))}setLayout(e){this.viewSettings.layout=e,this.mapping=new a.default(e.props,this.settings.direction,this.settings.axis),this.views&&this.views.forEach(function(t){t&&t.setLayout(e)})}updateWritingMode(e){this.writingMode=e}updateAxis(e,t){(t||e!==this.settings.axis)&&(this.settings.axis=e,this.stage&&this.stage.axis(e),this.viewSettings.axis=e,this.mapping&&(this.mapping=new a.default(this.layout.props,this.settings.direction,this.settings.axis)),this.layout&&("vertical"===e?this.layout.spread("none"):this.layout.spread(this.layout.settings.spread)))}updateFlow(e,t="auto"){let n="paginated"===e||"auto"===e;this.isPaginated=n,"scrolled-doc"===e||"scrolled-continuous"===e||"scrolled"===e?this.updateAxis("vertical"):this.updateAxis("horizontal"),this.viewSettings.flow=e,this.settings.overflow?this.overflow=this.settings.overflow:this.overflow=n?"hidden":t,this.stage&&this.stage.overflow(this.overflow),this.updateLayout()}getContents(){var e=[];return this.views?(this.views.forEach(function(t){const n=t&&t.contents;n&&e.push(n)}),e):e}direction(e="ltr"){this.settings.direction=e,this.stage&&this.stage.direction(e),this.viewSettings.direction=e,this.updateLayout()}isRendered(){return this.rendered}}(0,i.default)(d.prototype);var f=d;t.default=f},8125:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=class{constructor(e){this.container=e,this._views=[],this.length=0,this.hidden=!1}all(){return this._views}first(){return this._views[0]}last(){return this._views[this._views.length-1]}indexOf(e){return this._views.indexOf(e)}slice(){return this._views.slice.apply(this._views,arguments)}get(e){return this._views[e]}append(e){return this._views.push(e),this.container&&this.container.appendChild(e.element),this.length++,e}prepend(e){return this._views.unshift(e),this.container&&this.container.insertBefore(e.element,this.container.firstChild),this.length++,e}insert(e,t){return this._views.splice(t,0,e),this.container&&(t<this.container.children.length?this.container.insertBefore(e.element,this.container.children[t]):this.container.appendChild(e.element)),this.length++,e}remove(e){var t=this._views.indexOf(e);t>-1&&this._views.splice(t,1),this.destroy(e),this.length--}destroy(e){e.displayed&&e.destroy(),this.container&&this.container.removeChild(e.element),e=null}forEach(){return this._views.forEach.apply(this._views,arguments)}clear(){var e,t=this.length;if(this.length){for(var n=0;n<t;n++)e=this._views[n],this.destroy(e);this._views=[],this.length=0}}find(e){for(var t,n=this.length,i=0;i<n;i++)if((t=this._views[i]).displayed&&t.section.index==e.index)return t}displayed(){for(var e,t=[],n=this.length,i=0;i<n;i++)(e=this._views[i]).displayed&&t.push(e);return t}show(){for(var e,t=this.length,n=0;n<t;n++)(e=this._views[n]).displayed&&e.show();this.hidden=!1}hide(){for(var e,t=this.length,n=0;n<t;n++)(e=this._views[n]).displayed&&e.hide();this.hidden=!0}}},8175:e=>{"use strict";e.exports=function(e){return null!=e}},8221:(e,t,n)=>{var i=n(3805),r=n(124),s=n(9374),a=Math.max,o=Math.min;e.exports=function(e,t,n){var l,c,u,h,d,f,p=0,g=!1,m=!1,v=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function y(t){var n=l,i=c;return l=c=void 0,p=t,h=e.apply(i,n)}function b(e){var n=e-f;return void 0===f||n>=t||n<0||m&&e-p>=u}function E(){var e=r();if(b(e))return S(e);d=setTimeout(E,function(e){var n=t-(e-f);return m?o(n,u-(e-p)):n}(e))}function S(e){return d=void 0,v&&l?y(e):(l=c=void 0,h)}function w(){var e=r(),n=b(e);if(l=arguments,c=this,f=e,n){if(void 0===d)return function(e){return p=e,d=setTimeout(E,t),g?y(e):h}(f);if(m)return clearTimeout(d),d=setTimeout(E,t),y(f)}return void 0===d&&(d=setTimeout(E,t)),h}return t=s(t)||0,i(n)&&(g=!!n.leading,u=(m="maxWait"in n)?a(s(n.maxWait)||0,t):u,v="trailing"in n?!!n.trailing:v),w.cancel=function(){void 0!==d&&clearTimeout(d),p=0,l=f=c=d=void 0},w.flush=function(){return void 0===d?h:S(r())},w}},8263:(e,t,n)=>{"use strict";var i=n(8175),r=n(6873),s=n(6596),a=n(148),o=n(214);(e.exports=function(e,t){var n,r,l,c,u;return arguments.length<2||"string"!=typeof e?(c=t,t=e,e=null):c=arguments[2],i(e)?(n=o.call(e,"c"),r=o.call(e,"e"),l=o.call(e,"w")):(n=l=!0,r=!1),u={value:t,configurable:n,enumerable:r,writable:l},c?s(a(c),u):u}).gs=function(e,t,n){var l,c,u,h;return"string"!=typeof e?(u=n,n=t,t=e,e=null):u=arguments[3],i(t)?r(t)?i(n)?r(n)||(u=n,n=void 0):n=void 0:(u=t,t=n=void 0):t=void 0,i(e)?(l=o.call(e,"c"),c=o.call(e,"e")):(l=!0,c=!1),h={get:t,set:n,configurable:l,enumerable:c},u?s(a(u),h):h}},8598:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=c(n(3068)),r=n(3575),s=c(n(4166)),a=c(n(4216)),o=n(4083),l=n(6628);function c(e){return e&&e.__esModule?e:{default:e}}class u{constructor(e,t){this.settings=(0,r.extend)({ignoreClass:"",axis:void 0,direction:void 0,width:0,height:0,layout:void 0,globalLayoutProperties:{},method:void 0,forceRight:!1,allowScriptedContent:!1,allowPopups:!1},t||{}),this.id="epubjs-view-"+(0,r.uuid)(),this.section=e,this.index=e.index,this.element=this.container(this.settings.axis),this.added=!1,this.displayed=!1,this.rendered=!1,this.fixedWidth=0,this.fixedHeight=0,this.epubcfi=new s.default,this.layout=this.settings.layout,this.pane=void 0,this.highlights={},this.underlines={},this.marks={}}container(e){var t=document.createElement("div");return t.classList.add("epub-view"),t.style.height="0px",t.style.width="0px",t.style.overflow="hidden",t.style.position="relative",t.style.display="block",t.style.flex=e&&"horizontal"==e?"none":"initial",t}create(){return this.iframe||(this.element||(this.element=this.createContainer()),this.iframe=document.createElement("iframe"),this.iframe.id=this.id,this.iframe.scrolling="no",this.iframe.style.overflow="hidden",this.iframe.seamless="seamless",this.iframe.style.border="none",this.iframe.sandbox="allow-same-origin",this.settings.allowScriptedContent&&(this.iframe.sandbox+=" allow-scripts"),this.settings.allowPopups&&(this.iframe.sandbox+=" allow-popups"),this.iframe.setAttribute("enable-annotation","true"),this.resizing=!0,this.element.style.visibility="hidden",this.iframe.style.visibility="hidden",this.iframe.style.width="0",this.iframe.style.height="0",this._width=0,this._height=0,this.element.setAttribute("ref",this.index),this.added=!0,this.elementBounds=(0,r.bounds)(this.element),"srcdoc"in this.iframe?this.supportsSrcdoc=!0:this.supportsSrcdoc=!1,this.settings.method||(this.settings.method=this.supportsSrcdoc?"srcdoc":"write")),this.iframe}render(e,t){return this.create(),this.size(),this.sectionRender||(this.sectionRender=this.section.render(e)),this.sectionRender.then(function(e){return this.load(e)}.bind(this)).then(function(){let e,t=this.contents.writingMode();return e="scrolled"===this.settings.flow?0===t.indexOf("vertical")?"horizontal":"vertical":0===t.indexOf("vertical")?"vertical":"horizontal",0===t.indexOf("vertical")&&"paginated"===this.settings.flow&&(this.layout.delta=this.layout.height),this.setAxis(e),this.emit(o.EVENTS.VIEWS.AXIS,e),this.setWritingMode(t),this.emit(o.EVENTS.VIEWS.WRITING_MODE,t),this.layout.format(this.contents,this.section,this.axis),this.addListeners(),new Promise((e,t)=>{this.expand(),this.settings.forceRight&&(this.element.style.marginLeft=this.width()+"px"),e()})}.bind(this),function(e){return this.emit(o.EVENTS.VIEWS.LOAD_ERROR,e),new Promise((t,n)=>{n(e)})}.bind(this)).then(function(){this.emit(o.EVENTS.VIEWS.RENDERED,this.section)}.bind(this))}reset(){this.iframe&&(this.iframe.style.width="0",this.iframe.style.height="0",this._width=0,this._height=0,this._textWidth=void 0,this._contentWidth=void 0,this._textHeight=void 0,this._contentHeight=void 0),this._needsReframe=!0}size(e,t){var n=e||this.settings.width,i=t||this.settings.height;"pre-paginated"===this.layout.name?this.lock("both",n,i):"horizontal"===this.settings.axis?this.lock("height",n,i):this.lock("width",n,i),this.settings.width=n,this.settings.height=i}lock(e,t,n){var i,s=(0,r.borders)(this.element);i=this.iframe?(0,r.borders)(this.iframe):{width:0,height:0},"width"==e&&(0,r.isNumber)(t)&&(this.lockedWidth=t-s.width-i.width),"height"==e&&(0,r.isNumber)(n)&&(this.lockedHeight=n-s.height-i.height),"both"===e&&(0,r.isNumber)(t)&&(0,r.isNumber)(n)&&(this.lockedWidth=t-s.width-i.width,this.lockedHeight=n-s.height-i.height),this.displayed&&this.iframe&&this.expand()}expand(e){var t,n=this.lockedWidth,i=this.lockedHeight;this.iframe&&!this._expanding&&(this._expanding=!0,"pre-paginated"===this.layout.name?(n=this.layout.columnWidth,i=this.layout.height):"horizontal"===this.settings.axis?((n=this.contents.textWidth())%this.layout.pageWidth>0&&(n=Math.ceil(n/this.layout.pageWidth)*this.layout.pageWidth),this.settings.forceEvenPages&&(t=n/this.layout.pageWidth,this.layout.divisor>1&&"reflowable"===this.layout.name&&t%2>0&&(n+=this.layout.pageWidth))):"vertical"===this.settings.axis&&(i=this.contents.textHeight(),"paginated"===this.settings.flow&&i%this.layout.height>0&&(i=Math.ceil(i/this.layout.height)*this.layout.height)),(this._needsReframe||n!=this._width||i!=this._height)&&this.reframe(n,i),this._expanding=!1)}reframe(e,t){var n;(0,r.isNumber)(e)&&(this.element.style.width=e+"px",this.iframe.style.width=e+"px",this._width=e),(0,r.isNumber)(t)&&(this.element.style.height=t+"px",this.iframe.style.height=t+"px",this._height=t),n={width:e,height:t,widthDelta:this.prevBounds?e-this.prevBounds.width:e,heightDelta:this.prevBounds?t-this.prevBounds.height:t},this.pane&&this.pane.render(),requestAnimationFrame(()=>{let e;for(let t in this.marks)this.marks.hasOwnProperty(t)&&(e=this.marks[t],this.placeMark(e.element,e.range))}),this.onResize(this,n),this.emit(o.EVENTS.VIEWS.RESIZED,n),this.prevBounds=n,this.elementBounds=(0,r.bounds)(this.element)}load(e){var t=new r.defer,n=t.promise;if(!this.iframe)return t.reject(new Error("No Iframe Available")),n;if(this.iframe.onload=function(e){this.onLoad(e,t)}.bind(this),"blobUrl"===this.settings.method)this.blobUrl=(0,r.createBlobUrl)(e,"application/xhtml+xml"),this.iframe.src=this.blobUrl,this.element.appendChild(this.iframe);else if("srcdoc"===this.settings.method)this.iframe.srcdoc=e,this.element.appendChild(this.iframe);else{if(this.element.appendChild(this.iframe),this.document=this.iframe.contentDocument,!this.document)return t.reject(new Error("No Document Available")),n;if(this.iframe.contentDocument.open(),window.MSApp&&MSApp.execUnsafeLocalFunction){var i=this;MSApp.execUnsafeLocalFunction(function(){i.iframe.contentDocument.write(e)})}else this.iframe.contentDocument.write(e);this.iframe.contentDocument.close()}return n}onLoad(e,t){this.window=this.iframe.contentWindow,this.document=this.iframe.contentDocument,this.contents=new a.default(this.document,this.document.body,this.section.cfiBase,this.section.index),this.rendering=!1;var n=this.document.querySelector("link[rel='canonical']");n?n.setAttribute("href",this.section.canonical):((n=this.document.createElement("link")).setAttribute("rel","canonical"),n.setAttribute("href",this.section.canonical),this.document.querySelector("head").appendChild(n)),this.contents.on(o.EVENTS.CONTENTS.EXPAND,()=>{this.displayed&&this.iframe&&(this.expand(),this.contents&&this.layout.format(this.contents))}),this.contents.on(o.EVENTS.CONTENTS.RESIZE,e=>{this.displayed&&this.iframe&&(this.expand(),this.contents&&this.layout.format(this.contents))}),t.resolve(this.contents)}setLayout(e){this.layout=e,this.contents&&(this.layout.format(this.contents),this.expand())}setAxis(e){this.settings.axis=e,this.element.style.flex="horizontal"==e?"none":"initial",this.size()}setWritingMode(e){this.writingMode=e}addListeners(){}removeListeners(e){}display(e){var t=new r.defer;return this.displayed?t.resolve(this):this.render(e).then(function(){this.emit(o.EVENTS.VIEWS.DISPLAYED,this),this.onDisplayed(this),this.displayed=!0,t.resolve(this)}.bind(this),function(e){t.reject(e,this)}),t.promise}show(){this.element.style.visibility="visible",this.iframe&&(this.iframe.style.visibility="visible",this.iframe.style.transform="translateZ(0)",this.iframe.offsetWidth,this.iframe.style.transform=null),this.emit(o.EVENTS.VIEWS.SHOWN,this)}hide(){this.element.style.visibility="hidden",this.iframe.style.visibility="hidden",this.stopExpanding=!0,this.emit(o.EVENTS.VIEWS.HIDDEN,this)}offset(){return{top:this.element.offsetTop,left:this.element.offsetLeft}}width(){return this._width}height(){return this._height}position(){return this.element.getBoundingClientRect()}locationOf(e){this.iframe.getBoundingClientRect();var t=this.contents.locationOf(e,this.settings.ignoreClass);return{left:t.left,top:t.top}}onDisplayed(e){}onResize(e,t){}bounds(e){return!e&&this.elementBounds||(this.elementBounds=(0,r.bounds)(this.element)),this.elementBounds}highlight(e,t={},n,i="epubjs-hl",r={}){if(!this.contents)return;const s=Object.assign({fill:"yellow","fill-opacity":"0.3","mix-blend-mode":"multiply"},r);let a=this.contents.range(e),c=()=>{this.emit(o.EVENTS.VIEWS.MARK_CLICKED,e,t)};t.epubcfi=e,this.pane||(this.pane=new l.Pane(this.iframe,this.element));let u=new l.Highlight(a,i,t,s),h=this.pane.addMark(u);return this.highlights[e]={mark:h,element:h.element,listeners:[c,n]},h.element.setAttribute("ref",i),h.element.addEventListener("click",c),h.element.addEventListener("touchstart",c),n&&(h.element.addEventListener("click",n),h.element.addEventListener("touchstart",n)),h}underline(e,t={},n,i="epubjs-ul",r={}){if(!this.contents)return;const s=Object.assign({stroke:"black","stroke-opacity":"0.3","mix-blend-mode":"multiply"},r);let a=this.contents.range(e),c=()=>{this.emit(o.EVENTS.VIEWS.MARK_CLICKED,e,t)};t.epubcfi=e,this.pane||(this.pane=new l.Pane(this.iframe,this.element));let u=new l.Underline(a,i,t,s),h=this.pane.addMark(u);return this.underlines[e]={mark:h,element:h.element,listeners:[c,n]},h.element.setAttribute("ref",i),h.element.addEventListener("click",c),h.element.addEventListener("touchstart",c),n&&(h.element.addEventListener("click",n),h.element.addEventListener("touchstart",n)),h}mark(e,t={},n){if(!this.contents)return;if(e in this.marks)return this.marks[e];let i=this.contents.range(e);if(!i)return;let r=i.commonAncestorContainer,s=1===r.nodeType?r:r.parentNode,a=n=>{this.emit(o.EVENTS.VIEWS.MARK_CLICKED,e,t)};i.collapsed&&1===r.nodeType?(i=new Range,i.selectNodeContents(r)):i.collapsed&&(i=new Range,i.selectNodeContents(s));let l=this.document.createElement("a");return l.setAttribute("ref","epubjs-mk"),l.style.position="absolute",l.dataset.epubcfi=e,t&&Object.keys(t).forEach(e=>{l.dataset[e]=t[e]}),n&&(l.addEventListener("click",n),l.addEventListener("touchstart",n)),l.addEventListener("click",a),l.addEventListener("touchstart",a),this.placeMark(l,i),this.element.appendChild(l),this.marks[e]={element:l,range:i,listeners:[a,n]},s}placeMark(e,t){let n,i,r;if("pre-paginated"===this.layout.name||"horizontal"!==this.settings.axis){let e=t.getBoundingClientRect();n=e.top,i=e.right}else{let e,a=t.getClientRects();for(var s=0;s!=a.length;s++)e=a[s],(!r||e.left<r)&&(r=e.left,i=Math.ceil(r/this.layout.props.pageWidth)*this.layout.props.pageWidth-this.layout.gap/2,n=e.top)}e.style.top=`${n}px`,e.style.left=`${i}px`}unhighlight(e){let t;e in this.highlights&&(t=this.highlights[e],this.pane.removeMark(t.mark),t.listeners.forEach(e=>{e&&(t.element.removeEventListener("click",e),t.element.removeEventListener("touchstart",e))}),delete this.highlights[e])}ununderline(e){let t;e in this.underlines&&(t=this.underlines[e],this.pane.removeMark(t.mark),t.listeners.forEach(e=>{e&&(t.element.removeEventListener("click",e),t.element.removeEventListener("touchstart",e))}),delete this.underlines[e])}unmark(e){let t;e in this.marks&&(t=this.marks[e],this.element.removeChild(t.element),t.listeners.forEach(e=>{e&&(t.element.removeEventListener("click",e),t.element.removeEventListener("touchstart",e))}),delete this.marks[e])}destroy(){for(let e in this.highlights)this.unhighlight(e);for(let e in this.underlines)this.ununderline(e);for(let e in this.marks)this.unmark(e);this.blobUrl&&(0,r.revokeBlobUrl)(this.blobUrl),this.displayed&&(this.displayed=!1,this.removeListeners(),this.contents.destroy(),this.stopExpanding=!0,this.element.removeChild(this.iframe),this.pane&&(this.pane.element.remove(),this.pane=void 0),this.iframe=void 0,this.contents=void 0,this._textWidth=null,this._textHeight=null,this._width=null,this._height=null)}}(0,i.default)(u.prototype);var h=u;t.default=h},8701:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(429),r=n(3575),s=c(n(2259)),a=c(n(1832)),o=c(n(3859)),l=c(n(6841));function c(e){return e&&e.__esModule?e:{default:e}}t.default=class{constructor(e,t){this.settings={replacements:t&&t.replacements||"base64",archive:t&&t.archive,resolver:t&&t.resolver,request:t&&t.request},this.process(e)}process(e){this.manifest=e,this.resources=Object.keys(e).map(function(t){return e[t]}),this.replacementUrls=[],this.html=[],this.assets=[],this.css=[],this.urls=[],this.cssUrls=[],this.split(),this.splitUrls()}split(){this.html=this.resources.filter(function(e){if("application/xhtml+xml"===e.type||"text/html"===e.type)return!0}),this.assets=this.resources.filter(function(e){if("application/xhtml+xml"!==e.type&&"text/html"!==e.type)return!0}),this.css=this.resources.filter(function(e){if("text/css"===e.type)return!0})}splitUrls(){this.urls=this.assets.map(function(e){return e.href}.bind(this)),this.cssUrls=this.css.map(function(e){return e.href})}createUrl(e){var t=new s.default(e),n=a.default.lookup(t.filename);return this.settings.archive?this.settings.archive.createUrl(e,{base64:"base64"===this.settings.replacements}):"base64"===this.settings.replacements?this.settings.request(e,"blob").then(e=>(0,r.blob2base64)(e)).then(e=>(0,r.createBase64Url)(e,n)):this.settings.request(e,"blob").then(e=>(0,r.createBlobUrl)(e,n))}replacements(){if("none"===this.settings.replacements)return new Promise(function(e){e(this.urls)}.bind(this));var e=this.urls.map(e=>{var t=this.settings.resolver(e);return this.createUrl(t).catch(e=>(console.error(e),null))});return Promise.all(e).then(e=>(this.replacementUrls=e.filter(e=>"string"==typeof e),e))}replaceCss(e,t){var n=[];return e=e||this.settings.archive,t=t||this.settings.resolver,this.cssUrls.forEach(function(i){var r=this.createCssFile(i,e,t).then(function(e){var t=this.urls.indexOf(i);t>-1&&(this.replacementUrls[t]=e)}.bind(this));n.push(r)}.bind(this)),Promise.all(n)}createCssFile(e){if(l.default.isAbsolute(e))return new Promise(function(e){e()});var t,n=this.settings.resolver(e);t=this.settings.archive?this.settings.archive.getText(n):this.settings.request(n,"text");var s=this.urls.map(e=>{var t=this.settings.resolver(e);return new o.default(n).relative(t)});return t?t.then(e=>(e=(0,i.substitute)(e,s,this.replacementUrls),"base64"===this.settings.replacements?(0,r.createBase64Url)(e,"text/css"):(0,r.createBlobUrl)(e,"text/css")),e=>new Promise(function(e){e()})):new Promise(function(e){e()})}relativeTo(e,t){return t=t||this.settings.resolver,this.urls.map(function(n){var i=t(n);return new o.default(e).relative(i)}.bind(this))}get(e){var t=this.urls.indexOf(e);if(-1!==t)return this.replacementUrls.length?new Promise(function(e,n){e(this.replacementUrls[t])}.bind(this)):this.createUrl(e)}substitute(e,t){var n;return n=t?this.relativeTo(t):this.urls,(0,i.substitute)(e,n,this.replacementUrls)}destroy(){this.settings=void 0,this.manifest=void 0,this.resources=void 0,this.replacementUrls=void 0,this.html=void 0,this.assets=void 0,this.css=void 0,this.urls=void 0,this.cssUrls=void 0}}},8731:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var i=n-1>>>1,r=e[i];if(!(0<s(r,t)))break e;e[i]=t,e[n]=r,n=i}}function i(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var i=0,r=e.length,a=r>>>1;i<a;){var o=2*(i+1)-1,l=e[o],c=o+1,u=e[c];if(0>s(l,n))c<r&&0>s(u,l)?(e[i]=u,e[c]=n,i=c):(e[i]=l,e[o]=n,i=o);else{if(!(c<r&&0>s(u,n)))break e;e[i]=u,e[c]=n,i=c}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"==typeof performance&&"function"==typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],h=1,d=null,f=3,p=!1,g=!1,m=!1,v="function"==typeof setTimeout?setTimeout:null,y="function"==typeof clearTimeout?clearTimeout:null,b="undefined"!=typeof setImmediate?setImmediate:null;function E(e){for(var t=i(u);null!==t;){if(null===t.callback)r(u);else{if(!(t.startTime<=e))break;r(u),t.sortIndex=t.expirationTime,n(c,t)}t=i(u)}}function S(e){if(m=!1,E(e),!g)if(null!==i(c))g=!0,P(w);else{var t=i(u);null!==t&&O(S,t.startTime-e)}}function w(e,n){g=!1,m&&(m=!1,y(x),x=-1),p=!0;var s=f;try{for(E(n),d=i(c);null!==d&&(!(d.expirationTime>n)||e&&!R());){var a=d.callback;if("function"==typeof a){d.callback=null,f=d.priorityLevel;var o=a(d.expirationTime<=n);n=t.unstable_now(),"function"==typeof o?d.callback=o:d===i(c)&&r(c),E(n)}else r(c);d=i(c)}if(null!==d)var l=!0;else{var h=i(u);null!==h&&O(S,h.startTime-n),l=!1}return l}finally{d=null,f=s,p=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var T,k=!1,_=null,x=-1,L=5,A=-1;function R(){return!(t.unstable_now()-A<L)}function I(){if(null!==_){var e=t.unstable_now();A=e;var n=!0;try{n=_(!0,e)}finally{n?T():(k=!1,_=null)}}else k=!1}if("function"==typeof b)T=function(){b(I)};else if("undefined"!=typeof MessageChannel){var C=new MessageChannel,D=C.port2;C.port1.onmessage=I,T=function(){D.postMessage(null)}}else T=function(){v(I,0)};function P(e){_=e,k||(k=!0,T())}function O(e,n){x=v(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){g||p||(g=!0,P(w))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return i(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,r,s){var a=t.unstable_now();switch(s="object"==typeof s&&null!==s&&"number"==typeof(s=s.delay)&&0<s?a+s:a,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:h++,callback:r,priorityLevel:e,startTime:s,expirationTime:o=s+o,sortIndex:-1},s>a?(e.sortIndex=s,n(u,e),null===i(c)&&e===i(u)&&(m?(y(x),x=-1):m=!0,O(S,s-a))):(e.sortIndex=o,n(c,e),g||p||(g=!0,P(w))),e},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},8779:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,r=n(3575),s=(i=n(3859))&&i.__esModule?i:{default:i};t.default=function(e,t,n,i){var a,o="undefined"!=typeof window&&window.URL,l=o?"blob":"arraybuffer",c=new r.defer,u=new XMLHttpRequest,h=XMLHttpRequest.prototype;for(a in"overrideMimeType"in h||Object.defineProperty(h,"overrideMimeType",{value:function(){}}),n&&(u.withCredentials=!0),u.onreadystatechange=function(){if(this.readyState===XMLHttpRequest.DONE){var e=!1;if(""!==this.responseType&&"document"!==this.responseType||(e=this.responseXML),200===this.status||0===this.status||e){var n;if(!this.response&&!e)return c.reject({status:this.status,message:"Empty Response",stack:(new Error).stack}),c.promise;if(403===this.status)return c.reject({status:this.status,response:this.response,message:"Forbidden",stack:(new Error).stack}),c.promise;n=e?this.responseXML:(0,r.isXml)(t)?(0,r.parse)(this.response,"text/xml"):"xhtml"==t?(0,r.parse)(this.response,"application/xhtml+xml"):"html"==t||"htm"==t?(0,r.parse)(this.response,"text/html"):"json"==t?JSON.parse(this.response):"blob"==t?o?this.response:new Blob([this.response]):this.response,c.resolve(n)}else c.reject({status:this.status,message:this.response,stack:(new Error).stack})}},u.onerror=function(e){c.reject(e)},u.open("GET",e,!0),i)u.setRequestHeader(a,i[a]);return"json"==t&&u.setRequestHeader("Accept","application/json"),t||(t=new s.default(e).extension),"blob"==t&&(u.responseType=l),(0,r.isXml)(t)&&u.overrideMimeType("text/xml"),"binary"==t&&(u.responseType="arraybuffer"),u.send(),c.promise}},8851:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=o(n(4166)),r=o(n(2723)),s=o(n(7867)),a=n(429);function o(e){return e&&e.__esModule?e:{default:e}}t.default=class{constructor(){this.spineItems=[],this.spineByHref={},this.spineById={},this.hooks={},this.hooks.serialize=new r.default,this.hooks.content=new r.default,this.hooks.content.register(a.replaceBase),this.hooks.content.register(a.replaceCanonical),this.hooks.content.register(a.replaceMeta),this.epubcfi=new i.default,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0}unpack(e,t,n){this.items=e.spine,this.manifest=e.manifest,this.spineNodeIndex=e.spineNodeIndex,this.baseUrl=e.baseUrl||e.basePath||"",this.length=this.items.length,this.items.forEach((e,i)=>{var r,a=this.manifest[e.idref];e.index=i,e.cfiBase=this.epubcfi.generateChapterComponent(this.spineNodeIndex,e.index,e.id),e.href&&(e.url=t(e.href,!0),e.canonical=n(e.href)),a&&(e.href=a.href,e.url=t(e.href,!0),e.canonical=n(e.href),a.properties.length&&e.properties.push.apply(e.properties,a.properties)),"yes"===e.linear?(e.prev=function(){let t=e.index;for(;t>0;){let e=this.get(t-1);if(e&&e.linear)return e;t-=1}}.bind(this),e.next=function(){let t=e.index;for(;t<this.spineItems.length-1;){let e=this.get(t+1);if(e&&e.linear)return e;t+=1}}.bind(this)):(e.prev=function(){},e.next=function(){}),r=new s.default(e,this.hooks),this.append(r)}),this.loaded=!0}get(e){var t=0;if(void 0===e)for(;t<this.spineItems.length;){let e=this.spineItems[t];if(e&&e.linear)break;t+=1}else this.epubcfi.isCfiString(e)?t=new i.default(e).spinePos:"number"==typeof e||!1===isNaN(e)?t=e:"string"==typeof e&&0===e.indexOf("#")?t=this.spineById[e.substring(1)]:"string"==typeof e&&(e=e.split("#")[0],t=this.spineByHref[e]||this.spineByHref[encodeURI(e)]);return this.spineItems[t]||null}append(e){var t=this.spineItems.length;return e.index=t,this.spineItems.push(e),this.spineByHref[decodeURI(e.href)]=t,this.spineByHref[encodeURI(e.href)]=t,this.spineByHref[e.href]=t,this.spineById[e.idref]=t,t}prepend(e){return this.spineByHref[e.href]=0,this.spineById[e.idref]=0,this.spineItems.forEach(function(e,t){e.index=t}),0}remove(e){var t=this.spineItems.indexOf(e);if(t>-1)return delete this.spineByHref[e.href],delete this.spineById[e.idref],this.spineItems.splice(t,1)}each(){return this.spineItems.forEach.apply(this.spineItems,arguments)}first(){let e=0;do{let t=this.get(e);if(t&&t.linear)return t;e+=1}while(e<this.spineItems.length)}last(){let e=this.spineItems.length-1;do{let t=this.get(e);if(t&&t.linear)return t;e-=1}while(e>=0)}destroy(){this.each(e=>e.destroy()),this.spineItems=void 0,this.spineByHref=void 0,this.spineById=void 0,this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.epubcfi=void 0,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0}}},8949:(e,t)=>{"use strict";function n(){var e=document.createElement("div");e.dir="rtl",e.style.position="fixed",e.style.width="1px",e.style.height="1px",e.style.top="0px",e.style.left="0px",e.style.overflow="hidden";var t=document.createElement("div");t.style.width="2px";var n=document.createElement("span");n.style.width="1px",n.style.display="inline-block";var i=document.createElement("span");return i.style.width="1px",i.style.display="inline-block",t.appendChild(n),t.appendChild(i),e.appendChild(t),e}Object.defineProperty(t,"__esModule",{value:!0}),t.createDefiner=n,t.default=function(){var e="reverse",t=n();return document.body.appendChild(t),t.scrollLeft>0?e="default":"undefined"!=typeof Element&&Element.prototype.scrollIntoView?(t.children[0].children[1].scrollIntoView(),t.scrollLeft<0&&(e="negative")):(t.scrollLeft=1,0===t.scrollLeft&&(e="negative")),document.body.removeChild(t),e}},8978:(e,t,n)=>{var i=n(4722);t.DOMImplementation=i.DOMImplementation,t.XMLSerializer=i.XMLSerializer,t.DOMParser=n(5752).DOMParser},9047:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=S(n(3068)),r=n(3575),s=S(n(2259)),a=S(n(3859)),o=S(n(8851)),l=S(n(5836)),c=S(n(7575)),u=S(n(771)),h=S(n(6856)),d=S(n(8701)),f=S(n(3781)),p=S(n(4064)),g=S(n(2222)),m=S(n(8779)),v=S(n(4166)),y=S(n(6985)),b=S(n(9206)),E=n(4083);function S(e){return e&&e.__esModule?e:{default:e}}const w="META-INF/container.xml",T="binary",k="base64",_="epub",x="json";class L{constructor(e,t){void 0===t&&"string"!=typeof e&&e instanceof Blob==0&&e instanceof ArrayBuffer==0&&(t=e,e=void 0),this.settings=(0,r.extend)(this.settings||{},{requestMethod:void 0,requestCredentials:void 0,requestHeaders:void 0,encoding:void 0,replacements:void 0,canonical:void 0,openAs:void 0,store:void 0}),(0,r.extend)(this.settings,t),this.opening=new r.defer,this.opened=this.opening.promise,this.isOpen=!1,this.loading={manifest:new r.defer,spine:new r.defer,metadata:new r.defer,cover:new r.defer,navigation:new r.defer,pageList:new r.defer,resources:new r.defer,displayOptions:new r.defer},this.loaded={manifest:this.loading.manifest.promise,spine:this.loading.spine.promise,metadata:this.loading.metadata.promise,cover:this.loading.cover.promise,navigation:this.loading.navigation.promise,pageList:this.loading.pageList.promise,resources:this.loading.resources.promise,displayOptions:this.loading.displayOptions.promise},this.ready=Promise.all([this.loaded.manifest,this.loaded.spine,this.loaded.metadata,this.loaded.cover,this.loaded.navigation,this.loaded.resources,this.loaded.displayOptions]),this.isRendered=!1,this.request=this.settings.requestMethod||m.default,this.spine=new o.default,this.locations=new l.default(this.spine,this.load.bind(this)),this.navigation=void 0,this.pageList=void 0,this.url=void 0,this.path=void 0,this.archived=!1,this.archive=void 0,this.storage=void 0,this.resources=void 0,this.rendition=void 0,this.container=void 0,this.packaging=void 0,this.displayOptions=void 0,this.settings.store&&this.store(this.settings.store),e&&this.open(e,this.settings.openAs).catch(t=>{var n=new Error("Cannot load book at "+e);this.emit(E.EVENTS.BOOK.OPEN_FAILED,n)})}open(e,t){var n,i=t||this.determineType(e);return i===T?(this.archived=!0,this.url=new s.default("/",""),n=this.openEpub(e)):i===k?(this.archived=!0,this.url=new s.default("/",""),n=this.openEpub(e,i)):i===_?(this.archived=!0,this.url=new s.default("/",""),n=this.request(e,"binary",this.settings.requestCredentials,this.settings.requestHeaders).then(this.openEpub.bind(this))):"opf"==i?(this.url=new s.default(e),n=this.openPackaging(this.url.Path.toString())):i==x?(this.url=new s.default(e),n=this.openManifest(this.url.Path.toString())):(this.url=new s.default(e),n=this.openContainer(w).then(this.openPackaging.bind(this))),n}openEpub(e,t){return this.unarchive(e,t||this.settings.encoding).then(()=>this.openContainer(w)).then(e=>this.openPackaging(e))}openContainer(e){return this.load(e).then(e=>(this.container=new c.default(e),this.resolve(this.container.packagePath)))}openPackaging(e){return this.path=new a.default(e),this.load(e).then(e=>(this.packaging=new u.default(e),this.unpack(this.packaging)))}openManifest(e){return this.path=new a.default(e),this.load(e).then(e=>(this.packaging=new u.default,this.packaging.load(e),this.unpack(this.packaging)))}load(e){var t=this.resolve(e);return this.archived?this.archive.request(t):this.request(t,null,this.settings.requestCredentials,this.settings.requestHeaders)}resolve(e,t){if(e){var n=e;return e.indexOf("://")>-1?e:(this.path&&(n=this.path.resolve(e)),0!=t&&this.url&&(n=this.url.resolve(n)),n)}}canonical(e){return e?this.settings.canonical?this.settings.canonical(e):this.resolve(e,!0):""}determineType(e){var t;return"base64"===this.settings.encoding?k:"string"!=typeof e?T:((t=new s.default(e).path().extension)&&(t=t.replace(/\?.*$/,"")),t?"epub"===t?_:"opf"===t?"opf":"json"===t?x:void 0:"directory")}unpack(e){this.package=e,""===this.packaging.metadata.layout?this.load(this.url.resolve("META-INF/com.apple.ibooks.display-options.xml")).then(e=>{this.displayOptions=new b.default(e),this.loading.displayOptions.resolve(this.displayOptions)}).catch(e=>{this.displayOptions=new b.default,this.loading.displayOptions.resolve(this.displayOptions)}):(this.displayOptions=new b.default,this.loading.displayOptions.resolve(this.displayOptions)),this.spine.unpack(this.packaging,this.resolve.bind(this),this.canonical.bind(this)),this.resources=new d.default(this.packaging.manifest,{archive:this.archive,resolver:this.resolve.bind(this),request:this.request.bind(this),replacements:this.settings.replacements||(this.archived?"blobUrl":"base64")}),this.loadNavigation(this.packaging).then(()=>{this.loading.navigation.resolve(this.navigation)}),this.packaging.coverPath&&(this.cover=this.resolve(this.packaging.coverPath)),this.loading.manifest.resolve(this.packaging.manifest),this.loading.metadata.resolve(this.packaging.metadata),this.loading.spine.resolve(this.spine),this.loading.cover.resolve(this.cover),this.loading.resources.resolve(this.resources),this.loading.pageList.resolve(this.pageList),this.isOpen=!0,this.archived||this.settings.replacements&&"none"!=this.settings.replacements?this.replacements().then(()=>{this.loaded.displayOptions.then(()=>{this.opening.resolve(this)})}).catch(e=>{console.error(e)}):this.loaded.displayOptions.then(()=>{this.opening.resolve(this)})}loadNavigation(e){let t=e.navPath||e.ncxPath,n=e.toc;return n?new Promise((t,i)=>{this.navigation=new h.default(n),e.pageList&&(this.pageList=new f.default(e.pageList)),t(this.navigation)}):t?this.load(t,"xml").then(e=>(this.navigation=new h.default(e),this.pageList=new f.default(e),this.navigation)):new Promise((e,t)=>{this.navigation=new h.default,this.pageList=new f.default,e(this.navigation)})}section(e){return this.spine.get(e)}renderTo(e,t){return this.rendition=new p.default(this,t),this.rendition.attachTo(e),this.rendition}setRequestCredentials(e){this.settings.requestCredentials=e}setRequestHeaders(e){this.settings.requestHeaders=e}unarchive(e,t){return this.archive=new g.default,this.archive.open(e,t)}store(e){let t=this.settings.replacements&&"none"!==this.settings.replacements,n=this.url,i=this.settings.requestMethod||m.default.bind(this);return this.storage=new y.default(e,i,this.resolve.bind(this)),this.request=this.storage.request.bind(this.storage),this.opened.then(()=>{this.archived&&(this.storage.requester=this.archive.request.bind(this.archive));let e=(e,t)=>{t.output=this.resources.substitute(e,t.url)};this.resources.settings.replacements=t||"blobUrl",this.resources.replacements().then(()=>this.resources.replaceCss()),this.storage.on("offline",()=>{this.url=new s.default("/",""),this.spine.hooks.serialize.register(e)}),this.storage.on("online",()=>{this.url=n,this.spine.hooks.serialize.deregister(e)})}),this.storage}coverUrl(){return this.loaded.cover.then(()=>this.cover?this.archived?this.archive.createUrl(this.cover):this.cover:null)}replacements(){return this.spine.hooks.serialize.register((e,t)=>{t.output=this.resources.substitute(e,t.url)}),this.resources.replacements().then(()=>this.resources.replaceCss())}getRange(e){var t=new v.default(e),n=this.spine.get(t.spinePos),i=this.load.bind(this);return n?n.load(i).then(function(e){return t.toRange(n.document)}):new Promise((e,t)=>{t("CFI could not be found")})}key(e){var t=e||this.packaging.metadata.identifier||this.url.filename;return`epubjs:${E.EPUBJS_VERSION}:${t}`}destroy(){this.opened=void 0,this.loading=void 0,this.loaded=void 0,this.ready=void 0,this.isOpen=!1,this.isRendered=!1,this.spine&&this.spine.destroy(),this.locations&&this.locations.destroy(),this.pageList&&this.pageList.destroy(),this.archive&&this.archive.destroy(),this.resources&&this.resources.destroy(),this.container&&this.container.destroy(),this.packaging&&this.packaging.destroy(),this.rendition&&this.rendition.destroy(),this.displayOptions&&this.displayOptions.destroy(),this.spine=void 0,this.locations=void 0,this.pageList=void 0,this.archive=void 0,this.resources=void 0,this.container=void 0,this.packaging=void 0,this.rendition=void 0,this.navigation=void 0,this.url=void 0,this.path=void 0,this.archived=!1}}(0,i.default)(L.prototype);var A=L;t.default=A},9108:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var i=n(1601),r=n.n(i),s=n(6314),a=n.n(s)()(r());a.push([e.id,'.rc-slider {\n  border-radius: 6px;\n  height: 14px;\n  padding: 5px 0;\n  position: relative;\n  touch-action: none;\n  width: 100%;\n}\n.rc-slider,\n.rc-slider * {\n  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\n  box-sizing: border-box;\n}\n.rc-slider-rail {\n  background-color: #e9e9e9;\n  width: 100%;\n}\n.rc-slider-rail,\n.rc-slider-track {\n  border-radius: 6px;\n  height: 4px;\n  position: absolute;\n}\n.rc-slider-track {\n  background-color: #abe2fb;\n  left: 0;\n}\n.rc-slider-handle {\n  background-color: #fff;\n  border: 2px solid #96dbfa;\n  border-radius: 50%;\n  cursor: pointer;\n  cursor: -webkit-grab;\n  cursor: grab;\n  height: 14px;\n  margin-top: -5px;\n  position: absolute;\n  touch-action: pan-x;\n  width: 14px;\n}\n.rc-slider-handle-dragging.rc-slider-handle-dragging.rc-slider-handle-dragging {\n  border-color: #57c5f7;\n  box-shadow: 0 0 0 5px #96dbfa;\n}\n.rc-slider-handle:focus {\n  outline: none;\n}\n.rc-slider-handle-click-focused:focus {\n  border-color: #96dbfa;\n  box-shadow: unset;\n}\n.rc-slider-handle:hover {\n  border-color: #57c5f7;\n}\n.rc-slider-handle:active {\n  border-color: #57c5f7;\n  box-shadow: 0 0 5px #57c5f7;\n  cursor: -webkit-grabbing;\n  cursor: grabbing;\n}\n.rc-slider-mark {\n  font-size: 12px;\n  left: 0;\n  position: absolute;\n  top: 18px;\n  width: 100%;\n}\n.rc-slider-mark-text {\n  color: #999;\n  cursor: pointer;\n  display: inline-block;\n  position: absolute;\n  text-align: center;\n  vertical-align: middle;\n}\n.rc-slider-mark-text-active {\n  color: #666;\n}\n.rc-slider-step {\n  background: transparent;\n  height: 4px;\n  position: absolute;\n  width: 100%;\n}\n.rc-slider-dot {\n  background-color: #fff;\n  border: 2px solid #e9e9e9;\n  border-radius: 50%;\n  bottom: -2px;\n  cursor: pointer;\n  height: 8px;\n  margin-left: -4px;\n  position: absolute;\n  vertical-align: middle;\n  width: 8px;\n}\n.rc-slider-dot-active {\n  border-color: #96dbfa;\n}\n.rc-slider-dot-reverse {\n  margin-right: -4px;\n}\n.rc-slider-disabled {\n  background-color: #e9e9e9;\n}\n.rc-slider-disabled .rc-slider-track {\n  background-color: #ccc;\n}\n.rc-slider-disabled .rc-slider-dot,\n.rc-slider-disabled .rc-slider-handle {\n  background-color: #fff;\n  border-color: #ccc;\n  box-shadow: none;\n  cursor: not-allowed;\n}\n.rc-slider-disabled .rc-slider-dot,\n.rc-slider-disabled .rc-slider-mark-text {\n  cursor: not-allowed !important;\n}\n.rc-slider-vertical {\n  height: 100%;\n  padding: 0 5px;\n  width: 14px;\n}\n.rc-slider-vertical .rc-slider-rail {\n  height: 100%;\n  width: 4px;\n}\n.rc-slider-vertical .rc-slider-track {\n  bottom: 0;\n  left: 5px;\n  width: 4px;\n}\n.rc-slider-vertical .rc-slider-handle {\n  margin-left: -5px;\n  touch-action: pan-y;\n}\n.rc-slider-vertical .rc-slider-mark {\n  height: 100%;\n  left: 18px;\n  top: 0;\n}\n.rc-slider-vertical .rc-slider-step {\n  height: 100%;\n  width: 4px;\n}\n.rc-slider-vertical .rc-slider-dot {\n  left: 2px;\n  margin-bottom: -4px;\n}\n.rc-slider-vertical .rc-slider-dot:first-child {\n  margin-bottom: -4px;\n}\n.rc-slider-vertical .rc-slider-dot:last-child {\n  margin-bottom: -4px;\n}\n.rc-slider-tooltip-zoom-down-appear,\n.rc-slider-tooltip-zoom-down-enter,\n.rc-slider-tooltip-zoom-down-leave {\n  animation-duration: 0.3s;\n  animation-fill-mode: both;\n  animation-play-state: paused;\n  display: block !important;\n}\n.rc-slider-tooltip-zoom-down-appear.rc-slider-tooltip-zoom-down-appear-active,\n.rc-slider-tooltip-zoom-down-enter.rc-slider-tooltip-zoom-down-enter-active {\n  animation-name: rcSliderTooltipZoomDownIn;\n  animation-play-state: running;\n}\n.rc-slider-tooltip-zoom-down-leave.rc-slider-tooltip-zoom-down-leave-active {\n  animation-name: rcSliderTooltipZoomDownOut;\n  animation-play-state: running;\n}\n.rc-slider-tooltip-zoom-down-appear,\n.rc-slider-tooltip-zoom-down-enter {\n  animation-timing-function: cubic-bezier(0.23, 1, 0.32, 1);\n  transform: scale(0);\n}\n.rc-slider-tooltip-zoom-down-leave {\n  animation-timing-function: cubic-bezier(0.755, 0.05, 0.855, 0.06);\n}\n@keyframes rcSliderTooltipZoomDownIn {\n  0% {\n    opacity: 0;\n    transform: scale(0);\n    transform-origin: 50% 100%;\n  }\n  to {\n    transform: scale(1);\n    transform-origin: 50% 100%;\n  }\n}\n@keyframes rcSliderTooltipZoomDownOut {\n  0% {\n    transform: scale(1);\n    transform-origin: 50% 100%;\n  }\n  to {\n    opacity: 0;\n    transform: scale(0);\n    transform-origin: 50% 100%;\n  }\n}\n.rc-slider-tooltip {\n  left: -9999px;\n  position: absolute;\n  top: -9999px;\n  visibility: visible;\n}\n.rc-slider-tooltip,\n.rc-slider-tooltip * {\n  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\n  box-sizing: border-box;\n}\n.rc-slider-tooltip-hidden {\n  display: none;\n}\n.rc-slider-tooltip-placement-top {\n  padding: 4px 0 8px;\n}\n.rc-slider-tooltip-inner {\n  background-color: #6c6c6c;\n  border-radius: 6px;\n  box-shadow: 0 0 4px #d9d9d9;\n  color: #fff;\n  font-size: 12px;\n  height: 24px;\n  line-height: 1;\n  min-width: 24px;\n  padding: 6px 2px;\n  text-align: center;\n  text-decoration: none;\n}\n.rc-slider-tooltip-arrow {\n  border-color: transparent;\n  border-style: solid;\n  height: 0;\n  position: absolute;\n  width: 0;\n}\n.rc-slider-tooltip-placement-top .rc-slider-tooltip-arrow {\n  border-top-color: #6c6c6c;\n  border-width: 4px 4px 0;\n  bottom: 4px;\n  left: 50%;\n  margin-left: -4px;\n}\n.rc-switch {\n  background-color: #ccc;\n  border: 1px solid #ccc;\n  border-radius: 20px 20px;\n  box-sizing: border-box;\n  cursor: pointer;\n  display: inline-block;\n  height: 22px;\n  line-height: 20px;\n  padding: 0;\n  position: relative;\n  transition: all 0.3s cubic-bezier(0.35, 0, 0.25, 1);\n  vertical-align: middle;\n  width: 44px;\n}\n.rc-switch-inner {\n  color: #fff;\n  font-size: 12px;\n  left: 24px;\n  position: absolute;\n  top: 0;\n}\n.rc-switch:after {\n  animation-duration: 0.3s;\n  animation-name: rcSwitchOff;\n  animation-timing-function: cubic-bezier(0.35, 0, 0.25, 1);\n  background-color: #fff;\n  border-radius: 50% 50%;\n  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.26);\n  content: " ";\n  cursor: pointer;\n  height: 18px;\n  left: 2px;\n  position: absolute;\n  top: 1px;\n  transform: scale(1);\n  transition: left 0.3s cubic-bezier(0.35, 0, 0.25, 1);\n  width: 18px;\n}\n.rc-switch:hover:after {\n  animation-name: rcSwitchOn;\n  transform: scale(1.1);\n}\n.rc-switch:focus {\n  box-shadow: 0 0 0 2px #d5f1fd;\n  outline: none;\n}\n.rc-switch-checked {\n  background-color: #87d068;\n  border: 1px solid #87d068;\n}\n.rc-switch-checked .rc-switch-inner {\n  left: 6px;\n}\n.rc-switch-checked:after {\n  left: 22px;\n}\n.rc-switch-disabled {\n  background: #ccc;\n  border-color: #ccc;\n  cursor: no-drop;\n}\n.rc-switch-disabled:after {\n  animation-name: none;\n  background: #9e9e9e;\n  cursor: no-drop;\n}\n.rc-switch-disabled:hover:after {\n  animation-name: none;\n  transform: scale(1);\n}\n.rc-switch-label {\n  display: inline-block;\n  font-size: 14px;\n  line-height: 20px;\n  padding-left: 10px;\n  pointer-events: none;\n  user-select: text;\n  vertical-align: middle;\n  white-space: normal;\n}\n@keyframes rcSwitchOn {\n  0% {\n    transform: scale(1);\n  }\n  50% {\n    transform: scale(1.25);\n  }\n  to {\n    transform: scale(1.1);\n  }\n}\n@keyframes rcSwitchOff {\n  0% {\n    transform: scale(1.1);\n  }\n  to {\n    transform: scale(1);\n  }\n}\n.react-jinke-music-player-main:focus {\n  outline: none;\n}\n.react-jinke-music-player-main li,\n.react-jinke-music-player-main ul {\n  list-style-type: none;\n  margin: 0;\n  padding: 0;\n}\n.react-jinke-music-player-main * {\n  box-sizing: border-box;\n}\n.react-jinke-music-player-main .text-center {\n  text-align: center;\n}\n.react-jinke-music-player-main .hidden {\n  display: none !important;\n}\n.react-jinke-music-player-main .loading {\n  animation: audioLoading 1s linear infinite;\n  display: inline-flex;\n}\n.react-jinke-music-player-main .loading svg {\n  color: #31c27c;\n  font-size: 24px;\n}\n.react-jinke-music-player-main .translate {\n  animation: translate 0.35s cubic-bezier(0.43, -0.1, 0.16, 1.1) forwards;\n}\n.react-jinke-music-player-main .scale {\n  animation: scaleTo 0.35s cubic-bezier(0.43, -0.1, 0.16, 1.1) forwards;\n}\n@keyframes playing {\n  to {\n    transform: rotateX(1turn);\n  }\n}\n@keyframes coverReset {\n  to {\n    transform: rotate(0deg);\n  }\n}\n@keyframes audioLoading {\n  0% {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(1turn);\n  }\n}\n@keyframes scale {\n  0% {\n    transform: scale(0);\n  }\n  50% {\n    opacity: 0.6;\n    transform: scale(1.5);\n  }\n  to {\n    opacity: 0;\n    transform: scale(2);\n  }\n}\n@keyframes scaleTo {\n  0% {\n    opacity: 0;\n    transform: scale(0);\n  }\n  to {\n    opacity: 1;\n    transform: scale(1);\n  }\n}\n@keyframes scaleFrom {\n  0% {\n    opacity: 1;\n    transform: scale(1);\n  }\n  to {\n    opacity: 0;\n    transform: scale(0);\n  }\n}\n@keyframes imgRotate {\n  0% {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(1turn);\n  }\n}\n@keyframes fromTo {\n  0% {\n    transform: scale(1) translate3d(0, 110%, 0);\n  }\n  to {\n    transform: scale(1) translateZ(0);\n  }\n}\n@keyframes fromOut {\n  0% {\n    transform: scale(1) translateZ(0);\n  }\n  to {\n    transform: scale(1) translate3d(0, 110%, 0);\n  }\n}\n@keyframes fromDown {\n  0% {\n    transform: scale(1) translate3d(0, -110%, 0);\n  }\n  to {\n    transform: scale(1) translateZ(0);\n  }\n}\n@keyframes translate {\n  0% {\n    opacity: 0;\n    transform: translate3d(100%, 0, 0);\n  }\n  to {\n    opacity: 1;\n    transform: translateZ(0);\n  }\n}\n@keyframes remove {\n  0% {\n    opacity: 1;\n    transform: translateZ(0);\n  }\n  to {\n    opacity: 0;\n    transform: translate3d(-100%, 0, 0);\n  }\n}\n.react-jinke-music-player-main .img-rotate-pause {\n  animation-play-state: paused !important;\n}\n.react-jinke-music-player-main .img-rotate-reset {\n  animation: coverReset 0.35s cubic-bezier(0.43, -0.1, 0.16, 1.1) forwards !important;\n}\n.react-jinke-music-player-mobile {\n  background-color: rgba(0, 0, 0, 0.75);\n  bottom: 0;\n  color: #fff;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  left: 0;\n  overflow: hidden;\n  padding: 20px;\n  position: fixed;\n  right: 0;\n  top: 0;\n  width: 100%;\n  z-index: 999;\n}\n.react-jinke-music-player-mobile > .group {\n  flex: 1 1 auto;\n}\n.react-jinke-music-player-mobile .show {\n  animation: mobile-bg-show 0.35s cubic-bezier(0.43, -0.1, 0.16, 1.1) forwards;\n}\n.react-jinke-music-player-mobile .hide {\n  animation: mobile-bg-hide 0.35s cubic-bezier(0.43, -0.1, 0.16, 1.1) forwards;\n}\n.react-jinke-music-player-mobile-play-model-tip {\n  align-items: center;\n  background-color: #31c27c;\n  box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);\n  color: #fff;\n  display: flex;\n  height: 35px;\n  left: 0;\n  line-height: 35px;\n  padding: 0 20px;\n  position: fixed;\n  top: 0;\n  transform: translate3d(0, -105%, 0);\n  transition: transform 0.35s cubic-bezier(0.43, -0.1, 0.16, 1.1);\n  width: 100%;\n  z-index: 1000;\n}\n.react-jinke-music-player-mobile-play-model-tip-title {\n  margin-right: 12px;\n}\n.react-jinke-music-player-mobile-play-model-tip-title svg {\n  animation: none!important;\n  vertical-align: text-bottom !important;\n}\n@media screen and (max-width: 767px) {\n  .react-jinke-music-player-mobile-play-model-tip-title svg {\n    color: #fff !important;\n    font-size: 19px;\n  }\n}\n.react-jinke-music-player-mobile-play-model-tip-title .loop-btn {\n  display: flex;\n}\n.react-jinke-music-player-mobile-play-model-tip-text {\n  font-size: 14px;\n}\n.react-jinke-music-player-mobile-play-model-tip.show {\n  transform: translateZ(0);\n}\n.react-jinke-music-player-mobile-header {\n  align-items: center;\n  animation: fromDown 0.35s cubic-bezier(0.43, -0.1, 0.16, 1.1) forwards;\n  display: flex;\n  justify-content: center;\n  left: 0;\n  position: relative;\n  top: 0;\n  width: 100%;\n}\n.react-jinke-music-player-mobile-header-title {\n  font-size: 20px;\n  overflow: hidden;\n  padding: 0 30px;\n  text-align: center;\n  text-overflow: ellipsis;\n  transition: color 0.35s cubic-bezier(0.43, -0.1, 0.16, 1.1);\n  white-space: nowrap;\n}\n.react-jinke-music-player-mobile-header .item {\n  display: inline-flex;\n  width: 50px;\n}\n.react-jinke-music-player-mobile-header-right {\n  color: hsla(0, 0%, 100%, 0.6);\n  cursor: pointer;\n  position: absolute;\n  right: 0;\n}\n.react-jinke-music-player-mobile-header-right svg {\n  font-size: 25px;\n}\n.react-jinke-music-player-mobile-singer {\n  animation: fromDown 0.35s cubic-bezier(0.43, -0.1, 0.16, 1.1) forwards;\n  padding: 12px 0;\n}\n@media screen and (max-width: 320px) {\n  .react-jinke-music-player-mobile-singer {\n    padding: 0;\n  }\n}\n.react-jinke-music-player-mobile-singer-name {\n  font-size: 14px;\n  position: relative;\n  transition: color 0.35s cubic-bezier(0.43, -0.1, 0.16, 1.1);\n}\n.react-jinke-music-player-mobile-singer-name:after,\n.react-jinke-music-player-mobile-singer-name:before {\n  background-color: hsla(0, 0%, 100%, 0.6);\n  border-radius: 2px;\n  content: "";\n  height: 1px;\n  position: absolute;\n  top: 9px;\n  transition: background-color 0.35s cubic-bezier(0.43, -0.1, 0.16, 1.1);\n  width: 16px;\n}\n.react-jinke-music-player-mobile-singer-name:after {\n  left: -25px;\n}\n.react-jinke-music-player-mobile-singer-name:before {\n  right: -25px;\n}\n.react-jinke-music-player-mobile-cover {\n  animation: fromTo 0.35s cubic-bezier(0.43, -0.1, 0.16, 1.1) forwards;\n  border: 5px solid rgba(0, 0, 0, 0.2);\n  border-radius: 50%;\n  box-shadow: 0 0 1px 3px rgba(0, 0, 0, 0.1);\n  height: 300px;\n  margin: 15px auto;\n  overflow: hidden;\n  transition: box-shadow, border 0.35s cubic-bezier(0.43, -0.1, 0.16, 1.1);\n  width: 300px;\n}\n@media screen and (max-width: 320px) {\n  .react-jinke-music-player-mobile-cover {\n    height: 230px;\n    margin: 10px auto;\n    width: 230px;\n  }\n}\n.react-jinke-music-player-mobile-cover .cover {\n  animation: imgRotate 30s linear infinite;\n  object-fit: cover;\n  width: 100%;\n}\n.react-jinke-music-player-mobile-progress {\n  align-items: center;\n  display: flex;\n  justify-content: space-around;\n}\n.react-jinke-music-player-mobile-progress .current-time,\n.react-jinke-music-player-mobile-progress .duration {\n  color: hsla(0, 0%, 100%, 0.6);\n  display: inline-flex;\n  font-size: 12px;\n  transition: color 0.35s cubic-bezier(0.43, -0.1, 0.16, 1.1);\n  width: 55px;\n}\n.react-jinke-music-player-mobile-progress .current-time {\n  margin-right: 5px;\n}\n.react-jinke-music-player-mobile-progress .duration {\n  justify-content: flex-end;\n  margin-left: 5px;\n}\n.react-jinke-music-player-mobile-progress .progress-bar {\n  flex: 1 1 auto;\n}\n.react-jinke-music-player-mobile-progress .rc-slider-rail {\n  background-color: hsla(0, 0%, 100%, 0.6);\n}\n.react-jinke-music-player-mobile-progress .rc-slider-handle,\n.react-jinke-music-player-mobile-progress .rc-slider-track {\n  background-color: #31c27c;\n}\n.react-jinke-music-player-mobile-progress .rc-slider-handle {\n  border: 2px solid #fff;\n}\n.react-jinke-music-player-mobile-progress .rc-slider-handle:active {\n  box-shadow: 0 0 2px #31c27c;\n}\n.react-jinke-music-player-mobile-progress-bar {\n  display: flex;\n  position: relative;\n  width: 100%;\n}\n.react-jinke-music-player-mobile-progress-bar .progress-load-bar {\n  background-color: rgba(0, 0, 0, 0.06);\n  height: 4px;\n  left: 0;\n  position: absolute;\n  top: 5px;\n  transition: width, background-color 0.35s cubic-bezier(0.43, -0.1, 0.16, 1.1);\n  width: 0;\n  z-index: 77;\n}\n.react-jinke-music-player-mobile-switch {\n  animation: fromDown 0.35s cubic-bezier(0.43, -0.1, 0.16, 1.1) forwards;\n}\n.react-jinke-music-player-mobile-toggle {\n  padding: 17px 0;\n}\n.react-jinke-music-player-mobile-toggle .group {\n  cursor: pointer;\n}\n.react-jinke-music-player-mobile-toggle .group svg {\n  font-size: 40px;\n}\n.react-jinke-music-player-mobile-toggle .play-btn {\n  padding: 0 40px;\n}\n.react-jinke-music-player-mobile-toggle .play-btn svg {\n  font-size: 45px;\n}\n.react-jinke-music-player-mobile-toggle .loading-icon {\n  padding: 0 40px;\n}\n@media screen and (max-width: 320px) {\n  .react-jinke-music-player-mobile-toggle {\n    padding: 10px 0;\n  }\n  .react-jinke-music-player-mobile-toggle > .group svg {\n    font-size: 32px;\n  }\n  .react-jinke-music-player-mobile-toggle .play-btn svg {\n    font-size: 40px;\n  }\n}\n.react-jinke-music-player-mobile-operation,\n.react-jinke-music-player-mobile-progress,\n.react-jinke-music-player-mobile-toggle {\n  animation: fromTo 0.35s cubic-bezier(0.43, -0.1, 0.16, 1.1) forwards;\n}\n.react-jinke-music-player-mobile-operation .items {\n  align-items: center;\n  display: flex;\n  justify-content: space-around;\n}\n.react-jinke-music-player-mobile-operation .items .item {\n  cursor: pointer;\n  flex: 1;\n  text-align: center;\n}\n.react-jinke-music-player-mobile-operation .items .item svg {\n  color: hsla(0, 0%, 100%, 0.6);\n}\n@keyframes mobile-bg-show {\n  0% {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n@keyframes mobile-bg-hide {\n  0% {\n    opacity: 1;\n  }\n  to {\n    opacity: 0;\n  }\n}\n.audio-lists-panel-sortable-highlight-bg {\n  background-color: rgba(49, 194, 124, 0.15) !important;\n}\n.audio-lists-panel {\n  background-color: rgba(0, 0, 0, 0.75);\n  border-radius: 4px 4px 0 0;\n  bottom: 80px;\n  color: hsla(0, 0%, 100%, 0.8);\n  display: none\\9;\n  height: 410px;\n  overflow: hidden;\n  position: fixed;\n  right: 33px;\n  transform: scale(0);\n  transform-origin: right bottom;\n  transition: background-color 0.35s cubic-bezier(0.43, -0.1, 0.16, 1.1);\n  width: 480px;\n  z-index: 999;\n}\n.audio-lists-panel svg {\n  font-size: 24px;\n}\n.audio-lists-panel.show {\n  animation: scaleTo 0.35s cubic-bezier(0.43, -0.1, 0.16, 1.1) forwards;\n  display: block\\9;\n}\n.audio-lists-panel.hide {\n  animation: scaleFrom 0.35s cubic-bezier(0.43, -0.1, 0.16, 1.1) forwards;\n  display: none\\9;\n}\n.audio-lists-panel-mobile {\n  background-color: rgba(0, 0, 0, 0.75);\n  border-radius: 0;\n  bottom: 0;\n  height: auto!important;\n  left: 0;\n  right: 0;\n  top: 0;\n  transform-origin: bottom center;\n  width: 100% !important;\n}\n.audio-lists-panel-mobile.show {\n  animation: fromTo 0.35s cubic-bezier(0.43, -0.1, 0.16, 1.1) forwards;\n  display: block\\9;\n}\n.audio-lists-panel-mobile.hide {\n  animation: fromOut 0.35s cubic-bezier(0.43, -0.1, 0.16, 1.1) forwards;\n  display: none\\9;\n}\n.audio-lists-panel-mobile .audio-item:not(.audio-lists-panel-sortable-highlight-bg) {\n  background-color: rgba(0, 0, 0, 0.15) !important;\n}\n.audio-lists-panel-mobile .audio-item:not(.audio-lists-panel-sortable-highlight-bg).playing {\n  background-color: rgba(0, 0, 0, 0.75) !important;\n}\n.audio-lists-panel-mobile .audio-lists-panel-content {\n  -webkit-overflow-scrolling: touch;\n  height: calc(100vh - 50px) !important;\n  transform-origin: bottom center;\n  width: 100% !important;\n}\n.audio-lists-panel-header {\n  border-bottom: 1px solid rgba(3, 3, 3, 0.75);\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);\n  text-shadow: 0 1px 1px rgba(0, 0, 0, 0.1);\n  transition: background-color, border-bottom 0.35s cubic-bezier(0.43, -0.1, 0.16, 1.1);\n}\n.audio-lists-panel-header-close-btn,\n.audio-lists-panel-header-delete-btn {\n  cursor: pointer;\n  display: flex;\n}\n.audio-lists-panel-header-delete-btn svg {\n  font-size: 21px;\n}\n@media screen and (max-width: 767px) {\n  .audio-lists-panel-header-delete-btn svg {\n    font-size: 19px;\n  }\n}\n@media screen and (min-width: 768px) {\n  .audio-lists-panel-header-close-btn:hover svg {\n    animation: imgRotate 0.35s cubic-bezier(0.43, -0.1, 0.16, 1.1);\n  }\n}\n.audio-lists-panel-header-line {\n  background: #fff;\n  height: 20px;\n  margin: 0 10px;\n  width: 1px;\n}\n.audio-lists-panel-header-title {\n  align-items: center;\n  display: flex;\n  font-size: 16px;\n  font-weight: 500;\n  height: 50px;\n  margin: 0;\n  padding: 0 20px;\n  text-align: left;\n  transition: color 0.35s cubic-bezier(0.43, -0.1, 0.16, 1.1);\n}\n.audio-lists-panel-header-num {\n  margin-left: 10px;\n}\n.audio-lists-panel-header-actions {\n  align-items: center;\n  display: flex;\n  flex-grow: 1;\n  justify-content: flex-end;\n}\n.audio-lists-panel-content {\n  height: 359px;\n  overflow-x: hidden;\n  overflow-y: auto;\n}\n.audio-lists-panel-content.no-content {\n  align-items: center;\n  display: flex;\n  justify-content: center;\n}\n.audio-lists-panel-content.no-content > span {\n  display: flex;\n}\n.audio-lists-panel-content .no-data {\n  margin-left: 10px;\n}\n.audio-lists-panel-content .audio-item {\n  align-items: center;\n  border-bottom: 1px solid transparent;\n  cursor: pointer;\n  display: flex;\n  font-size: 14px;\n  justify-content: space-between;\n  line-height: 40px;\n  padding: 3px 20px;\n  transition: background-color 0.35s cubic-bezier(0.43, -0.1, 0.16, 1.1);\n}\n.audio-lists-panel-content .audio-item:nth-child(odd) {\n  background-color: rgba(0, 0, 0, 0.1);\n}\n.audio-lists-panel-content .audio-item.playing {\n  background-color: rgba(0, 0, 0, 0.35);\n}\n.audio-lists-panel-content .audio-item.playing,\n.audio-lists-panel-content .audio-item.playing svg {\n  color: #31c27c;\n}\n.audio-lists-panel-content .audio-item.remove {\n  animation: remove 0.35s cubic-bezier(0.43, -0.1, 0.16, 1.1) forwards;\n}\n.audio-lists-panel-content .audio-item .player-icons {\n  display: inline-flex;\n  width: 30px;\n}\n.audio-lists-panel-content .audio-item .player-icons .loading {\n  animation: audioLoading 1s linear infinite;\n}\n.audio-lists-panel-content .audio-item:active,\n.audio-lists-panel-content .audio-item:hover {\n  background-color: rgba(0, 0, 0, 0.35);\n}\n.audio-lists-panel-content .audio-item:active .group:not([class=".player-delete"]) svg,\n.audio-lists-panel-content .audio-item:hover .group:not([class=".player-delete"]) svg {\n  color: #31c27c;\n}\n.audio-lists-panel-content .audio-item .group {\n  display: inline-flex;\n}\n.audio-lists-panel-content .audio-item .player-name {\n  flex: 1;\n  padding: 0 20px 0 10px;\n}\n.audio-lists-panel-content .audio-item .player-name,\n.audio-lists-panel-content .audio-item .player-singer {\n  display: inline-block;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  transition: color 0.35s cubic-bezier(0.43, -0.1, 0.16, 1.1);\n  white-space: nowrap;\n}\n.audio-lists-panel-content .audio-item .player-singer {\n  font-size: 12px;\n  width: 85px;\n}\n.audio-lists-panel-content .audio-item .player-delete {\n  justify-content: flex-end;\n  text-align: right;\n  width: 30px;\n}\n.audio-lists-panel-content .audio-item .player-delete:hover svg {\n  animation: imgRotate 0.35s cubic-bezier(0.43, -0.1, 0.16, 1.1);\n}\n.react-jinke-music-player-main {\n  font-family: inherit;\n  touch-action: none;\n}\n.react-jinke-music-player-main ::-webkit-scrollbar-thumb {\n  background-color: #31c27c;\n  height: 20px;\n  opacity: 0.5;\n}\n.react-jinke-music-player-main ::-webkit-scrollbar {\n  background-color: #f7f8fa;\n  width: 8px;\n}\n.react-jinke-music-player-main .rc-switch:focus {\n  box-shadow: none;\n}\n.react-jinke-music-player-main .lyric-btn svg {\n  font-size: 20px;\n}\n.react-jinke-music-player-main .lyric-btn-active,\n.react-jinke-music-player-main .lyric-btn-active svg {\n  color: #31c27c !important;\n}\n.react-jinke-music-player-main .music-player-lyric {\n  background: transparent;\n  bottom: 100px;\n  color: #31c27c;\n  cursor: move;\n  font-size: 36px;\n  left: 0;\n  position: fixed;\n  text-align: center;\n  text-shadow: 0 1px 1px hsla(0, 0%, 100%, 0.05);\n  transition: box-shadow 0.35s cubic-bezier(0.43, -0.1, 0.16, 1.1);\n  width: 100%;\n  z-index: 998;\n}\n@media screen and (max-width: 767px) {\n  .react-jinke-music-player-main .music-player-lyric {\n    font-size: 16px;\n    z-index: 999;\n  }\n}\n.react-jinke-music-player-main .play-mode-title {\n  background-color: rgba(0, 0, 0, 0.5);\n  bottom: 80px;\n  color: #fff;\n  line-height: 1.5;\n  opacity: 0;\n  padding: 5px 20px;\n  pointer-events: none;\n  position: fixed;\n  right: 72px;\n  text-align: center;\n  transform: translate3d(100%, 0, 0);\n  transform-origin: bottom center;\n  transition: all 0.35s cubic-bezier(0.43, -0.1, 0.16, 1.1);\n  user-select: none;\n  visibility: hidden;\n  z-index: 1000;\n}\n.react-jinke-music-player-main .play-mode-title.play-mode-title-visible {\n  opacity: 1;\n  pointer-events: all;\n  transform: translateZ(0);\n  visibility: visible;\n}\n.react-jinke-music-player-main .glass-bg-container {\n  background-position: 50%;\n  background-repeat: no-repeat;\n  background-size: cover;\n  filter: blur(80px);\n  height: 300%;\n  left: 0;\n  position: absolute;\n  top: 0;\n  width: 300%;\n  z-index: -1;\n}\n.react-jinke-music-player-main .glass-bg {\n  backdrop-filter: blur(10px);\n}\n.react-jinke-music-player-main svg {\n  font-size: 24px;\n  transition: color 0.35s cubic-bezier(0.43, -0.1, 0.16, 1.1);\n}\n.react-jinke-music-player-main svg:active,\n.react-jinke-music-player-main svg:hover {\n  color: #31c27c;\n}\n@media screen and (max-width: 767px) {\n  .react-jinke-music-player-main svg {\n    font-size: 22px;\n  }\n}\n.react-jinke-music-player-main .react-jinke-music-player-mode-icon {\n  animation: scaleTo 0.35s cubic-bezier(0.43, -0.1, 0.16, 1.1);\n}\n.react-jinke-music-player-main .music-player-panel {\n  background-color: rgba(0, 0, 0, 0.75);\n  bottom: 0;\n  box-shadow: 0 0 3px #403f3f;\n  color: #fff;\n  height: 80px;\n  left: 0;\n  position: fixed;\n  transition: background-color 0.35s cubic-bezier(0.43, -0.1, 0.16, 1.1);\n  width: 100%;\n  z-index: 99;\n}\n.react-jinke-music-player-main .music-player-panel .panel-content {\n  align-items: center;\n  display: flex;\n  height: 100%;\n  justify-content: center;\n  overflow: hidden;\n  padding: 0 30px;\n  position: relative;\n}\n.react-jinke-music-player-main .music-player-panel .panel-content .rc-slider-rail {\n  background-color: hsla(0, 0%, 100%, 0.6);\n}\n.react-jinke-music-player-main .music-player-panel .panel-content .rc-slider-handle,\n.react-jinke-music-player-main .music-player-panel .panel-content .rc-slider-track {\n  background-color: #31c27c;\n}\n.react-jinke-music-player-main .music-player-panel .panel-content .rc-slider-handle {\n  border: 2px solid #fff;\n}\n.react-jinke-music-player-main .music-player-panel .panel-content .rc-slider-handle:active {\n  box-shadow: 0 0 2px #31c27c;\n}\n.react-jinke-music-player-main .music-player-panel .panel-content .img-content {\n  background-repeat: no-repeat;\n  background-size: 100%;\n  border-radius: 50%;\n  box-shadow: 0 0 10px rgba(0, 34, 77, 0.05);\n  cursor: pointer;\n  height: 50px;\n  overflow: hidden;\n  width: 50px;\n}\n@media screen and (max-width: 767px) {\n  .react-jinke-music-player-main .music-player-panel .panel-content .img-content {\n    height: 40px;\n    width: 40px;\n  }\n}\n.react-jinke-music-player-main .music-player-panel .panel-content .img-content img {\n  width: 100%;\n}\n.react-jinke-music-player-main .music-player-panel .panel-content .img-rotate {\n  animation: imgRotate 15s linear infinite;\n}\n.react-jinke-music-player-main .music-player-panel .panel-content .hide-panel,\n.react-jinke-music-player-main .music-player-panel .panel-content .upload-music {\n  cursor: pointer;\n  flex-basis: 10%;\n  margin-left: 15px;\n}\n@media screen and (max-width: 767px) {\n  .react-jinke-music-player-main .music-player-panel .panel-content .progress-bar-content {\n    display: none !important;\n  }\n}\n.react-jinke-music-player-main .music-player-panel .panel-content .progress-bar-content {\n  flex: 1;\n  overflow: hidden;\n  padding: 0 20px;\n}\n.react-jinke-music-player-main .music-player-panel .panel-content .progress-bar-content .audio-title {\n  display: inline-block;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  transition: color 0.35s cubic-bezier(0.43, -0.1, 0.16, 1.1);\n  white-space: nowrap;\n  width: 100%;\n}\n.react-jinke-music-player-main .music-player-panel .panel-content .progress-bar-content .audio-main {\n  display: inline-flex;\n  justify-content: center;\n  margin-top: 6px;\n  width: 100%;\n}\n.react-jinke-music-player-main .music-player-panel .panel-content .progress-bar-content .audio-main .current-time,\n.react-jinke-music-player-main .music-player-panel .panel-content .progress-bar-content .audio-main .duration {\n  flex-basis: 5%;\n  font-size: 12px;\n  transition: color 0.35s cubic-bezier(0.43, -0.1, 0.16, 1.1);\n}\n.react-jinke-music-player-main .music-player-panel .panel-content .progress-bar-content .progress-bar {\n  flex: 1 1 auto;\n  margin: 2px 20px 0;\n  position: relative;\n  width: 100%;\n}\n.react-jinke-music-player-main .music-player-panel .panel-content .progress-bar-content .progress-bar .progress {\n  background: linear-gradient(135deg, transparent, transparent 31%, rgba(0, 0, 0, 0.05) 33%, rgba(0, 0, 0, 0.05) 67%, transparent 69%);\n  background-color: #31c27c;\n  display: inline-block;\n  height: 5px;\n  left: 0;\n  position: absolute;\n  top: 0;\n  transition: width 0.35s cubic-bezier(0.43, -0.1, 0.16, 1.1);\n}\n.react-jinke-music-player-main .music-player-panel .panel-content .progress-bar-content .progress-bar .progress .progress-change {\n  background-color: #fff;\n  border-radius: 50%;\n  bottom: -2px;\n  box-shadow: 0 0 2px rgba(0, 0, 0, 0.4);\n  cursor: pointer;\n  height: 10px;\n  position: absolute;\n  right: 0;\n  width: 10px;\n}\n.react-jinke-music-player-main .music-player-panel .panel-content .progress-bar-content .progress-bar .progress-load-bar {\n  background-color: rgba(0, 0, 0, 0.11);\n  border-radius: 6px;\n  height: 4px;\n  left: 0;\n  position: absolute;\n  top: 5px;\n  transition: width, background-color 0.35s cubic-bezier(0.43, -0.1, 0.16, 1.1);\n  width: 0;\n  z-index: 77;\n}\n.react-jinke-music-player-main .music-player-panel .panel-content .progress-bar-content .progress-bar .rc-slider-track {\n  z-index: 78;\n}\n.react-jinke-music-player-main .music-player-panel .panel-content .progress-bar-content .progress-bar .rc-slider-handle {\n  z-index: 79;\n}\n.react-jinke-music-player-main .music-player-panel .panel-content .player-content {\n  align-content: center;\n  align-items: center;\n  display: inline-flex;\n  flex-basis: 15%;\n  padding-left: 5%;\n}\n.react-jinke-music-player-main .music-player-panel .panel-content .player-content > .group {\n  align-items: center;\n  display: inline-flex;\n  flex: 1;\n  justify-content: center;\n  margin: 0 10px;\n  text-align: center;\n}\n.react-jinke-music-player-main .music-player-panel .panel-content .player-content > .group,\n.react-jinke-music-player-main .music-player-panel .panel-content .player-content > .group > svg {\n  cursor: pointer;\n}\n.react-jinke-music-player-main .music-player-panel .panel-content .player-content > .group .group {\n  display: flex;\n}\n@media screen and (max-width: 767px) {\n  .react-jinke-music-player-main .music-player-panel .panel-content .player-content > .group {\n    margin: 0 6px;\n  }\n}\n@media screen and (max-width: 320px) {\n  .react-jinke-music-player-main .music-player-panel .panel-content .player-content > .group {\n    margin: 0 4px;\n  }\n}\n.react-jinke-music-player-main .music-player-panel .panel-content .player-content > .group > i {\n  color: #31c27c;\n  cursor: pointer;\n  font-size: 25px;\n  vertical-align: middle;\n}\n.react-jinke-music-player-main .music-player-panel .panel-content .player-content .theme-switch .rc-switch {\n  background-color: transparent;\n}\n@media screen and (max-width: 767px) {\n  .react-jinke-music-player-main .music-player-panel .panel-content .player-content .play-sounds {\n    display: none !important;\n  }\n}\n.react-jinke-music-player-main .music-player-panel .panel-content .player-content .next-audio svg,\n.react-jinke-music-player-main .music-player-panel .panel-content .player-content .prev-audio svg {\n  font-size: 35px;\n}\n.react-jinke-music-player-main .music-player-panel .panel-content .player-content .loading-icon,\n.react-jinke-music-player-main .music-player-panel .panel-content .player-content .play-btn {\n  padding: 0 18px;\n}\n.react-jinke-music-player-main .music-player-panel .panel-content .player-content .play-btn svg {\n  font-size: 26px;\n}\n.react-jinke-music-player-main .music-player-panel .panel-content .player-content .loop-btn.active {\n  color: #31c27c;\n}\n.react-jinke-music-player-main .music-player-panel .panel-content .player-content .play-sounds {\n  align-items: center;\n}\n.react-jinke-music-player-main .music-player-panel .panel-content .player-content .play-sounds svg {\n  font-size: 28px;\n}\n.react-jinke-music-player-main .music-player-panel .panel-content .player-content .play-sounds .sounds-icon {\n  display: flex;\n  flex: 1 1 auto;\n  margin-right: 15px;\n}\n.react-jinke-music-player-main .music-player-panel .panel-content .player-content .play-sounds .sound-operation {\n  width: 100px;\n}\n.react-jinke-music-player-main .music-player-panel .panel-content .player-content .destroy-btn svg {\n  font-size: 28px;\n}\n.react-jinke-music-player-main .music-player-panel .panel-content .player-content .audio-lists-btn {\n  background-color: rgba(0, 0, 0, 0.3);\n  border-radius: 40px;\n  box-shadow: 0 0 1px 1px hsla(0, 0%, 100%, 0.02);\n  height: 28px;\n  min-width: 60px;\n  padding: 0 10px;\n  position: relative;\n  transition: color, background-color 0.35s cubic-bezier(0.43, -0.1, 0.16, 1.1);\n  user-select: none;\n}\n.react-jinke-music-player-main .music-player-panel .panel-content .player-content .audio-lists-btn .audio-lists-icon {\n  display: flex;\n}\n.react-jinke-music-player-main .music-player-panel .panel-content .player-content .audio-lists-btn > .group:hover,\n.react-jinke-music-player-main .music-player-panel .panel-content .player-content .audio-lists-btn > .group:hover > svg {\n  color: #31c27c;\n}\n.react-jinke-music-player-main .music-player-panel .panel-content .player-content .audio-lists-btn .audio-lists-num {\n  margin-left: 8px;\n}\n.react-jinke-music-player-main .music-player-panel .rc-switch-inner svg {\n  font-size: 13px;\n}\n.react-jinke-music-player-main .rc-slider-rail {\n  background-color: #fff !important;\n  transition: background-color 0.35s cubic-bezier(0.43, -0.1, 0.16, 1.1);\n}\n.react-jinke-music-player-main.light-theme svg {\n  color: #31c27c;\n}\n.react-jinke-music-player-main.light-theme svg:active,\n.react-jinke-music-player-main.light-theme svg:hover {\n  color: #3ece89;\n}\n.react-jinke-music-player-main.light-theme .rc-slider-rail {\n  background-color: rgba(0, 0, 0, 0.09) !important;\n}\n.react-jinke-music-player-main.light-theme .music-player-controller {\n  background-color: #fff;\n  border-color: #fff;\n}\n.react-jinke-music-player-main.light-theme .music-player-panel {\n  background-color: #fff;\n  box-shadow: 0 1px 2px 0 rgba(0, 34, 77, 0.05);\n  color: #7d7d7d;\n}\n.react-jinke-music-player-main.light-theme .music-player-panel .img-content {\n  box-shadow: 0 0 10px #dcdcdc;\n}\n.react-jinke-music-player-main.light-theme .music-player-panel .progress-load-bar {\n  background-color: rgba(0, 0, 0, 0.06) !important;\n}\n.react-jinke-music-player-main.light-theme .rc-switch {\n  color: #fff;\n}\n.react-jinke-music-player-main.light-theme .rc-switch:after {\n  background-color: #fff;\n}\n.react-jinke-music-player-main.light-theme .rc-switch-checked {\n  background-color: #31c27c !important;\n  border: 1px solid #31c27c;\n}\n.react-jinke-music-player-main.light-theme .rc-switch-inner {\n  color: #fff;\n}\n.react-jinke-music-player-main.light-theme .audio-lists-btn {\n  background-color: #f7f8fa !important;\n}\n.react-jinke-music-player-main.light-theme .audio-lists-btn:active,\n.react-jinke-music-player-main.light-theme .audio-lists-btn:hover {\n  background-color: #fdfdfe;\n  color: #444;\n}\n.react-jinke-music-player-main.light-theme .audio-lists-btn > .group:hover,\n.react-jinke-music-player-main.light-theme .audio-lists-btn > .group:hover > svg {\n  color: #444;\n}\n.react-jinke-music-player-main.light-theme .audio-lists-panel {\n  background-color: #fff;\n  box-shadow: 0 0 2px #dcdcdc;\n  color: #444;\n}\n.react-jinke-music-player-main.light-theme .audio-lists-panel .audio-item {\n  background-color: #fff;\n}\n.react-jinke-music-player-main.light-theme .audio-lists-panel .audio-item:nth-child(odd) {\n  background-color: #fafafa !important;\n}\n.react-jinke-music-player-main.light-theme .audio-lists-panel .audio-item.playing {\n  background-color: #f2f2f2 !important;\n}\n.react-jinke-music-player-main.light-theme .audio-lists-panel .audio-item.playing,\n.react-jinke-music-player-main.light-theme .audio-lists-panel .audio-item.playing svg {\n  color: #31c27c !important;\n}\n@media screen and (max-width: 767px) {\n  .react-jinke-music-player-main.light-theme .audio-lists-panel .audio-item {\n    background-color: #fff !important;\n  }\n  .react-jinke-music-player-main.light-theme .audio-lists-panel .audio-item.playing {\n    background-color: #f2f2f2 !important;\n  }\n  .react-jinke-music-player-main.light-theme .audio-lists-panel .audio-item.playing,\n  .react-jinke-music-player-main.light-theme .audio-lists-panel .audio-item.playing svg {\n    color: #31c27c !important;\n  }\n}\n.react-jinke-music-player-main.light-theme .audio-lists-panel-header {\n  background-color: #fff;\n  border-bottom: 1px solid #f4f4f7;\n  color: #444;\n}\n.react-jinke-music-player-main.light-theme .audio-lists-panel-header-line {\n  background-color: #f4f4f7;\n}\n.react-jinke-music-player-main.light-theme .audio-item {\n  background-color: rgba(64, 68, 75, 0.65);\n  border-bottom: 1px solid hsla(0, 0%, 86.3%, 0.26);\n  box-shadow: 0 0 2px transparent !important;\n}\n.react-jinke-music-player-main.light-theme .audio-item:active,\n.react-jinke-music-player-main.light-theme .audio-item:hover {\n  background-color: #fafafa !important;\n}\n.react-jinke-music-player-main.light-theme .audio-item:active svg,\n.react-jinke-music-player-main.light-theme .audio-item:hover svg {\n  color: #31c27c;\n}\n.react-jinke-music-player-main.light-theme .audio-item.playing {\n  background-color: #fafafa !important;\n}\n.react-jinke-music-player-main.light-theme .audio-item.playing svg {\n  color: #31c27c;\n}\n.react-jinke-music-player-main.light-theme .audio-item.playing .player-singer {\n  color: #31c27c !important;\n}\n.react-jinke-music-player-main.light-theme .audio-item .player-singer {\n  color: hsla(0, 0%, 63.5%, 0.45) !important;\n}\n.react-jinke-music-player-main.light-theme .react-jinke-music-player-mobile {\n  background-color: #fff;\n  color: #444;\n}\n.react-jinke-music-player-main.light-theme .react-jinke-music-player-mobile-cover {\n  border: 5px solid transparent;\n  box-shadow: 0 0 30px 2px rgba(0, 0, 0, 0.2);\n}\n.react-jinke-music-player-main.light-theme .react-jinke-music-player-mobile .current-time,\n.react-jinke-music-player-main.light-theme .react-jinke-music-player-mobile .duration {\n  color: #444;\n}\n.react-jinke-music-player-main.light-theme .react-jinke-music-player-mobile .rc-slider-rail {\n  background-color: #e9e9e9;\n}\n.react-jinke-music-player-main.light-theme .react-jinke-music-player-mobile-operation svg {\n  color: #444;\n}\n.react-jinke-music-player-main.light-theme .react-jinke-music-player-mobile-tip svg {\n  color: #fff !important;\n}\n.react-jinke-music-player-main.light-theme .react-jinke-music-player-mobile-singer-name {\n  color: #444;\n  transition: color 0.35s cubic-bezier(0.43, -0.1, 0.16, 1.1);\n}\n.react-jinke-music-player-main.light-theme .react-jinke-music-player-mobile-singer-name:after,\n.react-jinke-music-player-main.light-theme .react-jinke-music-player-mobile-singer-name:before {\n  background-color: #444;\n}\n.react-jinke-music-player-main.light-theme .play-mode-title {\n  background-color: #fff;\n  color: #31c27c;\n}\n.react-jinke-music-player {\n  height: 80px;\n  position: fixed;\n  width: 80px;\n  z-index: 999;\n}\n@media screen and (max-width: 767px) {\n  .react-jinke-music-player {\n    height: 60px;\n    width: 60px;\n  }\n}\n.react-jinke-music-player:focus {\n  outline: none;\n}\n.react-jinke-music-player .music-player {\n  cursor: pointer;\n  height: 80px;\n  position: relative;\n  width: 80px;\n}\n@media screen and (max-width: 767px) {\n  .react-jinke-music-player .music-player {\n    height: 60px;\n    width: 60px;\n  }\n}\n.react-jinke-music-player .music-player:focus {\n  outline: none;\n}\n.react-jinke-music-player .music-player-audio {\n  display: none !important;\n}\n.react-jinke-music-player .music-player .destroy-btn {\n  position: absolute;\n  right: 0;\n  top: 0;\n  z-index: 100;\n}\n@media screen and (max-width: 767px) {\n  .react-jinke-music-player .music-player .destroy-btn {\n    right: -3px;\n  }\n}\n.react-jinke-music-player .music-player-controller {\n  align-items: center;\n  background-color: #e6e6e6;\n  background-repeat: no-repeat;\n  background-size: 100%;\n  border: 1px solid #e6e6e6;\n  border-radius: 50%;\n  box-shadow: 0 0 10px rgba(0, 0, 0, 0.15);\n  color: #31c27c;\n  cursor: pointer;\n  display: flex;\n  font-size: 20px;\n  height: 80px;\n  justify-content: center;\n  padding: 10px;\n  position: fixed;\n  text-align: center;\n  transition: all 0.3s cubic-bezier(0.43, -0.1, 0.16, 1.1);\n  width: 80px;\n  z-index: 99;\n}\n.react-jinke-music-player .music-player-controller:focus {\n  outline: none;\n}\n.react-jinke-music-player .music-player-controller.music-player-playing:before {\n  animation: scale 5s linear infinite;\n  border: 1px solid hsla(0, 0%, 100%, 0.2);\n  border-radius: 50%;\n  content: "";\n  cursor: pointer;\n  height: 80px;\n  position: fixed;\n  width: 80px;\n  z-index: -1;\n}\n@media screen and (max-width: 767px) {\n  .react-jinke-music-player .music-player-controller {\n    height: 60px;\n    width: 60px;\n  }\n  .react-jinke-music-player .music-player-controller.music-player-playing:before {\n    height: 60px;\n    width: 60px;\n  }\n}\n.react-jinke-music-player .music-player-controller i {\n  font-size: 28px;\n}\n.react-jinke-music-player .music-player-controller:active {\n  box-shadow: 0 0 30px rgba(0, 0, 0, 0.2);\n}\n.react-jinke-music-player .music-player-controller:hover {\n  font-size: 16px;\n}\n.react-jinke-music-player .music-player-controller:hover .music-player-controller-setting {\n  transform: scale(1);\n}\n.react-jinke-music-player .music-player-controller .controller-title {\n  font-size: 14px;\n}\n@media screen and (max-width: 767px) {\n  .react-jinke-music-player .music-player-controller i {\n    font-size: 20px;\n  }\n  .react-jinke-music-player .music-player-controller:active,\n  .react-jinke-music-player .music-player-controller:hover {\n    font-size: 12px;\n  }\n  .react-jinke-music-player .music-player-controller:active .music-player-controller-setting,\n  .react-jinke-music-player .music-player-controller:hover .music-player-controller-setting {\n    transform: scale(1);\n  }\n}\n.react-jinke-music-player .music-player-controller .music-player-controller-setting {\n  align-items: center;\n  background: rgba(49, 194, 124, 0.3);\n  border-radius: 50%;\n  color: #fff;\n  display: flex;\n  height: 100%;\n  justify-content: center;\n  left: 0;\n  position: absolute;\n  top: 0;\n  transform: scale(0);\n  transition: all 0.4s cubic-bezier(0.43, -0.1, 0.16, 1.1);\n  width: 100%;\n}\n.react-jinke-music-player .audio-circle-process-bar {\n  stroke-width: 3px;\n  stroke-linejoin: round;\n  animation: scaleTo 0.35s cubic-bezier(0.43, -0.1, 0.16, 1.1);\n  height: 80px;\n  left: 0;\n  pointer-events: none;\n  position: absolute;\n  top: -80px;\n  width: 80px;\n  z-index: 100;\n}\n.react-jinke-music-player .audio-circle-process-bar circle[class=bg] {\n  stroke: #fff;\n}\n.react-jinke-music-player .audio-circle-process-bar circle[class=stroke] {\n  stroke: #31c27c;\n}\n.react-jinke-music-player .audio-circle-process-bar,\n.react-jinke-music-player .audio-circle-process-bar circle {\n  transform: matrix(0, -1, 1, 0, 0, 80);\n  transition: stroke-dasharray 0.35s cubic-bezier(0.43, -0.1, 0.16, 1.1);\n}\n@media screen and (max-width: 767px) {\n  .react-jinke-music-player .audio-circle-process-bar,\n  .react-jinke-music-player .audio-circle-process-bar circle {\n    transform: matrix(0, -1, 1, 0, 0, 60);\n  }\n}\n',""]);const o=a},9202:(e,t,n)=>{"use strict";var i=n(181);e.exports=function(e){if(!i(e))return!1;try{return!!e.constructor&&e.constructor.prototype===e}catch(e){return!1}}},9206:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(3575);t.default=class{constructor(e){this.interactive="",this.fixedLayout="",this.openToSpread="",this.orientationLock="",e&&this.parse(e)}parse(e){if(!e)return this;const t=(0,i.qs)(e,"display_options");return t?((0,i.qsa)(t,"option").forEach(e=>{let t="";switch(e.childNodes.length&&(t=e.childNodes[0].nodeValue),e.attributes.name.value){case"interactive":this.interactive=t;break;case"fixed-layout":this.fixedLayout=t;break;case"open-to-spread":this.openToSpread=t;break;case"orientation-lock":this.orientationLock=t}}),this):this}destroy(){this.interactive=void 0,this.fixedLayout=void 0,this.openToSpread=void 0,this.orientationLock=void 0}}},9325:(e,t,n)=>{var i=n(4840),r="object"==typeof self&&self&&self.Object===Object&&self,s=i||r||Function("return this")();e.exports=s},9350:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},9374:(e,t,n)=>{var i=n(4128),r=n(3805),s=n(4394),a=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,l=/^0o[0-7]+$/i,c=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(s(e))return NaN;if(r(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=r(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=i(e);var n=o.test(e);return n||l.test(e)?c(e.slice(2),n?2:8):a.test(e)?NaN:+e}},9732:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=u(n(9047)),r=u(n(4064)),s=u(n(4166)),a=u(n(4216)),o=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=c(t);if(n&&n.has(e))return n.get(e);var i={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var a=r?Object.getOwnPropertyDescriptor(e,s):null;a&&(a.get||a.set)?Object.defineProperty(i,s,a):i[s]=e[s]}return i.default=e,n&&n.set(e,i),i}(n(3575)),l=n(4083);function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(c=function(e){return e?n:t})(e)}function u(e){return e&&e.__esModule?e:{default:e}}function h(e,t){return new i.default(e,t)}u(n(8598)),u(n(7983)),u(n(721)),h.VERSION=l.EPUBJS_VERSION,void 0!==n.g&&(n.g.EPUBJS_VERSION=l.EPUBJS_VERSION),h.Book=i.default,h.Rendition=r.default,h.Contents=a.default,h.CFI=s.default,h.utils=o;var d=h;t.default=d},9762:(e,t,n)=>{"use strict";var i=n(6011)();e.exports=function(e){return e!==i&&null!==e}},9932:(e,t,n)=>{e.exports=function e(t,n,i){function r(a,o){if(!n[a]){if(!t[a]){if(s)return s(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[a]={exports:{}};t[a][0].call(c.exports,function(e){return r(t[a][1][e]||e)},c,c.exports,e,t,n,i)}return n[a].exports}for(var s=void 0,a=0;a<i.length;a++)r(i[a]);return r}({1:[function(e,t,n){"use strict";var i=e("./utils"),r=e("./support"),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.encode=function(e){for(var t,n,r,a,o,l,c,u=[],h=0,d=e.length,f=d,p="string"!==i.getTypeOf(e);h<e.length;)f=d-h,p?(t=e[h++],n=h<d?e[h++]:0,r=h<d?e[h++]:0):(t=e.charCodeAt(h++),n=h<d?e.charCodeAt(h++):0,r=h<d?e.charCodeAt(h++):0),a=t>>2,o=(3&t)<<4|n>>4,l=f>1?(15&n)<<2|r>>6:64,c=f>2?63&r:64,u.push(s.charAt(a)+s.charAt(o)+s.charAt(l)+s.charAt(c));return u.join("")},n.decode=function(e){var t,n,i,a,o,l,c=0,u=0,h="data:";if(e.substr(0,5)===h)throw new Error("Invalid base64 input, it looks like a data url.");var d,f=3*(e=e.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(e.charAt(e.length-1)===s.charAt(64)&&f--,e.charAt(e.length-2)===s.charAt(64)&&f--,f%1!=0)throw new Error("Invalid base64 input, bad content length.");for(d=r.uint8array?new Uint8Array(0|f):new Array(0|f);c<e.length;)t=s.indexOf(e.charAt(c++))<<2|(a=s.indexOf(e.charAt(c++)))>>4,n=(15&a)<<4|(o=s.indexOf(e.charAt(c++)))>>2,i=(3&o)<<6|(l=s.indexOf(e.charAt(c++))),d[u++]=t,64!==o&&(d[u++]=n),64!==l&&(d[u++]=i);return d}},{"./support":30,"./utils":32}],2:[function(e,t,n){"use strict";var i=e("./external"),r=e("./stream/DataWorker"),s=e("./stream/Crc32Probe"),a=e("./stream/DataLengthProbe");function o(e,t,n,i,r){this.compressedSize=e,this.uncompressedSize=t,this.crc32=n,this.compression=i,this.compressedContent=r}o.prototype={getContentWorker:function(){var e=new r(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new a("data_length")),t=this;return e.on("end",function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),e},getCompressedWorker:function(){return new r(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},o.createWorkerFrom=function(e,t,n){return e.pipe(new s).pipe(new a("uncompressedSize")).pipe(t.compressWorker(n)).pipe(new a("compressedSize")).withStreamInfo("compression",t)},t.exports=o},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,t,n){"use strict";var i=e("./stream/GenericWorker");n.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},n.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,t,n){"use strict";var i=e("./utils");var r=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();t.exports=function(e,t){return void 0!==e&&e.length?"string"!==i.getTypeOf(e)?function(e,t,n,i){var s=r,a=i+n;e^=-1;for(var o=i;o<a;o++)e=e>>>8^s[255&(e^t[o])];return-1^e}(0|t,e,e.length,0):function(e,t,n,i){var s=r,a=i+n;e^=-1;for(var o=i;o<a;o++)e=e>>>8^s[255&(e^t.charCodeAt(o))];return-1^e}(0|t,e,e.length,0):0}},{"./utils":32}],5:[function(e,t,n){"use strict";n.base64=!1,n.binary=!1,n.dir=!1,n.createFolders=!0,n.date=null,n.compression=null,n.compressionOptions=null,n.comment=null,n.unixPermissions=null,n.dosPermissions=null},{}],6:[function(e,t,n){"use strict";var i;i="undefined"!=typeof Promise?Promise:e("lie"),t.exports={Promise:i}},{lie:37}],7:[function(e,t,n){"use strict";var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,r=e("pako"),s=e("./utils"),a=e("./stream/GenericWorker"),o=i?"uint8array":"array";function l(e,t){a.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}n.magic="\b\0",s.inherits(l,a),l.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(s.transformTo(o,e.data),!1)},l.prototype.flush=function(){a.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},l.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this._pako=null},l.prototype._createPako=function(){this._pako=new r[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(t){e.push({data:t,meta:e.meta})}},n.compressWorker=function(e){return new l("Deflate",e)},n.uncompressWorker=function(){return new l("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,t,n){"use strict";var i=e("../utils"),r=e("../stream/GenericWorker"),s=e("../utf8"),a=e("../crc32"),o=e("../signature"),l=function(e,t){var n,i="";for(n=0;n<t;n++)i+=String.fromCharCode(255&e),e>>>=8;return i},c=function(e,t,n,r,c,u){var h,d,f=e.file,p=e.compression,g=u!==s.utf8encode,m=i.transformTo("string",u(f.name)),v=i.transformTo("string",s.utf8encode(f.name)),y=f.comment,b=i.transformTo("string",u(y)),E=i.transformTo("string",s.utf8encode(y)),S=v.length!==f.name.length,w=E.length!==y.length,T="",k="",_="",x=f.dir,L=f.date,A={crc32:0,compressedSize:0,uncompressedSize:0};t&&!n||(A.crc32=e.crc32,A.compressedSize=e.compressedSize,A.uncompressedSize=e.uncompressedSize);var R=0;t&&(R|=8),g||!S&&!w||(R|=2048);var I,C,D,P=0,O=0;x&&(P|=16),"UNIX"===c?(O=798,P|=(I=f.unixPermissions,C=x,D=I,I||(D=C?16893:33204),(65535&D)<<16)):(O=20,P|=63&(f.dosPermissions||0)),h=L.getUTCHours(),h<<=6,h|=L.getUTCMinutes(),h<<=5,h|=L.getUTCSeconds()/2,d=L.getUTCFullYear()-1980,d<<=4,d|=L.getUTCMonth()+1,d<<=5,d|=L.getUTCDate(),S&&(k=l(1,1)+l(a(m),4)+v,T+="up"+l(k.length,2)+k),w&&(_=l(1,1)+l(a(b),4)+E,T+="uc"+l(_.length,2)+_);var N="";return N+="\n\0",N+=l(R,2),N+=p.magic,N+=l(h,2),N+=l(d,2),N+=l(A.crc32,4),N+=l(A.compressedSize,4),N+=l(A.uncompressedSize,4),N+=l(m.length,2),N+=l(T.length,2),{fileRecord:o.LOCAL_FILE_HEADER+N+m+T,dirRecord:o.CENTRAL_FILE_HEADER+l(O,2)+N+l(b.length,2)+"\0\0\0\0"+l(P,4)+l(r,4)+m+T+b}},u=function(e){return o.DATA_DESCRIPTOR+l(e.crc32,4)+l(e.compressedSize,4)+l(e.uncompressedSize,4)};function h(e,t,n,i){r.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=n,this.encodeFileName=i,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}i.inherits(h,r),h.prototype.push=function(e){var t=e.meta.percent||0,n=this.entriesCount,i=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,r.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:n?(t+100*(n-i-1))/n:100}}))},h.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var n=c(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:n.fileRecord,meta:{percent:0}})}else this.accumulate=!0},h.prototype.closedSource=function(e){this.accumulate=!1;var t=this.streamFiles&&!e.file.dir,n=c(e,t,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(n.dirRecord),t)this.push({data:u(e),meta:{percent:100}});else for(this.push({data:n.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},h.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var n=this.bytesWritten-e,r=function(e,t,n,r,s){var a=i.transformTo("string",s(r));return o.CENTRAL_DIRECTORY_END+"\0\0\0\0"+l(e,2)+l(e,2)+l(t,4)+l(n,4)+l(a.length,2)+a}(this.dirRecords.length,n,e,this.zipComment,this.encodeFileName);this.push({data:r,meta:{percent:100}})},h.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},h.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on("data",function(e){t.processChunk(e)}),e.on("end",function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()}),e.on("error",function(e){t.error(e)}),this},h.prototype.resume=function(){return!!r.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},h.prototype.error=function(e){var t=this._sources;if(!r.prototype.error.call(this,e))return!1;for(var n=0;n<t.length;n++)try{t[n].error(e)}catch(e){}return!0},h.prototype.lock=function(){r.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()},t.exports=h},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,t,n){"use strict";var i=e("../compressions"),r=e("./ZipFileWorker");n.generateWorker=function(e,t,n){var s=new r(t.streamFiles,n,t.platform,t.encodeFileName),a=0;try{e.forEach(function(e,n){a++;var r=function(e,t){var n=e||t,r=i[n];if(!r)throw new Error(n+" is not a valid compression method !");return r}(n.options.compression,t.compression),o=n.options.compressionOptions||t.compressionOptions||{},l=n.dir,c=n.date;n._compressWorker(r,o).withStreamInfo("file",{name:e,dir:l,date:c,comment:n.comment||"",unixPermissions:n.unixPermissions,dosPermissions:n.dosPermissions}).pipe(s)}),s.entriesCount=a}catch(e){s.error(e)}return s}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,t,n){"use strict";function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var e=new i;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}i.prototype=e("./object"),i.prototype.loadAsync=e("./load"),i.support=e("./support"),i.defaults=e("./defaults"),i.version="3.10.1",i.loadAsync=function(e,t){return(new i).loadAsync(e,t)},i.external=e("./external"),t.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,t,n){"use strict";var i=e("./utils"),r=e("./external"),s=e("./utf8"),a=e("./zipEntries"),o=e("./stream/Crc32Probe"),l=e("./nodejsUtils");function c(e){return new r.Promise(function(t,n){var i=e.decompressed.getContentWorker().pipe(new o);i.on("error",function(e){n(e)}).on("end",function(){i.streamInfo.crc32!==e.decompressed.crc32?n(new Error("Corrupted zip : CRC32 mismatch")):t()}).resume()})}t.exports=function(e,t){var n=this;return t=i.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:s.utf8decode}),l.isNode&&l.isStream(e)?r.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",e,!0,t.optimizedBinaryString,t.base64).then(function(e){var n=new a(t);return n.load(e),n}).then(function(e){var n=[r.Promise.resolve(e)],i=e.files;if(t.checkCRC32)for(var s=0;s<i.length;s++)n.push(c(i[s]));return r.Promise.all(n)}).then(function(e){for(var r=e.shift(),s=r.files,a=0;a<s.length;a++){var o=s[a],l=o.fileNameStr,c=i.resolve(o.fileNameStr);n.file(c,o.decompressed,{binary:!0,optimizedBinaryString:!0,date:o.date,dir:o.dir,comment:o.fileCommentStr.length?o.fileCommentStr:null,unixPermissions:o.unixPermissions,dosPermissions:o.dosPermissions,createFolders:t.createFolders}),o.dir||(n.file(c).unsafeOriginalName=l)}return r.zipComment.length&&(n.comment=r.zipComment),n})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,t,n){"use strict";var i=e("../utils"),r=e("../stream/GenericWorker");function s(e,t){r.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(t)}i.inherits(s,r),s.prototype._bindStream=function(e){var t=this;this._stream=e,e.pause(),e.on("data",function(e){t.push({data:e,meta:{percent:0}})}).on("error",function(e){t.isPaused?this.generatedError=e:t.error(e)}).on("end",function(){t.isPaused?t._upstreamEnded=!0:t.end()})},s.prototype.pause=function(){return!!r.prototype.pause.call(this)&&(this._stream.pause(),!0)},s.prototype.resume=function(){return!!r.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},t.exports=s},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,t,n){"use strict";var i=e("readable-stream").Readable;function r(e,t,n){i.call(this,t),this._helper=e;var r=this;e.on("data",function(e,t){r.push(e)||r._helper.pause(),n&&n(t)}).on("error",function(e){r.emit("error",e)}).on("end",function(){r.push(null)})}e("../utils").inherits(r,i),r.prototype._read=function(){this._helper.resume()},t.exports=r},{"../utils":32,"readable-stream":16}],14:[function(e,t,n){"use strict";t.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(e,t){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(e,t);if("number"==typeof e)throw new Error('The "data" argument must not be a number');return new Buffer(e,t)},allocBuffer:function(e){if(Buffer.alloc)return Buffer.alloc(e);var t=new Buffer(e);return t.fill(0),t},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}}},{}],15:[function(e,t,n){"use strict";var i=e("./utf8"),r=e("./utils"),s=e("./stream/GenericWorker"),a=e("./stream/StreamHelper"),o=e("./defaults"),l=e("./compressedObject"),c=e("./zipObject"),u=e("./generate"),h=e("./nodejsUtils"),d=e("./nodejs/NodejsStreamInputAdapter"),f=function(e,t,n){var i,a=r.getTypeOf(t),u=r.extend(n||{},o);u.date=u.date||new Date,null!==u.compression&&(u.compression=u.compression.toUpperCase()),"string"==typeof u.unixPermissions&&(u.unixPermissions=parseInt(u.unixPermissions,8)),u.unixPermissions&&16384&u.unixPermissions&&(u.dir=!0),u.dosPermissions&&16&u.dosPermissions&&(u.dir=!0),u.dir&&(e=g(e)),u.createFolders&&(i=p(e))&&m.call(this,i,!0);var f="string"===a&&!1===u.binary&&!1===u.base64;n&&void 0!==n.binary||(u.binary=!f),(t instanceof l&&0===t.uncompressedSize||u.dir||!t||0===t.length)&&(u.base64=!1,u.binary=!0,t="",u.compression="STORE",a="string");var v;v=t instanceof l||t instanceof s?t:h.isNode&&h.isStream(t)?new d(e,t):r.prepareContent(e,t,u.binary,u.optimizedBinaryString,u.base64);var y=new c(e,v,u);this.files[e]=y},p=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return t>0?e.substring(0,t):""},g=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},m=function(e,t){return t=void 0!==t?t:o.createFolders,e=g(e),this.files[e]||f.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function v(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var y={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,n,i;for(t in this.files)i=this.files[t],(n=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(n,i)},filter:function(e){var t=[];return this.forEach(function(n,i){e(n,i)&&t.push(i)}),t},file:function(e,t,n){if(1===arguments.length){if(v(e)){var i=e;return this.filter(function(e,t){return!t.dir&&i.test(e)})}var r=this.files[this.root+e];return r&&!r.dir?r:null}return e=this.root+e,f.call(this,e,t,n),this},folder:function(e){if(!e)return this;if(v(e))return this.filter(function(t,n){return n.dir&&e.test(t)});var t=this.root+e,n=m.call(this,t),i=this.clone();return i.root=n.name,i},remove:function(e){e=this.root+e;var t=this.files[e];if(t||("/"!==e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var n=this.filter(function(t,n){return n.name.slice(0,e.length)===e}),i=0;i<n.length;i++)delete this.files[n[i].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var t,n={};try{if((n=r.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:i.utf8encode})).type=n.type.toLowerCase(),n.compression=n.compression.toUpperCase(),"binarystring"===n.type&&(n.type="string"),!n.type)throw new Error("No output type specified.");r.checkSupport(n.type),"darwin"!==n.platform&&"freebsd"!==n.platform&&"linux"!==n.platform&&"sunos"!==n.platform||(n.platform="UNIX"),"win32"===n.platform&&(n.platform="DOS");var o=n.comment||this.comment||"";t=u.generateWorker(this,n,o)}catch(e){(t=new s("error")).error(e)}return new a(t,n.type||"string",n.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}};t.exports=y},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,t,n){"use strict";t.exports=e("stream")},{stream:void 0}],17:[function(e,t,n){"use strict";var i=e("./DataReader");function r(e){i.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}e("../utils").inherits(r,i),r.prototype.byteAt=function(e){return this.data[this.zero+e]},r.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),n=e.charCodeAt(1),i=e.charCodeAt(2),r=e.charCodeAt(3),s=this.length-4;s>=0;--s)if(this.data[s]===t&&this.data[s+1]===n&&this.data[s+2]===i&&this.data[s+3]===r)return s-this.zero;return-1},r.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1),i=e.charCodeAt(2),r=e.charCodeAt(3),s=this.readData(4);return t===s[0]&&n===s[1]&&i===s[2]&&r===s[3]},r.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=r},{"../utils":32,"./DataReader":18}],18:[function(e,t,n){"use strict";var i=e("../utils");function r(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}r.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(){},readInt:function(e){var t,n=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)n=(n<<8)+this.byteAt(t);return this.index+=e,n},readString:function(e){return i.transformTo("string",this.readData(e))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},t.exports=r},{"../utils":32}],19:[function(e,t,n){"use strict";var i=e("./Uint8ArrayReader");function r(e){i.call(this,e)}e("../utils").inherits(r,i),r.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=r},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,t,n){"use strict";var i=e("./DataReader");function r(e){i.call(this,e)}e("../utils").inherits(r,i),r.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},r.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},r.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},r.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=r},{"../utils":32,"./DataReader":18}],21:[function(e,t,n){"use strict";var i=e("./ArrayReader");function r(e){i.call(this,e)}e("../utils").inherits(r,i),r.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=r},{"../utils":32,"./ArrayReader":17}],22:[function(e,t,n){"use strict";var i=e("../utils"),r=e("../support"),s=e("./ArrayReader"),a=e("./StringReader"),o=e("./NodeBufferReader"),l=e("./Uint8ArrayReader");t.exports=function(e){var t=i.getTypeOf(e);return i.checkSupport(t),"string"!==t||r.uint8array?"nodebuffer"===t?new o(e):r.uint8array?new l(i.transformTo("uint8array",e)):new s(i.transformTo("array",e)):new a(e)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,t,n){"use strict";n.LOCAL_FILE_HEADER="PK",n.CENTRAL_FILE_HEADER="PK",n.CENTRAL_DIRECTORY_END="PK",n.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",n.ZIP64_CENTRAL_DIRECTORY_END="PK",n.DATA_DESCRIPTOR="PK\b"},{}],24:[function(e,t,n){"use strict";var i=e("./GenericWorker"),r=e("../utils");function s(e){i.call(this,"ConvertWorker to "+e),this.destType=e}r.inherits(s,i),s.prototype.processChunk=function(e){this.push({data:r.transformTo(this.destType,e.data),meta:e.meta})},t.exports=s},{"../utils":32,"./GenericWorker":28}],25:[function(e,t,n){"use strict";var i=e("./GenericWorker"),r=e("../crc32");function s(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(s,i),s.prototype.processChunk=function(e){this.streamInfo.crc32=r(e.data,this.streamInfo.crc32||0),this.push(e)},t.exports=s},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,t,n){"use strict";var i=e("../utils"),r=e("./GenericWorker");function s(e){r.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}i.inherits(s,r),s.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}r.prototype.processChunk.call(this,e)},t.exports=s},{"../utils":32,"./GenericWorker":28}],27:[function(e,t,n){"use strict";var i=e("../utils"),r=e("./GenericWorker");function s(e){r.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then(function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=i.getTypeOf(e),t.isPaused||t._tickAndRepeat()},function(e){t.error(e)})}i.inherits(s,r),s.prototype.cleanUp=function(){r.prototype.cleanUp.call(this),this.data=null},s.prototype.resume=function(){return!!r.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},s.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},s.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,t);break;case"uint8array":e=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},t.exports=s},{"../utils":32,"./GenericWorker":28}],28:[function(e,t,n){"use strict";function i(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var n=0;n<this._listeners[e].length;n++)this._listeners[e][n].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",function(e){t.processChunk(e)}),e.on("end",function(){t.end()}),e.on("error",function(e){t.error(e)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var e=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}},t.exports=i},{}],29:[function(e,t,n){"use strict";var i=e("../utils"),r=e("./ConvertWorker"),s=e("./GenericWorker"),a=e("../base64"),o=e("../support"),l=e("../external"),c=null;if(o.nodestream)try{c=e("../nodejs/NodejsStreamOutputAdapter")}catch(e){}function u(e,t){return new l.Promise(function(n,r){var s=[],o=e._internalType,l=e._outputType,c=e._mimeType;e.on("data",function(e,n){s.push(e),t&&t(n)}).on("error",function(e){s=[],r(e)}).on("end",function(){try{var e=function(e,t,n){switch(e){case"blob":return i.newBlob(i.transformTo("arraybuffer",t),n);case"base64":return a.encode(t);default:return i.transformTo(e,t)}}(l,function(e,t){var n,i=0,r=null,s=0;for(n=0;n<t.length;n++)s+=t[n].length;switch(e){case"string":return t.join("");case"array":return Array.prototype.concat.apply([],t);case"uint8array":for(r=new Uint8Array(s),n=0;n<t.length;n++)r.set(t[n],i),i+=t[n].length;return r;case"nodebuffer":return Buffer.concat(t);default:throw new Error("concat : unsupported type '"+e+"'")}}(o,s),c);n(e)}catch(e){r(e)}s=[]}).resume()})}function h(e,t,n){var a=t;switch(t){case"blob":case"arraybuffer":a="uint8array";break;case"base64":a="string"}try{this._internalType=a,this._outputType=t,this._mimeType=n,i.checkSupport(a),this._worker=e.pipe(new r(a)),e.lock()}catch(e){this._worker=new s("error"),this._worker.error(e)}}h.prototype={accumulate:function(e){return u(this,e)},on:function(e,t){var n=this;return"data"===e?this._worker.on(e,function(e){t.call(n,e.data,e.meta)}):this._worker.on(e,function(){i.delay(t,arguments,n)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(i.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new c(this,{objectMode:"nodebuffer"!==this._outputType},e)}},t.exports=h},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,t,n){"use strict";if(n.base64=!0,n.array=!0,n.string=!0,n.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,n.nodebuffer="undefined"!=typeof Buffer,n.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)n.blob=!1;else{var i=new ArrayBuffer(0);try{n.blob=0===new Blob([i],{type:"application/zip"}).size}catch(e){try{var r=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);r.append(i),n.blob=0===r.getBlob("application/zip").size}catch(e){n.blob=!1}}}try{n.nodestream=!!e("readable-stream").Readable}catch(e){n.nodestream=!1}},{"readable-stream":16}],31:[function(e,t,n){"use strict";for(var i=e("./utils"),r=e("./support"),s=e("./nodejsUtils"),a=e("./stream/GenericWorker"),o=new Array(256),l=0;l<256;l++)o[l]=l>=252?6:l>=248?5:l>=240?4:l>=224?3:l>=192?2:1;o[254]=o[254]=1;function c(){a.call(this,"utf-8 decode"),this.leftOver=null}function u(){a.call(this,"utf-8 encode")}n.utf8encode=function(e){return r.nodebuffer?s.newBufferFrom(e,"utf-8"):function(e){var t,n,i,s,a,o=e.length,l=0;for(s=0;s<o;s++)55296==(64512&(n=e.charCodeAt(s)))&&s+1<o&&56320==(64512&(i=e.charCodeAt(s+1)))&&(n=65536+(n-55296<<10)+(i-56320),s++),l+=n<128?1:n<2048?2:n<65536?3:4;for(t=r.uint8array?new Uint8Array(l):new Array(l),a=0,s=0;a<l;s++)55296==(64512&(n=e.charCodeAt(s)))&&s+1<o&&56320==(64512&(i=e.charCodeAt(s+1)))&&(n=65536+(n-55296<<10)+(i-56320),s++),n<128?t[a++]=n:n<2048?(t[a++]=192|n>>>6,t[a++]=128|63&n):n<65536?(t[a++]=224|n>>>12,t[a++]=128|n>>>6&63,t[a++]=128|63&n):(t[a++]=240|n>>>18,t[a++]=128|n>>>12&63,t[a++]=128|n>>>6&63,t[a++]=128|63&n);return t}(e)},n.utf8decode=function(e){return r.nodebuffer?i.transformTo("nodebuffer",e).toString("utf-8"):function(e){var t,n,r,s,a=e.length,l=new Array(2*a);for(n=0,t=0;t<a;)if((r=e[t++])<128)l[n++]=r;else if((s=o[r])>4)l[n++]=65533,t+=s-1;else{for(r&=2===s?31:3===s?15:7;s>1&&t<a;)r=r<<6|63&e[t++],s--;s>1?l[n++]=65533:r<65536?l[n++]=r:(r-=65536,l[n++]=55296|r>>10&1023,l[n++]=56320|1023&r)}return l.length!==n&&(l.subarray?l=l.subarray(0,n):l.length=n),i.applyFromCharCode(l)}(e=i.transformTo(r.uint8array?"uint8array":"array",e))},i.inherits(c,a),c.prototype.processChunk=function(e){var t=i.transformTo(r.uint8array?"uint8array":"array",e.data);if(this.leftOver&&this.leftOver.length){if(r.uint8array){var s=t;(t=new Uint8Array(s.length+this.leftOver.length)).set(this.leftOver,0),t.set(s,this.leftOver.length)}else t=this.leftOver.concat(t);this.leftOver=null}var a=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+o[e[n]]>t?n:t}(t),l=t;a!==t.length&&(r.uint8array?(l=t.subarray(0,a),this.leftOver=t.subarray(a,t.length)):(l=t.slice(0,a),this.leftOver=t.slice(a,t.length))),this.push({data:n.utf8decode(l),meta:e.meta})},c.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:n.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},n.Utf8DecodeWorker=c,i.inherits(u,a),u.prototype.processChunk=function(e){this.push({data:n.utf8encode(e.data),meta:e.meta})},n.Utf8EncodeWorker=u},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,t,n){"use strict";var i=e("./support"),r=e("./base64"),s=e("./nodejsUtils"),a=e("./external");function o(e){return e}function l(e,t){for(var n=0;n<e.length;++n)t[n]=255&e.charCodeAt(n);return t}e("setimmediate"),n.newBlob=function(e,t){n.checkSupport("blob");try{return new Blob([e],{type:t})}catch(n){try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return i.append(e),i.getBlob(t)}catch(e){throw new Error("Bug : can't construct the Blob.")}}};var c={stringifyByChunk:function(e,t,n){var i=[],r=0,s=e.length;if(s<=n)return String.fromCharCode.apply(null,e);for(;r<s;)"array"===t||"nodebuffer"===t?i.push(String.fromCharCode.apply(null,e.slice(r,Math.min(r+n,s)))):i.push(String.fromCharCode.apply(null,e.subarray(r,Math.min(r+n,s)))),r+=n;return i.join("")},stringifyByChar:function(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(e){return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&1===String.fromCharCode.apply(null,s.allocBuffer(1)).length}catch(e){return!1}}()}};function u(e){var t=65536,i=n.getTypeOf(e),r=!0;if("uint8array"===i?r=c.applyCanBeUsed.uint8array:"nodebuffer"===i&&(r=c.applyCanBeUsed.nodebuffer),r)for(;t>1;)try{return c.stringifyByChunk(e,i,t)}catch(e){t=Math.floor(t/2)}return c.stringifyByChar(e)}function h(e,t){for(var n=0;n<e.length;n++)t[n]=e[n];return t}n.applyFromCharCode=u;var d={};d.string={string:o,array:function(e){return l(e,new Array(e.length))},arraybuffer:function(e){return d.string.uint8array(e).buffer},uint8array:function(e){return l(e,new Uint8Array(e.length))},nodebuffer:function(e){return l(e,s.allocBuffer(e.length))}},d.array={string:u,array:o,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return s.newBufferFrom(e)}},d.arraybuffer={string:function(e){return u(new Uint8Array(e))},array:function(e){return h(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:o,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return s.newBufferFrom(new Uint8Array(e))}},d.uint8array={string:u,array:function(e){return h(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:o,nodebuffer:function(e){return s.newBufferFrom(e)}},d.nodebuffer={string:u,array:function(e){return h(e,new Array(e.length))},arraybuffer:function(e){return d.nodebuffer.uint8array(e).buffer},uint8array:function(e){return h(e,new Uint8Array(e.length))},nodebuffer:o},n.transformTo=function(e,t){if(t||(t=""),!e)return t;n.checkSupport(e);var i=n.getTypeOf(t);return d[i][e](t)},n.resolve=function(e){for(var t=e.split("/"),n=[],i=0;i<t.length;i++){var r=t[i];"."===r||""===r&&0!==i&&i!==t.length-1||(".."===r?n.pop():n.push(r))}return n.join("/")},n.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":i.nodebuffer&&s.isBuffer(e)?"nodebuffer":i.uint8array&&e instanceof Uint8Array?"uint8array":i.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},n.checkSupport=function(e){if(!i[e.toLowerCase()])throw new Error(e+" is not supported by this platform")},n.MAX_VALUE_16BITS=65535,n.MAX_VALUE_32BITS=-1,n.pretty=function(e){var t,n,i="";for(n=0;n<(e||"").length;n++)i+="\\x"+((t=e.charCodeAt(n))<16?"0":"")+t.toString(16).toUpperCase();return i},n.delay=function(e,t,n){setImmediate(function(){e.apply(n||null,t||[])})},n.inherits=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n},n.extend=function(){var e,t,n={};for(e=0;e<arguments.length;e++)for(t in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],t)&&void 0===n[t]&&(n[t]=arguments[e][t]);return n},n.prepareContent=function(e,t,s,o,c){return a.Promise.resolve(t).then(function(e){return i.blob&&(e instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(e)))&&"undefined"!=typeof FileReader?new a.Promise(function(t,n){var i=new FileReader;i.onload=function(e){t(e.target.result)},i.onerror=function(e){n(e.target.error)},i.readAsArrayBuffer(e)}):e}).then(function(t){var u,h=n.getTypeOf(t);return h?("arraybuffer"===h?t=n.transformTo("uint8array",t):"string"===h&&(c?t=r.decode(t):s&&!0!==o&&(t=l(u=t,i.uint8array?new Uint8Array(u.length):new Array(u.length)))),t):a.Promise.reject(new Error("Can't read the data of '"+e+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,t,n){"use strict";var i=e("./reader/readerFor"),r=e("./utils"),s=e("./signature"),a=e("./zipEntry"),o=e("./support");function l(e){this.files=[],this.loadOptions=e}l.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+r.pretty(t)+", expected "+r.pretty(e)+")")}},isSignature:function(e,t){var n=this.reader.index;this.reader.setIndex(e);var i=this.reader.readString(4)===t;return this.reader.setIndex(n),i},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=o.uint8array?"uint8array":"array",n=r.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(n)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,n,i=this.zip64EndOfCentralSize-44;0<i;)e=this.reader.readInt(2),t=this.reader.readInt(4),n=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:n}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(s.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(s.CENTRAL_FILE_HEADER);)(e=new a({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(e<0)throw this.isSignature(0,s.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(e);var t=e;if(this.checkSignature(s.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===r.MAX_VALUE_16BITS||this.diskWithCentralDirStart===r.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===r.MAX_VALUE_16BITS||this.centralDirRecords===r.MAX_VALUE_16BITS||this.centralDirSize===r.MAX_VALUE_32BITS||this.centralDirOffset===r.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,s.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var n=this.centralDirOffset+this.centralDirSize;this.zip64&&(n+=20,n+=12+this.zip64EndOfCentralSize);var i=t-n;if(i>0)this.isSignature(t,s.CENTRAL_FILE_HEADER)||(this.reader.zero=i);else if(i<0)throw new Error("Corrupted zip: missing "+Math.abs(i)+" bytes.")},prepareReader:function(e){this.reader=i(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=l},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,t,n){"use strict";var i=e("./reader/readerFor"),r=e("./utils"),s=e("./compressedObject"),a=e("./crc32"),o=e("./utf8"),l=e("./compressions"),c=e("./support");function u(e,t){this.options=e,this.loadOptions=t}u.prototype={isEncrypted:function(){return!(1&~this.bitFlag)},useUTF8:function(){return!(2048&~this.bitFlag)},readLocalPart:function(e){var t,n;if(e.skip(22),this.fileNameLength=e.readInt(2),n=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(n),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(t=function(e){for(var t in l)if(Object.prototype.hasOwnProperty.call(l,t)&&l[t].magic===e)return l[t];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+r.pretty(this.compressionMethod)+" unknown (inner file : "+r.transformTo("string",this.fileName)+")");this.decompressed=new s(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0===e&&(this.dosPermissions=63&this.externalFileAttributes),3===e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var e=i(this.extraFields[1].value);this.uncompressedSize===r.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===r.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===r.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===r.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(e){var t,n,i,r=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index+4<r;)t=e.readInt(2),n=e.readInt(2),i=e.readData(n),this.extraFields[t]={id:t,length:n,value:i};e.setIndex(r)},handleUTF8:function(){var e=c.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=o.utf8decode(this.fileName),this.fileCommentStr=o.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var n=r.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(n)}var i=this.findExtraFieldUnicodeComment();if(null!==i)this.fileCommentStr=i;else{var s=r.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(s)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=i(e.value);return 1!==t.readInt(1)||a(this.fileName)!==t.readInt(4)?null:o.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=i(e.value);return 1!==t.readInt(1)||a(this.fileComment)!==t.readInt(4)?null:o.utf8decode(t.readData(e.length-5))}return null}},t.exports=u},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,t,n){"use strict";var i=e("./stream/StreamHelper"),r=e("./stream/DataWorker"),s=e("./utf8"),a=e("./compressedObject"),o=e("./stream/GenericWorker"),l=function(e,t,n){this.name=e,this.dir=n.dir,this.date=n.date,this.comment=n.comment,this.unixPermissions=n.unixPermissions,this.dosPermissions=n.dosPermissions,this._data=t,this._dataBinary=n.binary,this.options={compression:n.compression,compressionOptions:n.compressionOptions}};l.prototype={internalStream:function(e){var t=null,n="string";try{if(!e)throw new Error("No output type specified.");var r="string"===(n=e.toLowerCase())||"text"===n;"binarystring"!==n&&"text"!==n||(n="string"),t=this._decompressWorker();var a=!this._dataBinary;a&&!r&&(t=t.pipe(new s.Utf8EncodeWorker)),!a&&r&&(t=t.pipe(new s.Utf8DecodeWorker))}catch(e){(t=new o("error")).error(e)}return new i(t,n,"")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof a&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var n=this._decompressWorker();return this._dataBinary||(n=n.pipe(new s.Utf8EncodeWorker)),a.createWorkerFrom(n,e,t)},_decompressWorker:function(){return this._data instanceof a?this._data.getContentWorker():this._data instanceof o?this._data:new r(this._data)}};for(var c=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],u=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},h=0;h<c.length;h++)l.prototype[c[h]]=u;t.exports=l},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,t,i){(function(e){"use strict";var n,i,r=e.MutationObserver||e.WebKitMutationObserver;if(r){var s=0,a=new r(u),o=e.document.createTextNode("");a.observe(o,{characterData:!0}),n=function(){o.data=s=++s%2}}else if(e.setImmediate||void 0===e.MessageChannel)n="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){u(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(u,0)};else{var l=new e.MessageChannel;l.port1.onmessage=u,n=function(){l.port2.postMessage(0)}}var c=[];function u(){var e,t;i=!0;for(var n=c.length;n;){for(t=c,c=[],e=-1;++e<n;)t[e]();n=c.length}i=!1}t.exports=function(e){1!==c.push(e)||i||n()}}).call(this,void 0!==n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(e,t,n){"use strict";var i=e("immediate");function r(){}var s={},a=["REJECTED"],o=["FULFILLED"],l=["PENDING"];function c(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,e!==r&&f(this,e)}function u(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function h(e,t,n){i(function(){var i;try{i=t(n)}catch(t){return s.reject(e,t)}i===e?s.reject(e,new TypeError("Cannot resolve promise with itself")):s.resolve(e,i)})}function d(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function f(e,t){var n=!1;function i(t){n||(n=!0,s.reject(e,t))}function r(t){n||(n=!0,s.resolve(e,t))}var a=p(function(){t(r,i)});"error"===a.status&&i(a.value)}function p(e,t){var n={};try{n.value=e(t),n.status="success"}catch(e){n.status="error",n.value=e}return n}t.exports=c,c.prototype.finally=function(e){if("function"!=typeof e)return this;var t=this.constructor;return this.then(function(n){return t.resolve(e()).then(function(){return n})},function(n){return t.resolve(e()).then(function(){throw n})})},c.prototype.catch=function(e){return this.then(null,e)},c.prototype.then=function(e,t){if("function"!=typeof e&&this.state===o||"function"!=typeof t&&this.state===a)return this;var n=new this.constructor(r);return this.state!==l?h(n,this.state===o?e:t,this.outcome):this.queue.push(new u(n,e,t)),n},u.prototype.callFulfilled=function(e){s.resolve(this.promise,e)},u.prototype.otherCallFulfilled=function(e){h(this.promise,this.onFulfilled,e)},u.prototype.callRejected=function(e){s.reject(this.promise,e)},u.prototype.otherCallRejected=function(e){h(this.promise,this.onRejected,e)},s.resolve=function(e,t){var n=p(d,t);if("error"===n.status)return s.reject(e,n.value);var i=n.value;if(i)f(e,i);else{e.state=o,e.outcome=t;for(var r=-1,a=e.queue.length;++r<a;)e.queue[r].callFulfilled(t)}return e},s.reject=function(e,t){e.state=a,e.outcome=t;for(var n=-1,i=e.queue.length;++n<i;)e.queue[n].callRejected(t);return e},c.resolve=function(e){return e instanceof this?e:s.resolve(new this(r),e)},c.reject=function(e){var t=new this(r);return s.reject(t,e)},c.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,i=!1;if(!n)return this.resolve([]);for(var a=new Array(n),o=0,l=-1,c=new this(r);++l<n;)u(e[l],l);return c;function u(e,r){t.resolve(e).then(function(e){a[r]=e,++o!==n||i||(i=!0,s.resolve(c,a))},function(e){i||(i=!0,s.reject(c,e))})}},c.race=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,i=!1;if(!n)return this.resolve([]);for(var a=-1,o=new this(r);++a<n;)l(e[a]);return o;function l(e){t.resolve(e).then(function(e){i||(i=!0,s.resolve(o,e))},function(e){i||(i=!0,s.reject(o,e))})}}},{immediate:36}],38:[function(e,t,n){"use strict";var i={};(0,e("./lib/utils/common").assign)(i,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,t,n){"use strict";var i=e("./zlib/deflate"),r=e("./utils/common"),s=e("./utils/strings"),a=e("./zlib/messages"),o=e("./zlib/zstream"),l=Object.prototype.toString;function c(e){if(!(this instanceof c))return new c(e);this.options=r.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new o,this.strm.avail_out=0;var n=i.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(0!==n)throw new Error(a[n]);if(t.header&&i.deflateSetHeader(this.strm,t.header),t.dictionary){var u;if(u="string"==typeof t.dictionary?s.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,0!==(n=i.deflateSetDictionary(this.strm,u)))throw new Error(a[n]);this._dict_set=!0}}function u(e,t){var n=new c(t);if(n.push(e,!0),n.err)throw n.msg||a[n.err];return n.result}c.prototype.push=function(e,t){var n,a,o=this.strm,c=this.options.chunkSize;if(this.ended)return!1;a=t===~~t?t:!0===t?4:0,"string"==typeof e?o.input=s.string2buf(e):"[object ArrayBuffer]"===l.call(e)?o.input=new Uint8Array(e):o.input=e,o.next_in=0,o.avail_in=o.input.length;do{if(0===o.avail_out&&(o.output=new r.Buf8(c),o.next_out=0,o.avail_out=c),1!==(n=i.deflate(o,a))&&0!==n)return this.onEnd(n),this.ended=!0,!1;0!==o.avail_out&&(0!==o.avail_in||4!==a&&2!==a)||("string"===this.options.to?this.onData(s.buf2binstring(r.shrinkBuf(o.output,o.next_out))):this.onData(r.shrinkBuf(o.output,o.next_out)))}while((o.avail_in>0||0===o.avail_out)&&1!==n);return 4===a?(n=i.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,0===n):2!==a||(this.onEnd(0),o.avail_out=0,!0)},c.prototype.onData=function(e){this.chunks.push(e)},c.prototype.onEnd=function(e){0===e&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Deflate=c,n.deflate=u,n.deflateRaw=function(e,t){return(t=t||{}).raw=!0,u(e,t)},n.gzip=function(e,t){return(t=t||{}).gzip=!0,u(e,t)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,t,n){"use strict";var i=e("./zlib/inflate"),r=e("./utils/common"),s=e("./utils/strings"),a=e("./zlib/constants"),o=e("./zlib/messages"),l=e("./zlib/zstream"),c=e("./zlib/gzheader"),u=Object.prototype.toString;function h(e){if(!(this instanceof h))return new h(e);this.options=r.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(15&t.windowBits||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var n=i.inflateInit2(this.strm,t.windowBits);if(n!==a.Z_OK)throw new Error(o[n]);this.header=new c,i.inflateGetHeader(this.strm,this.header)}function d(e,t){var n=new h(t);if(n.push(e,!0),n.err)throw n.msg||o[n.err];return n.result}h.prototype.push=function(e,t){var n,o,l,c,h,d,f=this.strm,p=this.options.chunkSize,g=this.options.dictionary,m=!1;if(this.ended)return!1;o=t===~~t?t:!0===t?a.Z_FINISH:a.Z_NO_FLUSH,"string"==typeof e?f.input=s.binstring2buf(e):"[object ArrayBuffer]"===u.call(e)?f.input=new Uint8Array(e):f.input=e,f.next_in=0,f.avail_in=f.input.length;do{if(0===f.avail_out&&(f.output=new r.Buf8(p),f.next_out=0,f.avail_out=p),(n=i.inflate(f,a.Z_NO_FLUSH))===a.Z_NEED_DICT&&g&&(d="string"==typeof g?s.string2buf(g):"[object ArrayBuffer]"===u.call(g)?new Uint8Array(g):g,n=i.inflateSetDictionary(this.strm,d)),n===a.Z_BUF_ERROR&&!0===m&&(n=a.Z_OK,m=!1),n!==a.Z_STREAM_END&&n!==a.Z_OK)return this.onEnd(n),this.ended=!0,!1;f.next_out&&(0!==f.avail_out&&n!==a.Z_STREAM_END&&(0!==f.avail_in||o!==a.Z_FINISH&&o!==a.Z_SYNC_FLUSH)||("string"===this.options.to?(l=s.utf8border(f.output,f.next_out),c=f.next_out-l,h=s.buf2string(f.output,l),f.next_out=c,f.avail_out=p-c,c&&r.arraySet(f.output,f.output,l,c,0),this.onData(h)):this.onData(r.shrinkBuf(f.output,f.next_out)))),0===f.avail_in&&0===f.avail_out&&(m=!0)}while((f.avail_in>0||0===f.avail_out)&&n!==a.Z_STREAM_END);return n===a.Z_STREAM_END&&(o=a.Z_FINISH),o===a.Z_FINISH?(n=i.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===a.Z_OK):o!==a.Z_SYNC_FLUSH||(this.onEnd(a.Z_OK),f.avail_out=0,!0)},h.prototype.onData=function(e){this.chunks.push(e)},h.prototype.onEnd=function(e){e===a.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Inflate=h,n.inflate=d,n.inflateRaw=function(e,t){return(t=t||{}).raw=!0,d(e,t)},n.ungzip=d},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,t,n){"use strict";var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;n.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var i in n)n.hasOwnProperty(i)&&(e[i]=n[i])}}return e},n.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var r={arraySet:function(e,t,n,i,r){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+i),r);else for(var s=0;s<i;s++)e[r+s]=t[n+s]},flattenChunks:function(e){var t,n,i,r,s,a;for(i=0,t=0,n=e.length;t<n;t++)i+=e[t].length;for(a=new Uint8Array(i),r=0,t=0,n=e.length;t<n;t++)s=e[t],a.set(s,r),r+=s.length;return a}},s={arraySet:function(e,t,n,i,r){for(var s=0;s<i;s++)e[r+s]=t[n+s]},flattenChunks:function(e){return[].concat.apply([],e)}};n.setTyped=function(e){e?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,r)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,s))},n.setTyped(i)},{}],42:[function(e,t,n){"use strict";var i=e("./common"),r=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch(e){r=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){s=!1}for(var a=new i.Buf8(256),o=0;o<256;o++)a[o]=o>=252?6:o>=248?5:o>=240?4:o>=224?3:o>=192?2:1;function l(e,t){if(t<65537&&(e.subarray&&s||!e.subarray&&r))return String.fromCharCode.apply(null,i.shrinkBuf(e,t));for(var n="",a=0;a<t;a++)n+=String.fromCharCode(e[a]);return n}a[254]=a[254]=1,n.string2buf=function(e){var t,n,r,s,a,o=e.length,l=0;for(s=0;s<o;s++)55296==(64512&(n=e.charCodeAt(s)))&&s+1<o&&56320==(64512&(r=e.charCodeAt(s+1)))&&(n=65536+(n-55296<<10)+(r-56320),s++),l+=n<128?1:n<2048?2:n<65536?3:4;for(t=new i.Buf8(l),a=0,s=0;a<l;s++)55296==(64512&(n=e.charCodeAt(s)))&&s+1<o&&56320==(64512&(r=e.charCodeAt(s+1)))&&(n=65536+(n-55296<<10)+(r-56320),s++),n<128?t[a++]=n:n<2048?(t[a++]=192|n>>>6,t[a++]=128|63&n):n<65536?(t[a++]=224|n>>>12,t[a++]=128|n>>>6&63,t[a++]=128|63&n):(t[a++]=240|n>>>18,t[a++]=128|n>>>12&63,t[a++]=128|n>>>6&63,t[a++]=128|63&n);return t},n.buf2binstring=function(e){return l(e,e.length)},n.binstring2buf=function(e){for(var t=new i.Buf8(e.length),n=0,r=t.length;n<r;n++)t[n]=e.charCodeAt(n);return t},n.buf2string=function(e,t){var n,i,r,s,o=t||e.length,c=new Array(2*o);for(i=0,n=0;n<o;)if((r=e[n++])<128)c[i++]=r;else if((s=a[r])>4)c[i++]=65533,n+=s-1;else{for(r&=2===s?31:3===s?15:7;s>1&&n<o;)r=r<<6|63&e[n++],s--;s>1?c[i++]=65533:r<65536?c[i++]=r:(r-=65536,c[i++]=55296|r>>10&1023,c[i++]=56320|1023&r)}return l(c,i)},n.utf8border=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+a[e[n]]>t?n:t}},{"./common":41}],43:[function(e,t,n){"use strict";t.exports=function(e,t,n,i){for(var r=65535&e,s=e>>>16&65535,a=0;0!==n;){n-=a=n>2e3?2e3:n;do{s=s+(r=r+t[i++]|0)|0}while(--a);r%=65521,s%=65521}return r|s<<16}},{}],44:[function(e,t,n){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,t,n){"use strict";var i=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();t.exports=function(e,t,n,r){var s=i,a=r+n;e^=-1;for(var o=r;o<a;o++)e=e>>>8^s[255&(e^t[o])];return-1^e}},{}],46:[function(e,t,n){"use strict";var i,r=e("../utils/common"),s=e("./trees"),a=e("./adler32"),o=e("./crc32"),l=e("./messages"),c=-2,u=258,h=262,d=103,f=113,p=666;function g(e,t){return e.msg=l[t],t}function m(e){return(e<<1)-(e>4?9:0)}function v(e){for(var t=e.length;--t>=0;)e[t]=0}function y(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(r.arraySet(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function b(e,t){s._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,y(e.strm)}function E(e,t){e.pending_buf[e.pending++]=t}function S(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function w(e,t,n,i){var s=e.avail_in;return s>i&&(s=i),0===s?0:(e.avail_in-=s,r.arraySet(t,e.input,e.next_in,s,n),1===e.state.wrap?e.adler=a(e.adler,t,s,n):2===e.state.wrap&&(e.adler=o(e.adler,t,s,n)),e.next_in+=s,e.total_in+=s,s)}function T(e,t){var n,i,r=e.max_chain_length,s=e.strstart,a=e.prev_length,o=e.nice_match,l=e.strstart>e.w_size-h?e.strstart-(e.w_size-h):0,c=e.window,d=e.w_mask,f=e.prev,p=e.strstart+u,g=c[s+a-1],m=c[s+a];e.prev_length>=e.good_match&&(r>>=2),o>e.lookahead&&(o=e.lookahead);do{if(c[(n=t)+a]===m&&c[n+a-1]===g&&c[n]===c[s]&&c[++n]===c[s+1]){s+=2,n++;do{}while(c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&s<p);if(i=u-(p-s),s=p-u,i>a){if(e.match_start=t,a=i,i>=o)break;g=c[s+a-1],m=c[s+a]}}}while((t=f[t&d])>l&&0!==--r);return a<=e.lookahead?a:e.lookahead}function k(e){var t,n,i,s,a,o=e.w_size;do{if(s=e.window_size-e.lookahead-e.strstart,e.strstart>=o+(o-h)){r.arraySet(e.window,e.window,o,o,0),e.match_start-=o,e.strstart-=o,e.block_start-=o,t=n=e.hash_size;do{i=e.head[--t],e.head[t]=i>=o?i-o:0}while(--n);t=n=o;do{i=e.prev[--t],e.prev[t]=i>=o?i-o:0}while(--n);s+=o}if(0===e.strm.avail_in)break;if(n=w(e.strm,e.window,e.strstart+e.lookahead,s),e.lookahead+=n,e.lookahead+e.insert>=3)for(a=e.strstart-e.insert,e.ins_h=e.window[a],e.ins_h=(e.ins_h<<e.hash_shift^e.window[a+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[a+3-1])&e.hash_mask,e.prev[a&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=a,a++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<h&&0!==e.strm.avail_in)}function _(e,t){for(var n,i;;){if(e.lookahead<h){if(k(e),e.lookahead<h&&0===t)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-h&&(e.match_length=T(e,n)),e.match_length>=3)if(i=s._tr_tally(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!==--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else i=s._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(b(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,4===t?(b(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(b(e,!1),0===e.strm.avail_out)?1:2}function x(e,t){for(var n,i,r;;){if(e.lookahead<h){if(k(e),e.lookahead<h&&0===t)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-h&&(e.match_length=T(e,n),e.match_length<=5&&(1===e.strategy||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){r=e.strstart+e.lookahead-3,i=s._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=r&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!==--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,i&&(b(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((i=s._tr_tally(e,0,e.window[e.strstart-1]))&&b(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=s._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===t?(b(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(b(e,!1),0===e.strm.avail_out)?1:2}function L(e,t,n,i,r){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=i,this.func=r}function A(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new r.Buf16(1146),this.dyn_dtree=new r.Buf16(122),this.bl_tree=new r.Buf16(78),v(this.dyn_ltree),v(this.dyn_dtree),v(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new r.Buf16(16),this.heap=new r.Buf16(573),v(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new r.Buf16(573),v(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function R(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:f,e.adler=2===t.wrap?0:1,t.last_flush=0,s._tr_init(t),0):g(e,c)}function I(e){var t,n=R(e);return 0===n&&((t=e.state).window_size=2*t.w_size,v(t.head),t.max_lazy_match=i[t.level].max_lazy,t.good_match=i[t.level].good_length,t.nice_match=i[t.level].nice_length,t.max_chain_length=i[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0),n}function C(e,t,n,i,s,a){if(!e)return c;var o=1;if(-1===t&&(t=6),i<0?(o=0,i=-i):i>15&&(o=2,i-=16),s<1||s>9||8!==n||i<8||i>15||t<0||t>9||a<0||a>4)return g(e,c);8===i&&(i=9);var l=new A;return e.state=l,l.strm=e,l.wrap=o,l.gzhead=null,l.w_bits=i,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=s+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+3-1)/3),l.window=new r.Buf8(2*l.w_size),l.head=new r.Buf16(l.hash_size),l.prev=new r.Buf16(l.w_size),l.lit_bufsize=1<<s+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new r.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=a,l.method=n,I(e)}i=[new L(0,0,0,0,function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(k(e),0===e.lookahead&&0===t)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var i=e.block_start+n;if((0===e.strstart||e.strstart>=i)&&(e.lookahead=e.strstart-i,e.strstart=i,b(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-h&&(b(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(b(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(b(e,!1),e.strm.avail_out),1)}),new L(4,4,8,4,_),new L(4,5,16,8,_),new L(4,6,32,32,_),new L(4,4,16,16,x),new L(8,16,32,32,x),new L(8,16,128,128,x),new L(8,32,128,256,x),new L(32,128,258,1024,x),new L(32,258,258,4096,x)],n.deflateInit=function(e,t){return C(e,t,8,15,8,0)},n.deflateInit2=C,n.deflateReset=I,n.deflateResetKeep=R,n.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?c:(e.state.gzhead=t,0):c},n.deflate=function(e,t){var n,r,a,l;if(!e||!e.state||t>5||t<0)return e?g(e,c):c;if(r=e.state,!e.output||!e.input&&0!==e.avail_in||r.status===p&&4!==t)return g(e,0===e.avail_out?-5:c);if(r.strm=e,n=r.last_flush,r.last_flush=t,42===r.status)if(2===r.wrap)e.adler=0,E(r,31),E(r,139),E(r,8),r.gzhead?(E(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),E(r,255&r.gzhead.time),E(r,r.gzhead.time>>8&255),E(r,r.gzhead.time>>16&255),E(r,r.gzhead.time>>24&255),E(r,9===r.level?2:r.strategy>=2||r.level<2?4:0),E(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(E(r,255&r.gzhead.extra.length),E(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=o(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69):(E(r,0),E(r,0),E(r,0),E(r,0),E(r,0),E(r,9===r.level?2:r.strategy>=2||r.level<2?4:0),E(r,3),r.status=f);else{var h=8+(r.w_bits-8<<4)<<8;h|=(r.strategy>=2||r.level<2?0:r.level<6?1:6===r.level?2:3)<<6,0!==r.strstart&&(h|=32),h+=31-h%31,r.status=f,S(r,h),0!==r.strstart&&(S(r,e.adler>>>16),S(r,65535&e.adler)),e.adler=1}if(69===r.status)if(r.gzhead.extra){for(a=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>a&&(e.adler=o(e.adler,r.pending_buf,r.pending-a,a)),y(e),a=r.pending,r.pending!==r.pending_buf_size));)E(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>a&&(e.adler=o(e.adler,r.pending_buf,r.pending-a,a)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=73)}else r.status=73;if(73===r.status)if(r.gzhead.name){a=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>a&&(e.adler=o(e.adler,r.pending_buf,r.pending-a,a)),y(e),a=r.pending,r.pending===r.pending_buf_size)){l=1;break}l=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,E(r,l)}while(0!==l);r.gzhead.hcrc&&r.pending>a&&(e.adler=o(e.adler,r.pending_buf,r.pending-a,a)),0===l&&(r.gzindex=0,r.status=91)}else r.status=91;if(91===r.status)if(r.gzhead.comment){a=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>a&&(e.adler=o(e.adler,r.pending_buf,r.pending-a,a)),y(e),a=r.pending,r.pending===r.pending_buf_size)){l=1;break}l=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,E(r,l)}while(0!==l);r.gzhead.hcrc&&r.pending>a&&(e.adler=o(e.adler,r.pending_buf,r.pending-a,a)),0===l&&(r.status=d)}else r.status=d;if(r.status===d&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&y(e),r.pending+2<=r.pending_buf_size&&(E(r,255&e.adler),E(r,e.adler>>8&255),e.adler=0,r.status=f)):r.status=f),0!==r.pending){if(y(e),0===e.avail_out)return r.last_flush=-1,0}else if(0===e.avail_in&&m(t)<=m(n)&&4!==t)return g(e,-5);if(r.status===p&&0!==e.avail_in)return g(e,-5);if(0!==e.avail_in||0!==r.lookahead||0!==t&&r.status!==p){var w=2===r.strategy?function(e,t){for(var n;;){if(0===e.lookahead&&(k(e),0===e.lookahead)){if(0===t)return 1;break}if(e.match_length=0,n=s._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(b(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(b(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(b(e,!1),0===e.strm.avail_out)?1:2}(r,t):3===r.strategy?function(e,t){for(var n,i,r,a,o=e.window;;){if(e.lookahead<=u){if(k(e),e.lookahead<=u&&0===t)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(i=o[r=e.strstart-1])===o[++r]&&i===o[++r]&&i===o[++r]){a=e.strstart+u;do{}while(i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&r<a);e.match_length=u-(a-r),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=s._tr_tally(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=s._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(b(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(b(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(b(e,!1),0===e.strm.avail_out)?1:2}(r,t):i[r.level].func(r,t);if(3!==w&&4!==w||(r.status=p),1===w||3===w)return 0===e.avail_out&&(r.last_flush=-1),0;if(2===w&&(1===t?s._tr_align(r):5!==t&&(s._tr_stored_block(r,0,0,!1),3===t&&(v(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),y(e),0===e.avail_out))return r.last_flush=-1,0}return 4!==t?0:r.wrap<=0?1:(2===r.wrap?(E(r,255&e.adler),E(r,e.adler>>8&255),E(r,e.adler>>16&255),E(r,e.adler>>24&255),E(r,255&e.total_in),E(r,e.total_in>>8&255),E(r,e.total_in>>16&255),E(r,e.total_in>>24&255)):(S(r,e.adler>>>16),S(r,65535&e.adler)),y(e),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?0:1)},n.deflateEnd=function(e){var t;return e&&e.state?42!==(t=e.state.status)&&69!==t&&73!==t&&91!==t&&t!==d&&t!==f&&t!==p?g(e,c):(e.state=null,t===f?g(e,-3):0):c},n.deflateSetDictionary=function(e,t){var n,i,s,o,l,u,h,d,f=t.length;if(!e||!e.state)return c;if(2===(o=(n=e.state).wrap)||1===o&&42!==n.status||n.lookahead)return c;for(1===o&&(e.adler=a(e.adler,t,f,0)),n.wrap=0,f>=n.w_size&&(0===o&&(v(n.head),n.strstart=0,n.block_start=0,n.insert=0),d=new r.Buf8(n.w_size),r.arraySet(d,t,f-n.w_size,n.w_size,0),t=d,f=n.w_size),l=e.avail_in,u=e.next_in,h=e.input,e.avail_in=f,e.next_in=0,e.input=t,k(n);n.lookahead>=3;){i=n.strstart,s=n.lookahead-2;do{n.ins_h=(n.ins_h<<n.hash_shift^n.window[i+3-1])&n.hash_mask,n.prev[i&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=i,i++}while(--s);n.strstart=i,n.lookahead=2,k(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,e.next_in=u,e.input=h,e.avail_in=l,n.wrap=o,0},n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,t,n){"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,t,n){"use strict";t.exports=function(e,t){var n,i,r,s,a,o,l,c,u,h,d,f,p,g,m,v,y,b,E,S,w,T,k,_,x;n=e.state,i=e.next_in,_=e.input,r=i+(e.avail_in-5),s=e.next_out,x=e.output,a=s-(t-e.avail_out),o=s+(e.avail_out-257),l=n.dmax,c=n.wsize,u=n.whave,h=n.wnext,d=n.window,f=n.hold,p=n.bits,g=n.lencode,m=n.distcode,v=(1<<n.lenbits)-1,y=(1<<n.distbits)-1;e:do{p<15&&(f+=_[i++]<<p,p+=8,f+=_[i++]<<p,p+=8),b=g[f&v];t:for(;;){if(f>>>=E=b>>>24,p-=E,0==(E=b>>>16&255))x[s++]=65535&b;else{if(!(16&E)){if(64&E){if(32&E){n.mode=12;break e}e.msg="invalid literal/length code",n.mode=30;break e}b=g[(65535&b)+(f&(1<<E)-1)];continue t}for(S=65535&b,(E&=15)&&(p<E&&(f+=_[i++]<<p,p+=8),S+=f&(1<<E)-1,f>>>=E,p-=E),p<15&&(f+=_[i++]<<p,p+=8,f+=_[i++]<<p,p+=8),b=m[f&y];;){if(f>>>=E=b>>>24,p-=E,16&(E=b>>>16&255)){if(w=65535&b,p<(E&=15)&&(f+=_[i++]<<p,(p+=8)<E&&(f+=_[i++]<<p,p+=8)),(w+=f&(1<<E)-1)>l){e.msg="invalid distance too far back",n.mode=30;break e}if(f>>>=E,p-=E,w>(E=s-a)){if((E=w-E)>u&&n.sane){e.msg="invalid distance too far back",n.mode=30;break e}if(T=0,k=d,0===h){if(T+=c-E,E<S){S-=E;do{x[s++]=d[T++]}while(--E);T=s-w,k=x}}else if(h<E){if(T+=c+h-E,(E-=h)<S){S-=E;do{x[s++]=d[T++]}while(--E);if(T=0,h<S){S-=E=h;do{x[s++]=d[T++]}while(--E);T=s-w,k=x}}}else if(T+=h-E,E<S){S-=E;do{x[s++]=d[T++]}while(--E);T=s-w,k=x}for(;S>2;)x[s++]=k[T++],x[s++]=k[T++],x[s++]=k[T++],S-=3;S&&(x[s++]=k[T++],S>1&&(x[s++]=k[T++]))}else{T=s-w;do{x[s++]=x[T++],x[s++]=x[T++],x[s++]=x[T++],S-=3}while(S>2);S&&(x[s++]=x[T++],S>1&&(x[s++]=x[T++]))}break}if(64&E){e.msg="invalid distance code",n.mode=30;break e}b=m[(65535&b)+(f&(1<<E)-1)]}}break}}while(i<r&&s<o);i-=S=p>>3,f&=(1<<(p-=S<<3))-1,e.next_in=i,e.next_out=s,e.avail_in=i<r?r-i+5:5-(i-r),e.avail_out=s<o?o-s+257:257-(s-o),n.hold=f,n.bits=p}},{}],49:[function(e,t,n){"use strict";var i=e("../utils/common"),r=e("./adler32"),s=e("./crc32"),a=e("./inffast"),o=e("./inftrees"),l=-2,c=12,u=30;function h(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function d(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function f(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new i.Buf32(852),t.distcode=t.distdyn=new i.Buf32(592),t.sane=1,t.back=-1,0):l}function p(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,f(e)):l}function g(e,t){var n,i;return e&&e.state?(i=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?l:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=n,i.wbits=t,p(e))):l}function m(e,t){var n,i;return e?(i=new d,e.state=i,i.window=null,0!==(n=g(e,t))&&(e.state=null),n):l}var v,y,b=!0;function E(e){if(b){var t;for(v=new i.Buf32(512),y=new i.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(o(1,e.lens,0,288,v,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;o(2,e.lens,0,32,y,0,e.work,{bits:5}),b=!1}e.lencode=v,e.lenbits=9,e.distcode=y,e.distbits=5}function S(e,t,n,r){var s,a=e.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new i.Buf8(a.wsize)),r>=a.wsize?(i.arraySet(a.window,t,n-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):((s=a.wsize-a.wnext)>r&&(s=r),i.arraySet(a.window,t,n-r,s,a.wnext),(r-=s)?(i.arraySet(a.window,t,n-r,r,0),a.wnext=r,a.whave=a.wsize):(a.wnext+=s,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=s))),0}n.inflateReset=p,n.inflateReset2=g,n.inflateResetKeep=f,n.inflateInit=function(e){return m(e,15)},n.inflateInit2=m,n.inflate=function(e,t){var n,d,f,p,g,m,v,y,b,w,T,k,_,x,L,A,R,I,C,D,P,O,N,M,F=0,B=new i.Buf8(4),U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return l;(n=e.state).mode===c&&(n.mode=13),g=e.next_out,f=e.output,v=e.avail_out,p=e.next_in,d=e.input,m=e.avail_in,y=n.hold,b=n.bits,w=m,T=v,O=0;e:for(;;)switch(n.mode){case 1:if(0===n.wrap){n.mode=13;break}for(;b<16;){if(0===m)break e;m--,y+=d[p++]<<b,b+=8}if(2&n.wrap&&35615===y){n.check=0,B[0]=255&y,B[1]=y>>>8&255,n.check=s(n.check,B,2,0),y=0,b=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&y)<<8)+(y>>8))%31){e.msg="incorrect header check",n.mode=u;break}if(8!=(15&y)){e.msg="unknown compression method",n.mode=u;break}if(b-=4,P=8+(15&(y>>>=4)),0===n.wbits)n.wbits=P;else if(P>n.wbits){e.msg="invalid window size",n.mode=u;break}n.dmax=1<<P,e.adler=n.check=1,n.mode=512&y?10:c,y=0,b=0;break;case 2:for(;b<16;){if(0===m)break e;m--,y+=d[p++]<<b,b+=8}if(n.flags=y,8!=(255&n.flags)){e.msg="unknown compression method",n.mode=u;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=u;break}n.head&&(n.head.text=y>>8&1),512&n.flags&&(B[0]=255&y,B[1]=y>>>8&255,n.check=s(n.check,B,2,0)),y=0,b=0,n.mode=3;case 3:for(;b<32;){if(0===m)break e;m--,y+=d[p++]<<b,b+=8}n.head&&(n.head.time=y),512&n.flags&&(B[0]=255&y,B[1]=y>>>8&255,B[2]=y>>>16&255,B[3]=y>>>24&255,n.check=s(n.check,B,4,0)),y=0,b=0,n.mode=4;case 4:for(;b<16;){if(0===m)break e;m--,y+=d[p++]<<b,b+=8}n.head&&(n.head.xflags=255&y,n.head.os=y>>8),512&n.flags&&(B[0]=255&y,B[1]=y>>>8&255,n.check=s(n.check,B,2,0)),y=0,b=0,n.mode=5;case 5:if(1024&n.flags){for(;b<16;){if(0===m)break e;m--,y+=d[p++]<<b,b+=8}n.length=y,n.head&&(n.head.extra_len=y),512&n.flags&&(B[0]=255&y,B[1]=y>>>8&255,n.check=s(n.check,B,2,0)),y=0,b=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&((k=n.length)>m&&(k=m),k&&(n.head&&(P=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),i.arraySet(n.head.extra,d,p,k,P)),512&n.flags&&(n.check=s(n.check,d,k,p)),m-=k,p+=k,n.length-=k),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===m)break e;k=0;do{P=d[p+k++],n.head&&P&&n.length<65536&&(n.head.name+=String.fromCharCode(P))}while(P&&k<m);if(512&n.flags&&(n.check=s(n.check,d,k,p)),m-=k,p+=k,P)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===m)break e;k=0;do{P=d[p+k++],n.head&&P&&n.length<65536&&(n.head.comment+=String.fromCharCode(P))}while(P&&k<m);if(512&n.flags&&(n.check=s(n.check,d,k,p)),m-=k,p+=k,P)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;b<16;){if(0===m)break e;m--,y+=d[p++]<<b,b+=8}if(y!==(65535&n.check)){e.msg="header crc mismatch",n.mode=u;break}y=0,b=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=c;break;case 10:for(;b<32;){if(0===m)break e;m--,y+=d[p++]<<b,b+=8}e.adler=n.check=h(y),y=0,b=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=g,e.avail_out=v,e.next_in=p,e.avail_in=m,n.hold=y,n.bits=b,2;e.adler=n.check=1,n.mode=c;case c:if(5===t||6===t)break e;case 13:if(n.last){y>>>=7&b,b-=7&b,n.mode=27;break}for(;b<3;){if(0===m)break e;m--,y+=d[p++]<<b,b+=8}switch(n.last=1&y,b-=1,3&(y>>>=1)){case 0:n.mode=14;break;case 1:if(E(n),n.mode=20,6===t){y>>>=2,b-=2;break e}break;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=u}y>>>=2,b-=2;break;case 14:for(y>>>=7&b,b-=7&b;b<32;){if(0===m)break e;m--,y+=d[p++]<<b,b+=8}if((65535&y)!=(y>>>16^65535)){e.msg="invalid stored block lengths",n.mode=u;break}if(n.length=65535&y,y=0,b=0,n.mode=15,6===t)break e;case 15:n.mode=16;case 16:if(k=n.length){if(k>m&&(k=m),k>v&&(k=v),0===k)break e;i.arraySet(f,d,p,k,g),m-=k,p+=k,v-=k,g+=k,n.length-=k;break}n.mode=c;break;case 17:for(;b<14;){if(0===m)break e;m--,y+=d[p++]<<b,b+=8}if(n.nlen=257+(31&y),y>>>=5,b-=5,n.ndist=1+(31&y),y>>>=5,b-=5,n.ncode=4+(15&y),y>>>=4,b-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=u;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;b<3;){if(0===m)break e;m--,y+=d[p++]<<b,b+=8}n.lens[U[n.have++]]=7&y,y>>>=3,b-=3}for(;n.have<19;)n.lens[U[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,N={bits:n.lenbits},O=o(0,n.lens,0,19,n.lencode,0,n.work,N),n.lenbits=N.bits,O){e.msg="invalid code lengths set",n.mode=u;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;A=(F=n.lencode[y&(1<<n.lenbits)-1])>>>16&255,R=65535&F,!((L=F>>>24)<=b);){if(0===m)break e;m--,y+=d[p++]<<b,b+=8}if(R<16)y>>>=L,b-=L,n.lens[n.have++]=R;else{if(16===R){for(M=L+2;b<M;){if(0===m)break e;m--,y+=d[p++]<<b,b+=8}if(y>>>=L,b-=L,0===n.have){e.msg="invalid bit length repeat",n.mode=u;break}P=n.lens[n.have-1],k=3+(3&y),y>>>=2,b-=2}else if(17===R){for(M=L+3;b<M;){if(0===m)break e;m--,y+=d[p++]<<b,b+=8}b-=L,P=0,k=3+(7&(y>>>=L)),y>>>=3,b-=3}else{for(M=L+7;b<M;){if(0===m)break e;m--,y+=d[p++]<<b,b+=8}b-=L,P=0,k=11+(127&(y>>>=L)),y>>>=7,b-=7}if(n.have+k>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=u;break}for(;k--;)n.lens[n.have++]=P}}if(n.mode===u)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=u;break}if(n.lenbits=9,N={bits:n.lenbits},O=o(1,n.lens,0,n.nlen,n.lencode,0,n.work,N),n.lenbits=N.bits,O){e.msg="invalid literal/lengths set",n.mode=u;break}if(n.distbits=6,n.distcode=n.distdyn,N={bits:n.distbits},O=o(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,N),n.distbits=N.bits,O){e.msg="invalid distances set",n.mode=u;break}if(n.mode=20,6===t)break e;case 20:n.mode=21;case 21:if(m>=6&&v>=258){e.next_out=g,e.avail_out=v,e.next_in=p,e.avail_in=m,n.hold=y,n.bits=b,a(e,T),g=e.next_out,f=e.output,v=e.avail_out,p=e.next_in,d=e.input,m=e.avail_in,y=n.hold,b=n.bits,n.mode===c&&(n.back=-1);break}for(n.back=0;A=(F=n.lencode[y&(1<<n.lenbits)-1])>>>16&255,R=65535&F,!((L=F>>>24)<=b);){if(0===m)break e;m--,y+=d[p++]<<b,b+=8}if(A&&!(240&A)){for(I=L,C=A,D=R;A=(F=n.lencode[D+((y&(1<<I+C)-1)>>I)])>>>16&255,R=65535&F,!(I+(L=F>>>24)<=b);){if(0===m)break e;m--,y+=d[p++]<<b,b+=8}y>>>=I,b-=I,n.back+=I}if(y>>>=L,b-=L,n.back+=L,n.length=R,0===A){n.mode=26;break}if(32&A){n.back=-1,n.mode=c;break}if(64&A){e.msg="invalid literal/length code",n.mode=u;break}n.extra=15&A,n.mode=22;case 22:if(n.extra){for(M=n.extra;b<M;){if(0===m)break e;m--,y+=d[p++]<<b,b+=8}n.length+=y&(1<<n.extra)-1,y>>>=n.extra,b-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;A=(F=n.distcode[y&(1<<n.distbits)-1])>>>16&255,R=65535&F,!((L=F>>>24)<=b);){if(0===m)break e;m--,y+=d[p++]<<b,b+=8}if(!(240&A)){for(I=L,C=A,D=R;A=(F=n.distcode[D+((y&(1<<I+C)-1)>>I)])>>>16&255,R=65535&F,!(I+(L=F>>>24)<=b);){if(0===m)break e;m--,y+=d[p++]<<b,b+=8}y>>>=I,b-=I,n.back+=I}if(y>>>=L,b-=L,n.back+=L,64&A){e.msg="invalid distance code",n.mode=u;break}n.offset=R,n.extra=15&A,n.mode=24;case 24:if(n.extra){for(M=n.extra;b<M;){if(0===m)break e;m--,y+=d[p++]<<b,b+=8}n.offset+=y&(1<<n.extra)-1,y>>>=n.extra,b-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=u;break}n.mode=25;case 25:if(0===v)break e;if(k=T-v,n.offset>k){if((k=n.offset-k)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=u;break}k>n.wnext?(k-=n.wnext,_=n.wsize-k):_=n.wnext-k,k>n.length&&(k=n.length),x=n.window}else x=f,_=g-n.offset,k=n.length;k>v&&(k=v),v-=k,n.length-=k;do{f[g++]=x[_++]}while(--k);0===n.length&&(n.mode=21);break;case 26:if(0===v)break e;f[g++]=n.length,v--,n.mode=21;break;case 27:if(n.wrap){for(;b<32;){if(0===m)break e;m--,y|=d[p++]<<b,b+=8}if(T-=v,e.total_out+=T,n.total+=T,T&&(e.adler=n.check=n.flags?s(n.check,f,T,g-T):r(n.check,f,T,g-T)),T=v,(n.flags?y:h(y))!==n.check){e.msg="incorrect data check",n.mode=u;break}y=0,b=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;b<32;){if(0===m)break e;m--,y+=d[p++]<<b,b+=8}if(y!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=u;break}y=0,b=0}n.mode=29;case 29:O=1;break e;case u:O=-3;break e;case 31:return-4;default:return l}return e.next_out=g,e.avail_out=v,e.next_in=p,e.avail_in=m,n.hold=y,n.bits=b,(n.wsize||T!==e.avail_out&&n.mode<u&&(n.mode<27||4!==t))&&S(e,e.output,e.next_out,T-e.avail_out)?(n.mode=31,-4):(w-=e.avail_in,T-=e.avail_out,e.total_in+=w,e.total_out+=T,n.total+=T,n.wrap&&T&&(e.adler=n.check=n.flags?s(n.check,f,T,e.next_out-T):r(n.check,f,T,e.next_out-T)),e.data_type=n.bits+(n.last?64:0)+(n.mode===c?128:0)+(20===n.mode||15===n.mode?256:0),(0===w&&0===T||4===t)&&0===O&&(O=-5),O)},n.inflateEnd=function(e){if(!e||!e.state)return l;var t=e.state;return t.window&&(t.window=null),e.state=null,0},n.inflateGetHeader=function(e,t){var n;return e&&e.state&&2&(n=e.state).wrap?(n.head=t,t.done=!1,0):l},n.inflateSetDictionary=function(e,t){var n,i=t.length;return e&&e.state?0!==(n=e.state).wrap&&11!==n.mode?l:11===n.mode&&r(1,t,i,0)!==n.check?-3:S(e,t,i,i)?(n.mode=31,-4):(n.havedict=1,0):l},n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,t,n){"use strict";var i=e("../utils/common"),r=15,s=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],l=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,n,c,u,h,d,f){var p,g,m,v,y,b,E,S,w,T=f.bits,k=0,_=0,x=0,L=0,A=0,R=0,I=0,C=0,D=0,P=0,O=null,N=0,M=new i.Buf16(16),F=new i.Buf16(16),B=null,U=0;for(k=0;k<=r;k++)M[k]=0;for(_=0;_<c;_++)M[t[n+_]]++;for(A=T,L=r;L>=1&&0===M[L];L--);if(A>L&&(A=L),0===L)return u[h++]=20971520,u[h++]=20971520,f.bits=1,0;for(x=1;x<L&&0===M[x];x++);for(A<x&&(A=x),C=1,k=1;k<=r;k++)if(C<<=1,(C-=M[k])<0)return-1;if(C>0&&(0===e||1!==L))return-1;for(F[1]=0,k=1;k<r;k++)F[k+1]=F[k]+M[k];for(_=0;_<c;_++)0!==t[n+_]&&(d[F[t[n+_]]++]=_);if(0===e?(O=B=d,b=19):1===e?(O=s,N-=257,B=a,U-=257,b=256):(O=o,B=l,b=-1),P=0,_=0,k=x,y=h,R=A,I=0,m=-1,v=(D=1<<A)-1,1===e&&D>852||2===e&&D>592)return 1;for(;;){E=k-I,d[_]<b?(S=0,w=d[_]):d[_]>b?(S=B[U+d[_]],w=O[N+d[_]]):(S=96,w=0),p=1<<k-I,x=g=1<<R;do{u[y+(P>>I)+(g-=p)]=E<<24|S<<16|w}while(0!==g);for(p=1<<k-1;P&p;)p>>=1;if(0!==p?(P&=p-1,P+=p):P=0,_++,0===--M[k]){if(k===L)break;k=t[n+d[_]]}if(k>A&&(P&v)!==m){for(0===I&&(I=A),y+=x,C=1<<(R=k-I);R+I<L&&!((C-=M[R+I])<=0);)R++,C<<=1;if(D+=1<<R,1===e&&D>852||2===e&&D>592)return 1;u[m=P&v]=A<<24|R<<16|y-h}}return 0!==P&&(u[y+P]=k-I<<24|64<<16),f.bits=A,0}},{"../utils/common":41}],51:[function(e,t,n){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,t,n){"use strict";var i=e("../utils/common");function r(e){for(var t=e.length;--t>=0;)e[t]=0}var s=256,a=286,o=30,l=15,c=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],u=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],h=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],d=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],f=new Array(576);r(f);var p=new Array(60);r(p);var g=new Array(512);r(g);var m=new Array(256);r(m);var v=new Array(29);r(v);var y,b,E,S=new Array(o);function w(e,t,n,i,r){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=i,this.max_length=r,this.has_stree=e&&e.length}function T(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function k(e){return e<256?g[e]:g[256+(e>>>7)]}function _(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function x(e,t,n){e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,_(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function L(e,t,n){x(e,n[2*t],n[2*t+1])}function A(e,t){var n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1}function R(e,t,n){var i,r,s=new Array(16),a=0;for(i=1;i<=l;i++)s[i]=a=a+n[i-1]<<1;for(r=0;r<=t;r++){var o=e[2*r+1];0!==o&&(e[2*r]=A(s[o]++,o))}}function I(e){var t;for(t=0;t<a;t++)e.dyn_ltree[2*t]=0;for(t=0;t<o;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function C(e){e.bi_valid>8?_(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function D(e,t,n,i){var r=2*t,s=2*n;return e[r]<e[s]||e[r]===e[s]&&i[t]<=i[n]}function P(e,t,n){for(var i=e.heap[n],r=n<<1;r<=e.heap_len&&(r<e.heap_len&&D(t,e.heap[r+1],e.heap[r],e.depth)&&r++,!D(t,i,e.heap[r],e.depth));)e.heap[n]=e.heap[r],n=r,r<<=1;e.heap[n]=i}function O(e,t,n){var i,r,a,o,l=0;if(0!==e.last_lit)do{i=e.pending_buf[e.d_buf+2*l]<<8|e.pending_buf[e.d_buf+2*l+1],r=e.pending_buf[e.l_buf+l],l++,0===i?L(e,r,t):(L(e,(a=m[r])+s+1,t),0!==(o=c[a])&&x(e,r-=v[a],o),L(e,a=k(--i),n),0!==(o=u[a])&&x(e,i-=S[a],o))}while(l<e.last_lit);L(e,256,t)}function N(e,t){var n,i,r,s=t.dyn_tree,a=t.stat_desc.static_tree,o=t.stat_desc.has_stree,c=t.stat_desc.elems,u=-1;for(e.heap_len=0,e.heap_max=573,n=0;n<c;n++)0!==s[2*n]?(e.heap[++e.heap_len]=u=n,e.depth[n]=0):s[2*n+1]=0;for(;e.heap_len<2;)s[2*(r=e.heap[++e.heap_len]=u<2?++u:0)]=1,e.depth[r]=0,e.opt_len--,o&&(e.static_len-=a[2*r+1]);for(t.max_code=u,n=e.heap_len>>1;n>=1;n--)P(e,s,n);r=c;do{n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],P(e,s,1),i=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=i,s[2*r]=s[2*n]+s[2*i],e.depth[r]=(e.depth[n]>=e.depth[i]?e.depth[n]:e.depth[i])+1,s[2*n+1]=s[2*i+1]=r,e.heap[1]=r++,P(e,s,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var n,i,r,s,a,o,c=t.dyn_tree,u=t.max_code,h=t.stat_desc.static_tree,d=t.stat_desc.has_stree,f=t.stat_desc.extra_bits,p=t.stat_desc.extra_base,g=t.stat_desc.max_length,m=0;for(s=0;s<=l;s++)e.bl_count[s]=0;for(c[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<573;n++)(s=c[2*c[2*(i=e.heap[n])+1]+1]+1)>g&&(s=g,m++),c[2*i+1]=s,i>u||(e.bl_count[s]++,a=0,i>=p&&(a=f[i-p]),o=c[2*i],e.opt_len+=o*(s+a),d&&(e.static_len+=o*(h[2*i+1]+a)));if(0!==m){do{for(s=g-1;0===e.bl_count[s];)s--;e.bl_count[s]--,e.bl_count[s+1]+=2,e.bl_count[g]--,m-=2}while(m>0);for(s=g;0!==s;s--)for(i=e.bl_count[s];0!==i;)(r=e.heap[--n])>u||(c[2*r+1]!==s&&(e.opt_len+=(s-c[2*r+1])*c[2*r],c[2*r+1]=s),i--)}}(e,t),R(s,u,e.bl_count)}function M(e,t,n){var i,r,s=-1,a=t[1],o=0,l=7,c=4;for(0===a&&(l=138,c=3),t[2*(n+1)+1]=65535,i=0;i<=n;i++)r=a,a=t[2*(i+1)+1],++o<l&&r===a||(o<c?e.bl_tree[2*r]+=o:0!==r?(r!==s&&e.bl_tree[2*r]++,e.bl_tree[32]++):o<=10?e.bl_tree[34]++:e.bl_tree[36]++,o=0,s=r,0===a?(l=138,c=3):r===a?(l=6,c=3):(l=7,c=4))}function F(e,t,n){var i,r,s=-1,a=t[1],o=0,l=7,c=4;for(0===a&&(l=138,c=3),i=0;i<=n;i++)if(r=a,a=t[2*(i+1)+1],!(++o<l&&r===a)){if(o<c)do{L(e,r,e.bl_tree)}while(0!==--o);else 0!==r?(r!==s&&(L(e,r,e.bl_tree),o--),L(e,16,e.bl_tree),x(e,o-3,2)):o<=10?(L(e,17,e.bl_tree),x(e,o-3,3)):(L(e,18,e.bl_tree),x(e,o-11,7));o=0,s=r,0===a?(l=138,c=3):r===a?(l=6,c=3):(l=7,c=4)}}r(S);var B=!1;function U(e,t,n,r){x(e,0+(r?1:0),3),function(e,t,n,r){C(e),r&&(_(e,n),_(e,~n)),i.arraySet(e.pending_buf,e.window,t,n,e.pending),e.pending+=n}(e,t,n,!0)}n._tr_init=function(e){B||(function(){var e,t,n,i,r,s=new Array(16);for(n=0,i=0;i<28;i++)for(v[i]=n,e=0;e<1<<c[i];e++)m[n++]=i;for(m[n-1]=i,r=0,i=0;i<16;i++)for(S[i]=r,e=0;e<1<<u[i];e++)g[r++]=i;for(r>>=7;i<o;i++)for(S[i]=r<<7,e=0;e<1<<u[i]-7;e++)g[256+r++]=i;for(t=0;t<=l;t++)s[t]=0;for(e=0;e<=143;)f[2*e+1]=8,e++,s[8]++;for(;e<=255;)f[2*e+1]=9,e++,s[9]++;for(;e<=279;)f[2*e+1]=7,e++,s[7]++;for(;e<=287;)f[2*e+1]=8,e++,s[8]++;for(R(f,287,s),e=0;e<o;e++)p[2*e+1]=5,p[2*e]=A(e,5);y=new w(f,c,257,a,l),b=new w(p,u,0,o,l),E=new w(new Array(0),h,0,19,7)}(),B=!0),e.l_desc=new T(e.dyn_ltree,y),e.d_desc=new T(e.dyn_dtree,b),e.bl_desc=new T(e.bl_tree,E),e.bi_buf=0,e.bi_valid=0,I(e)},n._tr_stored_block=U,n._tr_flush_block=function(e,t,n,i){var r,a,o=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<s;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),N(e,e.l_desc),N(e,e.d_desc),o=function(e){var t;for(M(e,e.dyn_ltree,e.l_desc.max_code),M(e,e.dyn_dtree,e.d_desc.max_code),N(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*d[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),r=e.opt_len+3+7>>>3,(a=e.static_len+3+7>>>3)<=r&&(r=a)):r=a=n+5,n+4<=r&&-1!==t?U(e,t,n,i):4===e.strategy||a===r?(x(e,2+(i?1:0),3),O(e,f,p)):(x(e,4+(i?1:0),3),function(e,t,n,i){var r;for(x(e,t-257,5),x(e,n-1,5),x(e,i-4,4),r=0;r<i;r++)x(e,e.bl_tree[2*d[r]+1],3);F(e,e.dyn_ltree,t-1),F(e,e.dyn_dtree,n-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,o+1),O(e,e.dyn_ltree,e.dyn_dtree)),I(e),i&&C(e)},n._tr_tally=function(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(m[n]+s+1)]++,e.dyn_dtree[2*k(t)]++),e.last_lit===e.lit_bufsize-1},n._tr_align=function(e){x(e,2,3),L(e,256,f),function(e){16===e.bi_valid?(_(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},{"../utils/common":41}],53:[function(e,t,n){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,t,i){(function(e){!function(e){"use strict";if(!e.setImmediate){var t,n=1,i={},r=!1,s=e.document,a=Object.getPrototypeOf&&Object.getPrototypeOf(e);a=a&&a.setTimeout?a:e,"[object process]"==={}.toString.call(e.process)?t=function(e){process.nextTick(function(){d(e)})}:function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?(c="setImmediate$"+Math.random()+"$",u=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(c)&&d(+t.data.slice(c.length))},e.addEventListener?e.addEventListener("message",u,!1):e.attachEvent("onmessage",u),t=function(t){e.postMessage(c+t,"*")}):e.MessageChannel?((l=new MessageChannel).port1.onmessage=function(e){d(e.data)},t=function(e){l.port2.postMessage(e)}):s&&"onreadystatechange"in s.createElement("script")?(o=s.documentElement,t=function(e){var t=s.createElement("script");t.onreadystatechange=function(){d(e),t.onreadystatechange=null,o.removeChild(t),t=null},o.appendChild(t)}):t=function(e){setTimeout(d,0,e)},a.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var r=new Array(arguments.length-1),s=0;s<r.length;s++)r[s]=arguments[s+1];var a={callback:e,args:r};return i[n]=a,t(n),n++},a.clearImmediate=h}var o,l,c,u;function h(e){delete i[e]}function d(e){if(r)setTimeout(d,0,e);else{var t=i[e];if(t){r=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(void 0,n)}}(t)}finally{h(e),r=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,void 0!==n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[10])(10)}},i={};function r(e){var t=i[e];if(void 0!==t)return t.exports;var s=i[e]={id:e,exports:{}};return n[e](s,s.exports,r),s.exports}r.m=n,r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,r.t=function(n,i){if(1&i&&(n=this(n)),8&i)return n;if("object"==typeof n&&n){if(4&i&&n.__esModule)return n;if(16&i&&"function"==typeof n.then)return n}var s=Object.create(null);r.r(s);var a={};e=e||[null,t({}),t([]),t(t)];for(var o=2&i&&n;("object"==typeof o||"function"==typeof o)&&!~e.indexOf(o);o=t(o))Object.getOwnPropertyNames(o).forEach(e=>a[e]=()=>n[e]);return a.default=()=>n,r.d(s,a),s},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.p="/AwesomeWeb/",r.b=document.baseURI||self.location.href,r.nc=void 0,(()=>{"use strict";var e=r(4848),t=r(6540),n=r.t(t,2),i=r(5338),s=r(5072),a=r.n(s),o=r(7825),l=r.n(o),c=r(7659),u=r.n(c),h=r(5056),d=r.n(h),f=r(540),p=r.n(f),g=r(1113),m=r.n(g),v=r(1081),y={};y.styleTagTransform=m(),y.setAttributes=d(),y.insert=u().bind(null,"head"),y.domAPI=l(),y.insertStyleElement=p(),a()(v.A,y),v.A&&v.A.locals&&v.A.locals;var b,E=r(961),S=r.t(E,2);function w(){return w=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},w.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(b||(b={}));const T="popstate";function k(e,t){if(!1===e||null==e)throw new Error(t)}function _(e,t){if(!e){"undefined"!=typeof console&&console.warn(t);try{throw new Error(t)}catch(e){}}}function x(e,t){return{usr:e.state,key:e.key,idx:t}}function L(e,t,n,i){return void 0===n&&(n=null),w({pathname:"string"==typeof e?e:e.pathname,search:"",hash:""},"string"==typeof t?R(t):t,{state:n,key:t&&t.key||i||Math.random().toString(36).substr(2,8)})}function A(e){let{pathname:t="/",search:n="",hash:i=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),i&&"#"!==i&&(t+="#"===i.charAt(0)?i:"#"+i),t}function R(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let i=e.indexOf("?");i>=0&&(t.search=e.substr(i),e=e.substr(0,i)),e&&(t.pathname=e)}return t}var I;function C(e,t,n){return void 0===n&&(n="/"),function(e,t,n,i){let r=q(("string"==typeof t?R(t):t).pathname||"/",n);if(null==r)return null;let s=D(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){return e.length===t.length&&e.slice(0,-1).every((e,n)=>e===t[n])?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(s);let a=null;for(let e=0;null==a&&e<s.length;++e){let t=V(r);a=z(s[e],t,i)}return a}(e,t,n,!1)}function D(e,t,n,i){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===i&&(i="");let r=(e,r,s)=>{let a={relativePath:void 0===s?e.path||"":s,caseSensitive:!0===e.caseSensitive,childrenIndex:r,route:e};a.relativePath.startsWith("/")&&(k(a.relativePath.startsWith(i),'Absolute route path "'+a.relativePath+'" nested under path "'+i+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),a.relativePath=a.relativePath.slice(i.length));let o=W([i,a.relativePath]),l=n.concat(a);e.children&&e.children.length>0&&(k(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+o+'".'),D(e.children,t,l,o)),(null!=e.path||e.index)&&t.push({path:o,score:j(o,e.index),routesMeta:l})};return e.forEach((e,t)=>{var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?"))for(let n of P(e.path))r(e,t,n);else r(e,t)}),t}function P(e){let t=e.split("/");if(0===t.length)return[];let[n,...i]=t,r=n.endsWith("?"),s=n.replace(/\?$/,"");if(0===i.length)return r?[s,""]:[s];let a=P(i.join("/")),o=[];return o.push(...a.map(e=>""===e?s:[s,e].join("/"))),r&&o.push(...a),o.map(t=>e.startsWith("/")&&""===t?"/":t)}!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(I||(I={})),new Set(["lazy","caseSensitive","path","id","index","children"]);const O=/^:[\w-]+$/,N=3,M=2,F=1,B=10,U=-2,$=e=>"*"===e;function j(e,t){let n=e.split("/"),i=n.length;return n.some($)&&(i+=U),t&&(i+=M),n.filter(e=>!$(e)).reduce((e,t)=>e+(O.test(t)?N:""===t?F:B),i)}function z(e,t,n){void 0===n&&(n=!1);let{routesMeta:i}=e,r={},s="/",a=[];for(let e=0;e<i.length;++e){let o=i[e],l=e===i.length-1,c="/"===s?t:t.slice(s.length)||"/",u=G({path:o.relativePath,caseSensitive:o.caseSensitive,end:l},c),h=o.route;if(!u&&l&&n&&!i[i.length-1].route.index&&(u=G({path:o.relativePath,caseSensitive:o.caseSensitive,end:!1},c)),!u)return null;Object.assign(r,u.params),a.push({params:r,pathname:W([s,u.pathname]),pathnameBase:K(W([s,u.pathnameBase])),route:h}),"/"!==u.pathnameBase&&(s=W([s,u.pathnameBase]))}return a}function G(e,t){"string"==typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,i]=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!0),_("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let i=[],r="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,n)=>(i.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(i.push({paramName:"*"}),r+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":""!==e&&"/"!==e&&(r+="(?:(?=\\/|$))"),[new RegExp(r,t?void 0:"i"),i]}(e.path,e.caseSensitive,e.end),r=t.match(n);if(!r)return null;let s=r[0],a=s.replace(/(.)\/+$/,"$1"),o=r.slice(1);return{params:i.reduce((e,t,n)=>{let{paramName:i,isOptional:r}=t;if("*"===i){let e=o[n]||"";a=s.slice(0,s.length-e.length).replace(/(.)\/+$/,"$1")}const l=o[n];return e[i]=r&&!l?void 0:(l||"").replace(/%2F/g,"/"),e},{}),pathname:s,pathnameBase:a,pattern:e}}function V(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return _(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function q(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,i=e.charAt(n);return i&&"/"!==i?null:e.slice(n)||"/"}function H(e,t,n,i){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(i)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}const W=e=>e.join("/").replace(/\/\/+/g,"/"),K=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Y=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",X=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;const Q=["post","put","patch","delete"],Z=(new Set(Q),["get",...Q]);function J(){return J=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},J.apply(this,arguments)}new Set(Z),new Set([301,302,303,307,308]),new Set([307,308]),Symbol("deferred");const ee=t.createContext(null),te=t.createContext(null),ne=t.createContext(null),ie=t.createContext(null),re=t.createContext({outlet:null,matches:[],isDataRoute:!1}),se=t.createContext(null);function ae(){return null!=t.useContext(ie)}function oe(){return ae()||k(!1),t.useContext(ie).location}function le(e){t.useContext(ne).static||t.useLayoutEffect(e)}function ce(){let{isDataRoute:e}=t.useContext(re);return e?function(){let{router:e}=function(){let e=t.useContext(ee);return e||k(!1),e}(me.UseNavigateStable),n=ye(ve.UseNavigateStable),i=t.useRef(!1);le(()=>{i.current=!0});let r=t.useCallback(function(t,r){void 0===r&&(r={}),i.current&&("number"==typeof t?e.navigate(t):e.navigate(t,J({fromRouteId:n},r)))},[e,n]);return r}():function(){ae()||k(!1);let e=t.useContext(ee),{basename:n,future:i,navigator:r}=t.useContext(ne),{matches:s}=t.useContext(re),{pathname:a}=oe(),o=JSON.stringify(function(e,t){let n=function(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}(e);return t?n.map((e,t)=>t===n.length-1?e.pathname:e.pathnameBase):n.map(e=>e.pathnameBase)}(s,i.v7_relativeSplatPath)),l=t.useRef(!1);le(()=>{l.current=!0});let c=t.useCallback(function(t,i){if(void 0===i&&(i={}),!l.current)return;if("number"==typeof t)return void r.go(t);let s=function(e,t,n,i){let r;void 0===i&&(i=!1),"string"==typeof e?r=R(e):(r=w({},e),k(!r.pathname||!r.pathname.includes("?"),H("?","pathname","search",r)),k(!r.pathname||!r.pathname.includes("#"),H("#","pathname","hash",r)),k(!r.search||!r.search.includes("#"),H("#","search","hash",r)));let s,a=""===e||""===r.pathname,o=a?"/":r.pathname;if(null==o)s=n;else{let e=t.length-1;if(!i&&o.startsWith("..")){let t=o.split("/");for(;".."===t[0];)t.shift(),e-=1;r.pathname=t.join("/")}s=e>=0?t[e]:"/"}let l=function(e,t){void 0===t&&(t="/");let{pathname:n,search:i="",hash:r=""}="string"==typeof e?R(e):e,s=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)}),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:s,search:Y(i),hash:X(r)}}(r,s),c=o&&"/"!==o&&o.endsWith("/"),u=(a||"."===o)&&n.endsWith("/");return l.pathname.endsWith("/")||!c&&!u||(l.pathname+="/"),l}(t,JSON.parse(o),a,"path"===i.relative);null==e&&"/"!==n&&(s.pathname="/"===s.pathname?n:W([n,s.pathname])),(i.replace?r.replace:r.push)(s,i.state,i)},[n,r,o,a,e]);return c}()}function ue(){let{matches:e}=t.useContext(re),n=e[e.length-1];return n?n.params:{}}function he(e,n,i,r){ae()||k(!1);let{navigator:s}=t.useContext(ne),{matches:a}=t.useContext(re),o=a[a.length-1],l=o?o.params:{},c=(o&&o.pathname,o?o.pathnameBase:"/");o&&o.route;let u,h=oe();if(n){var d;let e="string"==typeof n?R(n):n;"/"===c||(null==(d=e.pathname)?void 0:d.startsWith(c))||k(!1),u=e}else u=h;let f=u.pathname||"/",p=f;if("/"!==c){let e=c.replace(/^\//,"").split("/");p="/"+f.replace(/^\//,"").split("/").slice(e.length).join("/")}let g=C(e,{pathname:p}),m=function(e,n,i,r){var s;if(void 0===n&&(n=[]),void 0===i&&(i=null),void 0===r&&(r=null),null==e){var a;if(!i)return null;if(i.errors)e=i.matches;else{if(!(null!=(a=r)&&a.v7_partialHydration&&0===n.length&&!i.initialized&&i.matches.length>0))return null;e=i.matches}}let o=e,l=null==(s=i)?void 0:s.errors;if(null!=l){let e=o.findIndex(e=>e.route.id&&void 0!==(null==l?void 0:l[e.route.id]));e>=0||k(!1),o=o.slice(0,Math.min(o.length,e+1))}let c=!1,u=-1;if(i&&r&&r.v7_partialHydration)for(let e=0;e<o.length;e++){let t=o[e];if((t.route.HydrateFallback||t.route.hydrateFallbackElement)&&(u=e),t.route.id){let{loaderData:e,errors:n}=i,r=t.route.loader&&void 0===e[t.route.id]&&(!n||void 0===n[t.route.id]);if(t.route.lazy||r){c=!0,o=u>=0?o.slice(0,u+1):[o[0]];break}}}return o.reduceRight((e,r,s)=>{let a,h=!1,d=null,f=null;var p;i&&(a=l&&r.route.id?l[r.route.id]:void 0,d=r.route.errorElement||fe,c&&(u<0&&0===s?(be[p="route-fallback"]||(be[p]=!0),h=!0,f=null):u===s&&(h=!0,f=r.route.hydrateFallbackElement||null)));let g=n.concat(o.slice(0,s+1)),m=()=>{let n;return n=a?d:h?f:r.route.Component?t.createElement(r.route.Component,null):r.route.element?r.route.element:e,t.createElement(ge,{match:r,routeContext:{outlet:e,matches:g,isDataRoute:null!=i},children:n})};return i&&(r.route.ErrorBoundary||r.route.errorElement||0===s)?t.createElement(pe,{location:i.location,revalidation:i.revalidation,component:d,error:a,children:m(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):m()},null)}(g&&g.map(e=>Object.assign({},e,{params:Object.assign({},l,e.params),pathname:W([c,s.encodeLocation?s.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?c:W([c,s.encodeLocation?s.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})),a,i,r);return n&&m?t.createElement(ie.Provider,{value:{location:J({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:b.Pop}},m):m}function de(){let e=function(){var e;let n=t.useContext(se),i=function(){let e=t.useContext(te);return e||k(!1),e}(ve.UseRouteError),r=ye(ve.UseRouteError);return void 0!==n?n:null==(e=i.errors)?void 0:e[r]}(),n=function(e){return null!=e&&"number"==typeof e.status&&"string"==typeof e.statusText&&"boolean"==typeof e.internal&&"data"in e}(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),i=e instanceof Error?e.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return t.createElement(t.Fragment,null,t.createElement("h2",null,"Unexpected Application Error!"),t.createElement("h3",{style:{fontStyle:"italic"}},n),i?t.createElement("pre",{style:r},i):null,null)}const fe=t.createElement(de,null);class pe extends t.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?t.createElement(re.Provider,{value:this.props.routeContext},t.createElement(se.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function ge(e){let{routeContext:n,match:i,children:r}=e,s=t.useContext(ee);return s&&s.static&&s.staticContext&&(i.route.errorElement||i.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=i.route.id),t.createElement(re.Provider,{value:n},r)}var me=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(me||{}),ve=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(ve||{});function ye(e){let n=function(){let e=t.useContext(re);return e||k(!1),e}(),i=n.matches[n.matches.length-1];return i.route.id||k(!1),i.route.id}const be={};function Ee(e){k(!1)}function Se(e){let{basename:n="/",children:i=null,location:r,navigationType:s=b.Pop,navigator:a,static:o=!1,future:l}=e;ae()&&k(!1);let c=n.replace(/^\/*/,"/"),u=t.useMemo(()=>({basename:c,navigator:a,static:o,future:J({v7_relativeSplatPath:!1},l)}),[c,l,a,o]);"string"==typeof r&&(r=R(r));let{pathname:h="/",search:d="",hash:f="",state:p=null,key:g="default"}=r,m=t.useMemo(()=>{let e=q(h,c);return null==e?null:{location:{pathname:e,search:d,hash:f,state:p,key:g},navigationType:s}},[c,h,d,f,p,g,s]);return null==m?null:t.createElement(ne.Provider,{value:u},t.createElement(ie.Provider,{children:i,value:m}))}function we(e){let{children:t,location:n}=e;return he(Te(t),n)}function Te(e,n){void 0===n&&(n=[]);let i=[];return t.Children.forEach(e,(e,r)=>{if(!t.isValidElement(e))return;let s=[...n,r];if(e.type===t.Fragment)return void i.push.apply(i,Te(e.props.children,s));e.type!==Ee&&k(!1),e.props.index&&e.props.children&&k(!1);let a={id:e.props.id||s.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(a.children=Te(e.props.children,s)),i.push(a)}),i}n.startTransition,new Promise(()=>{}),t.Component,new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);try{window.__reactRouterVersion="6"}catch(e){}new Map;const ke=n.startTransition;function _e(e){let{basename:n,children:i,future:r,window:s}=e,a=t.useRef();null==a.current&&(a.current=function(e){return void 0===e&&(e={}),function(e,t,n,i){void 0===i&&(i={});let{window:r=document.defaultView,v5Compat:s=!1}=i,a=r.history,o=b.Pop,l=null,c=u();function u(){return(a.state||{idx:null}).idx}function h(){o=b.Pop;let e=u(),t=null==e?null:e-c;c=e,l&&l({action:o,location:f.location,delta:t})}function d(e){let t="null"!==r.location.origin?r.location.origin:r.location.href,n="string"==typeof e?e:A(e);return n=n.replace(/ $/,"%20"),k(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}null==c&&(c=0,a.replaceState(w({},a.state,{idx:c}),""));let f={get action(){return o},get location(){return e(r,a)},listen(e){if(l)throw new Error("A history only accepts one active listener");return r.addEventListener(T,h),l=e,()=>{r.removeEventListener(T,h),l=null}},createHref:e=>t(r,e),createURL:d,encodeLocation(e){let t=d(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){o=b.Push;let i=L(f.location,e,t);n&&n(i,e),c=u()+1;let h=x(i,c),d=f.createHref(i);try{a.pushState(h,"",d)}catch(e){if(e instanceof DOMException&&"DataCloneError"===e.name)throw e;r.location.assign(d)}s&&l&&l({action:o,location:f.location,delta:1})},replace:function(e,t){o=b.Replace;let i=L(f.location,e,t);n&&n(i,e),c=u();let r=x(i,c),h=f.createHref(i);a.replaceState(r,"",h),s&&l&&l({action:o,location:f.location,delta:0})},go:e=>a.go(e)};return f}(function(e,t){let{pathname:n,search:i,hash:r}=e.location;return L("",{pathname:n,search:i,hash:r},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"==typeof t?t:A(t)},null,e)}({window:s,v5Compat:!0}));let o=a.current,[l,c]=t.useState({action:o.action,location:o.location}),{v7_startTransition:u}=r||{},h=t.useCallback(e=>{u&&ke?ke(()=>c(e)):c(e)},[c,u]);return t.useLayoutEffect(()=>o.listen(h),[o,h]),t.useEffect(()=>{return null==(e=r)||e.v7_startTransition,void 0===(null==e?void 0:e.v7_relativeSplatPath)&&(!t||t.v7_relativeSplatPath),void(t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation));var e,t},[r]),t.createElement(Se,{basename:n,children:i,location:l.location,navigationType:l.action,navigator:o,future:r})}var xe,Le;S.flushSync,n.useId,"undefined"!=typeof window&&void 0!==window.document&&window.document.createElement,function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"}(xe||(xe={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(Le||(Le={}));var Ae=r(1029),Re={};Re.styleTagTransform=m(),Re.setAttributes=d(),Re.insert=u().bind(null,"head"),Re.domAPI=l(),Re.insertStyleElement=p(),a()(Ae.A,Re),Ae.A&&Ae.A.locals&&Ae.A.locals;const Ie=t=>{const{score:n}=t;return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)("span",{className:"star "+(()=>{let e=n/2;const t=Math.floor(e/10);let i=Math.floor(e%10);return i>0&&(i=5),e=10*t+i,"star"+e})()})})},Ce=t=>{const{score:n}=t;return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)("div",{children:[(0,e.jsx)(Ie,{score:n}),(0,e.jsx)("span",{style:{color:"#ffac2d"},children:Number(n/10).toFixed(1)})]})})};var De=r(7297),Pe={};Pe.styleTagTransform=m(),Pe.setAttributes=d(),Pe.insert=u().bind(null,"head"),Pe.domAPI=l(),Pe.insertStyleElement=p(),a()(De.A,Pe),De.A&&De.A.locals&&De.A.locals;const Oe=t=>{const{data:n}=t,{cover:i,name:r,score:s,details:a}=n,{date:o,directors:l,actors:c,types:u,region:h,alias:d,intro:f}=a,p=e=>Array.isArray(e)?e.join(" / "):e;return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)("div",{className:"video-card",children:[(0,e.jsx)("img",{style:{width:"40%",display:"block",paddingRight:"10px"},src:i}),(0,e.jsxs)("div",{className:"info",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("h1",{className:"title",children:r}),(0,e.jsx)("span",{className:"date",children:` (${o})`}),(0,e.jsx)(Ce,{score:s})]}),(0,e.jsxs)("div",{className:"property",children:[(0,e.jsx)("span",{className:"key",children:"导演 : "}),(0,e.jsx)("span",{className:"value",children:p(l)})]}),(0,e.jsxs)("div",{className:"property",children:[(0,e.jsx)("span",{className:"key",children:"主演 : "}),(0,e.jsx)("span",{className:"value",children:p(c)})]}),(0,e.jsxs)("div",{className:"property",children:[(0,e.jsx)("span",{className:"key",children:"类型: "}),(0,e.jsx)("span",{className:"value",children:p(u)})]}),(0,e.jsxs)("div",{className:"property",children:[(0,e.jsx)("span",{className:"key",children:"制片国家/地区 : "}),(0,e.jsx)("span",{className:"value",children:p(h)})]}),(0,e.jsxs)("div",{className:"property",children:[(0,e.jsx)("span",{className:"key",children:"又名 : "}),(0,e.jsx)("span",{className:"value",children:p(d)})]}),(0,e.jsxs)("div",{className:"property",children:[(0,e.jsx)("span",{className:"key",children:"简介 : "}),(0,e.jsx)("span",{className:"value",children:f})]})]})]})})},Ne=Number.isFinite||function(e){return"number"==typeof e&&isFinite(e)},Me=Number.isSafeInteger||function(e){return"number"==typeof e&&Math.abs(e)<=Fe},Fe=Number.MAX_SAFE_INTEGER||9007199254740991;let Be=function(e){return e.NETWORK_ERROR="networkError",e.MEDIA_ERROR="mediaError",e.KEY_SYSTEM_ERROR="keySystemError",e.MUX_ERROR="muxError",e.OTHER_ERROR="otherError",e}({}),Ue=function(e){return e.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",e.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",e.KEY_SYSTEM_NO_SESSION="keySystemNoSession",e.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",e.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",e.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",e.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",e.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",e.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",e.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",e.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR="keySystemDestroyMediaKeysError",e.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR="keySystemDestroyCloseSessionError",e.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR="keySystemDestroyRemoveSessionError",e.MANIFEST_LOAD_ERROR="manifestLoadError",e.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",e.MANIFEST_PARSING_ERROR="manifestParsingError",e.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",e.LEVEL_EMPTY_ERROR="levelEmptyError",e.LEVEL_LOAD_ERROR="levelLoadError",e.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",e.LEVEL_PARSING_ERROR="levelParsingError",e.LEVEL_SWITCH_ERROR="levelSwitchError",e.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",e.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",e.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",e.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",e.FRAG_LOAD_ERROR="fragLoadError",e.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",e.FRAG_DECRYPT_ERROR="fragDecryptError",e.FRAG_PARSING_ERROR="fragParsingError",e.FRAG_GAP="fragGap",e.REMUX_ALLOC_ERROR="remuxAllocError",e.KEY_LOAD_ERROR="keyLoadError",e.KEY_LOAD_TIMEOUT="keyLoadTimeOut",e.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",e.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",e.BUFFER_APPEND_ERROR="bufferAppendError",e.BUFFER_APPENDING_ERROR="bufferAppendingError",e.BUFFER_STALLED_ERROR="bufferStalledError",e.BUFFER_FULL_ERROR="bufferFullError",e.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",e.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",e.ASSET_LIST_LOAD_ERROR="assetListLoadError",e.ASSET_LIST_LOAD_TIMEOUT="assetListLoadTimeout",e.ASSET_LIST_PARSING_ERROR="assetListParsingError",e.INTERSTITIAL_ASSET_ITEM_ERROR="interstitialAssetItemError",e.INTERNAL_EXCEPTION="internalException",e.INTERNAL_ABORTED="aborted",e.ATTACH_MEDIA_ERROR="attachMediaError",e.UNKNOWN="unknown",e}({}),$e=function(e){return e.MEDIA_ATTACHING="hlsMediaAttaching",e.MEDIA_ATTACHED="hlsMediaAttached",e.MEDIA_DETACHING="hlsMediaDetaching",e.MEDIA_DETACHED="hlsMediaDetached",e.MEDIA_ENDED="hlsMediaEnded",e.STALL_RESOLVED="hlsStallResolved",e.BUFFER_RESET="hlsBufferReset",e.BUFFER_CODECS="hlsBufferCodecs",e.BUFFER_CREATED="hlsBufferCreated",e.BUFFER_APPENDING="hlsBufferAppending",e.BUFFER_APPENDED="hlsBufferAppended",e.BUFFER_EOS="hlsBufferEos",e.BUFFERED_TO_END="hlsBufferedToEnd",e.BUFFER_FLUSHING="hlsBufferFlushing",e.BUFFER_FLUSHED="hlsBufferFlushed",e.MANIFEST_LOADING="hlsManifestLoading",e.MANIFEST_LOADED="hlsManifestLoaded",e.MANIFEST_PARSED="hlsManifestParsed",e.LEVEL_SWITCHING="hlsLevelSwitching",e.LEVEL_SWITCHED="hlsLevelSwitched",e.LEVEL_LOADING="hlsLevelLoading",e.LEVEL_LOADED="hlsLevelLoaded",e.LEVEL_UPDATED="hlsLevelUpdated",e.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",e.LEVELS_UPDATED="hlsLevelsUpdated",e.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",e.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",e.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",e.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",e.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",e.AUDIO_TRACK_UPDATED="hlsAudioTrackUpdated",e.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",e.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",e.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",e.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",e.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",e.SUBTITLE_TRACK_UPDATED="hlsSubtitleTrackUpdated",e.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",e.CUES_PARSED="hlsCuesParsed",e.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",e.INIT_PTS_FOUND="hlsInitPtsFound",e.FRAG_LOADING="hlsFragLoading",e.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",e.FRAG_LOADED="hlsFragLoaded",e.FRAG_DECRYPTED="hlsFragDecrypted",e.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",e.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",e.FRAG_PARSING_METADATA="hlsFragParsingMetadata",e.FRAG_PARSED="hlsFragParsed",e.FRAG_BUFFERED="hlsFragBuffered",e.FRAG_CHANGED="hlsFragChanged",e.FPS_DROP="hlsFpsDrop",e.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",e.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",e.ERROR="hlsError",e.DESTROYING="hlsDestroying",e.KEY_LOADING="hlsKeyLoading",e.KEY_LOADED="hlsKeyLoaded",e.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",e.BACK_BUFFER_REACHED="hlsBackBufferReached",e.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",e.ASSET_LIST_LOADING="hlsAssetListLoading",e.ASSET_LIST_LOADED="hlsAssetListLoaded",e.INTERSTITIALS_UPDATED="hlsInterstitialsUpdated",e.INTERSTITIALS_BUFFERED_TO_BOUNDARY="hlsInterstitialsBufferedToBoundary",e.INTERSTITIAL_ASSET_PLAYER_CREATED="hlsInterstitialAssetPlayerCreated",e.INTERSTITIAL_STARTED="hlsInterstitialStarted",e.INTERSTITIAL_ASSET_STARTED="hlsInterstitialAssetStarted",e.INTERSTITIAL_ASSET_ENDED="hlsInterstitialAssetEnded",e.INTERSTITIAL_ASSET_ERROR="hlsInterstitialAssetError",e.INTERSTITIAL_ENDED="hlsInterstitialEnded",e.INTERSTITIALS_PRIMARY_RESUMED="hlsInterstitialsPrimaryResumed",e.PLAYOUT_LIMIT_REACHED="hlsPlayoutLimitReached",e.EVENT_CUE_ENTER="hlsEventCueEnter",e}({});var je="manifest",ze="level",Ge="audioTrack",Ve="subtitleTrack",qe="main",He="audio",We="subtitle";class Ke{constructor(e,t=0,n=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=n}sample(e,t){const n=Math.pow(this.alpha_,e);this.estimate_=t*(1-n)+n*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class Ye{constructor(e,t,n,i=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new Ke(e),this.fast_=new Ke(t),this.defaultTTFB_=i,this.ttfb_=new Ke(e)}update(e,t){const{slow_:n,fast_:i,ttfb_:r}=this;n.halfLife!==e&&(this.slow_=new Ke(e,n.getEstimate(),n.getTotalWeight())),i.halfLife!==t&&(this.fast_=new Ke(t,i.getEstimate(),i.getTotalWeight())),r.halfLife!==e&&(this.ttfb_=new Ke(e,r.getEstimate(),r.getTotalWeight()))}sample(e,t){const n=(e=Math.max(e,this.minDelayMs_))/1e3,i=8*t/n;this.fast_.sample(n,i),this.slow_.sample(n,i)}sampleTTFB(e){const t=e/1e3,n=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(n,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}get defaultEstimate(){return this.defaultEstimate_}destroy(){}}function Xe(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t);if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Qe(){return Qe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Qe.apply(null,arguments)}function Ze(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function Je(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ze(Object(n),!0).forEach(function(t){Xe(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ze(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}class et{constructor(e,t){this.trace=void 0,this.debug=void 0,this.log=void 0,this.warn=void 0,this.info=void 0,this.error=void 0;const n=`[${e}]:`;this.trace=tt,this.debug=t.debug.bind(null,n),this.log=t.log.bind(null,n),this.warn=t.warn.bind(null,n),this.info=t.info.bind(null,n),this.error=t.error.bind(null,n)}}const tt=function(){},nt={trace:tt,debug:tt,log:tt,warn:tt,info:tt,error:tt};function it(){return Qe({},nt)}function rt(e,t,n){return t[e]?t[e].bind(t):function(e,t){const n=self.console[e];return n?n.bind(self.console,`${t?"["+t+"] ":""}[${e}] >`):tt}(e,n)}const st=it(),at=st;function ot(e=!0){if("undefined"!=typeof self)return(e||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function lt(e,t){const n=Object.keys(e),i=Object.keys(t),r=n.length,s=i.length;return!r||!s||r===s&&!n.some(e=>-1===i.indexOf(e))}function ct(e,t=!1){if("undefined"!=typeof TextDecoder){const n=new TextDecoder("utf-8").decode(e);if(t){const e=n.indexOf("\0");return-1!==e?n.substring(0,e):n}return n.replace(/\0/g,"")}const n=e.length;let i,r,s,a="",o=0;for(;o<n;){if(i=e[o++],0===i&&t)return a;if(0!==i&&3!==i)switch(i>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:a+=String.fromCharCode(i);break;case 12:case 13:r=e[o++],a+=String.fromCharCode((31&i)<<6|63&r);break;case 14:r=e[o++],s=e[o++],a+=String.fromCharCode((15&i)<<12|(63&r)<<6|63&s)}}return a}function ut(e){let t="";for(let n=0;n<e.length;n++){let i=e[n].toString(16);i.length<2&&(i="0"+i),t+=i}return t}function ht(e){return Uint8Array.from(e.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}function dt(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ft,pt,gt,mt,vt,yt,bt={exports:{}},Et=(ft||(ft=1,pt=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,gt=/^(?=([^\/?#]*))\1([^]*)$/,mt=/(?:\/|^)\.(?=\/)/g,vt=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,bt.exports=yt={buildAbsoluteURL:function(e,t,n){if(n=n||{},e=e.trim(),!(t=t.trim())){if(!n.alwaysNormalize)return e;var i=yt.parseURL(e);if(!i)throw new Error("Error trying to parse base URL.");return i.path=yt.normalizePath(i.path),yt.buildURLFromParts(i)}var r=yt.parseURL(t);if(!r)throw new Error("Error trying to parse relative URL.");if(r.scheme)return n.alwaysNormalize?(r.path=yt.normalizePath(r.path),yt.buildURLFromParts(r)):t;var s=yt.parseURL(e);if(!s)throw new Error("Error trying to parse base URL.");if(!s.netLoc&&s.path&&"/"!==s.path[0]){var a=gt.exec(s.path);s.netLoc=a[1],s.path=a[2]}s.netLoc&&!s.path&&(s.path="/");var o={scheme:s.scheme,netLoc:r.netLoc,path:null,params:r.params,query:r.query,fragment:r.fragment};if(!r.netLoc&&(o.netLoc=s.netLoc,"/"!==r.path[0]))if(r.path){var l=s.path,c=l.substring(0,l.lastIndexOf("/")+1)+r.path;o.path=yt.normalizePath(c)}else o.path=s.path,r.params||(o.params=s.params,r.query||(o.query=s.query));return null===o.path&&(o.path=n.alwaysNormalize?yt.normalizePath(r.path):r.path),yt.buildURLFromParts(o)},parseURL:function(e){var t=pt.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(mt,"");e.length!==(e=e.replace(vt,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}}),bt.exports);class St{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var wt="audio",Tt="video",kt="audiovideo";class _t{constructor(e){this._byteRange=null,this._url=null,this._stats=null,this._streams=null,this.base=void 0,this.relurl=void 0,"string"==typeof e&&(e={url:e}),this.base=e,function(e,t){const n=Rt(e,t);n&&(n.enumerable=!0,Object.defineProperty(e,t,n))}(this,"stats")}setByteRange(e,t){const n=e.split("@",2);let i;i=1===n.length?(null==t?void 0:t.byteRangeEndOffset)||0:parseInt(n[1]),this._byteRange=[i,parseInt(n[0])+i]}get baseurl(){return this.base.url}get byteRange(){return null===this._byteRange?[]:this._byteRange}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get elementaryStreams(){return null===this._streams&&(this._streams={[wt]:null,[Tt]:null,[kt]:null}),this._streams}set elementaryStreams(e){this._streams=e}get hasStats(){return null!==this._stats}get hasStreams(){return null!==this._streams}get stats(){return null===this._stats&&(this._stats=new St),this._stats}set stats(e){this._stats=e}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Et.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[wt]=null,e[Tt]=null,e[kt]=null}}function xt(e){return"initSegment"!==e.sn}class Lt extends _t{constructor(e,t){super(t),this._decryptdata=null,this._programDateTime=null,this._ref=null,this._bitrate=void 0,this.rawProgramDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.playlistOffset=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=e}get byteLength(){if(this.hasStats){const e=this.stats.total;if(e)return e}if(this.byteRange.length){const e=this.byteRange[0],t=this.byteRange[1];if(Ne(e)&&Ne(t))return t-e}return null}get bitrate(){return this.byteLength?8*this.byteLength/this.duration:this._bitrate?this._bitrate:null}set bitrate(e){this._bitrate=e}get decryptdata(){const{levelkeys:e}=this;if(!e&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const e=this.levelkeys.identity;if(e)this._decryptdata=e.getDecryptData(this.sn);else{const e=Object.keys(this.levelkeys);if(1===e.length){const t=this._decryptdata=this.levelkeys[e[0]]||null;if(t)return t.getDecryptData(this.sn)}}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(null===this.programDateTime)return null;const e=Ne(this.duration)?this.duration:0;return this.programDateTime+1e3*e}get encrypted(){var e;if(null!=(e=this._decryptdata)&&e.encrypted)return!0;if(this.levelkeys){var t;const e=Object.keys(this.levelkeys),n=e.length;if(n>1||1===n&&null!=(t=this.levelkeys[e[0]])&&t.encrypted)return!0}return!1}get programDateTime(){return null===this._programDateTime&&this.rawProgramDateTime&&(this.programDateTime=Date.parse(this.rawProgramDateTime)),this._programDateTime}set programDateTime(e){Ne(e)?this._programDateTime=e:this._programDateTime=this.rawProgramDateTime=null}get ref(){return xt(this)?(this._ref||(this._ref={base:this.base,start:this.start,duration:this.duration,sn:this.sn,programDateTime:this.programDateTime}),this._ref):null}addStart(e){this.setStart(this.start+e)}setStart(e){this.start=e,this._ref&&(this._ref.start=e)}setDuration(e){this.duration=e,this._ref&&(this._ref.duration=e)}setKeyFormat(e){if(this.levelkeys){const t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}}abortRequests(){var e,t;null==(e=this.loader)||e.abort(),null==(t=this.keyLoader)||t.abort()}setElementaryStreamInfo(e,t,n,i,r,s=!1){const{elementaryStreams:a}=this,o=a[e];o?(o.startPTS=Math.min(o.startPTS,t),o.endPTS=Math.max(o.endPTS,n),o.startDTS=Math.min(o.startDTS,i),o.endDTS=Math.max(o.endDTS,r)):a[e]={startPTS:t,endPTS:n,startDTS:i,endDTS:r,partial:s}}}class At extends _t{constructor(e,t,n,i,r){super(n),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=i;const s=e.enumeratedString("BYTERANGE");s&&this.setByteRange(s,r),r&&(this.fragOffset=r.fragOffset+r.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}function Rt(e,t){const n=Object.getPrototypeOf(e);if(n){return Object.getOwnPropertyDescriptor(n,t)||Rt(n,t)}}const It=Math.pow(2,32)-1,Ct=[].push,Dt={video:1,audio:2,id3:3,text:4};function Pt(e){return String.fromCharCode.apply(null,e)}function Ot(e,t){const n=e[t]<<8|e[t+1];return n<0?65536+n:n}function Nt(e,t){const n=Ft(e,t);return n<0?4294967296+n:n}function Mt(e,t){let n=Nt(e,t);return n*=Math.pow(2,32),n+=Nt(e,t+4),n}function Ft(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}function Bt(e,t){const n=[];if(!t.length)return n;const i=e.byteLength;for(let r=0;r<i;){const s=Nt(e,r),a=s>1?r+s:i;if(Pt(e.subarray(r+4,r+8))===t[0])if(1===t.length)n.push(e.subarray(r+8,a));else{const i=Bt(e.subarray(r+8,a),t.slice(1));i.length&&Ct.apply(n,i)}r=a}return n}function Ut(e){const t=[],n=e[0];let i=8;const r=Nt(e,i);i+=4;let s=0,a=0;0===n?(s=Nt(e,i),a=Nt(e,i+4),i+=8):(s=Mt(e,i),a=Mt(e,i+8),i+=16),i+=2;let o=e.length+a;const l=Ot(e,i);i+=2;for(let n=0;n<l;n++){let n=i;const s=Nt(e,n);n+=4;const a=2147483647&s;if(1==(2147483648&s)>>>31)return at.warn("SIDX has hierarchical references (not supported)"),null;const l=Nt(e,n);n+=4,t.push({referenceSize:a,subsegmentDuration:l,info:{duration:l/r,start:o,end:o+a-1}}),o+=a,n+=4,i=n}return{earliestPresentationTime:s,timescale:r,version:n,referencesCount:l,references:t}}function $t(e){const t=[],n=Bt(e,["moov","trak"]);for(let e=0;e<n.length;e++){const i=n[e],r=Bt(i,["tkhd"])[0];if(r){let e=r[0];const n=Nt(r,0===e?12:20),s=Bt(i,["mdia","mdhd"])[0];if(s){e=s[0];const r=Nt(s,0===e?12:20),a=Bt(i,["mdia","hdlr"])[0];if(a){const e=Pt(a.subarray(8,12)),s={soun:wt,vide:Tt}[e],o=jt(Bt(i,["mdia","minf","stbl","stsd"])[0]);s?(t[n]={timescale:r,type:s,stsd:o},t[s]=Je({timescale:r,id:n},o)):t[n]={timescale:r,type:e,stsd:o}}}}}return Bt(e,["moov","mvex","trex"]).forEach(e=>{const n=Nt(e,4),i=t[n];i&&(i.default={duration:Nt(e,12),flags:Nt(e,20)})}),t}function jt(e){const t=e.subarray(8),n=t.subarray(86),i=Pt(t.subarray(4,8));let r,s=i;const a="enca"===i||"encv"===i;if(a){const e=Bt(t,[i])[0];Bt(e.subarray("enca"===i?28:78),["sinf"]).forEach(e=>{const t=Bt(e,["schm"])[0];if(t){const n=Pt(t.subarray(4,8));if("cbcs"===n||"cenc"===n){const t=Bt(e,["frma"])[0];t&&(s=Pt(t))}}})}const o=s;switch(s){case"avc1":case"avc2":case"avc3":case"avc4":{const e=Bt(n,["avcC"])[0];e&&e.length>3&&(s+="."+Vt(e[1])+Vt(e[2])+Vt(e[3]),r=zt("avc1"===o?"dva1":"dvav",n));break}case"mp4a":{const e=Bt(t,[i])[0],n=Bt(e.subarray(28),["esds"])[0];if(n&&n.length>7){let e=4;if(3!==n[e++])break;e=Gt(n,e),e+=2;const t=n[e++];if(128&t&&(e+=2),64&t&&(e+=n[e++]),4!==n[e++])break;e=Gt(n,e);const i=n[e++];if(64!==i)break;if(s+="."+Vt(i),e+=12,5!==n[e++])break;e=Gt(n,e);const r=n[e++];let a=(248&r)>>3;31===a&&(a+=1+((7&r)<<3)+((224&n[e])>>5)),s+="."+a}break}case"hvc1":case"hev1":{const e=Bt(n,["hvcC"])[0];if(e&&e.length>12){const t=e[1],n=["","A","B","C"][t>>6],i=31&t,r=Nt(e,2),a=(32&t)>>5?"H":"L",o=e[12],l=e.subarray(6,12);s+="."+n+i,s+="."+function(e){let t=0;for(let n=0;n<32;n++)t|=(e>>n&1)<<31-n;return t>>>0}(r).toString(16).toUpperCase(),s+="."+a+o;let c="";for(let e=l.length;e--;){const t=l[e];(t||c)&&(c="."+t.toString(16).toUpperCase()+c)}s+=c}r=zt("hev1"==o?"dvhe":"dvh1",n);break}case"dvh1":case"dvhe":case"dvav":case"dva1":case"dav1":s=zt(s,n)||s;break;case"vp09":{const e=Bt(n,["vpcC"])[0];if(e&&e.length>6){const t=e[4],n=e[5],i=e[6]>>4&15;s+="."+qt(t)+"."+qt(n)+"."+qt(i)}break}case"av01":{const e=Bt(n,["av1C"])[0];if(e&&e.length>2){const t=e[1]>>>5,i=31&e[1],a=e[2]>>>7?"H":"M",o=(64&e[2])>>6,l=(32&e[2])>>5,c=2===t&&o?l?12:10:o?10:8,u=(16&e[2])>>4,h=(8&e[2])>>3,d=(4&e[2])>>2,f=3&e[2],p=1,g=1,m=1,v=0;s+="."+t+"."+qt(i)+a+"."+qt(c)+"."+u+"."+h+d+f+"."+qt(p)+"."+qt(g)+"."+qt(m)+"."+v,r=zt("dav1",n)}break}}return{codec:s,encrypted:a,supplemental:r}}function zt(e,t){const n=Bt(t,["dvvC"]),i=n.length?n[0]:Bt(t,["dvcC"])[0];if(i){const t=i[2]>>1&127,n=i[2]<<5&32|i[3]>>3&31;return e+"."+qt(t)+"."+qt(n)}}function Gt(e,t){const n=t+5;for(;128&e[t++]&&t<n;);return t}function Vt(e){return("0"+e.toString(16).toUpperCase()).slice(-2)}function qt(e){return(e<10?"0":"")+e}function Ht(e){const t=Bt(e,["schm"])[0];if(t){const n=Pt(t.subarray(4,8));if("cbcs"===n||"cenc"===n)return Bt(e,["schi","tenc"])[0]}return null}function Wt(e,t){const n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}function Kt(e,t){const n=[],i=t.samples,r=t.timescale,s=t.id;let a=!1;return Bt(i,["moof"]).map(o=>{const l=o.byteOffset-8;Bt(o,["traf"]).map(o=>{const c=Bt(o,["tfdt"]).map(e=>{const t=e[0];let n=Nt(e,4);return 1===t&&(n*=Math.pow(2,32),n+=Nt(e,8)),n/r})[0];return void 0!==c&&(e=c),Bt(o,["tfhd"]).map(c=>{const u=Nt(c,4),h=16777215&Nt(c,0);let d=0;const f=!!(16&h);let p=0;const g=!!(32&h);let m=8;u===s&&(!!(1&h)&&(m+=8),!!(2&h)&&(m+=4),!!(8&h)&&(d=Nt(c,m),m+=4),f&&(p=Nt(c,m),m+=4),g&&(m+=4),"video"===t.type&&(a=Yt(t.codec)),Bt(o,["trun"]).map(s=>{const o=s[0],c=16777215&Nt(s,0),u=!!(1&c);let h=0;const f=!!(4&c),g=!!(256&c);let m=0;const v=!!(512&c);let y=0;const b=!!(1024&c),E=!!(2048&c);let S=0;const w=Nt(s,4);let T=8;u&&(h=Nt(s,T),T+=4),f&&(T+=4);let k=h+l;for(let l=0;l<w;l++){if(g?(m=Nt(s,T),T+=4):m=d,v?(y=Nt(s,T),T+=4):y=p,b&&(T+=4),E&&(S=0===o?Nt(s,T):Ft(s,T),T+=4),t.type===Tt){let t=0;for(;t<y;){const s=Nt(i,k);k+=4,Xt(a,i[k])&&Qt(i.subarray(k,k+s),a?2:1,e+S/r,n),k+=s,t+=s+4}}e+=m/r}}))})})}),n}function Yt(e){if(!e)return!1;const t=e.substring(0,4);return"hvc1"===t||"hev1"===t||"dvh1"===t||"dvhe"===t}function Xt(e,t){if(e){const e=t>>1&63;return 39===e||40===e}return 6==(31&t)}function Qt(e,t,n,i){const r=Zt(e);let s=0;s+=t;let a=0,o=0,l=0;for(;s<r.length;){a=0;do{if(s>=r.length)break;l=r[s++],a+=l}while(255===l);o=0;do{if(s>=r.length)break;l=r[s++],o+=l}while(255===l);const e=r.length-s;let t=s;if(o<e)s+=o;else if(o>e){at.error(`Malformed SEI payload. ${o} is too small, only ${e} bytes left to parse.`);break}if(4===a){if(181===r[t++]){const e=Ot(r,t);if(t+=2,49===e){const e=Nt(r,t);if(t+=4,1195456820===e){const e=r[t++];if(3===e){const s=r[t++],o=64&s,l=o?2+3*(31&s):0,c=new Uint8Array(l);if(o){c[0]=s;for(let e=1;e<l;e++)c[e]=r[t++]}i.push({type:e,payloadType:a,pts:n,bytes:c})}}}}}else if(5===a&&o>16){const e=[];for(let n=0;n<16;n++){const i=r[t++].toString(16);e.push(1==i.length?"0"+i:i),3!==n&&5!==n&&7!==n&&9!==n||e.push("-")}const s=o-16,l=new Uint8Array(s);for(let e=0;e<s;e++)l[e]=r[t++];i.push({payloadType:a,pts:n,uuid:e.join(""),userData:ct(l),userDataBytes:l})}}}function Zt(e){const t=e.byteLength,n=[];let i=1;for(;i<t-2;)0===e[i]&&0===e[i+1]&&3===e[i+2]?(n.push(i+2),i+=2):i++;if(0===n.length)return e;const r=t-n.length,s=new Uint8Array(r);let a=0;for(i=0;i<r;a++,i++)a===n[0]&&(a++,n.shift()),s[i]=e[a];return s}function Jt(e){const t=e.getUint32(0),n=e.byteOffset,i=e.byteLength;if(i<t)return{offset:n,size:i};if(1886614376!==e.getUint32(4))return{offset:n,size:t};const r=e.getUint32(8)>>>24;if(0!==r&&1!==r)return{offset:n,size:t};const s=e.buffer,a=ut(new Uint8Array(s,n+12,16));let o=null,l=null,c=0;if(0===r)c=28;else{const r=e.getUint32(28);if(!r||i<32+16*r)return{offset:n,size:t};o=[];for(let e=0;e<r;e++)o.push(new Uint8Array(s,n+32+16*e,16));c=32+16*r}if(!c)return{offset:n,size:t};const u=e.getUint32(c);return t-32<u?{offset:n,size:t}:(l=new Uint8Array(s,n+c+4,u),{version:r,systemId:a,kids:o,data:l,offset:n,size:t})}const en=()=>/\(Windows.+Firefox\//i.test(navigator.userAgent),tn={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,dav1:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function nn(e,t){const n=tn[t];return!!n&&!!n[e.slice(0,4)]}function rn(e,t,n=!0){return!e.split(",").some(e=>!sn(e,t,n))}function sn(e,t,n=!0){var i;const r=ot(n);return null!=(i=null==r?void 0:r.isTypeSupported(an(e,t)))&&i}function an(e,t){return`${t}/mp4;codecs=${e}`}function on(e){if(e){const t=e.substring(0,4);return tn.video[t]}return 2}function ln(e){const t=en();return e.split(",").reduce((e,n)=>{const i=t&&Yt(n)?9:tn.video[n];return i?(2*i+e)/(e?3:2):(tn.audio[n]+e)/(e?2:1)},0)}const cn={},un=/flac|opus|mp4a\.40\.34/i;function hn(e,t=!0){return e.replace(un,e=>function(e,t=!0){if(cn[e])return cn[e];const n={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"],"mp4a.40.34":["mp3"]}[e];for(let r=0;r<n.length;r++){var i;if(sn(n[r],"audio",t))return cn[e]=n[r],n[r];if("mp3"===n[r]&&null!=(i=ot(t))&&i.isTypeSupported("audio/mpeg"))return""}return e}(e.toLowerCase(),t))}function dn(e,t){if(e&&(e.length>4||-1!==["ac-3","ec-3","alac","fLaC","Opus"].indexOf(e))&&(fn(e,"audio")||fn(e,"video")))return e;if(t){const n=t.split(",");if(n.length>1){if(e)for(let t=n.length;t--;)if(n[t].substring(0,4)===e.substring(0,4))return n[t];return n[0]}}return t||e}function fn(e,t){return nn(e,t)&&sn(e,t)}function pn(e){if(e.startsWith("av01.")){const t=e.split("."),n=["0","111","01","01","01","0"];for(let e=t.length;e>4&&e<10;e++)t[e]=n[e-4];return t.join(".")}return e}function gn(e){const t=ot(e)||{isTypeSupported:()=>!1};return{mpeg:t.isTypeSupported("audio/mpeg"),mp3:t.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:t.isTypeSupported('audio/mp4; codecs="ac-3"')}}function mn(e){return e.replace(/^.+codecs=["']?([^"']+).*$/,"$1")}const vn={supported:!1,smooth:!1,powerEfficient:!1},yn={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]};function bn(e,t){return{supported:!1,configurations:t,decodingInfoResults:[vn],error:e}}function En(e,t,n,i,r,s){const a=e.videoCodec,o=e.audioCodec?e.audioGroups:null,l=null==s?void 0:s.audioCodec,c=null==s?void 0:s.channels,u=c?parseInt(c):l?1/0:2;let h=null;if(null!=o&&o.length)try{h=1===o.length&&o[0]?t.groups[o[0]].channels:o.reduce((e,n)=>{if(n){const i=t.groups[n];if(!i)throw new Error(`Audio track group ${n} not found`);Object.keys(i.channels).forEach(t=>{e[t]=(e[t]||0)+i.channels[t]})}return e},{2:0})}catch(e){return!0}return void 0!==a&&(a.split(",").some(e=>Yt(e))||e.width>1920&&e.height>1088||e.height>1920&&e.width>1088||e.frameRate>Math.max(i,30)||"SDR"!==e.videoRange&&e.videoRange!==n||e.bitrate>Math.max(r,8e6))||!!h&&Ne(u)&&Object.keys(h).some(e=>parseInt(e)>u)}function Sn(e,t,n,i={}){const r=e.videoCodec;if(!r&&!e.audioCodec||!n)return Promise.resolve(yn);const s=[],a=function(e){var t;const n=null==(t=e.videoCodec)?void 0:t.split(","),i=Tn(e),r=e.width||640,s=e.height||480,a=e.frameRate||30,o=e.videoRange.toLowerCase();return n?n.map(e=>{const t={contentType:an(pn(e),"video"),width:r,height:s,bitrate:i,framerate:a};return"sdr"!==o&&(t.transferFunction=o),t}):[]}(e),o=a.length,l=function(e,t,n){var i;const r=null==(i=e.audioCodec)?void 0:i.split(","),s=Tn(e);return r&&e.audioGroups?e.audioGroups.reduce((e,i)=>{var a;const o=i?null==(a=t.groups[i])?void 0:a.tracks:null;return o?o.reduce((e,t)=>{if(t.groupId===i){const i=parseFloat(t.channels||"");r.forEach(t=>{const r={contentType:an(t,"audio"),bitrate:n?wn(t,s):s};i&&(r.channels=""+i),e.push(r)})}return e},e):e},[]):[]}(e,t,o>0),c=l.length;for(let e=o||1*c||1;e--;){const t={type:"media-source"};if(o&&(t.video=a[e%o]),c){t.audio=l[e%c];const n=t.audio.bitrate;t.video&&n&&(t.video.bitrate-=n)}s.push(t)}if(r){const e=navigator.userAgent;if(r.split(",").some(e=>Yt(e))&&en())return Promise.resolve(bn(new Error(`Overriding Windows Firefox HEVC MediaCapabilities result based on user-agent string: (${e})`),s))}return Promise.all(s.map(e=>{const t=function(e){let t="";const{audio:n,video:i}=e;return i&&(t+=`${mn(i.contentType)}_r${i.height}x${i.width}f${Math.ceil(i.framerate)}${i.transferFunction||"sd"}_${Math.ceil(i.bitrate/1e5)}`),n&&(t+=`${i?"_":""}${mn(n.contentType)}_c${n.channels}`),t}(e);return i[t]||(i[t]=n.decodingInfo(e))})).then(e=>({supported:!e.some(e=>!e.supported),configurations:s,decodingInfoResults:e})).catch(e=>({supported:!1,configurations:s,decodingInfoResults:[],error:e}))}function wn(e,t){if(t<=1)return 1;let n=128e3;return"ec-3"===e?n=768e3:"ac-3"===e&&(n=64e4),Math.min(t/2,n)}function Tn(e){return 1e3*Math.ceil(Math.max(.9*e.bitrate,e.averageBitrate)/1e3)||1}const kn=["NONE","TYPE-0","TYPE-1",null],_n=["SDR","PQ","HLG"];function xn(e){const{canSkipUntil:t,canSkipDateRanges:n,age:i}=e;return t&&i<t/2?n?"v2":"YES":""}class Ln{constructor(e,t,n){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=n}addDirectives(e){const t=new self.URL(e);return void 0!==this.msn&&t.searchParams.set("_HLS_msn",this.msn.toString()),void 0!==this.part&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class An{constructor(e){if(this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.supplemental=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter(e=>!!e).map(e=>e.substring(0,4)).join(","),"supplemental"in e){var t;this.supplemental=e.supplemental;const n=null==(t=e.supplemental)?void 0:t.videoCodec;n&&n!==e.videoCodec&&(this.codecSet+=`,${n.substring(0,4)}`)}this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return Rn(this._audioGroups,e)}hasSubtitleGroup(e){return Rn(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,t){if(t)if("audio"===e){let e=this._audioGroups;e||(e=this._audioGroups=[]),-1===e.indexOf(t)&&e.push(t)}else if("text"===e){let e=this._subtitleGroups;e||(e=this._subtitleGroups=[]),-1===e.indexOf(t)&&e.push(t)}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return null==(e=this.audioGroups)?void 0:e[0]}get textGroupId(){var e;return null==(e=this.subtitleGroups)?void 0:e[0]}addFallback(){}}function Rn(e,t){return!(!t||!e)&&-1!==e.indexOf(t)}const In=(e,t)=>JSON.stringify(e,(e=>{const t=new WeakSet;return(n,i)=>{if(e&&(i=e(n,i)),"object"==typeof i&&null!==i){if(t.has(i))return;t.add(i)}return i}})(t));function Cn(e,t){at.log(`[abr] start candidates with "${e}" ignored because ${t}`)}function Dn(e){return e.reduce((e,t)=>{let n=e.groups[t.groupId];n||(n=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),n.tracks.push(t);const i=t.channels||"2";return n.channels[i]=(n.channels[i]||0)+1,n.hasDefault=n.hasDefault||t.default,n.hasAutoSelect=n.hasAutoSelect||t.autoselect,n.hasDefault&&(e.hasDefaultAudio=!0),n.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function Pn(e){if(!e)return e;const{lang:t,assocLang:n,characteristics:i,channels:r,audioCodec:s}=e;return{lang:t,assocLang:n,characteristics:i,channels:r,audioCodec:s}}function On(e,t,n){if("attrs"in e){const n=t.indexOf(e);if(-1!==n)return n}for(let i=0;i<t.length;i++)if(Nn(e,t[i],n))return i;return-1}function Nn(e,t,n){const{groupId:i,name:r,lang:s,assocLang:a,default:o}=e,l=e.forced;return(void 0===i||t.groupId===i)&&(void 0===r||t.name===r)&&(void 0===s||function(e,t="--"){return e.length===t.length?e===t:e.startsWith(t)||t.startsWith(e)}(s,t.lang))&&(void 0===s||t.assocLang===a)&&(void 0===o||t.default===o)&&(void 0===l||t.forced===l)&&(!("characteristics"in e)||function(e,t=""){const n=e.split(","),i=t.split(",");return n.length===i.length&&!n.some(e=>-1===i.indexOf(e))}(e.characteristics||"",t.characteristics))&&(void 0===n||n(e,t))}function Mn(e,t){const{audioCodec:n,channels:i}=e;return!(void 0!==n&&(t.audioCodec||"").substring(0,4)!==n.substring(0,4)||void 0!==i&&i!==(t.channels||"2"))}function Fn(e,t,n){for(let i=t;i>-1;i--)if(n(e[i]))return i;for(let i=t+1;i<e.length;i++)if(n(e[i]))return i;return-1}function Bn(e,t){var n;return!!e&&e!==(null==(n=t.loadLevelObj)?void 0:n.uri)}const Un=function(e,t){let n=0,i=e.length-1,r=null,s=null;for(;n<=i;){r=(n+i)/2|0,s=e[r];const a=t(s);if(a>0)n=r+1;else{if(!(a<0))return s;i=r-1}}return null};function $n(e,t,n=0,i=0,r=.005){let s=null;if(e){s=t[1+e.sn-t[0].sn]||null;const i=e.endDTS-n;i>0&&i<15e-7&&(n+=15e-7),s&&e.level!==s.level&&s.end<=e.end&&(s=t[2+e.sn-t[0].sn]||null)}else 0===n&&0===t[0].start&&(s=t[0]);if(s&&((!e||e.level===s.level)&&0===jn(n,i,s)||function(e,t,n){if(t&&0===t.start&&t.level<e.level&&(t.endPTS||0)>0){const i=t.tagList.reduce((e,t)=>("INF"===t[0]&&(e+=parseFloat(t[1])),e),n);return e.start<=i}return!1}(s,e,Math.min(r,i))))return s;const a=Un(t,jn.bind(null,n,i));return!a||a===e&&s?s:a}function jn(e=0,t=0,n){if(n.start<=e&&n.start+n.duration>e)return 0;const i=Math.min(t,n.duration+(n.deltaPTS?n.deltaPTS:0));return n.start+n.duration-i<=e?1:n.start-i>e&&n.start?-1:0}function zn(e,t,n){const i=1e3*Math.min(t,n.duration+(n.deltaPTS?n.deltaPTS:0));return(n.endProgramDateTime||0)-i>e}function Gn(e,t,n){if(e&&e.startCC<=t&&e.endCC>=t){let i=e.fragments;const{fragmentHint:r}=e;let s;return r&&(i=i.concat(r)),Un(i,e=>e.cc<t?1:e.cc>t?-1:(s=e,e.end<=n?1:e.start>n?-1:0)),s||null}return null}function Vn(e){switch(e.details){case Ue.FRAG_LOAD_TIMEOUT:case Ue.KEY_LOAD_TIMEOUT:case Ue.LEVEL_LOAD_TIMEOUT:case Ue.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function qn(e){return e.details.startsWith("key")}function Hn(e){return qn(e)&&!!e.frag&&!e.frag.decryptdata}function Wn(e,t){const n=Vn(t);return e.default[(n?"timeout":"error")+"Retry"]}function Kn(e,t){const n="linear"===e.backoff?1:Math.pow(2,t);return Math.min(n*e.retryDelayMs,e.maxRetryDelayMs)}function Yn(e){return Je(Je({},e),{errorRetry:null,timeoutRetry:null})}function Xn(e,t,n,i){if(!e)return!1;const r=null==i?void 0:i.code,s=t<e.maxNumRetry&&(function(e){return Qn(e)||!!e&&(e<400||e>499)}(r)||!!n);return e.shouldRetry?e.shouldRetry(e,t,n,i,s):s}function Qn(e){return 0===e&&!1===navigator.onLine}function Zn(e){const t={action:0,flags:0};return e&&(t.resolved=!0),t}var Jn="NOT_LOADED",ei="APPENDING",ti="PARTIAL",ni="OK";class ii{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e&&(e.on($e.MANIFEST_LOADING,this.onManifestLoading,this),e.on($e.BUFFER_APPENDED,this.onBufferAppended,this),e.on($e.FRAG_BUFFERED,this.onFragBuffered,this),e.on($e.FRAG_LOADED,this.onFragLoaded,this))}_unregisterListeners(){const{hls:e}=this;e&&(e.off($e.MANIFEST_LOADING,this.onManifestLoading,this),e.off($e.BUFFER_APPENDED,this.onBufferAppended,this),e.off($e.FRAG_BUFFERED,this.onFragBuffered,this),e.off($e.FRAG_LOADED,this.onFragLoaded,this))}destroy(){this._unregisterListeners(),this.hls=this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const n=this.activePartLists[t];if(n)for(let t=n.length;t--;){const i=n[t];if(!i)break;if(i.start<=e&&e<=i.end&&i.loaded)return i}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){return this.getFragAtPos(e,t,!0)}getFragAtPos(e,t,n){const{fragments:i}=this,r=Object.keys(i);for(let s=r.length;s--;){const a=i[r[s]];if((null==a?void 0:a.body.type)===t&&(!n||a.buffered)){const t=a.body;if(t.start<=e&&e<=t.end)return t}}return null}detectEvictedFragments(e,t,n,i,r){this.timeRanges&&(this.timeRanges[e]=t);const s=(null==i?void 0:i.fragment.sn)||-1;Object.keys(this.fragments).forEach(i=>{const a=this.fragments[i];if(!a)return;if(s>=a.body.sn)return;if(!a.buffered&&(!a.loaded||r))return void(a.body.type===n&&this.removeFragment(a.body));const o=a.range[e];o&&(0!==o.time.length?o.time.some(e=>{const n=!this.isTimeBuffered(e.startPTS,e.endPTS,t);return n&&this.removeFragment(a.body),n}):this.removeFragment(a.body))})}detectPartialFragments(e){const t=this.timeRanges;if(!t||"initSegment"===e.frag.sn)return;const n=e.frag,i=si(n),r=this.fragments[i];if(!r||r.buffered&&n.gap)return;const s=!n.relurl;Object.keys(t).forEach(i=>{const a=n.elementaryStreams[i];if(!a)return;const o=t[i],l=s||!0===a.partial;r.range[i]=this.getBufferedTimes(n,e.part,l,o)}),r.loaded=null,Object.keys(r.range).length?(r.buffered=!0,(r.body.endList=n.endList||r.body.endList)&&(this.endListFragments[r.body.type]=r),ri(r)||this.removeParts(n.sn-1,n.type)):this.removeFragment(r.body)}removeParts(e,t){const n=this.activePartLists[t];n&&(this.activePartLists[t]=ai(n,t=>t.fragment.sn>=e))}fragBuffered(e,t){const n=si(e);let i=this.fragments[n];!i&&t&&(i=this.fragments[n]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),i&&(i.loaded=null,i.buffered=!0)}getBufferedTimes(e,t,n,i){const r={time:[],partial:n},s=e.start,a=e.end,o=e.minEndPTS||a,l=e.maxStartPTS||s;for(let e=0;e<i.length;e++){const t=i.start(e)-this.bufferPadding,n=i.end(e)+this.bufferPadding;if(l>=t&&o<=n){r.time.push({startPTS:Math.max(s,i.start(e)),endPTS:Math.min(a,i.end(e))});break}if(s<n&&a>t){const t=Math.max(s,i.start(e)),n=Math.min(a,i.end(e));n>t&&(r.partial=!0,r.time.push({startPTS:t,endPTS:n}))}else if(a<=t)break}return r}getPartialFragment(e){let t,n,i,r=null,s=0;const{bufferPadding:a,fragments:o}=this;return Object.keys(o).forEach(l=>{const c=o[l];c&&ri(c)&&(n=c.body.start-a,i=c.body.end+a,e>=n&&e<=i&&(t=Math.min(e-n,i-e),s<=t&&(r=c.body,s=t)))}),r}isEndListAppended(e){const t=this.endListFragments[e];return void 0!==t&&(t.buffered||ri(t))}getState(e){const t=si(e),n=this.fragments[t];return n?n.buffered?ri(n)?ti:ni:ei:Jn}isTimeBuffered(e,t,n){let i,r;for(let s=0;s<n.length;s++){if(i=n.start(s)-this.bufferPadding,r=n.end(s)+this.bufferPadding,e>=i&&t<=r)return!0;if(t<=i)return!1}return!1}onManifestLoading(){this.removeAllFragments()}onFragLoaded(e,t){if("initSegment"===t.frag.sn||t.frag.bitrateTest)return;const n=t.frag,i=t.part?null:t,r=si(n);this.fragments[r]={body:n,appendedPTS:null,loaded:i,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:n,part:i,timeRanges:r,type:s}=t;if("initSegment"===n.sn)return;const a=n.type;if(i){let e=this.activePartLists[a];e||(this.activePartLists[a]=e=[]),e.push(i)}this.timeRanges=r;const o=r[s];this.detectEvictedFragments(s,o,a,i)}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=si(e);return!!this.fragments[t]}hasFragments(e){const{fragments:t}=this,n=Object.keys(t);if(!e)return n.length>0;for(let i=n.length;i--;){const r=t[n[i]];if((null==r?void 0:r.body.type)===e)return!0}return!1}hasParts(e){var t;return!(null==(t=this.activePartLists[e])||!t.length)}removeFragmentsInRange(e,t,n,i,r){i&&!this.hasGaps||Object.keys(this.fragments).forEach(s=>{const a=this.fragments[s];if(!a)return;const o=a.body;o.type!==n||i&&!o.gap||o.start<t&&o.end>e&&(a.buffered||r)&&this.removeFragment(o)})}removeFragment(e){const t=si(e);e.clearElementaryStreamInfo();const n=this.activePartLists[e.type];if(n){const t=e.sn;this.activePartLists[e.type]=ai(n,e=>e.fragment.sn!==t)}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){var e;this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1;const t=null==(e=this.hls)||null==(e=e.latestLevelDetails)?void 0:e.partList;t&&t.forEach(e=>e.clearElementaryStreamInfo())}}function ri(e){var t,n,i;return e.buffered&&!!(e.body.gap||null!=(t=e.range.video)&&t.partial||null!=(n=e.range.audio)&&n.partial||null!=(i=e.range.audiovideo)&&i.partial)}function si(e){return`${e.type}_${e.level}_${e.sn}`}function ai(e,t){return e.filter(e=>{const n=t(e);return n||e.clearElementaryStreamInfo(),n})}class oi{constructor(e,t,n){this.subtle=void 0,this.aesIV=void 0,this.aesMode=void 0,this.subtle=e,this.aesIV=t,this.aesMode=n}decrypt(e,t){switch(this.aesMode){case 0:return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e);case 1:return this.subtle.decrypt({name:"AES-CTR",counter:this.aesIV,length:64},t,e);default:throw new Error(`[AESCrypto] invalid aes mode ${this.aesMode}`)}}}class li{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),n=new Uint32Array(4);for(let e=0;e<4;e++)n[e]=t.getUint32(4*e);return n}initTable(){const e=this.sBox,t=this.invSBox,n=this.subMix,i=n[0],r=n[1],s=n[2],a=n[3],o=this.invSubMix,l=o[0],c=o[1],u=o[2],h=o[3],d=new Uint32Array(256);let f=0,p=0,g=0;for(g=0;g<256;g++)d[g]=g<128?g<<1:g<<1^283;for(g=0;g<256;g++){let n=p^p<<1^p<<2^p<<3^p<<4;n=n>>>8^255&n^99,e[f]=n,t[n]=f;const o=d[f],g=d[o],m=d[g];let v=257*d[n]^16843008*n;i[f]=v<<24|v>>>8,r[f]=v<<16|v>>>16,s[f]=v<<8|v>>>24,a[f]=v,v=16843009*m^65537*g^257*o^16843008*f,l[n]=v<<24|v>>>8,c[n]=v<<16|v>>>16,u[n]=v<<8|v>>>24,h[n]=v,f?(f=o^d[d[d[m^o]]],p^=d[d[p]]):f=p=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let n=!0,i=0;for(;i<t.length&&n;)n=t[i]===this.key[i],i++;if(n)return;this.key=t;const r=this.keySize=t.length;if(4!==r&&6!==r&&8!==r)throw new Error("Invalid aes key size="+r);const s=this.ksRows=4*(r+6+1);let a,o;const l=this.keySchedule=new Uint32Array(s),c=this.invKeySchedule=new Uint32Array(s),u=this.sBox,h=this.rcon,d=this.invSubMix,f=d[0],p=d[1],g=d[2],m=d[3];let v,y;for(a=0;a<s;a++)a<r?v=l[a]=t[a]:(y=v,a%r===0?(y=y<<8|y>>>24,y=u[y>>>24]<<24|u[y>>>16&255]<<16|u[y>>>8&255]<<8|u[255&y],y^=h[a/r|0]<<24):r>6&&a%r===4&&(y=u[y>>>24]<<24|u[y>>>16&255]<<16|u[y>>>8&255]<<8|u[255&y]),l[a]=v=(l[a-r]^y)>>>0);for(o=0;o<s;o++)a=s-o,y=3&o?l[a]:l[a-4],c[o]=o<4||a<=4?y:f[u[y>>>24]]^p[u[y>>>16&255]]^g[u[y>>>8&255]]^m[u[255&y]],c[o]=c[o]>>>0}networkToHostOrderSwap(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24}decrypt(e,t,n){const i=this.keySize+6,r=this.invKeySchedule,s=this.invSBox,a=this.invSubMix,o=a[0],l=a[1],c=a[2],u=a[3],h=this.uint8ArrayToUint32Array_(n);let d=h[0],f=h[1],p=h[2],g=h[3];const m=new Int32Array(e),v=new Int32Array(m.length);let y,b,E,S,w,T,k,_,x,L,A,R,I,C;const D=this.networkToHostOrderSwap;for(;t<m.length;){for(x=D(m[t]),L=D(m[t+1]),A=D(m[t+2]),R=D(m[t+3]),w=x^r[0],T=R^r[1],k=A^r[2],_=L^r[3],I=4,C=1;C<i;C++)y=o[w>>>24]^l[T>>16&255]^c[k>>8&255]^u[255&_]^r[I],b=o[T>>>24]^l[k>>16&255]^c[_>>8&255]^u[255&w]^r[I+1],E=o[k>>>24]^l[_>>16&255]^c[w>>8&255]^u[255&T]^r[I+2],S=o[_>>>24]^l[w>>16&255]^c[T>>8&255]^u[255&k]^r[I+3],w=y,T=b,k=E,_=S,I+=4;y=s[w>>>24]<<24^s[T>>16&255]<<16^s[k>>8&255]<<8^s[255&_]^r[I],b=s[T>>>24]<<24^s[k>>16&255]<<16^s[_>>8&255]<<8^s[255&w]^r[I+1],E=s[k>>>24]<<24^s[_>>16&255]<<16^s[w>>8&255]<<8^s[255&T]^r[I+2],S=s[_>>>24]<<24^s[w>>16&255]<<16^s[T>>8&255]<<8^s[255&k]^r[I+3],v[t]=D(y^d),v[t+1]=D(S^f),v[t+2]=D(E^p),v[t+3]=D(b^g),d=x,f=L,p=A,g=R,t+=4}return v.buffer}}class ci{constructor(e,t,n){this.subtle=void 0,this.key=void 0,this.aesMode=void 0,this.subtle=e,this.key=t,this.aesMode=n}expandKey(){const e=function(e){switch(e){case 0:return"AES-CBC";case 1:return"AES-CTR";default:throw new Error(`[FastAESKey] invalid aes mode ${e}`)}}(this.aesMode);return this.subtle.importKey("raw",this.key,{name:e},!1,["encrypt","decrypt"])}}class ui{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.enableSoftwareAES=void 0,this.enableSoftwareAES=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const e=self.crypto;e&&(this.subtle=e.subtle||e.webkitSubtle)}catch(e){}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const n=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?function(e){const t=e.byteLength,n=t&&new DataView(e.buffer).getUint8(t-1);return n?e.slice(0,t-n):e}(n):n}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,n,i){return this.useSoftware?new Promise((r,s)=>{const a=ArrayBuffer.isView(e)?e:new Uint8Array(e);this.softwareDecrypt(a,t,n,i);const o=this.flush();o?r(o.buffer):s(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,n,i)}softwareDecrypt(e,t,n,i){const{currentIV:r,currentResult:s,remainderData:a}=this;if(0!==i||16!==t.byteLength)return at.warn("SoftwareDecrypt: can only handle AES-128-CBC"),null;this.logOnce("JS AES decrypt"),a&&(e=Wt(a,e),this.remainderData=null);const o=this.getValidChunk(e);if(!o.length)return null;r&&(n=r);let l=this.softwareDecrypter;l||(l=this.softwareDecrypter=new li),l.expandKey(t);const c=s;return this.currentResult=l.decrypt(o.buffer,0,n),this.currentIV=o.slice(-16).buffer,c||null}webCryptoDecrypt(e,t,n,i){if(this.key!==t||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,t,n,i));this.key=t,this.fastAesKey=new ci(this.subtle,t,i)}return this.fastAesKey.expandKey().then(t=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new oi(this.subtle,new Uint8Array(n),i).decrypt(e.buffer,t)):Promise.reject(new Error("web crypto not initialized"))).catch(r=>(at.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${r.name}: ${r.message}`),this.onWebCryptoError(e,t,n,i)))}onWebCryptoError(e,t,n,i){const r=this.enableSoftwareAES;if(r){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,n,i);const r=this.flush();if(r)return r.buffer}throw new Error("WebCrypto"+(r?" and softwareDecrypt":"")+": failed to decrypt data")}getValidChunk(e){let t=e;const n=e.length-e.length%16;return n!==e.length&&(t=e.slice(0,n),this.remainderData=e.slice(n)),t}logOnce(e){this.logEnabled&&(at.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const hi=Math.pow(2,17);class di{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const n=e.url;if(!n)return Promise.reject(new gi({type:Be.NETWORK_ERROR,details:Ue.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error("Fragment does not have a "+(n?"part list":"url")),networkDetails:null}));this.abort();const i=this.config,r=i.fLoader,s=i.loader;return new Promise((a,o)=>{if(this.loader&&this.loader.destroy(),e.gap){if(e.tagList.some(e=>"GAP"===e[0]))return void o(pi(e));e.gap=!1}const l=this.loader=r?new r(i):new s(i),c=fi(e);e.loader=l;const u=Yn(i.fragLoadPolicy.default),h={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:"initSegment"===e.sn?1/0:hi};e.stats=l.stats;const d={onSuccess:(t,n,i,r)=>{this.resetLoader(e,l);let s=t.data;i.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(s.slice(0,16)),s=s.slice(16)),a({frag:e,part:null,payload:s,networkDetails:r})},onError:(t,i,r,s)=>{this.resetLoader(e,l),o(new gi({type:Be.NETWORK_ERROR,details:Ue.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:Je({url:n,data:void 0},t),error:new Error(`HTTP Error ${t.code} ${t.text}`),networkDetails:r,stats:s}))},onAbort:(t,n,i)=>{this.resetLoader(e,l),o(new gi({type:Be.NETWORK_ERROR,details:Ue.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:i,stats:t}))},onTimeout:(t,n,i)=>{this.resetLoader(e,l),o(new gi({type:Be.NETWORK_ERROR,details:Ue.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${h.timeout}ms`),networkDetails:i,stats:t}))}};t&&(d.onProgress=(n,i,r,s)=>t({frag:e,part:null,payload:r,networkDetails:s})),l.load(c,h,d)})}loadPart(e,t,n){this.abort();const i=this.config,r=i.fLoader,s=i.loader;return new Promise((a,o)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap)return void o(pi(e,t));const l=this.loader=r?new r(i):new s(i),c=fi(e,t);e.loader=l;const u=Yn(i.fragLoadPolicy.default),h={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:hi};t.stats=l.stats,l.load(c,h,{onSuccess:(i,r,s,o)=>{this.resetLoader(e,l),this.updateStatsFromPart(e,t);const c={frag:e,part:t,payload:i.data,networkDetails:o};n(c),a(c)},onError:(n,i,r,s)=>{this.resetLoader(e,l),o(new gi({type:Be.NETWORK_ERROR,details:Ue.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:Je({url:c.url,data:void 0},n),error:new Error(`HTTP Error ${n.code} ${n.text}`),networkDetails:r,stats:s}))},onAbort:(n,i,r)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,l),o(new gi({type:Be.NETWORK_ERROR,details:Ue.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:r,stats:n}))},onTimeout:(n,i,r)=>{this.resetLoader(e,l),o(new gi({type:Be.NETWORK_ERROR,details:Ue.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${h.timeout}ms`),networkDetails:r,stats:n}))}})})}updateStatsFromPart(e,t){const n=e.stats,i=t.stats,r=i.total;if(n.loaded+=i.loaded,r){const i=Math.round(e.duration/t.duration),s=Math.min(Math.round(n.loaded/r),i),a=(i-s)*Math.round(n.loaded/s);n.total=n.loaded+a}else n.total=Math.max(n.loaded,n.total);const s=n.loading,a=i.loading;s.start?s.first+=a.first-a.start:(s.start=a.start,s.first=a.first),s.end=a.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function fi(e,t=null){const n=t||e,i={frag:e,part:t,responseType:"arraybuffer",url:n.url,headers:{},rangeStart:0,rangeEnd:0},r=n.byteRangeStartOffset,s=n.byteRangeEndOffset;if(Ne(r)&&Ne(s)){var a;let t=r,n=s;if("initSegment"===e.sn&&("AES-128"===(o=null==(a=e.decryptdata)?void 0:a.method)||"AES-256"===o)){const e=s-r;e%16&&(n=s+(16-e%16)),0!==r&&(i.resetIV=!0,t=r-16)}i.rangeStart=t,i.rangeEnd=n}var o;return i}function pi(e,t){const n=new Error(`GAP ${e.gap?"tag":"attribute"} found`),i={type:Be.MEDIA_ERROR,details:Ue.FRAG_GAP,fatal:!1,frag:e,error:n,networkDetails:null};return t&&(i.part=t),(t||e).stats.aborted=!0,new gi(i)}class gi extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class mi extends et{constructor(e,t){super(e,t),this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return!this._tickInterval&&(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)}clearNextTick(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)}tick(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}class vi{constructor(e,t,n,i=0,r=-1,s=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing={start:0,executeStart:0,executeEnd:0,end:0},this.buffering={audio:{start:0,executeStart:0,executeEnd:0,end:0},video:{start:0,executeStart:0,executeEnd:0,end:0},audiovideo:{start:0,executeStart:0,executeEnd:0,end:0}},this.level=e,this.sn=t,this.id=n,this.size=i,this.part=r,this.partial=s}}const yi={length:0,start:()=>0,end:()=>0};class bi{static isBuffered(e,t){if(e){const n=bi.getBuffered(e);for(let e=n.length;e--;)if(t>=n.start(e)&&t<=n.end(e))return!0}return!1}static bufferedRanges(e){if(e){const t=bi.getBuffered(e);return bi.timeRangesToArray(t)}return[]}static timeRangesToArray(e){const t=[];for(let n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t}static bufferInfo(e,t,n){if(e){const i=bi.bufferedRanges(e);if(i.length)return bi.bufferedInfo(i,t,n)}return{len:0,start:t,end:t,bufferedIndex:-1}}static bufferedInfo(e,t,n){t=Math.max(0,t),e.length>1&&e.sort((e,t)=>e.start-t.start||t.end-e.end);let i=-1,r=[];if(n)for(let s=0;s<e.length;s++){t>=e[s].start&&t<=e[s].end&&(i=s);const a=r.length;if(a){const t=r[a-1].end;e[s].start-t<n?e[s].end>t&&(r[a-1].end=e[s].end):r.push(e[s])}else r.push(e[s])}else r=e;let s,a=0,o=t,l=t;for(let e=0;e<r.length;e++){const c=r[e].start,u=r[e].end;if(-1===i&&t>=c&&t<=u&&(i=e),t+n>=c&&t<u)o=c,l=u,a=l-t;else if(t+n<c){s=c;break}}return{len:a,start:o||0,end:l||0,nextStart:s,buffered:e,bufferedIndex:i}}static getBuffered(e){try{return e.buffered||yi}catch(e){return at.log("failed to get media.buffered",e),yi}}}const Ei=/\{\$([a-zA-Z0-9-_]+)\}/g;function Si(e){return Ei.test(e)}function wi(e,t){if(null!==e.variableList||e.hasVariableRefs){const n=e.variableList;return t.replace(Ei,t=>{const i=t.substring(2,t.length-1),r=null==n?void 0:n[i];return void 0===r?(e.playlistParsingError||(e.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${i}"`)),t):r})}return t}function Ti(e,t,n){let i,r,s=e.variableList;if(s||(e.variableList=s={}),"QUERYPARAM"in t){i=t.QUERYPARAM;try{const e=new self.URL(n).searchParams;if(!e.has(i))throw new Error(`"${i}" does not match any query parameter in URI: "${n}"`);r=e.get(i)}catch(t){e.playlistParsingError||(e.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${t.message}`))}}else i=t.NAME,r=t.VALUE;i in s?e.playlistParsingError||(e.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${i}"`)):s[i]=r||""}function ki(e,t,n){const i=t.IMPORT;if(n&&i in n){let t=e.variableList;t||(e.variableList=t={}),t[i]=n[i]}else e.playlistParsingError||(e.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${i}"`))}const _i=/^(\d+)x(\d+)$/,xi=/(.+?)=(".*?"|.*?)(?:,|$)/g;class Li{constructor(e,t){"string"==typeof e&&(e=Li.parseAttrList(e,t)),Qe(this,e)}get clientAttrs(){return Object.keys(this).filter(e=>"X-"===e.substring(0,2))}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;const n=new Uint8Array(t.length/2);for(let e=0;e<t.length/2;e++)n[e]=parseInt(t.slice(2*e,2*e+2),16);return n}return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const n=this[e];return n?parseFloat(n):t}enumeratedString(e){return this[e]}enumeratedStringList(e,t){const n=this[e];return(n?n.split(/[ ,]+/):[]).reduce((e,t)=>(e[t.toLowerCase()]=!0,e),t)}bool(e){return"YES"===this[e]}decimalResolution(e){const t=_i.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e,t){let n;const i={};for(xi.lastIndex=0;null!==(n=xi.exec(e));){const r=n[1].trim();let s=n[2];const a=0===s.indexOf('"')&&s.lastIndexOf('"')===s.length-1;let o=!1;if(a)s=s.slice(1,-1);else switch(r){case"IV":case"SCTE35-CMD":case"SCTE35-IN":case"SCTE35-OUT":o=!0}if(t&&(a||o))s=wi(t,s);else if(!o&&!a)switch(r){case"CLOSED-CAPTIONS":if("NONE"===s)break;case"ALLOWED-CPC":case"CLASS":case"ASSOC-LANGUAGE":case"AUDIO":case"BYTERANGE":case"CHANNELS":case"CHARACTERISTICS":case"CODECS":case"DATA-ID":case"END-DATE":case"GROUP-ID":case"ID":case"IMPORT":case"INSTREAM-ID":case"KEYFORMAT":case"KEYFORMATVERSIONS":case"LANGUAGE":case"NAME":case"PATHWAY-ID":case"QUERYPARAM":case"RECENTLY-REMOVED-DATERANGES":case"SERVER-URI":case"STABLE-RENDITION-ID":case"STABLE-VARIANT-ID":case"START-DATE":case"SUBTITLES":case"SUPPLEMENTAL-CODECS":case"URI":case"VALUE":case"VIDEO":case"X-ASSET-LIST":case"X-ASSET-URI":at.warn(`${e}: attribute ${r} is missing quotes`)}i[r]=s}return i}}function Ai(e){return"ID"!==e&&"CLASS"!==e&&"CUE"!==e&&"START-DATE"!==e&&"DURATION"!==e&&"END-DATE"!==e&&"END-ON-NEXT"!==e}function Ri(e){return"SCTE35-OUT"===e||"SCTE35-IN"===e||"SCTE35-CMD"===e}class Ii{constructor(e,t,n=0){var i;if(this.attr=void 0,this.tagAnchor=void 0,this.tagOrder=void 0,this._startDate=void 0,this._endDate=void 0,this._dateAtEnd=void 0,this._cue=void 0,this._badValueForSameId=void 0,this.tagAnchor=(null==t?void 0:t.tagAnchor)||null,this.tagOrder=null!=(i=null==t?void 0:t.tagOrder)?i:n,t){const n=t.attr;for(const t in n)if(Object.prototype.hasOwnProperty.call(e,t)&&e[t]!==n[t]){at.warn(`DATERANGE tag attribute: "${t}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=t;break}e=Qe(new Li({}),n,e)}if(this.attr=e,t?(this._startDate=t._startDate,this._cue=t._cue,this._endDate=t._endDate,this._dateAtEnd=t._dateAtEnd):this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const e=(null==t?void 0:t.endDate)||new Date(this.attr["END-DATE"]);Ne(e.getTime())&&(this._endDate=e)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get cue(){const e=this._cue;return void 0===e?this._cue=this.attr.enumeratedStringList(this.attr.CUE?"CUE":"X-CUE",{pre:!1,post:!1,once:!1}):e}get startTime(){const{tagAnchor:e}=this;return null===e||null===e.programDateTime?(at.warn(`Expected tagAnchor Fragment with PDT set for DateRange "${this.id}": ${e}`),NaN):e.start+(this.startDate.getTime()-e.programDateTime)/1e3}get startDate(){return this._startDate}get endDate(){const e=this._endDate||this._dateAtEnd;if(e)return e;const t=this.duration;return null!==t?this._dateAtEnd=new Date(this._startDate.getTime()+1e3*t):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(Ne(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isInterstitial(){return"com.apple.hls.interstitial"===this.class}get isValid(){return!!this.id&&!this._badValueForSameId&&Ne(this.startDate.getTime())&&(null===this.duration||this.duration>=0)&&(!this.endOnNext||!!this.class)&&(!this.attr.CUE||!this.cue.pre&&!this.cue.post||this.cue.pre!==this.cue.post)&&(!this.isInterstitial||"X-ASSET-URI"in this.attr||"X-ASSET-LIST"in this.attr)}}class Ci{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.dateRangeTagCount=0,this.live=!0,this.requestScheduled=-1,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.appliedTimelineOffset=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e)return this.advanced=!0,void(this.updated=!0);const t=this.lastPartSn-e.lastPartSn,n=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!n||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||0===t&&n>0,this.updated||this.advanced?this.misses=Math.floor(.6*e.misses):this.misses=e.misses+1}hasKey(e){return this.encryptedFragments.some(t=>{let n=t.decryptdata;return n||(t.setKeyFormat(e.keyFormat),n=t.decryptdata),!!n&&e.matches(n)})}get hasProgramDateTime(){return!!this.fragments.length&&Ne(this.fragments[this.fragments.length-1].programDateTime)}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||10}get drift(){const e=this.driftEndTime-this.driftStartTime;return e>0?1e3*(this.driftEnd-this.driftStart)/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){return this.fragments.length?this.fragments[this.fragments.length-1].end:0}get fragmentStart(){return this.fragments.length?this.fragments[0].start:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].index:-1}get maxPartIndex(){const e=this.partList;if(e){const t=this.lastPartIndex;if(-1!==t){for(let n=e.length;n--;)if(e[n].index>t)return e[n].index;return t}}return 0}get lastPartSn(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}get expired(){if(this.live&&this.age&&this.misses<3){const e=this.partEnd-this.fragmentStart;return this.age>Math.max(e,this.totalduration)+this.levelTargetDuration}return!1}}function Di(e,t){return e.length===t.length&&!e.some((e,n)=>e!==t[n])}function Pi(e,t){return!e&&!t||!(!e||!t)&&Di(e,t)}function Oi(e){return"AES-128"===e||"AES-256"===e||"AES-256-CTR"===e}function Ni(e){switch(e){case"AES-128":case"AES-256":return 0;case"AES-256-CTR":return 1;default:throw new Error(`invalid full segment method ${e}`)}}function Mi(e){return Uint8Array.from(atob(e),e=>e.charCodeAt(0))}function Fi(e){return Uint8Array.from(unescape(encodeURIComponent(e)),e=>e.charCodeAt(0))}function Bi(e){const t=function(e,t,n){const i=e[t];e[t]=e[n],e[n]=i};t(e,0,3),t(e,1,2),t(e,4,5),t(e,6,7)}const Ui="undefined"!=typeof self?self:void 0;var $i={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},ji="org.w3.clearkey",zi="com.apple.streamingkeydelivery",Gi="com.microsoft.playready",Vi="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed";function qi(e){switch(e){case zi:return $i.FAIRPLAY;case Gi:return $i.PLAYREADY;case Vi:return $i.WIDEVINE;case ji:return $i.CLEARKEY}}function Hi(e){switch(e){case $i.FAIRPLAY:return zi;case $i.PLAYREADY:return Gi;case $i.WIDEVINE:return Vi;case $i.CLEARKEY:return ji}}function Wi(e){const{drmSystems:t,widevineLicenseUrl:n}=e,i=t?[$i.FAIRPLAY,$i.WIDEVINE,$i.PLAYREADY,$i.CLEARKEY].filter(e=>!!t[e]):[];return!i[$i.WIDEVINE]&&n&&i.push($i.WIDEVINE),i}const Ki=null!=Ui&&null!=(Yi=Ui.navigator)&&Yi.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null;var Yi;let Xi={};class Qi{static clearKeyUriToKeyIdMap(){Xi={}}static setKeyIdForUri(e,t){Xi[e]=t}constructor(e,t,n,i=[1],r=null,s){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=n,this.keyFormatVersions=i,this.iv=r,this.encrypted=!!e&&"NONE"!==e,this.isCommonEncryption=this.encrypted&&!Oi(e),null!=s&&s.startsWith("0x")&&(this.keyId=new Uint8Array(ht(s)))}matches(e){return e.uri===this.uri&&e.method===this.method&&e.encrypted===this.encrypted&&e.keyFormat===this.keyFormat&&Di(e.keyFormatVersions,this.keyFormatVersions)&&Pi(e.iv,this.iv)&&Pi(e.keyId,this.keyId)}isSupported(){if(this.method){if(Oi(this.method)||"NONE"===this.method)return!0;if("identity"===this.keyFormat)return"SAMPLE-AES"===this.method;switch(this.keyFormat){case zi:case Vi:case Gi:case ji:return-1!==["SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if(Oi(this.method)){let t=this.iv;return t||("number"!=typeof e&&(at.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0),t=function(e){const t=new Uint8Array(16);for(let n=12;n<16;n++)t[n]=e>>8*(15-n)&255;return t}(e)),new Qi(this.method,this.uri,"identity",this.keyFormatVersions,t)}if(this.pssh&&this.keyId)return this;const t=function(e){const t=e.split(":");let n=null;if("data"===t[0]&&2===t.length){const e=t[1].split(";"),i=e[e.length-1].split(",");if(2===i.length){const t="base64"===i[0],r=i[1];t?(e.splice(-1,1),n=Mi(r)):n=function(e){const t=Fi(e).subarray(0,16),n=new Uint8Array(16);return n.set(t,16-t.length),n}(r)}}return n}(this.uri);if(t)switch(this.keyFormat){case Vi:if(this.pssh=t,!this.keyId){const e=function(e){const t=[];if(e instanceof ArrayBuffer){const n=e.byteLength;let i=0;for(;i+32<n;){const n=Jt(new DataView(e,i));t.push(n),i+=n.size}}return t}(t.buffer);if(e.length){var n;const t=e[0];this.keyId=null!=(n=t.kids)&&n.length?t.kids[0]:null}}if(!this.keyId){const e=t.length-22;this.keyId=t.subarray(e,e+16)}break;case Gi:{const e=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=function(e,t,n){if(16!==e.byteLength)throw new RangeError("Invalid system id");let i,r,s;i=0,r=new Uint8Array,s=new Uint8Array;const a=new Uint8Array(4);return n.byteLength>0&&new DataView(a.buffer).setUint32(0,n.byteLength,!1),function(e,...t){const n=t.length;let i=8,r=n;for(;r--;)i+=t[r].byteLength;const s=new Uint8Array(i);for(s[0]=i>>24&255,s[1]=i>>16&255,s[2]=i>>8&255,s[3]=255&i,s.set(e,4),r=0,i=8;r<n;r++)s.set(t[r],i),i+=t[r].byteLength;return s}([112,115,115,104],new Uint8Array([0,0,0,0]),e,s,r,a,n)}(e,0,t),this.keyId=function(e){const t=new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2),n=String.fromCharCode.apply(null,Array.from(t)),i=n.substring(n.indexOf("<"),n.length),r=(new DOMParser).parseFromString(i,"text/xml").getElementsByTagName("KID")[0];if(r){const e=r.childNodes[0]?r.childNodes[0].nodeValue:r.getAttribute("VALUE");if(e){const t=Mi(e).subarray(0,16);return Bi(t),t}}return null}(t);break}default:{let e=t.subarray(0,16);if(16!==e.length){const t=new Uint8Array(16);t.set(e,16-e.length),e=t}this.keyId=e;break}}if(!this.keyId||16!==this.keyId.byteLength){let e=Xi[this.uri];if(!e){const t=Object.keys(Xi).length%Number.MAX_SAFE_INTEGER;e=new Uint8Array(16),new DataView(e.buffer,12,4).setUint32(0,t),Qi.setKeyIdForUri(this.uri,e)}this.keyId=e}return this}}const Zi=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,Ji=/#EXT-X-MEDIA:(.*)/g,er=/^#EXT(?:INF|-X-TARGETDURATION):/m,tr=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#.*/.source].join("|"),"g"),nr=new RegExp([/#EXT-X-(PROGRAM-DATE-TIME|BYTERANGE|DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class ir{static findGroup(e,t){for(let n=0;n<e.length;n++){const i=e[n];if(i.id===t)return i}}static resolve(e,t){return Et.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return er.test(e)}static parseMasterPlaylist(e,t){const n={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:Si(e)},i=[];if(Zi.lastIndex=0,!e.startsWith("#EXTM3U"))return n.playlistParsingError=new Error("no EXTM3U delimiter"),n;let r;for(;null!=(r=Zi.exec(e));)if(r[1]){var s;const e=new Li(r[1],n),a=wi(n,r[2]),o={attrs:e,bitrate:e.decimalInteger("BANDWIDTH")||e.decimalInteger("AVERAGE-BANDWIDTH"),name:e.NAME,url:ir.resolve(a,t)},l=e.decimalResolution("RESOLUTION");l&&(o.width=l.width,o.height=l.height),lr(e.CODECS,o);const c=e["SUPPLEMENTAL-CODECS"];c&&(o.supplemental={},lr(c,o.supplemental)),null!=(s=o.unknownCodecs)&&s.length||i.push(o),n.levels.push(o)}else if(r[3]){const e=r[3],i=r[4];switch(e){case"SESSION-DATA":{const e=new Li(i,n),t=e["DATA-ID"];t&&(null===n.sessionData&&(n.sessionData={}),n.sessionData[t]=e);break}case"SESSION-KEY":{const e=ar(i,t,n);e.encrypted&&e.isSupported()?(null===n.sessionKeys&&(n.sessionKeys=[]),n.sessionKeys.push(e)):at.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${i}"`);break}case"DEFINE":Ti(n,new Li(i,n),t);break;case"CONTENT-STEERING":{const e=new Li(i,n);n.contentSteering={uri:ir.resolve(e["SERVER-URI"],t),pathwayId:e["PATHWAY-ID"]||"."};break}case"START":n.startTimeOffset=or(i)}}const a=i.length>0&&i.length<n.levels.length;return n.levels=a?i:n.levels,0===n.levels.length&&(n.playlistParsingError=new Error("no levels found in manifest")),n}static parseMasterPlaylistMedia(e,t,n){let i;const r={},s=n.levels,a={AUDIO:s.map(e=>({id:e.attrs.AUDIO,audioCodec:e.audioCodec})),SUBTITLES:s.map(e=>({id:e.attrs.SUBTITLES,textCodec:e.textCodec})),"CLOSED-CAPTIONS":[]};let o=0;for(Ji.lastIndex=0;null!==(i=Ji.exec(e));){const e=new Li(i[1],n),s=e.TYPE;if(s){const n=a[s],i=r[s]||[];r[s]=i;const l=e.LANGUAGE,c=e["ASSOC-LANGUAGE"],u=e.CHANNELS,h=e.CHARACTERISTICS,d=e["INSTREAM-ID"],f={attrs:e,bitrate:0,id:o++,groupId:e["GROUP-ID"]||"",name:e.NAME||l||"",type:s,default:e.bool("DEFAULT"),autoselect:e.bool("AUTOSELECT"),forced:e.bool("FORCED"),lang:l,url:e.URI?ir.resolve(e.URI,t):""};if(c&&(f.assocLang=c),u&&(f.channels=u),h&&(f.characteristics=h),d&&(f.instreamId=d),null!=n&&n.length){const e=ir.findGroup(n,f.groupId)||n[0];cr(f,e,"audioCodec"),cr(f,e,"textCodec")}i.push(f)}}return r}static parseLevelPlaylist(e,t,n,i,r,s){var a;const o={url:t},l=new Ci(t),c=l.fragments,u=[];let h,d,f,p,g=null,m=0,v=0,y=0,b=0,E=0,S=null,w=new Lt(i,o),T=-1,k=!1,_=null;if(tr.lastIndex=0,l.m3u8=e,l.hasVariableRefs=Si(e),"#EXTM3U"!==(null==(a=tr.exec(e))?void 0:a[0]))return l.playlistParsingError=new Error("Missing format identifier #EXTM3U"),l;for(;null!==(h=tr.exec(e));){k&&(k=!1,w=new Lt(i,o),w.playlistOffset=y,w.setStart(y),w.sn=m,w.cc=b,E&&(w.bitrate=E),w.level=n,g&&(w.initSegment=g,g.rawProgramDateTime&&(w.rawProgramDateTime=g.rawProgramDateTime,g.rawProgramDateTime=null),_&&(w.setByteRange(_),_=null)));const e=h[1];if(e){w.duration=parseFloat(e);const t=(" "+h[2]).slice(1);w.title=t||null,w.tagList.push(t?["INF",e,t]:["INF",e])}else if(h[3]){if(Ne(w.duration)){w.playlistOffset=y,w.setStart(y),f&&dr(w,f,l),w.sn=m,w.level=n,w.cc=b,c.push(w);const e=(" "+h[3]).slice(1);w.relurl=wi(l,e),ur(w,S,u),S=w,y+=w.duration,m++,v=0,k=!0}}else{if(h=h[0].match(nr),!h){at.warn("No matches on slow regex match for level playlist!");continue}for(d=1;d<h.length&&void 0===h[d];d++);const e=(" "+h[d]).slice(1),r=(" "+h[d+1]).slice(1),a=h[d+2]?(" "+h[d+2]).slice(1):null;switch(e){case"BYTERANGE":S?w.setByteRange(r,S):w.setByteRange(r);break;case"PROGRAM-DATE-TIME":w.rawProgramDateTime=r,w.tagList.push(["PROGRAM-DATE-TIME",r]),-1===T&&(T=c.length);break;case"PLAYLIST-TYPE":l.type&&fr(l,e,h),l.type=r.toUpperCase();break;case"MEDIA-SEQUENCE":0!==l.startSN?fr(l,e,h):c.length>0&&pr(l,e,h),m=l.startSN=parseInt(r);break;case"SKIP":{l.skippedSegments&&fr(l,e,h);const t=new Li(r,l),n=t.decimalInteger("SKIPPED-SEGMENTS");if(Ne(n)){l.skippedSegments+=n;for(let e=n;e--;)c.push(null);m+=n}const i=t.enumeratedString("RECENTLY-REMOVED-DATERANGES");i&&(l.recentlyRemovedDateranges=(l.recentlyRemovedDateranges||[]).concat(i.split("\t")));break}case"TARGETDURATION":0!==l.targetduration&&fr(l,e,h),l.targetduration=Math.max(parseInt(r),1);break;case"VERSION":null!==l.version&&fr(l,e,h),l.version=parseInt(r);break;case"INDEPENDENT-SEGMENTS":break;case"ENDLIST":l.live||fr(l,e,h),l.live=!1;break;case"#":(r||a)&&w.tagList.push(a?[r,a]:[r]);break;case"DISCONTINUITY":b++,w.tagList.push(["DIS"]);break;case"GAP":w.gap=!0,w.tagList.push([e]);break;case"BITRATE":w.tagList.push([e,r]),E=1e3*parseInt(r),Ne(E)?w.bitrate=E:E=0;break;case"DATERANGE":{const e=new Li(r,l),t=new Ii(e,l.dateRanges[e.ID],l.dateRangeTagCount);l.dateRangeTagCount++,t.isValid||l.skippedSegments?l.dateRanges[t.id]=t:at.warn(`Ignoring invalid DATERANGE tag: "${r}"`),w.tagList.push(["EXT-X-DATERANGE",r]);break}case"DEFINE":{const e=new Li(r,l);"IMPORT"in e?ki(l,e,s):Ti(l,e,t)}break;case"DISCONTINUITY-SEQUENCE":0!==l.startCC?fr(l,e,h):c.length>0&&pr(l,e,h),l.startCC=b=parseInt(r);break;case"KEY":{const e=ar(r,t,l);if(e.isSupported()){if("NONE"===e.method){f=void 0;break}f||(f={});const t=f[e.keyFormat];null!=t&&t.matches(e)||(t&&(f=Qe({},f)),f[e.keyFormat]=e)}else at.warn(`[Keys] Ignoring unsupported EXT-X-KEY tag: "${r}"`);break}case"START":l.startTimeOffset=or(r);break;case"MAP":{const e=new Li(r,l);if(w.duration){const t=new Lt(i,o);hr(t,e,n,f),g=t,w.initSegment=g,g.rawProgramDateTime&&!w.rawProgramDateTime&&(w.rawProgramDateTime=g.rawProgramDateTime)}else{const t=w.byteRangeEndOffset;if(t){const e=w.byteRangeStartOffset;_=`${t-e}@${e}`}else _=null;hr(w,e,n,f),g=w,k=!0}g.cc=b;break}case"SERVER-CONTROL":p&&fr(l,e,h),p=new Li(r),l.canBlockReload=p.bool("CAN-BLOCK-RELOAD"),l.canSkipUntil=p.optionalFloat("CAN-SKIP-UNTIL",0),l.canSkipDateRanges=l.canSkipUntil>0&&p.bool("CAN-SKIP-DATERANGES"),l.partHoldBack=p.optionalFloat("PART-HOLD-BACK",0),l.holdBack=p.optionalFloat("HOLD-BACK",0);break;case"PART-INF":{l.partTarget&&fr(l,e,h);const t=new Li(r);l.partTarget=t.decimalFloatingPoint("PART-TARGET");break}case"PART":{let e=l.partList;e||(e=l.partList=[]);const t=v>0?e[e.length-1]:void 0,n=v++,i=new Li(r,l),s=new At(i,w,o,n,t);e.push(s),w.duration+=s.duration;break}case"PRELOAD-HINT":{const e=new Li(r,l);l.preloadHint=e;break}case"RENDITION-REPORT":{const e=new Li(r,l);l.renditionReports=l.renditionReports||[],l.renditionReports.push(e);break}default:at.warn(`line parsed but not handled: ${h}`)}}}S&&!S.relurl?(c.pop(),y-=S.duration,l.partList&&(l.fragmentHint=S)):l.partList&&(ur(w,S,u),w.cc=b,l.fragmentHint=w,f&&dr(w,f,l)),l.targetduration||(l.playlistParsingError=new Error("Missing Target Duration"));const x=c.length,L=c[0],A=c[x-1];if(y+=l.skippedSegments*l.targetduration,y>0&&x&&A){l.averagetargetduration=y/x;const e=A.sn;l.endSN="initSegment"!==e?e:0,l.live||(A.endList=!0),T>0&&(function(e,t){let n=e[t];for(let i=t;i--;){const t=e[i];if(!t)return;t.programDateTime=n.programDateTime-1e3*t.duration,n=t}}(c,T),L&&u.unshift(L))}return l.fragmentHint&&(y+=l.fragmentHint.duration),l.totalduration=y,u.length&&l.dateRangeTagCount&&L&&rr(u,l),l.endCC=b,l}}function rr(e,t){let n=e.length;if(!n){if(!t.hasProgramDateTime)return;{const i=t.fragments[t.fragments.length-1];e.push(i),n++}}const i=e[n-1],r=t.live?1/0:t.totalduration,s=Object.keys(t.dateRanges);for(let o=s.length;o--;){const l=t.dateRanges[s[o]],c=l.startDate.getTime();l.tagAnchor=i.ref;for(let i=n;i--;){var a;if((null==(a=e[i])?void 0:a.sn)<t.startSN)break;const n=sr(t,c,e,i,r);if(-1!==n){l.tagAnchor=t.fragments[n].ref;break}}}}function sr(e,t,n,i,r){const s=n[i];if(s){const o=s.programDateTime;var a;if(t>=o||0===i)if(t<=o+1e3*(((null==(a=n[i+1])?void 0:a.start)||r)-s.start)){const r=n[i].sn-e.startSN;if(r<0)return-1;const s=e.fragments;if(s.length>n.length)for(let a=(n[i+1]||s[s.length-1]).sn-e.startSN;a>r;a--){const e=s[a].programDateTime;if(t>=e&&t<e+1e3*s[a].duration)return a}return r}}return-1}function ar(e,t,n){var i,r;const s=new Li(e,n),a=null!=(i=s.METHOD)?i:"",o=s.URI,l=s.hexadecimalInteger("IV"),c=s.KEYFORMATVERSIONS,u=null!=(r=s.KEYFORMAT)?r:"identity";o&&s.IV&&!l&&at.error(`Invalid IV: ${s.IV}`);const h=o?ir.resolve(o,t):"",d=(c||"1").split("/").map(Number).filter(Number.isFinite);return new Qi(a,h,u,d,l,s.KEYID)}function or(e){const t=new Li(e).decimalFloatingPoint("TIME-OFFSET");return Ne(t)?t:null}function lr(e,t){let n=(e||"").split(/[ ,]+/).filter(e=>e);["video","audio","text"].forEach(e=>{const i=n.filter(t=>nn(t,e));i.length&&(t[`${e}Codec`]=i.map(e=>e.split("/")[0]).join(","),n=n.filter(e=>-1===i.indexOf(e)))}),t.unknownCodecs=n}function cr(e,t,n){const i=t[n];i&&(e[n]=i)}function ur(e,t,n){e.rawProgramDateTime?n.push(e):null!=t&&t.programDateTime&&(e.programDateTime=t.endProgramDateTime)}function hr(e,t,n,i){e.relurl=t.URI,t.BYTERANGE&&e.setByteRange(t.BYTERANGE),e.level=n,e.sn="initSegment",i&&(e.levelkeys=i),e.initSegment=null}function dr(e,t,n){e.levelkeys=t;const{encryptedFragments:i}=n;i.length&&i[i.length-1].levelkeys===t||!Object.keys(t).some(e=>t[e].isCommonEncryption)||i.push(e)}function fr(e,t,n){e.playlistParsingError=new Error(`#EXT-X-${t} must not appear more than once (${n[0]})`)}function pr(e,t,n){e.playlistParsingError=new Error(`#EXT-X-${t} must appear before the first Media Segment (${n[0]})`)}function gr(e,t){const n=t.startPTS;if(Ne(n)){let i,r=0;t.sn>e.sn?(r=n-e.start,i=e):(r=e.start-n,i=t),i.duration!==r&&i.setDuration(r)}else t.sn>e.sn?e.cc===t.cc&&e.minEndPTS?t.setStart(e.start+(e.minEndPTS-e.start)):t.setStart(e.start+e.duration):t.setStart(Math.max(e.start-t.duration,0))}function mr(e,t,n,i,r,s,a){i-n<=0&&(a.warn("Fragment should have a positive duration",t),i=n+t.duration,s=r+t.duration);let o=n,l=i;const c=t.startPTS,u=t.endPTS;if(Ne(c)){const h=Math.abs(c-n);e&&h>e.totalduration?a.warn(`media timestamps and playlist times differ by ${h}s for level ${t.level} ${e.url}`):Ne(t.deltaPTS)?t.deltaPTS=Math.max(h,t.deltaPTS):t.deltaPTS=h,o=Math.max(n,c),n=Math.min(n,c),r=void 0!==t.startDTS?Math.min(r,t.startDTS):r,l=Math.min(i,u),i=Math.max(i,u),s=void 0!==t.endDTS?Math.max(s,t.endDTS):s}const h=n-t.start;0!==t.start&&t.setStart(n),t.setDuration(i-t.start),t.startPTS=n,t.maxStartPTS=o,t.startDTS=r,t.endPTS=i,t.minEndPTS=l,t.endDTS=s;const d=t.sn;if(!e||d<e.startSN||d>e.endSN)return 0;let f;const p=d-e.startSN,g=e.fragments;for(g[p]=t,f=p;f>0;f--)gr(g[f],g[f-1]);for(f=p;f<g.length-1;f++)gr(g[f],g[f+1]);return e.fragmentHint&&gr(g[g.length-1],e.fragmentHint),e.PTSKnown=e.alignedSliding=!0,h}function vr(e,t,n,i,r){return new Error(`${e} ${r.url}\nPlaylist starting @${t.startSN}\n${t.m3u8}\n\nPlaylist starting @${n.startSN}\n${n.m3u8}`)}function yr(e,t,n=!0){const i=t.startSN+t.skippedSegments-e.startSN,r=e.fragments,s=i>=0;let a=0;if(s&&i<r.length)a=r[i].start;else if(s&&t.startSN===e.endSN+1)a=e.fragmentEnd;else if(s&&n)a=e.fragmentStart+i*t.levelTargetDuration;else{if(t.skippedSegments||0!==t.fragmentStart)return;a=e.fragmentStart}br(t,a)}function br(e,t){if(t){const n=e.fragments;for(let i=e.skippedSegments;i<n.length;i++)n[i].addStart(t);e.fragmentHint&&e.fragmentHint.addStart(t)}}function Er(e,t=1/0){let n=1e3*e.targetduration;if(e.updated){const i=e.fragments,r=4;if(i.length&&n*r>t){const e=1e3*i[i.length-1].duration;e<n&&(n=e)}}else n/=2;return Math.round(n)}function Sr(e,t,n){if(!e)return null;let i=e.fragments[t-e.startSN];return i||(i=e.fragmentHint,i&&i.sn===t?i:t<e.startSN&&n&&n.sn===t?n:null)}function wr(e,t,n){return e?Tr(e.partList,t,n):null}function Tr(e,t,n){if(e)for(let i=e.length;i--;){const r=e[i];if(r.index===n&&r.fragment.sn===t)return r}return null}function kr(e){e.forEach((e,t)=>{var n;null==(n=e.details)||n.fragments.forEach(e=>{e.level=t,e.initSegment&&(e.initSegment.level=t)})})}function _r(e,t){return!(e===t||!t)&&xr(e)!==xr(t)}function xr(e){return e.replace(/\?[^?]*$/,"")}function Lr(e,t){for(let i=0,r=e.length;i<r;i++){var n;if((null==(n=e[i])?void 0:n.cc)===t)return e[i]}return null}function Ar(e,t){const n=e.start+t;e.startPTS=n,e.setStart(n),e.endPTS=n+e.duration}function Rr(e,t){const n=t.fragments;for(let t=0,i=n.length;t<i;t++)Ar(n[t],e);t.fragmentHint&&Ar(t.fragmentHint,e),t.alignedSliding=!0}function Ir(e,t){if(!function(e,t){return!!(e&&t.startCC<e.endCC&&t.endCC>e.startCC)}(t,e))return;const n=Math.min(t.endCC,e.endCC),i=Lr(t.fragments,n),r=Lr(e.fragments,n);i&&r&&(at.log(`Aligning playlist at start of dicontinuity sequence ${n}`),Rr(i.start-r.start,e))}function Cr(e,t){if(!e.hasProgramDateTime||!t.hasProgramDateTime)return;const n=e.fragments,i=t.fragments;if(!n.length||!i.length)return;let r,s;const a=Math.min(t.endCC,e.endCC);t.startCC<a&&e.startCC<a&&(r=Lr(i,a),s=Lr(n,a)),r&&s||(r=i[Math.floor(i.length/2)],s=Lr(n,r.cc)||n[Math.floor(n.length/2)]);const o=r.programDateTime,l=s.programDateTime;o&&l&&Rr((l-o)/1e3-(s.start-r.start),e)}function Dr(e,t,n){Pr(e,t,n),e.addEventListener(t,n)}function Pr(e,t,n){e.removeEventListener(t,n)}const Or="STOPPED",Nr="IDLE",Mr="KEY_LOADING",Fr="FRAG_LOADING",Br="FRAG_LOADING_WAITING_RETRY",Ur="WAITING_TRACK",$r="PARSING",jr="PARSED",zr="ENDED",Gr="ERROR",Vr="WAITING_INIT_PTS",qr="WAITING_LEVEL";class Hr extends mi{constructor(e,t,n,i,r){super(i,e.logger),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=Or,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.loadingParts=!1,this.loopSn=void 0,this.onMediaSeeking=()=>{const{config:e,fragCurrent:t,media:n,mediaBuffer:i,state:r}=this,s=n?n.currentTime:0,a=bi.bufferInfo(i||n,s,e.maxBufferHole),o=!a.len;if(this.log(`Media seeking to ${Ne(s)?s.toFixed(3):s}, state: ${r}, ${o?"out of":"in"} buffer`),this.state===zr)this.resetLoadingState();else if(t){const n=e.maxFragLookUpTolerance,i=t.start-n,r=t.start+t.duration+n;if(o||r<a.start||i>a.end){const e=s>r;(s<i||e)&&(e&&t.loader&&(this.log(`Cancelling fragment load for seek (sn: ${t.sn})`),t.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}if(n&&(this.fragmentTracker.removeFragmentsInRange(s,1/0,this.playlistType,!0),s>this.lastCurrentTime&&(this.lastCurrentTime=s),!this.loadingParts)){const e=Math.max(a.end,s),t=this.shouldLoadParts(this.getLevelDetails(),e);t&&(this.log(`LL-Part loading ON after seeking to ${s.toFixed(2)} with buffer @${e.toFixed(2)}`),this.loadingParts=t)}this.hls.hasEnoughToStart||(this.log(`Setting ${o?"startPosition":"nextLoadPosition"} to ${s} for seek without enough to start`),this.nextLoadPosition=s,o&&(this.startPosition=s)),o&&this.state===Nr&&this.tickImmediate()},this.onMediaEnded=()=>{this.log("setting startPosition to 0 because media ended"),this.startPosition=this.lastCurrentTime=0},this.playlistType=r,this.hls=e,this.fragmentLoader=new di(e.config),this.keyLoader=n,this.fragmentTracker=t,this.config=e.config,this.decrypter=new ui(e.config)}registerListeners(){const{hls:e}=this;e.on($e.MEDIA_ATTACHED,this.onMediaAttached,this),e.on($e.MEDIA_DETACHING,this.onMediaDetaching,this),e.on($e.MANIFEST_LOADING,this.onManifestLoading,this),e.on($e.MANIFEST_LOADED,this.onManifestLoaded,this),e.on($e.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off($e.MEDIA_ATTACHED,this.onMediaAttached,this),e.off($e.MEDIA_DETACHING,this.onMediaDetaching,this),e.off($e.MANIFEST_LOADING,this.onManifestLoading,this),e.off($e.MANIFEST_LOADED,this.onManifestLoaded,this),e.off($e.ERROR,this.onError,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){if(this.state===Or)return;this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;null!=e&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=Or}get startPositionValue(){const{nextLoadPosition:e,startPosition:t}=this;return-1===t&&e?e:t}get bufferingEnabled(){return this.buffering}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}get inFlightFrag(){return{frag:this.fragCurrent,state:this.state}}_streamEnded(e,t){if(t.live||!this.media)return!1;const n=e.end||0,i=this.config.timelineOffset||0;if(n<=i)return!1;const r=e.buffered;this.config.maxBufferHole&&r&&r.length>1&&(e=bi.bufferedInfo(r,e.start,0));const s=e.nextStart;if(s&&s>i&&s<t.edge)return!1;if(this.media.currentTime<e.start)return!1;const a=t.partList;if(null!=a&&a.length){const e=a[a.length-1];return bi.isBuffered(this.media,e.start+e.duration/2)}const o=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(o)}getLevelDetails(){if(this.levels&&null!==this.levelLastLoaded)return this.levelLastLoaded.details}get timelineOffset(){const e=this.config.timelineOffset;var t;return e?(null==(t=this.getLevelDetails())?void 0:t.appliedTimelineOffset)||e:0}onMediaAttached(e,t){const n=this.media=this.mediaBuffer=t.media;Dr(n,"seeking",this.onMediaSeeking),Dr(n,"ended",this.onMediaEnded);const i=this.config;this.levels&&i.autoStartLoad&&this.state===Or&&this.startLoad(i.startPosition)}onMediaDetaching(e,t){const n=!!t.transferMedia,i=this.media;if(null!==i){if(i.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),Pr(i,"seeking",this.onMediaSeeking),Pr(i,"ended",this.onMediaEnded),this.keyLoader&&!n&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loopSn=void 0,n)return this.resetLoadingState(),void this.resetTransmuxer();this.loadingParts=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}}onManifestLoading(){this.initPTS=[],this.levels=this.levelLastLoaded=this.fragCurrent=null,this.lastCurrentTime=this.startPosition=0,this.startFragRequested=!1}onError(e,t){}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset}onHandlerDestroying(){this.stopLoad(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),super.onHandlerDestroying(),this.hls=this.onMediaSeeking=this.onMediaEnded=null}onHandlerDestroyed(){this.state=Or,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,n){this.startFragRequested=!0,this._loadFragForPlayback(e,t,n)}_loadFragForPlayback(e,t,n){this._doFragLoad(e,t,n,e=>{const t=e.frag;if(this.fragContextChanged(t))return this.warn(`${t.type} sn: ${t.sn}${e.part?" part: "+e.part.index:""} of ${this.fragInfo(t,!1,e.part)}) was dropped during download.`),void this.fragmentTracker.removeFragment(t);t.stats.chunkCount++,this._handleFragmentLoadProgress(e)}).then(e=>{if(!e)return;const t=this.state,n=e.frag;this.fragContextChanged(n)?(t===Fr||!this.fragCurrent&&t===$r)&&(this.fragmentTracker.removeFragment(n),this.state=Nr):("payload"in e&&(this.log(`Loaded ${n.type} sn: ${n.sn} of ${this.playlistLabel()} ${n.level}`),this.hls.trigger($e.FRAG_LOADED,e)),this._handleFragmentLoadComplete(e))}).catch(t=>{this.state!==Or&&this.state!==Gr&&(this.warn(`Frag error: ${(null==t?void 0:t.message)||t}`),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;const{fragmentTracker:n}=this;if(n.getState(e)===ei){const t=e.type,i=this.getFwdBufferInfo(this.mediaBuffer,t),r=Math.max(e.duration,i?i.len:this.config.maxBufferLength),s=this.backtrackFragment;(1===(s?e.sn-s.sn:0)||this.reduceMaxBufferLength(r,e.duration))&&n.removeFragment(e)}else 0===(null==(t=this.mediaBuffer)?void 0:t.buffered.length)?n.removeAllFragments():n.hasParts(e.type)&&(n.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),n.getState(e)===ti&&n.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}waitForLive(e){const t=e.details;return(null==t?void 0:t.live)&&"EVENT"!==t.type&&(this.levelLastLoaded!==e||t.expired)}flushMainBuffer(e,t,n=null){if(!(e-t))return;const i={startOffset:e,endOffset:t,type:n};this.hls.trigger($e.BUFFER_FLUSHING,i)}_loadInitSegment(e,t){this._doFragLoad(e,t).then(e=>{const t=null==e?void 0:e.frag;if(!t||this.fragContextChanged(t)||!this.levels)throw new Error("init load aborted");return e}).then(e=>{const{hls:t}=this,{frag:n,payload:i}=e,r=n.decryptdata;if(i&&i.byteLength>0&&null!=r&&r.key&&r.iv&&Oi(r.method)){const s=self.performance.now();return this.decrypter.decrypt(new Uint8Array(i),r.key.buffer,r.iv.buffer,Ni(r.method)).catch(e=>{throw t.trigger($e.ERROR,{type:Be.MEDIA_ERROR,details:Ue.FRAG_DECRYPT_ERROR,fatal:!1,error:e,reason:e.message,frag:n}),e}).then(i=>{const r=self.performance.now();return t.trigger($e.FRAG_DECRYPTED,{frag:n,payload:i,stats:{tstart:s,tdecrypt:r}}),e.payload=i,this.completeInitSegmentLoad(e)})}return this.completeInitSegmentLoad(e)}).catch(t=>{this.state!==Or&&this.state!==Gr&&(this.warn(t),this.resetFragmentLoading(e))})}completeInitSegmentLoad(e){const{levels:t}=this;if(!t)throw new Error("init load aborted, missing levels");const n=e.frag.stats;this.state!==Or&&(this.state=Nr),e.frag.data=new Uint8Array(e.payload),n.parsing.start=n.buffering.start=self.performance.now(),n.parsing.end=n.buffering.end=self.performance.now(),this.tick()}unhandledEncryptionError(e,t){var n,i;const r=e.tracks;if(r&&!t.encrypted&&(null!=(n=r.audio)&&n.encrypted||null!=(i=r.video)&&i.encrypted)&&(!this.config.emeEnabled||!this.keyLoader.emeController)){const e=this.media,n=new Error(`Encrypted track with no key in ${this.fragInfo(t)} (media ${e?"attached mediaKeys: "+e.mediaKeys:"detached"})`);return this.warn(n.message),!(!e||e.mediaKeys)&&(this.hls.trigger($e.ERROR,{type:Be.KEY_SYSTEM_ERROR,details:Ue.KEY_SYSTEM_NO_KEYS,fatal:!1,error:n,frag:t}),this.resetTransmuxer(),!0)}return!1}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.sn!==t.sn||e.level!==t.level}fragBufferedComplete(e,t){const n=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)} > buffer:${n?function(e){let t="";const n=e.length;for(let i=0;i<n;i++)t+=`[${e.start(i).toFixed(3)}-${e.end(i).toFixed(3)}]`;return t}(bi.getBuffered(n)):"(detached)"})`),xt(e)){var i;if(e.type!==We){const t=e.elementaryStreams;if(!Object.keys(t).some(e=>!!t[e]))return void(this.state=Nr)}const t=null==(i=this.levels)?void 0:i[e.level];null!=t&&t.fragmentError&&(this.log(`Resetting level fragment error count of ${t.fragmentError} on frag buffered`),t.fragmentError=0)}this.state=Nr}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:n,part:i,partsLoaded:r}=e,s=!r||0===r.length||r.some(e=>!e),a=new vi(n.level,n.sn,n.stats.chunkCount+1,0,i?i.index:-1,!s);t.flush(a)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,n=null,i){var r;this.fragCurrent=e;const s=t.details;if(!this.levels||!s)throw new Error(`frag load aborted, missing level${s?"":" detail"}s`);let a=null;if(!e.encrypted||null!=(r=e.decryptdata)&&r.key)e.encrypted||(a=this.keyLoader.loadClear(e,s.encryptedFragments,this.startFragRequested),a&&this.log("[eme] blocking frag load until media-keys acquired"));else if(this.log(`Loading key for ${e.sn} of [${s.startSN}-${s.endSN}], ${this.playlistLabel()} ${e.level}`),this.state=Mr,this.fragCurrent=e,a=this.keyLoader.load(e).then(e=>{if(!this.fragContextChanged(e.frag))return this.hls.trigger($e.KEY_LOADED,e),this.state===Mr&&(this.state=Nr),e}),this.hls.trigger($e.KEY_LOADING,{frag:e}),null===this.fragCurrent)return this.log("context changed in KEY_LOADING"),Promise.resolve(null);const o=this.fragPrevious;if(xt(e)&&(!o||e.sn!==o.sn)){const n=this.shouldLoadParts(t.details,e.end);n!==this.loadingParts&&(this.log(`LL-Part loading ${n?"ON":"OFF"} loading sn ${null==o?void 0:o.sn}->${e.sn}`),this.loadingParts=n)}if(n=Math.max(e.start,n||0),this.loadingParts&&xt(e)){const r=s.partList;if(r&&i){n>s.fragmentEnd&&s.fragmentHint&&(e=s.fragmentHint);const o=this.getNextPart(r,e,n);if(o>-1){const l=r[o];let c;return e=this.fragCurrent=l.fragment,this.log(`Loading ${e.type} sn: ${e.sn} part: ${l.index} (${o}/${r.length-1}) of ${this.fragInfo(e,!1,l)}) cc: ${e.cc} [${s.startSN}-${s.endSN}], target: ${parseFloat(n.toFixed(3))}`),this.nextLoadPosition=l.start+l.duration,this.state=Fr,c=a?a.then(n=>!n||this.fragContextChanged(n.frag)?null:this.doFragPartsLoad(e,l,t,i)).catch(e=>this.handleFragLoadError(e)):this.doFragPartsLoad(e,l,t,i).catch(e=>this.handleFragLoadError(e)),this.hls.trigger($e.FRAG_LOADING,{frag:e,part:l,targetBufferTime:n}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):c}if(!e.url||this.loadedEndOfParts(r,n))return Promise.resolve(null)}}var l;if(xt(e)&&this.loadingParts)this.log(`LL-Part loading OFF after next part miss @${n.toFixed(2)} Check buffer at sn: ${e.sn} loaded parts: ${null==(l=s.partList)?void 0:l.filter(e=>e.loaded).map(e=>`[${e.start}-${e.end}]`)}`),this.loadingParts=!1;else if(!e.url)return Promise.resolve(null);this.log(`Loading ${e.type} sn: ${e.sn} of ${this.fragInfo(e,!1)}) cc: ${e.cc} ${"["+s.startSN+"-"+s.endSN+"]"}, target: ${parseFloat(n.toFixed(3))}`),Ne(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=Fr;const c=this.config.progressive;let u;return u=c&&a?a.then(t=>!t||this.fragContextChanged(t.frag)?null:this.fragmentLoader.load(e,i)).catch(e=>this.handleFragLoadError(e)):Promise.all([this.fragmentLoader.load(e,c?i:void 0),a]).then(([e])=>(!c&&i&&i(e),e)).catch(e=>this.handleFragLoadError(e)),this.hls.trigger($e.FRAG_LOADING,{frag:e,targetBufferTime:n}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):u}doFragPartsLoad(e,t,n,i){return new Promise((r,s)=>{var a;const o=[],l=null==(a=n.details)?void 0:a.partList,c=t=>{this.fragmentLoader.loadPart(e,t,i).then(i=>{o[t.index]=i;const s=i.part;this.hls.trigger($e.FRAG_LOADED,i);const a=wr(n.details,e.sn,t.index+1)||Tr(l,e.sn,t.index+1);if(!a)return r({frag:e,part:s,partsLoaded:o});c(a)}).catch(s)};c(t)})}handleFragLoadError(e){if("data"in e){const t=e.data;t.frag&&t.details===Ue.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):t.frag&&t.type===Be.KEY_SYSTEM_ERROR?(t.frag.abortRequests(),this.resetStartWhenNotLoaded(),this.resetFragmentLoading(t.frag)):this.hls.trigger($e.ERROR,t)}else this.hls.trigger($e.ERROR,{type:Be.OTHER_ERROR,details:Ue.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==$r)return void(this.fragCurrent||this.state===Or||this.state===Gr||(this.state=Nr));const{frag:n,part:i,level:r}=t,s=self.performance.now();n.stats.parsing.end=s,i&&(i.stats.parsing.end=s);const a=this.getLevelDetails(),o=a&&n.sn>a.endSN||this.shouldLoadParts(a,n.end);o!==this.loadingParts&&(this.log(`LL-Part loading ${o?"ON":"OFF"} after parsing segment ending @${n.end.toFixed(2)}`),this.loadingParts=o),this.updateLevelTiming(n,i,r,e.partial)}shouldLoadParts(e,t){if(this.config.lowLatencyMode){if(!e)return this.loadingParts;if(e.partList){var n;const r=e.partList[0];if(r.fragment.type===We)return!1;var i;if(t>=r.end+((null==(n=e.fragmentHint)?void 0:n.duration)||0))if((this.hls.hasEnoughToStart?(null==(i=this.media)?void 0:i.currentTime)||this.lastCurrentTime:this.getLoadPosition())>r.start-r.fragment.duration)return!0}}return!1}getCurrentContext(e){const{levels:t,fragCurrent:n}=this,{level:i,sn:r,part:s}=e;if(null==t||!t[i])return this.warn(`Levels object was unset while buffering fragment ${r} of ${this.playlistLabel()} ${i}. The current chunk will not be buffered.`),null;const a=t[i],o=a.details,l=s>-1?wr(o,r,s):null,c=l?l.fragment:Sr(o,r,n);return c?(n&&n!==c&&(c.stats=n.stats),{frag:c,part:l,level:a}):null}bufferFragmentData(e,t,n,i,r){if(this.state!==$r)return;const{data1:s,data2:a}=e;let o=s;if(a&&(o=Wt(s,a)),!o.length)return;const l=this.initPTS[t.cc],c=l?-l.baseTime/l.timescale:void 0,u={type:e.type,frag:t,part:n,chunkMeta:i,offset:c,parent:t.type,data:o};if(this.hls.trigger($e.BUFFER_APPENDING,u),e.dropped&&e.independent&&!n){if(r)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!bi.isBuffered(t,t.currentTime))return void this.flushMainBuffer(0,e.start);const n=t.currentTime,i=bi.bufferInfo(t,n,0),r=e.duration,s=Math.min(2*this.config.maxFragLookUpTolerance,.25*r),a=Math.max(Math.min(e.start-s,i.end-s),n+s);e.start-a>s&&this.flushMainBuffer(a,e.start)}getFwdBufferInfo(e,t){var n;const i=this.getLoadPosition();if(!Ne(i))return null;const r=this.lastCurrentTime>i||null!=(n=this.media)&&n.paused?0:this.config.maxBufferHole;return this.getFwdBufferInfoAtPos(e,i,t,r)}getFwdBufferInfoAtPos(e,t,n,i){const r=bi.bufferInfo(e,t,i);if(0===r.len&&void 0!==r.nextStart){const s=this.fragmentTracker.getBufferedFrag(t,n);if(s&&(r.nextStart<=s.end||s.gap)){const n=Math.max(Math.min(r.nextStart,s.end)-t,i);return bi.bufferInfo(e,t,n)}}return r}getMaxBufferLength(e){const{config:t}=this;let n;return n=e?Math.max(8*t.maxBufferSize/e,t.maxBufferLength):t.maxBufferLength,Math.min(n,t.maxMaxBufferLength)}reduceMaxBufferLength(e,t){const n=this.config,i=Math.max(Math.min(e-t,n.maxBufferLength),t),r=Math.max(e-3*t,n.maxMaxBufferLength/2,i);return r>=i&&(n.maxMaxBufferLength=r,this.warn(`Reduce max buffer length to ${r}s`),!0)}getAppendedFrag(e,t=qe){const n=this.fragmentTracker?this.fragmentTracker.getAppendedFrag(e,t):null;return n&&"fragment"in n?n.fragment:n}getNextFragment(e,t){const n=t.fragments,i=n.length;if(!i)return null;const{config:r}=this,s=n[0].start,a=r.lowLatencyMode&&!!t.partList;let o=null;if(t.live){const n=r.initialLiveManifestSize;if(i<n)return this.warn(`Not enough fragments to start playback (have: ${i}, need: ${n})`),null;if(!t.PTSKnown&&!this.startFragRequested&&-1===this.startPosition||e<s){var l;a&&!this.loadingParts&&(this.log("LL-Part loading ON for initial live fragment"),this.loadingParts=!0),o=this.getInitialLiveFragment(t);const n=this.hls.startPosition,i=this.hls.liveSyncPosition,r=o?(-1!==n&&n>=s?n:i)||o.start:e;this.log(`Setting startPosition to ${r} to match start frag at live edge. mainStart: ${n} liveSyncPosition: ${i} frag.start: ${null==(l=o)?void 0:l.start}`),this.startPosition=this.nextLoadPosition=r}}else e<=s&&(o=n[0]);if(!o){const n=this.loadingParts?t.partEnd:t.fragmentEnd;o=this.getFragmentAtPosition(e,n,t)}let c=this.filterReplacedPrimary(o,t);if(!c&&o){const e=o.sn-t.startSN;c=this.filterReplacedPrimary(n[e+1]||null,t)}return this.mapToInitFragWhenRequired(c)}isLoopLoading(e,t){const n=this.fragmentTracker.getState(e);return(n===ni||n===ti&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,n,i,r){let s=null;if(e.gap&&(s=this.getNextFragment(this.nextLoadPosition,t),s&&!s.gap&&n.nextStart)){const e=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,n.nextStart,i,0);if(null!==e&&n.len+e.len>=r){const e=s.sn;return this.loopSn!==e&&(this.log(`buffer full after gaps in "${i}" playlist starting at sn: ${e}`),this.loopSn=e),null}}return this.loopSn=void 0,s}get primaryPrefetch(){var e;if(Wr(this.config)&&(null==(e=this.hls.interstitialsManager)||null==(e=e.playingItem)?void 0:e.event))return!0;return!1}filterReplacedPrimary(e,t){if(!e)return e;if(Wr(this.config)&&e.type!==We){const n=this.hls.interstitialsManager,i=null==n?void 0:n.bufferingItem;if(i){const n=i.event;if(n){if(n.appendInPlace||Math.abs(e.start-i.start)>1||0===i.start)return null}else{if(e.end<=i.start&&!1===(null==t?void 0:t.live))return null;if(e.start>i.end&&i.nextEvent&&(i.nextEvent.appendInPlace||e.start-i.end>1))return null}}const r=null==n?void 0:n.playerQueue;if(r)for(let t=r.length;t--;){const n=r[t].interstitial;if(n.appendInPlace&&e.start>=n.startTime&&e.end<=n.resumeTime)return null}}return e}mapToInitFragWhenRequired(e){return null==e||!e.initSegment||e.initSegment.data||this.bitrateTest?e:e.initSegment}getNextPart(e,t,n){let i=-1,r=!1,s=!0;for(let a=0,o=e.length;a<o;a++){const o=e[a];if(s=s&&!o.independent,i>-1&&n<o.start)break;const l=o.loaded;l?i=-1:(r||(o.independent||s)&&o.fragment===t)&&(o.fragment!==t&&this.warn(`Need buffer at ${n} but next unloaded part starts at ${o.start}`),i=a),r=l}return i}loadedEndOfParts(e,t){let n;for(let i=e.length;i--;){if(n=e[i],!n.loaded)return!1;if(t>n.start)return!0}return!1}getInitialLiveFragment(e){const t=e.fragments,n=this.fragPrevious;let i=null;if(n){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${n.programDateTime}`),i=function(e,t,n){if(null===t||!Array.isArray(e)||!e.length||!Ne(t))return null;if(t<(e[0].programDateTime||0))return null;if(t>=(e[e.length-1].endProgramDateTime||0))return null;for(let i=0;i<e.length;++i){const r=e[i];if(zn(t,n,r))return r}return null}(t,n.endProgramDateTime,this.config.maxFragLookUpTolerance)),!i){const r=n.sn+1;if(r>=e.startSN&&r<=e.endSN){const s=t[r-e.startSN];n.cc===s.cc&&(i=s,this.log(`Live playlist, switching playlist, load frag with next SN: ${i.sn}`))}i||(i=Gn(e,n.cc,n.end),i&&this.log(`Live playlist, switching playlist, load frag with same CC: ${i.sn}`))}}else{const t=this.hls.liveSyncPosition;null!==t&&(i=this.getFragmentAtPosition(t,this.bitrateTest?e.fragmentEnd:e.edge,e))}return i}getFragmentAtPosition(e,t,n){const{config:i}=this;let{fragPrevious:r}=this,{fragments:s,endSN:a}=n;const{fragmentHint:o}=n,{maxFragLookUpTolerance:l}=i,c=n.partList,u=!!(this.loadingParts&&null!=c&&c.length&&o);let h;var d;(u&&!this.bitrateTest&&c[c.length-1].fragment.sn===o.sn&&(s=s.concat(o),a=o.sn),e<t)?h=$n(r,s,e,e<this.lastCurrentTime||e>t-l||null!=(d=this.media)&&d.paused||!this.startFragRequested?0:l):h=s[s.length-1];if(h){const e=h.sn-n.startSN,t=this.fragmentTracker.getState(h);if((t===ni||t===ti&&h.gap)&&(r=h),r&&h.sn===r.sn&&(!u||c[0].fragment.sn>h.sn||!n.live)&&h.level===r.level){const t=s[e+1];h=h.sn<a&&this.fragmentTracker.getState(t)!==ni?t:null}}return h}alignPlaylists(e,t,n){const i=e.fragments.length;if(!i)return this.warn("No fragments in live playlist"),0;const r=e.fragmentStart,s=!t,a=e.alignedSliding&&Ne(r);if(s||!a&&!r){!function(e,t){e&&(Ir(t,e),t.alignedSliding||Cr(t,e),t.alignedSliding||t.skippedSegments||yr(e,t,!1))}(n,e);const r=e.fragmentStart;return this.log(`Live playlist sliding: ${r.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} fragments: ${i}`),r}return r}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,3*e.partTarget)}setStartPosition(e,t){let n=this.startPosition;n<t&&(n=-1);const i=this.timelineOffset;if(-1===n){const r=null!==this.startTimeOffset,s=r?this.startTimeOffset:e.startTimeOffset;null!==s&&Ne(s)?(n=t+s,s<0&&(n+=e.edge),n=Math.min(Math.max(t,n),t+e.totalduration),this.log(`Setting startPosition to ${n} for start time offset ${s} found in ${r?"multivariant":"media"} playlist`),this.startPosition=n):e.live?(n=this.hls.liveSyncPosition||t,this.log(`Setting startPosition to -1 to start at live edge ${n}`),this.startPosition=-1):(this.log("setting startPosition to 0 by default"),this.startPosition=n=0),this.lastCurrentTime=n+i}this.nextLoadPosition=n+i}getLoadPosition(){var e;const{media:t}=this;let n=0;return null!=(e=this.hls)&&e.hasEnoughToStart&&t?n=t.currentTime:this.nextLoadPosition>=0&&(n=this.nextLoadPosition),n}handleFragLoadAborted(e,t){this.transmuxer&&e.type===this.playlistType&&xt(e)&&e.stats.aborted&&(this.log(`Fragment ${e.sn}${t?" part "+t.index:""} of ${this.playlistLabel()} ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){this.fragCurrent&&(this.fragContextChanged(e)||this.state===Br)||(this.state=Nr)}onFragmentOrKeyLoadError(e,t){var n;if(t.chunkMeta&&!t.frag){const e=this.getCurrentContext(t.chunkMeta);e&&(t.frag=e.frag)}const i=t.frag;if(!i||i.type!==e||!this.levels)return;var r;if(this.fragContextChanged(i))return void this.warn(`Frag load error must match current frag to retry ${i.url} > ${null==(r=this.fragCurrent)?void 0:r.url}`);const s=t.details===Ue.FRAG_GAP;s&&this.fragmentTracker.fragBuffered(i,!0);const a=t.errorAction;if(!a)return void(this.state=Gr);const{action:o,flags:l,retryCount:c=0,retryConfig:u}=a,h=!!u,d=h&&5===o,f=h&&!a.resolved&&1===l,p=null==(n=this.hls.latestLevelDetails)?void 0:n.live;if(!d&&f&&xt(i)&&!i.endList&&p&&!Hn(t))this.resetFragmentErrors(e),this.treatAsGap(i),a.resolved=!0;else if((d||f)&&c<u.maxNumRetry){var g;const n=Qn(null==(g=t.response)?void 0:g.code),r=Kn(u,c);if(this.resetStartWhenNotLoaded(),this.retryDate=self.performance.now()+r,this.state=Br,a.resolved=!0,n)return this.log("Waiting for connection (offline)"),this.retryDate=1/0,void(t.reason="offline");this.warn(`Fragment ${i.sn} of ${e} ${i.level} errored with ${t.details}, retrying loading ${c+1}/${u.maxNumRetry} in ${r}ms`)}else if(u){if(this.resetFragmentErrors(e),!(c<u.maxNumRetry))return void this.warn(`${t.details} reached or exceeded max retry (${c})`);s||3===o||(a.resolved=!0)}else this.state=2===o?qr:Gr;this.tickImmediate()}checkRetryDate(){const e=self.performance.now(),t=this.retryDate,n=t===1/0;(!t||e>=t||n&&!Qn(0))&&(n&&this.log("Connection restored (online)"),this.resetStartWhenNotLoaded(),this.state=Nr)}reduceLengthAndFlushBuffer(e){if(this.state===$r||this.state===jr){const t=e.frag,n=e.parent,i=this.getFwdBufferInfo(this.mediaBuffer,n),r=i&&i.len>.5;r&&this.reduceMaxBufferLength(i.len,(null==t?void 0:t.duration)||10);const s=!r;return s&&this.warn(`Buffer full error while media.currentTime (${this.getLoadPosition()}) is not buffered, flush ${n} buffer`),t&&(this.fragmentTracker.removeFragment(t),this.nextLoadPosition=t.start),this.resetLoadingState(),s}return!1}resetFragmentErrors(e){e===He&&(this.fragCurrent=null),this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.state!==Or&&(this.state=Nr)}afterBufferFlushed(e,t,n){if(!e)return;const i=bi.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,i,n),this.state===zr&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state!==Or&&(this.state=Nr)}resetStartWhenNotLoaded(){if(!this.hls.hasEnoughToStart){this.startFragRequested=!1;const e=this.levelLastLoaded,t=e?e.details:null;null!=t&&t.live?(this.log("resetting startPosition for live start"),this.startPosition=-1,this.setStartPosition(t,t.fragmentStart),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.log(`Loading context changed while buffering sn ${e.sn} of ${this.playlistLabel()} ${-1===e.level?"<removed>":e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,n,i){const r=n.details;if(r){var s;if(!Object.keys(e.elementaryStreams).reduce((t,s)=>{const a=e.elementaryStreams[s];if(a){const o=a.endPTS-a.startPTS;if(o<=0)return this.warn(`Could not parse fragment ${e.sn} ${s} duration reliably (${o})`),t||!1;const l=i?0:mr(r,e,a.startPTS,a.endPTS,a.startDTS,a.endDTS,this);return this.hls.trigger($e.LEVEL_PTS_UPDATED,{details:r,level:n,drift:l,type:s,frag:e,start:a.startPTS,end:a.endPTS}),!0}return t},!1)&&(0===n.fragmentError&&this.treatAsGap(e,n),null===(null==(s=this.transmuxer)?void 0:s.error))){const t=new Error(`Found no media in fragment ${e.sn} of ${this.playlistLabel()} ${e.level} resetting transmuxer to fallback to playlist timing`);if(this.warn(t.message),this.hls.trigger($e.ERROR,{type:Be.MEDIA_ERROR,details:Ue.FRAG_PARSING_ERROR,fatal:!1,error:t,frag:e,reason:`Found no media in msn ${e.sn} of ${this.playlistLabel()} "${n.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state=jr,this.log(`Parsed ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)})`),this.hls.trigger($e.FRAG_PARSED,{frag:e,part:t})}else this.warn("level.details undefined")}playlistLabel(){return this.playlistType===qe?"level":"track"}fragInfo(e,t=!0,n){var i,r;return`${this.playlistLabel()} ${e.level} (${n?"part":"frag"}:[${(null!=(i=t&&!n?e.startPTS:(n||e).start)?i:NaN).toFixed(3)}-${(null!=(r=t&&!n?e.endPTS:(n||e).end)?r:NaN).toFixed(3)}]${n&&"main"===e.type?"INDEPENDENT="+(n.independent?"YES":"NO"):""}`}treatAsGap(e,t){t&&t.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)}resetTransmuxer(){var e;null==(e=this.transmuxer)||e.reset()}recoverWorkerError(e){"demuxerWorker"===e.event&&(this.fragmentTracker.removeAllFragments(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),this.resetStartWhenNotLoaded(),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}function Wr(e){return!!e.interstitialsController&&!1!==e.enableInterstitialPlayback}class Kr{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let n;return e.length?(n=1===e.length?e[0]:function(e,t){const n=new Uint8Array(t);let i=0;for(let t=0;t<e.length;t++){const r=e[t];n.set(r,i),i+=r.length}return n}(e,t),this.reset(),n):new Uint8Array(0)}reset(){this.chunks.length=0,this.dataLength=0}}var Yr,Xr={exports:{}},Qr=(Yr||(Yr=1,function(e){var t=Object.prototype.hasOwnProperty,n="~";function i(){}function r(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function s(e,t,i,s,a){if("function"!=typeof i)throw new TypeError("The listener must be a function");var o=new r(i,s||e,a),l=n?n+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],o]:e._events[l].push(o):(e._events[l]=o,e._eventsCount++),e}function a(e,t){0===--e._eventsCount?e._events=new i:delete e._events[t]}function o(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(n=!1)),o.prototype.eventNames=function(){var e,i,r=[];if(0===this._eventsCount)return r;for(i in e=this._events)t.call(e,i)&&r.push(n?i.slice(1):i);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},o.prototype.listeners=function(e){var t=n?n+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var r=0,s=i.length,a=new Array(s);r<s;r++)a[r]=i[r].fn;return a},o.prototype.listenerCount=function(e){var t=n?n+e:e,i=this._events[t];return i?i.fn?1:i.length:0},o.prototype.emit=function(e,t,i,r,s,a){var o=n?n+e:e;if(!this._events[o])return!1;var l,c,u=this._events[o],h=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),h){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,i),!0;case 4:return u.fn.call(u.context,t,i,r),!0;case 5:return u.fn.call(u.context,t,i,r,s),!0;case 6:return u.fn.call(u.context,t,i,r,s,a),!0}for(c=1,l=new Array(h-1);c<h;c++)l[c-1]=arguments[c];u.fn.apply(u.context,l)}else{var d,f=u.length;for(c=0;c<f;c++)switch(u[c].once&&this.removeListener(e,u[c].fn,void 0,!0),h){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,t);break;case 3:u[c].fn.call(u[c].context,t,i);break;case 4:u[c].fn.call(u[c].context,t,i,r);break;default:if(!l)for(d=1,l=new Array(h-1);d<h;d++)l[d-1]=arguments[d];u[c].fn.apply(u[c].context,l)}}return!0},o.prototype.on=function(e,t,n){return s(this,e,t,n,!1)},o.prototype.once=function(e,t,n){return s(this,e,t,n,!0)},o.prototype.removeListener=function(e,t,i,r){var s=n?n+e:e;if(!this._events[s])return this;if(!t)return a(this,s),this;var o=this._events[s];if(o.fn)o.fn!==t||r&&!o.once||i&&o.context!==i||a(this,s);else{for(var l=0,c=[],u=o.length;l<u;l++)(o[l].fn!==t||r&&!o[l].once||i&&o[l].context!==i)&&c.push(o[l]);c.length?this._events[s]=1===c.length?c[0]:c:a(this,s)}return this},o.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&a(this,t)):(this._events=new i,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=n,o.EventEmitter=o,e.exports=o}(Xr)),Xr.exports),Zr=dt(Qr);const Jr="1.6.12",es={};function ts(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128}function ns(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128}function is(e,t){let n=0;return n=(127&e[t])<<21,n|=(127&e[t+1])<<14,n|=(127&e[t+2])<<7,n|=127&e[t+3],n}function rs(e,t){const n=t;let i=0;for(;ns(e,t);)i+=10,i+=is(e,t+6),ts(e,t+10)&&(i+=10),t+=i;if(i>0)return e.subarray(n,n+i)}function ss(e,t){return 255===e[t]&&240==(246&e[t+1])}function as(e,t){return 1&e[t+1]?7:9}function os(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5}function ls(e,t){return t+1<e.length&&ss(e,t)}function cs(e,t){if(ls(e,t)){const n=as(e,t);if(t+n>=e.length)return!1;const i=os(e,t);if(i<=n)return!1;const r=t+i;return r===e.length||ls(e,r)}return!1}function us(e,t,n,i,r){if(!e.samplerate){const s=function(e,t,n,i){const r=t[n+2],s=r>>2&15;if(s>12){const t=new Error(`invalid ADTS sampling index:${s}`);return void e.emit($e.ERROR,$e.ERROR,{type:Be.MEDIA_ERROR,details:Ue.FRAG_PARSING_ERROR,fatal:!0,error:t,reason:t.message})}const a=1+(r>>6&3),o=t[n+3]>>6&3|(1&r)<<2,l="mp4a.40."+a,c=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350][s];let u=s;5!==a&&29!==a||(u-=3);const h=[a<<3|(14&u)>>1,(1&u)<<7|o<<3];return at.log(`manifest codec:${i}, parsed codec:${l}, channels:${o}, rate:${c} (ADTS object type:${a} sampling index:${s})`),{config:h,samplerate:c,channelCount:o,codec:l,parsedCodec:l,manifestCodec:i}}(t,n,i,r);if(!s)return;Qe(e,s)}}function hs(e){return 9216e4/e}function ds(e,t,n,i,r){const s=i+r*hs(e.samplerate),a=function(e,t){const n=as(e,t);if(t+n<=e.length){const i=os(e,t)-n;if(i>0)return{headerLength:n,frameLength:i}}}(t,n);let o;if(a){const{frameLength:i,headerLength:r}=a,l=r+i,c=Math.max(0,n+l-t.length);c?(o=new Uint8Array(l-r),o.set(t.subarray(n+r,t.length),0)):o=t.subarray(n+r,n+l);const u={unit:o,pts:s};return c||e.samples.push(u),{sample:u,length:l,missing:c}}const l=t.length-n;return o=new Uint8Array(l),o.set(t.subarray(n,t.length),0),{sample:{unit:o,pts:s},length:l,missing:-1}}function fs(e,t){return ns(e,t)&&is(e,t+6)+10<=e.length-t}function ps(e,t=0,n=1/0){return function(e,t,n,i){const r=(s=e)instanceof ArrayBuffer?s:s.buffer;var s;let a=1;"BYTES_PER_ELEMENT"in i&&(a=i.BYTES_PER_ELEMENT);const o=(h=e)&&h.buffer instanceof ArrayBuffer&&void 0!==h.byteLength&&void 0!==h.byteOffset?e.byteOffset:0,l=(o+e.byteLength)/a,c=(o+t)/a,u=Math.floor(Math.max(0,Math.min(c,l)));var h;return new i(r,u,Math.floor(Math.min(u+Math.max(n,0),l))-u)}(e,t,n,Uint8Array)}function gs(e){return"PRIV"===e.type?function(e){if(e.size<2)return;const t=ct(e.data,!0),n=new Uint8Array(e.data.subarray(t.length+1));return{key:e.type,info:t,data:n.buffer}}(e):"W"===e.type[0]?function(e){if("WXXX"===e.type){if(e.size<2)return;let t=1;const n=ct(e.data.subarray(t),!0);t+=n.length+1;const i=ct(e.data.subarray(t));return{key:e.type,info:n,data:i}}const t=ct(e.data);return{key:e.type,info:"",data:t}}(e):"APIC"===e.type?function(e){const t={key:e.type,description:"",data:"",mimeType:null,pictureType:null};if(e.size<2)return;if(3!==e.data[0])return void console.log("Ignore frame with unrecognized character encoding");const n=e.data.subarray(1).indexOf(0);if(-1===n)return;const i=ct(ps(e.data,1,n)),r=e.data[2+n],s=e.data.subarray(3+n).indexOf(0);if(-1===s)return;const a=ct(ps(e.data,3+n,s));let o;return o="--\x3e"===i?ct(ps(e.data,4+n+s)):(l=e.data.subarray(4+n+s))instanceof ArrayBuffer?l:0==l.byteOffset&&l.byteLength==l.buffer.byteLength?l.buffer:new Uint8Array(l).buffer,t.mimeType=i,t.pictureType=r,t.description=a,t.data=o,t;var l}(e):function(e){if(e.size<2)return;if("TXXX"===e.type){let t=1;const n=ct(e.data.subarray(t),!0);t+=n.length+1;const i=ct(e.data.subarray(t));return{key:e.type,info:n,data:i}}const t=ct(e.data.subarray(1));return{key:e.type,info:"",data:t}}(e)}function ms(e){const t=String.fromCharCode(e[0],e[1],e[2],e[3]),n=is(e,4);return{type:t,size:n,data:e.subarray(10,10+n)}}function vs(e){let t=0;const n=[];for(;ns(e,t);){const i=is(e,t+6);e[t+5]>>6&1&&(t+=10),t+=10;const r=t+i;for(;t+10<r;){const i=ms(e.subarray(t)),r=gs(i);r&&n.push(r),t+=i.size+10}ts(e,t)&&(t+=10)}return n}function ys(e){return e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info}function bs(e){if(8===e.data.byteLength){const t=new Uint8Array(e.data),n=1&t[3];let i=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return i/=45,n&&(i+=47721858.84),Math.round(i)}}function Es(e){const t=vs(e);for(let e=0;e<t.length;e++){const n=t[e];if(ys(n))return bs(n)}}let Ss=function(e){return e.audioId3="org.id3",e.dateRange="com.apple.quicktime.HLS",e.emsg="https://aomedia.org/emsg/ID3",e.misbklv="urn:misb:KLV:bin:1910.1",e}({});function ws(e="",t=9e4){return{type:e,id:-1,pid:-1,inputTimeScale:t,sequenceNumber:-1,samples:[],dropped:0}}class Ts{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,n,i){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,n){}demux(e,t){this.cachedData&&(e=Wt(this.cachedData,e),this.cachedData=null);let n,i=rs(e,0),r=i?i.length:0;const s=this._audioTrack,a=this._id3Track,o=i?Es(i):void 0,l=e.length;for((null===this.basePTS||0===this.frameIndex&&Ne(o))&&(this.basePTS=ks(o,t,this.initPTS),this.lastPTS=this.basePTS),null===this.lastPTS&&(this.lastPTS=this.basePTS),i&&i.length>0&&a.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:Ss.audioId3,duration:Number.POSITIVE_INFINITY});r<l;){if(this.canParse(e,r)){const t=this.appendFrame(s,e,r);t?(this.frameIndex++,this.lastPTS=t.sample.pts,r+=t.length,n=r):r=l}else fs(e,r)?(i=rs(e,r),a.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:Ss.audioId3,duration:Number.POSITIVE_INFINITY}),r+=i.length,n=r):r++;if(r===l&&n!==l){const t=e.slice(n);this.cachedData?this.cachedData=Wt(this.cachedData,t):this.cachedData=t}}return{audioTrack:s,videoTrack:ws(),id3Track:a,textTrack:ws()}}demuxSampleAes(e,t,n){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:ws(),id3Track:this._id3Track,textTrack:ws()}}destroy(){this.cachedData=null,this._audioTrack=this._id3Track=void 0}}const ks=(e,t,n)=>Ne(e)?90*e:9e4*t+(n?9e4*n.baseTime/n.timescale:0);let _s=null;const xs=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],Ls=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],As=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],Rs=[0,1,1,4];function Is(e,t,n,i,r){if(n+24>t.length)return;const s=Cs(t,n);if(s&&n+s.frameLength<=t.length){const a=i+r*(9e4*s.samplesPerFrame/s.sampleRate),o={unit:t.subarray(n,n+s.frameLength),pts:a,dts:a};return e.config=[],e.channelCount=s.channelCount,e.samplerate=s.sampleRate,e.samples.push(o),{sample:o,length:s.frameLength,missing:0}}}function Cs(e,t){const n=e[t+1]>>3&3,i=e[t+1]>>1&3,r=e[t+2]>>4&15,s=e[t+2]>>2&3;if(1!==n&&0!==r&&15!==r&&3!==s){const a=e[t+2]>>1&1,o=e[t+3]>>6,l=1e3*xs[14*(3===n?3-i:3===i?3:4)+r-1],c=Ls[3*(3===n?0:2===n?1:2)+s],u=3===o?1:2,h=As[n][i],d=Rs[i],f=8*h*d,p=Math.floor(h*l/c+a)*d;if(null===_s){const e=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);_s=e?parseInt(e[1]):0}return!!_s&&_s<=87&&2===i&&l>=224e3&&0===o&&(e[t+3]=128|e[t+3]),{sampleRate:c,channelCount:u,frameLength:p,samplesPerFrame:f}}}function Ds(e,t){return!(255!==e[t]||224&~e[t+1]||!(6&e[t+1]))}function Ps(e,t){return t+1<e.length&&Ds(e,t)}function Os(e,t){if(t+1<e.length&&Ds(e,t)){const n=4,i=Cs(e,t);let r=n;null!=i&&i.frameLength&&(r=i.frameLength);const s=t+r;return s===e.length||Ps(e,s)}return!1}const Ns=(e,t)=>{let n=0,i=5;t+=i;const r=new Uint32Array(1),s=new Uint32Array(1),a=new Uint8Array(1);for(;i>0;){a[0]=e[t];const o=Math.min(i,8),l=8-o;s[0]=4278190080>>>24+l<<l,r[0]=(a[0]&s[0])>>l,n=n?n<<o|r[0]:r[0],t+=1,i-=o}return n};function Ms(e,t,n,i,r){if(n+8>t.length)return-1;if(11!==t[n]||119!==t[n+1])return-1;const s=t[n+4]>>6;if(s>=3)return-1;const a=[48e3,44100,32e3][s],o=63&t[n+4],l=2*[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][3*o+s];if(n+l>t.length)return-1;const c=t[n+6]>>5;let u=0;2===c?u+=2:(1&c&&1!==c&&(u+=2),4&c&&(u+=2));const h=(t[n+6]<<8|t[n+7])>>12-u&1,d=[2,1,2,3,3,4,4,5][c]+h,f=t[n+5]>>3,p=7&t[n+5],g=new Uint8Array([s<<6|f<<1|p>>2,(3&p)<<6|c<<3|h<<2|o>>4,o<<4&224]),m=i+r*(1536/a*9e4),v=t.subarray(n,n+l);return e.config=g,e.channelCount=d,e.samplerate=a,e.samples.push({unit:v,pts:m}),l}const Fs=/\/emsg[-/]ID3/i;function Bs(e,t){return Ne(e.presentationTime)?e.presentationTime/e.timeScale:t+e.presentationTimeDelta/e.timeScale}class Us{constructor(e,t,n){this.keyData=void 0,this.decrypter=void 0,this.keyData=n,this.decrypter=new ui(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer,0)}decryptAacSample(e,t,n){const i=e[t].unit;if(i.length<=16)return;const r=i.subarray(16,i.length-i.length%16),s=r.buffer.slice(r.byteOffset,r.byteOffset+r.length);this.decryptBuffer(s).then(r=>{const s=new Uint8Array(r);i.set(s,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,n)}).catch(n)}decryptAacSamples(e,t,n){for(;;t++){if(t>=e.length)return void n();if(!(e[t].unit.length<32||(this.decryptAacSample(e,t,n),this.decrypter.isSync())))return}}getAvcEncryptedData(e){const t=16*Math.floor((e.length-48)/160)+16,n=new Int8Array(t);let i=0;for(let t=32;t<e.length-16;t+=160,i+=16)n.set(e.subarray(t,t+16),i);return n}getAvcDecryptedUnit(e,t){const n=new Uint8Array(t);let i=0;for(let t=32;t<e.length-16;t+=160,i+=16)e.set(n.subarray(i,i+16),t);return e}decryptAvcSample(e,t,n,i,r){const s=Zt(r.data),a=this.getAvcEncryptedData(s);this.decryptBuffer(a.buffer).then(a=>{r.data=this.getAvcDecryptedUnit(s,a),this.decrypter.isSync()||this.decryptAvcSamples(e,t,n+1,i)}).catch(i)}decryptAvcSamples(e,t,n,i){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,n=0){if(t>=e.length)return void i();const r=e[t].units;for(;!(n>=r.length);n++){const s=r[n];if(!(s.data.length<=48||1!==s.type&&5!==s.type||(this.decryptAvcSample(e,t,n,i,s),this.decrypter.isSync())))return}}}}class $s{constructor(){this.VideoSample=null}createVideoSample(e,t,n){return{key:e,frame:!1,pts:t,dts:n,units:[],length:0}}getLastNalUnit(e){var t;let n,i=this.VideoSample;if(i&&0!==i.units.length||(i=e[e.length-1]),null!=(t=i)&&t.units){const e=i.units;n=e[e.length-1]}return n}pushAccessUnit(e,t){if(e.units.length&&e.frame){if(void 0===e.pts){const n=t.samples,i=n.length;if(!i)return void t.dropped++;{const t=n[i-1];e.pts=t.pts,e.dts=t.dts}}t.samples.push(e)}}parseNALu(e,t,n){const i=t.byteLength;let r=e.naluState||0;const s=r,a=[];let o,l,c,u=0,h=-1,d=0;for(-1===r&&(h=0,d=this.getNALuType(t,0),r=0,u=1);u<i;)if(o=t[u++],r)if(1!==r)if(o)if(1===o){if(l=u-r-1,h>=0){const e={data:t.subarray(h,l),type:d};a.push(e)}else{const n=this.getLastNalUnit(e.samples);n&&(s&&u<=4-s&&n.state&&(n.data=n.data.subarray(0,n.data.byteLength-s)),l>0&&(n.data=Wt(n.data,t.subarray(0,l)),n.state=0))}u<i?(c=this.getNALuType(t,u),h=u,d=c,r=0):r=-1}else r=0;else r=3;else r=o?0:2;else r=o?0:1;if(h>=0&&r>=0){const e={data:t.subarray(h,i),type:d,state:r};a.push(e)}if(0===a.length){const n=this.getLastNalUnit(e.samples);n&&(n.data=Wt(n.data,t))}return e.naluState=r,a}}class js{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,n=e.byteLength-t,i=new Uint8Array(4),r=Math.min(4,t);if(0===r)throw new Error("no bytes available");i.set(e.subarray(n,n+r)),this.word=new DataView(i.buffer).getUint32(0),this.bitsAvailable=8*r,this.bytesAvailable-=r}skipBits(e){let t;e=Math.min(e,8*this.bytesAvailable+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(t=(e-=this.bitsAvailable)>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const n=this.word>>>32-t;if(e>32&&at.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else{if(!(this.bytesAvailable>0))throw new Error("no bits available");this.loadWord()}return t=e-t,t>0&&this.bitsAvailable?n<<t|this.readBits(t):n}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if(this.word&2147483648>>>e)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return 1===this.readBits(1)}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}}class zs extends $s{parsePES(e,t,n,i){const r=this.parseNALu(e,n.data,i);let s,a=this.VideoSample,o=!1;n.data=null,a&&r.length&&!e.audFound&&(this.pushAccessUnit(a,e),a=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts)),r.forEach(i=>{var r,l;switch(i.type){case 1:{let t=!1;s=!0;const r=i.data;if(o&&r.length>4){const e=this.readSliceType(r);2!==e&&4!==e&&7!==e&&9!==e||(t=!0)}var c;t&&null!=(c=a)&&c.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null),a||(a=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),a.frame=!0,a.key=t;break}case 5:s=!0,null!=(r=a)&&r.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null),a||(a=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),a.key=!0,a.frame=!0;break;case 6:s=!0,Qt(i.data,1,n.pts,t.samples);break;case 7:{var u,h;s=!0,o=!0;const t=i.data,n=this.readSPS(t);if(!e.sps||e.width!==n.width||e.height!==n.height||(null==(u=e.pixelRatio)?void 0:u[0])!==n.pixelRatio[0]||(null==(h=e.pixelRatio)?void 0:h[1])!==n.pixelRatio[1]){e.width=n.width,e.height=n.height,e.pixelRatio=n.pixelRatio,e.sps=[t];const i=t.subarray(1,4);let r="avc1.";for(let e=0;e<3;e++){let t=i[e].toString(16);t.length<2&&(t="0"+t),r+=t}e.codec=r}break}case 8:s=!0,e.pps=[i.data];break;case 9:s=!0,e.audFound=!0,null!=(l=a)&&l.frame&&(this.pushAccessUnit(a,e),a=null),a||(a=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts));break;case 12:s=!0;break;default:s=!1}a&&s&&a.units.push(i)}),i&&a&&(this.pushAccessUnit(a,e),this.VideoSample=null)}getNALuType(e,t){return 31&e[t]}readSliceType(e){const t=new js(e);return t.readUByte(),t.readUEG(),t.readUEG()}skipScalingList(e,t){let n,i=8,r=8;for(let s=0;s<e;s++)0!==r&&(n=t.readEG(),r=(i+n+256)%256),i=0===r?i:r}readSPS(e){const t=new js(e);let n,i,r,s=0,a=0,o=0,l=0;const c=t.readUByte.bind(t),u=t.readBits.bind(t),h=t.readUEG.bind(t),d=t.readBoolean.bind(t),f=t.skipBits.bind(t),p=t.skipEG.bind(t),g=t.skipUEG.bind(t),m=this.skipScalingList.bind(this);c();const v=c();if(u(5),f(3),c(),g(),100===v||110===v||122===v||244===v||44===v||83===v||86===v||118===v||128===v){const e=h();if(3===e&&f(1),g(),g(),f(1),d())for(i=3!==e?8:12,r=0;r<i;r++)d()&&m(r<6?16:64,t)}g();const y=h();if(0===y)h();else if(1===y)for(f(1),p(),p(),n=h(),r=0;r<n;r++)p();g(),f(1);const b=h(),E=h(),S=u(1);0===S&&f(1),f(1),d()&&(s=h(),a=h(),o=h(),l=h());let w=[1,1];if(d()&&d())switch(c()){case 1:w=[1,1];break;case 2:w=[12,11];break;case 3:w=[10,11];break;case 4:w=[16,11];break;case 5:w=[40,33];break;case 6:w=[24,11];break;case 7:w=[20,11];break;case 8:w=[32,11];break;case 9:w=[80,33];break;case 10:w=[18,11];break;case 11:w=[15,11];break;case 12:w=[64,33];break;case 13:w=[160,99];break;case 14:w=[4,3];break;case 15:w=[3,2];break;case 16:w=[2,1];break;case 255:w=[c()<<8|c(),c()<<8|c()]}return{width:Math.ceil(16*(b+1)-2*s-2*a),height:(2-S)*(E+1)*16-(S?2:4)*(o+l),pixelRatio:w}}}class Gs extends $s{constructor(...e){super(...e),this.initVPS=null}parsePES(e,t,n,i){const r=this.parseNALu(e,n.data,i);let s,a=this.VideoSample,o=!1;n.data=null,a&&r.length&&!e.audFound&&(this.pushAccessUnit(a,e),a=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts)),r.forEach(i=>{var r,l;switch(i.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:a||(a=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts)),a.frame=!0,s=!0;break;case 16:case 17:case 18:case 21:var c;s=!0,o&&null!=(c=a)&&c.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null),a||(a=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),a.key=!0,a.frame=!0;break;case 19:case 20:s=!0,null!=(r=a)&&r.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null),a||(a=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),a.key=!0,a.frame=!0;break;case 39:s=!0,Qt(i.data,2,n.pts,t.samples);break;case 32:s=!0,e.vps||("object"!=typeof e.params&&(e.params={}),e.params=Qe(e.params,this.readVPS(i.data)),this.initVPS=i.data),e.vps=[i.data];break;case 33:if(s=!0,o=!0,void 0===e.vps||e.vps[0]===this.initVPS||void 0===e.sps||this.matchSPS(e.sps[0],i.data)||(this.initVPS=e.vps[0],e.sps=e.pps=void 0),!e.sps){const t=this.readSPS(i.data);e.width=t.width,e.height=t.height,e.pixelRatio=t.pixelRatio,e.codec=t.codecString,e.sps=[],"object"!=typeof e.params&&(e.params={});for(const n in t.params)e.params[n]=t.params[n]}this.pushParameterSet(e.sps,i.data,e.vps),a||(a=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),a.key=!0;break;case 34:if(s=!0,"object"==typeof e.params){if(!e.pps){e.pps=[];const t=this.readPPS(i.data);for(const n in t)e.params[n]=t[n]}this.pushParameterSet(e.pps,i.data,e.vps)}break;case 35:s=!0,e.audFound=!0,null!=(l=a)&&l.frame&&(this.pushAccessUnit(a,e),a=null),a||(a=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts));break;default:s=!1}a&&s&&a.units.push(i)}),i&&a&&(this.pushAccessUnit(a,e),this.VideoSample=null)}pushParameterSet(e,t,n){(n&&n[0]===this.initVPS||!n&&!e.length)&&e.push(t)}getNALuType(e,t){return(126&e[t])>>>1}ebsp2rbsp(e){const t=new Uint8Array(e.byteLength);let n=0;for(let i=0;i<e.byteLength;i++)i>=2&&3===e[i]&&0===e[i-1]&&0===e[i-2]||(t[n]=e[i],n++);return new Uint8Array(t.buffer,0,n)}pushAccessUnit(e,t){super.pushAccessUnit(e,t),this.initVPS&&(this.initVPS=null)}readVPS(e){const t=new js(e);return t.readUByte(),t.readUByte(),t.readBits(4),t.skipBits(2),t.readBits(6),{numTemporalLayers:t.readBits(3)+1,temporalIdNested:t.readBoolean()}}readSPS(e){const t=new js(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.readBits(4);const n=t.readBits(3);t.readBoolean();const i=t.readBits(2),r=t.readBoolean(),s=t.readBits(5),a=t.readUByte(),o=t.readUByte(),l=t.readUByte(),c=t.readUByte(),u=t.readUByte(),h=t.readUByte(),d=t.readUByte(),f=t.readUByte(),p=t.readUByte(),g=t.readUByte(),m=t.readUByte(),v=[],y=[];for(let e=0;e<n;e++)v.push(t.readBoolean()),y.push(t.readBoolean());if(n>0)for(let e=n;e<8;e++)t.readBits(2);for(let e=0;e<n;e++)v[e]&&(t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte()),y[e]&&t.readUByte();t.readUEG();const b=t.readUEG();3==b&&t.skipBits(1);const E=t.readUEG(),S=t.readUEG(),w=t.readBoolean();let T=0,k=0,_=0,x=0;w&&(T+=t.readUEG(),k+=t.readUEG(),_+=t.readUEG(),x+=t.readUEG());const L=t.readUEG(),A=t.readUEG(),R=t.readUEG();for(let e=t.readBoolean()?0:n;e<=n;e++)t.skipUEG(),t.skipUEG(),t.skipUEG();if(t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.readBoolean()&&t.readBoolean())for(let e=0;e<4;e++)for(let n=0;n<(3===e?2:6);n++)if(t.readBoolean()){const n=Math.min(64,1<<4+(e<<1));e>1&&t.readEG();for(let e=0;e<n;e++)t.readEG()}else t.readUEG();t.readBoolean(),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.skipUEG(),t.skipUEG(),t.readBoolean());const I=t.readUEG();let C=0;for(let e=0;e<I;e++){let n=!1;if(0!==e&&(n=t.readBoolean()),n){e===I&&t.readUEG(),t.readBoolean(),t.readUEG();let n=0;for(let e=0;e<=C;e++){const e=t.readBoolean();let i=!1;e||(i=t.readBoolean()),(e||i)&&n++}C=n}else{const e=t.readUEG(),n=t.readUEG();C=e+n;for(let n=0;n<e;n++)t.readUEG(),t.readBoolean();for(let e=0;e<n;e++)t.readUEG(),t.readBoolean()}}if(t.readBoolean()){const e=t.readUEG();for(let n=0;n<e;n++){for(let e=0;e<R+4;e++)t.readBits(1);t.readBits(1)}}let D=0,P=1,O=1,N=!0,M=1,F=0;t.readBoolean(),t.readBoolean();let B=!1;if(t.readBoolean()){if(t.readBoolean()){const e=t.readUByte();e>0&&e<16?(P=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][e-1],O=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][e-1]):255===e&&(P=t.readBits(16),O=t.readBits(16))}if(t.readBoolean()&&t.readBoolean(),t.readBoolean()&&(t.readBits(3),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.readUByte(),t.readUByte())),t.readBoolean()&&(t.readUEG(),t.readUEG()),t.readBoolean(),t.readBoolean(),t.readBoolean(),B=t.readBoolean(),B&&(t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG()),t.readBoolean()&&(M=t.readBits(32),F=t.readBits(32),t.readBoolean()&&t.readUEG(),t.readBoolean())){const e=t.readBoolean(),i=t.readBoolean();let r=!1;(e||i)&&(r=t.readBoolean(),r&&(t.readUByte(),t.readBits(5),t.readBoolean(),t.readBits(5)),t.readBits(4),t.readBits(4),r&&t.readBits(4),t.readBits(5),t.readBits(5),t.readBits(5));for(let s=0;s<=n;s++){N=t.readBoolean();let n=!1;N||t.readBoolean()?t.readEG():n=t.readBoolean();const s=n?1:t.readUEG()+1;if(e)for(let e=0;e<s;e++)t.readUEG(),t.readUEG(),r&&(t.readUEG(),t.readUEG()),t.skipBits(1);if(i)for(let e=0;e<s;e++)t.readUEG(),t.readUEG(),r&&(t.readUEG(),t.readUEG()),t.skipBits(1)}}t.readBoolean()&&(t.readBoolean(),t.readBoolean(),t.readBoolean(),D=t.readUEG())}let U=E,$=S;if(w){let e=1,t=1;1===b?e=t=2:2==b&&(e=2),U=E-e*k-e*T,$=S-t*x-t*_}const j=i?["A","B","C"][i]:"",z=a<<24|o<<16|l<<8|c;let G=0;for(let e=0;e<32;e++)G=(G|(z>>e&1)<<31-e)>>>0;let V=G.toString(16);return 1===s&&"2"===V&&(V="6"),{codecString:`hvc1.${j}${s}.${V}.${r?"H":"L"}${m}.B0`,params:{general_tier_flag:r,general_profile_idc:s,general_profile_space:i,general_profile_compatibility_flags:[a,o,l,c],general_constraint_indicator_flags:[u,h,d,f,p,g],general_level_idc:m,bit_depth:L+8,bit_depth_luma_minus8:L,bit_depth_chroma_minus8:A,min_spatial_segmentation_idc:D,chroma_format_idc:b,frame_rate:{fixed:N,fps:F/M}},width:U,height:$,pixelRatio:[P,O]}}readPPS(e){const t=new js(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.skipUEG(),t.skipUEG(),t.skipBits(2),t.skipBits(3),t.skipBits(2),t.skipUEG(),t.skipUEG(),t.skipEG(),t.skipBits(2),t.readBoolean()&&t.skipUEG(),t.skipEG(),t.skipEG(),t.skipBits(4);const n=t.readBoolean(),i=t.readBoolean();let r=1;return i&&n?r=0:i?r=3:n&&(r=2),{parallelismType:r}}matchSPS(e,t){return String.fromCharCode.apply(null,e).substr(3)===String.fromCharCode.apply(null,t).substr(3)}}const Vs=188;class qs{constructor(e,t,n,i){this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=t,this.typeSupported=n,this.logger=i,this.videoParser=null}static probe(e,t){const n=qs.syncOffset(e);return n>0&&t.warn(`MPEG2-TS detected but first sync word found @ offset ${n}`),-1!==n}static syncOffset(e){const t=e.length;let n=Math.min(940,t-Vs)+1,i=0;for(;i<n;){let r=!1,s=-1,a=0;for(let o=i;o<t;o+=Vs){if(71!==e[o]||t-o!==Vs&&71!==e[o+Vs]){if(a)return-1;break}if(a++,-1===s&&(s=o,0!==s&&(n=Math.min(s+18612,e.length-Vs)+1)),r||(r=0===Hs(e,o)),r&&a>1&&(0===s&&a>2||o+Vs>n))return s}i++}return-1}static createTrack(e,t){return{container:"video"===e||"audio"===e?"video/mp2t":void 0,type:e,id:Dt[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:"audio"===e?t:void 0}}resetInitSegment(e,t,n,i){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=qs.createTrack("video"),this._videoTrack.duration=i,this._audioTrack=qs.createTrack("audio",i),this._id3Track=qs.createTrack("id3"),this._txtTrack=qs.createTrack("text"),this._audioTrack.segmentCodec="aac",this.videoParser=null,this.aacOverFlow=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=n}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_videoTrack:t,_id3Track:n}=this;e&&(e.pesData=null),t&&(t.pesData=null),n&&(n.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,t,n=!1,i=!1){let r;n||(this.sampleAes=null);const s=this._videoTrack,a=this._audioTrack,o=this._id3Track,l=this._txtTrack;let c=s.pid,u=s.pesData,h=a.pid,d=o.pid,f=a.pesData,p=o.pesData,g=null,m=this.pmtParsed,v=this._pmtId,y=e.length;if(this.remainderData&&(y=(e=Wt(this.remainderData,e)).length,this.remainderData=null),y<Vs&&!i)return this.remainderData=e,{audioTrack:a,videoTrack:s,id3Track:o,textTrack:l};const b=Math.max(0,qs.syncOffset(e));y-=(y-b)%Vs,y<e.byteLength&&!i&&(this.remainderData=new Uint8Array(e.buffer,y,e.buffer.byteLength-y));let E=0;for(let t=b;t<y;t+=Vs)if(71===e[t]){const i=!!(64&e[t+1]),y=Hs(e,t);let E;if((48&e[t+3])>>4>1){if(E=t+5+e[t+4],E===t+Vs)continue}else E=t+4;switch(y){case c:i&&(u&&(r=Qs(u,this.logger))&&(this.readyVideoParser(s.segmentCodec),null!==this.videoParser&&this.videoParser.parsePES(s,l,r,!1)),u={data:[],size:0}),u&&(u.data.push(e.subarray(E,t+Vs)),u.size+=t+Vs-E);break;case h:if(i){if(f&&(r=Qs(f,this.logger)))switch(a.segmentCodec){case"aac":this.parseAACPES(a,r);break;case"mp3":this.parseMPEGPES(a,r);break;case"ac3":this.parseAC3PES(a,r)}f={data:[],size:0}}f&&(f.data.push(e.subarray(E,t+Vs)),f.size+=t+Vs-E);break;case d:i&&(p&&(r=Qs(p,this.logger))&&this.parseID3PES(o,r),p={data:[],size:0}),p&&(p.data.push(e.subarray(E,t+Vs)),p.size+=t+Vs-E);break;case 0:i&&(E+=e[E]+1),v=this._pmtId=Ws(e,E);break;case v:{i&&(E+=e[E]+1);const r=Ks(e,E,this.typeSupported,n,this.observer,this.logger);c=r.videoPid,c>0&&(s.pid=c,s.segmentCodec=r.segmentVideoCodec),h=r.audioPid,h>0&&(a.pid=h,a.segmentCodec=r.segmentAudioCodec),d=r.id3Pid,d>0&&(o.pid=d),null===g||m||(this.logger.warn(`MPEG-TS PMT found at ${t} after unknown PID '${g}'. Backtracking to sync byte @${b} to parse all TS packets.`),g=null,t=b-188),m=this.pmtParsed=!0;break}case 17:case 8191:break;default:g=y}}else E++;E>0&&Ys(this.observer,new Error(`Found ${E} TS packet/s that do not start with 0x47`),void 0,this.logger),s.pesData=u,a.pesData=f,o.pesData=p;const S={audioTrack:a,videoTrack:s,id3Track:o,textTrack:l};return i&&this.extractRemainingSamples(S),S}flush(){const{remainderData:e}=this;let t;return this.remainderData=null,t=e?this.demux(e,-1,!1,!0):{videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:n,id3Track:i,textTrack:r}=e,s=n.pesData,a=t.pesData,o=i.pesData;let l;if(s&&(l=Qs(s,this.logger))?(this.readyVideoParser(n.segmentCodec),null!==this.videoParser&&(this.videoParser.parsePES(n,r,l,!0),n.pesData=null)):n.pesData=s,a&&(l=Qs(a,this.logger))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,l);break;case"mp3":this.parseMPEGPES(t,l);break;case"ac3":this.parseAC3PES(t,l)}t.pesData=null}else null!=a&&a.size&&this.logger.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=a;o&&(l=Qs(o,this.logger))?(this.parseID3PES(i,l),i.pesData=null):i.pesData=o}demuxSampleAes(e,t,n){const i=this.demux(e,n,!0,!this.config.progressive),r=this.sampleAes=new Us(this.observer,this.config,t);return this.decrypt(i,r)}readyVideoParser(e){null===this.videoParser&&("avc"===e?this.videoParser=new zs:"hevc"===e&&(this.videoParser=new Gs))}decrypt(e,t){return new Promise(n=>{const{audioTrack:i,videoTrack:r}=e;i.samples&&"aac"===i.segmentCodec?t.decryptAacSamples(i.samples,0,()=>{r.samples?t.decryptAvcSamples(r.samples,0,0,()=>{n(e)}):n(e)}):r.samples&&t.decryptAvcSamples(r.samples,0,0,()=>{n(e)})})}destroy(){this.observer&&this.observer.removeAllListeners(),this.config=this.logger=this.observer=null,this.aacOverFlow=this.videoParser=this.remainderData=this.sampleAes=null,this._videoTrack=this._audioTrack=this._id3Track=this._txtTrack=void 0}parseAACPES(e,t){let n=0;const i=this.aacOverFlow;let r,s,a,o=t.data;if(i){this.aacOverFlow=null;const t=i.missing,r=i.sample.unit.byteLength;if(-1===t)o=Wt(i.sample.unit,o);else{const s=r-t;i.sample.unit.set(o.subarray(0,t),s),e.samples.push(i.sample),n=i.missing}}for(r=n,s=o.length;r<s-1&&!ls(o,r);r++);if(r!==n){let e;const t=r<s-1;if(e=t?`AAC PES did not start with ADTS header,offset:${r}`:"No ADTS header found in AAC PES",Ys(this.observer,new Error(e),t,this.logger),!t)return}if(us(e,this.observer,o,r,this.audioCodec),void 0!==t.pts)a=t.pts;else{if(!i)return void this.logger.warn("[tsdemuxer]: AAC PES unknown PTS");{const t=hs(e.samplerate);a=i.sample.pts+t}}let l,c=0;for(;r<s;){if(l=ds(e,o,r,a,c),r+=l.length,l.missing){this.aacOverFlow=l;break}for(c++;r<s-1&&!ls(o,r);r++);}}parseMPEGPES(e,t){const n=t.data,i=n.length;let r=0,s=0;const a=t.pts;if(void 0!==a)for(;s<i;)if(Ps(n,s)){const t=Is(e,n,s,a,r);if(!t)break;s+=t.length,r++}else s++;else this.logger.warn("[tsdemuxer]: MPEG PES unknown PTS")}parseAC3PES(e,t){{const n=t.data,i=t.pts;if(void 0===i)return void this.logger.warn("[tsdemuxer]: AC3 PES unknown PTS");const r=n.length;let s,a=0,o=0;for(;o<r&&(s=Ms(e,n,o,i,a++))>0;)o+=s}}parseID3PES(e,t){if(void 0===t.pts)return void this.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");const n=Qe({},t,{type:this._videoTrack?Ss.emsg:Ss.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(n)}}function Hs(e,t){return((31&e[t+1])<<8)+e[t+2]}function Ws(e,t){return(31&e[t+10])<<8|e[t+11]}function Ks(e,t,n,i,r,s){const a={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},o=t+3+((15&e[t+1])<<8|e[t+2])-4;for(t+=12+((15&e[t+10])<<8|e[t+11]);t<o;){const o=Hs(e,t),l=(15&e[t+3])<<8|e[t+4];switch(e[t]){case 207:if(!i){Xs("ADTS AAC",s);break}case 15:-1===a.audioPid&&(a.audioPid=o);break;case 21:-1===a.id3Pid&&(a.id3Pid=o);break;case 219:if(!i){Xs("H.264",s);break}case 27:-1===a.videoPid&&(a.videoPid=o);break;case 3:case 4:n.mpeg||n.mp3?-1===a.audioPid&&(a.audioPid=o,a.segmentAudioCodec="mp3"):s.log("MPEG audio found, not supported in this browser");break;case 193:if(!i){Xs("AC-3",s);break}case 129:n.ac3?-1===a.audioPid&&(a.audioPid=o,a.segmentAudioCodec="ac3"):s.log("AC-3 audio found, not supported in this browser");break;case 6:if(-1===a.audioPid&&l>0){let i=t+5,r=l;for(;r>2;){106===e[i]&&(!0!==n.ac3?s.log("AC-3 audio found, not supported in this browser for now"):(a.audioPid=o,a.segmentAudioCodec="ac3"));const t=e[i+1]+2;i+=t,r-=t}}break;case 194:case 135:return Ys(r,new Error("Unsupported EC-3 in M2TS found"),void 0,s),a;case 36:-1===a.videoPid&&(a.videoPid=o,a.segmentVideoCodec="hevc",s.log("HEVC in M2TS found"))}t+=l+5}return a}function Ys(e,t,n,i){i.warn(`parsing error: ${t.message}`),e.emit($e.ERROR,$e.ERROR,{type:Be.MEDIA_ERROR,details:Ue.FRAG_PARSING_ERROR,fatal:!1,levelRetry:n,error:t,reason:t.message})}function Xs(e,t){t.log(`${e} with AES-128-CBC encryption found in unencrypted stream`)}function Qs(e,t){let n,i,r,s,a,o=0;const l=e.data;if(!e||0===e.size)return null;for(;l[0].length<19&&l.length>1;)l[0]=Wt(l[0],l[1]),l.splice(1,1);if(n=l[0],1===(n[0]<<16)+(n[1]<<8)+n[2]){if(i=(n[4]<<8)+n[5],i&&i>e.size-6)return null;const c=n[7];192&c&&(s=536870912*(14&n[9])+4194304*(255&n[10])+16384*(254&n[11])+128*(255&n[12])+(254&n[13])/2,64&c?(a=536870912*(14&n[14])+4194304*(255&n[15])+16384*(254&n[16])+128*(255&n[17])+(254&n[18])/2,s-a>54e5&&(t.warn(`${Math.round((s-a)/9e4)}s delta between PTS and DTS, align them`),s=a)):a=s),r=n[8];let u=r+9;if(e.size<=u)return null;e.size-=u;const h=new Uint8Array(e.size);for(let e=0,t=l.length;e<t;e++){n=l[e];let t=n.byteLength;if(u){if(u>t){u-=t;continue}n=n.subarray(u),t-=u,u=0}h.set(n,o),o+=t}return i&&(i-=r+3),{data:h,pts:s,dts:a,len:i}}return null}class Zs{static getSilentFrame(e,t){if("mp4a.40.2"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}}}const Js=Math.pow(2,32)-1;class ea{static init(){let e;for(e in ea.types={avc1:[],avcC:[],hvc1:[],hvcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},ea.types)ea.types.hasOwnProperty(e)&&(ea.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);ea.HDLR_TYPES={video:t,audio:n};const i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),r=new Uint8Array([0,0,0,0,0,0,0,0]);ea.STTS=ea.STSC=ea.STCO=r,ea.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),ea.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),ea.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),ea.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const s=new Uint8Array([105,115,111,109]),a=new Uint8Array([97,118,99,49]),o=new Uint8Array([0,0,0,1]);ea.FTYP=ea.box(ea.types.ftyp,s,o,s,a),ea.DINF=ea.box(ea.types.dinf,ea.box(ea.types.dref,i))}static box(e,...t){let n=8,i=t.length;const r=i;for(;i--;)n+=t[i].byteLength;const s=new Uint8Array(n);for(s[0]=n>>24&255,s[1]=n>>16&255,s[2]=n>>8&255,s[3]=255&n,s.set(e,4),i=0,n=8;i<r;i++)s.set(t[i],n),n+=t[i].byteLength;return s}static hdlr(e){return ea.box(ea.types.hdlr,ea.HDLR_TYPES[e])}static mdat(e){return ea.box(ea.types.mdat,e)}static mdhd(e,t){t*=e;const n=Math.floor(t/(Js+1)),i=Math.floor(t%(Js+1));return ea.box(ea.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,n>>24,n>>16&255,n>>8&255,255&n,i>>24,i>>16&255,i>>8&255,255&i,85,196,0,0]))}static mdia(e){return ea.box(ea.types.mdia,ea.mdhd(e.timescale||0,e.duration||0),ea.hdlr(e.type),ea.minf(e))}static mfhd(e){return ea.box(ea.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e]))}static minf(e){return"audio"===e.type?ea.box(ea.types.minf,ea.box(ea.types.smhd,ea.SMHD),ea.DINF,ea.stbl(e)):ea.box(ea.types.minf,ea.box(ea.types.vmhd,ea.VMHD),ea.DINF,ea.stbl(e))}static moof(e,t,n){return ea.box(ea.types.moof,ea.mfhd(e),ea.traf(n,t))}static moov(e){let t=e.length;const n=[];for(;t--;)n[t]=ea.trak(e[t]);return ea.box.apply(null,[ea.types.moov,ea.mvhd(e[0].timescale||0,e[0].duration||0)].concat(n).concat(ea.mvex(e)))}static mvex(e){let t=e.length;const n=[];for(;t--;)n[t]=ea.trex(e[t]);return ea.box.apply(null,[ea.types.mvex,...n])}static mvhd(e,t){t*=e;const n=Math.floor(t/(Js+1)),i=Math.floor(t%(Js+1)),r=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,n>>24,n>>16&255,n>>8&255,255&n,i>>24,i>>16&255,i>>8&255,255&i,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return ea.box(ea.types.mvhd,r)}static sdtp(e){const t=e.samples||[],n=new Uint8Array(4+t.length);let i,r;for(i=0;i<t.length;i++)r=t[i].flags,n[i+4]=r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy;return ea.box(ea.types.sdtp,n)}static stbl(e){return ea.box(ea.types.stbl,ea.stsd(e),ea.box(ea.types.stts,ea.STTS),ea.box(ea.types.stsc,ea.STSC),ea.box(ea.types.stsz,ea.STSZ),ea.box(ea.types.stco,ea.STCO))}static avc1(e){let t,n,i,r=[],s=[];for(t=0;t<e.sps.length;t++)n=e.sps[t],i=n.byteLength,r.push(i>>>8&255),r.push(255&i),r=r.concat(Array.prototype.slice.call(n));for(t=0;t<e.pps.length;t++)n=e.pps[t],i=n.byteLength,s.push(i>>>8&255),s.push(255&i),s=s.concat(Array.prototype.slice.call(n));const a=ea.box(ea.types.avcC,new Uint8Array([1,r[3],r[4],r[5],255,224|e.sps.length].concat(r).concat([e.pps.length]).concat(s))),o=e.width,l=e.height,c=e.pixelRatio[0],u=e.pixelRatio[1];return ea.box(ea.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,o>>8&255,255&o,l>>8&255,255&l,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),a,ea.box(ea.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),ea.box(ea.types.pasp,new Uint8Array([c>>24,c>>16&255,c>>8&255,255&c,u>>24,u>>16&255,u>>8&255,255&u])))}static esds(e){const t=e.config;return new Uint8Array([0,0,0,0,3,25,0,1,0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,...t,6,1,2])}static audioStsd(e){const t=e.samplerate||0;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount||0,0,16,0,0,0,0,t>>8&255,255&t,0,0])}static mp4a(e){return ea.box(ea.types.mp4a,ea.audioStsd(e),ea.box(ea.types.esds,ea.esds(e)))}static mp3(e){return ea.box(ea.types[".mp3"],ea.audioStsd(e))}static ac3(e){return ea.box(ea.types["ac-3"],ea.audioStsd(e),ea.box(ea.types.dac3,e.config))}static stsd(e){const{segmentCodec:t}=e;if("audio"===e.type){if("aac"===t)return ea.box(ea.types.stsd,ea.STSD,ea.mp4a(e));if("ac3"===t&&e.config)return ea.box(ea.types.stsd,ea.STSD,ea.ac3(e));if("mp3"===t&&"mp3"===e.codec)return ea.box(ea.types.stsd,ea.STSD,ea.mp3(e))}else{if(!e.pps||!e.sps)throw new Error("video track missing pps or sps");if("avc"===t)return ea.box(ea.types.stsd,ea.STSD,ea.avc1(e));if("hevc"===t&&e.vps)return ea.box(ea.types.stsd,ea.STSD,ea.hvc1(e))}throw new Error(`unsupported ${e.type} segment codec (${t}/${e.codec})`)}static tkhd(e){const t=e.id,n=(e.duration||0)*(e.timescale||0),i=e.width||0,r=e.height||0,s=Math.floor(n/(Js+1)),a=Math.floor(n%(Js+1));return ea.box(ea.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,0,0,0,0,s>>24,s>>16&255,s>>8&255,255&s,a>>24,a>>16&255,a>>8&255,255&a,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>8&255,255&i,0,0,r>>8&255,255&r,0,0]))}static traf(e,t){const n=ea.sdtp(e),i=e.id,r=Math.floor(t/(Js+1)),s=Math.floor(t%(Js+1));return ea.box(ea.types.traf,ea.box(ea.types.tfhd,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i])),ea.box(ea.types.tfdt,new Uint8Array([1,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,s>>24,s>>16&255,s>>8&255,255&s])),ea.trun(e,n.length+16+20+8+16+8+8),n)}static trak(e){return e.duration=e.duration||4294967295,ea.box(ea.types.trak,ea.tkhd(e),ea.mdia(e))}static trex(e){const t=e.id;return ea.box(ea.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const n=e.samples||[],i=n.length,r=12+16*i,s=new Uint8Array(r);let a,o,l,c,u,h;for(t+=8+r,s.set(["video"===e.type?1:0,0,15,1,i>>>24&255,i>>>16&255,i>>>8&255,255&i,t>>>24&255,t>>>16&255,t>>>8&255,255&t],0),a=0;a<i;a++)o=n[a],l=o.duration,c=o.size,u=o.flags,h=o.cts,s.set([l>>>24&255,l>>>16&255,l>>>8&255,255&l,c>>>24&255,c>>>16&255,c>>>8&255,255&c,u.isLeading<<2|u.dependsOn,u.isDependedOn<<6|u.hasRedundancy<<4|u.paddingValue<<1|u.isNonSync,61440&u.degradPrio,15&u.degradPrio,h>>>24&255,h>>>16&255,h>>>8&255,255&h],12+16*a);return ea.box(ea.types.trun,s)}static initSegment(e){ea.types||ea.init();const t=ea.moov(e);return Wt(ea.FTYP,t)}static hvc1(e){const t=e.params,n=[e.vps,e.sps,e.pps],i=new Uint8Array([1,t.general_profile_space<<6|(t.general_tier_flag?32:0)|t.general_profile_idc,t.general_profile_compatibility_flags[0],t.general_profile_compatibility_flags[1],t.general_profile_compatibility_flags[2],t.general_profile_compatibility_flags[3],t.general_constraint_indicator_flags[0],t.general_constraint_indicator_flags[1],t.general_constraint_indicator_flags[2],t.general_constraint_indicator_flags[3],t.general_constraint_indicator_flags[4],t.general_constraint_indicator_flags[5],t.general_level_idc,240|t.min_spatial_segmentation_idc>>8,255&t.min_spatial_segmentation_idc,252|t.parallelismType,252|t.chroma_format_idc,248|t.bit_depth_luma_minus8,248|t.bit_depth_chroma_minus8,0,parseInt(t.frame_rate.fps),3|t.temporal_id_nested<<2|t.num_temporal_layers<<3|(t.frame_rate.fixed?64:0),n.length]);let r=i.length;for(let e=0;e<n.length;e+=1){r+=3;for(let t=0;t<n[e].length;t+=1)r+=2+n[e][t].length}const s=new Uint8Array(r);s.set(i,0),r=i.length;const a=n.length-1;for(let e=0;e<n.length;e+=1){s.set(new Uint8Array([32+e|(e===a?128:0),0,n[e].length]),r),r+=3;for(let t=0;t<n[e].length;t+=1)s.set(new Uint8Array([n[e][t].length>>8,255&n[e][t].length]),r),r+=2,s.set(n[e][t],r),r+=n[e][t].length}const o=ea.box(ea.types.hvcC,s),l=e.width,c=e.height,u=e.pixelRatio[0],h=e.pixelRatio[1];return ea.box(ea.types.hvc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,255&l,c>>8&255,255&c,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),o,ea.box(ea.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),ea.box(ea.types.pasp,new Uint8Array([u>>24,u>>16&255,u>>8&255,255&u,h>>24,h>>16&255,h>>8&255,255&h])))}}function ta(e,t,n=1,i=!1){const r=e*t*n;return i?Math.round(r):r}function na(e,t=!1){return ta(e,1e3,1/9e4,t)}ea.types=void 0,ea.HDLR_TYPES=void 0,ea.STTS=void 0,ea.STSC=void 0,ea.STCO=void 0,ea.STSZ=void 0,ea.VMHD=void 0,ea.SMHD=void 0,ea.STSD=void 0,ea.FTYP=void 0,ea.DINF=void 0;let ia,ra=null,sa=null;function aa(e,t,n,i){return{duration:t,size:n,cts:i,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:e?2:1,isNonSync:e?0:1}}}class oa extends et{constructor(e,t,n,i){if(super("mp4-remuxer",i),this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextVideoTs=null,this.nextAudioTs=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=t,this.typeSupported=n,this.ISGenerated=!1,null===ra){const e=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);ra=e?parseInt(e[1]):0}if(null===sa){const e=navigator.userAgent.match(/Safari\/(\d+)/i);sa=e?parseInt(e[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){this.log("initPTS & initDTS reset"),this._initPTS=this._initDTS=e}resetNextTimestamp(){this.log("reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){this.log("ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let t=!1;const n=e[0].pts,i=e.reduce((e,i)=>{let r=i.pts,s=r-e;return s<-4294967296&&(t=!0,r=la(r,n),s=r-e),s>0?e:r},n);return t&&this.debug("PTS rollover detected"),i}remux(e,t,n,i,r,s,a,o){let l,c,u,h,d,f,p=r,g=r;const m=e.pid>-1,v=t.pid>-1,y=t.samples.length,b=e.samples.length>0,E=a&&y>0||y>1;if((!m||b)&&(!v||E)||this.ISGenerated||a){if(this.ISGenerated){var S,w,T,k;const e=this.videoTrackConfig;(e&&(t.width!==e.width||t.height!==e.height||(null==(S=t.pixelRatio)?void 0:S[0])!==(null==(w=e.pixelRatio)?void 0:w[0])||(null==(T=t.pixelRatio)?void 0:T[1])!==(null==(k=e.pixelRatio)?void 0:k[1]))||!e&&E||null===this.nextAudioTs&&b)&&this.resetInitSegment()}this.ISGenerated||(u=this.generateIS(e,t,r,s));const n=this.isVideoContiguous;let i,a=-1;if(E&&(a=function(e){for(let t=0;t<e.length;t++)if(e[t].key)return t;return-1}(t.samples),!n&&this.config.forceKeyFrameOnDiscontinuity))if(f=!0,a>0){this.warn(`Dropped ${a} out of ${y} video samples due to a missing keyframe`);const e=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(a),t.dropped+=a,g+=(t.samples[0].pts-e)/t.inputTimeScale,i=g}else-1===a&&(this.warn(`No keyframe found out of ${y} video samples`),f=!1);if(this.ISGenerated){if(b&&E){const n=this.getVideoStartPts(t.samples),i=(la(e.samples[0].pts,n)-n)/t.inputTimeScale;p+=Math.max(0,i),g+=Math.max(0,-i)}if(b){if(e.samplerate||(this.warn("regenerate InitSegment as audio detected"),u=this.generateIS(e,t,r,s)),c=this.remuxAudio(e,p,this.isAudioContiguous,s,v||E||o===He?g:void 0),E){const i=c?c.endPTS-c.startPTS:0;t.inputTimeScale||(this.warn("regenerate InitSegment as video detected"),u=this.generateIS(e,t,r,s)),l=this.remuxVideo(t,g,n,i)}}else E&&(l=this.remuxVideo(t,g,n,0));l&&(l.firstKeyFrame=a,l.independent=-1!==a,l.firstKeyFramePTS=i)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(n.samples.length&&(d=ca(n,r,this._initPTS,this._initDTS)),i.samples.length&&(h=ua(i,r,this._initPTS))),{audio:c,video:l,initSegment:u,independent:f,text:h,id3:d}}generateIS(e,t,n,i){const r=e.samples,s=t.samples,a=this.typeSupported,o={},l=this._initPTS;let c,u,h,d=!l||i,f="audio/mp4",p=-1;if(d&&(c=u=1/0),e.config&&r.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":a.mpeg?(f="audio/mpeg",e.codec=""):a.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3"}o.audio={id:"audio",container:f,codec:e.codec,initSegment:"mp3"===e.segmentCodec&&a.mpeg?new Uint8Array(0):ea.initSegment([e]),metadata:{channelCount:e.channelCount}},d&&(p=e.id,h=e.inputTimeScale,l&&h===l.timescale?d=!1:c=u=r[0].pts-Math.round(h*n))}if(t.sps&&t.pps&&s.length){if(t.timescale=t.inputTimeScale,o.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:ea.initSegment([t]),metadata:{width:t.width,height:t.height}},d)if(p=t.id,h=t.inputTimeScale,l&&h===l.timescale)d=!1;else{const e=this.getVideoStartPts(s),t=Math.round(h*n);u=Math.min(u,la(s[0].dts,e)-t),c=Math.min(c,e-t)}this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio}}if(Object.keys(o).length)return this.ISGenerated=!0,d?(l&&this.warn(`Timestamps at playlist time: ${i?"":"~"}${n} ${c/h} != initPTS: ${l.baseTime/l.timescale} (${l.baseTime}/${l.timescale}) trackId: ${l.trackId}`),this.log(`Found initPTS at playlist time: ${n} offset: ${c/h} (${c}/${h}) trackId: ${p}`),this._initPTS={baseTime:c,timescale:h,trackId:p},this._initDTS={baseTime:u,timescale:h,trackId:p}):c=h=void 0,{tracks:o,initPTS:c,timescale:h,trackId:p}}remuxVideo(e,t,n,i){const r=e.inputTimeScale,s=e.samples,a=[],o=s.length,l=this._initPTS,c=l.baseTime*r/l.timescale;let u,h,d=this.nextVideoTs,f=8,p=this.videoSampleDuration,g=Number.POSITIVE_INFINITY,m=Number.NEGATIVE_INFINITY,v=!1;if(!n||null===d){const e=c+t*r,i=s[0].pts-la(s[0].dts,s[0].pts);ra&&null!==d&&Math.abs(e-i-(d+c))<15e3?n=!0:d=e-i-c}const y=d+c;for(let e=0;e<o;e++){const t=s[e];t.pts=la(t.pts,y),t.dts=la(t.dts,y),t.dts<s[e>0?e-1:e].dts&&(v=!0)}v&&s.sort(function(e,t){const n=e.dts-t.dts,i=e.pts-t.pts;return n||i}),u=s[0].dts,h=s[s.length-1].dts;const b=h-u,E=b?Math.round(b/(o-1)):p||e.inputTimeScale/30;if(n){const n=u-y,i=n>E,r=n<-1;if((i||r)&&(i?this.warn(`${(e.segmentCodec||"").toUpperCase()}: ${na(n,!0)} ms (${n}dts) hole between fragments detected at ${t.toFixed(3)}`):this.warn(`${(e.segmentCodec||"").toUpperCase()}: ${na(-n,!0)} ms (${n}dts) overlapping between fragments detected at ${t.toFixed(3)}`),!r||y>=s[0].pts||ra)){u=y;const e=s[0].pts-n;if(i)s[0].dts=u,s[0].pts=e;else{let t=!0;for(let i=0;i<s.length&&!(s[i].dts>e&&t);i++){const e=s[i].pts;if(s[i].dts-=n,s[i].pts-=n,i<s.length-1){const n=s[i+1].pts;t=n<=s[i].pts==n<=e}}}this.log(`Video: Initial PTS/DTS adjusted: ${na(e,!0)}/${na(u,!0)}, delta: ${na(n,!0)} ms`)}}u=Math.max(0,u);let S=0,w=0,T=u;for(let e=0;e<o;e++){const t=s[e],n=t.units,i=n.length;let r=0;for(let e=0;e<i;e++)r+=n[e].data.length;w+=r,S+=i,t.length=r,t.dts<T?(t.dts=T,T+=E/4|0||1):T=t.dts,g=Math.min(t.pts,g),m=Math.max(t.pts,m)}h=s[o-1].dts;const k=w+4*S+8;let _;try{_=new Uint8Array(k)}catch(e){return void this.observer.emit($e.ERROR,$e.ERROR,{type:Be.MUX_ERROR,details:Ue.REMUX_ALLOC_ERROR,fatal:!1,error:e,bytes:k,reason:`fail allocating video mdat ${k}`})}const x=new DataView(_.buffer);x.setUint32(0,k),_.set(ea.types.mdat,4);let L=!1,A=Number.POSITIVE_INFINITY,R=Number.POSITIVE_INFINITY,I=Number.NEGATIVE_INFINITY,C=Number.NEGATIVE_INFINITY;for(let e=0;e<o;e++){const t=s[e],n=t.units;let l,u=0;for(let e=0,t=n.length;e<t;e++){const t=n[e],i=t.data,r=t.data.byteLength;x.setUint32(f,r),f+=4,_.set(i,f),f+=r,u+=4+r}if(e<o-1)p=s[e+1].dts-t.dts,l=s[e+1].pts-t.pts;else{const n=this.config,a=e>0?t.dts-s[e-1].dts:E;if(l=e>0?t.pts-s[e-1].pts:E,n.stretchShortVideoTrack&&null!==this.nextAudioTs){const e=Math.floor(n.maxBufferHole*r),s=(i?g+i*r:this.nextAudioTs+c)-t.pts;s>e?(p=s-a,p<0?p=a:L=!0,this.log(`It is approximately ${s/90} ms to the next segment; using duration ${p/90} ms for the last video frame.`)):p=a}else p=a}const h=Math.round(t.pts-t.dts);A=Math.min(A,p),I=Math.max(I,p),R=Math.min(R,l),C=Math.max(C,l),a.push(aa(t.key,p,u,h))}if(a.length)if(ra){if(ra<70){const e=a[0].flags;e.dependsOn=2,e.isNonSync=0}}else if(sa&&C-R<I-A&&E/I<.025&&0===a[0].cts){this.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let e=u;for(let t=0,n=a.length;t<n;t++){const i=e+a[t].duration,r=e+a[t].cts;if(t<n-1){const e=i+a[t+1].cts;a[t].duration=e-r}else a[t].duration=t?a[t-1].duration:E;a[t].cts=0,e=i}}p=L||!p?E:p;const D=h+p;this.nextVideoTs=d=D-c,this.videoSampleDuration=p,this.isVideoContiguous=!0;const P={data1:ea.moof(e.sequenceNumber++,u,Qe(e,{samples:a})),data2:_,startPTS:(g-c)/r,endPTS:(m+p-c)/r,startDTS:(u-c)/r,endDTS:d/r,type:"video",hasAudio:!1,hasVideo:!0,nb:a.length,dropped:e.dropped};return e.samples=[],e.dropped=0,P}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return 1152;case"ac3":return 1536;default:return 1024}}remuxAudio(e,t,n,i,r){const s=e.inputTimeScale,a=s/(e.samplerate?e.samplerate:s),o=this.getSamplesPerFrame(e),l=o*a,c=this._initPTS,u="mp3"===e.segmentCodec&&this.typeSupported.mpeg,h=[],d=void 0!==r;let f=e.samples,p=u?0:8,g=this.nextAudioTs||-1;const m=c.baseTime*s/c.timescale,v=m+t*s;if(this.isAudioContiguous=n=n||f.length&&g>0&&(i&&Math.abs(v-(g+m))<9e3||Math.abs(la(f[0].pts,v)-(g+m))<20*l),f.forEach(function(e){e.pts=la(e.pts,v)}),!n||g<0){if(f=f.filter(e=>e.pts>=0),!f.length)return;g=0===r?0:i&&!d?Math.max(0,v-m):f[0].pts-m}if("aac"===e.segmentCodec){const t=this.config.maxAudioFramesDrift;for(let n=0,i=g+m;n<f.length;n++){const r=f[n],a=r.pts,o=a-i,c=Math.abs(1e3*o/s);if(o<=-t*l&&d)0===n&&(this.warn(`Audio frame @ ${(a/s).toFixed(3)}s overlaps marker by ${Math.round(1e3*o/s)} ms.`),this.nextAudioTs=g=a-m,i=a);else if(o>=t*l&&c<1e4&&d){let t=Math.round(o/l);for(i=a-t*l;i<0&&t&&l;)t--,i+=l;0===n&&(this.nextAudioTs=g=i-m),this.warn(`Injecting ${t} audio frames @ ${((i-m)/s).toFixed(3)}s due to ${Math.round(1e3*o/s)} ms gap.`);for(let s=0;s<t;s++){let t=Zs.getSilentFrame(e.parsedCodec||e.manifestCodec||e.codec,e.channelCount);t||(this.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),t=r.unit.subarray()),f.splice(n,0,{unit:t,pts:i}),i+=l,n++}}r.pts=i,i+=l}}let y,b=null,E=null,S=0,w=f.length;for(;w--;)S+=f[w].unit.byteLength;for(let t=0,i=f.length;t<i;t++){const i=f[t],r=i.unit;let s=i.pts;if(null!==E)h[t-1].duration=Math.round((s-E)/a);else{if(n&&"aac"===e.segmentCodec&&(s=g+m),b=s,!(S>0))return;S+=p;try{y=new Uint8Array(S)}catch(e){return void this.observer.emit($e.ERROR,$e.ERROR,{type:Be.MUX_ERROR,details:Ue.REMUX_ALLOC_ERROR,fatal:!1,error:e,bytes:S,reason:`fail allocating audio mdat ${S}`})}u||(new DataView(y.buffer).setUint32(0,S),y.set(ea.types.mdat,4))}y.set(r,p);const l=r.byteLength;p+=l,h.push(aa(!0,o,l,0)),E=s}const T=h.length;if(!T)return;const k=h[h.length-1];g=E-m,this.nextAudioTs=g+a*k.duration;const _=u?new Uint8Array(0):ea.moof(e.sequenceNumber++,b/a,Qe({},e,{samples:h}));e.samples=[];const x=(b-m)/s,L=g/s,A={data1:_,data2:y,startPTS:x,endPTS:L,startDTS:x,endDTS:L,type:"audio",hasAudio:!0,hasVideo:!1,nb:T};return this.isAudioContiguous=!0,A}}function la(e,t){let n;if(null===t)return e;for(n=t<e?-8589934592:8589934592;Math.abs(e-t)>4294967296;)e+=n;return e}function ca(e,t,n,i){const r=e.samples.length;if(!r)return;const s=e.inputTimeScale;for(let a=0;a<r;a++){const r=e.samples[a];r.pts=la(r.pts-n.baseTime*s/n.timescale,t*s)/s,r.dts=la(r.dts-i.baseTime*s/i.timescale,t*s)/s}const a=e.samples;return e.samples=[],{samples:a}}function ua(e,t,n){const i=e.samples.length;if(!i)return;const r=e.inputTimeScale;for(let s=0;s<i;s++){const i=e.samples[s];i.pts=la(i.pts-n.baseTime*r/n.timescale,t*r)/r}e.samples.sort((e,t)=>e.pts-t.pts);const s=e.samples;return e.samples=[],{samples:s}}function ha(e,t,n=!1){return void 0!==(null==e?void 0:e.start)?(e.start+(n?e.duration:0))/e.timescale:t}function da(e,t,n){const i=e.codec;return i&&i.length>4?i:t===wt?"ec-3"===i||"ac-3"===i||"alac"===i?i:"fLaC"===i||"Opus"===i?hn(i,!1):(n.warn(`Unhandled audio codec "${i}" in mp4 MAP`),i||"mp4a"):(n.warn(`Unhandled video codec "${i}" in mp4 MAP`),i||"avc1")}try{ia=self.performance.now.bind(self.performance)}catch(e){ia=Date.now}const fa=[{demux:class{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,n,i){const r=this.videoTrack=ws("video",1),s=this.audioTrack=ws("audio",1),a=this.txtTrack=ws("text",1);if(this.id3Track=ws("id3",1),this.timeOffset=0,null==e||!e.byteLength)return;const o=$t(e);if(o.video){const{id:e,timescale:t,codec:n,supplemental:i}=o.video;r.id=e,r.timescale=a.timescale=t,r.codec=n,r.supplemental=i}if(o.audio){const{id:e,timescale:t,codec:n}=o.audio;s.id=e,s.timescale=t,s.codec=n}a.id=Dt.text,r.sampleDuration=0,r.duration=s.duration=i}resetContiguity(){this.remainderData=null}static probe(e){return function(e){const t=e.byteLength;for(let n=0;n<t;){const i=Nt(e,n);if(i>8&&109===e[n+4]&&111===e[n+5]&&111===e[n+6]&&102===e[n+7])return!0;n=i>1?n+i:t}return!1}(e)}demux(e,t){this.timeOffset=t;let n=e;const i=this.videoTrack,r=this.txtTrack;if(this.config.progressive){this.remainderData&&(n=Wt(this.remainderData,e));const t=function(e){const t={valid:null,remainder:null},n=Bt(e,["moof"]);if(n.length<2)return t.remainder=e,t;const i=n[n.length-1];return t.valid=e.slice(0,i.byteOffset-8),t.remainder=e.slice(i.byteOffset-8),t}(n);this.remainderData=t.remainder,i.samples=t.valid||new Uint8Array}else i.samples=n;const s=this.extractID3Track(i,t);return r.samples=Kt(t,i),{videoTrack:i,audioTrack:this.audioTrack,id3Track:s,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,n=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const i=this.extractID3Track(t,this.timeOffset);return n.samples=Kt(e,t),{videoTrack:t,audioTrack:ws(),id3Track:i,textTrack:ws()}}extractID3Track(e,t){const n=this.id3Track;if(e.samples.length){const i=Bt(e.samples,["emsg"]);i&&i.forEach(e=>{const i=function(e){const t=e[0];let n="",i="",r=0,s=0,a=0,o=0,l=0,c=0;if(0===t){for(;"\0"!==Pt(e.subarray(c,c+1));)n+=Pt(e.subarray(c,c+1)),c+=1;for(n+=Pt(e.subarray(c,c+1)),c+=1;"\0"!==Pt(e.subarray(c,c+1));)i+=Pt(e.subarray(c,c+1)),c+=1;i+=Pt(e.subarray(c,c+1)),c+=1,r=Nt(e,12),s=Nt(e,16),o=Nt(e,20),l=Nt(e,24),c=28}else if(1===t){c+=4,r=Nt(e,c),c+=4;const t=Nt(e,c);c+=4;const s=Nt(e,c);for(c+=4,a=2**32*t+s,Me(a)||(a=Number.MAX_SAFE_INTEGER,at.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),o=Nt(e,c),c+=4,l=Nt(e,c),c+=4;"\0"!==Pt(e.subarray(c,c+1));)n+=Pt(e.subarray(c,c+1)),c+=1;for(n+=Pt(e.subarray(c,c+1)),c+=1;"\0"!==Pt(e.subarray(c,c+1));)i+=Pt(e.subarray(c,c+1)),c+=1;i+=Pt(e.subarray(c,c+1)),c+=1}return{schemeIdUri:n,value:i,timeScale:r,presentationTime:a,presentationTimeDelta:s,eventDuration:o,id:l,payload:e.subarray(c,e.byteLength)}}(e);if(Fs.test(i.schemeIdUri)){const e=Bs(i,t);let r=4294967295===i.eventDuration?Number.POSITIVE_INFINITY:i.eventDuration/i.timeScale;r<=.001&&(r=Number.POSITIVE_INFINITY);const s=i.payload;n.samples.push({data:s,len:s.byteLength,dts:e,pts:e,type:Ss.emsg,duration:r})}else if(this.config.enableEmsgKLVMetadata&&i.schemeIdUri.startsWith("urn:misb:KLV:bin:1910.1")){const e=Bs(i,t);n.samples.push({data:i.payload,len:i.payload.byteLength,dts:e,pts:e,type:Ss.misbklv,duration:Number.POSITIVE_INFINITY})}})}return n}demuxSampleAes(e,t,n){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){this.config=null,this.remainderData=null,this.videoTrack=this.audioTrack=this.id3Track=this.txtTrack=void 0}},remux:class extends et{constructor(e,t,n,i){super("passthrough-remuxer",i),this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null,this.isVideoContiguous=!1}destroy(){}resetTimeStamp(e){this.lastEndTime=null;const t=this.initPTS;t&&e&&t.baseTime===e.baseTime&&t.timescale===e.timescale||(this.initPTS=e)}resetNextTimestamp(){this.isVideoContiguous=!1,this.lastEndTime=null}resetInitSegment(e,t,n,i){this.audioCodec=t,this.videoCodec=n,this.generateInitSegment(e,i),this.emitInitSegment=!0}generateInitSegment(e,t){let{audioCodec:n,videoCodec:i}=this;if(null==e||!e.byteLength)return this.initTracks=void 0,void(this.initData=void 0);const{audio:r,video:s}=this.initData=$t(e);if(t)!function(e,t){if(!e||!t)return;const n=t.keyId;n&&t.isCommonEncryption&&Bt(e,["moov","trak"]).forEach(e=>{const t=Bt(e,["mdia","minf","stbl","stsd"])[0].subarray(8);let i=Bt(t,["enca"]);const r=i.length>0;r||(i=Bt(t,["encv"])),i.forEach(e=>{Bt(r?e.subarray(28):e.subarray(78),["sinf"]).forEach(e=>{const t=Ht(e);if(t){const e=t.subarray(8,24);e.some(e=>0!==e)||(at.log(`[eme] Patching keyId in 'enc${r?"a":"v"}>sinf>>tenc' box: ${ut(e)} -> ${ut(n)}`),t.set(n,8))}})})})}(e,t);else{const e=r||s;null!=e&&e.encrypted&&this.warn(`Init segment with encrypted track with has no key ("${e.codec}")!`)}r&&(n=da(r,wt,this)),s&&(i=da(s,Tt,this));const a={};r&&s?a.audiovideo={container:"video/mp4",codec:n+","+i,supplemental:s.supplemental,encrypted:s.encrypted,initSegment:e,id:"main"}:r?a.audio={container:"audio/mp4",codec:n,encrypted:r.encrypted,initSegment:e,id:"audio"}:s?a.video={container:"video/mp4",codec:i,supplemental:s.supplemental,encrypted:s.encrypted,initSegment:e,id:"main"}:this.warn("initSegment does not contain moov or trak boxes."),this.initTracks=a}remux(e,t,n,i,r,s){var a,o;let{initPTS:l,lastEndTime:c}=this;const u={audio:void 0,video:void 0,text:i,id3:n,initSegment:void 0};Ne(c)||(c=this.lastEndTime=r||0);const h=t.samples;if(!h.length)return u;const d={initPTS:void 0,timescale:void 0,trackId:void 0};let f=this.initData;if(null!=(a=f)&&a.length||(this.generateInitSegment(h),f=this.initData),null==(o=f)||!o.length)return this.warn("Failed to generate initSegment."),u;this.emitInitSegment&&(d.tracks=this.initTracks,this.emitInitSegment=!1);const p=function(e,t,n){const i={},r=Bt(e,["moof","traf"]);for(let e=0;e<r.length;e++){const s=r[e],a=Bt(s,["tfhd"])[0],o=Nt(a,4),l=t[o];if(!l)continue;i[o]||(i[o]={start:NaN,duration:0,sampleCount:0,timescale:l.timescale,type:l.type});const c=i[o],u=Bt(s,["tfdt"])[0];if(u){const e=u[0];let t=Nt(u,4);1===e&&(t===It?n.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"):(t*=It+1,t+=Nt(u,8))),Ne(t)&&(!Ne(c.start)||t<c.start)&&(c.start=t)}const h=l.default,d=Nt(a,0)|(null==h?void 0:h.flags);let f=(null==h?void 0:h.duration)||0;8&d&&(f=Nt(a,2&d?12:8));const p=Bt(s,["trun"]);let g=c.start||0,m=0,v=f;for(let e=0;e<p.length;e++){const t=p[e],n=Nt(t,4),i=c.sampleCount;c.sampleCount+=n;const r=1&t[3],s=4&t[3],a=1&t[2],o=2&t[2],l=4&t[2],u=8&t[2];let h=8,d=n;for(r&&(h+=4),s&&n&&(1&t[h+1]||void 0!==c.keyFrameIndex||(c.keyFrameIndex=i),h+=4,a?(v=Nt(t,h),h+=4):v=f,o&&(h+=4),u&&(h+=4),g+=v,m+=v,d--);d--;)a?(v=Nt(t,h),h+=4):v=f,o&&(h+=4),l&&(1&t[h+1]||void 0===c.keyFrameIndex&&(c.keyFrameIndex=c.sampleCount-(d+1),c.keyFrameStart=g),h+=4),u&&(h+=4),g+=v,m+=v;!m&&f&&(m+=f*n)}c.duration+=m}if(!Object.keys(i).some(e=>i[e].duration)){let t=1/0,n=0;const r=Bt(e,["sidx"]);for(let e=0;e<r.length;e++){const i=Ut(r[e]);if(null!=i&&i.references){t=Math.min(t,i.earliestPresentationTime/i.timescale);const e=i.references.reduce((e,t)=>e+t.info.duration||0,0);n=Math.max(n,e+i.earliestPresentationTime/i.timescale)}}n&&Ne(n)&&Object.keys(i).forEach(e=>{i[e].duration||(i[e].duration=n*i[e].timescale-i[e].start)})}return i}(h,f,this),g=f.audio?p[f.audio.id]:null,m=f.video?p[f.video.id]:null,v=ha(m,1/0),y=ha(g,1/0),b=ha(m,0,!0),E=ha(g,0,!0);let S=r,w=0;const T=g&&(!m||!l&&y<v||l&&l.trackId===f.audio.id),k=T?g:m;if(k){const e=k.timescale,t=k.start-r*e,n=T?f.audio.id:f.video.id;S=k.start/e,w=T?E-y:b-v,!s&&l||!function(e,t,n,i){if(null===e)return!0;const r=Math.max(i,1),s=t-e.baseTime/e.timescale;return Math.abs(s-n)>r}(l,S,r,w)&&e===l.timescale||(l&&this.warn(`Timestamps at playlist time: ${s?"":"~"}${r} ${t/e} != initPTS: ${l.baseTime/l.timescale} (${l.baseTime}/${l.timescale}) trackId: ${l.trackId}`),this.log(`Found initPTS at playlist time: ${r} offset: ${S-r} (${t}/${e}) trackId: ${n}`),l=null,d.initPTS=t,d.timescale=e,d.trackId=n)}else this.warn(`No audio or video samples found for initPTS at playlist time: ${r}`);l?(d.initPTS=l.baseTime,d.timescale=l.timescale,d.trackId=l.trackId):(d.timescale&&void 0!==d.trackId&&void 0!==d.initPTS||(this.warn("Could not set initPTS"),d.initPTS=S,d.timescale=1,d.trackId=-1),this.initPTS=l={baseTime:d.initPTS,timescale:d.timescale,trackId:d.trackId});const _=S-l.baseTime/l.timescale,x=_+w;w>0?this.lastEndTime=x:(this.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const L=!!f.audio,A=!!f.video;let R="";L&&(R+="audio"),A&&(R+="video");const I={data1:h,startPTS:_,startDTS:_,endPTS:x,endDTS:x,type:R,hasAudio:L,hasVideo:A,nb:1,dropped:0,encrypted:!!f.audio&&f.audio.encrypted||!!f.video&&f.video.encrypted};u.audio=L&&!A?I:void 0,u.video=A?I:void 0;const C=null==m?void 0:m.sampleCount;if(C){const e=m.keyFrameIndex,t=-1!==e;I.nb=C,I.dropped=0===e||this.isVideoContiguous?0:t?e:C,I.independent=t,I.firstKeyFrame=e,t&&m.keyFrameStart&&(I.firstKeyFramePTS=(m.keyFrameStart-l.baseTime)/l.timescale),this.isVideoContiguous||(u.independent=t),this.isVideoContiguous||(this.isVideoContiguous=t),I.dropped&&this.warn(`fmp4 does not start with IDR: firstIDR ${e}/${C} dropped: ${I.dropped} start: ${I.firstKeyFramePTS||"NA"}`)}return u.initSegment=d,u.id3=ca(n,r,l,l),i.samples.length&&(u.text=ua(i,r,l)),u}}},{demux:qs,remux:oa},{demux:class extends Ts{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,n,i){super.resetInitSegment(e,t,n,i),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}static probe(e,t){if(!e)return!1;const n=rs(e,0);let i=(null==n?void 0:n.length)||0;if(Os(e,i))return!1;for(let n=e.length;i<n;i++)if(cs(e,i))return t.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return function(e,t){return function(e,t){return t+5<e.length}(e,t)&&ss(e,t)&&os(e,t)<=e.length-t}(e,t)}appendFrame(e,t,n){us(e,this.observer,t,n,e.manifestCodec);const i=ds(e,t,n,this.basePTS,this.frameIndex);if(i&&0===i.missing)return i}},remux:oa},{demux:class extends Ts{resetInitSegment(e,t,n,i){super.resetInitSegment(e,t,n,i),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=rs(e,0);let n=(null==t?void 0:t.length)||0;if(t&&11===e[n]&&119===e[n+1]&&void 0!==Es(t)&&Ns(e,n)<=16)return!1;for(let t=e.length;n<t;n++)if(Os(e,n))return at.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return function(e,t){return Ds(e,t)&&4<=e.length-t}(e,t)}appendFrame(e,t,n){if(null!==this.basePTS)return Is(e,t,n,this.basePTS,this.frameIndex)}},remux:oa}];fa.splice(2,0,{demux:class extends Ts{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,t,n,i){super.resetInitSegment(e,t,n,i),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}canParse(e,t){return t+64<e.length}appendFrame(e,t,n){const i=Ms(e,t,n,this.basePTS,this.frameIndex);if(-1!==i)return{sample:e.samples[e.samples.length-1],length:i,missing:0}}static probe(e){if(!e)return!1;const t=rs(e,0);if(!t)return!1;const n=t.length;return 11===e[n]&&119===e[n+1]&&void 0!==Es(t)&&Ns(e,n)<16}},remux:oa});class pa{constructor(e,t,n,i,r,s){this.asyncResult=!1,this.logger=void 0,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=n,this.id=r,this.logger=s}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,n,i){const r=n.transmuxing;r.executeStart=ia();let s=new Uint8Array(e);const{currentTransmuxState:a,transmuxConfig:o}=this;i&&(this.currentTransmuxState=i);const{contiguous:l,discontinuity:c,trackSwitch:u,accurateTimeOffset:h,timeOffset:d,initSegmentChange:f}=i||a,{audioCodec:p,videoCodec:g,defaultInitPts:m,duration:v,initSegmentData:y}=o,b=function(e,t){let n=null;return e.byteLength>0&&null!=(null==t?void 0:t.key)&&null!==t.iv&&null!=t.method&&(n=t),n}(s,t);if(b&&Oi(b.method)){const e=this.getDecrypter(),t=Ni(b.method);if(!e.isSync())return this.asyncResult=!0,this.decryptionPromise=e.webCryptoDecrypt(s,b.key.buffer,b.iv.buffer,t).then(e=>{const t=this.push(e,null,n);return this.decryptionPromise=null,t}),this.decryptionPromise;{let i=e.softwareDecrypt(s,b.key.buffer,b.iv.buffer,t);if(n.part>-1){const t=e.flush();i=t?t.buffer:t}if(!i)return r.executeEnd=ia(),ga(n);s=new Uint8Array(i)}}const E=this.needsProbing(c,u);if(E){const e=this.configureTransmuxer(s);if(e)return this.logger.warn(`[transmuxer] ${e.message}`),this.observer.emit($e.ERROR,$e.ERROR,{type:Be.MEDIA_ERROR,details:Ue.FRAG_PARSING_ERROR,fatal:!1,error:e,reason:e.message}),r.executeEnd=ia(),ga(n)}(c||u||f||E)&&this.resetInitSegment(y,p,g,v,t),(c||f||E)&&this.resetInitialTimestamp(m),l||this.resetContiguity();const S=this.transmux(s,b,d,h,n);this.asyncResult=ma(S);const w=this.currentTransmuxState;return w.contiguous=!0,w.discontinuity=!1,w.trackSwitch=!1,r.executeEnd=ia(),S}flush(e){const t=e.transmuxing;t.executeStart=ia();const{decrypter:n,currentTransmuxState:i,decryptionPromise:r}=this;if(r)return this.asyncResult=!0,r.then(()=>this.flush(e));const s=[],{timeOffset:a}=i;if(n){const t=n.flush();t&&s.push(this.push(t.buffer,null,e))}const{demuxer:o,remuxer:l}=this;if(!o||!l){t.executeEnd=ia();const n=[ga(e)];return this.asyncResult?Promise.resolve(n):n}const c=o.flush(a);return ma(c)?(this.asyncResult=!0,c.then(t=>(this.flushRemux(s,t,e),s))):(this.flushRemux(s,c,e),this.asyncResult?Promise.resolve(s):s)}flushRemux(e,t,n){const{audioTrack:i,videoTrack:r,id3Track:s,textTrack:a}=t,{accurateTimeOffset:o,timeOffset:l}=this.currentTransmuxState;this.logger.log(`[transmuxer.ts]: Flushed ${this.id} sn: ${n.sn}${n.part>-1?" part: "+n.part:""} of ${this.id===qe?"level":"track"} ${n.level}`);const c=this.remuxer.remux(i,r,s,a,l,o,!0,this.id);e.push({remuxResult:c,chunkMeta:n}),n.transmuxing.executeEnd=ia()}resetInitialTimestamp(e){const{demuxer:t,remuxer:n}=this;t&&n&&(t.resetTimeStamp(e),n.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;e&&t&&(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,n,i,r){const{demuxer:s,remuxer:a}=this;s&&a&&(s.resetInitSegment(e,t,n,i),a.resetInitSegment(e,t,n,r))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,n,i,r){let s;return s=t&&"SAMPLE-AES"===t.method?this.transmuxSampleAes(e,t,n,i,r):this.transmuxUnencrypted(e,n,i,r),s}transmuxUnencrypted(e,t,n,i){const{audioTrack:r,videoTrack:s,id3Track:a,textTrack:o}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(r,s,a,o,t,n,!1,this.id),chunkMeta:i}}transmuxSampleAes(e,t,n,i,r){return this.demuxer.demuxSampleAes(e,t,n).then(e=>({remuxResult:this.remuxer.remux(e.audioTrack,e.videoTrack,e.id3Track,e.textTrack,n,i,!1,this.id),chunkMeta:r}))}configureTransmuxer(e){const{config:t,observer:n,typeSupported:i}=this;let r;for(let t=0,n=fa.length;t<n;t++){var s;if(null!=(s=fa[t].demux)&&s.probe(e,this.logger)){r=fa[t];break}}if(!r)return new Error("Failed to find demuxer by probing fragment data");const a=this.demuxer,o=this.remuxer,l=r.remux,c=r.demux;o&&o instanceof l||(this.remuxer=new l(n,t,i,this.logger)),a&&a instanceof c||(this.demuxer=new c(n,t,i,this.logger),this.probe=c.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new ui(this.config)),e}}const ga=e=>({remuxResult:{},chunkMeta:e});function ma(e){return"then"in e&&e.then instanceof Function}class va{constructor(e,t,n,i,r){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=n,this.duration=i,this.defaultInitPts=r||null}}class ya{constructor(e,t,n,i,r,s){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=n,this.trackSwitch=i,this.timeOffset=r,this.initSegmentChange=s}}let ba=0;class Ea{constructor(e,t,n,i){this.error=null,this.hls=void 0,this.id=void 0,this.instanceNo=ba++,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.onWorkerMessage=e=>{const t=e.data,n=this.hls;if(n&&null!=t&&t.event&&t.instanceNo===this.instanceNo)switch(t.event){case"init":{var i;const e=null==(i=this.workerContext)?void 0:i.objectURL;e&&self.URL.revokeObjectURL(e);break}case"transmuxComplete":this.handleTransmuxComplete(t.data);break;case"flush":this.onFlush(t.data);break;case"workerLog":n.logger[t.data.logType]&&n.logger[t.data.logType](t.data.message);break;default:t.data=t.data||{},t.data.frag=this.frag,t.data.part=this.part,t.data.id=this.id,n.trigger(t.event,t.data)}},this.onWorkerError=e=>{if(!this.hls)return;const t=new Error(`${e.message}  (${e.filename}:${e.lineno})`);this.hls.config.enableWorker=!1,this.hls.logger.warn(`Error in "${this.id}" Web Worker, fallback to inline`),this.hls.trigger($e.ERROR,{type:Be.OTHER_ERROR,details:Ue.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:t})};const r=e.config;this.hls=e,this.id=t,this.useWorker=!!r.enableWorker,this.onTransmuxComplete=n,this.onFlush=i;const s=(e,t)=>{(t=t||{}).frag=this.frag||void 0,e===$e.ERROR&&(t.parent=this.id,t.part=this.part,this.error=t.error),this.hls.trigger(e,t)};this.observer=new Zr,this.observer.on($e.FRAG_DECRYPTED,s),this.observer.on($e.ERROR,s);const a=gn(r.preferManagedMediaSource);if(this.useWorker&&"undefined"!=typeof Worker){const n=this.hls.logger;if(r.workerPath||"function"==typeof __HLS_WORKER_BUNDLE__){try{r.workerPath?(n.log(`loading Web Worker ${r.workerPath} for "${t}"`),this.workerContext=function(e){const t=es[e];if(t)return t.clientCount++,t;const n=new self.URL(e,self.location.href).href,i={worker:new self.Worker(n),scriptURL:n,clientCount:1};return es[e]=i,i}(r.workerPath)):(n.log(`injecting Web Worker for "${t}"`),this.workerContext=function(){const e=es[Jr];if(e)return e.clientCount++,e;const t=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),n=self.URL.createObjectURL(t),i={worker:new self.Worker(n),objectURL:n,clientCount:1};return es[Jr]=i,i}());const{worker:e}=this.workerContext;e.addEventListener("message",this.onWorkerMessage),e.addEventListener("error",this.onWorkerError),e.postMessage({instanceNo:this.instanceNo,cmd:"init",typeSupported:a,id:t,config:In(r)})}catch(i){n.warn(`Error setting up "${t}" Web Worker, fallback to inline`,i),this.terminateWorker(),this.error=null,this.transmuxer=new pa(this.observer,a,r,"",t,e.logger)}return}}this.transmuxer=new pa(this.observer,a,r,"",t,e.logger)}reset(){if(this.frag=null,this.part=null,this.workerContext){const e=this.instanceNo;this.instanceNo=ba++;const t=this.hls.config,n=gn(t.preferManagedMediaSource);this.workerContext.worker.postMessage({instanceNo:this.instanceNo,cmd:"reset",resetNo:e,typeSupported:n,id:this.id,config:In(t)})}}terminateWorker(){if(this.workerContext){const{worker:e}=this.workerContext;this.workerContext=null,e.removeEventListener("message",this.onWorkerMessage),e.removeEventListener("error",this.onWorkerError),function(e){const t=es[e||Jr];if(t&&1===t.clientCount--){const{worker:n,objectURL:i}=t;delete es[e||Jr],i&&self.URL.revokeObjectURL(i),n.terminate()}}(this.hls.config.workerPath)}}destroy(){if(this.workerContext)this.terminateWorker(),this.onWorkerMessage=this.onWorkerError=null;else{const e=this.transmuxer;e&&(e.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.part=null,this.observer=null,this.hls=null}push(e,t,n,i,r,s,a,o,l,c){var u,h;l.transmuxing.start=self.performance.now();const{instanceNo:d,transmuxer:f}=this,p=s?s.start:r.start,g=r.decryptdata,m=this.frag,v=!(m&&r.cc===m.cc),y=!(m&&l.level===m.level),b=m?l.sn-m.sn:-1,E=this.part?l.part-this.part.index:-1,S=0===b&&l.id>1&&l.id===(null==m?void 0:m.stats.chunkCount),w=!y&&(1===b||0===b&&(1===E||S&&E<=0)),T=self.performance.now();(y||b||0===r.stats.parsing.start)&&(r.stats.parsing.start=T),!s||!E&&w||(s.stats.parsing.start=T);const k=!(m&&(null==(u=r.initSegment)?void 0:u.url)===(null==(h=m.initSegment)?void 0:h.url)),_=new ya(v,w,o,y,p,k);if(!w||v||k){this.hls.logger.log(`[transmuxer-interface]: Starting new transmux session for ${r.type} sn: ${l.sn}${l.part>-1?" part: "+l.part:""} ${this.id===qe?"level":"track"}: ${l.level} id: ${l.id}\n        discontinuity: ${v}\n        trackSwitch: ${y}\n        contiguous: ${w}\n        accurateTimeOffset: ${o}\n        timeOffset: ${p}\n        initSegmentChange: ${k}`);const e=new va(n,i,t,a,c);this.configureTransmuxer(e)}if(this.frag=r,this.part=s,this.workerContext)this.workerContext.worker.postMessage({instanceNo:d,cmd:"demux",data:e,decryptdata:g,chunkMeta:l,state:_},e instanceof ArrayBuffer?[e]:[]);else if(f){const t=f.push(e,g,l,_);ma(t)?t.then(e=>{this.handleTransmuxComplete(e)}).catch(e=>{this.transmuxerError(e,l,"transmuxer-interface push error")}):this.handleTransmuxComplete(t)}}flush(e){e.transmuxing.start=self.performance.now();const{instanceNo:t,transmuxer:n}=this;if(this.workerContext)this.workerContext.worker.postMessage({instanceNo:t,cmd:"flush",chunkMeta:e});else if(n){const t=n.flush(e);ma(t)?t.then(t=>{this.handleFlushResult(t,e)}).catch(t=>{this.transmuxerError(t,e,"transmuxer-interface flush error")}):this.handleFlushResult(t,e)}}transmuxerError(e,t,n){this.hls&&(this.error=e,this.hls.trigger($e.ERROR,{type:Be.MEDIA_ERROR,details:Ue.FRAG_PARSING_ERROR,chunkMeta:t,frag:this.frag||void 0,part:this.part||void 0,fatal:!1,error:e,err:e,reason:n}))}handleFlushResult(e,t){e.forEach(e=>{this.handleTransmuxComplete(e)}),this.onFlush(t)}configureTransmuxer(e){const{instanceNo:t,transmuxer:n}=this;this.workerContext?this.workerContext.worker.postMessage({instanceNo:t,cmd:"configure",config:e}):n&&n.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}class Sa extends et{constructor(e,t){super(t,e.logger),this.hls=void 0,this.canLoad=!1,this.timer=-1,this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){-1!==this.timer&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t,n){const i=null==t?void 0:t.renditionReports;if(i){let r=-1;for(let n=0;n<i.length;n++){const s=i[n];let a;try{a=new self.URL(s.URI,t.url).href}catch(e){this.warn(`Could not construct new URL for Rendition Report: ${e}`),a=s.URI||""}if(a===e){r=n;break}a===e.substring(0,a.length)&&(r=n)}if(-1!==r){const e=i[r],s=parseInt(e["LAST-MSN"])||t.lastPartSn;let a=parseInt(e["LAST-PART"])||t.lastPartIndex;if(this.hls.config.lowLatencyMode){const e=Math.min(t.age-t.partTarget,t.targetduration);a>=0&&e>t.partTarget&&(a+=1)}const o=n&&xn(n);return new Ln(s,a>=0?a:void 0,o)}}}loadPlaylist(e){this.clearTimer()}loadingPlaylist(e,t){this.clearTimer()}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}getUrlWithDirectives(e,t){if(t)try{return t.addDirectives(e)}catch(e){this.warn(`Could not construct new URL with HLS Delivery Directives: ${e}`)}return e}playlistLoaded(e,t,n){const{details:i,stats:r}=t,s=self.performance.now(),a=r.loading.first?Math.max(0,s-r.loading.first):0;i.advancedDateTime=Date.now()-a;const o=this.hls.config.timelineOffset;if(o!==i.appliedTimelineOffset){const e=Math.max(o||0,0);i.appliedTimelineOffset=e,i.fragments.forEach(t=>{t.setStart(t.playlistOffset+e)})}if(i.live||null!=n&&n.live){const o="levelInfo"in t?t.levelInfo:t.track;if(i.reloaded(n),n&&i.fragments.length>0){!function(e,t,n){if(e===t)return;let i=null;const r=e.fragments;for(let e=r.length-1;e>=0;e--){const t=r[e].initSegment;if(t){i=t;break}}let s;e.fragmentHint&&delete e.fragmentHint.endPTS,function(e,t,n){const i=t.skippedSegments,r=Math.max(e.startSN,t.startSN)-t.startSN,s=(e.fragmentHint?1:0)+(i?t.endSN:Math.min(e.endSN,t.endSN))-t.startSN,a=t.startSN-e.startSN,o=t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments,l=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments;for(let c=r;c<=s;c++){const r=l[a+c];let s=o[c];if(i&&!s&&r&&(s=t.fragments[c]=r),r&&s){n(r,s,c,o);const i=r.relurl,a=s.relurl;if(i&&_r(i,a))return void(t.playlistParsingError=vr(`media sequence mismatch ${s.sn}:`,e,t,0,s));if(r.cc!==s.cc)return void(t.playlistParsingError=vr(`discontinuity sequence mismatch (${r.cc}!=${s.cc})`,e,t,0,s))}}}(e,t,(e,n,r,a)=>{if((!t.startCC||t.skippedSegments)&&n.cc!==e.cc){const i=e.cc-n.cc;for(let e=r;e<a.length;e++)a[e].cc+=i;t.endCC=a[a.length-1].cc}Ne(e.startPTS)&&Ne(e.endPTS)&&(n.setStart(n.startPTS=e.startPTS),n.startDTS=e.startDTS,n.maxStartPTS=e.maxStartPTS,n.endPTS=e.endPTS,n.endDTS=e.endDTS,n.minEndPTS=e.minEndPTS,n.setDuration(e.endPTS-e.startPTS),n.duration&&(s=n),t.PTSKnown=t.alignedSliding=!0),e.hasStreams&&(n.elementaryStreams=e.elementaryStreams),n.loader=e.loader,e.hasStats&&(n.stats=e.stats),e.initSegment&&(n.initSegment=e.initSegment,i=e.initSegment)});const a=t.fragments,o=t.fragmentHint?a.concat(t.fragmentHint):a;if(i&&o.forEach(e=>{var t;!e||e.initSegment&&e.initSegment.relurl!==(null==(t=i)?void 0:t.relurl)||(e.initSegment=i)}),t.skippedSegments){if(t.deltaUpdateFailed=a.some(e=>!e),t.deltaUpdateFailed){n.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let e=t.skippedSegments;e--;)a.shift();t.startSN=a[0].sn}else{t.canSkipDateRanges&&(t.dateRanges=function(e,t,n){const{dateRanges:i,recentlyRemovedDateranges:r}=t,s=Qe({},e);r&&r.forEach(e=>{delete s[e]});const a=Object.keys(s).length;return a?(Object.keys(i).forEach(e=>{const t=s[e],r=new Ii(i[e].attr,t);r.isValid?(s[e]=r,t||(r.tagOrder+=a)):n.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${In(i[e].attr)}"`)}),s):i}(e.dateRanges,t,n));const i=e.fragments.filter(e=>e.rawProgramDateTime);if(e.hasProgramDateTime&&!t.hasProgramDateTime)for(let e=1;e<o.length;e++)null===o[e].programDateTime&&ur(o[e],o[e-1],i);rr(i,t)}t.endCC=a[a.length-1].cc}if(!t.startCC){var l;const n=Sr(e,t.startSN-1);t.startCC=null!=(l=null==n?void 0:n.cc)?l:a[0].cc}!function(e,t,n){if(e&&t){let i=0;for(let r=0,s=e.length;r<=s;r++){const s=e[r],a=t[r+i];s&&a&&s.index===a.index&&s.fragment.sn===a.fragment.sn?n(s,a):i--}}}(e.partList,t.partList,(e,t)=>{t.elementaryStreams=e.elementaryStreams,t.stats=e.stats}),s?mr(t,s,s.startPTS,s.endPTS,s.startDTS,s.endDTS,n):yr(e,t),a.length&&(t.totalduration=t.edge-a[0].start),t.driftStartTime=e.driftStartTime,t.driftStart=e.driftStart;const c=t.advancedDateTime;if(t.advanced&&c){const e=t.edge;t.driftStart||(t.driftStartTime=c,t.driftStart=e),t.driftEndTime=c,t.driftEnd=e}else t.driftEndTime=e.driftEndTime,t.driftEnd=e.driftEnd,t.advancedDateTime=e.advancedDateTime;-1===t.requestScheduled&&(t.requestScheduled=e.requestScheduled)}(n,i,this);const e=i.playlistParsingError;if(e){this.warn(e);const n=this.hls;if(!n.config.ignorePlaylistParsingErrors){var l;const{networkDetails:s}=t;return void n.trigger($e.ERROR,{type:Be.NETWORK_ERROR,details:Ue.LEVEL_PARSING_ERROR,fatal:!1,url:i.url,error:e,reason:e.message,level:t.level||void 0,parent:null==(l=i.fragments[0])?void 0:l.type,networkDetails:s,stats:r})}i.playlistParsingError=null}}-1===i.requestScheduled&&(i.requestScheduled=r.loading.start);const c=this.hls.mainForwardBufferInfo,u=c?c.end-c.len:0,h=Er(i,1e3*(i.edge-u));if(i.requestScheduled+h<s?i.requestScheduled=s:i.requestScheduled+=h,this.log(`live playlist ${e} ${i.advanced?"REFRESHED "+i.lastPartSn+"-"+i.lastPartIndex:i.updated?"UPDATED":"MISSED"}`),!this.canLoad||!i.live)return;let d,f,p;if(i.canBlockReload&&i.endSN&&i.advanced){const e=this.hls.config.lowLatencyMode,r=i.lastPartSn,a=i.endSN,l=i.lastPartIndex,c=r===a;-1!==l?c?(f=a+1,p=e?0:l):(f=r,p=e?l+1:i.maxPartIndex):f=a+1;const u=i.age,h=u+i.ageHeader;let g=Math.min(h-i.partTarget,1.5*i.targetduration);if(g>0){if(h>3*i.targetduration)this.log(`Playlist last advanced ${u.toFixed(2)}s ago. Omitting segment and part directives.`),f=void 0,p=void 0;else if(null!=n&&n.tuneInGoal&&h-i.partTarget>n.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${n.tuneInGoal} to: ${g} with playlist age: ${i.age}`),g=0;else{const e=Math.floor(g/i.targetduration);f+=e,void 0!==p&&(p+=Math.round(g%i.targetduration/i.partTarget)),this.log(`CDN Tune-in age: ${i.ageHeader}s last advanced ${u.toFixed(2)}s goal: ${g} skip sn ${e} to part ${p}`)}i.tuneInGoal=g}if(d=this.getDeliveryDirectives(i,t.deliveryDirectives,f,p),e||!c)return i.requestScheduled=s,void this.loadingPlaylist(o,d)}else(i.canBlockReload||i.canSkipUntil)&&(d=this.getDeliveryDirectives(i,t.deliveryDirectives,f,p));d&&void 0!==f&&i.canBlockReload&&(i.requestScheduled=r.loading.first+Math.max(h-2*a,h/2)),this.scheduleLoading(o,d,i)}else this.clearTimer()}scheduleLoading(e,t,n){const i=n||e.details;if(!i)return void this.loadingPlaylist(e,t);const r=self.performance.now(),s=i.requestScheduled;if(r>=s)return void this.loadingPlaylist(e,t);const a=s-r;this.log(`reload live playlist ${e.name||e.bitrate+"bps"} in ${Math.round(a)} ms`),this.clearTimer(),this.timer=self.setTimeout(()=>this.loadingPlaylist(e,t),a)}getDeliveryDirectives(e,t,n,i){let r=xn(e);return null!=t&&t.skip&&e.deltaUpdateFailed&&(n=t.msn,i=t.part,r=""),new Ln(n,i,r)}checkRetry(e){const t=e.details,n=Vn(e),i=e.errorAction,{action:r,retryCount:s=0,retryConfig:a}=i||{},o=!!i&&!!a&&(5===r||!i.resolved&&2===r);if(o){var l;if(s>=a.maxNumRetry)return!1;if(n&&null!=(l=e.context)&&l.deliveryDirectives)this.warn(`Retrying playlist loading ${s+1}/${a.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const e=Kn(a,s);this.clearTimer(),this.timer=self.setTimeout(()=>this.loadPlaylist(),e),this.warn(`Retrying playlist loading ${s+1}/${a.maxNumRetry} after "${t}" in ${e}ms`)}e.levelRetry=!0,i.resolved=!0}return o}}function wa(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!Ta(e[n].attrs,t[n].attrs))return!1;return!0}function Ta(e,t,n){const i=e["STABLE-RENDITION-ID"];return i&&!n?i===t["STABLE-RENDITION-ID"]:!(n||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(n=>e[n]!==t[n])}function ka(e,t){return t.label.toLowerCase()===e.name.toLowerCase()&&(!t.language||t.language.toLowerCase()===(e.lang||"").toLowerCase())}class _a{constructor(e){this.tracks=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.tracks=e}destroy(){this.tracks=this.queues=null}append(e,t,n){if(null===this.queues||null===this.tracks)return;const i=this.queues[t];i.push(e),1!==i.length||n||this.executeNext(t)}appendBlocker(e){return new Promise(t=>{const n={label:"async-blocker",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.append(n,e)})}prependBlocker(e){return new Promise(t=>{if(this.queues){const n={label:"async-blocker-prepend",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.queues[e].unshift(n)}})}removeBlockers(){null!==this.queues&&[this.queues.video,this.queues.audio,this.queues.audiovideo].forEach(e=>{var t;const n=null==(t=e[0])?void 0:t.label;"async-blocker"!==n&&"async-blocker-prepend"!==n||(e[0].execute(),e.splice(0,1))})}unblockAudio(e){null!==this.queues&&this.queues.audio[0]===e&&this.shiftAndExecuteNext("audio")}executeNext(e){if(null===this.queues||null===this.tracks)return;const t=this.queues[e];if(t.length){const i=t[0];try{i.execute()}catch(t){var n;if(i.onError(t),null===this.queues||null===this.tracks)return;const r=null==(n=this.tracks[e])?void 0:n.buffer;null!=r&&r.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){null!==this.queues&&(this.queues[e].shift(),this.executeNext(e))}current(e){var t;return(null==(t=this.queues)?void 0:t[e][0])||null}toString(){const{queues:e,tracks:t}=this;return null===e||null===t?"<destroyed>":`\n${this.list("video")}\n${this.list("audio")}\n${this.list("audiovideo")}}`}list(e){var t,n;return null!=(t=this.queues)&&t[e]||null!=(n=this.tracks)&&n[e]?`${e}: (${this.listSbInfo(e)}) ${this.listOps(e)}`:""}listSbInfo(e){var t;const n=null==(t=this.tracks)?void 0:t[e],i=null==n?void 0:n.buffer;return i?`SourceBuffer${i.updating?" updating":""}${n.ended?" ended":""}${n.ending?" ending":""}`:"none"}listOps(e){var t;return(null==(t=this.queues)?void 0:t[e].map(e=>e.label).join(", "))||""}}const xa=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,La="HlsJsTrackRemovedError";class Aa extends Error{constructor(e){super(e),this.name=La}}function Ra(e){const t=e.querySelectorAll("source");[].slice.call(t).forEach(t=>{e.removeChild(t)})}function Ia(e){return"audio"===e?1:0}class Ca{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on($e.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on($e.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on($e.MANIFEST_PARSED,this.onManifestParsed,this),e.on($e.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on($e.BUFFER_CODECS,this.onBufferCodecs,this),e.on($e.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off($e.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off($e.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off($e.MANIFEST_PARSED,this.onManifestParsed,this),e.off($e.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off($e.BUFFER_CODECS,this.onBufferCodecs,this),e.off($e.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const n=this.hls.levels[t.droppedLevel];this.isLevelAllowed(n)&&this.restrictedLevels.push({bitrate:n.bitrate,height:n.height,width:n.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,t){const n=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,n.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onLevelsUpdated(e,t){this.timer&&Ne(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping(),this.media=null}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0)return void(this.clientRect=null);const e=this.hls.levels;if(e.length){const t=this.hls,n=this.getMaxLevel(e.length-1);n!==this.autoLevelCapping&&t.logger.log(`Setting autoLevelCapping to ${n}: ${e[n].height}p@${e[n].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),t.autoLevelCapping=n,t.autoLevelEnabled&&t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const n=t.filter((t,n)=>this.isLevelAllowed(t)&&n<=e);return this.clientRect=null,Ca.getMaxLevelByMediaSize(n,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const n=e.getBoundingClientRect();t.width=n.width,t.height=n.height,t.width||t.height||(t.width=n.right-n.left||e.width||0,t.height=n.bottom-n.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch(e){}return Math.min(e,this.hls.config.maxDevicePixelRatio)}isLevelAllowed(e){return!this.restrictedLevels.some(t=>e.bitrate===t.bitrate&&e.width===t.width&&e.height===t.height)}static getMaxLevelByMediaSize(e,t,n){if(null==e||!e.length)return-1;const i=(e,t)=>!t||e.width!==t.width||e.height!==t.height;let r=e.length-1;const s=Math.max(t,n);for(let t=0;t<e.length;t+=1){const n=e[t];if((n.width>=s||n.height>=s)&&i(n,e[t+1])){r=t;break}}return r}}const Da="m",Pa="a",Oa="v",Na="av",Ma="i",Fa="tt",Ba="h";class Ua{constructor(e,t){Array.isArray(e)&&(e=e.map(e=>e instanceof Ua?e:new Ua(e))),this.value=e,this.params=t}}function $a(e,t,n){return function(e,t,n,i){return new Error(`failed to ${e} "${r=t,Array.isArray(r)?JSON.stringify(r):r instanceof Map?"Map{}":r instanceof Set?"Set{}":"object"==typeof r?JSON.stringify(r):String(r)}" as ${n}`,{cause:i});var r}("serialize",e,t,n)}class ja{constructor(e){this.description=e}}const za="Bare Item";function Ga(e){if(function(e){return e<-999999999999999||999999999999999<e}(e))throw $a(e,"Integer");return e.toString()}function Va(e,t){if(e<0)return-Va(-e,t);const n=Math.pow(10,t);if(Math.abs(e*n%1-.5)<Number.EPSILON){const t=Math.floor(e*n);return(t%2==0?t:t+1)/n}return Math.round(e*n)/n}function qa(e){const t=Va(e,3);if(Math.floor(Math.abs(t)).toString().length>12)throw $a(e,"Decimal");const n=t.toString();return n.includes(".")?n:`${n}.0`}const Ha=/[\x00-\x1f\x7f]+/;function Wa(e){const t=(n=e).description||n.toString().slice(7,-1);var n;if(!1===/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(t))throw $a(t,"Token");return t}function Ka(e){switch(typeof e){case"number":if(!Ne(e))throw $a(e,za);return Number.isInteger(e)?Ga(e):qa(e);case"string":return function(e){if(Ha.test(e))throw $a(e,"String");return`"${e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}(e);case"symbol":return Wa(e);case"boolean":return function(e){if("boolean"!=typeof e)throw $a(e,"Boolean");return e?"?1":"?0"}(e);case"object":if(e instanceof Date)return function(e){return`@${Ga(e.getTime()/1e3)}`}(e);if(e instanceof Uint8Array)return function(e){if(!1===ArrayBuffer.isView(e))throw $a(e,"Byte Sequence");return`:${t=e,btoa(String.fromCharCode(...t))}:`;var t}(e);if(e instanceof ja)return Wa(e);default:throw $a(e,za)}}function Ya(e){if(!1===/^[a-z*][a-z0-9\-_.*]*$/.test(e))throw $a(e,"Key");return e}function Xa(e){return null==e?"":Object.entries(e).map(([e,t])=>!0===t?`;${Ya(e)}`:`;${Ya(e)}=${Ka(t)}`).join("")}function Qa(e){return e instanceof Ua?`${Ka(e.value)}${Xa(e.params)}`:Ka(e)}function Za(e,t){return function(e,t={whitespace:!0}){if("object"!=typeof e||null==e)throw $a(e,"Dict");const n=e instanceof Map?e.entries():Object.entries(e),i=(null==t?void 0:t.whitespace)?" ":"";return Array.from(n).map(([e,t])=>{t instanceof Ua==0&&(t=new Ua(t));let n=Ya(e);var i;return!0===t.value?n+=Xa(t.params):(n+="=",Array.isArray(t.value)?n+=`(${(i=t).value.map(Qa).join(" ")})${Xa(i.params)}`:n+=Qa(t)),n}).join(`,${i}`)}(e,t)}const Ja="CMCD-Object",eo="CMCD-Request",to="CMCD-Session",no="CMCD-Status",io={br:Ja,ab:Ja,d:Ja,ot:Ja,tb:Ja,tpb:Ja,lb:Ja,tab:Ja,lab:Ja,url:Ja,pb:eo,bl:eo,tbl:eo,dl:eo,ltc:eo,mtp:eo,nor:eo,nrr:eo,rc:eo,sn:eo,sta:eo,su:eo,ttfb:eo,ttfbb:eo,ttlb:eo,cmsdd:eo,cmsds:eo,smrt:eo,df:eo,cs:eo,ts:eo,cid:to,pr:to,sf:to,sid:to,st:to,v:to,msd:to,bs:no,bsd:no,cdn:no,rtp:no,bg:no,pt:no,ec:no,e:no},ro=eo;const so="event",ao=e=>Math.round(e),oo=(e,t)=>Array.isArray(e)?e.map(e=>oo(e,t)):e instanceof Ua&&"string"==typeof e.value?new Ua(oo(e.value,t),e.params):(t.baseUrl&&(e=function(e,t){const n=new URL(e),i=new URL(t);if(n.origin!==i.origin)return e;const r=n.pathname.split("/").slice(1),s=i.pathname.split("/").slice(1,-1);for(;r[0]===s[0];)r.shift(),s.shift();for(;s.length;)s.shift(),r.unshift("..");return r.join("/")+n.search+n.hash}(e,t.baseUrl)),1===t.version?encodeURIComponent(e):e),lo=e=>100*ao(e/100),co={br:ao,d:ao,bl:lo,dl:lo,mtp:lo,nor:(e,t)=>{let n=e;return t.version>=2&&(e instanceof Ua&&"string"==typeof e.value?n=new Ua([e]):"string"==typeof e&&(n=[e])),oo(n,t)},rtp:lo,tb:ao},uo="request",ho="response",fo=["ab","bg","bl","br","bs","bsd","cdn","cid","cs","df","ec","lab","lb","ltc","msd","mtp","pb","pr","pt","sf","sid","sn","st","sta","tab","tb","tbl","tpb","ts","v"],po=["e"],go=/^[a-zA-Z0-9-.]+-[a-zA-Z0-9-.]+$/;function mo(e){return go.test(e)}const vo=["d","dl","nor","ot","rtp","su"],yo=["cmsdd","cmsds","rc","smrt","ttfb","ttfbb","ttlb","url"],bo=["bl","br","bs","cid","d","dl","mtp","nor","nrr","ot","pr","rtp","sf","sid","st","su","tb","v"];function Eo(e){return bo.includes(e)||mo(e)}const So={[ho]:function(e){return fo.includes(e)||vo.includes(e)||yo.includes(e)||mo(e)},[so]:function(e){return fo.includes(e)||po.includes(e)||mo(e)},[uo]:function(e){return fo.includes(e)||vo.includes(e)||mo(e)}};function wo(e,t={}){const n={};if(null==e||"object"!=typeof e)return n;const i=t.version||e.v||1,r=t.reportingMode||uo,s=1===i?Eo:So[r];let a=Object.keys(e).filter(s);const o=t.filter;"function"==typeof o&&(a=a.filter(o));const l=r===ho||r===so;l&&!a.includes("ts")&&a.push("ts"),i>1&&!a.includes("v")&&a.push("v");const c=Qe({},co,t.formatters),u={version:i,reportingMode:r,baseUrl:t.baseUrl};return a.sort().forEach(t=>{let r=e[t];const s=c[t];if("function"==typeof s&&(r=s(r,u)),"v"===t){if(1===i)return;r=i}"pr"==t&&1===r||(l&&"ts"===t&&!Ne(r)&&(r=Date.now()),function(e){return"number"==typeof e?Ne(e):null!=e&&""!==e&&!1!==e}(r)&&(function(e){return["ot","sf","st","e","sta"].includes(e)}(t)&&"string"==typeof r&&(r=new ja(r)),n[t]=r))}),n}function To(e,t,n){return Qe(e,function(e,t={}){const n={};if(!e)return n;const i=function(e,t){const n={};if(!e)return n;const i=Object.keys(e),r=t?(s=t,Object.keys(s).reduce((e,t)=>{var n;return null===(n=s[t])||void 0===n||n.forEach(n=>e[n]=t),e},{})):{};var s;return i.reduce((t,n)=>{var i;const s=io[n]||r[n]||ro;return(null!==(i=t[s])&&void 0!==i?i:t[s]={})[n]=e[n],t},n)}(wo(e,t),null==t?void 0:t.customHeaderMap);return Object.entries(i).reduce((e,[t,n])=>{const i=Za(n,{whitespace:!1});return i&&(e[t]=i),e},n)}(t,n))}const ko=/CMCD=[^&#]+/;function _o(e,t,n){const i=function(e,t={}){return e?`CMCD=${function(e,t={}){if(!e)return"";const n=function(e,t={}){return e?Za(wo(e,t),{whitespace:!1}):""}(e,t);return encodeURIComponent(n)}(e,t)}`:""}(t,n);if(!i)return e;if(ko.test(e))return e.replace(ko,i);const r=e.includes("?")?"&":"?";return`${e}${r}${i}`}function xo(e,t,n,i){e&&Object.keys(t).forEach(r=>{const s=e.filter(e=>e.groupId===r).map(e=>{const s=Qe({},e);return s.details=void 0,s.attrs=new Li(s.attrs),s.url=s.attrs.URI=Lo(e.url,e.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",n),s.groupId=s.attrs["GROUP-ID"]=t[r],s.attrs["PATHWAY-ID"]=i,s});e.push(...s)})}function Lo(e,t,n,i){const{HOST:r,PARAMS:s,[n]:a}=i;let o;t&&(o=null==a?void 0:a[t],o&&(e=o));const l=new self.URL(e);return r&&!o&&(l.host=r),s&&Object.keys(s).sort().forEach(e=>{e&&l.searchParams.set(e,s[e])}),l.href}class Ao extends et{constructor(e){super("eme",e.logger),this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.mediaKeys=null,this.setMediaKeysQueue=Ao.CDMCleanupPromise?[Ao.CDMCleanupPromise]:[],this.bannedKeyIds={},this.onMediaEncrypted=e=>{const{initDataType:t,initData:n}=e,i=`"${e.type}" event: init data type: "${t}"`;if(this.debug(i),null!==n){if(!this.keyFormatPromise){let e=Object.keys(this.keySystemAccessPromises);e.length||(e=Wi(this.config));const t=e.map(Hi).filter(e=>!!e);this.keyFormatPromise=this.getKeyFormatPromise(t)}this.keyFormatPromise.then(r=>{const s=qi(r);if("sinf"!==t||s!==$i.FAIRPLAY)return void this.log(`Ignoring "${e.type}" event with init data type: "${t}" for selected key-system ${s}`);let a;try{const e=Pt(new Uint8Array(n)),t=Ht(Mi(JSON.parse(e).sinf));if(!t)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");a=new Uint8Array(t.subarray(8,24))}catch(e){return void this.warn(`${i} Failed to parse sinf: ${e}`)}const o=ut(a),{keyIdToKeySessionPromise:l,mediaKeySessions:c}=this;let u=l[o];for(let e=0;e<c.length;e++){const i=c[e],r=i.decryptdata;if(!r.keyId)continue;const s=ut(r.keyId);if(Di(a,r.keyId)||-1!==r.uri.replace(/-/g,"").indexOf(o)){if(u=l[s],!u)continue;if(r.pssh)break;delete l[s],r.pssh=new Uint8Array(n),r.keyId=a,u=l[o]=u.then(()=>this.generateRequestWithPreferredKeySession(i,t,n,"encrypted-event-key-match")),u.catch(e=>this.handleError(e));break}}u||this.handleError(new Error(`Key ID ${o} not encountered in playlist. Key-system sessions ${c.length}.`))}).catch(e=>this.handleError(e))}},this.onWaitingForKey=e=>{this.log(`"${e.type}" event`)},this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.onDestroying(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}registerListeners(){this.hls.on($e.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on($e.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on($e.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on($e.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.on($e.DESTROYING,this.onDestroying,this)}unregisterListeners(){this.hls.off($e.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off($e.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off($e.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off($e.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.off($e.DESTROYING,this.onDestroying,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:n}=this.config,i=null==t?void 0:t[e];return i?i.licenseUrl:e===$i.WIDEVINE&&n?n:void 0}getLicenseServerUrlOrThrow(e){const t=this.getLicenseServerUrl(e);if(void 0===t)throw new Error(`no license server URL configured for key-system "${e}"`);return t}getServerCertificateUrl(e){const{drmSystems:t}=this.config,n=null==t?void 0:t[e];if(n)return n.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,n=(e,t,n)=>!!e&&n.indexOf(e)===t,i=t.map(e=>e.audioCodec).filter(n),r=t.map(e=>e.videoCodec).filter(n);return i.length+r.length===0&&r.push("avc1.42e01e"),new Promise((t,n)=>{const s=e=>{const a=e.shift();this.getMediaKeysPromise(a,i,r).then(e=>t({keySystem:a,mediaKeys:e})).catch(t=>{e.length?s(e):n(t instanceof Co?t:new Co({type:Be.KEY_SYSTEM_ERROR,details:Ue.KEY_SYSTEM_NO_ACCESS,error:t,fatal:!0},t.message))})};s(e)})}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:n}=this.config;if("function"!=typeof n){let e=`Configured requestMediaKeySystemAccess is not a function ${n}`;return null===Ki&&"http:"===self.location.protocol&&(e=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(e))}return n(e,t)}getMediaKeysPromise(e,t,n){var i;const r=function(e,t,n,i){let r;switch(e){case $i.FAIRPLAY:r=["cenc","sinf"];break;case $i.WIDEVINE:case $i.PLAYREADY:r=["cenc"];break;case $i.CLEARKEY:r=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${e}`)}return function(e,t,n,i){return[{initDataTypes:e,persistentState:i.persistentState||"optional",distinctiveIdentifier:i.distinctiveIdentifier||"optional",sessionTypes:i.sessionTypes||[i.sessionType||"temporary"],audioCapabilities:t.map(e=>({contentType:`audio/mp4; codecs=${e}`,robustness:i.audioRobustness||"",encryptionScheme:i.audioEncryptionScheme||null})),videoCapabilities:n.map(e=>({contentType:`video/mp4; codecs=${e}`,robustness:i.videoRobustness||"",encryptionScheme:i.videoEncryptionScheme||null}))}]}(r,t,n,i)}(e,t,n,this.config.drmSystemOptions||{});let s=this.keySystemAccessPromises[e],a=null==(i=s)?void 0:i.keySystemAccess;if(!a){this.log(`Requesting encrypted media "${e}" key-system access with config: ${In(r)}`),a=this.requestMediaKeySystemAccess(e,r);const t=s=this.keySystemAccessPromises[e]={keySystemAccess:a};return a.catch(t=>{this.log(`Failed to obtain access to key-system "${e}": ${t}`)}),a.then(n=>{this.log(`Access for key-system "${n.keySystem}" obtained`);const i=this.fetchServerCertificate(e);this.log(`Create media-keys for "${e}"`);const r=t.mediaKeys=n.createMediaKeys().then(n=>(this.log(`Media-keys created for "${e}"`),t.hasMediaKeys=!0,i.then(t=>t?this.setMediaKeysServerCertificate(n,e,t):n)));return r.catch(t=>{this.error(`Failed to create media-keys for "${e}"}: ${t}`)}),r})}return a.then(()=>s.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:n}){this.log(`Creating key-system session "${t}" keyId: ${ut(e.keyId||[])} keyUri: ${e.uri}`);const i=n.createSession(),r={decryptdata:e,keySystem:t,mediaKeys:n,mediaKeysSession:i,keyStatus:"status-pending"};return this.mediaKeySessions.push(r),r}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const n=this.createMediaKeySessionContext(e),i=Ro(t),r="cenc";this.keyIdToKeySessionPromise[i]=this.generateRequestWithPreferredKeySession(n,r,t.pssh.buffer,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}updateKeySession(e,t){const n=e.mediaKeysSession;return this.log(`Updating key-session "${n.sessionId}" for keyId ${ut(e.decryptdata.keyId||[])}\n      } (data length: ${t.byteLength})`),n.update(t)}getSelectedKeySystemFormats(){return Object.keys(this.keySystemAccessPromises).map(e=>({keySystem:e,hasMediaKeys:this.keySystemAccessPromises[e].hasMediaKeys})).filter(({hasMediaKeys:e})=>!!e).map(({keySystem:e})=>Hi(e)).filter(e=>!!e)}getKeySystemAccess(e){return this.getKeySystemSelectionPromise(e).then(({keySystem:e,mediaKeys:t})=>this.attemptSetMediaKeys(e,t))}selectKeySystem(e){return new Promise((t,n)=>{this.getKeySystemSelectionPromise(e).then(({keySystem:e})=>{const i=Hi(e);i?t(i):n(new Error(`Unable to find format for key-system "${e}"`))}).catch(n)})}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){const t=Wi(this.config),n=e.map(qi).filter(e=>!!e&&-1!==t.indexOf(e));return this.selectKeySystem(n)}getKeyStatus(e){const{mediaKeySessions:t}=this;for(let n=0;n<t.length;n++){const i=Io(e,t[n]);if(i)return i}}loadKey(e){const t=e.keyInfo.decryptdata,n=Ro(t),i=this.bannedKeyIds[n];if(i||"internal-error"===this.getKeyStatus(t)){const n=Do(i||"internal-error",t);return this.handleError(n,e.frag),Promise.reject(n)}const r=`(keyId: ${n} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${r}`);const s=this.keyIdToKeySessionPromise[n];if(!s){const i=this.getKeySystemForKeyPromise(t).then(({keySystem:n,mediaKeys:i})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${r}`),this.attemptSetMediaKeys(n,i).then(()=>(this.throwIfDestroyed(),this.createMediaKeySessionContext({keySystem:n,mediaKeys:i,decryptdata:t}))))).then(e=>{const n=t.pssh?t.pssh.buffer:null;return this.generateRequestWithPreferredKeySession(e,"cenc",n,"playlist-key")});return i.catch(t=>this.handleError(t,e.frag)),this.keyIdToKeySessionPromise[n]=i,i}return s.catch(n=>{if(n instanceof Co){const i=Je({},n.data);"internal-error"===this.getKeyStatus(t)&&(i.decryptdata=t);const r=new Co(i,n.message);this.handleError(r,e.frag)}}),s}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e,t){if(this.hls)if(e instanceof Co){t&&(e.data.frag=t);const n=e.data.decryptdata;this.error(`${e.message}${n?` (${ut(n.keyId||[])})`:""}`),this.hls.trigger($e.ERROR,e.data)}else this.error(e.message),this.hls.trigger($e.ERROR,{type:Be.KEY_SYSTEM_ERROR,details:Ue.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0})}getKeySystemForKeyPromise(e){const t=Ro(e),n=this.keyIdToKeySessionPromise[t];if(!n){const t=qi(e.keyFormat),n=t?[t]:Wi(this.config);return this.attemptKeySystemAccess(n)}return n}getKeySystemSelectionPromise(e){if(e.length||(e=Wi(this.config)),0===e.length)throw new Co({type:Be.KEY_SYSTEM_ERROR,details:Ue.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${In({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}attemptSetMediaKeys(e,t){if(this.mediaKeys===t)return Promise.resolve();const n=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const i=Promise.all(n).then(()=>{if(!this.media)throw this.mediaKeys=null,new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(t)});return this.mediaKeys=t,this.setMediaKeysQueue.push(i),i.then(()=>{this.log(`Media-keys set for "${e}"`),n.push(i),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(e=>-1===n.indexOf(e))})}generateRequestWithPreferredKeySession(e,t,n,i){var r;const s=null==(r=this.config.drmSystems)||null==(r=r[e.keySystem])?void 0:r.generateRequest;if(s)try{const i=s.call(this.hls,t,n,e);if(!i)throw new Error("Invalid response from configured generateRequest filter");t=i.initDataType,n=i.initData?i.initData:null,e.decryptdata.pssh=n?new Uint8Array(n):null}catch(e){if(this.warn(e.message),this.hls&&this.hls.config.debug)throw e}if(null===n)return this.log(`Skipping key-session request for "${i}" (no initData)`),Promise.resolve(e);const a=Ro(e.decryptdata),o=e.decryptdata.uri;this.log(`Generating key-session request for "${i}" keyId: ${a} URI: ${o} (init data type: ${t} length: ${n.byteLength})`);const l=new Zr,c=e._onmessage=t=>{const n=e.mediaKeysSession;if(!n)return void l.emit("error",new Error("invalid state"));const{messageType:i,message:r}=t;this.log(`"${i}" message event for session "${n.sessionId}" message size: ${r.byteLength}`),"license-request"===i||"license-renewal"===i?this.renewLicense(e,r).catch(e=>{l.eventNames().length?l.emit("error",e):this.handleError(e)}):"license-release"===i?e.keySystem===$i.FAIRPLAY&&this.updateKeySession(e,Fi("acknowledged")).then(()=>this.removeSession(e)).catch(e=>this.handleError(e)):this.warn(`unhandled media key message type "${i}"`)},u=(e,t)=>{let n;t.keyStatus=e,e.startsWith("usable")?l.emit("resolved"):"internal-error"===e||"output-restricted"===e||"output-downscaled"===e?n=Do(e,t.decryptdata):"expired"===e?n=new Error(`key expired (keyId: ${a})`):"released"===e?n=new Error("key released"):"status-pending"===e||this.warn(`unhandled key status change "${e}" (keyId: ${a})`),n&&(l.eventNames().length?l.emit("error",n):this.handleError(n))},h=e._onkeystatuseschange=t=>{if(!e.mediaKeysSession)return void l.emit("error",new Error("invalid state"));const n=this.getKeyStatuses(e);if(!Object.keys(n).some(e=>"status-pending"!==n[e]))return;if("expired"===n[a])return this.log(`Expired key ${In(n)} in key-session "${e.mediaKeysSession.sessionId}"`),void this.renewKeySession(e);let i=n[a];if(i)u(i,e);else{var r;const t=0;e.keyStatusTimeouts||(e.keyStatusTimeouts={}),(r=e.keyStatusTimeouts)[a]||(r[a]=self.setTimeout(()=>{if(!e.mediaKeysSession||!this.mediaKeys)return;const n=this.getKeyStatus(e.decryptdata);if(n&&"status-pending"!==n)return this.log(`No status for keyId ${a} in key-session "${e.mediaKeysSession.sessionId}". Using session key-status ${n} from other session.`),u(n,e);this.log(`key status for ${a} in key-session "${e.mediaKeysSession.sessionId}" timed out after ${t}ms`),i="internal-error",u(i,e)},t)),this.log(`No status for keyId ${a} (${In(n)}).`)}};Dr(e.mediaKeysSession,"message",c),Dr(e.mediaKeysSession,"keystatuseschange",h);const d=new Promise((e,t)=>{l.on("error",t),l.on("resolved",e)});return e.mediaKeysSession.generateRequest(t,n).then(()=>{this.log(`Request generated for key-session "${e.mediaKeysSession.sessionId}" keyId: ${a} URI: ${o}`)}).catch(t=>{throw new Co({type:Be.KEY_SYSTEM_ERROR,details:Ue.KEY_SYSTEM_NO_SESSION,error:t,decryptdata:e.decryptdata,fatal:!1},`Error generating key-session request: ${t}`)}).then(()=>d).catch(t=>(l.removeAllListeners(),this.removeSession(e).then(()=>{throw t}))).then(()=>(l.removeAllListeners(),e))}getKeyStatuses(e){const t={};return e.mediaKeysSession.keyStatuses.forEach((n,i)=>{if("string"==typeof i&&"object"==typeof n){const e=i;i=n,n=e}const r="buffer"in i?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):new Uint8Array(i);e.keySystem===$i.PLAYREADY&&16===r.length&&Bi(r);const s=ut(r);"internal-error"===n&&(this.bannedKeyIds[s]=n),this.log(`key status change "${n}" for keyStatuses keyId: ${s} key-session "${e.mediaKeysSession.sessionId}"`),t[s]=n}),t}fetchServerCertificate(e){const t=this.config,n=new(0,t.loader)(t),i=this.getServerCertificateUrl(e);return i?(this.log(`Fetching server certificate for "${e}"`),new Promise((r,s)=>{const a={responseType:"arraybuffer",url:i},o=t.certLoadPolicy.default,l={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},c={onSuccess:(e,t,n,i)=>{r(e.data)},onError:(t,n,r,o)=>{s(new Co({type:Be.KEY_SYSTEM_ERROR,details:Ue.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:r,response:Je({url:a.url,data:void 0},t)},`"${e}" certificate request failed (${i}). Status: ${t.code} (${t.text})`))},onTimeout:(t,n,r)=>{s(new Co({type:Be.KEY_SYSTEM_ERROR,details:Ue.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:r,response:{url:a.url,data:void 0}},`"${e}" certificate request timed out (${i})`))},onAbort:(e,t,n)=>{s(new Error("aborted"))}};n.load(a,l,c)})):Promise.resolve()}setMediaKeysServerCertificate(e,t,n){return new Promise((i,r)=>{e.setServerCertificate(n).then(r=>{this.log(`setServerCertificate ${r?"success":"not supported by CDM"} (${n.byteLength}) on "${t}"`),i(e)}).catch(e=>{r(new Co({type:Be.KEY_SYSTEM_ERROR,details:Ue.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:e,fatal:!0},e.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(t=>this.updateKeySession(e,new Uint8Array(t)).catch(t=>{throw new Co({type:Be.KEY_SYSTEM_ERROR,details:Ue.KEY_SYSTEM_SESSION_UPDATE_FAILED,decryptdata:e.decryptdata,error:t,fatal:!1},t.message)}))}unpackPlayReadyKeyMessage(e,t){const n=String.fromCharCode.apply(null,new Uint16Array(t.buffer));if(!n.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),t;const i=(new DOMParser).parseFromString(n,"application/xml"),r=i.querySelectorAll("HttpHeader");if(r.length>0){let t;for(let n=0,i=r.length;n<i;n++){var s,a;t=r[n];const i=null==(s=t.querySelector("name"))?void 0:s.textContent,o=null==(a=t.querySelector("value"))?void 0:a.textContent;i&&o&&e.setRequestHeader(i,o)}}const o=i.querySelector("Challenge"),l=null==o?void 0:o.textContent;if(!l)throw new Error("Cannot find <Challenge> in key message");return Fi(atob(l))}setupLicenseXHR(e,t,n,i){const r=this.config.licenseXhrSetup;return r?Promise.resolve().then(()=>{if(!n.decryptdata)throw new Error("Key removed");return r.call(this.hls,e,t,n,i)}).catch(s=>{if(!n.decryptdata)throw s;return e.open("POST",t,!0),r.call(this.hls,e,t,n,i)}).then(n=>(e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:n||i})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:i}))}requestLicense(e,t){const n=this.config.keyLoadPolicy.default;return new Promise((i,r)=>{const s=this.getLicenseServerUrlOrThrow(e.keySystem);this.log(`Sending license request to URL: ${s}`);const a=new XMLHttpRequest;a.responseType="arraybuffer",a.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return r(new Error("invalid state"));if(4===a.readyState)if(200===a.status){this._requestLicenseFailureCount=0;let t=a.response;this.log(`License received ${t instanceof ArrayBuffer?t.byteLength:t}`);const n=this.config.licenseResponseCallback;if(n)try{t=n.call(this.hls,a,s,e)}catch(e){this.error(e)}i(t)}else{const o=n.errorRetry,l=o?o.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>l||a.status>=400&&a.status<500)r(new Co({type:Be.KEY_SYSTEM_ERROR,details:Ue.KEY_SYSTEM_LICENSE_REQUEST_FAILED,decryptdata:e.decryptdata,fatal:!0,networkDetails:a,response:{url:s,data:void 0,code:a.status,text:a.statusText}},`License Request XHR failed (${s}). Status: ${a.status} (${a.statusText})`));else{const n=l-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${n} attempts left`),this.requestLicense(e,t).then(i,r)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=a,this.setupLicenseXHR(a,s,e,t).then(({xhr:t,licenseChallenge:n})=>{e.keySystem==$i.PLAYREADY&&(n=this.unpackPlayReadyKeyMessage(t,n)),t.send(n)}).catch(r)})}onDestroying(){this.unregisterListeners(),this._clear()}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const n=t.media;this.media=n,Dr(n,"encrypted",this.onMediaEncrypted),Dr(n,"waitingforkey",this.onWaitingForKey)}onMediaDetached(){const e=this.media;e&&(Pr(e,"encrypted",this.onMediaEncrypted),Pr(e,"waitingforkey",this.onWaitingForKey),this.media=null,this.mediaKeys=null)}_clear(){var e;if(this._requestLicenseFailureCount=0,this.keyIdToKeySessionPromise={},this.bannedKeyIds={},!this.mediaKeys&&!this.mediaKeySessions.length)return;const t=this.media,n=this.mediaKeySessions.slice();this.mediaKeySessions=[],this.mediaKeys=null,Qi.clearKeyUriToKeyIdMap();const i=n.length;Ao.CDMCleanupPromise=Promise.all(n.map(e=>this.removeSession(e)).concat((null==t||null==(e=t.setMediaKeys(null))?void 0:e.catch(e=>{this.log(`Could not clear media keys: ${e}`),this.hls&&this.hls.trigger($e.ERROR,{type:Be.OTHER_ERROR,details:Ue.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR,fatal:!1,error:new Error(`Could not clear media keys: ${e}`)})}))||Promise.resolve())).catch(e=>{this.log(`Could not close sessions and clear media keys: ${e}`),this.hls&&this.hls.trigger($e.ERROR,{type:Be.OTHER_ERROR,details:Ue.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close sessions and clear media keys: ${e}`)})}).then(()=>{i&&this.log("finished closing key sessions and clearing media keys")})}onManifestLoading(){this.keyFormatPromise=null,this.bannedKeyIds={}}onManifestLoaded(e,{sessionKeys:t}){if(t&&this.config.emeEnabled&&!this.keyFormatPromise){const e=t.reduce((e,t)=>(-1===e.indexOf(t.keyFormat)&&e.push(t.keyFormat),e),[]);this.log(`Selecting key-system from session-keys ${e.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(e)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:n,decryptdata:i}=e;if(t){this.log(`Remove licenses and keys and close session "${t.sessionId}" keyId: ${ut((null==i?void 0:i.keyId)||[])}`),e._onmessage&&(t.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(t.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),n&&n.readyState!==XMLHttpRequest.DONE&&n.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const r=this.mediaKeySessions.indexOf(e);r>-1&&this.mediaKeySessions.splice(r,1);const{keyStatusTimeouts:s}=e;s&&Object.keys(s).forEach(e=>self.clearTimeout(s[e]));const{drmSystemOptions:a}=this.config,o=function(e){var t;return!(!e||"persistent-license"!==e.sessionType&&(null==(t=e.sessionTypes)||!t.some(e=>"persistent-license"===e)))}(a)?new Promise((e,n)=>{self.setTimeout(()=>n(new Error("MediaKeySession.remove() timeout")),8e3),t.remove().then(e).catch(n)}):Promise.resolve();return o.catch(e=>{this.log(`Could not remove session: ${e}`),this.hls&&this.hls.trigger($e.ERROR,{type:Be.OTHER_ERROR,details:Ue.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR,fatal:!1,error:new Error(`Could not remove session: ${e}`)})}).then(()=>t.close()).catch(e=>{this.log(`Could not close session: ${e}`),this.hls&&this.hls.trigger($e.ERROR,{type:Be.OTHER_ERROR,details:Ue.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close session: ${e}`)})})}return Promise.resolve()}}function Ro(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(null===e.keyId)throw new Error("keyId is null");return ut(e.keyId)}function Io(e,t){return e.keyId&&t.mediaKeysSession.keyStatuses.has(e.keyId)?t.mediaKeysSession.keyStatuses.get(e.keyId):e.matches(t.decryptdata)?t.keyStatus:void 0}Ao.CDMCleanupPromise=void 0;class Co extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}function Do(e,t){const n="output-restricted"===e,i=n?Ue.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:Ue.KEY_SYSTEM_STATUS_INTERNAL_ERROR;return new Co({type:Be.KEY_SYSTEM_ERROR,details:i,fatal:!1,decryptdata:t},n?"HDCP level output restricted":`key status changed to "${e}"`)}function Po(e,t){let n;try{n=new Event("addtrack")}catch(e){n=document.createEvent("Event"),n.initEvent("addtrack",!1,!1)}n.track=e,t.dispatchEvent(n)}function Oo(e,t){const n=e.mode;if("disabled"===n&&(e.mode="hidden"),e.cues&&!e.cues.getCueById(t.id))try{if(e.addCue(t),!e.cues.getCueById(t.id))throw new Error(`addCue is failed for: ${t}`)}catch(n){at.debug(`[texttrack-utils]: ${n}`);try{const n=new self.TextTrackCue(t.startTime,t.endTime,t.text);n.id=t.id,e.addCue(n)}catch(e){at.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${e}`)}}"disabled"===n&&(e.mode=n)}function No(e,t){const n=e.mode;if("disabled"===n&&(e.mode="hidden"),e.cues)for(let n=e.cues.length;n--;)t&&e.cues[n].removeEventListener("enter",t),e.removeCue(e.cues[n]);"disabled"===n&&(e.mode=n)}function Mo(e,t,n,i){const r=e.mode;if("disabled"===r&&(e.mode="hidden"),e.cues&&e.cues.length>0){const r=function(e,t,n){const i=[],r=function(e,t){if(t<=e[0].startTime)return 0;const n=e.length-1;if(t>e[n].endTime)return-1;let i,r=0,s=n;for(;r<=s;)if(i=Math.floor((s+r)/2),t<e[i].startTime)s=i-1;else{if(!(t>e[i].startTime&&r<n))return i;r=i+1}return e[r].startTime-t<t-e[s].startTime?r:s}(e,t);if(r>-1)for(let s=r,a=e.length;s<a;s++){const r=e[s];if(r.startTime>=t&&r.endTime<=n)i.push(r);else if(r.startTime>n)return i}return i}(e.cues,t,n);for(let t=0;t<r.length;t++)i&&!i(r[t])||e.removeCue(r[t])}"disabled"===r&&(e.mode=r)}function Fo(e){const t=[];for(let n=0;n<e.length;n++){const i=e[n];"subtitles"!==i.kind&&"captions"!==i.kind||!i.label||t.push(e[n])}return t}function Bo(e){let t=5381,n=e.length;for(;n;)t=33*t^e.charCodeAt(--n);return(t>>>0).toString()}const Uo=.025;let $o=function(e){return e[e.Point=0]="Point",e[e.Range=1]="Range",e}({});function jo(e,t,n){return`${e.identifier}-${n+1}-${Bo(t)}`}class zo{constructor(e,t){this.base=void 0,this._duration=null,this._timelineStart=null,this.appendInPlaceDisabled=void 0,this.appendInPlaceStarted=void 0,this.dateRange=void 0,this.hasPlayed=!1,this.cumulativeDuration=0,this.resumeOffset=NaN,this.playoutLimit=NaN,this.restrictions={skip:!1,jump:!1},this.snapOptions={out:!1,in:!1},this.assetList=[],this.assetListLoader=void 0,this.assetListResponse=null,this.resumeAnchor=void 0,this.error=void 0,this.resetOnResume=void 0,this.base=t,this.dateRange=e,this.setDateRange(e)}setDateRange(e){this.dateRange=e,this.resumeOffset=e.attr.optionalFloat("X-RESUME-OFFSET",this.resumeOffset),this.playoutLimit=e.attr.optionalFloat("X-PLAYOUT-LIMIT",this.playoutLimit),this.restrictions=e.attr.enumeratedStringList("X-RESTRICT",this.restrictions),this.snapOptions=e.attr.enumeratedStringList("X-SNAP",this.snapOptions)}reset(){var e;this.appendInPlaceStarted=!1,null==(e=this.assetListLoader)||e.destroy(),this.assetListLoader=void 0,this.supplementsPrimary||(this.assetListResponse=null,this.assetList=[],this._duration=null)}isAssetPastPlayoutLimit(e){var t;if(e>0&&e>=this.assetList.length)return!0;const n=this.playoutLimit;return!(e<=0||isNaN(n))&&(0===n||((null==(t=this.assetList[e])?void 0:t.startOffset)||0)>n)}findAssetIndex(e){return this.assetList.indexOf(e)}get identifier(){return this.dateRange.id}get startDate(){return this.dateRange.startDate}get startTime(){const e=this.dateRange.startTime;if(this.snapOptions.out){const t=this.dateRange.tagAnchor;if(t)return Go(e,t)}return e}get startOffset(){return this.cue.pre?0:this.startTime}get startIsAligned(){if(0===this.startTime||this.snapOptions.out)return!0;const e=this.dateRange.tagAnchor;if(e){const t=this.dateRange.startTime;return t-Go(t,e)<.1}return!1}get resumptionOffset(){const e=this.resumeOffset,t=Ne(e)?e:this.duration;return this.cumulativeDuration+t}get resumeTime(){const e=this.startOffset+this.resumptionOffset;if(this.snapOptions.in){const t=this.resumeAnchor;if(t)return Go(e,t)}return e}get appendInPlace(){return!!this.appendInPlaceStarted||!this.appendInPlaceDisabled&&!(this.cue.once||this.cue.pre||!this.startIsAligned||!(isNaN(this.playoutLimit)&&isNaN(this.resumeOffset)||this.resumeOffset&&this.duration&&Math.abs(this.resumeOffset-this.duration)<Uo))}set appendInPlace(e){this.appendInPlaceStarted?this.resetOnResume=!e:this.appendInPlaceDisabled=!e}get timelineStart(){return null!==this._timelineStart?this._timelineStart:this.startTime}set timelineStart(e){this._timelineStart=e}get duration(){const e=this.playoutLimit;let t;return t=null!==this._duration?this._duration:this.dateRange.duration?this.dateRange.duration:this.dateRange.plannedDuration||0,!isNaN(e)&&e<t&&(t=e),t}set duration(e){this._duration=e}get cue(){return this.dateRange.cue}get timelineOccupancy(){return"RANGE"===this.dateRange.attr["X-TIMELINE-OCCUPIES"]?$o.Range:$o.Point}get supplementsPrimary(){return"PRIMARY"===this.dateRange.attr["X-TIMELINE-STYLE"]}get contentMayVary(){return"NO"!==this.dateRange.attr["X-CONTENT-MAY-VARY"]}get assetUrl(){return this.dateRange.attr["X-ASSET-URI"]}get assetListUrl(){return this.dateRange.attr["X-ASSET-LIST"]}get baseUrl(){return this.base.url}get assetListLoaded(){return this.assetList.length>0||null!==this.assetListResponse}toString(){return`["${(e=this).identifier}" ${e.cue.pre?"<pre>":e.cue.post?"<post>":""}${e.timelineStart.toFixed(2)}-${e.resumeTime.toFixed(2)}]`;var e}}function Go(e,t){return e-t.start<t.duration/2&&!(Math.abs(e-(t.start+t.duration))<Uo)?t.start:t.start+t.duration}function Vo(e,t,n){const i=new self.URL(e,n);return"data:"!==i.protocol&&i.searchParams.set("_HLS_primary_id",t),i}function qo(e,t){for(;null!=(n=e.assetList[++t])&&n.error;)var n;return t}function Ho(e){const t=e.timelineStart,n=e.duration||0;return`["${e.identifier}" ${t.toFixed(2)}-${(t+n).toFixed(2)}]`}class Wo{constructor(e,t,n,i){this.hls=void 0,this.interstitial=void 0,this.assetItem=void 0,this.tracks=null,this.hasDetails=!1,this.mediaAttached=null,this._currentTime=void 0,this._bufferedEosTime=void 0,this.checkPlayout=()=>{this.reachedPlayout(this.currentTime)&&this.hls&&this.hls.trigger($e.PLAYOUT_LIMIT_REACHED,{})};const r=this.hls=new e(t);this.interstitial=n,this.assetItem=i;const s=()=>{this.hasDetails=!0};r.once($e.LEVEL_LOADED,s),r.once($e.AUDIO_TRACK_LOADED,s),r.once($e.SUBTITLE_TRACK_LOADED,s),r.on($e.MEDIA_ATTACHING,(e,{media:t})=>{this.removeMediaListeners(),this.mediaAttached=t,this.interstitial.playoutLimit&&(t.addEventListener("timeupdate",this.checkPlayout),this.appendInPlace&&r.on($e.BUFFER_APPENDED,()=>{const e=this.bufferedEnd;this.reachedPlayout(e)&&(this._bufferedEosTime=e,r.trigger($e.BUFFERED_TO_END,void 0))}))})}get appendInPlace(){return this.interstitial.appendInPlace}loadSource(){const e=this.hls;if(e)if(e.url)e.levels.length&&!e.started&&e.startLoad(-1,!0);else{let t=this.assetItem.uri;try{t=Vo(t,e.config.primarySessionId||"").href}catch(e){}e.loadSource(t)}}bufferedInPlaceToEnd(e){var t;if(!this.appendInPlace)return!1;if(null!=(t=this.hls)&&t.bufferedToEnd)return!0;if(!e)return!1;const n=Math.min(this._bufferedEosTime||1/0,this.duration),i=this.timelineOffset,r=bi.bufferInfo(e,i,0);return this.getAssetTime(r.end)>=n-.02}reachedPlayout(e){const t=this.interstitial.playoutLimit;return this.startOffset+e>=t}get destroyed(){var e;return!(null!=(e=this.hls)&&e.userConfig)}get assetId(){return this.assetItem.identifier}get interstitialId(){return this.assetItem.parentIdentifier}get media(){var e;return(null==(e=this.hls)?void 0:e.media)||null}get bufferedEnd(){const e=this.media||this.mediaAttached;if(!e)return this._bufferedEosTime?this._bufferedEosTime:this.currentTime;const t=bi.bufferInfo(e,e.currentTime,.001);return this.getAssetTime(t.end)}get currentTime(){const e=this.media||this.mediaAttached;return e?this.getAssetTime(e.currentTime):this._currentTime||0}get duration(){const e=this.assetItem.duration;if(!e)return 0;const t=this.interstitial.playoutLimit;if(t){const n=t-this.startOffset;if(n>0&&n<e)return n}return e}get remaining(){const e=this.duration;return e?Math.max(0,e-this.currentTime):0}get startOffset(){return this.assetItem.startOffset}get timelineOffset(){var e;return(null==(e=this.hls)?void 0:e.config.timelineOffset)||0}set timelineOffset(e){const t=this.timelineOffset;if(e!==t){const n=e-t;if(Math.abs(n)>1/9e4&&this.hls){if(this.hasDetails)throw new Error("Cannot set timelineOffset after playlists are loaded");this.hls.config.timelineOffset=e}}}getAssetTime(e){const t=this.timelineOffset,n=this.duration;return Math.min(Math.max(0,e-t),n)}removeMediaListeners(){const e=this.mediaAttached;e&&(this._currentTime=e.currentTime,this.bufferSnapShot(),e.removeEventListener("timeupdate",this.checkPlayout))}bufferSnapShot(){var e;this.mediaAttached&&null!=(e=this.hls)&&e.bufferedToEnd&&(this._bufferedEosTime=this.bufferedEnd)}destroy(){this.removeMediaListeners(),this.hls&&this.hls.destroy(),this.hls=null,this.tracks=this.mediaAttached=this.checkPlayout=null}attachMedia(e){var t;this.loadSource(),null==(t=this.hls)||t.attachMedia(e)}detachMedia(){var e;this.removeMediaListeners(),this.mediaAttached=null,null==(e=this.hls)||e.detachMedia()}resumeBuffering(){var e;null==(e=this.hls)||e.resumeBuffering()}pauseBuffering(){var e;null==(e=this.hls)||e.pauseBuffering()}transferMedia(){var e;return this.bufferSnapShot(),(null==(e=this.hls)?void 0:e.transferMedia())||null}resetDetails(){const e=this.hls;if(e&&this.hasDetails){e.stopLoad();const t=e=>delete e.details;e.levels.forEach(t),e.allAudioTracks.forEach(t),e.allSubtitleTracks.forEach(t),this.hasDetails=!1}}on(e,t,n){var i;null==(i=this.hls)||i.on(e,t)}once(e,t,n){var i;null==(i=this.hls)||i.once(e,t)}off(e,t,n){var i;null==(i=this.hls)||i.off(e,t)}toString(){var e;return`HlsAssetPlayer: ${Ho(this.assetItem)} ${null==(e=this.hls)?void 0:e.sessionId} ${this.appendInPlace?"append-in-place":""}`}}class Ko extends et{constructor(e,t){super("interstitials-sched",t),this.onScheduleUpdate=void 0,this.eventMap={},this.events=null,this.items=null,this.durations={primary:0,playout:0,integrated:0},this.onScheduleUpdate=e}destroy(){this.reset(),this.onScheduleUpdate=null}reset(){this.eventMap={},this.setDurations(0,0,0),this.events&&this.events.forEach(e=>e.reset()),this.events=this.items=null}resetErrorsInRange(e,t){return this.events?this.events.reduce((n,i)=>e<=i.startOffset&&t>i.startOffset?(delete i.error,n+1):n,0):0}get duration(){const e=this.items;return e?e[e.length-1].end:0}get length(){return this.items?this.items.length:0}getEvent(e){return e&&this.eventMap[e]||null}hasEvent(e){return e in this.eventMap}findItemIndex(e,t){if(e.event)return this.findEventIndex(e.event.identifier);let n=-1;e.nextEvent?n=this.findEventIndex(e.nextEvent.identifier)-1:e.previousEvent&&(n=this.findEventIndex(e.previousEvent.identifier)+1);const i=this.items;if(i)for(i[n]||(void 0===t&&(t=e.start),n=this.findItemIndexAtTime(t));n>=0&&null!=(r=i[n])&&r.event;){var r;n--}return n}findItemIndexAtTime(e,t){const n=this.items;if(n)for(let i=0;i<n.length;i++){let r=n[i];if(t&&"primary"!==t&&(r=r[t]),e===r.start||e>r.start&&e<r.end)return i}return-1}findJumpRestrictedIndex(e,t){const n=this.items;if(n)for(let i=e;i<=t&&n[i];i++){const e=n[i].event;if(null!=e&&e.restrictions.jump&&!e.appendInPlace)return i}return-1}findEventIndex(e){const t=this.items;if(t)for(let i=t.length;i--;){var n;if((null==(n=t[i].event)?void 0:n.identifier)===e)return i}return-1}findAssetIndex(e,t){const n=e.assetList,i=n.length;if(i>1)for(let e=0;e<i;e++){const r=n[e];if(!r.error){const n=r.timelineStart;if(t===n||t>n&&(t<n+(r.duration||0)||e===i-1))return e}}return 0}get assetIdAtEnd(){var e;const t=null==(e=this.items)||null==(e=e[this.length-1])?void 0:e.event;if(t){const e=t.assetList,n=e[e.length-1];if(n)return n.identifier}return null}parseInterstitialDateRanges(e,t){const n=e.main.details,{dateRanges:i}=n,r=this.events,s=this.parseDateRanges(i,{url:n.url},t),a=Object.keys(i),o=r?r.filter(e=>!a.includes(e.identifier)):[];s.length&&s.sort((e,t)=>{const n=e.cue.pre,i=e.cue.post,r=t.cue.pre,s=t.cue.post;if(n&&!r)return-1;if(r&&!n)return 1;if(i&&!s)return 1;if(s&&!i)return-1;if(!(n||r||i||s)){const n=e.startTime,i=t.startTime;if(n!==i)return n-i}return e.dateRange.tagOrder-t.dateRange.tagOrder}),this.events=s,o.forEach(e=>{this.removeEvent(e)}),this.updateSchedule(e,o)}updateSchedule(e,t=[],n=!1){const i=this.events||[];if(i.length||t.length||this.length<2){const r=this.items,s=this.parseSchedule(i,e);(n||t.length||(null==r?void 0:r.length)!==s.length||s.some((e,t)=>Math.abs(e.playout.start-r[t].playout.start)>.005||Math.abs(e.playout.end-r[t].playout.end)>.005))&&(this.items=s,this.onScheduleUpdate(t,r))}}parseDateRanges(e,t,n){const i=[],r=Object.keys(e);for(let s=0;s<r.length;s++){const a=r[s],o=e[a];if(o.isInterstitial){let e=this.eventMap[a];e?e.setDateRange(o):(e=new zo(o,t),this.eventMap[a]=e,!1===n&&(e.appendInPlace=n)),i.push(e)}}return i}parseSchedule(e,t){const n=[],i=t.main.details,r=i.live?1/0:i.edge;let s=0;if((e=e.filter(e=>!(e.error||e.cue.once&&e.hasPlayed))).length){this.resolveOffsets(e,t);let i=0,o=0;if(e.forEach((t,a)=>{const l=t.cue.pre,c=t.cue.post,u=e[a-1]||null,h=t.appendInPlace,d=c?r:t.startOffset,f=t.duration,p=t.timelineOccupancy===$o.Range?f:0,g=t.resumptionOffset,m=(null==u?void 0:u.startTime)===d,v=d+t.cumulativeDuration;let y=h?v+f:d+g;if(l||!c&&d<=0){const e=o;o+=p,t.timelineStart=v;const i=s;s+=f,n.push({event:t,start:v,end:y,playout:{start:i,end:s},integrated:{start:e,end:o}})}else{if(!(d<=r))return;{if(!m){const r=d-i;if(r>.033){const l=i,c=o;o+=r;const u=s;s+=r;const h={previousEvent:e[a-1]||null,nextEvent:t,start:l,end:l+r,playout:{start:u,end:s},integrated:{start:c,end:o}};n.push(h)}else r>0&&u&&(u.cumulativeDuration+=r,n[n.length-1].end=d)}c&&(y=v),t.timelineStart=v;const r=o;o+=p;const l=s;s+=f,n.push({event:t,start:v,end:y,playout:{start:l,end:s},integrated:{start:r,end:o}})}}const b=t.resumeTime;i=c||b>r?r:b}),i<r){var a;const e=i,t=o,l=r-i;o+=l;const c=s;s+=l,n.push({previousEvent:(null==(a=n[n.length-1])?void 0:a.event)||null,nextEvent:null,start:i,end:e+l,playout:{start:c,end:s},integrated:{start:t,end:o}})}this.setDurations(r,s,o)}else{const e=0;n.push({previousEvent:null,nextEvent:null,start:e,end:r,playout:{start:e,end:r},integrated:{start:e,end:r}}),this.setDurations(r,r,r)}return n}setDurations(e,t,n){this.durations={primary:e,playout:t,integrated:n}}resolveOffsets(e,t){const n=t.main.details,i=n.live?1/0:n.edge;let r=0,s=-1;e.forEach((a,o)=>{const l=a.cue.pre,c=a.cue.post,u=l?0:c?i:a.startTime;this.updateAssetDurations(a),s===u?a.cumulativeDuration=r:(r=0,s=u),!c&&a.snapOptions.in&&(a.resumeAnchor=$n(null,n.fragments,a.startOffset+a.resumptionOffset,0,0)||void 0),a.appendInPlace&&!a.appendInPlaceStarted&&(this.primaryCanResumeInPlaceAt(a,t)||(a.appendInPlace=!1)),!a.appendInPlace&&o+1<e.length&&e[o+1].startTime-e[o].resumeTime<.033&&(e[o+1].appendInPlace=!1,e[o+1].appendInPlace&&this.warn(`Could not change append strategy for abutting event ${a}`));const h=Ne(a.resumeOffset)?a.resumeOffset:a.duration;r+=h})}primaryCanResumeInPlaceAt(e,t){const n=e.resumeTime,i=e.startTime+e.resumptionOffset;return Math.abs(n-i)>Uo?(this.log(`"${e.identifier}" resumption ${n} not aligned with estimated timeline end ${i}`),!1):!Object.keys(t).some(i=>{const r=t[i].details,s=r.edge;if(n>=s)return this.log(`"${e.identifier}" resumption ${n} past ${i} playlist end ${s}`),!1;const a=$n(null,r.fragments,n);if(!a)return this.log(`"${e.identifier}" resumption ${n} does not align with any fragments in ${i} playlist (${r.fragStart}-${r.fragmentEnd})`),!0;const o="audio"===i?.175:0;return!(Math.abs(a.start-n)<Uo+o||Math.abs(a.end-n)<Uo+o||(this.log(`"${e.identifier}" resumption ${n} not aligned with ${i} fragment bounds (${a.start}-${a.end} sn: ${a.sn} cc: ${a.cc})`),0))})}updateAssetDurations(e){if(!e.assetListLoaded)return;const t=e.timelineStart;let n=0,i=!1,r=!1;for(let s=0;s<e.assetList.length;s++){const a=e.assetList[s],o=t+n;a.startOffset=n,a.timelineStart=o,i||(i=null===a.duration),r||(r=!!a.error),n+=a.error?0:a.duration||0}e.duration=i&&!r?Math.max(n,e.duration):n}removeEvent(e){e.reset(),delete this.eventMap[e.identifier]}}function Yo(e){return`[${e.event?'"'+e.event.identifier+'"':"primary"}: ${e.start.toFixed(2)}-${e.end.toFixed(2)}]`}class Xo{constructor(e){this.hls=void 0,this.hls=e}destroy(){this.hls=null}loadAssetList(e,t){const n=e.assetListUrl;let i;try{i=Vo(n,this.hls.sessionId,e.baseUrl)}catch(t){const i=this.assignAssetListError(e,Ue.ASSET_LIST_LOAD_ERROR,t,n);return void this.hls.trigger($e.ERROR,i)}t&&"data:"!==i.protocol&&i.searchParams.set("_HLS_start_offset",""+t);const r=this.hls.config,s=new(0,r.loader)(r),a={responseType:"json",url:i.href},o=r.interstitialAssetListLoadPolicy.default,l={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},c={onSuccess:(t,n,i,r)=>{const s=t.data,a=null==s?void 0:s.ASSETS;if(!Array.isArray(a)){const t=this.assignAssetListError(e,Ue.ASSET_LIST_PARSING_ERROR,new Error("Invalid interstitial asset list"),i.url,n,r);return void this.hls.trigger($e.ERROR,t)}e.assetListResponse=s,this.hls.trigger($e.ASSET_LIST_LOADED,{event:e,assetListResponse:s,networkDetails:r})},onError:(t,n,i,r)=>{const s=this.assignAssetListError(e,Ue.ASSET_LIST_LOAD_ERROR,new Error(`Error loading X-ASSET-LIST: HTTP status ${t.code} ${t.text} (${n.url})`),n.url,r,i);this.hls.trigger($e.ERROR,s)},onTimeout:(t,n,i)=>{const r=this.assignAssetListError(e,Ue.ASSET_LIST_LOAD_TIMEOUT,new Error(`Timeout loading X-ASSET-LIST (${n.url})`),n.url,t,i);this.hls.trigger($e.ERROR,r)}};return s.load(a,l,c),this.hls.trigger($e.ASSET_LIST_LOADING,{event:e}),s}assignAssetListError(e,t,n,i,r,s){return e.error=n,{type:Be.NETWORK_ERROR,details:t,fatal:!1,interstitial:e,url:i,error:n,networkDetails:s,stats:r}}}function Qo(e){null==e||e.play().catch(()=>{})}function Zo(e,t){return`[${e}] Advancing timeline position to ${t}`}class Jo{constructor(e){this.buffered=void 0;const t=(t,n,i)=>{if((n>>>=0)>i-1)throw new DOMException(`Failed to execute '${t}' on 'TimeRanges': The index provided (${n}) is greater than the maximum bound (${i})`);return e[n][t]};this.buffered={get length(){return e.length},end:n=>t("end",n,e.length),start:n=>t("start",n,e.length)}}}const el={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},tl=e=>String.fromCharCode(el[e]||e),nl=15,il=100,rl={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},sl={17:2,18:4,21:6,22:8,23:10,19:13,20:15},al={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},ol={25:2,26:4,29:6,30:8,31:10,27:13,28:15},ll=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class cl{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const n="function"==typeof t?t():t;at.log(`${this.time} [${e}] ${n}`)}}}const ul=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].toString(16));return t};class hl{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let n=0;n<t.length;n++){const i=t[n];e.hasOwnProperty(i)&&(this[i]=e[i])}}isDefault(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class dl{constructor(){this.uchar=" ",this.penState=new hl}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return" "===this.uchar&&this.penState.isDefault()}}class fl{constructor(e){this.chars=[],this.pos=0,this.currPenState=new hl,this.cueStartTime=null,this.logger=void 0;for(let e=0;e<il;e++)this.chars.push(new dl);this.logger=e}equals(e){for(let t=0;t<il;t++)if(!this.chars[t].equals(e.chars[t]))return!1;return!0}copy(e){for(let t=0;t<il;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<il;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>il&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=il)}moveCursor(e){const t=this.pos+e;if(e>1)for(let e=this.pos+1;e<t+1;e++)this.chars[e].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=tl(e);this.pos>=il?this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))}clearFromPos(e){let t;for(t=e;t<il;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let n=0;n<il;n++){const i=this.chars[n].uchar;" "!==i&&(t=!1),e.push(i)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class pl{constructor(e){this.rows=[],this.currRow=14,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let t=0;t<nl;t++)this.rows.push(new fl(e));this.logger=e}reset(){for(let e=0;e<nl;e++)this.rows[e].clear();this.currRow=14}equals(e){let t=!0;for(let n=0;n<nl;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t}copy(e){for(let t=0;t<nl;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<nl;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+In(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let e=0;e<nl;e++)this.rows[e].clear();const e=this.currRow+1-this.nrRollUpRows,n=this.lastOutputScreen;if(n){const i=n.rows[e].cueStartTime,r=this.logger.time;if(null!==i&&null!==r&&i<r)for(let i=0;i<this.nrRollUpRows;i++)this.rows[t-this.nrRollUpRows+i+1].copy(n.rows[e+i])}}this.currRow=t;const n=this.rows[this.currRow];if(null!==e.indent){const t=e.indent,i=Math.max(t-1,0);n.setCursor(e.indent),e.color=n.chars[i].penState.foreground}const i={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(i)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+In(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(null===this.nrRollUpRows)return void this.logger.log(3,"roll_up but nrRollUpRows not set yet");this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let n="",i=-1;for(let n=0;n<nl;n++){const r=this.rows[n].getTextString();r&&(i=n+1,e?t.push("Row "+i+": '"+r+"'"):t.push(r.trim()))}return t.length>0&&(n=e?"["+t.join(" | ")+"]":t.join("\n")),n}getTextAndFormat(){return this.rows}}class gl{constructor(e,t,n){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new pl(n),this.nonDisplayedMemory=new pl(n),this.lastOutputScreen=new pl(n),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=n}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),"MODE_POP-ON"===this.mode){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2==1,t.italics=e>=46,t.italics)t.foreground="white";else{const n=Math.floor(e/2)-16,i=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=i[n]}this.logger.log(2,"MIDROW: "+In(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;null!==t&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class ml{constructor(e,t,n){this.channels=void 0,this.currentChannel=0,this.cmdHistory={a:null,b:null},this.logger=void 0;const i=this.logger=new cl;this.channels=[null,new gl(e,t,i),new gl(e+1,n,i)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){this.logger.time=e;for(let e=0;e<t.length;e+=2){const n=127&t[e],i=127&t[e+1];let r=!1,s=null;if(0===n&&0===i)continue;this.logger.log(3,()=>"["+ul([t[e],t[e+1]])+"] -> ("+ul([n,i])+")");const a=this.cmdHistory;if(n>=16&&n<=31){if(yl(n,i,a)){vl(null,null,a),this.logger.log(3,()=>"Repeated command ("+ul([n,i])+") is dropped");continue}vl(n,i,this.cmdHistory),r=this.parseCmd(n,i),r||(r=this.parseMidrow(n,i)),r||(r=this.parsePAC(n,i)),r||(r=this.parseBackgroundAttributes(n,i))}else vl(null,null,a);if(!r&&(s=this.parseChars(n,i),s)){const e=this.currentChannel;e&&e>0?this.channels[e].insertChars(s):this.logger.log(2,"No channel found yet. TEXT-MODE?")}r||s||this.logger.log(2,()=>"Couldn't parse cleaned data "+ul([n,i])+" orig: "+ul([t[e],t[e+1]]))}}parseCmd(e,t){if(!((20===e||28===e||21===e||29===e)&&t>=32&&t<=47||(23===e||31===e)&&t>=33&&t<=35))return!1;const n=20===e||21===e||23===e?1:2,i=this.channels[n];return 20===e||21===e||28===e||29===e?32===t?i.ccRCL():33===t?i.ccBS():34===t?i.ccAOF():35===t?i.ccAON():36===t?i.ccDER():37===t?i.ccRU(2):38===t?i.ccRU(3):39===t?i.ccRU(4):40===t?i.ccFON():41===t?i.ccRDC():42===t?i.ccTR():43===t?i.ccRTD():44===t?i.ccEDM():45===t?i.ccCR():46===t?i.ccENM():47===t&&i.ccEOC():i.ccTO(t-32),this.currentChannel=n,!0}parseMidrow(e,t){let n=0;if((17===e||25===e)&&t>=32&&t<=47){if(n=17===e?1:2,n!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const i=this.channels[n];return!!i&&(i.ccMIDROW(t),this.logger.log(3,()=>"MIDROW ("+ul([e,t])+")"),!0)}return!1}parsePAC(e,t){let n;if(!((e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127||(16===e||24===e)&&t>=64&&t<=95))return!1;const i=e<=23?1:2;n=t>=64&&t<=95?1===i?rl[e]:al[e]:1===i?sl[e]:ol[e];const r=this.channels[i];return!!r&&(r.setPAC(this.interpretPAC(n,t)),this.currentChannel=i,!0)}interpretPAC(e,t){let n;const i={color:null,italics:!1,indent:null,underline:!1,row:e};return n=t>95?t-96:t-64,i.underline=!(1&~n),n<=13?i.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(i.italics=!0,i.color="white"):i.indent=4*Math.floor((n-16)/2),i}parseChars(e,t){let n,i=null,r=null;if(e>=25?(n=2,r=e-8):(n=1,r=e),r>=17&&r<=19){let e;e=17===r?t+80:18===r?t+112:t+144,this.logger.log(2,()=>"Special char '"+tl(e)+"' in channel "+n),i=[e]}else e>=32&&e<=127&&(i=0===t?[e]:[e,t]);return i&&this.logger.log(3,()=>"Char codes =  "+ul(i).join(",")),i}parseBackgroundAttributes(e,t){if(!((16===e||24===e)&&t>=32&&t<=47||(23===e||31===e)&&t>=45&&t<=47))return!1;let n;const i={};16===e||24===e?(n=Math.floor((t-32)/2),i.background=ll[n],t%2==1&&(i.background=i.background+"_semi")):45===t?i.background="transparent":(i.foreground="black",47===t&&(i.underline=!0));const r=e<=23?1:2;return this.channels[r].setBkgData(i),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}vl(null,null,this.cmdHistory)}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const n=this.channels[t];n&&n.cueSplitAtTime(e)}}}function vl(e,t,n){n.a=e,n.b=t}function yl(e,t,n){return n.a===e&&n.b===t}var bl=function(){if(null!=Ui&&Ui.VTTCue)return self.VTTCue;const e=["","lr","rl"],t=["start","middle","end","left","right"];function n(e,t){if("string"!=typeof t)return!1;if(!Array.isArray(e))return!1;const n=t.toLowerCase();return!!~e.indexOf(n)&&n}function i(e){return n(t,e)}function r(e,...t){let n=1;for(;n<arguments.length;n++){const t=arguments[n];for(const n in t)e[n]=t[n]}return e}function s(t,s,a){const o=this,l={enumerable:!0};o.hasBeenReset=!1;let c="",u=!1,h=t,d=s,f=a,p=null,g="",m=!0,v="auto",y="start",b=50,E="middle",S=50,w="middle";Object.defineProperty(o,"id",r({},l,{get:function(){return c},set:function(e){c=""+e}})),Object.defineProperty(o,"pauseOnExit",r({},l,{get:function(){return u},set:function(e){u=!!e}})),Object.defineProperty(o,"startTime",r({},l,{get:function(){return h},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");h=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"endTime",r({},l,{get:function(){return d},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");d=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"text",r({},l,{get:function(){return f},set:function(e){f=""+e,this.hasBeenReset=!0}})),Object.defineProperty(o,"region",r({},l,{get:function(){return p},set:function(e){p=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"vertical",r({},l,{get:function(){return g},set:function(t){const i=function(t){return n(e,t)}(t);if(!1===i)throw new SyntaxError("An invalid or illegal string was specified.");g=i,this.hasBeenReset=!0}})),Object.defineProperty(o,"snapToLines",r({},l,{get:function(){return m},set:function(e){m=!!e,this.hasBeenReset=!0}})),Object.defineProperty(o,"line",r({},l,{get:function(){return v},set:function(e){if("number"!=typeof e&&"auto"!==e)throw new SyntaxError("An invalid number or illegal string was specified.");v=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"lineAlign",r({},l,{get:function(){return y},set:function(e){const t=i(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");y=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"position",r({},l,{get:function(){return b},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");b=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"positionAlign",r({},l,{get:function(){return E},set:function(e){const t=i(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");E=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"size",r({},l,{get:function(){return S},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");S=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"align",r({},l,{get:function(){return w},set:function(e){const t=i(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");w=t,this.hasBeenReset=!0}})),o.displayState=void 0}return s.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},s}();class El{decode(e,t){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function Sl(e){function t(e,t,n,i){return 3600*(0|e)+60*(0|t)+(0|n)+parseFloat(i||0)}const n=e.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return n?parseFloat(n[2])>59?t(n[2],n[3],0,n[4]):t(n[1],n[2],n[3],n[4]):null}class wl{constructor(){this.values=Object.create(null)}set(e,t){this.get(e)||""===t||(this.values[e]=t)}get(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,n){for(let i=0;i<n.length;++i)if(t===n[i]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const n=parseFloat(t);if(n>=0&&n<=100)return this.set(e,n),!0}return!1}}function Tl(e,t,n,i){const r=i?e.split(i):[e];for(const e in r){if("string"!=typeof r[e])continue;const i=r[e].split(n);2===i.length&&t(i[0],i[1])}}const kl=new bl(0,0,""),_l="middle"===kl.align?"middle":"center";function xl(e,t,n){const i=e;function r(){const t=Sl(e);if(null===t)throw new Error("Malformed timestamp: "+i);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function s(){e=e.replace(/^\s+/,"")}if(s(),t.startTime=r(),s(),"--\x3e"!==e.slice(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+i);e=e.slice(3),s(),t.endTime=r(),s(),function(e,t){const i=new wl;Tl(e,function(e,t){let r;switch(e){case"region":for(let r=n.length-1;r>=0;r--)if(n[r].id===t){i.set(e,n[r].region);break}break;case"vertical":i.alt(e,t,["rl","lr"]);break;case"line":r=t.split(","),i.integer(e,r[0]),i.percent(e,r[0])&&i.set("snapToLines",!1),i.alt(e,r[0],["auto"]),2===r.length&&i.alt("lineAlign",r[1],["start",_l,"end"]);break;case"position":r=t.split(","),i.percent(e,r[0]),2===r.length&&i.alt("positionAlign",r[1],["start",_l,"end","line-left","line-right","auto"]);break;case"size":i.percent(e,t);break;case"align":i.alt(e,t,["start",_l,"end","left","right"])}},/:/,/\s/),t.region=i.get("region",null),t.vertical=i.get("vertical","");let r=i.get("line","auto");"auto"===r&&-1===kl.line&&(r=-1),t.line=r,t.lineAlign=i.get("lineAlign","start"),t.snapToLines=i.get("snapToLines",!0),t.size=i.get("size",100),t.align=i.get("align",_l);let s=i.get("position","auto");"auto"===s&&50===kl.position&&(s="start"===t.align||"left"===t.align?0:"end"===t.align||"right"===t.align?100:50),t.position=s}(e,t)}function Ll(e){return e.replace(/<br(?: \/)?>/gi,"\n")}class Al{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new El,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;function n(){let e=t.buffer,n=0;for(e=Ll(e);n<e.length&&"\r"!==e[n]&&"\n"!==e[n];)++n;const i=e.slice(0,n);return"\r"===e[n]&&++n,"\n"===e[n]&&++n,t.buffer=e.slice(n),i}function i(e){Tl(e,function(e,t){},/:/)}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{let e="";if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;e=n();const i=e.match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(null==i||!i[0])throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let r=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(r?r=!1:e=n(),t.state){case"HEADER":/:/.test(e)?i(e):e||(t.state="ID");continue;case"NOTE":e||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(e)){t.state="NOTE";break}if(!e)continue;if(t.cue=new bl(0,0,""),t.state="CUE",-1===e.indexOf("--\x3e")){t.cue.id=e;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{xl(e,t.cue,t.regionList)}catch(e){t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const n=-1!==e.indexOf("--\x3e");if(!e||n&&(r=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(null===t.cue)continue;t.cue.text&&(t.cue.text+="\n"),t.cue.text+=e}continue;case"BADCUE":e||(t.state="ID")}}}catch(e){"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||"HEADER"===e.state)&&(e.buffer+="\n\n",e.parse()),"INITIAL"===e.state||"BADWEBVTT"===e.state)throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}const Rl=/\r\n|\n\r|\n|\r/g,Il=function(e,t,n=0){return e.slice(n,n+t.length)===t};function Cl(e,t,n){return Bo(e.toString())+Bo(t.toString())+Bo(n)}const Dl="stpp.ttml.im1t",Pl=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,Ol=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,Nl={left:"start",center:"center",right:"end",start:"start",end:"end"};function Ml(e,t,n,i){const r=Bt(new Uint8Array(e),["mdat"]);if(0===r.length)return void i(new Error("Could not parse IMSC1 mdat"));const s=r.map(e=>ct(e)),a=function(e,t,n=1,i=!1){return ta(e,t,1/n,i)}(t.baseTime,1,t.timescale);try{s.forEach(e=>n(function(e,t){const n=(new DOMParser).parseFromString(e,"text/xml").getElementsByTagName("tt")[0];if(!n)throw new Error("Invalid ttml");const i={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},r=Object.keys(i).reduce((e,t)=>(e[t]=n.getAttribute(`ttp:${t}`)||i[t],e),{}),s="preserve"!==n.getAttribute("xml:space"),a=Bl(Fl(n,"styling","style")),o=Bl(Fl(n,"layout","region")),l=Fl(n,"body","[begin]");return[].map.call(l,e=>{const n=Ul(e,s);if(!n||!e.hasAttribute("begin"))return null;const i=zl(e.getAttribute("begin"),r),l=zl(e.getAttribute("dur"),r);let c=zl(e.getAttribute("end"),r);if(null===i)throw jl(e);if(null===c){if(null===l)throw jl(e);c=i+l}const u=new bl(i-t,c-t,n);u.id=Cl(u.startTime,u.endTime,u.text);const h=function(e,t,n){const i="http://www.w3.org/ns/ttml#styling";let r=null;const s=null!=e&&e.hasAttribute("style")?e.getAttribute("style"):null;return s&&n.hasOwnProperty(s)&&(r=n[s]),["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"].reduce((n,s)=>{const a=$l(t,i,s)||$l(e,i,s)||$l(r,i,s);return a&&(n[s]=a),n},{})}(o[e.getAttribute("region")],a[e.getAttribute("style")],a),{textAlign:d}=h;if(d){const e=Nl[d];e&&(u.lineAlign=e),u.align=d}return Qe(u,h),u}).filter(e=>null!==e)}(e,a)))}catch(e){i(e)}}function Fl(e,t,n){const i=e.getElementsByTagName(t)[0];return i?[].slice.call(i.querySelectorAll(n)):[]}function Bl(e){return e.reduce((e,t)=>{const n=t.getAttribute("xml:id");return n&&(e[n]=t),e},{})}function Ul(e,t){return[].slice.call(e.childNodes).reduce((e,n,i)=>{var r;return"br"===n.nodeName&&i?e+"\n":null!=(r=n.childNodes)&&r.length?Ul(n,t):t?e+n.textContent.trim().replace(/\s+/g," "):e+n.textContent},"")}function $l(e,t,n){return e&&e.hasAttributeNS(t,n)?e.getAttributeNS(t,n):null}function jl(e){return new Error(`Could not parse ttml timestamp ${e}`)}function zl(e,t){if(!e)return null;let n=Sl(e);return null===n&&(Pl.test(e)?n=function(e,t){const n=Pl.exec(e),i=(0|n[4])+(0|n[5])/t.subFrameRate;return 3600*(0|n[1])+60*(0|n[2])+(0|n[3])+i/t.frameRate}(e,t):Ol.test(e)&&(n=function(e,t){const n=Ol.exec(e),i=Number(n[1]);switch(n[2]){case"h":return 3600*i;case"m":return 60*i;case"ms":return 1e3*i;case"f":return i/t.frameRate;case"t":return i/t.tickRate}return i}(e,t))),n}class Gl{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,n){(null===this.startTime||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=n,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}function Vl(e){return e.characteristics&&/transcribes-spoken-dialog/gi.test(e.characteristics)&&/describes-music-and-sound/gi.test(e.characteristics)?"captions":"subtitles"}function ql(e,t){return!!e&&e.kind===Vl(t)&&ka(t,e)}function Hl(e,t,n,i){return Math.min(t,i)-Math.max(e,n)}const Wl=/\s/,Kl={newCue(e,t,n,i){const r=[];let s,a,o,l,c;const u=self.VTTCue||self.TextTrackCue;for(let d=0;d<i.rows.length;d++)if(s=i.rows[d],o=!0,l=0,c="",!s.isEmpty()){var h;for(let e=0;e<s.chars.length;e++)Wl.test(s.chars[e].uchar)&&o?l++:(c+=s.chars[e].uchar,o=!1);s.cueStartTime=t,t===n&&(n+=1e-4),l>=16?l--:l++;const i=Ll(c.trim()),f=Cl(t,n,i);null!=e&&null!=(h=e.cues)&&h.getCueById(f)||(a=new u(t,n,i),a.id=f,a.line=d+1,a.align="left",a.position=10+Math.min(80,10*Math.floor(8*l/32)),r.push(a))}return e&&r.length&&(r.sort((e,t)=>"auto"===e.line||"auto"===t.line?0:e.line>8&&t.line>8?t.line-e.line:e.line-t.line),r.forEach(t=>Oo(e,t))),r}},Yl=/(\d+)-(\d+)\/(\d+)/;class Xl{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||Ql,this.controller=new self.AbortController,this.stats=new St}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),null!=(e=this.callbacks)&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,n){const i=this.stats;if(i.loading.start)throw new Error("Loader can only be used once.");i.loading.start=self.performance.now();const r=function(e,t){const n={method:"GET",mode:"cors",credentials:"same-origin",signal:t,headers:new self.Headers(Qe({},e.headers))};return e.rangeEnd&&n.headers.set("Range","bytes="+e.rangeStart+"-"+String(e.rangeEnd-1)),n}(e,this.controller.signal),s="arraybuffer"===e.responseType,a=s?"byteLength":"length",{maxTimeToFirstByteMs:o,maxLoadTimeMs:l}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=n,this.request=this.fetchSetup(e,r),self.clearTimeout(this.requestTimeout),t.timeout=o&&Ne(o)?o:l,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(i,e,this.response))},t.timeout),(ma(this.request)?this.request.then(self.fetch):self.fetch(this.request)).then(n=>{var r;this.response=this.loader=n;const a=Math.max(self.performance.now(),i.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=l,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(i,e,this.response))},l-(a-i.loading.start)),!n.ok){const{status:e,statusText:t}=n;throw new Zl(t||"fetch, bad network response",e,n)}i.loading.first=a,i.total=function(e){const t=e.get("Content-Range");if(t){const e=function(e){const t=Yl.exec(e);if(t)return parseInt(t[2])-parseInt(t[1])+1}(t);if(Ne(e))return e}const n=e.get("Content-Length");if(n)return parseInt(n)}(n.headers)||i.total;const o=null==(r=this.callbacks)?void 0:r.onProgress;return o&&Ne(t.highWaterMark)?this.loadProgressively(n,i,e,t.highWaterMark,o):s?n.arrayBuffer():"json"===e.responseType?n.json():n.text()}).then(n=>{var r,s;const o=this.response;if(!o)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),i.loading.end=Math.max(self.performance.now(),i.loading.first);const l=n[a];l&&(i.loaded=i.total=l);const c={url:o.url,data:n,code:o.status},u=null==(r=this.callbacks)?void 0:r.onProgress;u&&!Ne(t.highWaterMark)&&u(i,e,n,o),null==(s=this.callbacks)||s.onSuccess(c,i,e,o)}).catch(t=>{var n;if(self.clearTimeout(this.requestTimeout),i.aborted)return;const r=t&&t.code||0,s=t?t.message:null;null==(n=this.callbacks)||n.onError({code:r,text:s},e,t?t.details:null,i)})}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,n,i=0,r){const s=new Kr,a=e.body.getReader(),o=()=>a.read().then(a=>{if(a.done)return s.dataLength&&r(t,n,s.flush().buffer,e),Promise.resolve(new ArrayBuffer(0));const l=a.value,c=l.length;return t.loaded+=c,c<i||s.dataLength?(s.push(l),s.dataLength>=i&&r(t,n,s.flush().buffer,e)):r(t,n,l.buffer,e),o()}).catch(()=>Promise.reject());return o()}}function Ql(e,t){return new self.Request(e.url,t)}class Zl extends Error{constructor(e,t,n){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=n}}const Jl=/^age:\s*[\d.]+\s*$/im;class ec{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new St,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,4!==e.readyState&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),null!=(e=this.callbacks)&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,n){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=n,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e||!t)return;const n=this.loader=new self.XMLHttpRequest,i=this.stats;i.loading.first=0,i.loaded=0,i.aborted=!1;const r=this.xhrSetup;r?Promise.resolve().then(()=>{if(this.loader===n&&!this.stats.aborted)return r(n,t.url)}).catch(e=>{if(this.loader===n&&!this.stats.aborted)return n.open("GET",t.url,!0),r(n,t.url)}).then(()=>{this.loader!==n||this.stats.aborted||this.openAndSendXhr(n,t,e)}).catch(e=>{var r;null==(r=this.callbacks)||r.onError({code:n.status,text:e.message},t,n,i)}):this.openAndSendXhr(n,t,e)}openAndSendXhr(e,t,n){e.readyState||e.open("GET",t.url,!0);const i=t.headers,{maxTimeToFirstByteMs:r,maxLoadTimeMs:s}=n.loadPolicy;if(i)for(const t in i)e.setRequestHeader(t,i[t]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),n.timeout=r&&Ne(r)?r:s,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),n.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:n}=this;if(!e||!t)return;const i=t.readyState,r=this.config;if(!n.aborted&&i>=2&&(0===n.loading.first&&(n.loading.first=Math.max(self.performance.now(),n.loading.start),r.timeout!==r.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),r.timeout=r.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),r.loadPolicy.maxLoadTimeMs-(n.loading.first-n.loading.start)))),4===i)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const i=t.status,l="text"===t.responseType?t.responseText:null;if(i>=200&&i<300){const r=null!=l?l:t.response;if(null!=r){var s,a;n.loading.end=Math.max(self.performance.now(),n.loading.first);const o="arraybuffer"===t.responseType?r.byteLength:r.length;n.loaded=n.total=o,n.bwEstimate=8e3*n.total/(n.loading.end-n.loading.first);const l=null==(s=this.callbacks)?void 0:s.onProgress;l&&l(n,e,r,t);const c={url:t.responseURL,data:r,code:i};return void(null==(a=this.callbacks)||a.onSuccess(c,n,e,t))}}const c=r.loadPolicy.errorRetry;var o;Xn(c,n.retry,!1,{url:e.url,data:void 0,code:i})?this.retry(c):(at.error(`${i} while loading ${e.url}`),null==(o=this.callbacks)||o.onError({code:i,text:t.statusText},e,t,n))}}loadtimeout(){if(!this.config)return;const e=this.config.loadPolicy.timeoutRetry;if(Xn(e,this.stats.retry,!0))this.retry(e);else{var t;at.warn(`timeout while loading ${null==(t=this.context)?void 0:t.url}`);const e=this.callbacks;e&&(this.abortInternal(),e.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:n}=this;this.retryDelay=Kn(e,n.retry),n.retry++,at.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${null==t?void 0:t.url}, retrying ${n.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&Jl.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}const tc=Je(Je({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,maxDevicePixelRatio:Number.POSITIVE_INFINITY,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,startOnSegmentBoundary:!1,maxBufferSize:6e7,maxFragLookUpTolerance:.25,maxBufferHole:.1,detectStallWithCurrentTimeMs:1250,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,nudgeOnVideoHole:!0,liveSyncMode:"edge",liveSyncDurationCount:3,liveSyncOnStallIncrease:1,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,ignorePlaylistParsingErrors:!1,loader:ec,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:class extends et{constructor(e){super("abr",e.logger),this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.rebufferNotice=-1,this.supportedCache={},this.bwEstimator=void 0,this._abandonRulesCheck=e=>{var t;const{fragCurrent:n,partCurrent:i,hls:r}=this,{autoLevelEnabled:s,media:a}=r;if(!n||!a)return;const o=performance.now(),l=i?i.stats:n.stats,c=i?i.duration:n.duration,u=o-l.loading.start,h=r.minAutoLevel,d=n.level,f=this._nextAutoLevel;if(l.aborted||l.loaded&&l.loaded===l.total||d<=h)return this.clearTimer(),void(this._nextAutoLevel=-1);if(!s)return;const p=f>-1&&f!==d,g=!!e||p;if(!g&&(a.paused||!a.playbackRate||!a.readyState))return;const m=r.mainForwardBufferInfo;if(!g&&null===m)return;const v=this.bwEstimator.getEstimateTTFB(),y=Math.abs(a.playbackRate);if(u<=Math.max(v,c/(2*y)*1e3))return;const b=m?m.len/y:0,E=l.loading.first?l.loading.first-l.loading.start:-1,S=l.loaded&&E>-1,w=this.getBwEstimate(),T=r.levels,k=T[d],_=Math.max(l.loaded,Math.round(c*(n.bitrate||k.averageBitrate)/8));let x=S?u-E:u;x<1&&S&&(x=Math.min(u,8*l.loaded/w));const L=S?1e3*l.loaded/x:0,A=v/1e3,R=L?(_-l.loaded)/L:8*_/w+A;if(R<=b)return;const I=L?8*L:w,C=!0===(null==(t=(null==e?void 0:e.details)||this.hls.latestLevelDetails)?void 0:t.live),D=this.hls.config.abrBandWidthUpFactor;let P,O=Number.POSITIVE_INFINITY;for(P=d-1;P>h;P--){const e=T[P].maxBitrate,t=!T[P].details||C;if(O=this.getTimeToLoadFrag(A,I,c*e,t),O<Math.min(b,c+A))break}if(O>=R)return;if(O>10*c)return;S?this.bwEstimator.sample(u-Math.min(v,E),l.loaded):this.bwEstimator.sampleTTFB(u);const N=T[P].maxBitrate;this.getBwEstimate()*D>N&&this.resetEstimator(N);const M=this.findBestLevel(N,h,P,0,b,1,1);M>-1&&(P=M),this.warn(`Fragment ${n.sn}${i?" part "+i.index:""} of level ${d} is loading too slowly;\n      Fragment duration: ${n.duration.toFixed(3)}\n      Time to underbuffer: ${b.toFixed(3)} s\n      Estimated load time for current fragment: ${R.toFixed(3)} s\n      Estimated load time for down switch fragment: ${O.toFixed(3)} s\n      TTFB estimate: ${0|E} ms\n      Current BW estimate: ${Ne(w)?0|w:"Unknown"} bps\n      New BW estimate: ${0|this.getBwEstimate()} bps\n      Switching to level ${P} @ ${0|N} bps`),r.nextLoadLevel=r.nextAutoLevel=P,this.clearTimer();const F=()=>{if(this.clearTimer(),this.fragCurrent===n&&this.hls.loadLevel===P&&P>0){const e=this.getStarvationDelay();if(this.warn(`Aborting inflight request ${P>0?"and switching down":""}\n      Fragment duration: ${n.duration.toFixed(3)} s\n      Time to underbuffer: ${e.toFixed(3)} s`),n.abortRequests(),this.fragCurrent=this.partCurrent=null,P>h){let t=this.findBestLevel(this.hls.levels[h].bitrate,h,P,0,e,1,1);-1===t&&(t=h),this.hls.nextLoadLevel=this.hls.nextAutoLevel=t,this.resetEstimator(this.hls.levels[t].bitrate)}}};p||R>2*O?F():this.timer=self.setInterval(F,1e3*O),r.trigger($e.FRAG_LOAD_EMERGENCY_ABORTED,{frag:n,part:i,stats:l})},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(this.log(`setting initial bwe to ${e}`),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const e=this.hls.config;return new Ye(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){const{hls:e}=this;e.on($e.MANIFEST_LOADING,this.onManifestLoading,this),e.on($e.FRAG_LOADING,this.onFragLoading,this),e.on($e.FRAG_LOADED,this.onFragLoaded,this),e.on($e.FRAG_BUFFERED,this.onFragBuffered,this),e.on($e.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on($e.LEVEL_LOADED,this.onLevelLoaded,this),e.on($e.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on($e.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on($e.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e&&(e.off($e.MANIFEST_LOADING,this.onManifestLoading,this),e.off($e.FRAG_LOADING,this.onFragLoading,this),e.off($e.FRAG_LOADED,this.onFragLoaded,this),e.off($e.FRAG_BUFFERED,this.onFragBuffered,this),e.off($e.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off($e.LEVEL_LOADED,this.onLevelLoaded,this),e.off($e.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off($e.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off($e.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=this.supportedCache=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.supportedCache={},this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,t){const n=t.frag;var i;this.ignoreFragment(n)||(n.bitrateTest||(this.fragCurrent=n,this.partCurrent=null!=(i=t.part)?i:null),this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100))}onLevelSwitching(e,t){this.clearTimer()}onError(e,t){if(!t.fatal)switch(t.details){case Ue.BUFFER_ADD_CODEC_ERROR:case Ue.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case Ue.FRAG_LOAD_TIMEOUT:{const e=t.frag,{fragCurrent:n,partCurrent:i}=this;if(e&&n&&e.sn===n.sn&&e.level===n.level){const t=performance.now(),n=i?i.stats:e.stats,r=t-n.loading.start,s=n.loading.first?n.loading.first-n.loading.start:-1;if(n.loaded&&s>-1){const e=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(r-Math.min(e,s),n.loaded)}else this.bwEstimator.sampleTTFB(r)}break}}}getTimeToLoadFrag(e,t,n,i){return e+n/t+(i?e+this.lastLevelLoadSec:0)}onLevelLoaded(e,t){const n=this.hls.config,{loading:i}=t.stats,r=i.end-i.first;Ne(r)&&(this.lastLevelLoadSec=r/1e3),t.details.live?this.bwEstimator.update(n.abrEwmaSlowLive,n.abrEwmaFastLive):this.bwEstimator.update(n.abrEwmaSlowVoD,n.abrEwmaFastVoD),this.timer>-1&&this._abandonRulesCheck(t.levelInfo)}onFragLoaded(e,{frag:t,part:n}){const i=n?n.stats:t.stats;if(t.type===qe&&this.bwEstimator.sampleTTFB(i.loading.first-i.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),t.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const e=n?n.duration:t.duration,r=this.hls.levels[t.level],s=(r.loaded?r.loaded.bytes:0)+i.loaded,a=(r.loaded?r.loaded.duration:0)+e;r.loaded={bytes:s,duration:a},r.realBitrate=Math.round(8*s/a)}if(t.bitrateTest){const e={stats:i,frag:t,part:n,id:t.type};this.onFragBuffered($e.FRAG_BUFFERED,e),t.bitrateTest=!1}else this.lastLoadedFragLevel=t.level}}onFragBuffered(e,t){const{frag:n,part:i}=t,r=null!=i&&i.stats.loaded?i.stats:n.stats;if(r.aborted)return;if(this.ignoreFragment(n))return;const s=r.parsing.end-r.loading.start-Math.min(r.loading.first-r.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(s,r.loaded),r.bwEstimate=this.getBwEstimate(),n.bitrateTest?this.bitrateTestDelay=s/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==qe||"initSegment"===e.sn}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:e,minAutoLevel:t}=this.hls,n=this.getBwEstimate(),i=this.hls.config.maxStarvationDelay,r=this.findBestLevel(n,t,e,0,i,1,1);if(r>-1)return r;const s=this.hls.firstLevel,a=Math.min(Math.max(s,t),e);return this.warn(`Could not find best starting auto level. Defaulting to first in playlist ${s} clamped to ${a}`),a}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const e=this.forcedAutoLevel,t=this.bwEstimator.canEstimate(),n=this.lastLoadedFragLevel>-1;if(!(-1===e||t&&n&&this.nextAutoLevelKey!==this.getAutoLevelKey()))return e;const i=t&&n?this.getNextABRAutoLevel():this.firstAutoLevel;if(-1!==e){const t=this.hls.levels;if(t.length>Math.max(e,i)&&t[e].loadError<=t[i].loadError)return e}return this._nextAutoLevel=i,this.nextAutoLevelKey=this.getAutoLevelKey(),i}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:n}=this;if(n.levels.length<=1)return n.loadLevel;const{maxAutoLevel:i,config:r,minAutoLevel:s}=n,a=t?t.duration:e?e.duration:0,o=this.getBwEstimate(),l=this.getStarvationDelay();let c=r.abrBandWidthFactor,u=r.abrBandWidthUpFactor;if(l){const e=this.findBestLevel(o,s,i,l,0,c,u);if(e>=0)return this.rebufferNotice=-1,e}let h=a?Math.min(a,r.maxStarvationDelay):r.maxStarvationDelay;if(!l){const e=this.bitrateTestDelay;e&&(h=(a?Math.min(a,r.maxLoadingDelay):r.maxLoadingDelay)-e,this.info(`bitrate test took ${Math.round(1e3*e)}ms, set first fragment max fetchDuration to ${Math.round(1e3*h)} ms`),c=u=1)}const d=this.findBestLevel(o,s,i,l,h,c,u);if(this.rebufferNotice!==d&&(this.rebufferNotice=d,this.info(`${l?"rebuffering expected":"buffer is empty"}, optimal quality level ${d}`)),d>-1)return d;const f=n.levels[s],p=n.loadLevelObj;return p&&(null==f?void 0:f.bitrate)<p.bitrate?s:n.loadLevel}getStarvationDelay(){const e=this.hls,t=e.media;if(!t)return 1/0;const n=t&&0!==t.playbackRate?Math.abs(t.playbackRate):1,i=e.mainForwardBufferInfo;return(i?i.len:0)/n}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,t,n,i,r,s,a){var o;const l=i+r,c=this.lastLoadedFragLevel,u=-1===c?this.hls.firstLevel:c,{fragCurrent:h,partCurrent:d}=this,{levels:f,allAudioTracks:p,loadLevel:g,config:m}=this.hls;if(1===f.length)return 0;const v=f[u],y=!(null==(o=this.hls.latestLevelDetails)||!o.live),b=-1===g||-1===c;let E,S="SDR",w=(null==v?void 0:v.frameRate)||0;const{audioPreference:T,videoPreference:k}=m,_=this.audioTracksByGroup||(this.audioTracksByGroup=Dn(p));let x=-1;if(b){if(-1!==this.firstSelection)return this.firstSelection;const i=this.codecTiers||(this.codecTiers=function(e,t,n,i){return e.slice(n,i+1).reduce((e,n,i)=>{if(!n.codecSet)return e;const r=n.audioGroups;let s=e[n.codecSet];s||(e[n.codecSet]=s={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,minIndex:i,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!r,fragmentError:0}),s.minBitrate=Math.min(s.minBitrate,n.bitrate);const a=Math.min(n.height,n.width);return s.minHeight=Math.min(s.minHeight,a),s.minFramerate=Math.min(s.minFramerate,n.frameRate),s.minIndex=Math.min(s.minIndex,i),s.maxScore=Math.max(s.maxScore,n.score),s.fragmentError+=n.fragmentError,s.videoRanges[n.videoRange]=(s.videoRanges[n.videoRange]||0)+1,r&&r.forEach(e=>{if(!e)return;const n=t.groups[e];n&&(s.hasDefaultAudio=s.hasDefaultAudio||t.hasDefaultAudio?n.hasDefault:n.hasAutoSelect||!t.hasDefaultAudio&&!t.hasAutoSelectAudio,Object.keys(n.channels).forEach(e=>{s.channels[e]=(s.channels[e]||0)+n.channels[e]}))}),e},{})}(f,_,t,n)),r=function(e,t,n,i,r){const s=Object.keys(e),a=null==i?void 0:i.channels,o=null==i?void 0:i.audioCodec,l=null==r?void 0:r.videoCodec,c=a&&2===parseInt(a);let u=!1,h=!1,d=1/0,f=1/0,p=1/0,g=1/0,m=0,v=[];const{preferHDR:y,allowedVideoRanges:b}=function(e,t){let n=!1,i=[];if(e&&(n="SDR"!==e,i=[e]),t){i=t.allowedVideoRanges||_n.slice(0);const e="SDR"!==i.join("")&&!t.videoCodec;n=void 0!==t.preferHDR?t.preferHDR:e&&function(){if("function"==typeof matchMedia){const e=matchMedia("(dynamic-range: high)"),t=matchMedia("bad query");if(e.media!==t.media)return!0===e.matches}return!1}(),n||(i=["SDR"])}return{preferHDR:n,allowedVideoRanges:i}}(t,r);for(let t=s.length;t--;){const n=e[s[t]];u||(u=n.channels[2]>0),d=Math.min(d,n.minHeight),f=Math.min(f,n.minFramerate),p=Math.min(p,n.minBitrate),b.filter(e=>n.videoRanges[e]>0).length>0&&(h=!0)}d=Ne(d)?d:0,f=Ne(f)?f:0;const E=Math.max(1080,d),S=Math.max(30,f);p=Ne(p)?p:n,n=Math.max(p,n),h||(t=void 0);const w=s.length>1;return{codecSet:s.reduce((t,i)=>{const r=e[i];if(i===t)return t;if(v=h?b.filter(e=>r.videoRanges[e]>0):[],w){if(r.minBitrate>n)return Cn(i,`min bitrate of ${r.minBitrate} > current estimate of ${n}`),t;if(!r.hasDefaultAudio)return Cn(i,"no renditions with default or auto-select sound found"),t;if(o&&i.indexOf(o.substring(0,4))%5!=0)return Cn(i,`audio codec preference "${o}" not found`),t;if(a&&!c){if(!r.channels[a])return Cn(i,`no renditions with ${a} channel sound found (channels options: ${Object.keys(r.channels)})`),t}else if((!o||c)&&u&&0===r.channels[2])return Cn(i,"no renditions with stereo sound found"),t;if(r.minHeight>E)return Cn(i,`min resolution of ${r.minHeight} > maximum of ${E}`),t;if(r.minFramerate>S)return Cn(i,`min framerate of ${r.minFramerate} > maximum of ${S}`),t;if(!v.some(e=>r.videoRanges[e]>0))return Cn(i,`no variants with VIDEO-RANGE of ${In(v)} found`),t;if(l&&i.indexOf(l.substring(0,4))%5!=0)return Cn(i,`video codec preference "${l}" not found`),t;if(r.maxScore<m)return Cn(i,`max score of ${r.maxScore} < selected max of ${m}`),t}return t&&(ln(i)>=ln(t)||r.fragmentError>e[t].fragmentError)?t:(g=r.minIndex,m=r.maxScore,i)},void 0),videoRanges:v,preferHDR:y,minFramerate:f,minBitrate:p,minIndex:g}}(i,S,e,T,k),{codecSet:s,videoRanges:a,minFramerate:o,minBitrate:l,minIndex:c,preferHDR:u}=r;x=c,E=s,S=u?a[a.length-1]:a[0],w=o,e=Math.max(e,l),this.log(`picked start tier ${In(r)}`)}else E=null==v?void 0:v.codecSet,S=null==v?void 0:v.videoRange;const L=d?d.duration:h?h.duration:0,A=this.bwEstimator.getEstimateTTFB()/1e3,R=[];for(let o=n;o>=t;o--){var I;const t=f[o],h=o>u;if(!t)continue;if(m.useMediaCapabilities&&!t.supportedResult&&!t.supportedPromise){const n=navigator.mediaCapabilities;"function"==typeof(null==n?void 0:n.decodingInfo)&&En(t,_,S,w,e,T)?(t.supportedPromise=Sn(t,_,n,this.supportedCache),t.supportedPromise.then(e=>{if(!this.hls)return;t.supportedResult=e;const n=this.hls.levels,i=n.indexOf(t);e.error?this.warn(`MediaCapabilities decodingInfo error: "${e.error}" for level ${i} ${In(e)}`):e.supported?e.decodingInfoResults.some(e=>!1===e.smooth||!1===e.powerEfficient)&&this.log(`MediaCapabilities decodingInfo for level ${i} not smooth or powerEfficient: ${In(e)}`):(this.warn(`Unsupported MediaCapabilities decodingInfo result for level ${i} ${In(e)}`),i>-1&&n.length>1&&(this.log(`Removing unsupported level ${i}`),this.hls.removeLevel(i),-1===this.hls.loadLevel&&(this.hls.nextLoadLevel=0)))}).catch(e=>{this.warn(`Error handling MediaCapabilities decodingInfo: ${e}`)})):t.supportedResult=yn}if((E&&t.codecSet!==E||S&&t.videoRange!==S||h&&w>t.frameRate||!h&&w>0&&w<t.frameRate||null!=(I=t.supportedResult)&&null!=(I=I.decodingInfoResults)&&I.some(e=>!1===e.smooth))&&(!b||o!==x)){R.push(o);continue}const p=t.details,v=(d?null==p?void 0:p.partTarget:null==p?void 0:p.averagetargetduration)||L;let k;k=h?a*e:s*e;const C=L&&i>=2*L&&0===r?t.averageBitrate:t.maxBitrate,D=this.getTimeToLoadFrag(A,k,C*v,void 0===p);if(k>=C&&(o===c||0===t.loadError&&0===t.fragmentError)&&(D<=A||!Ne(D)||y&&!this.bitrateTestDelay||D<l)){const e=this.forcedAutoLevel;return o===g||-1!==e&&e===g||(R.length&&this.trace(`Skipped level(s) ${R.join(",")} of ${n} max with CODECS and VIDEO-RANGE:"${f[R[0]].codecs}" ${f[R[0]].videoRange}; not compatible with "${E}" ${S}`),this.info(`switch candidate:${u}->${o} adjustedbw(${Math.round(k)})-bitrate=${Math.round(k-C)} ttfb:${A.toFixed(1)} avgDuration:${v.toFixed(1)} maxFetchDuration:${l.toFixed(1)} fetchDuration:${D.toFixed(1)} firstSelection:${b} codecSet:${t.codecSet} videoRange:${t.videoRange} hls.loadLevel:${g}`)),b&&(this.firstSelection=o),o}}return-1}set nextAutoLevel(e){const t=this.deriveNextAutoLevel(e);this._nextAutoLevel!==t&&(this.nextAutoLevelKey="",this._nextAutoLevel=t)}deriveNextAutoLevel(e){const{maxAutoLevel:t,minAutoLevel:n}=this.hls;return Math.min(Math.max(e,n),t)}},bufferController:class extends et{constructor(e,t){var n;super("buffer-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.details=null,this._objectUrl=null,this.operationQueue=null,this.bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.blockedAudioAppend=null,this.lastVideoAppendEnd=0,this.appendSource=void 0,this.transferData=void 0,this.overrides=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.sourceBuffers=[[null,null],[null,null]],this._onEndStreaming=e=>{var t;this.hls&&"open"===(null==(t=this.mediaSource)?void 0:t.readyState)&&this.hls.pauseBuffering()},this._onStartStreaming=e=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=e=>{const{media:t,mediaSource:n}=this;e&&this.log("Media source opened"),t&&n&&(n.removeEventListener("sourceopen",this._onMediaSourceOpen),t.removeEventListener("emptied",this._onMediaEmptied),this.updateDuration(),this.hls.trigger($e.MEDIA_ATTACHED,{media:t,mediaSource:n}),null!==this.mediaSource&&this.checkPendingTracks())},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:e,_objectUrl:t}=this;e!==t&&this.error(`Media element src was set while attaching MediaSource (${t} > ${e})`)},this.hls=e,this.fragmentTracker=t,this.appendSource=(n=ot(e.config.preferManagedMediaSource),"undefined"!=typeof self&&n===self.ManagedMediaSource),this.initTracks(),this.registerListeners()}hasSourceTypes(){return Object.keys(this.tracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.transferData=this.overrides=void 0,this.operationQueue&&(this.operationQueue.destroy(),this.operationQueue=null),this.hls=this.fragmentTracker=null,this._onMediaSourceOpen=this._onMediaSourceClose=null,this._onMediaSourceEnded=null,this._onStartStreaming=this._onEndStreaming=null}registerListeners(){const{hls:e}=this;e.on($e.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on($e.MEDIA_DETACHING,this.onMediaDetaching,this),e.on($e.MANIFEST_LOADING,this.onManifestLoading,this),e.on($e.MANIFEST_PARSED,this.onManifestParsed,this),e.on($e.BUFFER_RESET,this.onBufferReset,this),e.on($e.BUFFER_APPENDING,this.onBufferAppending,this),e.on($e.BUFFER_CODECS,this.onBufferCodecs,this),e.on($e.BUFFER_EOS,this.onBufferEos,this),e.on($e.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on($e.LEVEL_UPDATED,this.onLevelUpdated,this),e.on($e.FRAG_PARSED,this.onFragParsed,this),e.on($e.FRAG_CHANGED,this.onFragChanged,this),e.on($e.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off($e.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off($e.MEDIA_DETACHING,this.onMediaDetaching,this),e.off($e.MANIFEST_LOADING,this.onManifestLoading,this),e.off($e.MANIFEST_PARSED,this.onManifestParsed,this),e.off($e.BUFFER_RESET,this.onBufferReset,this),e.off($e.BUFFER_APPENDING,this.onBufferAppending,this),e.off($e.BUFFER_CODECS,this.onBufferCodecs,this),e.off($e.BUFFER_EOS,this.onBufferEos,this),e.off($e.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off($e.LEVEL_UPDATED,this.onLevelUpdated,this),e.off($e.FRAG_PARSED,this.onFragParsed,this),e.off($e.FRAG_CHANGED,this.onFragChanged,this),e.off($e.ERROR,this.onError,this)}transferMedia(){const{media:e,mediaSource:t}=this;if(!e)return null;const n={};if(this.operationQueue){const e=this.isUpdating();e||this.operationQueue.removeBlockers();const t=this.isQueued();(e||t)&&this.warn(`Transfering MediaSource with${t?" operations in queue":""}${e?" updating SourceBuffer(s)":""} ${this.operationQueue}`),this.operationQueue.destroy()}const i=this.transferData;return!this.sourceBufferCount&&i&&i.mediaSource===t?Qe(n,i.tracks):this.sourceBuffers.forEach(e=>{const[t]=e;t&&(n[t]=Qe({},this.tracks[t]),this.removeBuffer(t)),e[0]=e[1]=null}),{media:e,mediaSource:t,tracks:n}}initTracks(){this.sourceBuffers=[[null,null],[null,null]],this.tracks={},this.resetQueue(),this.resetAppendErrors(),this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.lastVideoAppendEnd=0}onManifestLoading(){this.bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){var n;let i=2;(t.audio&&!t.video||!t.altAudio)&&(i=1),this.bufferCodecEventsTotal=i,this.log(`${i} bufferCodec event(s) expected.`),null!=(n=this.transferData)&&n.mediaSource&&this.sourceBufferCount&&i&&this.bufferCreated()}onMediaAttaching(e,t){const n=this.media=t.media;this.transferData=this.overrides=void 0;const i=ot(this.appendSource);if(i){const e=!!t.mediaSource;(e||t.overrides)&&(this.transferData=t,this.overrides=t.overrides);const r=this.mediaSource=t.mediaSource||new i;if(this.assignMediaSource(r),e)this._objectUrl=n.src,this.attachTransferred();else{const e=this._objectUrl=self.URL.createObjectURL(r);if(this.appendSource)try{n.removeAttribute("src");const t=self.ManagedMediaSource;n.disableRemotePlayback=n.disableRemotePlayback||t&&r instanceof t,Ra(n),function(e,t){const n=self.document.createElement("source");n.type="video/mp4",n.src=t,e.appendChild(n)}(n,e),n.load()}catch(t){n.src=e}else n.src=e}n.addEventListener("emptied",this._onMediaEmptied)}}assignMediaSource(e){var t,n;this.log(`${(null==(t=this.transferData)?void 0:t.mediaSource)===e?"transferred":"created"} media source: ${null==(n=e.constructor)?void 0:n.name}`),e.addEventListener("sourceopen",this._onMediaSourceOpen),e.addEventListener("sourceended",this._onMediaSourceEnded),e.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(e.addEventListener("startstreaming",this._onStartStreaming),e.addEventListener("endstreaming",this._onEndStreaming))}attachTransferred(){const e=this.media,t=this.transferData;if(!t||!e)return;const n=this.tracks,i=t.tracks,r=i?Object.keys(i):null,s=r?r.length:0,a=()=>{Promise.resolve().then(()=>{this.media&&this.mediaSourceOpenOrEnded&&this._onMediaSourceOpen()})};if(i&&r&&s){if(!this.tracksReady)return this.hls.config.startFragPrefetch=!0,void this.log("attachTransferred: waiting for SourceBuffer track info");if(this.log(`attachTransferred: (bufferCodecEventsTotal ${this.bufferCodecEventsTotal})\nrequired tracks: ${In(n,(e,t)=>"initSegment"===e?void 0:t)};\ntransfer tracks: ${In(i,(e,t)=>"initSegment"===e?void 0:t)}}`),!lt(i,n)){t.mediaSource=null,t.tracks=void 0;const r=e.currentTime,s=this.details,a=Math.max(r,(null==s?void 0:s.fragments[0].start)||0);return a-r>1?void this.log(`attachTransferred: waiting for playback to reach new tracks start time ${r} -> ${a}`):(this.warn(`attachTransferred: resetting MediaSource for incompatible tracks ("${Object.keys(i)}"->"${Object.keys(n)}") start time: ${a} currentTime: ${r}`),this.onMediaDetaching($e.MEDIA_DETACHING,{}),this.onMediaAttaching($e.MEDIA_ATTACHING,t),void(e.currentTime=a))}this.transferData=void 0,r.forEach(e=>{const t=e,n=i[t];if(n){const e=n.buffer;if(e){const i=this.fragmentTracker,r=n.id;if(i.hasFragments(r)||i.hasParts(r)){const n=bi.getBuffered(e);i.detectEvictedFragments(t,n,r,null,!0)}const s=Ia(t),a=[t,e];this.sourceBuffers[s]=a,e.updating&&this.operationQueue&&this.operationQueue.prependBlocker(t),this.trackSourceBuffer(t,n)}}}),a(),this.bufferCreated()}else this.log("attachTransferred: MediaSource w/o SourceBuffers"),a()}get mediaSourceOpenOrEnded(){var e;const t=null==(e=this.mediaSource)?void 0:e.readyState;return"open"===t||"ended"===t}onMediaDetaching(e,t){const n=!!t.transferMedia;this.transferData=this.overrides=void 0;const{media:i,mediaSource:r,_objectUrl:s}=this;if(r){if(this.log("media source "+(n?"transferring":"detaching")),n)this.sourceBuffers.forEach(([e])=>{e&&this.removeBuffer(e)}),this.resetQueue();else{if(this.mediaSourceOpenOrEnded){const e="open"===r.readyState;try{const t=r.sourceBuffers;for(let n=t.length;n--;)e&&t[n].abort(),r.removeSourceBuffer(t[n]);e&&r.endOfStream()}catch(e){this.warn(`onMediaDetaching: ${e.message} while calling endOfStream`)}}this.sourceBufferCount&&this.onBufferReset()}r.removeEventListener("sourceopen",this._onMediaSourceOpen),r.removeEventListener("sourceended",this._onMediaSourceEnded),r.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(r.removeEventListener("startstreaming",this._onStartStreaming),r.removeEventListener("endstreaming",this._onEndStreaming)),this.mediaSource=null,this._objectUrl=null}i&&(i.removeEventListener("emptied",this._onMediaEmptied),n||(s&&self.URL.revokeObjectURL(s),this.mediaSrc===s?(i.removeAttribute("src"),this.appendSource&&Ra(i),i.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.media=null),this.hls.trigger($e.MEDIA_DETACHED,t)}onBufferReset(){this.sourceBuffers.forEach(([e])=>{e&&this.resetBuffer(e)}),this.initTracks()}resetBuffer(e){var t;const n=null==(t=this.tracks[e])?void 0:t.buffer;if(this.removeBuffer(e),n)try{var i;null!=(i=this.mediaSource)&&i.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(n)}catch(t){this.warn(`onBufferReset ${e}`,t)}delete this.tracks[e]}removeBuffer(e){this.removeBufferListeners(e),this.sourceBuffers[Ia(e)]=[null,null];const t=this.tracks[e];t&&(t.buffer=void 0)}resetQueue(){this.operationQueue&&this.operationQueue.destroy(),this.operationQueue=new _a(this.tracks)}onBufferCodecs(e,t){var n;const i=this.tracks,r=Object.keys(t);this.log(`BUFFER_CODECS: "${r}" (current SB count ${this.sourceBufferCount})`);const s="audiovideo"in t&&(i.audio||i.video)||i.audiovideo&&("audio"in t||"video"in t),a=!s&&this.sourceBufferCount&&this.media&&r.some(e=>!i[e]);s||a?this.warn(`Unsupported transition between "${Object.keys(i)}" and "${r}" SourceBuffers`):(r.forEach(e=>{var n,r;const s=t[e],{id:a,codec:o,levelCodec:l,container:c,metadata:u,supplemental:h}=s;let d=i[e];const f=null==(n=this.transferData)||null==(n=n.tracks)?void 0:n[e],p=null!=f&&f.buffer?f:d,g=(null==p?void 0:p.pendingCodec)||(null==p?void 0:p.codec),m=null==p?void 0:p.levelCodec;d||(d=i[e]={buffer:void 0,listeners:[],codec:o,supplemental:h,container:c,levelCodec:l,metadata:u,id:a});const v=dn(g,m),y=null==v?void 0:v.replace(xa,"$1");let b=dn(o,l);const E=null==(r=b)?void 0:r.replace(xa,"$1");b&&v&&y!==E&&("audio"===e.slice(0,5)&&(b=hn(b,this.appendSource)),this.log(`switching codec ${g} to ${b}`),b!==(d.pendingCodec||d.codec)&&(d.pendingCodec=b),d.container=c,this.appendChangeType(e,c,b))}),(this.tracksReady||this.sourceBufferCount)&&(t.tracks=this.sourceBufferTracks),this.sourceBufferCount||(this.bufferCodecEventsTotal>1&&!this.tracks.video&&!t.video&&"main"===(null==(n=t.audio)?void 0:n.id)&&(this.log("Main audio-only"),this.bufferCodecEventsTotal=1),this.mediaSourceOpenOrEnded&&this.checkPendingTracks()))}get sourceBufferTracks(){return Object.keys(this.tracks).reduce((e,t)=>{const n=this.tracks[t];return e[t]={id:n.id,container:n.container,codec:n.codec,levelCodec:n.levelCodec},e},{})}appendChangeType(e,t,n){const i=`${t};codecs=${n}`,r={label:`change-type=${i}`,execute:()=>{const r=this.tracks[e];if(r){const s=r.buffer;null!=s&&s.changeType&&(this.log(`changing ${e} sourceBuffer type to ${i}`),s.changeType(i),r.codec=n,r.container=t)}this.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:t=>{this.warn(`Failed to change ${e} SourceBuffer type`,t)}};this.append(r,e,this.isPending(this.tracks[e]))}blockAudio(e){var t;const n=e.start,i=n+.05*e.duration;if(!0===(null==(t=this.fragmentTracker.getAppendedFrag(n,qe))?void 0:t.gap))return;const r={label:"block-audio",execute:()=>{var e;const t=this.tracks.video;(this.lastVideoAppendEnd>i||null!=t&&t.buffer&&bi.isBuffered(t.buffer,i)||!0===(null==(e=this.fragmentTracker.getAppendedFrag(i,qe))?void 0:e.gap))&&(this.blockedAudioAppend=null,this.shiftAndExecuteNext("audio"))},onStart:()=>{},onComplete:()=>{},onError:e=>{this.warn("Error executing block-audio operation",e)}};this.blockedAudioAppend={op:r,frag:e},this.append(r,"audio",!0)}unblockAudio(){const{blockedAudioAppend:e,operationQueue:t}=this;e&&t&&(this.blockedAudioAppend=null,t.unblockAudio(e.op))}onBufferAppending(e,t){const{tracks:n}=this,{data:i,type:r,parent:s,frag:a,part:o,chunkMeta:l,offset:c}=t,u=l.buffering[r],{sn:h,cc:d}=a,f=self.performance.now();u.start=f;const p=a.stats.buffering,g=o?o.stats.buffering:null;0===p.start&&(p.start=f),g&&0===g.start&&(g.start=f);const m=n.audio;let v=!1;"audio"===r&&"audio/mpeg"===(null==m?void 0:m.container)&&(v=!this.lastMpegAudioChunk||1===l.id||this.lastMpegAudioChunk.sn!==l.sn,this.lastMpegAudioChunk=l);const y=n.video,b=null==y?void 0:y.buffer;if(b&&"initSegment"!==h){const e=o||a,t=this.blockedAudioAppend;if("audio"!==r||"main"===s||this.blockedAudioAppend||y.ending||y.ended){if("video"===r){const n=e.end;if(t){const e=t.frag.start;(n>e||n<this.lastVideoAppendEnd||bi.isBuffered(b,e))&&this.unblockAudio()}this.lastVideoAppendEnd=n}}else{const t=e.start+.05*e.duration,n=b.buffered,i=this.currentOp("video");n.length||i?!i&&!bi.isBuffered(b,t)&&this.lastVideoAppendEnd<t&&this.blockAudio(e):this.blockAudio(e)}}const E=(o||a).start,S={label:`append-${r}`,execute:()=>{var e;u.executeStart=self.performance.now();const t=null==(e=this.tracks[r])?void 0:e.buffer;t&&(v?this.updateTimestampOffset(t,E,.1,r,h,d):void 0!==c&&Ne(c)&&this.updateTimestampOffset(t,c,1e-6,r,h,d)),this.appendExecutor(i,r)},onStart:()=>{},onComplete:()=>{const e=self.performance.now();u.executeEnd=u.end=e,0===p.first&&(p.first=e),g&&0===g.first&&(g.first=e);const t={};this.sourceBuffers.forEach(([e,n])=>{e&&(t[e]=bi.getBuffered(n))}),this.appendErrors[r]=0,"audio"===r||"video"===r?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger($e.BUFFER_APPENDED,{type:r,frag:a,part:o,chunkMeta:l,parent:a.type,timeRanges:t})},onError:e=>{var t;const n={type:Be.MEDIA_ERROR,parent:a.type,details:Ue.BUFFER_APPEND_ERROR,sourceBufferName:r,frag:a,part:o,chunkMeta:l,error:e,err:e,fatal:!1},i=null==(t=this.media)?void 0:t.error;if(e.code===DOMException.QUOTA_EXCEEDED_ERR||"QuotaExceededError"==e.name||"quota"in e)n.details=Ue.BUFFER_FULL_ERROR;else if(e.code===DOMException.INVALID_STATE_ERR&&this.mediaSourceOpenOrEnded&&!i)n.errorAction=Zn(!0);else if(e.name===La&&0===this.sourceBufferCount)n.errorAction=Zn(!0);else{const e=++this.appendErrors[r];this.warn(`Failed ${e}/${this.hls.config.appendErrorMaxRetry} times to append segment in "${r}" sourceBuffer (${i||"no media error"})`),(e>=this.hls.config.appendErrorMaxRetry||i)&&(n.fatal=!0)}this.hls.trigger($e.ERROR,n)}};this.log(`queuing "${r}" append sn: ${h}${o?" p: "+o.index:""} of ${a.type===qe?"level":"track"} ${a.level} cc: ${d}`),this.append(S,r,this.isPending(this.tracks[r]))}getFlushOp(e,t,n){return this.log(`queuing "${e}" remove ${t}-${n}`),{label:"remove",execute:()=>{this.removeExecutor(e,t,n)},onStart:()=>{},onComplete:()=>{this.hls.trigger($e.BUFFER_FLUSHED,{type:e})},onError:i=>{this.warn(`Failed to remove ${t}-${n} from "${e}" SourceBuffer`,i)}}}onBufferFlushing(e,t){const{type:n,startOffset:i,endOffset:r}=t;n?this.append(this.getFlushOp(n,i,r),n):this.sourceBuffers.forEach(([e])=>{e&&this.append(this.getFlushOp(e,i,r),e)})}onFragParsed(e,t){const{frag:n,part:i}=t,r=[],s=i?i.elementaryStreams:n.elementaryStreams;s[kt]?r.push("audiovideo"):(s[wt]&&r.push("audio"),s[Tt]&&r.push("video")),0===r.length&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${n.type} level: ${n.level} sn: ${n.sn}`),this.blockBuffers(()=>{const e=self.performance.now();n.stats.buffering.end=e,i&&(i.stats.buffering.end=e);const t=i?i.stats:n.stats;this.hls.trigger($e.FRAG_BUFFERED,{frag:n,part:i,stats:t,id:n.type})},r).catch(e=>{this.warn(`Fragment buffered callback ${e}`),this.stepOperationQueue(this.sourceBufferTypes)})}onFragChanged(e,t){this.trimBuffers()}get bufferedToEnd(){return this.sourceBufferCount>0&&!this.sourceBuffers.some(([e])=>{if(e){const t=this.tracks[e];if(t)return!t.ended||t.ending}return!1})}onBufferEos(e,t){var n;this.sourceBuffers.forEach(([e])=>{if(e){const n=this.tracks[e];t.type&&t.type!==e||(n.ending=!0,n.ended||(n.ended=!0,this.log(`${e} buffer reached EOS`)))}});const i=!1!==(null==(n=this.overrides)?void 0:n.endOfStream);this.sourceBufferCount>0&&!this.sourceBuffers.some(([e])=>{var t;return e&&!(null!=(t=this.tracks[e])&&t.ended)})?i?(this.log("Queueing EOS"),this.blockUntilOpen(()=>{this.tracksEnded();const{mediaSource:e}=this;e&&"open"===e.readyState?(this.log("Calling mediaSource.endOfStream()"),e.endOfStream(),this.hls.trigger($e.BUFFERED_TO_END,void 0)):e&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${e.readyState}`)})):(this.tracksEnded(),this.hls.trigger($e.BUFFERED_TO_END,void 0)):"video"===t.type&&this.unblockAudio()}tracksEnded(){this.sourceBuffers.forEach(([e])=>{if(null!==e){const t=this.tracks[e];t&&(t.ending=!1)}})}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.updateDuration())}updateDuration(){this.blockUntilOpen(()=>{const e=this.getDurationAndRange();e&&this.updateMediaSource(e)})}onError(e,t){if(t.details===Ue.BUFFER_APPEND_ERROR&&t.frag){var n;const e=null==(n=t.errorAction)?void 0:n.nextAutoLevel;Ne(e)&&e!==t.frag.level&&this.resetAppendErrors()}}resetAppendErrors(){this.appendErrors={audio:0,video:0,audiovideo:0}}trimBuffers(){const{hls:e,details:t,media:n}=this;if(!n||null===t)return;if(!this.sourceBufferCount)return;const i=e.config,r=n.currentTime,s=t.levelTargetDuration,a=t.live&&null!==i.liveBackBufferLength?i.liveBackBufferLength:i.backBufferLength;if(Ne(a)&&a>=0){const e=Math.max(a,s),t=Math.floor(r/s)*s-e;this.flushBackBuffer(r,s,t)}const o=i.frontBufferFlushThreshold;if(Ne(o)&&o>0){const e=Math.max(i.maxBufferLength,o),t=Math.max(e,s),n=Math.floor(r/s)*s+t;this.flushFrontBuffer(r,s,n)}}flushBackBuffer(e,t,n){this.sourceBuffers.forEach(([e,t])=>{if(t){const r=bi.getBuffered(t);if(r.length>0&&n>r.start(0)){var i;this.hls.trigger($e.BACK_BUFFER_REACHED,{bufferEnd:n});const t=this.tracks[e];if(null!=(i=this.details)&&i.live)this.hls.trigger($e.LIVE_BACK_BUFFER_REACHED,{bufferEnd:n});else if(null!=t&&t.ended)return void this.log(`Cannot flush ${e} back buffer while SourceBuffer is in ended state`);this.hls.trigger($e.BUFFER_FLUSHING,{startOffset:0,endOffset:n,type:e})}}})}flushFrontBuffer(e,t,n){this.sourceBuffers.forEach(([t,i])=>{if(i){const r=bi.getBuffered(i),s=r.length;if(s<2)return;const a=r.start(s-1),o=r.end(s-1);if(n>a||e>=a&&e<=o)return;this.hls.trigger($e.BUFFER_FLUSHING,{startOffset:a,endOffset:1/0,type:t})}})}getDurationAndRange(){var e;const{details:t,mediaSource:n}=this;if(!t||!this.media||"open"!==(null==n?void 0:n.readyState))return null;const i=t.edge;if(t.live&&this.hls.config.liveDurationInfinity){if(t.fragments.length&&n.setLiveSeekableRange){const e=Math.max(0,t.fragmentStart);return{duration:1/0,start:e,end:Math.max(e,i)}}return{duration:1/0}}const r=null==(e=this.overrides)?void 0:e.duration;if(r)return Ne(r)?{duration:r}:null;const s=this.media.duration;return i>(Ne(n.duration)?n.duration:0)&&i>s||!Ne(s)?{duration:i}:null}updateMediaSource({duration:e,start:t,end:n}){const i=this.mediaSource;this.media&&i&&"open"===i.readyState&&(i.duration!==e&&(Ne(e)&&this.log(`Updating MediaSource duration to ${e.toFixed(3)}`),i.duration=e),void 0!==t&&void 0!==n&&(this.log(`MediaSource duration is set to ${i.duration}. Setting seekable range to ${t}-${n}.`),i.setLiveSeekableRange(t,n)))}get tracksReady(){const e=this.pendingTrackCount;return e>0&&(e>=this.bufferCodecEventsTotal||this.isPending(this.tracks.audiovideo))}checkPendingTracks(){const{bufferCodecEventsTotal:e,pendingTrackCount:t,tracks:n}=this;if(this.log(`checkPendingTracks (pending: ${t} codec events expected: ${e}) ${In(n)}`),this.tracksReady){var i;const e=null==(i=this.transferData)?void 0:i.tracks;e&&Object.keys(e).length?this.attachTransferred():this.createSourceBuffers()}}bufferCreated(){if(this.sourceBufferCount){const e={};this.sourceBuffers.forEach(([t,n])=>{if(t){const i=this.tracks[t];e[t]={buffer:n,container:i.container,codec:i.codec,supplemental:i.supplemental,levelCodec:i.levelCodec,id:i.id,metadata:i.metadata}}}),this.hls.trigger($e.BUFFER_CREATED,{tracks:e}),this.log(`SourceBuffers created. Running queue: ${this.operationQueue}`),this.sourceBuffers.forEach(([e])=>{this.executeNext(e)})}else{const e=new Error("could not create source buffer for media codec(s)");this.hls.trigger($e.ERROR,{type:Be.MEDIA_ERROR,details:Ue.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:e,reason:e.message})}}createSourceBuffers(){const{tracks:e,sourceBuffers:t,mediaSource:n}=this;if(!n)throw new Error("createSourceBuffers called when mediaSource was null");for(const r in e){const s=r,a=e[s];if(this.isPending(a)){const e=this.getTrackCodec(a,s),r=`${a.container};codecs=${e}`;a.codec=e,this.log(`creating sourceBuffer(${r})${this.currentOp(s)?" Queued":""} ${In(a)}`);try{const e=n.addSourceBuffer(r),i=Ia(s),o=[s,e];t[i]=o,a.buffer=e}catch(e){var i;return this.error(`error while trying to add sourceBuffer: ${e.message}`),this.shiftAndExecuteNext(s),null==(i=this.operationQueue)||i.removeBlockers(),delete this.tracks[s],void this.hls.trigger($e.ERROR,{type:Be.MEDIA_ERROR,details:Ue.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:e,sourceBufferName:s,mimeType:r,parent:a.id})}this.trackSourceBuffer(s,a)}}this.bufferCreated()}getTrackCodec(e,t){const n=e.supplemental;let i=e.codec;n&&("video"===t||"audiovideo"===t)&&rn(n,"video")&&(i=function(e,t){const n=[];if(e){const t=e.split(",");for(let e=0;e<t.length;e++)nn(t[e],"video")||n.push(t[e])}return t&&n.push(t),n.join(",")}(i,n));const r=dn(i,e.levelCodec);return r?"audio"===t.slice(0,5)?hn(r,this.appendSource):r:""}trackSourceBuffer(e,t){const n=t.buffer;if(!n)return;const i=this.getTrackCodec(t,e);this.tracks[e]={buffer:n,codec:i,container:t.container,levelCodec:t.levelCodec,supplemental:t.supplemental,metadata:t.metadata,id:t.id,listeners:[]},this.removeBufferListeners(e),this.addBufferListener(e,"updatestart",this.onSBUpdateStart),this.addBufferListener(e,"updateend",this.onSBUpdateEnd),this.addBufferListener(e,"error",this.onSBUpdateError),this.appendSource&&this.addBufferListener(e,"bufferedchange",(e,t)=>{const n=t.removedRanges;null!=n&&n.length&&this.hls.trigger($e.BUFFER_FLUSHED,{type:e})})}get mediaSrc(){var e,t;const n=(null==(e=this.media)||null==(t=e.querySelector)?void 0:t.call(e,"source"))||this.media;return null==n?void 0:n.src}onSBUpdateStart(e){const t=this.currentOp(e);t&&t.onStart()}onSBUpdateEnd(e){var t;if("closed"===(null==(t=this.mediaSource)?void 0:t.readyState))return void this.resetBuffer(e);const n=this.currentOp(e);n&&(n.onComplete(),this.shiftAndExecuteNext(e))}onSBUpdateError(e,t){var n;const i=new Error(`${e} SourceBuffer error. MediaSource readyState: ${null==(n=this.mediaSource)?void 0:n.readyState}`);this.error(`${i}`,t),this.hls.trigger($e.ERROR,{type:Be.MEDIA_ERROR,details:Ue.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:i,fatal:!1});const r=this.currentOp(e);r&&r.onError(i)}updateTimestampOffset(e,t,n,i,r,s){const a=t-e.timestampOffset;Math.abs(a)>=n&&(this.log(`Updating ${i} SourceBuffer timestampOffset to ${t} (sn: ${r} cc: ${s})`),e.timestampOffset=t)}removeExecutor(e,t,n){const{media:i,mediaSource:r}=this,s=this.tracks[e],a=null==s?void 0:s.buffer;if(!i||!r||!a)return this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),void this.shiftAndExecuteNext(e);const o=Ne(i.duration)?i.duration:1/0,l=Ne(r.duration)?r.duration:1/0,c=Math.max(0,t),u=Math.min(n,o,l);u>c&&(!s.ending||s.ended)?(s.ended=!1,this.log(`Removing [${c},${u}] from the ${e} SourceBuffer`),a.remove(c,u)):this.shiftAndExecuteNext(e)}appendExecutor(e,t){const n=this.tracks[t],i=null==n?void 0:n.buffer;if(!i)throw new Aa(`Attempting to append to the ${t} SourceBuffer, but it does not exist`);n.ending=!1,n.ended=!1,i.appendBuffer(e)}blockUntilOpen(e){if(this.isUpdating()||this.isQueued())this.blockBuffers(e).catch(e=>{this.warn(`SourceBuffer blocked callback ${e}`),this.stepOperationQueue(this.sourceBufferTypes)});else try{e()}catch(e){this.warn(`Callback run without blocking ${this.operationQueue} ${e}`)}}isUpdating(){return this.sourceBuffers.some(([e,t])=>e&&t.updating)}isQueued(){return this.sourceBuffers.some(([e])=>e&&!!this.currentOp(e))}isPending(e){return!!e&&!e.buffer}blockBuffers(e,t=this.sourceBufferTypes){if(!t.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);const{operationQueue:n}=this,i=t.map(e=>this.appendBlocker(e));return t.length>1&&!!this.blockedAudioAppend&&this.unblockAudio(),Promise.all(i).then(t=>{n===this.operationQueue&&(e(),this.stepOperationQueue(this.sourceBufferTypes))})}stepOperationQueue(e){e.forEach(e=>{var t;const n=null==(t=this.tracks[e])?void 0:t.buffer;n&&!n.updating&&this.shiftAndExecuteNext(e)})}append(e,t,n){this.operationQueue&&this.operationQueue.append(e,t,n)}appendBlocker(e){if(this.operationQueue)return this.operationQueue.appendBlocker(e)}currentOp(e){return this.operationQueue?this.operationQueue.current(e):null}executeNext(e){e&&this.operationQueue&&this.operationQueue.executeNext(e)}shiftAndExecuteNext(e){this.operationQueue&&this.operationQueue.shiftAndExecuteNext(e)}get pendingTrackCount(){return Object.keys(this.tracks).reduce((e,t)=>e+(this.isPending(this.tracks[t])?1:0),0)}get sourceBufferCount(){return this.sourceBuffers.reduce((e,[t])=>e+(t?1:0),0)}get sourceBufferTypes(){return this.sourceBuffers.map(([e])=>e).filter(e=>!!e)}addBufferListener(e,t,n){const i=this.tracks[e];if(!i)return;const r=i.buffer;if(!r)return;const s=n.bind(this,e);i.listeners.push({event:t,listener:s}),r.addEventListener(t,s)}removeBufferListeners(e){const t=this.tracks[e];if(!t)return;const n=t.buffer;n&&(t.listeners.forEach(e=>{n.removeEventListener(e.event,e.listener)}),t.listeners.length=0)}},capLevelController:Ca,errorController:class extends et{constructor(e){super("error-controller",e.logger),this.hls=void 0,this.playlistError=0,this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on($e.ERROR,this.onError,this),e.on($e.MANIFEST_LOADING,this.onManifestLoading,this),e.on($e.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off($e.ERROR,this.onError,this),e.off($e.ERROR,this.onErrorOut,this),e.off($e.MANIFEST_LOADING,this.onManifestLoading,this),e.off($e.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return(null==e?void 0:e.type)===qe?e.level:this.getVariantIndex()}getVariantIndex(){var e;const t=this.hls,n=t.currentLevel;return null!=(e=t.loadLevelObj)&&e.details||-1===n?t.loadLevel:n}variantHasKey(e,t){if(e){var n;if(null!=(n=e.details)&&n.hasKey(t))return!0;const i=e.audioGroups;if(i)return this.hls.allAudioTracks.filter(e=>i.indexOf(e.groupId)>=0).some(e=>{var n;return null==(n=e.details)?void 0:n.hasKey(t)})}return!1}onManifestLoading(){this.playlistError=0}onLevelUpdated(){this.playlistError=0}onError(e,t){var n;if(t.fatal)return;const i=this.hls,r=t.context;switch(t.details){case Ue.FRAG_LOAD_ERROR:case Ue.FRAG_LOAD_TIMEOUT:case Ue.KEY_LOAD_ERROR:case Ue.KEY_LOAD_TIMEOUT:return void(t.errorAction=this.getFragRetryOrSwitchAction(t));case Ue.FRAG_PARSING_ERROR:if(null!=(n=t.frag)&&n.gap)return void(t.errorAction=Zn());case Ue.FRAG_GAP:case Ue.FRAG_DECRYPT_ERROR:return t.errorAction=this.getFragRetryOrSwitchAction(t),void(t.errorAction.action=2);case Ue.LEVEL_EMPTY_ERROR:case Ue.LEVEL_PARSING_ERROR:{var s;const e=t.parent===qe?t.level:i.loadLevel;t.details===Ue.LEVEL_EMPTY_ERROR&&null!=(s=t.context)&&null!=(s=s.levelDetails)&&s.live?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,e):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,e))}return;case Ue.LEVEL_LOAD_ERROR:case Ue.LEVEL_LOAD_TIMEOUT:return void("number"==typeof(null==r?void 0:r.level)&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,r.level)));case Ue.AUDIO_TRACK_LOAD_ERROR:case Ue.AUDIO_TRACK_LOAD_TIMEOUT:case Ue.SUBTITLE_LOAD_ERROR:case Ue.SUBTITLE_TRACK_LOAD_TIMEOUT:if(r){const e=i.loadLevelObj;if(e&&(r.type===Ge&&e.hasAudioGroup(r.groupId)||r.type===Ve&&e.hasSubtitleGroup(r.groupId)))return t.errorAction=this.getPlaylistRetryOrSwitchAction(t,i.loadLevel),t.errorAction.action=2,void(t.errorAction.flags=1)}return;case Ue.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:return void(t.errorAction={action:2,flags:2});case Ue.KEY_SYSTEM_SESSION_UPDATE_FAILED:case Ue.KEY_SYSTEM_STATUS_INTERNAL_ERROR:case Ue.KEY_SYSTEM_NO_SESSION:return void(t.errorAction={action:2,flags:4});case Ue.BUFFER_ADD_CODEC_ERROR:case Ue.REMUX_ALLOC_ERROR:case Ue.BUFFER_APPEND_ERROR:var a;return void(t.errorAction||(t.errorAction=this.getLevelSwitchAction(t,null!=(a=t.level)?a:i.loadLevel)));case Ue.INTERNAL_EXCEPTION:case Ue.BUFFER_APPENDING_ERROR:case Ue.BUFFER_FULL_ERROR:case Ue.LEVEL_SWITCH_ERROR:case Ue.BUFFER_STALLED_ERROR:case Ue.BUFFER_SEEK_OVER_HOLE:case Ue.BUFFER_NUDGE_ON_STALL:return void(t.errorAction=Zn())}t.type===Be.KEY_SYSTEM_ERROR&&(t.levelRetry=!1,t.errorAction=Zn())}getPlaylistRetryOrSwitchAction(e,t){const n=Wn(this.hls.config.playlistLoadPolicy,e),i=this.playlistError++;if(Xn(n,i,Vn(e),e.response))return{action:5,flags:0,retryConfig:n,retryCount:i};const r=this.getLevelSwitchAction(e,t);return n&&(r.retryConfig=n,r.retryCount=i),r}getFragRetryOrSwitchAction(e){const t=this.hls,n=this.getVariantLevelIndex(e.frag),i=t.levels[n],{fragLoadPolicy:r,keyLoadPolicy:s}=t.config,a=Wn(qn(e)?s:r,e),o=t.levels.reduce((e,t)=>e+t.fragmentError,0);if(i&&(e.details!==Ue.FRAG_GAP&&i.fragmentError++,!Hn(e))&&Xn(a,o,Vn(e),e.response))return{action:5,flags:0,retryConfig:a,retryCount:o};const l=this.getLevelSwitchAction(e,n);return a&&(l.retryConfig=a,l.retryCount=o),l}getLevelSwitchAction(e,t){const n=this.hls;null==t&&(t=n.loadLevel);const i=this.hls.levels[t];if(i){var r,s;const t=e.details;i.loadError++,t===Ue.BUFFER_APPEND_ERROR&&i.fragmentError++;let l=-1;const{levels:c,loadLevel:u,minAutoLevel:h,maxAutoLevel:d}=n;n.autoLevelEnabled||n.config.preserveManualLevelOnError||(n.loadLevel=-1);const f=null==(r=e.frag)?void 0:r.type,p=(f===He&&t===Ue.FRAG_PARSING_ERROR||"audio"===e.sourceBufferName&&(t===Ue.BUFFER_ADD_CODEC_ERROR||t===Ue.BUFFER_APPEND_ERROR))&&c.some(({audioCodec:e})=>i.audioCodec!==e),g="video"===e.sourceBufferName&&(t===Ue.BUFFER_ADD_CODEC_ERROR||t===Ue.BUFFER_APPEND_ERROR)&&c.some(({codecSet:e,audioCodec:t})=>i.codecSet!==e&&i.audioCodec===t),{type:m,groupId:v}=null!=(s=e.context)?s:{};for(let n=c.length;n--;){const r=(n+u)%c.length;if(r!==u&&r>=h&&r<=d&&0===c[r].loadError){var a,o;const n=c[r];if(t===Ue.FRAG_GAP&&f===qe&&e.frag){const t=c[r].details;if(t){const n=$n(e.frag,t.fragments,e.frag.start);if(null!=n&&n.gap)continue}}else{if(m===Ge&&n.hasAudioGroup(v)||m===Ve&&n.hasSubtitleGroup(v))continue;if(f===He&&null!=(a=i.audioGroups)&&a.some(e=>n.hasAudioGroup(e))||f===We&&null!=(o=i.subtitleGroups)&&o.some(e=>n.hasSubtitleGroup(e))||p&&i.audioCodec===n.audioCodec||g&&i.codecSet===n.codecSet||!p&&i.codecSet!==n.codecSet)continue}l=r;break}}if(l>-1&&n.loadLevel!==l)return e.levelRetry=!0,this.playlistError=0,{action:2,flags:0,nextAutoLevel:l}}return{action:2,flags:1}}onErrorOut(e,t){var n;switch(null==(n=t.errorAction)?void 0:n.action){case 0:break;case 2:this.sendAlternateToPenaltyBox(t),t.errorAction.resolved||t.details===Ue.FRAG_GAP?/MediaSource readyState: ended/.test(t.error.message)&&(this.warn(`MediaSource ended after "${t.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError()):t.fatal=!0}t.fatal&&this.hls.stopLoad()}sendAlternateToPenaltyBox(e){const t=this.hls,n=e.errorAction;if(!n)return;const{flags:i}=n,r=n.nextAutoLevel;switch(i){case 0:this.switchLevel(e,r);break;case 2:{const i=this.getVariantLevelIndex(e.frag),r=t.levels[i],s=null==r?void 0:r.attrs["HDCP-LEVEL"];if(n.hdcpLevel=s,"NONE"===s)this.warn("HDCP policy resticted output with HDCP-LEVEL=NONE");else if(s){t.maxHdcpLevel=kn[kn.indexOf(s)-1],n.resolved=!0,this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`);break}}case 4:{const t=e.decryptdata;if(t){const i=this.hls.levels,r=i.length;for(let n=r;n--;){var s,a;this.variantHasKey(i[n],t)&&(this.log(`Banned key found in level ${n} (${i[n].bitrate}bps) or audio group "${null==(s=i[n].audioGroups)?void 0:s.join(",")}" (${null==(a=e.frag)?void 0:a.type} fragment) ${ut(t.keyId||[])}`),i[n].fragmentError++,i[n].loadError++,this.log(`Removing level ${n} with key error (${e.error})`),this.hls.removeLevel(n))}const o=e.frag;if(this.hls.levels.length<r)n.resolved=!0;else if(o&&o.type!==qe){const e=o.decryptdata;e&&!t.matches(e)&&(n.resolved=!0)}}break}}n.resolved||this.switchLevel(e,r)}switchLevel(e,t){if(void 0!==t&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel,e.details===Ue.BUFFER_ADD_CODEC_ERROR&&e.mimeType&&"audiovideo"!==e.sourceBufferName)){const t=mn(e.mimeType),n=this.hls.levels;for(let i=n.length;i--;)n[i][`${e.sourceBufferName}Codec`]===t&&(this.log(`Removing level ${i} for ${e.details} ("${t}" not supported)`),this.hls.removeLevel(i))}}},fpsController:class{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on($e.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.on($e.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListeners(){this.hls.off($e.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.off($e.MEDIA_DETACHING,this.onMediaDetaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const n=this.hls.config;if(n.capLevelOnFPSDrop){const e=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=e,e&&"function"==typeof e.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),n.fpsDroppedMonitoringPeriod)}}onMediaDetaching(){this.media=null}checkFPS(e,t,n){const i=performance.now();if(t){if(this.lastTime){const e=i-this.lastTime,r=n-this.lastDroppedFrames,s=t-this.lastDecodedFrames,a=1e3*r/e,o=this.hls;if(o.trigger($e.FPS_DROP,{currentDropped:r,currentDecoded:s,totalDroppedFrames:n}),a>0&&r>o.config.fpsDroppedMonitoringThreshold*s){let e=o.currentLevel;o.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+e),e>0&&(-1===o.autoLevelCapping||o.autoLevelCapping>=e)&&(e-=1,o.trigger($e.FPS_DROP_LEVEL_CAPPING,{level:e,droppedLevel:o.currentLevel}),o.autoLevelCapping=e,this.streamController.nextLevelSwitch())}}this.lastTime=i,this.lastDroppedFrames=n,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}},stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:Ki,requireKeySystemAccessOnStart:!1,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableEmsgKLVMetadata:!1,enableID3MetadataCues:!0,enableInterstitialPlayback:!0,interstitialAppendInPlace:!0,interstitialLiveLookAhead:10,useMediaCapabilities:!0,preserveManualLevelOnError:!1,certLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null}},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},interstitialAssetListLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:3e4,timeoutRetry:{maxNumRetry:0,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:0,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},{cueHandler:Kl,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{},{subtitleStreamController:class extends Hr{constructor(e,t,n){super(e,t,n,"subtitle-stream-controller",We),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on($e.LEVEL_LOADED,this.onLevelLoaded,this),e.on($e.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on($e.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on($e.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on($e.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on($e.BUFFER_FLUSHING,this.onBufferFlushing,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off($e.LEVEL_LOADED,this.onLevelLoaded,this),e.off($e.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off($e.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off($e.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off($e.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off($e.BUFFER_FLUSHING,this.onBufferFlushing,this)}startLoad(e,t){this.stopLoad(),this.state=Nr,this.setInterval(500),this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}onManifestLoading(){super.onManifestLoading(),this.mainDetails=null}onMediaDetaching(e,t){this.tracksBuffered=[],super.onMediaDetaching(e,t)}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:n,success:i}=t;if(this.fragContextChanged(n)||(xt(n)&&(this.fragPrevious=n),this.state=Nr),!i)return;const r=this.tracksBuffered[this.currentTrackId];if(!r)return;let s;const a=n.start;for(let e=0;e<r.length;e++)if(a>=r[e].start&&a<=r[e].end){s=r[e];break}const o=n.start+n.duration;s?s.end=o:(s={start:a,end:o},r.push(s)),this.fragmentTracker.fragBuffered(n),this.fragBufferedComplete(n,null),this.media&&this.tick()}onBufferFlushing(e,t){const{startOffset:n,endOffset:i}=t;if(0===n&&i!==Number.POSITIVE_INFINITY){const e=i-1;if(e<=0)return;t.endOffsetSubtitles=Math.max(0,e),this.tracksBuffered.forEach(t=>{for(let n=0;n<t.length;)if(t[n].end<=e)t.shift();else{if(!(t[n].start<e))break;t[n].start=e,n++}}),this.fragmentTracker.removeFragmentsInRange(n,e,We)}}onError(e,t){const n=t.frag;(null==n?void 0:n.type)===We&&(t.details===Ue.FRAG_GAP&&this.fragmentTracker.fragBuffered(n,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==Or&&(this.state=Nr))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){this.levels&&wa(this.levels,t)?this.levels=t.map(e=>new An(e)):(this.tracksBuffered=[],this.levels=t.map(e=>{const t=new An(e);return this.tracksBuffered[t.id]=[],t}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,We),this.fragPrevious=null,this.mediaBuffer=null)}onSubtitleTrackSwitch(e,t){var n;if(this.currentTrackId=t.id,null==(n=this.levels)||!n.length||-1===this.currentTrackId)return void this.clearInterval();const i=this.levels[this.currentTrackId];null!=i&&i.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,i&&this.state!==Or&&this.setInterval(500)}onSubtitleTrackLoaded(e,t){var n;const{currentTrackId:i,levels:r}=this,{details:s,id:a}=t;if(!r)return void this.warn(`Subtitle tracks were reset while loading level ${a}`);const o=r[a];if(a>=r.length||!o)return;this.log(`Subtitle track ${a} loaded [${s.startSN},${s.endSN}]${s.lastPartSn?`[part-${s.lastPartSn}-${s.lastPartIndex}]`:""},duration:${s.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let l=0;if(s.live||null!=(n=o.details)&&n.live){if(s.deltaUpdateFailed)return;const e=this.mainDetails;if(!e)return void(this.startFragRequested=!1);const t=e.fragments[0];var c;o.details?(l=this.alignPlaylists(s,o.details,null==(c=this.levelLastLoaded)?void 0:c.details),0===l&&t&&(l=t.start,br(s,l))):s.hasProgramDateTime&&e.hasProgramDateTime?(Cr(s,e),l=s.fragmentStart):t&&(l=t.start,br(s,l)),e&&!this.startFragRequested&&this.setStartPosition(e,l)}o.details=s,this.levelLastLoaded=o,a===i&&(this.hls.trigger($e.SUBTITLE_TRACK_UPDATED,{details:s,id:a,groupId:t.groupId}),this.tick(),s.live&&!this.fragCurrent&&this.media&&this.state===Nr)&&($n(null,s.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),o.details=void 0))}_handleFragmentLoadComplete(e){const{frag:t,payload:n}=e,i=t.decryptdata,r=this.hls;if(!this.fragContextChanged(t)&&n&&n.byteLength>0&&null!=i&&i.key&&i.iv&&Oi(i.method)){const e=performance.now();this.decrypter.decrypt(new Uint8Array(n),i.key.buffer,i.iv.buffer,Ni(i.method)).catch(e=>{throw r.trigger($e.ERROR,{type:Be.MEDIA_ERROR,details:Ue.FRAG_DECRYPT_ERROR,fatal:!1,error:e,reason:e.message,frag:t}),e}).then(n=>{const i=performance.now();r.trigger($e.FRAG_DECRYPTED,{frag:t,payload:n,stats:{tstart:e,tdecrypt:i}})}).catch(e=>{this.warn(`${e.name}: ${e.message}`),this.state=Nr})}}doTick(){if(this.media){if(this.state===Nr){const{currentTrackId:e,levels:t}=this,n=null==t?void 0:t[e];if(!n||!t.length||!n.details)return;if(this.waitForLive(n))return;const{config:i}=this,r=this.getLoadPosition(),s=bi.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],r,i.maxBufferHole),{end:a,len:o}=s,l=n.details;if(o>this.hls.maxBufferLength+l.levelTargetDuration)return;const c=l.fragments,u=c.length,h=l.edge;let d=null;const f=this.fragPrevious;if(a<h){const e=i.maxFragLookUpTolerance,t=a>h-e?0:e;d=$n(f,c,Math.max(c[0].start,a),t),!d&&f&&f.start<c[0].start&&(d=c[0])}else d=c[u-1];if(d=this.filterReplacedPrimary(d,n.details),!d)return;const p=c[d.sn-l.startSN-1];if(p&&p.cc===d.cc&&this.fragmentTracker.getState(p)===Jn&&(d=p),this.fragmentTracker.getState(d)===Jn){const e=this.mapToInitFragWhenRequired(d);e&&this.loadFragment(e,n,a)}}}else this.state=Nr}loadFragment(e,t,n){xt(e)?super.loadFragment(e,t,n):this._loadInitSegment(e,t)}get mediaBufferTimeRanges(){return new Jo(this.tracksBuffered[this.currentTrackId]||[])}},subtitleTrackController:class extends Sa{constructor(e){super(e,"subtitle-track-controller"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let e=null;const t=Fo(this.media.textTracks);for(let n=0;n<t.length;n++)if("hidden"===t[n].mode)e=t[n];else if("showing"===t[n].mode){e=t[n];break}const n=this.findTrackForTextTrack(e);this.subtitleTrack!==n&&this.setSubtitleTrack(n)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:e}=this;e.on($e.MEDIA_ATTACHED,this.onMediaAttached,this),e.on($e.MEDIA_DETACHING,this.onMediaDetaching,this),e.on($e.MANIFEST_LOADING,this.onManifestLoading,this),e.on($e.MANIFEST_PARSED,this.onManifestParsed,this),e.on($e.LEVEL_LOADING,this.onLevelLoading,this),e.on($e.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on($e.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on($e.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off($e.MEDIA_ATTACHED,this.onMediaAttached,this),e.off($e.MEDIA_DETACHING,this.onMediaDetaching,this),e.off($e.MANIFEST_LOADING,this.onManifestLoading,this),e.off($e.MANIFEST_PARSED,this.onManifestParsed,this),e.off($e.LEVEL_LOADING,this.onLevelLoading,this),e.off($e.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off($e.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off($e.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(e,t){const n=this.media;if(!n)return;const i=!!t.transferMedia;self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||n.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),this.subtitleTrack=-1,this.media=null,i||Fo(n.textTracks).forEach(e=>{No(e)})}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:n,groupId:i,details:r}=t,s=this.tracksInGroup[n];if(!s||s.groupId!==i)return void this.warn(`Subtitle track with id:${n} and group:${i} not found in active group ${null==s?void 0:s.groupId}`);const a=s.details;s.details=t.details,this.log(`Subtitle track ${n} "${s.name}" lang:${s.lang} group:${i} loaded [${r.startSN}-${r.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,a)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const n=t.subtitleGroups||null,i=this.groupIds;let r=this.currentTrack;if(!n||(null==i?void 0:i.length)!==(null==n?void 0:n.length)||null!=n&&n.some(e=>-1===(null==i?void 0:i.indexOf(e)))){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const e=this.tracks.filter(e=>!n||-1!==n.indexOf(e.groupId));if(e.length)this.selectDefaultTrack&&!e.some(e=>e.default)&&(this.selectDefaultTrack=!1),e.forEach((e,t)=>{e.id=t});else if(!r&&!this.tracksInGroup.length)return;this.tracksInGroup=e;const t=this.hls.config.subtitlePreference;if(!r&&t){this.selectDefaultTrack=!1;const n=On(t,e);if(n>-1)r=e[n];else{const e=On(t,this.tracks);r=this.tracks[e]}}let i=this.findTrackId(r);-1===i&&r&&(i=this.findTrackId(null));const s={subtitleTracks:e};this.log(`Updating subtitle tracks, ${e.length} track(s) found in "${null==n?void 0:n.join(",")}" group-id`),this.hls.trigger($e.SUBTITLE_TRACKS_UPDATED,s),-1!==i&&-1===this.trackId&&this.setSubtitleTrack(i)}}findTrackId(e){const t=this.tracksInGroup,n=this.selectDefaultTrack;for(let i=0;i<t.length;i++){const r=t[i];if((!n||r.default)&&(n||e)&&(!e||Nn(r,e)))return i}if(e){for(let n=0;n<t.length;n++){const i=t[n];if(Ta(e.attrs,i.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return n}for(let n=0;n<t.length;n++){const i=t[n];if(Ta(e.attrs,i.attrs,["LANGUAGE"]))return n}}return-1}findTrackForTextTrack(e){if(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++)if(ka(t[n],e))return n}return-1}onError(e,t){!t.fatal&&t.context&&(t.context.type!==Ve||t.context.id!==this.trackId||this.groupIds&&-1===this.groupIds.indexOf(t.context.groupId)||this.checkRetry(t))}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){if(-1===e.id)return this.setSubtitleTrack(-1),null;const t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){const n=this.currentTrack;if(n&&Nn(e,n))return n;const i=On(e,this.tracksInGroup);if(i>-1){const e=this.tracksInGroup[i];return this.setSubtitleTrack(i),e}if(n)return null;{const n=On(e,t);if(n>-1)return t[n]}}}return null}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentTrack)&&this.scheduleLoading(this.currentTrack,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const n=e.id,i=e.groupId,r=this.getUrlWithDirectives(e.url,t),s=e.details,a=null==s?void 0:s.age;this.log(`Loading subtitle ${n} "${e.name}" lang:${e.lang} group:${i}${void 0!==(null==t?void 0:t.msn)?" at sn "+t.msn+" part "+t.part:""}${a&&s.live?" age "+a.toFixed(1)+(s.type?" "+s.type||0:""):""} ${r}`),this.hls.trigger($e.SUBTITLE_TRACK_LOADING,{url:r,id:n,groupId:i,deliveryDirectives:t||null,track:e})}toggleTrackModes(){const{media:e}=this;if(!e)return;const t=Fo(e.textTracks),n=this.currentTrack;let i;if(n&&(i=t.filter(e=>ka(n,e))[0],i||this.warn(`Unable to find subtitle TextTrack with name "${n.name}" and language "${n.lang}"`)),[].slice.call(t).forEach(e=>{"disabled"!==e.mode&&e!==i&&(e.mode="disabled")}),i){const e=this.subtitleDisplay?"showing":"hidden";i.mode!==e&&(i.mode=e)}}setSubtitleTrack(e){const t=this.tracksInGroup;if(!this.media)return void(this.queuedDefaultTrack=e);if(e<-1||e>=t.length||!Ne(e))return void this.warn(`Invalid subtitle track id: ${e}`);this.selectDefaultTrack=!1;const n=this.currentTrack,i=t[e]||null;if(this.trackId=e,this.currentTrack=i,this.toggleTrackModes(),!i)return void this.hls.trigger($e.SUBTITLE_TRACK_SWITCH,{id:e});const r=!!i.details&&!i.details.live;if(e===this.trackId&&i===n&&r)return;this.log(`Switching to subtitle-track ${e}`+(i?` "${i.name}" lang:${i.lang} group:${i.groupId}`:""));const{id:s,groupId:a="",name:o,type:l,url:c}=i;this.hls.trigger($e.SUBTITLE_TRACK_SWITCH,{id:s,groupId:a,name:o,type:l,url:c});const u=this.switchParams(i.url,null==n?void 0:n.details,i.details);this.loadPlaylist(u)}},timelineController:class{constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on($e.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on($e.MEDIA_DETACHING,this.onMediaDetaching,this),e.on($e.MANIFEST_LOADING,this.onManifestLoading,this),e.on($e.MANIFEST_LOADED,this.onManifestLoaded,this),e.on($e.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on($e.FRAG_LOADING,this.onFragLoading,this),e.on($e.FRAG_LOADED,this.onFragLoaded,this),e.on($e.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on($e.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on($e.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on($e.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on($e.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off($e.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off($e.MEDIA_DETACHING,this.onMediaDetaching,this),e.off($e.MANIFEST_LOADING,this.onManifestLoading,this),e.off($e.MANIFEST_LOADED,this.onManifestLoaded,this),e.off($e.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off($e.FRAG_LOADING,this.onFragLoading,this),e.off($e.FRAG_LOADED,this.onFragLoaded,this),e.off($e.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off($e.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off($e.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off($e.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off($e.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.media=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){const e=new Gl(this,"textTrack1"),t=new Gl(this,"textTrack2"),n=new Gl(this,"textTrack3"),i=new Gl(this,"textTrack4");this.cea608Parser1=new ml(1,e,t),this.cea608Parser2=new ml(3,n,i)}addCues(e,t,n,i,r){let s=!1;for(let e=r.length;e--;){const i=r[e],a=Hl(i[0],i[1],t,n);if(a>=0&&(i[0]=Math.min(i[0],t),i[1]=Math.max(i[1],n),s=!0,a/(n-t)>.5))return}if(s||r.push([t,n]),this.config.renderTextTracksNatively){const r=this.captionsTracks[e];this.Cues.newCue(r,t,n,i)}else{const r=this.Cues.newCue(null,t,n,i);this.hls.trigger($e.CUES_PARSED,{type:"captions",cues:r,track:e})}}onInitPtsFound(e,{frag:t,id:n,initPTS:i,timescale:r,trackId:s}){const{unparsedVttFrags:a}=this;n===qe&&(this.initPTS[t.cc]={baseTime:i,timescale:r,trackId:s}),a.length&&(this.unparsedVttFrags=[],a.forEach(e=>{this.initPTS[e.frag.cc]?this.onFragLoaded($e.FRAG_LOADED,e):this.hls.trigger($e.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e.frag,error:new Error("Subtitle discontinuity domain does not match main")})}))}getExistingTrack(e,t){const{media:n}=this;if(n)for(let i=0;i<n.textTracks.length;i++){const r=n.textTracks[i];if(ql(r,{name:e,lang:t,characteristics:"transcribes-spoken-dialog,describes-music-and-sound"}))return r}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:n,media:i}=this,{label:r,languageCode:s}=t[e],a=this.getExistingTrack(r,s);if(a)n[e]=a,No(n[e]),Po(n[e],i);else{const t=this.createTextTrack("captions",r,s);t&&(t[e]=!0,n[e]=t)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const n={_id:e,label:t.label,kind:"captions",default:!!t.media&&!!t.media.default,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=n,this.hls.trigger($e.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[n]})}createTextTrack(e,t,n){const i=this.media;if(i)return i.addTextTrack(e,t,n)}onMediaAttaching(e,t){this.media=t.media,t.mediaSource||this._cleanTracks()}onMediaDetaching(e,t){const n=!!t.transferMedia;if(this.media=null,n)return;const{captionsTracks:i}=this;Object.keys(i).forEach(e=>{No(i[e]),delete i[e]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let e=0;e<t.length;e++)No(t[e])}onSubtitleTracksUpdated(e,t){const n=t.subtitleTracks||[],i=n.some(e=>e.textCodec===Dl);if(this.config.enableWebVTT||i&&this.config.enableIMSC1){if(wa(this.tracks,n))return void(this.tracks=n);if(this.textTracks=[],this.tracks=n,this.config.renderTextTracksNatively){const e=this.media,t=e?Fo(e.textTracks):null;if(this.tracks.forEach((e,n)=>{let i;if(t){let n=null;for(let i=0;i<t.length;i++)if(t[i]&&ql(t[i],e)){n=t[i],t[i]=null;break}n&&(i=n)}if(i)No(i);else{const t=Vl(e);i=this.createTextTrack(t,e.name,e.lang),i&&(i.mode="disabled")}i&&this.textTracks.push(i)}),null!=t&&t.length){const e=t.filter(e=>null!==e).map(e=>e.label);e.length&&this.hls.logger.warn(`Media element contains unused subtitle tracks: ${e.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const e=this.tracks.map(e=>({label:e.name,kind:e.type.toLowerCase(),default:e.default,subtitleTrack:e}));this.hls.trigger($e.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:e})}}}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(e=>{const t=/(?:CC|SERVICE)([1-4])/.exec(e.instreamId);if(!t)return;const n=`textTrack${t[1]}`,i=this.captionsProperties[n];i&&(i.label=e.name,e.lang&&(i.languageCode=e.lang),i.media=e)})}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return null==t?void 0:t.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){if(this.enabled&&t.frag.type===qe){var n,i;const{cea608Parser1:e,cea608Parser2:r,lastSn:s}=this,{cc:a,sn:o}=t.frag,l=null!=(n=null==(i=t.part)?void 0:i.index)?n:-1;e&&r&&(o!==s+1||o===s&&l!==this.lastPartIndex+1||a!==this.lastCc)&&(e.reset(),r.reset()),this.lastCc=a,this.lastSn=o,this.lastPartIndex=l}}onFragLoaded(e,t){const{frag:n,payload:i}=t;if(n.type===We)if(i.byteLength){const e=n.decryptdata,r="stats"in t;if(null==e||!e.encrypted||r){const e=this.tracks[n.level],r=this.vttCCs;r[n.cc]||(r[n.cc]={start:n.start,prevCC:this.prevCC,new:!0},this.prevCC=n.cc),e&&e.textCodec===Dl?this._parseIMSC1(n,i):this._parseVTTs(t)}}else this.hls.trigger($e.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const n=this.hls;Ml(t,this.initPTS[e.cc],t=>{this._appendCues(t,e.level),n.trigger($e.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},t=>{n.logger.log(`Failed to parse IMSC1: ${t}`),n.trigger($e.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:t})})}_parseVTTs(e){var t;const{frag:n,payload:i}=e,{initPTS:r,unparsedVttFrags:s}=this,a=r.length-1;if(!r[n.cc]&&-1===a)return void s.push(e);const o=this.hls;!function(e,t,n,i,r,s,a){const o=new Al,l=ct(new Uint8Array(e)).trim().replace(Rl,"\n").split("\n"),c=[],u=t?function(e,t=1){return ta(e,9e4,1/t)}(t.baseTime,t.timescale):0;let h,d="00:00.000",f=0,p=0,g=!0;o.oncue=function(e){const s=n[i];let a=n.ccOffset;const o=(f-u)/9e4;if(null!=s&&s.new&&(void 0!==p?a=n.ccOffset=s.start:function(e,t,n){let i=e[t],r=e[i.prevCC];if(!r||!r.new&&i.new)return e.ccOffset=e.presentationOffset=i.start,void(i.new=!1);for(;null!=(s=r)&&s.new;){var s;e.ccOffset+=i.start-r.start,i.new=!1,i=r,r=e[i.prevCC]}e.presentationOffset=n}(n,i,o)),o){if(!t)return void(h=new Error("Missing initPTS for VTT MPEGTS"));a=o-n.presentationOffset}const l=e.endTime-e.startTime,d=la(9e4*(e.startTime+a-p),9e4*r)/9e4;e.startTime=Math.max(d,0),e.endTime=Math.max(d+l,0);const g=e.text.trim();e.text=decodeURIComponent(encodeURIComponent(g)),e.id||(e.id=Cl(e.startTime,e.endTime,g)),e.endTime>0&&c.push(e)},o.onparsingerror=function(e){h=e},o.onflush=function(){h?a(h):s(c)},l.forEach(e=>{if(g){if(Il(e,"X-TIMESTAMP-MAP=")){g=!1,e.slice(16).split(",").forEach(e=>{Il(e,"LOCAL:")?d=e.slice(6):Il(e,"MPEGTS:")&&(f=parseInt(e.slice(7)))});try{p=function(e){let t=parseInt(e.slice(-3));const n=parseInt(e.slice(-6,-4)),i=parseInt(e.slice(-9,-7)),r=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!(Ne(t)&&Ne(n)&&Ne(i)&&Ne(r)))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*n,t+=6e4*i,t+=36e5*r,t}(d)/1e3}catch(e){h=e}return}""===e&&(g=!1)}o.parse(e+"\n")}),o.flush()}(null!=(t=n.initSegment)&&t.data?Wt(n.initSegment.data,new Uint8Array(i)).buffer:i,this.initPTS[n.cc],this.vttCCs,n.cc,n.start,e=>{this._appendCues(e,n.level),o.trigger($e.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:n})},t=>{const r="Missing initPTS for VTT MPEGTS"===t.message;r?s.push(e):this._fallbackToIMSC1(n,i),o.logger.log(`Failed to parse VTT cue: ${t}`),r&&a>n.cc||o.trigger($e.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:t})})}_fallbackToIMSC1(e,t){const n=this.tracks[e.level];n.textCodec||Ml(t,this.initPTS[e.cc],()=>{n.textCodec=Dl,this._parseIMSC1(e,t)},()=>{n.textCodec="wvtt"})}_appendCues(e,t){const n=this.hls;if(this.config.renderTextTracksNatively){const n=this.textTracks[t];if(!n||"disabled"===n.mode)return;e.forEach(e=>Oo(n,e))}else{const i=this.tracks[t];if(!i)return;const r=i.default?"default":"subtitles"+t;n.trigger($e.CUES_PARSED,{type:"subtitles",cues:e,track:r})}}onFragDecrypted(e,t){const{frag:n}=t;n.type===We&&this.onFragLoaded($e.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){if(!this.enabled||!this.config.enableCEA708Captions)return;const{frag:n,samples:i}=t;if(n.type!==qe||"NONE"!==this.closedCaptionsForLevel(n))for(let e=0;e<i.length;e++){const t=i[e].bytes;if(t){this.cea608Parser1||this.initCea608Parsers();const n=this.extractCea608Data(t);this.cea608Parser1.addData(i[e].pts,n[0]),this.cea608Parser2.addData(i[e].pts,n[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:n,endOffsetSubtitles:i,type:r}){const{media:s}=this;if(s&&!(s.currentTime<n)){if(!r||"video"===r){const{captionsTracks:e}=this;Object.keys(e).forEach(i=>Mo(e[i],t,n))}if(this.config.renderTextTracksNatively&&0===t&&void 0!==i){const{textTracks:e}=this;Object.keys(e).forEach(n=>Mo(e[n],t,i))}}}extractCea608Data(e){const t=[[],[]],n=31&e[0];let i=2;for(let r=0;r<n;r++){const n=e[i++],r=127&e[i++],s=127&e[i++];if((0!==r||0!==s)&&4&n){const e=3&n;0!==e&&1!==e||(t[e].push(r),t[e].push(s))}}return t}},audioStreamController:class extends Hr{constructor(e,t,n){super(e,t,n,"audio-stream-controller",He),this.mainAnchor=null,this.mainFragLoading=null,this.audioOnly=!1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.resetItem()}resetItem(){this.mainDetails=this.mainAnchor=this.mainFragLoading=this.bufferedTrack=this.switchingTrack=this.waitingData=this.cachedTrackLoadedData=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on($e.LEVEL_LOADED,this.onLevelLoaded,this),e.on($e.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on($e.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on($e.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on($e.BUFFER_RESET,this.onBufferReset,this),e.on($e.BUFFER_CREATED,this.onBufferCreated,this),e.on($e.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on($e.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on($e.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on($e.FRAG_LOADING,this.onFragLoading,this),e.on($e.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){const{hls:e}=this;e&&(super.unregisterListeners(),e.off($e.LEVEL_LOADED,this.onLevelLoaded,this),e.off($e.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off($e.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off($e.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off($e.BUFFER_RESET,this.onBufferReset,this),e.off($e.BUFFER_CREATED,this.onBufferCreated,this),e.off($e.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off($e.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off($e.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off($e.FRAG_LOADING,this.onFragLoading,this),e.off($e.FRAG_BUFFERED,this.onFragBuffered,this))}onInitPtsFound(e,{frag:t,id:n,initPTS:i,timescale:r,trackId:s}){if(n===qe){const e=t.cc,n=this.fragCurrent;if(this.initPTS[e]={baseTime:i,timescale:r,trackId:s},this.log(`InitPTS for cc: ${e} found from main: ${i/r} (${i}/${r}) trackId: ${s}`),this.mainAnchor=t,this.state===Vr){const n=this.waitingData;(!n&&!this.loadingParts||n&&n.frag.cc!==e)&&this.syncWithAnchor(t,null==n?void 0:n.frag)}else!this.hls.hasEnoughToStart&&n&&n.cc!==e?(n.abortRequests(),this.syncWithAnchor(t,n)):this.state===Nr&&this.tick()}}getLoadPosition(){return!this.startFragRequested&&this.nextLoadPosition>=0?this.nextLoadPosition:super.getLoadPosition()}syncWithAnchor(e,t){var n;const i=(null==(n=this.mainFragLoading)?void 0:n.frag)||null;if(t&&(null==i?void 0:i.cc)===t.cc)return;const r=(i||e).cc,s=Gn(this.getLevelDetails(),r,this.getLoadPosition());s&&(this.log(`Syncing with main frag at ${s.start} cc ${s.cc}`),this.startFragRequested=!1,this.nextLoadPosition=s.start,this.resetLoadingState(),this.state===Nr&&this.doTickIdle())}startLoad(e,t){if(!this.levels)return this.startPosition=e,void(this.state=Or);const n=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),n>0&&-1===e?(this.log(`Override startPosition with lastCurrentTime @${n.toFixed(3)}`),e=n,this.state=Nr):this.state=Ur,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}doTick(){switch(this.state){case Nr:this.doTickIdle();break;case Ur:{const{levels:e,trackId:t}=this,n=null==e?void 0:e[t],i=null==n?void 0:n.details;if(i&&!this.waitForLive(n)){if(this.waitForCdnTuneIn(i))break;this.state=Vr}break}case Br:this.checkRetryDate();break;case Vr:{const e=this.waitingData;if(e){const{frag:t,part:n,cache:i,complete:r}=e,s=this.mainAnchor;if(void 0!==this.initPTS[t.cc]){this.waitingData=null,this.state=Fr;const e={frag:t,part:n,payload:i.flush().buffer,networkDetails:null};this._handleFragmentLoadProgress(e),r&&super._handleFragmentLoadComplete(e)}else s&&s.cc!==e.frag.cc&&this.syncWithAnchor(s,e.frag)}else this.state=Nr}}this.onTickEnd()}resetLoadingState(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null),super.resetLoadingState()}onTickEnd(){const{media:e}=this;null!=e&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){var e;const{hls:t,levels:n,media:i,trackId:r}=this,s=t.config;if(!this.buffering||!i&&!this.primaryPrefetch&&(this.startFragRequested||!s.startFragPrefetch)||null==n||!n[r])return;const a=n[r],o=a.details;if(!o||this.waitForLive(a)||this.waitForCdnTuneIn(o))return this.state=Ur,void(this.startFragRequested=!1);const l=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&l&&(this.bufferFlushed=!1,this.afterBufferFlushed(l,wt,He));const c=this.getFwdBufferInfo(l,He);if(null===c)return;if(!this.switchingTrack&&this._streamEnded(c,o))return t.trigger($e.BUFFER_EOS,{type:"audio"}),void(this.state=zr);const u=c.len,h=t.maxBufferLength,d=o.fragments,f=d[0].start,p=this.getLoadPosition(),g=this.flushing?p:c.end;if(this.switchingTrack&&i){const e=p;o.PTSKnown&&e<f&&(c.end>f||c.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),i.currentTime=f+.05)}if(u>=h&&!this.switchingTrack&&g<d[d.length-1].start)return;let m=this.getNextFragment(g,o);if(m&&this.isLoopLoading(m,g)&&(m=this.getNextFragmentLoopLoading(m,o,c,qe,h)),!m)return void(this.bufferFlushed=!0);let v=(null==(e=this.mainFragLoading)?void 0:e.frag)||null;if(!this.audioOnly&&this.startFragRequested&&v&&xt(m)&&!m.endList&&(!o.live||!this.loadingParts&&g<this.hls.liveSyncPosition)&&(this.fragmentTracker.getState(v)===ni&&(this.mainFragLoading=v=null),v&&xt(v))){if(m.start>v.end){const e=this.fragmentTracker.getFragAtPos(g,qe);e&&e.end>v.end&&(v=e,this.mainFragLoading={frag:e,targetBufferTime:null})}if(m.start>v.end)return}this.loadFragment(m,a,g)}onMediaDetaching(e,t){this.bufferFlushed=this.flushing=!1,super.onMediaDetaching(e,t)}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(e=>new An(e))}onAudioTrackSwitching(e,t){const n=!!t.url;this.trackId=t.id;const{fragCurrent:i}=this;i&&(i.abortRequests(),this.removeUnbufferedFrags(i.start)),this.resetLoadingState(),n?(this.switchingTrack=t,this.flushAudioIfNeeded(t),this.state!==Or&&(this.setInterval(100),this.state=Nr,this.tick())):(this.resetTransmuxer(),this.switchingTrack=null,this.bufferedTrack=t,this.clearInterval())}onManifestLoading(){super.onManifestLoading(),this.bufferFlushed=this.flushing=this.audioOnly=!1,this.resetItem(),this.trackId=-1}onLevelLoaded(e,t){this.mainDetails=t.details;const n=this.cachedTrackLoadedData;n&&(this.cachedTrackLoadedData=null,this.onAudioTrackLoaded($e.AUDIO_TRACK_LOADED,n))}onAudioTrackLoaded(e,t){var n;const{levels:i}=this,{details:r,id:s,groupId:a,track:o}=t;if(!i)return void this.warn(`Audio tracks reset while loading track ${s} "${o.name}" of "${a}"`);const l=this.mainDetails;if(!l||r.endCC>l.endCC||l.expired)return this.cachedTrackLoadedData=t,void(this.state!==Or&&(this.state=Ur));this.cachedTrackLoadedData=null,this.log(`Audio track ${s} "${o.name}" of "${a}" loaded [${r.startSN},${r.endSN}]${r.lastPartSn?`[part-${r.lastPartSn}-${r.lastPartIndex}]`:""},duration:${r.totalduration}`);const c=i[s];let u=0;if(r.live||null!=(n=c.details)&&n.live){if(this.checkLiveUpdate(r),r.deltaUpdateFailed)return;var h;c.details&&(u=this.alignPlaylists(r,c.details,null==(h=this.levelLastLoaded)?void 0:h.details)),r.alignedSliding||(Ir(r,l),r.alignedSliding||Cr(r,l),u=r.fragmentStart)}c.details=r,this.levelLastLoaded=c,this.startFragRequested||this.setStartPosition(l,u),this.hls.trigger($e.AUDIO_TRACK_UPDATED,{details:r,id:s,groupId:t.groupId}),this.state!==Ur||this.waitForCdnTuneIn(r)||(this.state=Nr),this.tick()}_handleFragmentLoadProgress(e){var t;const n=e.frag,{part:i,payload:r}=e,{config:s,trackId:a,levels:o}=this;if(!o)return void this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);const l=o[a];if(!l)return void this.warn("Audio track is undefined on fragment load progress");const c=l.details;if(!c)return this.warn("Audio track details undefined on fragment load progress"),void this.removeUnbufferedFrags(n.start);const u=s.defaultAudioCodec||l.audioCodec||"mp4a.40.2";let h=this.transmuxer;h||(h=this.transmuxer=new Ea(this.hls,He,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const d=this.initPTS[n.cc],f=null==(t=n.initSegment)?void 0:t.data;if(void 0!==d){const e=!1,t=i?i.index:-1,s=-1!==t,a=new vi(n.level,n.sn,n.stats.chunkCount,r.byteLength,t,s);h.push(r,f,u,"",n,i,c.totalduration,e,a,d)}else{this.log(`Unknown video PTS for cc ${n.cc}, waiting for video PTS before demuxing audio frag ${n.sn} of [${c.startSN} ,${c.endSN}],track ${a}`);const{cache:e}=this.waitingData=this.waitingData||{frag:n,part:i,cache:new Kr,complete:!1};e.push(new Uint8Array(r)),this.state!==Or&&(this.state=Vr)}}_handleFragmentLoadComplete(e){this.waitingData?this.waitingData.complete=!0:super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=null}onBufferCreated(e,t){this.bufferFlushed=this.flushing=!1;const n=t.tracks.audio;n&&(this.mediaBuffer=n.buffer||null)}onFragLoading(e,t){!this.audioOnly&&t.frag.type===qe&&xt(t.frag)&&(this.mainFragLoading=t,this.state===Nr&&this.tick())}onFragBuffered(e,t){const{frag:n,part:i}=t;if(n.type===He)if(this.fragContextChanged(n))this.warn(`Fragment ${n.sn}${i?" p: "+i.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);else{if(xt(n)){this.fragPrevious=n;const e=this.switchingTrack;e&&(this.bufferedTrack=e,this.switchingTrack=null,this.hls.trigger($e.AUDIO_TRACK_SWITCHED,Je({},e)))}this.fragBufferedComplete(n,i),this.media&&this.tick()}else this.audioOnly||n.type!==qe||n.elementaryStreams.video||n.elementaryStreams.audiovideo||(this.audioOnly=!0,this.mainFragLoading=null)}onError(e,t){var n;if(t.fatal)this.state=Gr;else switch(t.details){case Ue.FRAG_GAP:case Ue.FRAG_PARSING_ERROR:case Ue.FRAG_DECRYPT_ERROR:case Ue.FRAG_LOAD_ERROR:case Ue.FRAG_LOAD_TIMEOUT:case Ue.KEY_LOAD_ERROR:case Ue.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(He,t);break;case Ue.AUDIO_TRACK_LOAD_ERROR:case Ue.AUDIO_TRACK_LOAD_TIMEOUT:case Ue.LEVEL_PARSING_ERROR:t.levelRetry||this.state!==Ur||(null==(n=t.context)?void 0:n.type)!==Ge||(this.state=Nr);break;case Ue.BUFFER_ADD_CODEC_ERROR:case Ue.BUFFER_APPEND_ERROR:if("audio"!==t.parent)return;this.reduceLengthAndFlushBuffer(t)||this.resetLoadingState();break;case Ue.BUFFER_FULL_ERROR:if("audio"!==t.parent)return;this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case Ue.INTERNAL_EXCEPTION:this.recoverWorkerError(t)}}onBufferFlushing(e,{type:t}){t!==Tt&&(this.flushing=!0)}onBufferFlushed(e,{type:t}){if(t!==Tt){this.flushing=!1,this.bufferFlushed=!0,this.state===zr&&(this.state=Nr);const e=this.mediaBuffer||this.media;e&&(this.afterBufferFlushed(e,t,He),this.tick())}}_handleTransmuxComplete(e){var t;const n="audio",{hls:i}=this,{remuxResult:r,chunkMeta:s}=e,a=this.getCurrentContext(s);if(!a)return void this.resetWhenMissingContext(s);const{frag:o,part:l,level:c}=a,{details:u}=c,{audio:h,text:d,id3:f,initSegment:p}=r;if(!this.fragContextChanged(o)&&u){if(this.state=$r,this.switchingTrack&&h&&this.completeAudioSwitch(this.switchingTrack),null!=p&&p.tracks){const e=o.initSegment||o;if(this.unhandledEncryptionError(p,o))return;this._bufferInitSegment(c,p.tracks,e,s),i.trigger($e.FRAG_PARSING_INIT_SEGMENT,{frag:e,id:n,tracks:p.tracks})}if(h){const{startPTS:e,endPTS:t,startDTS:n,endDTS:i}=h;l&&(l.elementaryStreams[wt]={startPTS:e,endPTS:t,startDTS:n,endDTS:i}),o.setElementaryStreamInfo(wt,e,t,n,i),this.bufferFragmentData(h,o,l,s)}if(null!=f&&null!=(t=f.samples)&&t.length){const e=Qe({id:n,frag:o,details:u},f);i.trigger($e.FRAG_PARSING_METADATA,e)}if(d){const e=Qe({id:n,frag:o,details:u},d);i.trigger($e.FRAG_PARSING_USERDATA,e)}}else this.fragmentTracker.removeFragment(o)}_bufferInitSegment(e,t,n,i){if(this.state!==$r)return;if(t.video&&delete t.video,t.audiovideo&&delete t.audiovideo,!t.audio)return;const r=t.audio;r.id=He;const s=e.audioCodec;this.log(`Init audio buffer, container:${r.container}, codecs[level/parsed]=[${s}/${r.codec}]`),s&&1===s.split(",").length&&(r.levelCodec=s),this.hls.trigger($e.BUFFER_CODECS,t);const a=r.initSegment;if(null!=a&&a.byteLength){const e={type:"audio",frag:n,part:null,chunkMeta:i,parent:n.type,data:a};this.hls.trigger($e.BUFFER_APPENDING,e)}this.tickImmediate()}loadFragment(e,t,n){const i=this.fragmentTracker.getState(e);var r;if(this.switchingTrack||i===Jn||i===ti)if(xt(e))if(null!=(r=t.details)&&r.live&&!this.initPTS[e.cc]){this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=Vr;const n=this.mainDetails;n&&n.fragmentStart!==t.details.fragmentStart&&Cr(t.details,n)}else super.loadFragment(e,t,n);else this._loadInitSegment(e,t);else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){if(this.media&&this.bufferedTrack){const{name:t,lang:n,assocLang:i,characteristics:r,audioCodec:s,channels:a}=this.bufferedTrack;Nn({name:t,lang:n,assocLang:i,characteristics:r,audioCodec:s,channels:a},e,Mn)||(Bn(e.url,this.hls)?(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null):this.bufferedTrack=e)}}completeAudioSwitch(e){const{hls:t}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger($e.AUDIO_TRACK_SWITCHED,Je({},e))}},audioTrackController:class extends Sa{constructor(e){super(e,"audio-track-controller"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on($e.MANIFEST_LOADING,this.onManifestLoading,this),e.on($e.MANIFEST_PARSED,this.onManifestParsed,this),e.on($e.LEVEL_LOADING,this.onLevelLoading,this),e.on($e.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on($e.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on($e.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off($e.MANIFEST_LOADING,this.onManifestLoading,this),e.off($e.MANIFEST_PARSED,this.onManifestParsed,this),e.off($e.LEVEL_LOADING,this.onLevelLoading,this),e.off($e.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off($e.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off($e.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:n,groupId:i,details:r}=t,s=this.tracksInGroup[n];if(!s||s.groupId!==i)return void this.warn(`Audio track with id:${n} and group:${i} not found in active group ${null==s?void 0:s.groupId}`);const a=s.details;s.details=t.details,this.log(`Audio track ${n} "${s.name}" lang:${s.lang} group:${i} loaded [${r.startSN}-${r.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,a)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const n=t.audioGroups||null,i=this.groupIds;let r=this.currentTrack;if(!n||(null==i?void 0:i.length)!==(null==n?void 0:n.length)||null!=n&&n.some(e=>-1===(null==i?void 0:i.indexOf(e)))){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const e=this.tracks.filter(e=>!n||-1!==n.indexOf(e.groupId));if(e.length)this.selectDefaultTrack&&!e.some(e=>e.default)&&(this.selectDefaultTrack=!1),e.forEach((e,t)=>{e.id=t});else if(!r&&!this.tracksInGroup.length)return;this.tracksInGroup=e;const t=this.hls.config.audioPreference;if(!r&&t){const n=On(t,e,Mn);if(n>-1)r=e[n];else{const e=On(t,this.tracks);r=this.tracks[e]}}let i=this.findTrackId(r);-1===i&&r&&(i=this.findTrackId(null));const a={audioTracks:e};this.log(`Updating audio tracks, ${e.length} track(s) found in group(s): ${null==n?void 0:n.join(",")}`),this.hls.trigger($e.AUDIO_TRACKS_UPDATED,a);const o=this.trackId;if(-1!==i&&-1===o)this.setAudioTrack(i);else if(e.length&&-1===o){var s;const t=new Error(`No audio track selected for current audio group-ID(s): ${null==(s=this.groupIds)?void 0:s.join(",")} track count: ${e.length}`);this.warn(t.message),this.hls.trigger($e.ERROR,{type:Be.MEDIA_ERROR,details:Ue.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:t})}}}onError(e,t){!t.fatal&&t.context&&(t.context.type!==Ge||t.context.id!==this.trackId||this.groupIds&&-1===this.groupIds.indexOf(t.context.groupId)||this.checkRetry(t))}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){const t=this.hls;if(t.config.audioPreference=e,e){const n=this.allAudioTracks;if(this.selectDefaultTrack=!1,n.length){const i=this.currentTrack;if(i&&Nn(e,i,Mn))return i;const r=On(e,this.tracksInGroup,Mn);if(r>-1){const e=this.tracksInGroup[r];return this.setAudioTrack(r),e}if(i){let i=t.loadLevel;-1===i&&(i=t.firstAutoLevel);const r=function(e,t,n,i,r){const s=t[i],a=t.reduce((e,t,n)=>{const i=t.uri;return(e[i]||(e[i]=[])).push(n),e},{})[s.uri];a.length>1&&(i=Math.max.apply(Math,a));const o=s.videoRange,l=s.frameRate,c=s.codecSet.substring(0,4),u=Fn(t,i,t=>{if(t.videoRange!==o||t.frameRate!==l||t.codecSet.substring(0,4)!==c)return!1;const i=t.audioGroups,s=n.filter(e=>!i||-1!==i.indexOf(e.groupId));return On(e,s,r)>-1});return u>-1?u:Fn(t,i,t=>{const i=t.audioGroups,s=n.filter(e=>!i||-1!==i.indexOf(e.groupId));return On(e,s,r)>-1})}(e,t.levels,n,i,Mn);if(-1===r)return null;t.nextLoadLevel=r}if(e.channels||e.audioCodec){const t=On(e,n);if(t>-1)return n[t]}}}return null}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length)return void this.warn(`Invalid audio track id: ${e}`);this.selectDefaultTrack=!1;const n=this.currentTrack,i=t[e],r=i.details&&!i.details.live;if(e===this.trackId&&i===n&&r)return;if(this.log(`Switching to audio-track ${e} "${i.name}" lang:${i.lang} group:${i.groupId} channels:${i.channels}`),this.trackId=e,this.currentTrack=i,this.hls.trigger($e.AUDIO_TRACK_SWITCHING,Je({},i)),r)return;const s=this.switchParams(i.url,null==n?void 0:n.details,i.details);this.loadPlaylist(s)}findTrackId(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const i=t[n];if((!this.selectDefaultTrack||i.default)&&(!e||Nn(e,i,Mn)))return n}if(e){const{name:n,lang:i,assocLang:r,characteristics:s,audioCodec:a,channels:o}=e;for(let e=0;e<t.length;e++)if(Nn({name:n,lang:i,assocLang:r,characteristics:s,audioCodec:a,channels:o},t[e],Mn))return e;for(let n=0;n<t.length;n++){const i=t[n];if(Ta(e.attrs,i.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return n}for(let n=0;n<t.length;n++){const i=t[n];if(Ta(e.attrs,i.attrs,["LANGUAGE"]))return n}}return-1}loadPlaylist(e){super.loadPlaylist();const t=this.currentTrack;this.shouldLoadPlaylist(t)&&Bn(t.url,this.hls)&&this.scheduleLoading(t,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const n=e.id,i=e.groupId,r=this.getUrlWithDirectives(e.url,t),s=e.details,a=null==s?void 0:s.age;this.log(`Loading audio-track ${n} "${e.name}" lang:${e.lang} group:${i}${void 0!==(null==t?void 0:t.msn)?" at sn "+t.msn+" part "+t.part:""}${a&&s.live?" age "+a.toFixed(1)+(s.type?" "+s.type||0:""):""} ${r}`),this.hls.trigger($e.AUDIO_TRACK_LOADING,{url:r,id:n,groupId:i,deliveryDirectives:t||null,track:e})}},emeController:Ao,cmcdController:class{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=e=>{try{this.apply(e,{ot:Da,su:!this.initialized})}catch(e){this.hls.logger.warn("Could not generate manifest CMCD data.",e)}},this.applyFragmentData=e=>{try{const{frag:t,part:n}=e,i=this.hls.levels[t.level],r=this.getObjectType(t),s={d:1e3*(n||t).duration,ot:r};r!==Oa&&r!==Pa&&r!=Na||(s.br=i.bitrate/1e3,s.tb=this.getTopBandwidth(r)/1e3,s.bl=this.getBufferLength(r));const a=n?this.getNextPart(n):this.getNextFrag(t);null!=a&&a.url&&a.url!==t.url&&(s.nor=a.url),this.apply(e,s)}catch(e){this.hls.logger.warn("Could not generate segment CMCD data.",e)}},this.hls=e;const t=this.config=e.config,{cmcd:n}=t;null!=n&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=n.sessionId||e.sessionId,this.cid=n.contentId,this.useHeaders=!0===n.useHeaders,this.includeKeys=n.includeKeys,this.registerListeners())}registerListeners(){const e=this.hls;e.on($e.MEDIA_ATTACHED,this.onMediaAttached,this),e.on($e.MEDIA_DETACHED,this.onMediaDetached,this),e.on($e.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off($e.MEDIA_ATTACHED,this.onMediaAttached,this),e.off($e.MEDIA_DETACHED,this.onMediaDetached,this),e.off($e.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=this.media=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var n,i;this.audioBuffer=null==(n=t.tracks.audio)?void 0:n.buffer,this.videoBuffer=null==(i=t.tracks.video)?void 0:i.buffer}createData(){var e;return{v:1,sf:Ba,sid:this.sid,cid:this.cid,pr:null==(e=this.media)?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){Qe(t,this.createData());const n=t.ot===Ma||t.ot===Oa||t.ot===Na;this.starved&&n&&(t.bs=!0,t.su=!0,this.starved=!1),null==t.su&&(t.su=this.buffering);const{includeKeys:i}=this;i&&(t=Object.keys(t).reduce((e,n)=>(i.includes(n)&&(e[n]=t[n]),e),{}));const r={baseUrl:e.url};this.useHeaders?(e.headers||(e.headers={}),To(e.headers,t,r)):e.url=_o(e.url,t,r)}getNextFrag(e){var t;const n=null==(t=this.hls.levels[e.level])?void 0:t.details;if(n){const t=e.sn-n.startSN;return n.fragments[t+1]}}getNextPart(e){var t;const{index:n,fragment:i}=e,r=null==(t=this.hls.levels[i.level])||null==(t=t.details)?void 0:t.partList;if(r){const{sn:e}=i;for(let t=r.length-1;t>=0;t--){const i=r[t];if(i.index===n&&i.fragment.sn===e)return r[t+1]}}}getObjectType(e){const{type:t}=e;return"subtitle"===t?Fa:"initSegment"===e.sn?Ma:"audio"===t?Pa:"main"===t?this.hls.audioTracks.length?Oa:Na:void 0}getTopBandwidth(e){let t,n=0;const i=this.hls;if(e===Pa)t=i.audioTracks;else{const e=i.maxAutoLevel,n=e>-1?e+1:i.levels.length;t=i.levels.slice(0,n)}return t.forEach(e=>{e.bitrate>n&&(n=e.bitrate)}),n>0?n:NaN}getBufferLength(e){const t=this.media,n=e===Pa?this.audioBuffer:this.videoBuffer;return n&&t?1e3*bi.bufferInfo(n,t.currentTime,this.config.maxBufferHole).len:NaN}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,n=e||this.config.loader;return class{constructor(e){this.loader=void 0,this.loader=new n(e)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(e,n,i){t(e),this.loader.load(e,n,i)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,n=e||this.config.loader;return class{constructor(e){this.loader=void 0,this.loader=new n(e)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(e,n,i){t(e),this.loader.load(e,n,i)}}}},contentSteeringController:class extends et{constructor(e){super("content-steering",e.logger),this.hls=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this._pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on($e.MANIFEST_LOADING,this.onManifestLoading,this),e.on($e.MANIFEST_LOADED,this.onManifestLoaded,this),e.on($e.MANIFEST_PARSED,this.onManifestParsed,this),e.on($e.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off($e.MANIFEST_LOADING,this.onManifestLoading,this),e.off($e.MANIFEST_LOADED,this.onManifestLoaded,this),e.off($e.MANIFEST_PARSED,this.onManifestParsed,this),e.off($e.ERROR,this.onError,this))}pathways(){return(this.levels||[]).reduce((e,t)=>(-1===e.indexOf(t.pathwayId)&&e.push(t.pathwayId),e),[])}get pathwayPriority(){return this._pathwayPriority}set pathwayPriority(e){this.updatePathwayPriority(e)}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const e=1e3*this.timeToLoad-(performance.now()-this.updated);if(e>0)return void this.scheduleRefresh(this.uri,e)}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){-1!==this.reloadTimer&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter(t=>t!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:n}=t;null!==n&&(this.pathwayId=n.pathwayId,this.uri=n.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:n}=t;if(2===(null==n?void 0:n.action)&&1===n.flags){const e=this.levels;let i=this._pathwayPriority,r=this.pathwayId;if(t.context){const{groupId:n,pathwayId:i,type:s}=t.context;n&&e?r=this.getPathwayForGroupId(n,s,r):i&&(r=i)}r in this.penalizedPathways||(this.penalizedPathways[r]=performance.now()),!i&&e&&(i=this.pathways()),i&&i.length>1&&(this.updatePathwayPriority(i),n.resolved=this.pathwayId!==r),t.details!==Ue.BUFFER_APPEND_ERROR||t.fatal?n.resolved||this.warn(`Could not resolve ${t.details} ("${t.error.message}") with content-steering for Pathway: ${r} levels: ${e?e.length:e} priorities: ${In(i)} penalized: ${In(this.penalizedPathways)}`):n.resolved=!0}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(0===t.length){const n=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${n}"`),t=this.getLevelsForPathway(n),this.pathwayId=n}return t.length!==e.length&&this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t}getLevelsForPathway(e){return null===this.levels?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){let t;this._pathwayPriority=e;const n=this.penalizedPathways,i=performance.now();Object.keys(n).forEach(e=>{i-n[e]>3e5&&delete n[e]});for(let i=0;i<e.length;i++){const r=e[i];if(r in n)continue;if(r===this.pathwayId)return;const s=this.hls.nextLoadLevel,a=this.hls.levels[s];if(t=this.getLevelsForPathway(r),t.length>0){this.log(`Setting Pathway to "${r}"`),this.pathwayId=r,kr(t),this.hls.trigger($e.LEVELS_UPDATED,{levels:t});const e=this.hls.levels[s];a&&e&&this.levels&&(e.attrs["STABLE-VARIANT-ID"]!==a.attrs["STABLE-VARIANT-ID"]&&e.bitrate!==a.bitrate&&this.log(`Unstable Pathways change from bitrate ${a.bitrate} to ${e.bitrate}`),this.hls.nextLoadLevel=s);break}}}getPathwayForGroupId(e,t,n){const i=this.getLevelsForPathway(n).concat(this.levels||[]);for(let n=0;n<i.length;n++)if(t===Ge&&i[n].hasAudioGroup(e)||t===Ve&&i[n].hasSubtitleGroup(e))return i[n].pathwayId;return n}clonePathways(e){const t=this.levels;if(!t)return;const n={},i={};e.forEach(e=>{const{ID:r,"BASE-ID":s,"URI-REPLACEMENT":a}=e;if(t.some(e=>e.pathwayId===r))return;const o=this.getLevelsForPathway(s).map(e=>{const t=new Li(e.attrs);t["PATHWAY-ID"]=r;const s=t.AUDIO&&`${t.AUDIO}_clone_${r}`,o=t.SUBTITLES&&`${t.SUBTITLES}_clone_${r}`;s&&(n[t.AUDIO]=s,t.AUDIO=s),o&&(i[t.SUBTITLES]=o,t.SUBTITLES=o);const l=Lo(e.uri,t["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",a),c=new An({attrs:t,audioCodec:e.audioCodec,bitrate:e.bitrate,height:e.height,name:e.name,url:l,videoCodec:e.videoCodec,width:e.width});if(e.audioGroups)for(let t=1;t<e.audioGroups.length;t++)c.addGroupId("audio",`${e.audioGroups[t]}_clone_${r}`);if(e.subtitleGroups)for(let t=1;t<e.subtitleGroups.length;t++)c.addGroupId("text",`${e.subtitleGroups[t]}_clone_${r}`);return c});t.push(...o),xo(this.audioTracks,n,a,r),xo(this.subtitleTracks,i,a,r)})}loadSteeringManifest(e){const t=this.hls.config,n=t.loader;let i;this.loader&&this.loader.destroy(),this.loader=new n(t);try{i=new self.URL(e)}catch(t){return this.enabled=!1,void this.log(`Failed to parse Steering Manifest URI: ${e}`)}if("data:"!==i.protocol){const e=0|(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate);i.searchParams.set("_HLS_pathway",this.pathwayId),i.searchParams.set("_HLS_throughput",""+e)}const r={responseType:"json",url:i.href},s=t.steeringManifestLoadPolicy.default,a=s.errorRetry||s.timeoutRetry||{},o={loadPolicy:s,timeout:s.maxLoadTimeMs,maxRetry:a.maxNumRetry||0,retryDelay:a.retryDelayMs||0,maxRetryDelay:a.maxRetryDelayMs||0},l={onSuccess:(e,t,n,r)=>{this.log(`Loaded steering manifest: "${i}"`);const s=e.data;if(1!==(null==s?void 0:s.VERSION))return void this.log(`Steering VERSION ${s.VERSION} not supported!`);this.updated=performance.now(),this.timeToLoad=s.TTL;const{"RELOAD-URI":a,"PATHWAY-CLONES":o,"PATHWAY-PRIORITY":l}=s;if(a)try{this.uri=new self.URL(a,i).href}catch(e){return this.enabled=!1,void this.log(`Failed to parse Steering Manifest RELOAD-URI: ${a}`)}this.scheduleRefresh(this.uri||n.url),o&&this.clonePathways(o);const c={steeringManifest:s,url:i.toString()};this.hls.trigger($e.STEERING_MANIFEST_LOADED,c),l&&this.updatePathwayPriority(l)},onError:(e,t,n,i)=>{if(this.log(`Error loading steering manifest: ${e.code} ${e.text} (${t.url})`),this.stopLoad(),410===e.code)return this.enabled=!1,void this.log(`Steering manifest ${t.url} no longer available`);let r=1e3*this.timeToLoad;if(429===e.code){const e=this.loader;if("function"==typeof(null==e?void 0:e.getResponseHeader)){const t=e.getResponseHeader("Retry-After");t&&(r=1e3*parseFloat(t))}return void this.log(`Steering manifest ${t.url} rate limited`)}this.scheduleRefresh(this.uri||t.url,r)},onTimeout:(e,t,n)=>{this.log(`Timeout loading steering manifest (${t.url})`),this.scheduleRefresh(this.uri||t.url)}};this.log(`Requesting steering manifest: ${i}`),this.loader.load(r,o,l)}scheduleRefresh(e,t=1e3*this.timeToLoad){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var t;const n=null==(t=this.hls)?void 0:t.media;!n||n.ended?this.scheduleRefresh(e,1e3*this.timeToLoad):this.loadSteeringManifest(e)},t)}},interstitialsController:class extends et{constructor(e,t){super("interstitials",e.logger),this.HlsPlayerClass=void 0,this.hls=void 0,this.assetListLoader=void 0,this.mediaSelection=null,this.altSelection=null,this.media=null,this.detachedData=null,this.requiredTracks=null,this.manager=null,this.playerQueue=[],this.bufferedPos=-1,this.timelinePos=-1,this.schedule=void 0,this.playingItem=null,this.bufferingItem=null,this.waitingItem=null,this.endedItem=null,this.playingAsset=null,this.endedAsset=null,this.bufferingAsset=null,this.shouldPlay=!1,this.onPlay=()=>{this.shouldPlay=!0},this.onPause=()=>{this.shouldPlay=!1},this.onSeeking=()=>{const e=this.currentTime;if(void 0===e||this.playbackDisabled||!this.schedule)return;const t=e-this.timelinePos;if(Math.abs(t)<1/7056e5)return;const n=t<=-.01;this.timelinePos=e,this.bufferedPos=e;const i=this.playingItem;if(!i)return void this.checkBuffer();if(n&&this.schedule.resetErrorsInRange(e,e-t)&&this.updateSchedule(!0),this.checkBuffer(),n&&e<i.start||e>=i.end){var r;const t=this.findItemIndex(i);let s=this.schedule.findItemIndexAtTime(e);if(-1===s&&(s=t+(n?-1:1),this.log(`seeked ${n?"back ":""}to position not covered by schedule ${e} (resolving from ${t} to ${s})`)),!this.isInterstitial(i)&&null!=(r=this.media)&&r.paused&&(this.shouldPlay=!1),!n&&s>t){const e=this.schedule.findJumpRestrictedIndex(t+1,s);if(e>t)return void this.setSchedulePosition(e)}return void this.setSchedulePosition(s)}const s=this.playingAsset;if(!s){if(this.playingLastItem&&this.isInterstitial(i)){const t=i.event.assetList[0];t&&(this.endedItem=this.playingItem,this.playingItem=null,this.setScheduleToAssetAtTime(e,t))}return}const a=s.timelineStart,o=s.duration||0;var l;(n&&e<a||e>=a+o)&&(null!=(l=i.event)&&l.appendInPlace&&(this.clearInterstitial(i.event,i),this.flushFrontBuffer(e)),this.setScheduleToAssetAtTime(e,s))},this.onTimeupdate=()=>{const e=this.currentTime;if(void 0===e||this.playbackDisabled)return;if(!(e>this.timelinePos))return;this.timelinePos=e,e>this.bufferedPos&&this.checkBuffer();const t=this.playingItem;if(!t||this.playingLastItem)return;if(e>=t.end){this.timelinePos=t.end;const e=this.findItemIndex(t);this.setSchedulePosition(e+1)}const n=this.playingAsset;n&&e>=n.timelineStart+(n.duration||0)&&this.setScheduleToAssetAtTime(e,n)},this.onScheduleUpdate=(e,t)=>{const n=this.schedule;if(!n)return;const i=this.playingItem,r=n.events||[],s=n.items||[],a=n.durations,o=e.map(e=>e.identifier),l=!(!r.length&&!o.length);(l||t)&&this.log(`INTERSTITIALS_UPDATED (${r.length}): ${r}\nSchedule: ${s.map(e=>Yo(e))} pos: ${this.timelinePos}`),o.length&&this.log(`Removed events ${o}`);let c=null,u=null;i&&(c=this.updateItem(i,this.timelinePos),this.itemsMatch(i,c)?this.playingItem=c:this.waitingItem=this.endedItem=null),this.waitingItem=this.updateItem(this.waitingItem),this.endedItem=this.updateItem(this.endedItem);const h=this.bufferingItem;if(h&&(u=this.updateItem(h,this.bufferedPos),this.itemsMatch(h,u)?this.bufferingItem=u:h.event&&(this.bufferingItem=this.playingItem,this.clearInterstitial(h.event,null))),e.forEach(e=>{e.assetList.forEach(e=>{this.clearAssetPlayer(e.identifier,null)})}),this.playerQueue.forEach(e=>{if(e.interstitial.appendInPlace){const t=e.assetItem.timelineStart,n=e.timelineOffset-t;if(n)try{e.timelineOffset=t}catch(i){Math.abs(n)>Uo&&this.warn(`${i} ("${e.assetId}" ${e.timelineOffset}->${t})`)}}}),l||t){if(this.hls.trigger($e.INTERSTITIALS_UPDATED,{events:r.slice(0),schedule:s.slice(0),durations:a,removedIds:o}),this.isInterstitial(i)&&o.includes(i.event.identifier))return this.warn(`Interstitial "${i.event.identifier}" removed while playing`),void this.primaryFallback(i.event);i&&this.trimInPlace(c,i),h&&u!==c&&this.trimInPlace(u,h),this.checkBuffer()}},this.hls=e,this.HlsPlayerClass=t,this.assetListLoader=new Xo(e),this.schedule=new Ko(this.onScheduleUpdate,e.logger),this.registerListeners()}registerListeners(){const e=this.hls;e&&(e.on($e.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on($e.MEDIA_ATTACHED,this.onMediaAttached,this),e.on($e.MEDIA_DETACHING,this.onMediaDetaching,this),e.on($e.MANIFEST_LOADING,this.onManifestLoading,this),e.on($e.LEVEL_UPDATED,this.onLevelUpdated,this),e.on($e.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on($e.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.on($e.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on($e.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.on($e.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.on($e.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.on($e.BUFFER_APPENDED,this.onBufferAppended,this),e.on($e.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on($e.BUFFERED_TO_END,this.onBufferedToEnd,this),e.on($e.MEDIA_ENDED,this.onMediaEnded,this),e.on($e.ERROR,this.onError,this),e.on($e.DESTROYING,this.onDestroying,this))}unregisterListeners(){const e=this.hls;e&&(e.off($e.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off($e.MEDIA_ATTACHED,this.onMediaAttached,this),e.off($e.MEDIA_DETACHING,this.onMediaDetaching,this),e.off($e.MANIFEST_LOADING,this.onManifestLoading,this),e.off($e.LEVEL_UPDATED,this.onLevelUpdated,this),e.off($e.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off($e.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.off($e.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off($e.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.off($e.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.off($e.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.off($e.BUFFER_CODECS,this.onBufferCodecs,this),e.off($e.BUFFER_APPENDED,this.onBufferAppended,this),e.off($e.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off($e.BUFFERED_TO_END,this.onBufferedToEnd,this),e.off($e.MEDIA_ENDED,this.onMediaEnded,this),e.off($e.ERROR,this.onError,this),e.off($e.DESTROYING,this.onDestroying,this))}startLoad(){this.resumeBuffering()}stopLoad(){this.pauseBuffering()}resumeBuffering(){var e;null==(e=this.getBufferingPlayer())||e.resumeBuffering()}pauseBuffering(){var e;null==(e=this.getBufferingPlayer())||e.pauseBuffering()}destroy(){this.unregisterListeners(),this.stopLoad(),this.assetListLoader&&this.assetListLoader.destroy(),this.emptyPlayerQueue(),this.clearScheduleState(),this.schedule&&this.schedule.destroy(),this.media=this.detachedData=this.mediaSelection=this.requiredTracks=this.altSelection=this.schedule=this.manager=null,this.hls=this.HlsPlayerClass=this.log=null,this.assetListLoader=null,this.onPlay=this.onPause=this.onSeeking=this.onTimeupdate=null,this.onScheduleUpdate=null}onDestroying(){const e=this.primaryMedia||this.media;e&&this.removeMediaListeners(e)}removeMediaListeners(e){Pr(e,"play",this.onPlay),Pr(e,"pause",this.onPause),Pr(e,"seeking",this.onSeeking),Pr(e,"timeupdate",this.onTimeupdate)}onMediaAttaching(e,t){const n=this.media=t.media;Dr(n,"seeking",this.onSeeking),Dr(n,"timeupdate",this.onTimeupdate),Dr(n,"play",this.onPlay),Dr(n,"pause",this.onPause)}onMediaAttached(e,t){const n=this.effectivePlayingItem,i=this.detachedData;if(this.detachedData=null,null===n)this.checkStart();else if(!i){this.clearScheduleState();const e=this.findItemIndex(n);this.setSchedulePosition(e)}}clearScheduleState(){this.log("clear schedule state"),this.playingItem=this.bufferingItem=this.waitingItem=this.endedItem=this.playingAsset=this.endedAsset=this.bufferingAsset=null}onMediaDetaching(e,t){const n=!!t.transferMedia,i=this.media;if(this.media=null,!n&&(i&&this.removeMediaListeners(i),this.detachedData)){const e=this.getBufferingPlayer();e&&(this.log(`Removing schedule state for detachedData and ${e}`),this.playingAsset=this.endedAsset=this.bufferingAsset=this.bufferingItem=this.waitingItem=this.detachedData=null,e.detachMedia()),this.shouldPlay=!1}}get interstitialsManager(){if(!this.hls)return null;if(this.manager)return this.manager;const e=this,t=()=>e.bufferingItem||e.waitingItem,n=t=>t?e.getAssetPlayer(t.identifier):t,i=(t,i,s,a,o)=>{if(t){let l=t[i].start;const c=t.event;if(c){if("playout"===i||c.timelineOccupancy!==$o.Point){const e=n(s);(null==e?void 0:e.interstitial)===c&&(l+=e.assetItem.startOffset+e[o])}}else l+=("bufferedPos"===a?r():e[a])-t.start;return l}return 0},r=()=>{const t=e.bufferedPos;return t===Number.MAX_VALUE?s("primary"):Math.max(t,0)},s=t=>{var n,i;return null!=(n=e.primaryDetails)&&n.live?e.primaryDetails.edge:(null==(i=e.schedule)?void 0:i.durations[t])||0},a=(t,r)=>{var s,a;const o=e.effectivePlayingItem;if(null!=o&&null!=(s=o.event)&&s.restrictions.skip||!e.schedule)return;e.log(`seek to ${t} "${r}"`);const l=e.effectivePlayingItem,c=e.schedule.findItemIndexAtTime(t,r),u=null==(a=e.schedule.items)?void 0:a[c],h=e.getBufferingPlayer(),d=null==h?void 0:h.interstitial,f=null==d?void 0:d.appendInPlace,p=l&&e.itemsMatch(l,u);if(l&&(f||p)){const s=n(e.playingAsset),a=(null==s?void 0:s.media)||e.primaryMedia;if(a){const n="primary"===r?a.currentTime:i(l,r,e.playingAsset,"timelinePos","currentTime"),o=t-n,c=(f?n:a.currentTime)+o;if(c>=0&&(!s||f||c<=s.duration))return void(a.currentTime=c)}}if(u){let n=t;if("primary"!==r){const e=t-u[r].start;n=u.start+e}const i=!e.isInterstitial(u);if(e.isInterstitial(l)&&!l.event.appendInPlace||!i&&!u.event.appendInPlace){if(l){const s=e.findItemIndex(l);if(c>s){const t=e.schedule.findJumpRestrictedIndex(s+1,c);if(t>s)return void e.setSchedulePosition(t)}let a=0;if(i)e.timelinePos=n,e.checkBuffer();else{const e=u.event.assetList,n=t-(u[r]||u).start;for(let t=e.length;t--;){const i=e[t];if(i.duration&&n>=i.startOffset&&n<i.startOffset+i.duration){a=t;break}}}e.setSchedulePosition(c,a)}}else{const t=e.media||(f?null==h?void 0:h.media:null);t&&(t.currentTime=n)}}},o=()=>{const n=e.effectivePlayingItem;if(e.isInterstitial(n))return n;const i=t();return e.isInterstitial(i)?i:null},l={get bufferedEnd(){const n=t(),r=e.bufferingItem;var s;return r&&r===n&&(i(r,"playout",e.bufferingAsset,"bufferedPos","bufferedEnd")-r.playout.start||(null==(s=e.bufferingAsset)?void 0:s.startOffset))||0},get currentTime(){const t=o(),n=e.effectivePlayingItem;return n&&n===t?i(n,"playout",e.effectivePlayingAsset,"timelinePos","currentTime")-n.playout.start:0},set currentTime(t){const n=o(),i=e.effectivePlayingItem;i&&i===n&&a(t+i.playout.start,"playout")},get duration(){const e=o();return e?e.playout.end-e.playout.start:0},get assetPlayers(){var t;const n=null==(t=o())?void 0:t.event.assetList;return n?n.map(t=>e.getAssetPlayer(t.identifier)):[]},get playingIndex(){var t;const n=null==(t=o())?void 0:t.event;return n&&e.effectivePlayingAsset?n.findAssetIndex(e.effectivePlayingAsset):-1},get scheduleItem(){return o()}};return this.manager={get events(){var t;return(null==(t=e.schedule)||null==(t=t.events)?void 0:t.slice(0))||[]},get schedule(){var t;return(null==(t=e.schedule)||null==(t=t.items)?void 0:t.slice(0))||[]},get interstitialPlayer(){return o()?l:null},get playerQueue(){return e.playerQueue.slice(0)},get bufferingAsset(){return e.bufferingAsset},get bufferingItem(){return t()},get bufferingIndex(){const n=t();return e.findItemIndex(n)},get playingAsset(){return e.effectivePlayingAsset},get playingItem(){return e.effectivePlayingItem},get playingIndex(){const t=e.effectivePlayingItem;return e.findItemIndex(t)},primary:{get bufferedEnd(){return r()},get currentTime(){const t=e.timelinePos;return t>0?t:0},set currentTime(e){a(e,"primary")},get duration(){return s("primary")},get seekableStart(){var t;return(null==(t=e.primaryDetails)?void 0:t.fragmentStart)||0}},integrated:{get bufferedEnd(){return i(t(),"integrated",e.bufferingAsset,"bufferedPos","bufferedEnd")},get currentTime(){return i(e.effectivePlayingItem,"integrated",e.effectivePlayingAsset,"timelinePos","currentTime")},set currentTime(e){a(e,"integrated")},get duration(){return s("integrated")},get seekableStart(){var t;return((t,n)=>{var i;if(0!==t&&null!=(i=e.schedule)&&i.length){var r;const i=e.schedule.findItemIndexAtTime(t),s=null==(r=e.schedule.items)?void 0:r[i];if(s)return t+(s[n].start-s.start)}return t})((null==(t=e.primaryDetails)?void 0:t.fragmentStart)||0,"integrated")}},skip:()=>{const t=e.effectivePlayingItem,n=null==t?void 0:t.event;if(n&&!n.restrictions.skip){const i=e.findItemIndex(t);if(n.appendInPlace){const e=t.playout.start+t.event.duration;a(e+.001,"playout")}else e.advanceAfterAssetEnded(n,i,1/0)}}}}get effectivePlayingItem(){return this.waitingItem||this.playingItem||this.endedItem}get effectivePlayingAsset(){return this.playingAsset||this.endedAsset}get playingLastItem(){var e;const t=this.playingItem,n=null==(e=this.schedule)?void 0:e.items;return!!(this.playbackStarted&&t&&n)&&this.findItemIndex(t)===n.length-1}get playbackStarted(){return null!==this.effectivePlayingItem}get currentTime(){var e,t;if(null===this.mediaSelection)return;const n=this.waitingItem||this.playingItem;if(this.isInterstitial(n)&&!n.event.appendInPlace)return;let i=this.media;!i&&null!=(e=this.bufferingItem)&&null!=(e=e.event)&&e.appendInPlace&&(i=this.primaryMedia);const r=null==(t=i)?void 0:t.currentTime;return void 0!==r&&Ne(r)?r:void 0}get primaryMedia(){var e;return this.media||(null==(e=this.detachedData)?void 0:e.media)||null}isInterstitial(e){return!(null==e||!e.event)}retreiveMediaSource(e,t){const n=this.getAssetPlayer(e);n&&this.transferMediaFromPlayer(n,t)}transferMediaFromPlayer(e,t){const n=e.interstitial.appendInPlace,i=e.media;if(n&&i===this.primaryMedia){if(this.bufferingAsset=null,(!t||this.isInterstitial(t)&&!t.event.appendInPlace)&&t&&i)return void(this.detachedData={media:i});const n=e.transferMedia();this.log(`transfer MediaSource from ${e} ${In(n)}`),this.detachedData=n}else t&&i&&(this.shouldPlay||(this.shouldPlay=!i.paused))}transferMediaTo(e,t){var n,i;if(e.media===t)return;let r=null;const s=this.hls,a=e!==s,o=a&&e.interstitial.appendInPlace,l=null==(n=this.detachedData)?void 0:n.mediaSource;let c;if(s.media)o&&(r=s.transferMedia(),this.detachedData=r),c="Primary";else if(l){const e=this.getBufferingPlayer();e?(r=e.transferMedia(),c=`${e}`):c="detached MediaSource"}else c="detached media";if(!r)if(l)r=this.detachedData,this.log(`using detachedData: MediaSource ${In(r)}`);else if(!this.detachedData||s.media===t){const e=this.playerQueue;e.length>1&&e.forEach(e=>{if(a&&e.interstitial.appendInPlace!==o){const t=e.interstitial;this.clearInterstitial(e.interstitial,null),t.appendInPlace=!1,t.appendInPlace&&this.warn(`Could not change append strategy for queued assets ${t}`)}}),this.hls.detachMedia(),this.detachedData={media:t}}const u=r&&"mediaSource"in r&&"closed"!==(null==(i=r.mediaSource)?void 0:i.readyState),h=u&&r?r:t;this.log(`${u?"transfering MediaSource":"attaching media"} to ${a?e:"Primary"} from ${c} (media.currentTime: ${t.currentTime})`);const d=this.schedule;if(h===r&&d){const t=a&&e.assetId===d.assetIdAtEnd;h.overrides={duration:d.duration,endOfStream:!a||t,cueRemoval:!a}}e.attachMedia(h)}onInterstitialCueEnter(){this.onTimeupdate()}checkStart(){const e=this.schedule,t=null==e?void 0:e.events;if(!t||this.playbackDisabled||!this.media)return;-1===this.bufferedPos&&(this.bufferedPos=0);const n=this.timelinePos,i=this.effectivePlayingItem;if(-1===n){const n=this.hls.startPosition;if(this.log(Zo("checkStart",n)),this.timelinePos=n,t.length&&t[0].cue.pre){const n=e.findEventIndex(t[0].identifier);this.setSchedulePosition(n)}else if(n>=0||!this.primaryLive){const t=this.timelinePos=n>0?n:0,i=e.findItemIndexAtTime(t);this.setSchedulePosition(i)}}else if(i&&!this.playingItem){const t=e.findItemIndex(i);this.setSchedulePosition(t)}}advanceAssetBuffering(e,t){const n=e.event,i=n.findAssetIndex(t),r=qo(n,i);if(n.isAssetPastPlayoutLimit(r)){if(this.schedule){var s;const t=null==(s=this.schedule.items)?void 0:s[this.findItemIndex(e)+1];t&&this.bufferedToItem(t)}}else this.bufferedToEvent(e,r)}advanceAfterAssetEnded(e,t,n){const i=qo(e,n);if(e.isAssetPastPlayoutLimit(i)){if(this.schedule){const n=this.schedule.items;if(n){const i=t+1;if(i>=n.length)return void this.setSchedulePosition(-1);const r=e.resumeTime;this.timelinePos<r&&(this.log(Zo("advanceAfterAssetEnded",r)),this.timelinePos=r,e.appendInPlace&&this.advanceInPlace(r),this.checkBuffer(this.bufferedPos<r)),this.setSchedulePosition(i)}}}else{if(e.appendInPlace){const t=e.assetList[i];t&&this.advanceInPlace(t.timelineStart)}this.setSchedulePosition(t,i)}}setScheduleToAssetAtTime(e,t){const n=this.schedule;if(!n)return;const i=t.parentIdentifier,r=n.getEvent(i);if(r){const t=n.findEventIndex(i),s=n.findAssetIndex(r,e);this.advanceAfterAssetEnded(r,t,s-1)}}setSchedulePosition(e,t){var n;const i=null==(n=this.schedule)?void 0:n.items;if(!i||this.playbackDisabled)return;const r=e>=0?i[e]:null;this.log(`setSchedulePosition ${e}, ${t} (${r?Yo(r):r}) pos: ${this.timelinePos}`);const s=this.waitingItem||this.playingItem,a=this.playingLastItem;if(this.isInterstitial(s)){const n=s.event,c=this.playingAsset,u=null==c?void 0:c.identifier,h=u?this.getAssetPlayer(u):null;if(h&&u&&(!this.eventItemsMatch(s,r)||void 0!==t&&u!==n.assetList[t].identifier)){var o;const t=n.findAssetIndex(c);if(this.log(`INTERSTITIAL_ASSET_ENDED ${t+1}/${n.assetList.length} ${Ho(c)}`),this.endedAsset=c,this.playingAsset=null,this.hls.trigger($e.INTERSTITIAL_ASSET_ENDED,{asset:c,assetListIndex:t,event:n,schedule:i.slice(0),scheduleIndex:e,player:h}),s!==this.playingItem)return void(this.itemsMatch(s,this.playingItem)&&!this.playingAsset&&this.advanceAfterAssetEnded(n,this.findItemIndex(this.playingItem),t));this.retreiveMediaSource(u,r),!h.media||null!=(o=this.detachedData)&&o.mediaSource||h.detachMedia()}if(!this.eventItemsMatch(s,r)&&(this.endedItem=s,this.playingItem=null,this.log(`INTERSTITIAL_ENDED ${n} ${Yo(s)}`),n.hasPlayed=!0,this.hls.trigger($e.INTERSTITIAL_ENDED,{event:n,schedule:i.slice(0),scheduleIndex:e}),n.cue.once)){var l;this.updateSchedule();const e=null==(l=this.schedule)?void 0:l.items;if(r&&e){const n=this.findItemIndex(r);this.advanceSchedule(n,e,t,s,a)}return}}this.advanceSchedule(e,i,t,s,a)}advanceSchedule(e,t,n,i,r){const s=this.schedule;if(!s)return;const a=t[e]||null,o=this.primaryMedia,l=this.playerQueue;if(l.length&&l.forEach(t=>{const n=t.interstitial,i=s.findEventIndex(n.identifier);(i<e||i>e+1)&&this.clearInterstitial(n,a)}),this.isInterstitial(a)){this.timelinePos=Math.min(Math.max(this.timelinePos,a.start),a.end);const r=a.event;if(void 0===n){const t=qo(r,(n=s.findAssetIndex(r,this.timelinePos))-1);if(r.isAssetPastPlayoutLimit(t)||r.appendInPlace&&this.timelinePos===a.end)return void this.advanceAfterAssetEnded(r,e,n);n=t}const l=this.waitingItem;this.assetsBuffered(a,o)||this.setBufferingItem(a);let c=this.preloadAssets(r,n);if(this.eventItemsMatch(a,l||i)||(this.waitingItem=a,this.log(`INTERSTITIAL_STARTED ${Yo(a)} ${r.appendInPlace?"append in place":""}`),this.hls.trigger($e.INTERSTITIAL_STARTED,{event:r,schedule:t.slice(0),scheduleIndex:e})),!r.assetListLoaded)return void this.log(`Waiting for ASSET-LIST to complete loading ${r}`);if(r.assetListLoader&&(r.assetListLoader.destroy(),r.assetListLoader=void 0),!o)return void this.log(`Waiting for attachMedia to start Interstitial ${r}`);this.waitingItem=this.endedItem=null,this.playingItem=a;const u=r.assetList[n];if(!u)return void this.advanceAfterAssetEnded(r,e,n||0);if(c||(c=this.getAssetPlayer(u.identifier)),null===c||c.destroyed){const e=r.assetList.length;this.warn(`asset ${n+1}/${e} player destroyed ${r}`),c=this.createAssetPlayer(r,u,n),c.loadSource()}if(!this.eventItemsMatch(a,this.bufferingItem)&&r.appendInPlace&&this.isAssetBuffered(u))return;this.startAssetPlayer(c,n,t,e,o),this.shouldPlay&&Qo(c.media)}else a?(this.resumePrimary(a,e,i),this.shouldPlay&&Qo(this.hls.media)):r&&this.isInterstitial(i)&&(this.endedItem=null,this.playingItem=i,i.event.appendInPlace||this.attachPrimary(s.durations.primary,null))}get playbackDisabled(){return!1===this.hls.config.enableInterstitialPlayback}get primaryDetails(){var e;return null==(e=this.mediaSelection)?void 0:e.main.details}get primaryLive(){var e;return!(null==(e=this.primaryDetails)||!e.live)}resumePrimary(e,t,n){var i,r;if(this.playingItem=e,this.playingAsset=this.endedAsset=null,this.waitingItem=this.endedItem=null,this.bufferedToItem(e),this.log(`resuming ${Yo(e)}`),null==(i=this.detachedData)||!i.mediaSource){let n=this.timelinePos;(n<e.start||n>=e.end)&&(n=this.getPrimaryResumption(e,t),this.log(Zo("resumePrimary",n)),this.timelinePos=n),this.attachPrimary(n,e)}if(!n)return;const s=null==(r=this.schedule)?void 0:r.items;s&&(this.log(`INTERSTITIALS_PRIMARY_RESUMED ${Yo(e)}`),this.hls.trigger($e.INTERSTITIALS_PRIMARY_RESUMED,{schedule:s.slice(0),scheduleIndex:t}),this.checkBuffer())}getPrimaryResumption(e,t){const n=e.start;if(this.primaryLive){const e=this.primaryDetails;if(0===t)return this.hls.startPosition;if(e&&(n<e.fragmentStart||n>e.edge))return this.hls.liveSyncPosition||-1}return n}isAssetBuffered(e){const t=this.getAssetPlayer(e.identifier);return null!=t&&t.hls?t.hls.bufferedToEnd:bi.bufferInfo(this.primaryMedia,this.timelinePos,0).end+1>=e.timelineStart+(e.duration||0)}attachPrimary(e,t,n){t?this.setBufferingItem(t):this.bufferingItem=this.playingItem,this.bufferingAsset=null;const i=this.primaryMedia;if(!i)return;const r=this.hls;r.media?this.checkBuffer():(this.transferMediaTo(r,i),n&&this.startLoadingPrimaryAt(e,n)),n||(this.log(Zo("attachPrimary",e)),this.timelinePos=e,this.startLoadingPrimaryAt(e,n))}startLoadingPrimaryAt(e,t){var n;const i=this.hls;!i.loadingEnabled||!i.media||Math.abs(((null==(n=i.mainForwardBufferInfo)?void 0:n.start)||i.media.currentTime)-e)>.5?i.startLoad(e,t):i.bufferingEnabled||i.resumeBuffering()}onManifestLoading(){var e;this.stopLoad(),null==(e=this.schedule)||e.reset(),this.emptyPlayerQueue(),this.clearScheduleState(),this.shouldPlay=!1,this.bufferedPos=this.timelinePos=-1,this.mediaSelection=this.altSelection=this.manager=this.requiredTracks=null,this.hls.off($e.BUFFER_CODECS,this.onBufferCodecs,this),this.hls.on($e.BUFFER_CODECS,this.onBufferCodecs,this)}onLevelUpdated(e,t){if(-1===t.level||!this.schedule)return;const n=this.hls.levels[t.level];if(!n.details)return;const i=Je(Je({},this.mediaSelection||this.altSelection),{},{main:n});this.mediaSelection=i,this.schedule.parseInterstitialDateRanges(i,this.hls.config.interstitialAppendInPlace),!this.effectivePlayingItem&&this.schedule.items&&this.checkStart()}onAudioTrackUpdated(e,t){const n=this.hls.audioTracks[t.id],i=this.mediaSelection;if(!i)return void(this.altSelection=Je(Je({},this.altSelection),{},{audio:n}));const r=Je(Je({},i),{},{audio:n});this.mediaSelection=r}onSubtitleTrackUpdated(e,t){const n=this.hls.subtitleTracks[t.id],i=this.mediaSelection;if(!i)return void(this.altSelection=Je(Je({},this.altSelection),{},{subtitles:n}));const r=Je(Je({},i),{},{subtitles:n});this.mediaSelection=r}onAudioTrackSwitching(e,t){const n=Pn(t);this.playerQueue.forEach(({hls:e})=>e&&(e.setAudioOption(t)||e.setAudioOption(n)))}onSubtitleTrackSwitch(e,t){const n=Pn(t);this.playerQueue.forEach(({hls:e})=>e&&(e.setSubtitleOption(t)||-1!==t.id&&e.setSubtitleOption(n)))}onBufferCodecs(e,t){const n=t.tracks;n&&(this.requiredTracks=n)}onBufferAppended(e,t){this.checkBuffer()}onBufferFlushed(e,t){const n=this.playingItem;if(n&&!this.itemsMatch(n,this.bufferingItem)&&!this.isInterstitial(n)){const e=this.timelinePos;this.bufferedPos=e,this.checkBuffer()}}onBufferedToEnd(e){if(!this.schedule)return;const t=this.schedule.events;if(this.bufferedPos<Number.MAX_VALUE&&t){for(let e=0;e<t.length;e++){const i=t[e];if(i.cue.post){var n;const e=this.schedule.findEventIndex(i.identifier),t=null==(n=this.schedule.items)?void 0:n[e];this.isInterstitial(t)&&this.eventItemsMatch(t,this.bufferingItem)&&this.bufferedToItem(t,0);break}}this.bufferedPos=Number.MAX_VALUE}}onMediaEnded(e){const t=this.playingItem;if(!this.playingLastItem&&t){const e=this.findItemIndex(t);this.setSchedulePosition(e+1)}else this.shouldPlay=!1}updateItem(e,t){var n;const i=null==(n=this.schedule)?void 0:n.items;return e&&i&&i[this.findItemIndex(e,t)]||null}trimInPlace(e,t){if(this.isInterstitial(e)&&e.event.appendInPlace&&t.end-e.end>.25){e.event.assetList.forEach((t,n)=>{e.event.isAssetPastPlayoutLimit(n)&&this.clearAssetPlayer(t.identifier,null)});const n=e.end+.25,i=bi.bufferInfo(this.primaryMedia,n,0);if(i.end>n||(i.nextStart||0)>n){this.log(`trim buffered interstitial ${Yo(e)} (was ${Yo(t)})`);const i=!0;this.attachPrimary(n,null,i),this.flushFrontBuffer(n)}}}itemsMatch(e,t){return!!t&&(e===t||e.event&&t.event&&this.eventItemsMatch(e,t)||!e.event&&!t.event&&this.findItemIndex(e)===this.findItemIndex(t))}eventItemsMatch(e,t){var n;return!!t&&(e===t||e.event.identifier===(null==(n=t.event)?void 0:n.identifier))}findItemIndex(e,t){return e&&this.schedule?this.schedule.findItemIndex(e,t):-1}updateSchedule(e=!1){var t;const n=this.mediaSelection;n&&(null==(t=this.schedule)||t.updateSchedule(n,[],e))}checkBuffer(e){var t;const n=null==(t=this.schedule)?void 0:t.items;if(!n)return;const i=bi.bufferInfo(this.primaryMedia,this.timelinePos,0);e&&(this.bufferedPos=this.timelinePos),e||(e=i.len<1),this.updateBufferedPos(i.end,n,e)}updateBufferedPos(e,t,n){const i=this.schedule,r=this.bufferingItem;if(this.bufferedPos>e||!i)return;if(1===t.length&&this.itemsMatch(t[0],r))return void(this.bufferedPos=e);const s=this.playingItem,a=this.findItemIndex(s);let o=i.findItemIndexAtTime(e);if(this.bufferedPos<e){var l;const n=this.findItemIndex(r),i=Math.min(n+1,t.length-1),s=t[i];if((-1===o&&r&&e>=r.end||null!=(l=s.event)&&l.appendInPlace&&e+.01>=s.start)&&(o=i),this.isInterstitial(r)){const e=r.event;if(i-a>1&&!1===e.appendInPlace)return;if(0===e.assetList.length&&e.assetListLoader)return}if(this.bufferedPos=e,o>n&&o>a)this.bufferedToItem(s);else{const t=this.primaryDetails;this.primaryLive&&t&&e>t.edge-t.targetduration&&s.start<t.edge+this.hls.config.interstitialLiveLookAhead&&this.isInterstitial(s)&&this.preloadAssets(s.event,0)}}else n&&s&&!this.itemsMatch(s,r)&&(o===a?this.bufferedToItem(s):o===a+1&&this.bufferedToItem(t[o]))}assetsBuffered(e,t){return 0!==e.event.assetList.length&&!e.event.assetList.some(e=>{const n=this.getAssetPlayer(e.identifier);return!(null!=n&&n.bufferedInPlaceToEnd(t))})}setBufferingItem(e){const t=this.bufferingItem,n=this.schedule;if(!this.itemsMatch(e,t)&&n){const{items:i,events:r}=n;if(!i||!r)return t;const s=this.isInterstitial(e),a=this.getBufferingPlayer();this.bufferingItem=e,this.bufferedPos=Math.max(e.start,Math.min(e.end,this.timelinePos));const o=a?a.remaining:t?t.end-this.timelinePos:0;if(this.log(`INTERSTITIALS_BUFFERED_TO_BOUNDARY ${Yo(e)}`+(t?` (${o.toFixed(2)} remaining)`:"")),!this.playbackDisabled)if(s){const t=n.findAssetIndex(e.event,this.bufferedPos);e.event.assetList.forEach((e,n)=>{const i=this.getAssetPlayer(e.identifier);i&&(n===t&&i.loadSource(),i.resumeBuffering())})}else this.hls.resumeBuffering(),this.playerQueue.forEach(e=>e.pauseBuffering());this.hls.trigger($e.INTERSTITIALS_BUFFERED_TO_BOUNDARY,{events:r.slice(0),schedule:i.slice(0),bufferingIndex:this.findItemIndex(e),playingIndex:this.findItemIndex(this.playingItem)})}else this.bufferingItem!==e&&(this.bufferingItem=e);return t}bufferedToItem(e,t=0){const n=this.setBufferingItem(e);if(!this.playbackDisabled)if(this.isInterstitial(e))this.bufferedToEvent(e,t);else if(null!==n){this.bufferingAsset=null;const t=this.detachedData;if(t)if(t.mediaSource){const t=!0;this.attachPrimary(e.start,e,t)}else this.preloadPrimary(e);else this.preloadPrimary(e)}}preloadPrimary(e){const t=this.findItemIndex(e),n=this.getPrimaryResumption(e,t);this.startLoadingPrimaryAt(n)}bufferedToEvent(e,t){const n=e.event,i=0===n.assetList.length&&!n.assetListLoader,r=n.cue.once;if(i||!r){const e=this.preloadAssets(n,t);if(null!=e&&e.interstitial.appendInPlace){const t=this.primaryMedia;t&&this.bufferAssetPlayer(e,t)}}}preloadAssets(e,t){const n=e.assetUrl,i=e.assetList.length,r=0===i&&!e.assetListLoader,s=e.cue.once;if(r){const r=e.timelineStart;if(e.appendInPlace){var a;const t=this.playingItem;this.isInterstitial(t)||(null==t||null==(a=t.nextEvent)?void 0:a.identifier)!==e.identifier||this.flushFrontBuffer(r+.25)}let s,o=0;if(!this.playingItem&&this.primaryLive&&(o=this.hls.startPosition,-1===o&&(o=this.hls.liveSyncPosition||0)),o&&!e.cue.pre&&!e.cue.post){const e=o-r;e>0&&(s=Math.round(1e3*e)/1e3)}if(this.log(`Load interstitial asset ${t+1}/${n?1:i} ${e}${s?` live-start: ${o} start-offset: ${s}`:""}`),n)return this.createAsset(e,0,0,r,e.duration,n);const l=this.assetListLoader.loadAssetList(e,s);l&&(e.assetListLoader=l)}else if(!s&&i){for(let n=t;n<i;n++){const t=e.assetList[n],i=this.getAssetPlayerQueueIndex(t.identifier);-1!==i&&!this.playerQueue[i].destroyed||t.error||this.createAssetPlayer(e,t,n)}const n=e.assetList[t];if(n){const e=this.getAssetPlayer(n.identifier);return e&&e.loadSource(),e}}return null}flushFrontBuffer(e){const t=this.requiredTracks;t&&(this.log(`Removing front buffer starting at ${e}`),Object.keys(t).forEach(t=>{this.hls.trigger($e.BUFFER_FLUSHING,{startOffset:e,endOffset:1/0,type:t})}))}getAssetPlayerQueueIndex(e){const t=this.playerQueue;for(let n=0;n<t.length;n++)if(e===t[n].assetId)return n;return-1}getAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);return this.playerQueue[t]||null}getBufferingPlayer(){const{playerQueue:e,primaryMedia:t}=this;if(t)for(let n=0;n<e.length;n++)if(e[n].media===t)return e[n];return null}createAsset(e,t,n,i,r,s){const a={parentIdentifier:e.identifier,identifier:jo(e,s,t),duration:r,startOffset:n,timelineStart:i,uri:s};return this.createAssetPlayer(e,a,t)}createAssetPlayer(e,t,n){const i=this.hls,r=i.userConfig;let s=r.videoPreference;const a=i.loadLevelObj||i.levels[i.currentLevel];(s||a)&&(s=Qe({},s),a.videoCodec&&(s.videoCodec=a.videoCodec),a.videoRange&&(s.allowedVideoRanges=[a.videoRange]));const o=i.audioTracks[i.audioTrack],l=i.subtitleTracks[i.subtitleTrack];let c=0;if(this.primaryLive||e.appendInPlace){const e=this.timelinePos-t.timelineStart;if(e>1){const n=t.duration;n&&e<n&&(c=e)}}const u=t.identifier,h=Je(Je({},r),{},{maxMaxBufferLength:Math.min(180,i.config.maxMaxBufferLength),autoStartLoad:!0,startFragPrefetch:!0,primarySessionId:i.sessionId,assetPlayerId:u,abrEwmaDefaultEstimate:i.bandwidthEstimate,interstitialsController:void 0,startPosition:c,liveDurationInfinity:!1,testBandwidth:!1,videoPreference:s,audioPreference:o||r.audioPreference,subtitlePreference:l||r.subtitlePreference});e.appendInPlace&&(e.appendInPlaceStarted=!0,t.timelineStart&&(h.timelineOffset=t.timelineStart));const d=h.cmcd;null!=d&&d.sessionId&&d.contentId&&(h.cmcd=Qe({},d,{contentId:Bo(t.uri)})),this.getAssetPlayer(u)&&this.warn(`Duplicate date range identifier ${e} and asset ${u}`);const f=new Wo(this.HlsPlayerClass,h,e,t);this.playerQueue.push(f),e.assetList[n]=t;let p=!0;const g=i=>{if(i.live){var r;const t=new Error(`Interstitials MUST be VOD assets ${e}`),i={fatal:!0,type:Be.OTHER_ERROR,details:Ue.INTERSTITIAL_ASSET_ITEM_ERROR,error:t},s=(null==(r=this.schedule)?void 0:r.findEventIndex(e.identifier))||-1;return void this.handleAssetItemError(i,e,s,n,t.message)}const s=i.edge-i.fragmentStart,a=t.duration;(p||null===a||s>a)&&(p=!1,this.log(`Interstitial asset "${u}" duration change ${a} > ${s}`),t.duration=s,this.updateSchedule())};f.on($e.LEVEL_UPDATED,(e,{details:t})=>g(t)),f.on($e.LEVEL_PTS_UPDATED,(e,{details:t})=>g(t)),f.on($e.EVENT_CUE_ENTER,()=>this.onInterstitialCueEnter());const m=(e,t)=>{const n=this.getAssetPlayer(u);if(n&&t.tracks){n.off($e.BUFFER_CODECS,m),n.tracks=t.tracks;const e=this.primaryMedia;this.bufferingAsset===n.assetItem&&e&&!n.media&&this.bufferAssetPlayer(n,e)}};f.on($e.BUFFER_CODECS,m),f.on($e.BUFFERED_TO_END,()=>{var n;const i=this.getAssetPlayer(u);if(this.log(`buffered to end of asset ${i}`),!i||!this.schedule)return;const r=this.schedule.findEventIndex(e.identifier),s=null==(n=this.schedule.items)?void 0:n[r];this.isInterstitial(s)&&this.advanceAssetBuffering(s,t)});const v=t=>()=>{if(!this.getAssetPlayer(u)||!this.schedule)return;this.shouldPlay=!0;const n=this.schedule.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,n,t)};return f.once($e.MEDIA_ENDED,v(n)),f.once($e.PLAYOUT_LIMIT_REACHED,v(1/0)),f.on($e.ERROR,(t,i)=>{if(!this.schedule)return;const r=this.getAssetPlayer(u);if(i.details===Ue.BUFFER_STALLED_ERROR)return null!=r&&r.appendInPlace?void this.handleInPlaceStall(e):(this.onTimeupdate(),void this.checkBuffer(!0));this.handleAssetItemError(i,e,this.schedule.findEventIndex(e.identifier),n,`Asset player error ${i.error} ${e}`)}),f.on($e.DESTROYING,()=>{if(!this.getAssetPlayer(u)||!this.schedule)return;const t=new Error(`Asset player destroyed unexpectedly ${u}`),i={fatal:!0,type:Be.OTHER_ERROR,details:Ue.INTERSTITIAL_ASSET_ITEM_ERROR,error:t};this.handleAssetItemError(i,e,this.schedule.findEventIndex(e.identifier),n,t.message)}),this.log(`INTERSTITIAL_ASSET_PLAYER_CREATED ${Ho(t)}`),this.hls.trigger($e.INTERSTITIAL_ASSET_PLAYER_CREATED,{asset:t,assetListIndex:n,event:e,player:f}),f}clearInterstitial(e,t){e.assetList.forEach(e=>{this.clearAssetPlayer(e.identifier,t)}),e.reset()}resetAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);if(-1!==t){this.log(`reset asset player "${e}" after error`);const n=this.playerQueue[t];this.transferMediaFromPlayer(n,null),n.resetDetails()}}clearAssetPlayer(e,t){const n=this.getAssetPlayerQueueIndex(e);if(-1!==n){const e=this.playerQueue[n];this.log(`clear ${e} toSegment: ${t?Yo(t):t}`),this.transferMediaFromPlayer(e,t),this.playerQueue.splice(n,1),e.destroy()}}emptyPlayerQueue(){let e;for(;e=this.playerQueue.pop();)e.destroy();this.playerQueue=[]}startAssetPlayer(e,t,n,i,r){const{interstitial:s,assetItem:a,assetId:o}=e,l=s.assetList.length,c=this.playingAsset;this.endedAsset=null,this.playingAsset=a,c&&c.identifier===o||(c&&(this.clearAssetPlayer(c.identifier,n[i]),delete c.error),this.log(`INTERSTITIAL_ASSET_STARTED ${t+1}/${l} ${Ho(a)}`),this.hls.trigger($e.INTERSTITIAL_ASSET_STARTED,{asset:a,assetListIndex:t,event:s,schedule:n.slice(0),scheduleIndex:i,player:e})),this.bufferAssetPlayer(e,r)}bufferAssetPlayer(e,t){var n,i;if(!this.schedule)return;const{interstitial:r,assetItem:s}=e,a=this.schedule.findEventIndex(r.identifier),o=null==(n=this.schedule.items)?void 0:n[a];if(!o)return;e.loadSource(),this.setBufferingItem(o),this.bufferingAsset=s;const l=this.getBufferingPlayer();if(l===e)return;const c=r.appendInPlace;if(c&&!1===(null==l?void 0:l.interstitial.appendInPlace))return;const u=(null==l?void 0:l.tracks)||(null==(i=this.detachedData)?void 0:i.tracks)||this.requiredTracks;if(c&&s!==this.playingAsset){if(!e.tracks)return void this.log(`Waiting for track info before buffering ${e}`);if(u&&!lt(u,e.tracks)){const t=new Error(`Asset ${Ho(s)} SourceBuffer tracks ('${Object.keys(e.tracks)}') are not compatible with primary content tracks ('${Object.keys(u)}')`),n={fatal:!0,type:Be.OTHER_ERROR,details:Ue.INTERSTITIAL_ASSET_ITEM_ERROR,error:t},i=r.findAssetIndex(s);return void this.handleAssetItemError(n,r,a,i,t.message)}}this.transferMediaTo(e,t)}handleInPlaceStall(e){const t=this.schedule,n=this.primaryMedia;if(!t||!n)return;const i=n.currentTime,r=t.findAssetIndex(e,i),s=e.assetList[r];if(s){const a=this.getAssetPlayer(s.identifier);if(a){const o=a.currentTime||i-s.timelineStart,l=a.duration-o;if(this.warn(`Stalled at ${o} of ${o+l} in ${a} ${e} (media.currentTime: ${i})`),o&&(l/n.playbackRate<.5||a.bufferedInPlaceToEnd(n))&&a.hls){const n=t.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,n,r)}}}}advanceInPlace(e){const t=this.primaryMedia;t&&t.currentTime<e&&(t.currentTime=e)}handleAssetItemError(e,t,n,i,r){if(e.details===Ue.BUFFER_STALLED_ERROR)return;const s=t.assetList[i]||null;if(this.warn(`INTERSTITIAL_ASSET_ERROR ${s?Ho(s):s} ${e.error}`),!this.schedule)return;const a=(null==s?void 0:s.identifier)||"",o=this.getAssetPlayerQueueIndex(a),l=this.playerQueue[o]||null,c=this.schedule.items,u=Qe({},e,{fatal:!1,errorAction:Zn(!0),asset:s,assetListIndex:i,event:t,schedule:c,scheduleIndex:n,player:l});if(this.hls.trigger($e.INTERSTITIAL_ASSET_ERROR,u),!e.fatal)return;const h=this.playingAsset,d=this.bufferingAsset,f=new Error(r);if(s&&(this.clearAssetPlayer(a,null),s.error=f),t.assetList.some(e=>!e.error))for(let e=i;e<t.assetList.length;e++)this.resetAssetPlayer(t.assetList[e].identifier);else t.error=f;this.updateSchedule(!0),t.error?this.primaryFallback(t):h&&h.identifier===a?this.advanceAfterAssetEnded(t,n,i):d&&d.identifier===a&&this.isInterstitial(this.bufferingItem)&&this.advanceAssetBuffering(this.bufferingItem,d)}primaryFallback(e){const t=e.timelineStart,n=this.effectivePlayingItem;if(n){this.log(`Fallback to primary from event "${e.identifier}" start: ${t} pos: ${this.timelinePos} playing: ${Yo(n)} error: ${e.error}`);let i=this.timelinePos;-1===i&&(i=this.hls.startPosition);const r=this.updateItem(n,i);if(this.itemsMatch(n,r)&&this.clearInterstitial(e,null),e.appendInPlace&&(this.attachPrimary(t,null),this.flushFrontBuffer(t)),!this.schedule)return;const s=this.schedule.findItemIndexAtTime(i);this.setSchedulePosition(s)}else this.checkStart()}onAssetListLoaded(e,t){var n,i;const r=t.event,s=r.identifier,a=t.assetListResponse.ASSETS;if(null==(n=this.schedule)||!n.hasEvent(s))return;const o=r.timelineStart,l=r.duration;let c=0;a.forEach((e,t)=>{const n=parseFloat(e.DURATION);this.createAsset(r,t,c,o+c,n,e.URI),c+=n}),r.duration=c,this.log(`Loaded asset-list with duration: ${c} (was: ${l}) ${r}`);const u=this.waitingItem,h=(null==u?void 0:u.event.identifier)===s;this.updateSchedule();const d=null==(i=this.bufferingItem)?void 0:i.event;if(h){var f;const e=this.schedule.findEventIndex(s),t=null==(f=this.schedule.items)?void 0:f[e];if(t){if(!this.playingItem&&this.timelinePos>t.end&&this.schedule.findItemIndexAtTime(this.timelinePos)!==e)return r.error=new Error(`Interstitial no longer within playback range ${this.timelinePos} ${r}`),this.updateSchedule(!0),void this.primaryFallback(r);this.setBufferingItem(t)}this.setSchedulePosition(e)}else if((null==d?void 0:d.identifier)===s){const e=r.assetList[0];if(e){const t=this.getAssetPlayer(e.identifier);if(d.appendInPlace){const e=this.primaryMedia;t&&e&&this.bufferAssetPlayer(t,e)}else t&&t.loadSource()}}}onError(e,t){if(this.schedule)switch(t.details){case Ue.ASSET_LIST_PARSING_ERROR:case Ue.ASSET_LIST_LOAD_ERROR:case Ue.ASSET_LIST_LOAD_TIMEOUT:{const e=t.interstitial;e&&(this.updateSchedule(!0),this.primaryFallback(e));break}case Ue.BUFFER_STALLED_ERROR:{const e=this.endedItem||this.waitingItem||this.playingItem;if(this.isInterstitial(e)&&e.event.appendInPlace)return void this.handleInPlaceStall(e.event);this.log(`Primary player stall @${this.timelinePos} bufferedPos: ${this.bufferedPos}`),this.onTimeupdate(),this.checkBuffer(!0);break}}}}});function nc(e){return e&&"object"==typeof e?Array.isArray(e)?e.map(nc):Object.keys(e).reduce((t,n)=>(t[n]=nc(e[n]),t),{}):e}class ic extends mi{constructor(e,t){super("gap-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.media=null,this.mediaSource=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.buffered={},this.lastCurrentTime=0,this.ended=0,this.waiting=0,this.onMediaPlaying=()=>{this.ended=0,this.waiting=0},this.onMediaWaiting=()=>{var e;null!=(e=this.media)&&e.seeking||(this.waiting=self.performance.now(),this.tick())},this.onMediaEnded=()=>{var e;this.hls&&(this.ended=(null==(e=this.media)?void 0:e.currentTime)||1,this.hls.trigger($e.MEDIA_ENDED,{stalled:!1}))},this.hls=e,this.fragmentTracker=t,this.registerListeners()}registerListeners(){const{hls:e}=this;e&&(e.on($e.MEDIA_ATTACHED,this.onMediaAttached,this),e.on($e.MEDIA_DETACHING,this.onMediaDetaching,this),e.on($e.BUFFER_APPENDED,this.onBufferAppended,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off($e.MEDIA_ATTACHED,this.onMediaAttached,this),e.off($e.MEDIA_DETACHING,this.onMediaDetaching,this),e.off($e.BUFFER_APPENDED,this.onBufferAppended,this))}destroy(){super.destroy(),this.unregisterListeners(),this.media=this.hls=this.fragmentTracker=null,this.mediaSource=void 0}onMediaAttached(e,t){this.setInterval(100),this.mediaSource=t.mediaSource;const n=this.media=t.media;Dr(n,"playing",this.onMediaPlaying),Dr(n,"waiting",this.onMediaWaiting),Dr(n,"ended",this.onMediaEnded)}onMediaDetaching(e,t){this.clearInterval();const{media:n}=this;n&&(Pr(n,"playing",this.onMediaPlaying),Pr(n,"waiting",this.onMediaWaiting),Pr(n,"ended",this.onMediaEnded),this.media=null),this.mediaSource=void 0}onBufferAppended(e,t){this.buffered=t.timeRanges}get hasBuffered(){return Object.keys(this.buffered).length>0}tick(){var e;if(null==(e=this.media)||!e.readyState||!this.hasBuffered)return;const t=this.media.currentTime;this.poll(t,this.lastCurrentTime),this.lastCurrentTime=t}poll(e,t){var n,i;const r=null==(n=this.hls)?void 0:n.config;if(!r)return;const s=this.media;if(!s)return;const{seeking:a}=s,o=this.seeking&&!a,l=!this.seeking&&a,c=s.paused&&!a||s.ended||0===s.playbackRate;if(this.seeking=a,e!==t)return t&&(this.ended=0),this.moved=!0,a||(this.nudgeRetry=0,r.nudgeOnVideoHole&&!c&&e>t&&this.nudgeOnVideoHole(e,t)),void(0===this.waiting&&this.stallResolved(e));if(l||o)return void(o&&this.stallResolved(e));if(c)return this.nudgeRetry=0,this.stallResolved(e),void(!this.ended&&s.ended&&this.hls&&(this.ended=e||1,this.hls.trigger($e.MEDIA_ENDED,{stalled:!1})));if(!bi.getBuffered(s).length)return void(this.nudgeRetry=0);const u=bi.bufferInfo(s,e,0),h=u.nextStart||0,d=this.fragmentTracker;if(a&&d&&this.hls){const t=rc(this.hls.inFlightFragments,e),n=u.len>2,i=!h||t||h-e>2&&!d.getPartialFragment(e);if(n||i)return;this.moved=!1}const f=null==(i=this.hls)?void 0:i.latestLevelDetails;if(!this.moved&&null!==this.stalled&&d){if(!(u.len>0||h))return;const t=Math.max(h,u.start||0)-e,n=null!=f&&f.live?2*f.targetduration:2,i=ac(e,d);if(t>0&&(t<=n||i))return void(s.paused||this._trySkipBufferHole(i))}const p=r.detectStallWithCurrentTimeMs,g=self.performance.now(),m=this.waiting;let v=this.stalled;if(null===v){if(!(m>0&&g-m<p))return void(this.stalled=g);v=this.stalled=m}const y=g-v;if(!a&&(y>=p||m)&&this.hls){var b;if("ended"===(null==(b=this.mediaSource)?void 0:b.readyState)&&(null==f||!f.live)&&Math.abs(e-((null==f?void 0:f.edge)||0))<1){if(this.ended)return;return this.ended=e||1,void this.hls.trigger($e.MEDIA_ENDED,{stalled:!0})}if(this._reportStall(u),!this.media||!this.hls)return}const E=bi.bufferInfo(s,e,r.maxBufferHole);this._tryFixBufferStall(E,y,e)}stallResolved(e){const t=this.stalled;if(t&&this.hls&&(this.stalled=null,this.stallReported)){const n=self.performance.now()-t;this.log(`playback not stuck anymore @${e}, after ${Math.round(n)}ms`),this.stallReported=!1,this.waiting=0,this.hls.trigger($e.STALL_RESOLVED,{})}}nudgeOnVideoHole(e,t){var n;const i=this.buffered.video;if(this.hls&&this.media&&this.fragmentTracker&&null!=(n=this.buffered.audio)&&n.length&&i&&i.length>1&&e>i.end(0)){const n=bi.bufferedInfo(bi.timeRangesToArray(this.buffered.audio),e,0);if(n.len>1&&t>=n.start){const n=bi.timeRangesToArray(i),r=bi.bufferedInfo(n,t,0).bufferedIndex;if(r>-1&&r<n.length-1){const t=bi.bufferedInfo(n,e,0).bufferedIndex,i=n[r].end,s=n[r+1].start;if((-1===t||t>r)&&s-i<1&&e-i<2){const n=new Error(`nudging playhead to flush pipeline after video hole. currentTime: ${e} hole: ${i} -> ${s} buffered index: ${t}`);this.warn(n.message),this.media.currentTime+=1e-6;let r=ac(e,this.fragmentTracker);r&&"fragment"in r?r=r.fragment:r||(r=void 0);const a=bi.bufferInfo(this.media,e,0);this.hls.trigger($e.ERROR,{type:Be.MEDIA_ERROR,details:Ue.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:n,reason:n.message,frag:r,buffer:a.len,bufferInfo:a})}}}}}_tryFixBufferStall(e,t,n){var i,r;const{fragmentTracker:s,media:a}=this,o=null==(i=this.hls)?void 0:i.config;if(!a||!s||!o)return;const l=null==(r=this.hls)?void 0:r.latestLevelDetails,c=ac(n,s);if((c||null!=l&&l.live&&n<l.fragmentStart)&&(this._trySkipBufferHole(c)||!this.media))return;const u=e.buffered,h=this.adjacentTraversal(e,n);(u&&u.length>1&&e.len>o.maxBufferHole||e.nextStart&&(e.nextStart-n<o.maxBufferHole||h))&&(t>1e3*o.highBufferWatchdogPeriod||this.waiting)&&(this.warn("Trying to nudge playhead over buffer-hole"),this._tryNudgeBuffer(e))}adjacentTraversal(e,t){const n=this.fragmentTracker,i=e.nextStart;if(n&&i){const e=n.getFragAtPos(t,qe),r=n.getFragAtPos(i,qe);if(e&&r)return r.sn-e.sn<2}return!1}_reportStall(e){const{hls:t,media:n,stallReported:i,stalled:r}=this;if(!i&&null!==r&&n&&t){this.stallReported=!0;const i=new Error(`Playback stalling at @${n.currentTime} due to low buffer (${In(e)})`);this.warn(i.message),t.trigger($e.ERROR,{type:Be.MEDIA_ERROR,details:Ue.BUFFER_STALLED_ERROR,fatal:!1,error:i,buffer:e.len,bufferInfo:e,stalled:{start:r}})}}_trySkipBufferHole(e){var t;const{fragmentTracker:n,media:i}=this,r=null==(t=this.hls)?void 0:t.config;if(!i||!n||!r)return 0;const s=i.currentTime,a=bi.bufferInfo(i,s,0),o=s<a.start?a.start:a.nextStart;if(o&&this.hls){const t=a.len<=r.maxBufferHole,c=a.len>0&&a.len<1&&i.readyState<3,u=o-s;if(u>0&&(t||c)){if(u>r.maxBufferHole){let t=!1;if(0===s){const e=n.getAppendedFrag(0,qe);e&&o<e.end&&(t=!0)}if(!t&&e){var l;if(null==(l=this.hls.loadLevelObj)||!l.details)return 0;if(rc(this.hls.inFlightFragments,o))return 0;let t=!1,i=e.end;for(;i<o;){const e=ac(i,n);if(!e){t=!0;break}i+=e.duration}if(t)return 0}}const t=Math.max(o+.05,s+.1);if(this.warn(`skipping hole, adjusting currentTime from ${s} to ${t}`),this.moved=!0,i.currentTime=t,null==e||!e.gap){const n=new Error(`fragment loaded with buffer holes, seeking from ${s} to ${t}`),i={type:Be.MEDIA_ERROR,details:Ue.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:n,reason:n.message,buffer:a.len,bufferInfo:a};e&&("fragment"in e?i.part=e:i.frag=e),this.hls.trigger($e.ERROR,i)}return t}}return 0}_tryNudgeBuffer(e){const{hls:t,media:n,nudgeRetry:i}=this,r=null==t?void 0:t.config;if(!n||!r)return 0;const s=n.currentTime;if(this.nudgeRetry++,i<r.nudgeMaxRetry){const a=s+(i+1)*r.nudgeOffset,o=new Error(`Nudging 'currentTime' from ${s} to ${a}`);this.warn(o.message),n.currentTime=a,t.trigger($e.ERROR,{type:Be.MEDIA_ERROR,details:Ue.BUFFER_NUDGE_ON_STALL,error:o,fatal:!1,buffer:e.len,bufferInfo:e})}else{const n=new Error(`Playhead still not moving while enough data buffered @${s} after ${r.nudgeMaxRetry} nudges`);this.error(n.message),t.trigger($e.ERROR,{type:Be.MEDIA_ERROR,details:Ue.BUFFER_STALLED_ERROR,error:n,fatal:!0,buffer:e.len,bufferInfo:e})}}}function rc(e,t){const n=sc(e.main);if(n&&n.start<=t)return n;const i=sc(e.audio);return i&&i.start<=t?i:null}function sc(e){if(!e)return null;switch(e.state){case Nr:case Or:case zr:case Gr:return null}return e.frag}function ac(e,t){return t.getAppendedFrag(e,qe)||t.getPartialFragment(e)}function oc(){if("undefined"!=typeof self)return self.VTTCue||self.TextTrackCue}function lc(e,t,n,i,r){let s=new e(t,n,"");try{s.value=i,r&&(s.type=r)}catch(a){s=new e(t,n,In(r?Je({type:r},i):i))}return s}const cc=(()=>{const e=oc();try{e&&new e(0,Number.POSITIVE_INFINITY,"")}catch(e){return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();class uc{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.removeCues=!0,this.assetCue=void 0,this.onEventCueEnter=()=>{this.hls&&this.hls.trigger($e.EVENT_CUE_ENTER,{})},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=this.onEventCueEnter=null}_registerListeners(){const{hls:e}=this;e&&(e.on($e.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on($e.MEDIA_ATTACHED,this.onMediaAttached,this),e.on($e.MEDIA_DETACHING,this.onMediaDetaching,this),e.on($e.MANIFEST_LOADING,this.onManifestLoading,this),e.on($e.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on($e.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on($e.LEVEL_UPDATED,this.onLevelUpdated,this),e.on($e.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}_unregisterListeners(){const{hls:e}=this;e&&(e.off($e.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off($e.MEDIA_ATTACHED,this.onMediaAttached,this),e.off($e.MEDIA_DETACHING,this.onMediaDetaching,this),e.off($e.MANIFEST_LOADING,this.onManifestLoading,this),e.off($e.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off($e.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off($e.LEVEL_UPDATED,this.onLevelUpdated,this),e.off($e.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}onMediaAttaching(e,t){var n;this.media=t.media,!1===(null==(n=t.overrides)?void 0:n.cueRemoval)&&(this.removeCues=!1)}onMediaAttached(){var e;const t=null==(e=this.hls)?void 0:e.latestLevelDetails;t&&this.updateDateRangeCues(t)}onMediaDetaching(e,t){this.media=null,t.transferMedia||(this.id3Track&&(this.removeCues&&No(this.id3Track,this.onEventCueEnter),this.id3Track=null),this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const n=e[t];if("metadata"===n.kind&&"id3"===n.label)return Po(n,this.media),n}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media||!this.hls)return;const{enableEmsgMetadataCues:n,enableID3MetadataCues:i}=this.hls.config;if(!n&&!i)return;const{samples:r}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const s=oc();if(s)for(let e=0;e<r.length;e++){const t=r[e].type;if(t===Ss.emsg&&!n||!i)continue;const a=vs(r[e].data),o=r[e].pts;let l=o+r[e].duration;l>cc&&(l=cc),l-o<=0&&(l=o+.25);for(let e=0;e<a.length;e++){const n=a[e];if(!ys(n)){this.updateId3CueEnds(o,t);const e=lc(s,o,l,n,t);e&&this.id3Track.addCue(e)}}}}updateId3CueEnds(e,t){var n;const i=null==(n=this.id3Track)?void 0:n.cues;if(i)for(let n=i.length;n--;){const r=i[n];r.type===t&&r.startTime<e&&r.endTime===cc&&(r.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:n,type:i}){const{id3Track:r,hls:s}=this;if(!s)return;const{config:{enableEmsgMetadataCues:a,enableID3MetadataCues:o}}=s;if(r&&(a||o)){let e;e="audio"===i?e=>e.type===Ss.audioId3&&o:"video"===i?e=>e.type===Ss.emsg&&a:e=>e.type===Ss.audioId3&&o||e.type===Ss.emsg&&a,Mo(r,t,n,e)}}onLevelUpdated(e,{details:t}){this.updateDateRangeCues(t,!0)}onLevelPtsUpdated(e,t){Math.abs(t.drift)>.01&&this.updateDateRangeCues(t.details)}updateDateRangeCues(e,t){if(!this.hls||!this.media)return;const{assetPlayerId:n,timelineOffset:i,enableDateRangeMetadataCues:r,interstitialsController:s}=this.hls.config;if(!r)return;const a=oc();if(n&&i&&!s){const{fragmentStart:t,fragmentEnd:i}=e;let r=this.assetCue;r?(r.startTime=t,r.endTime=i):a&&(r=this.assetCue=lc(a,t,i,{assetPlayerId:this.hls.config.assetPlayerId},"hlsjs.interstitial.asset"),r&&(r.id=n,this.id3Track||(this.id3Track=this.createTrack(this.media)),this.id3Track.addCue(r),r.addEventListener("enter",this.onEventCueEnter)))}if(!e.hasProgramDateTime)return;const{id3Track:o}=this,{dateRanges:l}=e,c=Object.keys(l);let u=this.dateRangeCuesAppended;var h;if(o&&t)if(null!=(h=o.cues)&&h.length){const e=Object.keys(u).filter(e=>!c.includes(e));for(let t=e.length;t--;){var d;const n=e[t],i=null==(d=u[n])?void 0:d.cues;delete u[n],i&&Object.keys(i).forEach(e=>{const t=i[e];if(t){t.removeEventListener("enter",this.onEventCueEnter);try{o.removeCue(t)}catch(e){}}})}}else u=this.dateRangeCuesAppended={};const f=e.fragments[e.fragments.length-1];if(0!==c.length&&Ne(null==f?void 0:f.programDateTime)){this.id3Track||(this.id3Track=this.createTrack(this.media));for(let e=0;e<c.length;e++){const t=c[e],n=l[t],i=n.startTime,r=u[t],o=(null==r?void 0:r.cues)||{};let h=(null==r?void 0:r.durationKnown)||!1,d=cc;const{duration:f,endDate:p}=n;if(p&&null!==f)d=i+f,h=!0;else if(n.endOnNext&&!h){const e=c.reduce((e,t)=>{if(t!==n.id){const i=l[t];if(i.class===n.class&&i.startDate>n.startDate&&(!e||n.startDate<e.startDate))return i}return e},null);e&&(d=e.startTime,h=!0)}const g=Object.keys(n.attr);for(let e=0;e<g.length;e++){const l=g[e];if(!Ai(l))continue;const c=o[l];if(c)!h||null!=r&&r.durationKnown?Math.abs(c.startTime-i)>.01&&(c.startTime=i,c.endTime=d):c.endTime=d;else if(a){let e=n.attr[l];Ri(l)&&(e=ht(e));const r=lc(a,i,d,{key:l,data:e},Ss.dateRange);r&&(r.id=t,this.id3Track.addCue(r),o[l]=r,s&&("X-ASSET-LIST"!==l&&"X-ASSET-URL"!==l||r.addEventListener("enter",this.onEventCueEnter)))}}u[t]={cues:o,dateRange:n,durationKnown:h}}}}}class hc{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.currentTime=0,this.stallCount=0,this._latency=null,this._targetLatencyUpdated=!1,this.onTimeupdate=()=>{const{media:e}=this,t=this.levelDetails;if(!e||!t)return;this.currentTime=e.currentTime;const n=this.computeLatency();if(null===n)return;this._latency=n;const{lowLatencyMode:i,maxLiveSyncPlaybackRate:r}=this.config;if(!i||1===r||!t.live)return;const s=this.targetLatency;if(null===s)return;const a=n-s;if(a<Math.min(this.maxLatency,s+t.targetduration)&&a>.05&&this.forwardBufferLength>1){const t=Math.min(2,Math.max(1,r)),n=Math.round(2/(1+Math.exp(-.75*a-this.edgeStalled))*20)/20,i=Math.min(t,Math.max(1,n));this.changeMediaPlaybackRate(e,i)}else 1!==e.playbackRate&&0!==e.playbackRate&&this.changeMediaPlaybackRate(e,1)},this.hls=e,this.config=e.config,this.registerListeners()}get levelDetails(){var e;return(null==(e=this.hls)?void 0:e.latestLevelDetails)||null}get latency(){return this._latency||0}get maxLatency(){const{config:e}=this;if(void 0!==e.liveMaxLatencyDuration)return e.liveMaxLatencyDuration;const t=this.levelDetails;return t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const e=this.levelDetails;if(null===e||null===this.hls)return null;const{holdBack:t,partHoldBack:n,targetduration:i}=e,{liveSyncDuration:r,liveSyncDurationCount:s,lowLatencyMode:a}=this.config,o=this.hls.userConfig;let l=a&&n||t;(this._targetLatencyUpdated||o.liveSyncDuration||o.liveSyncDurationCount||0===l)&&(l=void 0!==r?r:s*i);const c=i;return l+Math.min(this.stallCount*this.config.liveSyncOnStallIncrease,c)}set targetLatency(e){this.stallCount=0,this.config.liveSyncDuration=e,this._targetLatencyUpdated=!0}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency;if(null===e||null===t)return null;const n=this.levelDetails;if(null===n)return null;const i=n.edge,r=e-t-this.edgeStalled,s=i-n.totalduration,a=i-(this.config.lowLatencyMode&&n.partTarget||n.targetduration);return Math.min(Math.max(s,r),a)}get drift(){const e=this.levelDetails;return null===e?1:e.drift}get edgeStalled(){const e=this.levelDetails;if(null===e)return 0;const t=3*(this.config.lowLatencyMode&&e.partTarget||e.targetduration);return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e}=this,t=this.levelDetails;if(!e||!t)return 0;const n=e.buffered.length;return(n?e.buffered.end(n-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.hls=null}registerListeners(){const{hls:e}=this;e&&(e.on($e.MEDIA_ATTACHED,this.onMediaAttached,this),e.on($e.MEDIA_DETACHING,this.onMediaDetaching,this),e.on($e.MANIFEST_LOADING,this.onManifestLoading,this),e.on($e.LEVEL_UPDATED,this.onLevelUpdated,this),e.on($e.ERROR,this.onError,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off($e.MEDIA_ATTACHED,this.onMediaAttached,this),e.off($e.MEDIA_DETACHING,this.onMediaDetaching,this),e.off($e.MANIFEST_LOADING,this.onManifestLoading,this),e.off($e.LEVEL_UPDATED,this.onLevelUpdated,this),e.off($e.ERROR,this.onError,this))}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.onTimeupdate)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.onTimeupdate),this.media=null)}onManifestLoading(){this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){t.advanced&&this.onTimeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.onTimeupdate)}onError(e,t){var n;t.details===Ue.BUFFER_STALLED_ERROR&&(this.stallCount++,this.hls&&null!=(n=this.levelDetails)&&n.live&&this.hls.logger.warn("[latency-controller]: Stall detected, adjusting target latency"))}changeMediaPlaybackRate(e,t){var n,i;e.playbackRate!==t&&(null==(n=this.hls)||n.logger.debug(`[latency-controller]: latency=${this.latency.toFixed(3)}, targetLatency=${null==(i=this.targetLatency)?void 0:i.toFixed(3)}, forwardBufferLength=${this.forwardBufferLength.toFixed(3)}: adjusting playback rate from ${e.playbackRate} to ${t}`),e.playbackRate=t)}estimateLiveEdge(){const e=this.levelDetails;return null===e?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return null===e?null:e-this.currentTime}}class dc extends Sa{constructor(e,t){super(e,"level-controller"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on($e.MANIFEST_LOADING,this.onManifestLoading,this),e.on($e.MANIFEST_LOADED,this.onManifestLoaded,this),e.on($e.LEVEL_LOADED,this.onLevelLoaded,this),e.on($e.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on($e.FRAG_BUFFERED,this.onFragBuffered,this),e.on($e.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off($e.MANIFEST_LOADING,this.onManifestLoading,this),e.off($e.MANIFEST_LOADED,this.onManifestLoaded,this),e.off($e.LEVEL_LOADED,this.onLevelLoaded,this),e.off($e.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off($e.FRAG_BUFFERED,this.onFragBuffered,this),e.off($e.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(e=>{e.loadError=0,e.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const n=this.hls.config.preferManagedMediaSource,i=[],r={},s={};let a=!1,o=!1,l=!1;t.levels.forEach(e=>{const t=e.attrs;let{audioCodec:c,videoCodec:u}=e;c&&(e.audioCodec=c=hn(c,n)||void 0),u&&(u=e.videoCodec=function(e){const t=e.split(",");for(let e=0;e<t.length;e++){const n=t[e].split(".");n.length>2&&"avc1"===n[0]&&(t[e]=`avc1.${parseInt(n[1]).toString(16)}${("000"+parseInt(n[2]).toString(16)).slice(-4)}`)}return t.join(",")}(u));const{width:h,height:d,unknownCodecs:f}=e,p=(null==f?void 0:f.length)||0;if(a||(a=!(!h||!d)),o||(o=!!u),l||(l=!!c),p||c&&!this.isAudioSupported(c)||u&&!this.isVideoSupported(u))return void this.log(`Some or all CODECS not supported "${t.CODECS}"`);const{CODECS:g,"FRAME-RATE":m,"HDCP-LEVEL":v,"PATHWAY-ID":y,RESOLUTION:b,"VIDEO-RANGE":E}=t,S=`${y||"."}-${e.bitrate}-${b}-${m}-${g}-${E}-${v}`;if(r[S])if(r[S].uri===e.url||e.attrs["PATHWAY-ID"])r[S].addGroupId("audio",t.AUDIO),r[S].addGroupId("text",t.SUBTITLES);else{const t=s[S]+=1;e.attrs["PATHWAY-ID"]=new Array(t+1).join(".");const n=this.createLevel(e);r[S]=n,i.push(n)}else{const t=this.createLevel(e);r[S]=t,s[S]=1,i.push(t)}}),this.filterAndSortMediaOptions(i,t,a,o,l)}createLevel(e){const t=new An(e),n=e.supplemental;if(null!=n&&n.videoCodec&&!this.isVideoSupported(n.videoCodec)){const e=new Error(`SUPPLEMENTAL-CODECS not supported "${n.videoCodec}"`);this.log(e.message),t.supportedResult=bn(e,[])}return t}isAudioSupported(e){return rn(e,"audio",this.hls.config.preferManagedMediaSource)}isVideoSupported(e){return rn(e,"video",this.hls.config.preferManagedMediaSource)}filterAndSortMediaOptions(e,t,n,i,r){var s;let a=[],o=[],l=e;const c=(null==(s=t.stats)?void 0:s.parsing)||{};if((n||i)&&r&&(l=l.filter(({videoCodec:e,videoRange:t,width:n,height:i})=>{return(!!e||!(!n||!i))&&!!(r=t)&&_n.indexOf(r)>-1;var r})),0===l.length)return Promise.resolve().then(()=>{if(this.hls){let e="no level with compatible codecs found in manifest",n=e;t.levels.length&&(n=`one or more CODECS in variant not supported: ${In(t.levels.map(e=>e.attrs.CODECS).filter((e,t,n)=>n.indexOf(e)===t))}`,this.warn(n),e+=` (${n})`);const i=new Error(e);this.hls.trigger($e.ERROR,{type:Be.MEDIA_ERROR,details:Ue.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:i,reason:n})}}),void(c.end=performance.now());t.audioTracks&&(a=t.audioTracks.filter(e=>!e.audioCodec||this.isAudioSupported(e.audioCodec)),fc(a)),t.subtitles&&(o=t.subtitles,fc(o));const u=l.slice(0);l.sort((e,t)=>{if(e.attrs["HDCP-LEVEL"]!==t.attrs["HDCP-LEVEL"])return(e.attrs["HDCP-LEVEL"]||"")>(t.attrs["HDCP-LEVEL"]||"")?1:-1;if(n&&e.height!==t.height)return e.height-t.height;if(e.frameRate!==t.frameRate)return e.frameRate-t.frameRate;if(e.videoRange!==t.videoRange)return _n.indexOf(e.videoRange)-_n.indexOf(t.videoRange);if(e.videoCodec!==t.videoCodec){const n=on(e.videoCodec),i=on(t.videoCodec);if(n!==i)return i-n}if(e.uri===t.uri&&e.codecSet!==t.codecSet){const n=ln(e.codecSet),i=ln(t.codecSet);if(n!==i)return i-n}return e.averageBitrate!==t.averageBitrate?e.averageBitrate-t.averageBitrate:0});let h=u[0];if(this.steering&&(l=this.steering.filterParsedLevels(l),l.length!==u.length))for(let e=0;e<u.length;e++)if(u[e].pathwayId===l[0].pathwayId){h=u[e];break}this._levels=l;for(let e=0;e<l.length;e++)if(l[e]===h){var d;this._firstLevel=e;const t=h.bitrate,n=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${l.length} level(s) found, first bitrate: ${t}`),void 0===(null==(d=this.hls.userConfig)?void 0:d.abrEwmaDefaultEstimate)){const e=Math.min(t,this.hls.config.abrEwmaDefaultEstimateMax);e>n&&n===this.hls.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=e)}break}const f=r&&!i,p=this.hls.config,g=!(!p.audioStreamController||!p.audioTrackController),m={levels:l,audioTracks:a,subtitleTracks:o,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:r,video:i,altAudio:g&&!f&&a.some(e=>!!e.url)};c.end=performance.now(),this.hls.trigger($e.MANIFEST_PARSED,m)}get levels(){return 0===this._levels.length?null:this._levels}get loadLevelObj(){return this.currentLevel}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(0===t.length)return;if(e<0||e>=t.length){const n=new Error("invalid level idx"),i=e<0;if(this.hls.trigger($e.ERROR,{type:Be.OTHER_ERROR,details:Ue.LEVEL_SWITCH_ERROR,level:e,fatal:i,error:n,reason:n.message}),i)return;e=Math.min(e,t.length-1)}const n=this.currentLevelIndex,i=this.currentLevel,r=i?i.attrs["PATHWAY-ID"]:void 0,s=t[e],a=s.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=s,n===e&&i&&r===a)return;this.log(`Switching to level ${e} (${s.height?s.height+"p ":""}${s.videoRange?s.videoRange+" ":""}${s.codecSet?s.codecSet+" ":""}@${s.bitrate})${a?" with Pathway "+a:""} from level ${n}${r?" with Pathway "+r:""}`);const o={level:e,attrs:s.attrs,details:s.details,bitrate:s.bitrate,averageBitrate:s.averageBitrate,maxBitrate:s.maxBitrate,realBitrate:s.realBitrate,width:s.width,height:s.height,codecSet:s.codecSet,audioCodec:s.audioCodec,videoCodec:s.videoCodec,audioGroups:s.audioGroups,subtitleGroups:s.subtitleGroups,loaded:s.loaded,loadError:s.loadError,fragmentError:s.fragmentError,name:s.name,id:s.id,uri:s.uri,url:s.url,urlId:0,audioGroupIds:s.audioGroupIds,textGroupIds:s.textGroupIds};this.hls.trigger($e.LEVEL_SWITCHING,o);const l=s.details;if(!l||l.live){const e=this.switchParams(s.uri,null==i?void 0:i.details,l);this.loadPlaylist(e)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(void 0===this._startLevel){const e=this.hls.config.startLevel;return void 0!==e?e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(e){this._startLevel=e}get pathways(){return this.steering?this.steering.pathways():[]}get pathwayPriority(){return this.steering?this.steering.pathwayPriority:null}set pathwayPriority(e){if(this.steering){const t=this.steering.pathways(),n=e.filter(e=>-1!==t.indexOf(e));if(e.length<1)return void this.warn(`pathwayPriority ${e} should contain at least one pathway from list: ${t}`);this.steering.pathwayPriority=n}}onError(e,t){!t.fatal&&t.context&&t.context.type===ze&&t.context.level===this.level&&this.checkRetry(t)}onFragBuffered(e,{frag:t}){if(void 0!==t&&t.type===qe){const e=t.elementaryStreams;if(!Object.keys(e).some(t=>!!e[t]))return;const n=this._levels[t.level];null!=n&&n.loadError&&(this.log(`Resetting level error count of ${n.loadError} on frag buffered`),n.loadError=0)}}onLevelLoaded(e,t){var n;const{level:i,details:r}=t,s=t.levelInfo;var a;if(!s)return this.warn(`Invalid level index ${i}`),void(null!=(a=t.deliveryDirectives)&&a.skip&&(r.deltaUpdateFailed=!0));if(s===this.currentLevel||t.withoutMultiVariant){0===s.fragmentError&&(s.loadError=0);let e=s.details;e===t.details&&e.advanced&&(e=void 0),this.playlistLoaded(i,t,e)}else null!=(n=t.deliveryDirectives)&&n.skip&&(r.deltaUpdateFailed=!0)}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentLevel)&&this.scheduleLoading(this.currentLevel,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const n=this.getUrlWithDirectives(e.uri,t),i=this.currentLevelIndex,r=e.attrs["PATHWAY-ID"],s=e.details,a=null==s?void 0:s.age;this.log(`Loading level index ${i}${void 0!==(null==t?void 0:t.msn)?" at sn "+t.msn+" part "+t.part:""}${r?" Pathway "+r:""}${a&&s.live?" age "+a.toFixed(1)+(s.type?" "+s.type||0:""):""} ${n}`),this.hls.trigger($e.LEVEL_LOADING,{url:n,level:i,levelInfo:e,pathwayId:e.attrs["PATHWAY-ID"],id:0,deliveryDirectives:t||null})}get nextLoadLevel(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=e)}removeLevel(e){var t;if(1===this._levels.length)return;const n=this._levels.filter((t,n)=>n!==e||(this.steering&&this.steering.removeLevel(t),t===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,t.details&&t.details.fragments.forEach(e=>e.level=-1)),!1));kr(n),this._levels=n,this.currentLevelIndex>-1&&null!=(t=this.currentLevel)&&t.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.manualLevelIndex>-1&&(this.manualLevelIndex=this.currentLevelIndex);const i=n.length-1;this._firstLevel=Math.min(this._firstLevel,i),this._startLevel&&(this._startLevel=Math.min(this._startLevel,i)),this.hls.trigger($e.LEVELS_UPDATED,{levels:n})}onLevelsUpdated(e,{levels:t}){this._levels=t}checkMaxAutoUpdated(){const{autoLevelCapping:e,maxAutoLevel:t,maxHdcpLevel:n}=this.hls;this._maxAutoLevel!==t&&(this._maxAutoLevel=t,this.hls.trigger($e.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:e,levels:this.levels,maxAutoLevel:t,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:n}))}}function fc(e){const t={};e.forEach(e=>{const n=e.groupId||"";e.id=t[n]=t[n]||0,t[n]++})}function pc(){return self.SourceBuffer||self.WebKitSourceBuffer}function gc(){if(!ot())return!1;const e=pc();return!e||e.prototype&&"function"==typeof e.prototype.appendBuffer&&"function"==typeof e.prototype.remove}class mc extends Hr{constructor(e,t,n){super(e,t,n,"stream-controller",qe),this.audioCodecSwap=!1,this.level=-1,this._forceStartLoad=!1,this._hasEnoughToStart=!1,this.altAudio=0,this.audioOnly=!1,this.fragPlaying=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this.onMediaPlaying=()=>{this.tick()},this.onMediaSeeked=()=>{const e=this.media,t=e?e.currentTime:null;if(null===t||!Ne(t))return;if(this.log(`Media seeked to ${t.toFixed(3)}`),!this.getBufferedFrag(t))return;const n=this.getFwdBufferInfoAtPos(e,t,qe,0);null!==n&&0!==n.len?this.tick():this.warn(`Main forward buffer length at ${t} on "seeked" event ${n?n.len:"empty"})`)},this.registerListeners()}registerListeners(){super.registerListeners();const{hls:e}=this;e.on($e.MANIFEST_PARSED,this.onManifestParsed,this),e.on($e.LEVEL_LOADING,this.onLevelLoading,this),e.on($e.LEVEL_LOADED,this.onLevelLoaded,this),e.on($e.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on($e.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on($e.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on($e.BUFFER_CREATED,this.onBufferCreated,this),e.on($e.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on($e.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on($e.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off($e.MANIFEST_PARSED,this.onManifestParsed,this),e.off($e.LEVEL_LOADED,this.onLevelLoaded,this),e.off($e.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off($e.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off($e.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off($e.BUFFER_CREATED,this.onBufferCreated,this),e.off($e.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off($e.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off($e.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this.onMediaPlaying=this.onMediaSeeked=null,this.unregisterListeners(),super.onHandlerDestroying()}startLoad(e,t){if(this.levels){const{lastCurrentTime:n,hls:i}=this;if(this.stopLoad(),this.setInterval(100),this.level=-1,!this.startFragRequested){let e=i.startLevel;-1===e&&(i.config.testBandwidth&&this.levels.length>1?(e=0,this.bitrateTest=!0):e=i.firstAutoLevel),i.nextLoadLevel=e,this.level=i.loadLevel,this._hasEnoughToStart=!!t}n>0&&-1===e&&!t&&(this.log(`Override startPosition with lastCurrentTime @${n.toFixed(3)}`),e=n),this.state=Nr,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}else this._forceStartLoad=!0,this.state=Or}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case qr:{const{levels:e,level:t}=this,n=null==e?void 0:e[t],i=null==n?void 0:n.details;if(i&&(!i.live||this.levelLastLoaded===n&&!this.waitForLive(n))){if(this.waitForCdnTuneIn(i))break;this.state=Nr;break}if(this.hls.nextLoadLevel!==this.level){this.state=Nr;break}break}case Br:this.checkRetryDate()}this.state===Nr&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){var e;super.onTickEnd(),null!=(e=this.media)&&e.readyState&&!1===this.media.seeking&&(this.lastCurrentTime=this.media.currentTime),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:n,media:i}=this;if(null===t||!i&&!this.primaryPrefetch&&(this.startFragRequested||!e.config.startFragPrefetch))return;if(this.altAudio&&this.audioOnly)return;const r=this.buffering?e.nextLoadLevel:e.loadLevel;if(null==n||!n[r])return;const s=n[r],a=this.getMainFwdBufferInfo();if(null===a)return;const o=this.getLevelDetails();if(o&&this._streamEnded(a,o)){const e={};return 2===this.altAudio&&(e.type="video"),this.hls.trigger($e.BUFFER_EOS,e),void(this.state=zr)}if(!this.buffering)return;e.loadLevel!==r&&-1===e.manualLevel&&this.log(`Adapting to level ${r} from level ${this.level}`),this.level=e.nextLoadLevel=r;const l=s.details;if(!l||this.state===qr||this.waitForLive(s))return this.level=r,this.state=qr,void(this.startFragRequested=!1);const c=a.len,u=this.getMaxBufferLength(s.maxBitrate);if(c>=u)return;this.backtrackFragment&&this.backtrackFragment.start>a.end&&(this.backtrackFragment=null);const h=this.backtrackFragment?this.backtrackFragment.start:a.end;let d=this.getNextFragment(h,l);if(this.couldBacktrack&&!this.fragPrevious&&d&&xt(d)&&this.fragmentTracker.getState(d)!==ni){var f;const e=(null!=(f=this.backtrackFragment)?f:d).sn-l.startSN,t=l.fragments[e-1];t&&d.cc===t.cc&&(d=t,this.fragmentTracker.removeFragment(t))}else this.backtrackFragment&&a.len&&(this.backtrackFragment=null);if(d&&this.isLoopLoading(d,h)){if(!d.gap){const e=this.audioOnly&&!this.altAudio?wt:Tt,t=(e===Tt?this.videoBuffer:this.mediaBuffer)||this.media;t&&this.afterBufferFlushed(t,e,qe)}d=this.getNextFragmentLoopLoading(d,l,a,qe,u)}d&&(!d.initSegment||d.initSegment.data||this.bitrateTest||(d=d.initSegment),this.loadFragment(d,s,h))}loadFragment(e,t,n){const i=this.fragmentTracker.getState(e);i===Jn||i===ti?xt(e)?this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):super.loadFragment(e,t,n):this._loadInitSegment(e,t):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,qe)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(null!=t&&t.readyState){let n;const i=this.getAppendedFrag(t.currentTime);i&&i.start>1&&this.flushMainBuffer(0,i.start-1);const r=this.getLevelDetails();if(null!=r&&r.live){const e=this.getMainFwdBufferInfo();if(!e||e.len<2*r.targetduration)return}if(!t.paused&&e){const t=e[this.hls.nextLoadLevel],i=this.fragLastKbps;n=i&&this.fragCurrent?this.fragCurrent.duration*t.maxBitrate/(1e3*i)+1:0}else n=0;const s=this.getBufferedFrag(t.currentTime+n);if(s){const e=this.followingBufferedFrag(s);if(e){this.abortCurrentFrag();const t=e.maxStartPTS?e.maxStartPTS:e.start,n=e.duration,i=Math.max(s.end,t+Math.min(Math.max(n-this.config.maxFragLookUpTolerance,n*(this.couldBacktrack?.5:.125)),n*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(i,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case Mr:case Fr:case Br:case $r:case jr:this.state=Nr}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,2===this.altAudio?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const n=t.media;Dr(n,"playing",this.onMediaPlaying),Dr(n,"seeked",this.onMediaSeeked)}onMediaDetaching(e,t){const{media:n}=this;n&&(Pr(n,"playing",this.onMediaPlaying),Pr(n,"seeked",this.onMediaSeeked)),this.videoBuffer=null,this.fragPlaying=null,super.onMediaDetaching(e,t),t.transferMedia||(this._hasEnoughToStart=!1)}onManifestLoading(){super.onManifestLoading(),this.log("Trigger BUFFER_RESET"),this.hls.trigger($e.BUFFER_RESET,void 0),this.couldBacktrack=!1,this.fragLastKbps=0,this.fragPlaying=this.backtrackFragment=null,this.altAudio=0,this.audioOnly=!1}onManifestParsed(e,t){let n=!1,i=!1;for(let e=0;e<t.levels.length;e++){const r=t.levels[e].audioCodec;r&&(n=n||-1!==r.indexOf("mp4a.40.2"),i=i||-1!==r.indexOf("mp4a.40.5"))}this.audioCodecSwitch=n&&i&&!function(){var e;const t=pc();return"function"==typeof(null==t||null==(e=t.prototype)?void 0:e.changeType)}(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:n}=this;if(!n||this.state!==Nr)return;const i=t.levelInfo;(!i.details||i.details.live&&(this.levelLastLoaded!==i||i.details.expired)||this.waitForCdnTuneIn(i.details))&&(this.state=qr)}onLevelLoaded(e,t){var n;const{levels:i,startFragRequested:r}=this,s=t.level,a=t.details,o=a.totalduration;if(!i)return void this.warn(`Levels were reset while loading level ${s}`);this.log(`Level ${s} loaded [${a.startSN},${a.endSN}]${a.lastPartSn?`[part-${a.lastPartSn}-${a.lastPartIndex}]`:""}, cc [${a.startCC}, ${a.endCC}] duration:${o}`);const l=t.levelInfo,c=this.fragCurrent;!c||this.state!==Fr&&this.state!==Br||c.level!==t.level&&c.loader&&this.abortCurrentFrag();let u=0;if(a.live||null!=(n=l.details)&&n.live){var h;if(this.checkLiveUpdate(a),a.deltaUpdateFailed)return;u=this.alignPlaylists(a,l.details,null==(h=this.levelLastLoaded)?void 0:h.details)}if(l.details=a,this.levelLastLoaded=l,r||this.setStartPosition(a,u),this.hls.trigger($e.LEVEL_UPDATED,{details:a,level:s}),this.state===qr){if(this.waitForCdnTuneIn(a))return;this.state=Nr}r&&a.live&&this.synchronizeToLiveEdge(a),this.tick()}synchronizeToLiveEdge(e){const{config:t,media:n}=this;if(!n)return;const i=this.hls.liveSyncPosition,r=this.getLoadPosition(),s=e.fragmentStart,a=e.edge,o=r>=s-t.maxFragLookUpTolerance&&r<=a;if(null!==i&&n.duration>i&&(r<i||!o)){const s=void 0!==t.liveMaxLatencyDuration?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;if((!o&&n.readyState<4||r<a-s)&&(this._hasEnoughToStart||(this.nextLoadPosition=i),n.readyState))if(this.warn(`Playback: ${r.toFixed(3)} is located too far from the end of live sliding playlist: ${a}, reset currentTime to : ${i.toFixed(3)}`),"buffered"===this.config.liveSyncMode){var l;const e=bi.bufferInfo(n,i,0);if(null==(l=e.buffered)||!l.length)return void(n.currentTime=i);if(e.start<=r)return void(n.currentTime=i);const{nextStart:t}=bi.bufferedInfo(e.buffered,r,0);t&&(n.currentTime=t)}else n.currentTime=i}}_handleFragmentLoadProgress(e){var t;const n=e.frag,{part:i,payload:r}=e,{levels:s}=this;if(!s)return void this.warn(`Levels were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);const a=s[n.level];if(!a)return void this.warn(`Level ${n.level} not found on progress`);const o=a.details;if(!o)return this.warn(`Dropping fragment ${n.sn} of level ${n.level} after level details were reset`),void this.fragmentTracker.removeFragment(n);const l=a.videoCodec,c=o.PTSKnown||!o.live,u=null==(t=n.initSegment)?void 0:t.data,h=this._getAudioCodec(a),d=this.transmuxer=this.transmuxer||new Ea(this.hls,qe,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),f=i?i.index:-1,p=-1!==f,g=new vi(n.level,n.sn,n.stats.chunkCount,r.byteLength,f,p),m=this.initPTS[n.cc];d.push(r,u,h,l,n,i,o.totalduration,c,g,m)}onAudioTrackSwitching(e,t){const n=this.hls,i=2===this.altAudio;if(Bn(t.url,n))this.altAudio=1;else{if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const e=this.fragCurrent;e&&(this.log("Switching to main audio track, cancel main fragment load"),e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();if(i)return this.fragmentTracker.removeAllFragments(),n.once($e.BUFFER_FLUSHED,()=>{this.hls&&this.hls.trigger($e.AUDIO_TRACK_SWITCHED,t)}),void n.trigger($e.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null});n.trigger($e.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const n=Bn(t.url,this.hls);if(n){const e=this.videoBuffer;e&&this.mediaBuffer!==e&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=e)}this.altAudio=n?2:0,this.tick()}onBufferCreated(e,t){const n=t.tracks;let i,r,s=!1;for(const e in n){const t=n[e];if("main"===t.id){if(r=e,i=t,"video"===e){const t=n[e];t&&(this.videoBuffer=t.buffer)}}else s=!0}s&&i?(this.log(`Alternate track found, use ${r}.buffered to schedule main fragment loading`),this.mediaBuffer=i.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:n,part:i}=t,r=n.type===qe;if(r){if(this.fragContextChanged(n))return this.warn(`Fragment ${n.sn}${i?" p: "+i.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}`),void(this.state===jr&&(this.state=Nr));const e=i?i.stats:n.stats;this.fragLastKbps=Math.round(8*e.total/(e.buffering.end-e.loading.first)),xt(n)&&(this.fragPrevious=n),this.fragBufferedComplete(n,i)}const s=this.media;s&&(!this._hasEnoughToStart&&bi.getBuffered(s).length&&(this._hasEnoughToStart=!0,this.seekToStartPos()),r&&this.tick())}get hasEnoughToStart(){return this._hasEnoughToStart}onError(e,t){var n;if(t.fatal)this.state=Gr;else switch(t.details){case Ue.FRAG_GAP:case Ue.FRAG_PARSING_ERROR:case Ue.FRAG_DECRYPT_ERROR:case Ue.FRAG_LOAD_ERROR:case Ue.FRAG_LOAD_TIMEOUT:case Ue.KEY_LOAD_ERROR:case Ue.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(qe,t);break;case Ue.LEVEL_LOAD_ERROR:case Ue.LEVEL_LOAD_TIMEOUT:case Ue.LEVEL_PARSING_ERROR:t.levelRetry||this.state!==qr||(null==(n=t.context)?void 0:n.type)!==ze||(this.state=Nr);break;case Ue.BUFFER_ADD_CODEC_ERROR:case Ue.BUFFER_APPEND_ERROR:if("main"!==t.parent)return;this.reduceLengthAndFlushBuffer(t)&&this.resetLoadingState();break;case Ue.BUFFER_FULL_ERROR:if("main"!==t.parent)return;this.reduceLengthAndFlushBuffer(t)&&(!this.config.interstitialsController&&this.config.assetPlayerId?this._hasEnoughToStart=!0:this.flushMainBuffer(0,Number.POSITIVE_INFINITY));break;case Ue.INTERNAL_EXCEPTION:this.recoverWorkerError(t)}}onFragLoadEmergencyAborted(){this.state=Nr,this._hasEnoughToStart||(this.startFragRequested=!1,this.nextLoadPosition=this.lastCurrentTime),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==wt||!this.altAudio){const e=(t===Tt?this.videoBuffer:this.mediaBuffer)||this.media;e&&(this.afterBufferFlushed(e,t,qe),this.tick())}}onLevelsUpdated(e,t){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level,-1===this.level&&this.resetWhenMissingContext(this.fragCurrent)),this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let n=this.startPosition;if(n>=0&&t<n){if(e.seeking)return void this.log(`could not seek to ${n}, already seeking at ${t}`);const i=this.timelineOffset;i&&n&&(n+=i);const r=this.getLevelDetails(),s=bi.getBuffered(e),a=s.length?s.start(0):0,o=a-n,l=Math.max(this.config.maxBufferHole,this.config.maxFragLookUpTolerance);(this.config.startOnSegmentBoundary||o>0&&(o<l||this.loadingParts&&o<2*((null==r?void 0:r.partTarget)||0)))&&(this.log(`adjusting start position by ${o} to match buffer start`),n+=o,this.startPosition=n),t<n&&(this.log(`seek to target start position ${n} from current time ${t} buffer start ${a}`),e.currentTime=n)}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t=-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(e=>{const{hls:n}=this,i=null==e?void 0:e.frag;if(!i||this.fragContextChanged(i))return;t.fragmentError=0,this.state=Nr,this.startFragRequested=!1,this.bitrateTest=!1;const r=i.stats;r.parsing.start=r.parsing.end=r.buffering.start=r.buffering.end=self.performance.now(),n.trigger($e.FRAG_LOADED,e),i.bitrateTest=!1}).catch(t=>{this.state!==Or&&this.state!==Gr&&(this.warn(t),this.resetFragmentLoading(e))})}_handleTransmuxComplete(e){const t=this.playlistType,{hls:n}=this,{remuxResult:i,chunkMeta:r}=e,s=this.getCurrentContext(r);if(!s)return void this.resetWhenMissingContext(r);const{frag:a,part:o,level:l}=s,{video:c,text:u,id3:h,initSegment:d}=i,{details:f}=l,p=this.altAudio?void 0:i.audio;if(this.fragContextChanged(a))this.fragmentTracker.removeFragment(a);else{if(this.state=$r,d){const e=d.tracks;if(e){const i=a.initSegment||a;if(this.unhandledEncryptionError(d,a))return;this._bufferInitSegment(l,e,i,r),n.trigger($e.FRAG_PARSING_INIT_SEGMENT,{frag:i,id:t,tracks:e})}const i=d.initPTS,s=d.timescale,o=this.initPTS[a.cc];if(Ne(i)&&(!o||o.baseTime!==i||o.timescale!==s)){const e=d.trackId;this.initPTS[a.cc]={baseTime:i,timescale:s,trackId:e},n.trigger($e.INIT_PTS_FOUND,{frag:a,id:t,initPTS:i,timescale:s,trackId:e})}}if(c&&f){p&&"audiovideo"===c.type&&this.logMuxedErr(a);const e=f.fragments[a.sn-1-f.startSN],t=a.sn===f.startSN,n=!e||a.cc>e.cc;if(!1!==i.independent){const{startPTS:e,endPTS:i,startDTS:s,endDTS:l}=c;if(o)o.elementaryStreams[c.type]={startPTS:e,endPTS:i,startDTS:s,endDTS:l};else if(c.firstKeyFrame&&c.independent&&1===r.id&&!n&&(this.couldBacktrack=!0),c.dropped&&c.independent){const r=this.getMainFwdBufferInfo(),s=(r?r.end:this.getLoadPosition())+this.config.maxBufferHole,o=c.firstKeyFramePTS?c.firstKeyFramePTS:e;if(!t&&s<o-this.config.maxBufferHole&&!n)return void this.backtrack(a);n&&(a.gap=!0),a.setElementaryStreamInfo(c.type,a.start,i,a.start,l,!0)}else t&&e-(f.appliedTimelineOffset||0)>2&&(a.gap=!0);a.setElementaryStreamInfo(c.type,e,i,s,l),this.backtrackFragment&&(this.backtrackFragment=a),this.bufferFragmentData(c,a,o,r,t||n)}else{if(!t&&!n)return void this.backtrack(a);a.gap=!0}}if(p){const{startPTS:e,endPTS:t,startDTS:n,endDTS:i}=p;o&&(o.elementaryStreams[wt]={startPTS:e,endPTS:t,startDTS:n,endDTS:i}),a.setElementaryStreamInfo(wt,e,t,n,i),this.bufferFragmentData(p,a,o,r)}if(f&&null!=h&&h.samples.length){const e={id:t,frag:a,details:f,samples:h.samples};n.trigger($e.FRAG_PARSING_METADATA,e)}if(f&&u){const e={id:t,frag:a,details:f,samples:u.samples};n.trigger($e.FRAG_PARSING_USERDATA,e)}}}logMuxedErr(e){this.warn(`${xt(e)?"Media":"Init"} segment with muxed audiovideo where only video expected: ${e.url}`)}_bufferInitSegment(e,t,n,i){if(this.state!==$r)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&(delete t.audio,t.audiovideo&&this.logMuxedErr(n));const{audio:r,video:s,audiovideo:a}=t;if(r){const n=e.audioCodec;let i=dn(r.codec,n);"mp4a"===i&&(i="mp4a.40.5");const s=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){i&&(i=-1!==i.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5");const e=r.metadata;e&&"channelCount"in e&&1!==(e.channelCount||1)&&-1===s.indexOf("firefox")&&(i="mp4a.40.5")}i&&-1!==i.indexOf("mp4a.40.5")&&-1!==s.indexOf("android")&&"audio/mpeg"!==r.container&&(i="mp4a.40.2",this.log(`Android: force audio codec to ${i}`)),n&&n!==i&&this.log(`Swapping manifest audio codec "${n}" for "${i}"`),r.levelCodec=i,r.id=qe,this.log(`Init audio buffer, container:${r.container}, codecs[selected/level/parsed]=[${i||""}/${n||""}/${r.codec}]`),delete t.audiovideo}if(s){s.levelCodec=e.videoCodec,s.id=qe;const n=s.codec;if(4===(null==n?void 0:n.length))switch(n){case"hvc1":case"hev1":s.codec="hvc1.1.6.L120.90";break;case"av01":s.codec="av01.0.04M.08";break;case"avc1":s.codec="avc1.42e01e"}this.log(`Init video buffer, container:${s.container}, codecs[level/parsed]=[${e.videoCodec||""}/${n}]${s.codec!==n?" parsed-corrected="+s.codec:""}${s.supplemental?" supplemental="+s.supplemental:""}`),delete t.audiovideo}a&&(this.log(`Init audiovideo buffer, container:${a.container}, codecs[level/parsed]=[${e.codecs}/${a.codec}]`),delete t.video,delete t.audio);const o=Object.keys(t);if(o.length){if(this.hls.trigger($e.BUFFER_CODECS,t),!this.hls)return;o.forEach(e=>{const r=t[e].initSegment;null!=r&&r.byteLength&&this.hls.trigger($e.BUFFER_APPENDING,{type:e,data:r,frag:n,part:null,chunkMeta:i,parent:n.type})})}this.tickImmediate()}getMainFwdBufferInfo(){const e=this.mediaBuffer&&2===this.altAudio?this.mediaBuffer:this.media;return this.getFwdBufferInfo(e,qe)}get maxBufferLength(){const{levels:e,level:t}=this,n=null==e?void 0:e[t];return n?this.getMaxBufferLength(n.maxBitrate):this.config.maxBufferLength}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=Nr}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&!1===e.seeking){const n=e.currentTime;if(bi.isBuffered(e,n)?t=this.getAppendedFrag(n):bi.isBuffered(e,n+.1)&&(t=this.getAppendedFrag(n+.1)),t){this.backtrackFragment=null;const e=this.fragPlaying,n=t.level;e&&t.sn===e.sn&&e.level===n||(this.fragPlaying=t,this.hls.trigger($e.FRAG_CHANGED,{frag:t}),e&&e.level===n||this.hls.trigger($e.LEVEL_SWITCHED,{level:n}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){var e;if(this.fragPlaying)return this.fragPlaying;const t=(null==(e=this.media)?void 0:e.currentTime)||this.lastCurrentTime;return Ne(t)?this.getAppendedFrag(t):null}get currentProgramDateTime(){var e;const t=(null==(e=this.media)?void 0:e.currentTime)||this.lastCurrentTime;if(Ne(t)){const e=this.getLevelDetails(),n=this.currentFrag||(e?$n(null,e.fragments,t):null);if(n){const e=n.programDateTime;if(null!==e){const i=e+1e3*(t-n.start);return new Date(i)}}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class vc extends et{constructor(e,t){super("key-loader",t),this.config=void 0,this.keyIdToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const n in this.keyIdToKeyInfo){const i=this.keyIdToKeyInfo[n].loader;if(i){var t;if(e&&e!==(null==(t=i.context)?void 0:t.frag.type))return;i.abort()}}}detach(){for(const e in this.keyIdToKeyInfo){const t=this.keyIdToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyIdToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyIdToKeyInfo){const t=this.keyIdToKeyInfo[e].loader;t&&t.destroy()}this.keyIdToKeyInfo={}}createKeyLoadError(e,t=Ue.KEY_LOAD_ERROR,n,i,r){return new gi({type:Be.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:r,error:n,networkDetails:i})}loadClear(e,t,n){if(this.emeController&&this.config.emeEnabled&&!this.emeController.getSelectedKeySystemFormats().length){if(t.length)for(let i=0,r=t.length;i<r;i++){const s=t[i];if(e.cc<=s.cc&&(!xt(e)||!xt(s)||e.sn<s.sn)||!n&&i==r-1)return this.emeController.selectKeySystemFormat(s).then(e=>{if(!this.emeController)return;s.setKeyFormat(e);const t=qi(e);return t?this.emeController.getKeySystemAccess([t]):void 0})}if(this.config.requireKeySystemAccessOnStart){const e=Wi(this.config);if(e.length)return this.emeController.getKeySystemAccess(e)}}return null}load(e){return!e.decryptdata&&e.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var n,i;t&&e.setKeyFormat(t);const r=e.decryptdata;if(!r){const n=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:`Missing decryption data on fragment in onKeyLoading (emeEnabled with controller: ${this.emeController&&this.config.emeEnabled})`);return Promise.reject(this.createKeyLoadError(e,Ue.KEY_LOAD_ERROR,n))}const s=r.uri;if(!s)return Promise.reject(this.createKeyLoadError(e,Ue.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${s}"`)));const a=yc(r);let o=this.keyIdToKeyInfo[a];if(null!=(n=o)&&n.decryptdata.key)return r.key=o.decryptdata.key,Promise.resolve({frag:e,keyInfo:o});if(this.emeController&&null!=(i=o)&&i.keyLoadPromise)switch(this.emeController.getKeyStatus(o.decryptdata)){case"usable":case"usable-in-future":return o.keyLoadPromise.then(t=>{const{keyInfo:n}=t;return r.key=n.decryptdata.key,{frag:e,keyInfo:n}})}switch(this.log(`${this.keyIdToKeyInfo[a]?"Rel":"L"}oading${r.keyId?" keyId: "+ut(r.keyId):""} URI: ${r.uri} from ${e.type} ${e.level}`),o=this.keyIdToKeyInfo[a]={decryptdata:r,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},r.method){case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return"identity"===r.keyFormat?this.loadKeyHTTP(o,e):this.loadKeyEME(o,e);case"AES-128":case"AES-256":case"AES-256-CTR":return this.loadKeyHTTP(o,e);default:return Promise.reject(this.createKeyLoadError(e,Ue.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${r.method}"`)))}}loadKeyEME(e,t){const n={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){const i=this.emeController.loadKey(n);return(e.keyLoadPromise=i.then(t=>(e.mediaKeySessionContext=t,n))).catch(n=>{throw e.keyLoadPromise=null,"data"in n&&(n.data.frag=t),n})}return Promise.resolve(n)}loadKeyHTTP(e,t){const n=this.config,i=new(0,n.loader)(n);return t.keyLoader=e.loader=i,e.keyLoadPromise=new Promise((r,s)=>{const a={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},o=n.keyLoadPolicy.default,l={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},c={onSuccess:(e,t,n,i)=>{const{frag:a,keyInfo:o}=n,l=yc(o.decryptdata);if(!a.decryptdata||o!==this.keyIdToKeyInfo[l])return s(this.createKeyLoadError(a,Ue.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),i));o.decryptdata.key=a.decryptdata.key=new Uint8Array(e.data),a.keyLoader=null,o.loader=null,r({frag:a,keyInfo:o})},onError:(e,n,i,r)=>{this.resetLoader(n),s(this.createKeyLoadError(t,Ue.KEY_LOAD_ERROR,new Error(`HTTP Error ${e.code} loading key ${e.text}`),i,Je({url:a.url,data:void 0},e)))},onTimeout:(e,n,i)=>{this.resetLoader(n),s(this.createKeyLoadError(t,Ue.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),i))},onAbort:(e,n,i)=>{this.resetLoader(n),s(this.createKeyLoadError(t,Ue.INTERNAL_ABORTED,new Error("key loading aborted"),i))}};i.load(a,l,c)})}resetLoader(e){const{frag:t,keyInfo:n,url:i}=e,r=n.loader;t.keyLoader===r&&(t.keyLoader=null,n.loader=null);const s=yc(n.decryptdata)||i;delete this.keyIdToKeyInfo[s],r&&r.destroy()}}function yc(e){if(e.keyFormat!==zi){const t=e.keyId;if(t)return ut(t)}return e.uri}function bc(e){const{type:t}=e;switch(t){case Ge:return He;case Ve:return We;default:return qe}}function Ec(e,t){let n=e.url;return void 0!==n&&0!==n.indexOf("data:")||(n=t.url),n}class Sc{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.onManifestLoaded=this.checkAutostartLoad,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on($e.MANIFEST_LOADING,this.onManifestLoading,this),e.on($e.LEVEL_LOADING,this.onLevelLoading,this),e.on($e.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on($e.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.on($e.LEVELS_UPDATED,this.onLevelsUpdated,this)}unregisterListeners(){const{hls:e}=this;e.off($e.MANIFEST_LOADING,this.onManifestLoading,this),e.off($e.LEVEL_LOADING,this.onLevelLoading,this),e.off($e.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off($e.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.off($e.LEVELS_UPDATED,this.onLevelsUpdated,this)}createInternalLoader(e){const t=this.hls.config,n=t.pLoader,i=t.loader,r=new(n||i)(t);return this.loaders[e.type]=r,r}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:n}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:je,url:n,deliveryDirectives:null,levelOrTrack:null})}onLevelLoading(e,t){const{id:n,level:i,pathwayId:r,url:s,deliveryDirectives:a,levelInfo:o}=t;this.load({id:n,level:i,pathwayId:r,responseType:"text",type:ze,url:s,deliveryDirectives:a,levelOrTrack:o})}onAudioTrackLoading(e,t){const{id:n,groupId:i,url:r,deliveryDirectives:s,track:a}=t;this.load({id:n,groupId:i,level:null,responseType:"text",type:Ge,url:r,deliveryDirectives:s,levelOrTrack:a})}onSubtitleTrackLoading(e,t){const{id:n,groupId:i,url:r,deliveryDirectives:s,track:a}=t;this.load({id:n,groupId:i,level:null,responseType:"text",type:Ve,url:r,deliveryDirectives:s,levelOrTrack:a})}onLevelsUpdated(e,t){const n=this.loaders[ze];if(n){const e=n.context;e&&!t.levels.some(t=>t===e.levelOrTrack)&&(n.abort(),delete this.loaders[ze])}}load(e){var t;const n=this.hls.config;let i,r=this.getInternalLoader(e);if(r){const t=this.hls.logger,n=r.context;if(n&&n.levelOrTrack===e.levelOrTrack&&(n.url===e.url||n.deliveryDirectives&&!e.deliveryDirectives))return void(n.url===e.url?t.log(`[playlist-loader]: ignore ${e.url} ongoing request`):t.log(`[playlist-loader]: ignore ${e.url} in favor of ${n.url}`));t.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),r.abort()}if(i=e.type===je?n.manifestLoadPolicy.default:Qe({},n.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),r=this.createInternalLoader(e),Ne(null==(t=e.deliveryDirectives)?void 0:t.part)){let t;if(e.type===ze&&null!==e.level?t=this.hls.levels[e.level].details:e.type===Ge&&null!==e.id?t=this.hls.audioTracks[e.id].details:e.type===Ve&&null!==e.id&&(t=this.hls.subtitleTracks[e.id].details),t){const e=t.partTarget,n=t.targetduration;if(e&&n){const t=1e3*Math.max(3*e,.8*n);i=Qe({},i,{maxTimeToFirstByteMs:Math.min(t,i.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(t,i.maxTimeToFirstByteMs)})}}}const s=i.errorRetry||i.timeoutRetry||{},a={loadPolicy:i,timeout:i.maxLoadTimeMs,maxRetry:s.maxNumRetry||0,retryDelay:s.retryDelayMs||0,maxRetryDelay:s.maxRetryDelayMs||0},o={onSuccess:(e,t,n,i)=>{const r=this.getInternalLoader(n);this.resetInternalLoader(n.type);const s=e.data;t.parsing.start=performance.now(),ir.isMediaPlaylist(s)||n.type!==je?this.handleTrackOrLevelPlaylist(e,t,n,i||null,r):this.handleMasterPlaylist(e,t,n,i)},onError:(e,t,n,i)=>{this.handleNetworkError(t,n,!1,e,i)},onTimeout:(e,t,n)=>{this.handleNetworkError(t,n,!0,void 0,e)}};r.load(e,a,o)}checkAutostartLoad(){if(!this.hls)return;const{config:{autoStartLoad:e,startPosition:t},forceStartLoad:n}=this.hls;(e||n)&&(this.hls.logger.log(`${e?"auto":"force"} startLoad with configured startPosition ${t}`),this.hls.startLoad(t))}handleMasterPlaylist(e,t,n,i){const r=this.hls,s=e.data,a=Ec(e,n),o=ir.parseMasterPlaylist(s,a);if(o.playlistParsingError)return t.parsing.end=performance.now(),void this.handleManifestParsingError(e,n,o.playlistParsingError,i,t);const{contentSteering:l,levels:c,sessionData:u,sessionKeys:h,startTimeOffset:d,variableList:f}=o;this.variableList=f,c.forEach(e=>{const{unknownCodecs:t}=e;if(t){const{preferManagedMediaSource:n}=this.hls.config;let{audioCodec:i,videoCodec:r}=e;for(let s=t.length;s--;){const a=t[s];rn(a,"audio",n)?(e.audioCodec=i=i?`${i},${a}`:a,tn.audio[i.substring(0,4)]=2,t.splice(s,1)):rn(a,"video",n)&&(e.videoCodec=r=r?`${r},${a}`:a,tn.video[r.substring(0,4)]=2,t.splice(s,1))}}});const{AUDIO:p=[],SUBTITLES:g,"CLOSED-CAPTIONS":m}=ir.parseMasterPlaylistMedia(s,a,o);p.length&&(p.some(e=>!e.url)||!c[0].audioCodec||c[0].attrs.AUDIO||(this.hls.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),p.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new Li({}),bitrate:0,url:""}))),r.trigger($e.MANIFEST_LOADED,{levels:c,audioTracks:p,subtitles:g,captions:m,contentSteering:l,url:a,stats:t,networkDetails:i,sessionData:u,sessionKeys:h,startTimeOffset:d,variableList:f})}handleTrackOrLevelPlaylist(e,t,n,i,r){const s=this.hls,{id:a,level:o,type:l}=n,c=Ec(e,n),u=Ne(o)?o:Ne(a)?a:0,h=bc(n),d=ir.parseLevelPlaylist(e.data,c,u,h,0,this.variableList);if(l===je){const e={attrs:new Li({}),bitrate:0,details:d,name:"",url:c};d.requestScheduled=t.loading.start+Er(d,0),s.trigger($e.MANIFEST_LOADED,{levels:[e],audioTracks:[],url:c,stats:t,networkDetails:i,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),n.levelDetails=d,this.handlePlaylistLoaded(d,e,t,n,i,r)}handleManifestParsingError(e,t,n,i,r){this.hls.trigger($e.ERROR,{type:Be.NETWORK_ERROR,details:Ue.MANIFEST_PARSING_ERROR,fatal:t.type===je,url:e.url,err:n,error:n,reason:n.message,response:e,context:t,networkDetails:i,stats:r})}handleNetworkError(e,t,n=!1,i,r){let s=`A network ${n?"timeout":"error"+(i?" (status "+i.code+")":"")} occurred while loading ${e.type}`;e.type===ze?s+=`: ${e.level} id: ${e.id}`:e.type!==Ge&&e.type!==Ve||(s+=` id: ${e.id} group-id: "${e.groupId}"`);const a=new Error(s);this.hls.logger.warn(`[playlist-loader]: ${s}`);let o=Ue.UNKNOWN,l=!1;const c=this.getInternalLoader(e);switch(e.type){case je:o=n?Ue.MANIFEST_LOAD_TIMEOUT:Ue.MANIFEST_LOAD_ERROR,l=!0;break;case ze:o=n?Ue.LEVEL_LOAD_TIMEOUT:Ue.LEVEL_LOAD_ERROR,l=!1;break;case Ge:o=n?Ue.AUDIO_TRACK_LOAD_TIMEOUT:Ue.AUDIO_TRACK_LOAD_ERROR,l=!1;break;case Ve:o=n?Ue.SUBTITLE_TRACK_LOAD_TIMEOUT:Ue.SUBTITLE_LOAD_ERROR,l=!1}c&&this.resetInternalLoader(e.type);const u={type:Be.NETWORK_ERROR,details:o,fatal:l,url:e.url,loader:c,context:e,error:a,networkDetails:t,stats:r};if(i){const n=(null==t?void 0:t.url)||e.url;u.response=Je({url:n,data:void 0},i)}this.hls.trigger($e.ERROR,u)}handlePlaylistLoaded(e,t,n,i,r,s){const a=this.hls,{type:o,level:l,levelOrTrack:c,id:u,groupId:h,deliveryDirectives:d}=i,f=Ec(t,i),p=bc(i);let g="number"==typeof i.level&&p===qe?l:void 0;const m=e.playlistParsingError;if(m){if(this.hls.logger.warn(`${m} ${e.url}`),!a.config.ignorePlaylistParsingErrors)return void a.trigger($e.ERROR,{type:Be.NETWORK_ERROR,details:Ue.LEVEL_PARSING_ERROR,fatal:!1,url:f,error:m,reason:m.message,response:t,context:i,level:g,parent:p,networkDetails:r,stats:n});e.playlistParsingError=null}if(!e.fragments.length){const s=e.playlistParsingError=new Error("No Segments found in Playlist");return void a.trigger($e.ERROR,{type:Be.NETWORK_ERROR,details:Ue.LEVEL_EMPTY_ERROR,fatal:!1,url:f,error:s,reason:s.message,response:t,context:i,level:g,parent:p,networkDetails:r,stats:n})}switch(e.live&&s&&(s.getCacheAge&&(e.ageHeader=s.getCacheAge()||0),s.getCacheAge&&!isNaN(e.ageHeader)||(e.ageHeader=0)),o){case je:case ze:if(g)if(c){if(c!==a.levels[g]){const e=a.levels.indexOf(c);e>-1&&(g=e)}}else g=0;a.trigger($e.LEVEL_LOADED,{details:e,levelInfo:c||a.levels[0],level:g||0,id:u||0,stats:n,networkDetails:r,deliveryDirectives:d,withoutMultiVariant:o===je});break;case Ge:a.trigger($e.AUDIO_TRACK_LOADED,{details:e,track:c,id:u||0,groupId:h||"",stats:n,networkDetails:r,deliveryDirectives:d});break;case Ve:a.trigger($e.SUBTITLE_TRACK_LOADED,{details:e,track:c,id:u||0,groupId:h||"",stats:n,networkDetails:r,deliveryDirectives:d})}}}class wc{static get version(){return Jr}static isMSESupported(){return gc()}static isSupported(){return function(){if(!gc())return!1;const e=ot();return"function"==typeof(null==e?void 0:e.isTypeSupported)&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(t=>e.isTypeSupported(an(t,"video")))||["mp4a.40.2","fLaC"].some(t=>e.isTypeSupported(an(t,"audio"))))}()}static getMediaSource(){return ot()}static get Events(){return $e}static get MetadataSchema(){return Ss}static get ErrorTypes(){return Be}static get ErrorDetails(){return Ue}static get DefaultConfig(){return wc.defaultConfig?wc.defaultConfig:tc}static set DefaultConfig(e){wc.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.logger=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new Zr,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioStreamController=void 0,this.subtititleStreamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.interstitialsController=void 0,this.gapController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this._url=null,this._sessionId=void 0,this.triggeringException=void 0,this.started=!1;const t=this.logger=function(e,t,n){const i=it();if("object"==typeof console&&!0===e||"object"==typeof e){const t=["debug","log","info","warn","error"];t.forEach(t=>{i[t]=rt(t,e,n)});try{i.log('Debug logs enabled for "Hls instance" in hls.js version 1.6.12')}catch(e){return it()}t.forEach(t=>{st[t]=rt(t,e)})}else Qe(st,i);return i}(e.debug||!1,0,e.assetPlayerId),n=this.config=function(e,t,n){if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(void 0!==t.liveMaxLatencyDurationCount&&(void 0===t.liveSyncDurationCount||t.liveMaxLatencyDurationCount<=t.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(void 0!==t.liveMaxLatencyDuration&&(void 0===t.liveSyncDuration||t.liveMaxLatencyDuration<=t.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const i=nc(e),r=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return["manifest","level","frag"].forEach(e=>{const s=`${"level"===e?"playlist":e}LoadPolicy`,a=void 0===t[s],o=[];r.forEach(n=>{const r=`${e}Loading${n}`,l=t[r];if(void 0!==l&&a){o.push(r);const e=i[s].default;switch(t[s]={default:e},n){case"TimeOut":e.maxLoadTimeMs=l,e.maxTimeToFirstByteMs=l;break;case"MaxRetry":e.errorRetry.maxNumRetry=l,e.timeoutRetry.maxNumRetry=l;break;case"RetryDelay":e.errorRetry.retryDelayMs=l,e.timeoutRetry.retryDelayMs=l;break;case"MaxRetryTimeout":e.errorRetry.maxRetryDelayMs=l,e.timeoutRetry.maxRetryDelayMs=l}}}),o.length&&n.warn(`hls.js config: "${o.join('", "')}" setting(s) are deprecated, use "${s}": ${In(t[s])}`)}),Je(Je({},i),t)}(wc.DefaultConfig,e,t);this.userConfig=e,n.progressive&&function(e,t){const n=e.loader;n!==Xl&&n!==ec?(t.log("[config]: Custom loader detected, cannot enable progressive streaming"),e.progressive=!1):function(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(e){}return!1}()&&(e.loader=Xl,e.progressive=!0,e.enableSoftwareAES=!0,t.log("[config]: Progressive streaming enabled, using FetchLoader"))}(n,t);const{abrController:i,bufferController:r,capLevelController:s,errorController:a,fpsController:o}=n,l=new a(this),c=this.abrController=new i(this),u=new ii(this),h=n.interstitialsController,d=h?this.interstitialsController=new h(this,wc):null,f=this.bufferController=new r(this,u),p=this.capLevelController=new s(this),g=new o(this),m=new Sc(this),v=n.contentSteeringController,y=v?new v(this):null,b=this.levelController=new dc(this,y),E=new uc(this),S=new vc(this.config,this.logger),w=this.streamController=new mc(this,u,S),T=this.gapController=new ic(this,u);p.setStreamController(w),g.setStreamController(w);const k=[m,b,w];d&&k.splice(1,0,d),y&&k.splice(1,0,y),this.networkControllers=k;const _=[c,f,T,p,g,E,u];this.audioTrackController=this.createController(n.audioTrackController,k);const x=n.audioStreamController;x&&k.push(this.audioStreamController=new x(this,u,S)),this.subtitleTrackController=this.createController(n.subtitleTrackController,k);const L=n.subtitleStreamController;L&&k.push(this.subtititleStreamController=new L(this,u,S)),this.createController(n.timelineController,_),S.emeController=this.emeController=this.createController(n.emeController,_),this.cmcdController=this.createController(n.cmcdController,_),this.latencyController=this.createController(hc,_),this.coreComponents=_,k.push(l);const A=l.onErrorOut;"function"==typeof A&&this.on($e.ERROR,A,l),this.on($e.MANIFEST_LOADED,m.onManifestLoaded,m)}createController(e,t){if(e){const n=new e(this);return t&&t.push(n),n}return null}on(e,t,n=this){this._emitter.on(e,t,n)}once(e,t,n=this){this._emitter.once(e,t,n)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,n=this,i){this._emitter.off(e,t,n,i)}listeners(e){return this._emitter.listeners(e)}emit(e,t,n){return this._emitter.emit(e,t,n)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(t){if(this.logger.error("An internal error happened while handling event "+e+'. Error message: "'+t.message+'". Here is a stacktrace:',t),!this.triggeringException){this.triggeringException=!0;const n=e===$e.ERROR;this.trigger($e.ERROR,{type:Be.OTHER_ERROR,details:Ue.INTERNAL_EXCEPTION,fatal:n,event:e,error:t}),this.triggeringException=!1}}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){this.logger.log("destroy"),this.trigger($e.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this._url=null,this.networkControllers.forEach(e=>e.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(e=>e.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){if(!e||"media"in e&&!e.media){const t=new Error(`attachMedia failed: invalid argument (${e})`);return void this.trigger($e.ERROR,{type:Be.OTHER_ERROR,details:Ue.ATTACH_MEDIA_ERROR,fatal:!0,error:t})}this.logger.log("attachMedia"),this._media&&(this.logger.warn("media must be detached before attaching"),this.detachMedia());const t="media"in e,n=t?e.media:e,i=t?e:{media:n};this._media=n,this.trigger($e.MEDIA_ATTACHING,i)}detachMedia(){this.logger.log("detachMedia"),this.trigger($e.MEDIA_DETACHING,{}),this._media=null}transferMedia(){this._media=null;const e=this.bufferController.transferMedia();return this.trigger($e.MEDIA_DETACHING,{transferMedia:e}),e}loadSource(e){this.stopLoad();const t=this.media,n=this._url,i=this._url=Et.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.logger.log(`loadSource:${i}`),t&&n&&(n!==i||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger($e.MANIFEST_LOADING,{url:e})}get url(){return this._url}get hasEnoughToStart(){return this.streamController.hasEnoughToStart}get startPosition(){return this.streamController.startPositionValue}startLoad(e=-1,t){this.logger.log(`startLoad(${e+(t?", <skip seek to start>":"")})`),this.started=!0,this.resumeBuffering();for(let n=0;n<this.networkControllers.length&&(this.networkControllers[n].startLoad(e,t),this.started&&this.networkControllers);n++);}stopLoad(){this.logger.log("stopLoad"),this.started=!1;for(let e=0;e<this.networkControllers.length&&(this.networkControllers[e].stopLoad(),!this.started&&this.networkControllers);e++);}get loadingEnabled(){return this.started}get bufferingEnabled(){return this.streamController.bufferingEnabled}resumeBuffering(){this.bufferingEnabled||(this.logger.log("resume buffering"),this.networkControllers.forEach(e=>{e.resumeBuffering&&e.resumeBuffering()}))}pauseBuffering(){this.bufferingEnabled&&(this.logger.log("pause buffering"),this.networkControllers.forEach(e=>{e.pauseBuffering&&e.pauseBuffering()}))}get inFlightFragments(){const e={[qe]:this.streamController.inFlightFrag};return this.audioStreamController&&(e[He]=this.audioStreamController.inFlightFrag),this.subtititleStreamController&&(e[We]=this.subtititleStreamController.inFlightFrag),e}swapAudioCodec(){this.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){this.logger.log("recoverMediaError");const e=this._media,t=null==e?void 0:e.currentTime;this.detachMedia(),e&&(this.attachMedia(e),t&&this.startLoad(t))}removeLevel(e){this.levelController.removeLevel(e)}get sessionId(){let e=this._sessionId;return e||(e=this._sessionId=function(){try{return crypto.randomUUID()}catch(e){try{const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}catch(e){let t=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?n:3&n|8).toString(16)})}}}()),e}get levels(){return this.levelController.levels||[]}get latestLevelDetails(){return this.streamController.getLevelDetails()||null}get loadLevelObj(){return this.levelController.loadLevelObj}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){this.logger.log(`set currentLevel:${e}`),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){this.logger.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){this.logger.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){this.logger.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){const e=this.levelController.startLevel;return-1===e&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e}set startLevel(e){this.logger.log(`set startLevel:${e}`),-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}set bandwidthEstimate(e){this.abrController.resetEstimator(e)}get abrEwmaDefaultEstimate(){const{bwEstimator:e}=this.abrController;return e?e.defaultEstimate:NaN}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(this.logger.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){(function(e){return kn.indexOf(e)>-1})(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return-1===this.levelController.manualLevel}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const n=e.length;for(let i=0;i<n;i++)if(e[i].maxBitrate>=t)return i;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:n}=this;let i;if(i=-1===t&&null!=e&&e.length?e.length-1:t,n)for(let t=i;t--;){const i=e[t].attrs["HDCP-LEVEL"];if(i&&i<=n)return t}return i}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(e){this.abrController.nextAutoLevel=e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get maxBufferLength(){return this.streamController.maxBufferLength}setAudioOption(e){var t;return(null==(t=this.audioTrackController)?void 0:t.setAudioOption(e))||null}setSubtitleOption(e){var t;return(null==(t=this.subtitleTrackController)?void 0:t.setSubtitleOption(e))||null}get allAudioTracks(){const e=this.audioTrackController;return e?e.allAudioTracks:[]}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get allSubtitleTracks(){const e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return!!e&&e.subtitleDisplay}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}set targetLatency(e){this.latencyController.targetLatency=e}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}get pathways(){return this.levelController.pathways}get pathwayPriority(){return this.levelController.pathwayPriority}set pathwayPriority(e){this.levelController.pathwayPriority=e}get bufferedToEnd(){var e;return!(null==(e=this.bufferController)||!e.bufferedToEnd)}get interstitialsManager(){var e;return(null==(e=this.interstitialsController)?void 0:e.interstitialsManager)||null}getMediaDecodingInfo(e,t=this.allAudioTracks){return Sn(e,Dn(t),navigator.mediaCapabilities)}}wc.defaultConfig=void 0;const Tc=n=>{const{source:i}=n;return(0,t.useEffect)(()=>{const e=document.getElementById("video"),t=i;if(wc.isSupported()){const n=new wc;n.loadSource(t),n.attachMedia(e),n.on(wc.Events.MANIFEST_PARSED,function(){})}else e.canPlayType("application/vnd.apple.mpegurl")&&(e.src=t,e.addEventListener("loadedmetadata",function(){}))}),(0,e.jsx)(e.Fragment,{children:(0,e.jsx)("video",{controls:!0,autoPlay:!1,style:{width:"100%"},id:"video"})})},kc=[{title:"视频",path:"video"},{title:"电子书",path:"ebook"},{title:"音乐",path:"music"},{title:"图片",path:"picture"},{title:"文章",path:"article"},{title:"RSS",path:"rss"},{title:"游戏",path:"game"}],_c=[{name:"情书 Love Letter",source:"https://s1.zoubuting.com/20220622/Xl2b7haF/hls/index.m3u8",cover:"/covers/情书.webp",score:"89",details:{alias:"When I Close My Eyes / Letters of Love",directors:["岩井俊二"],scriptwriter:"岩井俊二",actors:"中山美穗 / 丰川悦司 / 酒井美纪 / 柏原崇 / 范文雀 / 篠原胜之 / 铃木庆一 / 田口智朗 / 加贺麻理子 / 光石研 / 铃木兰兰 / 盐见三省 / 中村久美 / 梅田凡乃 / 长田江身子 / 小栗香织 / 神户浩 / 酒井敏也 / 山口诗史 / 山崎一 / 德井优 / 武藤寿美",types:"剧情 / 爱情",region:"日本",language:"日语",date:"1999-03(中国大陆) / 2021-05-20(中国大陆重映) / 1995-03-25(日本)",duration:"117分钟",IMDB:"tt0113703",intro:"日本神户某个飘雪的冬日，渡边博子（中山美穗）在前未婚夫藤井树的两周年祭日上又一次悲痛到不能自已。正因为无法抑制住对已逝恋人的思念，渡边博子在其中学同学录里发现“藤井树” 在小樽市读书时的地址时，依循着寄发了一封本以为是发往天国的情书。不想不久渡边博子竟然收到署名为“藤井树（酒井美纪）”的回信，经过进一步了解，她知晓此藤井树是一个同她年纪相仿的女孩，且还是男友藤井树（柏原崇）少年时代的同班同学。为了多了解一些昔日恋人在中学时代的情况，渡边博子开始与女性藤井树书信往来。而藤井树在不断的回忆中，渐渐发现少年时代与她同名同姓的那个藤井树曾对自己藏了一腔柔情。"}},{name:"白日梦想家",source:"https://v4.cdtlas.com/20220531/pm3QPmvK/1000kb/hls/index.m3u8",cover:"/covers/白日梦想家.jpeg",score:"86",details:{alias:"发梦王大历险(港) / 白日梦冒险王(台) / 奇幻冒险家 / 梦里乾坤 / 沃尔特·米蒂的秘密生活 / 白日密语",directors:["本·斯蒂勒"],scriptwriter:"斯蒂夫·康拉德 / 詹姆斯·瑟伯",actors:"本·斯蒂勒 / 克里斯汀·韦格 / 亚当·斯科特 / 西恩·潘 / 凯瑟琳·哈恩 / 泰伦斯·伯尼·海恩斯 / 保罗·菲兹杰拉德 / 乔恩·戴利 / 乔伊·斯洛特尼克 / 格蕾丝·雷克斯 / 阿莱克斯·阿方格 / 阿曼达·诺顿 / 阿德里安·马丁斯 / 雪莉·麦克雷恩 / 艾米·斯蒂勒 / 斯图尔特·康菲尔德 / 奥拉维尔·达里·奥拉夫松 / 索哈德吕尔·西格罗森 / 贡纳·黑尔加松 / 卡伊·伦诺克斯 / 柯南·奥布莱恩 / 安迪·里克特 / 安东尼·德西奥 / 帕顿·奥斯瓦尔特 / 理查德·德多梅尼科 / 马特·莱文 / 格雷格·西佩斯 / 马米·科西科 / 马修·古利 / 罗丝玛丽·霍华德 / 伊兰·克里斯费尔德 / 安娜·库奇马",types:"剧情 / 喜剧 / 冒险",region:"美国 / 英国",language:"英语 / 西班牙语 / 冰岛语",date:"2013-12-25(美国)",duration:"114分钟",IMDB:"tt0359950",intro:"沃特.密提（本·斯蒂勒 Ben Stiller 饰）是一名在《生活》杂志工作了16年的胶片洗印经理，他性格内向，甚至无法跟心仪的同事谢莉尔（克里斯汀·韦格 Kristen Wiig 饰）开口搭讪，面对生活他像个旁观者，时常“放空”做白日英雄梦。直到有一天公司被并购，杂志需要做最后一期的封面，而封面成功与否的关键是找到狂野摄影师尚恩（西恩·潘 Sean Penn）的一卷胶片，沃特终于开口搭讪谢莉尔，并在她和母亲（雪莉·麦克雷恩 Shirley MacLaine 饰）的鼓励下踏上真正的冒险之旅，冰原、大海、喜马拉雅山……沃特的白日梦远不及现实壮丽。"}},{name:"让子弹飞",source:"https://vip.lzcdn2.com/20220318/12_2644b2e0/index.m3u8",cover:"/covers/让子弹飞.jpeg",score:"90",details:{alias:"让子弹飞一会儿 / 火烧云 / Let The Bullets Fly",directors:["姜文"],scriptwriter:"朱苏进 / 述平 / 姜文 / 郭俊立 / 危笑 / 李不空 / 马识途",actors:"姜文 / 葛优 / 周润发 / 刘嘉玲 / 陈坤 / 张默 / 姜武 / 周韵 / 廖凡 / 姚橹 / 邵兵 / 苗圃 / 冯小刚 / 胡军 / 马珂 / 白冰 / 杜奕衡 / 李静 / 胡明 / 危笑 / 杨奇雨 / 赵铭",types:"剧情 / 喜剧 / 动作 / 西部",region:"中国大陆 / 中国香港",language:"汉语普通话 / 四川话 / 山西话",date:"2010-12-16(中国大陆)",duration:"132分钟",IMDB:"tt1533117",intro:"民国年间，花钱捐得县长的马邦德（葛优 饰）携妻（刘嘉玲 饰）及随从走马上任。途经南国某地，遭劫匪张麻子（姜文 饰）一伙伏击，随从尽死，只夫妻二人侥幸活命。马为保命，谎称自己是县长的汤 师爷。为汤师爷许下的财富所动，张麻子摇身一变化身县长，带着手下赶赴鹅城上任。有道是天高皇帝远，鹅城地处偏僻，一方霸主黄四郎（周润发 饰）只手遮天，全然不将这个新来的县长放在眼里。张麻子痛打了黄的武教头（姜武 饰），黄则设计害死张的义子小六（张默 饰）。原本只想赚钱的马邦德，怎么也想不到竟会被卷入这场土匪和恶霸的角力之中。鹅城上空愁云密布，血雨腥风在所难免……本片根据马识途的小说《夜谭十记》中的《盗官记》一章改编。"}},{name:"一九四二",source:"https://cdn.zoubuting.com/20221130/3IIvCUnL/1000kb/hls/index.m3u8",cover:"/covers/1942.jpeg",score:"81",details:{alias:["温故1942","1942","温故一九四二","Back to 1942"],directors:["冯小刚"],scriptwriter:["刘震云"],actors:["张国立","张默","徐帆","李雪健","陈道明","艾德里安·布洛迪","蒂姆·罗宾斯","冯远征","张涵予","王子文","段奕宏","范伟","柯蓝","张国强","林永健","乔振宇","李倩","赵毅"],types:["剧情","历史","战争","灾难"],region:"中国大陆",language:["河南方言","英语","日语","汉语普通话"],date:"2012-11-29",duration:"146分钟",IMDB:"tt2113822",intro:"1942年，抗日战争与第二次世界大战正处于白热化阶段。燎原之火，生灵涂炭，天灾人祸，哀鸿遍野。当军事家和政治家的目光聚焦在一城一郭的征伐劫掠之时，几乎鲜少有人注意到古老的中原河南正爆发一场惨绝人寰的大旱灾。影片的主角老东家（张国立 饰），狡猾、市侩，典型的封建地主，可即便如此也无法对抗这史无前例的灾难，他被迫逃荒，亲眼见证着儿子、儿媳、老伴等亲人的种种死状。他的遭遇是三百万灾民的缩影，面对这群人的苦难，无论是高高在上的蒋委员长（陈道明 饰），还是深入民间报道灾难真相的美国记者白修德（阿德里安•布劳迪 Adrien Brody 饰），以及海内外的每一个人，如何能从这眼前的人间炼狱之景侧目。绝望无止的逃生坎途，中华民族多舛命运的苦难一斑……本片根据刘震云的小说《温故一九四二》改编。"}},{name:"活着",source:"https://vip.lzcdn2.com/20220407/2614_9730c040/1200k/hls/mixed.m3u8",cover:"/covers/活着.jpeg",score:"93",details:{alias:["人生","Lifetimes","To Live"],directors:["张艺谋"],scriptwriter:["芦苇","余华"],actors:["葛优","巩俐","姜武","牛犇","郭涛","张璐","倪大红","肖聪","董飞","刘天池","董立范","黄宗洛","刘燕瑾","李连义","杨同顺"],types:["剧情","家庭","历史"],region:"中国大陆 / 中国香港",language:["汉语普通话"],date:"1994-06-30",duration:"132分钟",IMDB:"tt0110081",intro:"根据余华同名小说改编。富少福贵（葛优）嗜赌成性，妻子家珍（巩俐）屡劝无果后带着女儿凤霞离开了他，当夜，福贵输光所有家产气死父亲，被迫靠变卖母亲首饰租间破屋过活。一年后，家珍手拉凤霞怀抱刚出世的儿子有庆回到家中，福贵痛改前非，开始靠演皮影戏过起安份守己的日子。但好景不常，内战时期，福贵被国民党抓去当劳工，一番辗转终回到家乡与一家人团圆后，凤霞因病变成哑巴，而在后来的大跃进运动和文化大革命中，他虽获某些小福，逆境却也一直与他如影相随。"}},{name:"盗梦空间",source:"https://vip.lzcdn2.com/20220318/5_1dddc8ed/1200k/hls/mixed.m3u8",cover:"/covers/盗梦空间.jpeg",score:"94",details:{alias:["潜行凶间(港)","全面启动(台)","奠基","心灵犯案","记忆迷阵","记忆魔方"],directors:["克里斯托弗·诺兰"],scriptwriter:["克里斯托弗·诺兰"],actors:["莱昂纳多·迪卡普里奥","约瑟夫·高登-莱维特","艾利奥特·佩吉","汤姆·哈迪","渡边谦","迪利普·劳","基里安·墨菲","汤姆·贝伦杰","玛丽昂·歌迪亚","皮特·波斯尔思韦特","迈克尔·凯恩","卢卡斯·哈斯","李太力","克莱尔·吉尔蕾","马格努斯·诺兰","泰勒·吉蕾","乔纳森·吉尔","水源士郎","冈本玉二","厄尔·卡梅伦","瑞恩·海沃德","米兰达·诺兰","拉什·费加","蒂姆·科勒赫","妲露拉·莱莉"],types:["剧情","科幻","悬疑","冒险"],region:"美国 / 英国",language:["英语","日语","法语"],date:"2010-09-01",duration:"148分钟",IMDB:"tt1375666",intro:"道姆·柯布（莱昂纳多·迪卡普里奥 Leonardo DiCaprio 饰）与同事阿瑟（约瑟夫·戈登-莱维特 Joseph Gordon-Levitt 饰）和纳什（卢卡斯·哈斯 Lukas Haas 饰）在一次针对日本能源大亨齐藤（渡边谦 饰）的盗梦行动中失败，反被齐藤利用。齐藤威逼利诱因遭通缉而流亡海外的柯布帮他拆分他竞争对手的公司，采取极端措施在其唯一继承人罗伯特·费希尔（希里安·墨菲 Cillian Murphy 饰）的深层潜意识中种下放弃家族公司、自立门户的想法。为了重返美国，柯布偷偷求助于岳父迈尔斯（迈克尔·凯恩 Michael Caine 饰），吸收了年轻的梦境设计师艾里阿德妮（艾伦·佩吉 Ellen Page 饰）、梦境演员艾姆斯（汤姆·哈迪 Tom Hardy 饰）和药剂师约瑟夫（迪利普·劳 Dileep Rao 饰）加入行动。在一层层递进的梦境中，柯布不仅要对付费希尔潜意识的本能反抗，还必须直面已逝妻子梅尔（玛丽昂·歌迪亚 Marion Cotillard 饰）的处处破坏，实际情况远比预想危险得多……"}},{name:"城南旧事",source:"https://vip.lz-cdn10.com/20220902/2376_c532cfb6/1200k/hls/mixed.m3u8",cover:"/covers/城南旧事.jpeg",score:"91",details:{alias:["My Memories of Old Beijing","South of the old"],directors:["吴贻弓"],scriptwriter:["伊明","林海音"],actors:["沈洁","张丰毅","张闽","郑振瑶","严翔"],types:["剧情"],region:"中国大陆",language:["汉语普通话"],date:"1983",duration:"88分钟",IMDB:"tt0085326",intro:"本片根据林海音的同名短篇小说改编。小女孩林英子（沈洁 饰）住在五十年前的北京南城，在他们家院子附近住着一个疯女人秀珍（张闽 饰），秀珍的丈夫因参与学生运动被杀，孩子也不知所踪，因此落下了疯病，时常把英子当做自己的孩子“小桂子”看待，英子也喜欢秀珍，答应帮她找回小桂子。英子有个苦命的小伙伴妞儿，学戏时常遭干爹打骂，英子偶然发现妞儿有小桂子的胎记，帮助她们母女相认。英子上小学后，一家人搬到了厂甸。在家门口荒废的院落里，英子发现了一个小偷（张丰毅 饰）藏赃的草堆，小偷为了供弟弟读书只得干不光彩的勾当，英子却不把他看作是坏人。不久，女佣苏妈返乡，父亲去世，英子的童年，彷佛一下结束了……"}},{name:"天空之城",source:"https://vip.lzcdn2.com/20220323/322_d924eacf/1200k/hls/mixed.m3u8",cover:"/covers/天空之城.jpeg",score:"92",details:{alias:["天空之城拉普他","空中城堡拉普他","Tenkû no shiro Rapyuta","Laputa: Castle in the Sky"],directors:["宫崎骏"],scriptwriter:["宫崎骏"],actors:["田中真弓","横泽启子","初井言荣","寺田农","常田富士男","永井一郎","糸博","鹫尾真知子","神山卓三","安原义人","槐柳二","鳕子"],types:["动画","奇幻","冒险"],region:"日本",language:["日语"],date:"1992-05-01",duration:"125分钟",IMDB:"tt0092067",intro:"古老帝国拉比达是一座漂浮在空中的巨大的机器岛，传说那里已经无人居住，蕴藏着巨大的财富。因此，无论军方还是海盗，都在找寻着这座传说中的飞行岛。矿工帕克这天偶遇拉比达继承人希达，两人一见如故。因为希达身上有找寻拉比达帝国的重要物件飞行石，军方和海盗两帮人马都在追杀希达。帕克带着希达一起逃亡，最终都没有逃出军方的手中，希达被军队掳走了。为救朋友，帕克只能选择与海盗合作。帕克与海盗成功救出了希达，同时，他们也发现了军方的邪恶计划。为了阻止军方邪恶计划的实施，他们和海盗一起踏上了寻找拉比达之旅。"}},{name:"楚门的世界",source:"https://cdn.zoubuting.com/20220524/7eG65lXt/1000kb/hls/index.m3u8",cover:"/covers/楚门的世界.jpeg",score:"94",details:{alias:["真人Show(港)","真人戏","真人世界","楚门秀","真人秀"],directors:["彼得·威尔"],scriptwriter:["安德鲁·尼科尔"],actors:["金·凯瑞","劳拉·琳妮","艾德·哈里斯","诺亚·艾默里奇","娜塔莎·麦克艾霍恩"],types:["剧情","科幻"],region:"美国",language:["英语"],date:"1998-06-05",duration:"103分钟",IMDB:"tt0120382",intro:"楚门（金•凯瑞 Jim Carrey 饰）是一个平凡得不能再平凡的人，除了一些有些稀奇的经历之外——初恋女友突然失踪、溺水身亡的父亲忽然似乎又出现在眼前，他和绝大多数30多岁的美国男人绝无异样。这令他倍感失落。他也曾试过离开自己生活了多年的地方，但总因种种理由而不能成行。直到有一天，他忽然发觉自己似乎一直在被人跟踪，无论他走到哪里，干什么事情。这种感觉愈来愈强烈。楚门决定不惜一切代价逃离这个他生活了30多年的地方，去寻找他的初恋女友。但他却发现自己怎样也逃不出去。真相其实很残忍。"}},{name:"肖申克的救赎",source:"https://vip.lzcdn2.com/20220318/7_a4fcd924/1200k/hls/mixed.m3u8",cover:"/covers/肖申克的救赎.jpeg",score:"97",details:{alias:"月黑高飞(港) / 刺激1995(台) / 地狱诺言 / 铁窗岁月 / 消香克的救赎",directors:["弗兰克·德拉邦特"],scriptwriter:"弗兰克·德拉邦特 / 斯蒂芬·金",actors:"蒂姆·罗宾斯 / 摩根·弗里曼 / 鲍勃·冈顿 / 威廉姆·赛德勒 / 克兰西·布朗 / 吉尔·贝罗斯 / 马克·罗斯顿 / 詹姆斯·惠特摩 / 杰弗里·德曼 / 拉里·布兰登伯格 / 尼尔·吉恩托利 / 布赖恩·利比 / 大卫·普罗瓦尔 / 约瑟夫·劳格诺 / 祖德·塞克利拉 / 保罗·麦克兰尼 / 芮妮·布莱恩 / 阿方索·弗里曼 / V·J·福斯特 / 弗兰克·梅德拉诺 / 马克·迈尔斯 / 尼尔·萨默斯 / 耐德·巴拉米 / 布赖恩·戴拉特 / 唐·麦克马纳斯",types:"剧情 / 犯罪",region:"美国",language:["英语"],date:"1994-09-10(多伦多电影节) / 1994-10-14(美国)",duration:"142分钟",IMDB:"tt0120382",intro:"一场谋杀案使银行家安迪（蒂姆•罗宾斯 Tim Robbins 饰）蒙冤入狱，谋杀妻子及其情人的指控将囚禁他终生。在肖申克监狱的首次现身就让监狱“大哥”瑞德（摩根•弗里曼 Morgan Freeman 饰）对他另眼相看。瑞德帮助他搞到一把石锤和一幅女明星海报，两人渐成患难 之交。很快，安迪在监狱里大显其才，担当监狱图书管理员，并利用自己的金融知识帮助监狱官避税，引起了典狱长的注意，被招致麾下帮助典狱长洗黑钱。偶然一次，他得知一名新入狱的小偷能够作证帮他洗脱谋杀罪。燃起一丝希望的安迪找到了典狱长，希望他能帮自己翻案。阴险伪善的狱长假装答应安迪，背后却派人杀死小偷，让他唯一能合法出狱的希望泯灭。沮丧的安迪并没有绝望，在一个电闪雷鸣的风雨夜，一场暗藏几十年的越狱计划让他自我救赎，重获自由！老朋友瑞德在他的鼓舞和帮助下，也勇敢地奔向自由。本片获得1995年奥斯卡10项提名，以及金球奖、土星奖等多项提名。"}},{name:"黑客帝国1",source:"https://vip.lzcdn2.com/20220321/184_c1e1ee38/1200k/hls/mixed.m3u8",cover:"/covers/黑客帝国.jpeg",score:"91",details:{alias:"22世纪杀人网络(港) / 廿二世纪杀人网络(港) / 骇客任务(台) / 骇客帝国",directors:"莉莉·沃卓斯基 / 拉娜·沃卓斯基",scriptwriter:"莉莉·沃卓斯基 / 拉娜·沃卓斯基",actors:"基努·里维斯 / 劳伦斯·菲什伯恩 / 凯瑞-安·莫斯 / 雨果·维文 / 格洛丽亚·福斯特 / 乔·潘托里亚诺 / 马库斯·钟 / 朱利安·阿拉汗加 / 马特·多兰 / 贝琳达·麦克洛里 / 安东尼雷派克 / 罗伯特·泰勒 / 阿达·尼科德莫 / 罗温·维特 / 塔玛拉·布朗 / 纳塔莉·特珍 / 比尔·扬 / 克里斯·斯科特 / 纳许·埃哲顿",types:"动作 / 科幻",region:"美国",language:["英语"],date:"2000-01-14(中国大陆) / 1999-03-31(美国)",duration:"136分钟",IMDB:"tt0133093",intro:"一场谋杀案使银行家安迪（蒂姆•罗宾斯 Tim Robbins 饰）蒙冤入狱，谋杀妻子及其情人的指控将囚禁他终生。在肖申克监狱的首次现身就让监狱“大哥”瑞德（摩根•弗里曼 Morgan Freeman 饰）对他另眼相看。瑞德帮助他搞到一把石锤和一幅女明星海报，两人渐成患难 之交。很快，安迪在监狱里大显其才，担当监狱图书管理员，并利用自己的金融知识帮助监狱官避税，引起了典狱长的注意，被招致麾下帮助典狱长洗黑钱。偶然一次，他得知一名新入狱的小偷能够作证帮他洗脱谋杀罪。燃起一丝希望的安迪找到了典狱长，希望他能帮自己翻案。阴险伪善的狱长假装答应安迪，背后却派人杀死小偷，让他唯一能合法出狱的希望泯灭。沮丧的安迪并没有绝望，在一个电闪雷鸣的风雨夜，一场暗藏几十年的越狱计划让他自我救赎，重获自由！老朋友瑞德在他的鼓舞和帮助下，也勇敢地奔向自由。本片获得1995年奥斯卡10项提名，以及金球奖、土星奖等多项提名。"}},{name:"茶馆",source:"https://vip.lzcdn2.com/20220321/165_6eb8a25a/1200k/hls/mixed.m3u8",cover:"/covers/茶馆.jpeg",score:"91",details:{alias:"The Teahouse",directors:"谢添",scriptwriter:"老舍",actors:"于是之 / 郑榕 / 蓝天野 / 英若诚 / 黄宗洛 / 童超 / 金昭 / 林连昆 / 牛星丽 / 谭宗尧 / 童弟 / 吴淑昆 / 胡宗温 / 程中 / 李大千 / 李源 / 李翔 / 张瞳 / 任宝贤 / 尚丽娟 / 米铁增 / 田春奎 / 冯增祥 / 雷飞 / 林东升 / 孟瑾 / 孙峻峰 / 平原 / 曹世骧 / 王大年 / 王淑华 / 张华 / 丁海涛 / 朱旭 / 孙敬修 / 曹孟浪 / 何康理",types:"剧情 / 历史",region:"中国大陆",language:["汉语普通话"],date:"1982(中国大陆)",duration:"118分钟",IMDB:"tt1395030",intro:"世纪之交，古老的中国正迎来前所未有的巨大变革。老态龙钟的大清王朝摇摇欲坠，六君子的鲜血无法阻止历史车轮的滚动，老北京城的上空风云变幻，波谲云诡。王利发（于是之 饰），北京城内裕泰茶馆的年轻掌柜。他谨记父亲的教诲，体面周全地迎送四方宾客。小小的茶馆内，三教九流各色人等穿梭于此：提笼架鸟哀叹时运的松二爷（黄宗洛 饰）；慨叹国之将亡的刚毅满人常四爷（郑榕 饰）；一心谋求实业救国的秦仲义（蓝天野 饰）；丧尽天良买卖人口的刘麻子（英若诚 饰）；打算娶老婆的庞太监（童超 饰）……你方唱罢我登场，小小茶馆之内演尽世间的沧桑与凄凉……本片根据老舍同名原着改编，并1983年第3届中国电影金鸡奖特别奖、文化部1982年优秀影片奖特别奖。"}},{name:"千与千寻",source:"https://sd3.taopianplay1.com:43333/c56b1bc09da3/HD/2023-01-07/1/bd867764cf92/b7f72ceefe5e/playlist.m3u8",cover:"/covers/千与千寻.webp",score:"94",details:{alias:"神隐少女(台) / 千与千寻的神隐 / Spirited Away / A Voyage of Chihiro / Sen to Chihiro no kamikakushi",directors:"宫崎骏",scriptwriter:"宫崎骏",actors:"柊瑠美 / 入野自由 / 夏木真理 / 菅原文太 / 中村彰男 / 玉井夕海 / 神木隆之介 / 内藤刚志 / 泽口靖子 / 我修院达也 / 大泉洋 / 小林郁夫 / 上条恒彦 / 小野武彦",types:"剧情 / 动画 / 奇幻",region:"日本",language:["日语"],date:"2019-06-21(中国大陆) / 2001-07-20(日本)",duration:"125分钟",IMDB:"tt0245429",intro:"千寻和爸爸妈妈一同驱车前往新家，在郊外的小路上不慎进入了神秘的隧道——他们去到了另外一个诡异世界—一个中世纪的小镇。远处飘来食物的香味，爸爸妈妈大快朵颐，孰料之后变成了猪！这时小镇上渐渐来了许多样子古怪、半透明的人。千寻仓皇逃出，一个叫小白的人救了他，喂了她阻止身体消 失的药，并且告诉她怎样去找锅炉爷爷以及汤婆婆，而且必须获得一份工作才能不被魔法变成别的东西。千寻在小白的帮助下幸运地获得了一份在浴池打杂的工作。渐渐她不再被那些怪模怪样的人吓倒，并从小玲那儿知道了小白是凶恶的汤婆婆的弟子。一次，千寻发现小白被一群白色飞舞的纸人打伤，为了救受伤的小白，她用河神送给她的药丸驱出了小白身体内的封印以及守封印的小妖精，但小白还是没有醒过来。为了救小白，千寻又踏上了她的冒险之旅。"}},{name:"魔女宅急便",source:"https://vip.lzcdn2.com/20220323/314_0f4d8df9/1200k/hls/mixed.m3u8",cover:"/covers/魔女宅急便.jpeg",score:"87",details:{alias:"魔女琪琪(台) / 小魔女限时专送 / Kiki's Delivery Service",directors:"宫崎骏",scriptwriter:"宫崎骏",actors:"高山南 / 佐久间玲 / 户田惠子 / 山口胜平 / 信泽三惠子 / 加藤治子 / 关弘子 / 三浦浩一 / 山寺宏一 / 井上喜久子 / 渊崎由里子 / 土井美加 / 土师孝也 / 浅井淑子 / 齐藤昌 / 西村知道 / 小林优子 / 池水通洋 / 辻亲八 / 大塚明夫 / 坂本千夏 / 田口昂 / 键本景子 / 津贺有子 / 龟井芳子 / 丸山裕子",types:"动画 / 奇幻 / 冒险",region:"日本",language:["日语"],date:"1989-07-29(日本)",duration:"103分钟",IMDB:"tt0097814",intro:"琪琪今年13岁了，按照魔法界的规矩，魔法少女年满13岁就要出外进行为期一年的修行。所以琪琪带着宠物黑猫吉吉踏上了修行之旅。然而，修行之旅开始得并不顺利，当琪琪来到海边一座大城市时，人们并没有欢迎她的到来，人人都不搭理她。幸亏琪琪有一颗善良的心，当她拾到了一件别人的失物时，热心的琪琪找到了失主。她的善良赢得了面包店老板娘的好感，琪琪就在面包店开始了她用飞行魔法为客人服务的快递业务。琪琪很快适应了新环境，一次，一个热衷于飞机制造的男孩邀请琪琪去参加飞行俱乐部的聚会，途中琪琪因为帮一位老大娘送东西而被雨淋了。从此，琪琪突然发现自己的魔法正在一天天变弱。"}}],xc=[{name:"UNIX环境高级编程（第3版 英文pdf）",source:"/books/Advanced Programming in the UNIX® Environment (W. Richard Stevens  Stephen A. Rago [Stevens etc.) (Z-Library).pdf",cover:"/covers/APUE-en.jpg",score:"97",details:{author:["史蒂文斯 (W.Richard Stevens) / 拉戈 (Stephen A.Rago)"],producer:["异步图书"],publisher:"人民邮电出版社",translator:"",subTitle:"",date:"2014-6-1",pageNumber:812,price:"128.00元",binding:"平装",series:"",ISBN:"9787115352118"}},{name:"UNIX环境高级编程（第3版）",source:"/books/UNIX环境高级编程 (W. Richard Stevens, Stephen A. Rago) (Z-Library).epub",cover:"/covers/APUE.jpg",score:"97",details:{author:["史蒂文斯 (W.Richard Stevens) / 拉戈 (Stephen A.Rago)"],producer:["异步图书"],publisher:"人民邮电出版社",translator:"戚正伟 / 张亚英 / 尤晋元",subTitle:"",date:"2014-6-1",pageNumber:812,price:"128.00元",binding:"平装",series:"",ISBN:"9787115352118"}},{name:"程序员修炼之道（第2版）",source:"/books/程序员修炼之道：通向务实的最高境界（第2版） ((美）David Thomas（大卫·托马斯），Andrew Hunt（安德鲁·亨特）) (Z-Library).epub",cover:"/covers/程序员修炼之道.jpg",score:"92",details:{author:["[美] David Thomas / [美] Andrew Hunt"],producer:["博文视点"],publisher:"电子工业出版社",translator:"云风",subTitle:"通向务实的最高境界",date:"2020-4-1",pageNumber:344,price:"89.00元",binding:"平装",series:"",ISBN:"9787121384356"}},{name:"可能性的艺术",source:"/books/可能性的艺术：比较政治学30讲（学者刘瑜比较政治学新著，跳出现象，通过比较洞察政治，突破认知偏见，在浩瀚的可能性中理解我们自身 理想国... (Z-Library).epub",cover:"/covers/可能性的艺术.jpg",score:"91",details:{author:["刘瑜"],producer:["理想国"],publisher:"广西师范大学出版社",translator:"",subTitle:"比较政治学30讲",date:"2022-4",pageNumber:384,price:"82.00元",binding:"精装",series:"",ISBN:"9787559848048"}},{name:"UNIX编程艺术",source:"/books/UNIX编程艺术 (【美】理曼德 (Raymond E.S.)) (Z-Library).epub",cover:"/covers/Unix编程艺术.jpg",score:"90",details:{author:["[美国] Eric S·Raymond"],producer:["博文视点"],publisher:"电子工业出版社",translator:"姜宏 / 何源 / 蔡晓俊",subTitle:"",date:"2006-2",pageNumber:525,price:"59.00元",binding:"平装",series:"",ISBN:"9787121021169"}},{name:"尼安德特人",source:"/books/尼安德特人 (斯万特·帕博) (Z-Library).epub",cover:"/covers/尼安德特人.jpg",score:"83",details:{author:["[瑞典] 斯万特·帕博（Svante Pääbo）"],producer:["后浪"],publisher:"浙江教育出版社",translator:"夏志 / 杨焕明",subTitle:"",date:"2018-12",pageNumber:336,price:"68.00元",binding:"精装",series:"",ISBN:"9787553678351"}},{name:"哲学的故事",source:"/books/哲学的故事【让深奥的哲学立刻生动起来上市首年连续再版22次，迅速译成18种语言，掀起全球哲学热潮】 (威尔•杜兰特 (Will Durant)) (Z-Library).epub",cover:"/covers/哲学的故事.jpg",score:"88",details:{author:["[美] 威尔·杜兰特"],publisher:"新星出版社",producer:["新经典文化"],translator:"蒋剑峰 / 张程程",subTitle:"",date:"2013-3",pageNumber:432,price:"49.00元",binding:"平装",series:"",ISBN:"9787513306331",originalTitle:"The Story of Philosophy"}},{name:"写作是门手艺",source:"/books/The Craft of Writing 写作是门手艺 (刘军强) (Z-Library).epub",cover:"/covers/写作是门手艺.jpg",score:"91",details:{author:["刘军强"],publisher:"广西师范大学出版社",producer:[],translator:"",subTitle:"",date:"2020-7-30",pageNumber:316,price:"58.00元",binding:"平装",series:"",ISBN:"9787559830043"}},{name:"And Then There Were None",source:"/books/And Then There Were None (Agatha Christie) (Z-Library).epub",cover:"/covers/无人生还.jpg",score:"100",details:{author:["Agatha Christie"],publisher:"William Morrow Paperbacks",producer:[],translator:"",subTitle:"",date:"2011",pageNumber:272,price:"",binding:"",series:"",ISBN:"9780062073471"}},{name:"小说的八百万种写法",source:"/books/小说的八百万种写法 (劳伦斯·布洛克) (Z-Library).epub",cover:"/covers/小说的八百万种写法.jpg",score:"74",details:{author:["[美] 劳伦斯·布洛克"],publisher:"中国友谊出版公司",producer:["后浪"],translator:"邵逸",subTitle:"",date:"2019-7",pageNumber:368,price:"56.00元",binding:"平装",series:"后浪创意写作教室",ISBN:"9787505746367"}},{name:"Harry Potter and the Sorcerer's Stone",source:"/books/Harry Potter and the Sorcerers Stone (J.K. Rowling) (Z-Library).epub",cover:"/covers/哈利波特与魔法石.jpg",score:"74",details:{author:["J·K·Rowling"],publisher:"Arthur A. Levine Books",producer:["Children's ed"],translator:"",subTitle:"",date:"1998",pageNumber:309,price:"56.00元",binding:"平装",series:"Harry Potter #1",ISBN:"9780590353403"}}],Lc=[{name:"x",musicSrc:"http://other.player.rc01.sycdn.kuwo.cn/d84d12b10a48e1c9ac966315a66dd9a2/648546a7/resource/n1/12/69/1531173933.mp3",cover:"",lyric:"",duration:0,details:{singer:[],date:""}}],Ac=[{name:"SudoKu",source:"https://jujuxi.xyz/sudoku",score:"100",cover:"/covers/SudoKu.jpg",details:{author:["liuqinh2s"],date:"2023-10-23"}}];var Rc=r(2054),Ic={};Ic.styleTagTransform=m(),Ic.setAttributes=d(),Ic.insert=u().bind(null,"head"),Ic.domAPI=l(),Ic.insertStyleElement=p(),a()(Rc.A,Ic),Rc.A&&Rc.A.locals&&Rc.A.locals;const Cc=n=>{const{list:i,index:r}=n,s=ce(),[a,o]=(0,t.useState)(r);return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)("ul",{className:"category",children:(()=>{let t=[];for(let n=0;n<i.length;n++){const{title:r,path:l}=i[n];t.push((0,e.jsx)("li",{className:n===a?"active":"",onClick:()=>{o(n),s("/"+l)},children:r},n))}return t})()})})},Dc=()=>{const t=ue()||{};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Cc,{list:kc,index:0}),(0,e.jsx)(Oe,{data:_c[t.id||0]}),(0,e.jsx)(Tc,{source:_c[t.id||0].source})]})};var Pc=r(4368);const Oc=n=>{const{source:i}=n,[r,s]=(0,t.useState)(null);return(0,e.jsx)("div",{style:{height:"100vh"},children:(0,e.jsx)(Pc.ReactReader,{location:r,locationChanged:e=>{s(e)},url:i})})},Nc=t=>{const{source:n}=t;return n.endsWith(".epub")?(0,e.jsx)(Oc,{source:n}):n.endsWith(".pdf")?(window.open(`https://${document.location.host}`+n),(0,e.jsx)(e.Fragment,{})):(0,e.jsx)(e.Fragment,{})},Mc=()=>{const t=ue()||{};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Cc,{list:kc,index:1}),(0,e.jsx)(Nc,{source:xc[t.id||0].source})]})};var Fc=r(1106),Bc={};Bc.styleTagTransform=m(),Bc.setAttributes=d(),Bc.insert=u().bind(null,"head"),Bc.domAPI=l(),Bc.insertStyleElement=p(),a()(Fc.A,Bc),Fc.A&&Fc.A.locals&&Fc.A.locals;const Uc=t=>{const{id:n,name:i,cover:r,score:s}=t,a=ce(),o=ue(),l=()=>{console.log(o),a("/"+(o.id||"video")+"/"+n)};return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)("div",{className:"simple-card",children:[(0,e.jsx)("img",{className:"cover",src:r,onClick:()=>{l()}}),(0,e.jsx)("div",{className:"title",onClick:()=>{l()},children:i}),(0,e.jsx)(Ce,{score:s})]})})};var $c=r(6046),jc={};jc.styleTagTransform=m(),jc.setAttributes=d(),jc.insert=u().bind(null,"head"),jc.domAPI=l(),jc.insertStyleElement=p(),a()($c.A,jc),$c.A&&$c.A.locals&&$c.A.locals;const zc=t=>{const{data:n}=t;return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)("div",{className:"block",children:(()=>{let t=[];for(let i=0;i<n.length;i++)t.push((0,e.jsx)("div",{className:"card-wrap",children:(0,e.jsx)(Uc,{name:n[i].name,cover:n[i].cover,score:n[i].score,id:i+""})},i));return t})()})})},Gc=()=>{const t=ue();return console.log(t),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Cc,{list:kc,index:(()=>{switch(t.id){case void 0:case"video":return 0;case"ebook":return 1;case"music":return 2;case"picture":return 3;case"article":return 4;case"rss":return 5;case"game":return 6;default:return 0}})()}),(0,e.jsx)(zc,{data:(()=>{switch(t.id){case void 0:case"video":return _c;case"ebook":return xc;case"game":return Ac;default:return[]}})()})]})};var Vc=r(9108),qc={};qc.styleTagTransform=m(),qc.setAttributes=d(),qc.insert=u().bind(null,"head"),qc.domAPI=l(),qc.insertStyleElement=p(),a()(Vc.A,qc),Vc.A&&Vc.A.locals&&Vc.A.locals;const Hc=()=>(console.log(Lc),(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(Cc,{list:kc,index:2})})),Wc=()=>{const t=ue()||{};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Cc,{list:kc,index:6}),(0,e.jsx)("iframe",{src:Ac[t.id||0].source,style:{width:"100%",height:"calc(100vh - 129px)",borderWidth:"0px"}})]})},Kc="/AwesomeWeb";function Yc(){return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(_e,{children:(0,e.jsxs)(we,{children:[(0,e.jsx)(Ee,{path:Kc+"/",element:(0,e.jsx)(Gc,{})}),(0,e.jsx)(Ee,{path:Kc+"/:id",element:(0,e.jsx)(Gc,{})}),(0,e.jsx)(Ee,{path:Kc+"/video/:id",element:(0,e.jsx)(Dc,{})}),(0,e.jsx)(Ee,{path:Kc+"/ebook/:id",element:(0,e.jsx)(Mc,{})}),(0,e.jsx)(Ee,{path:Kc+"/music",element:(0,e.jsx)(Hc,{})}),(0,e.jsx)(Ee,{path:Kc+"/game/:id",element:(0,e.jsx)(Wc,{})})]})})})}i.createRoot(document.getElementById("root")).render((0,e.jsx)(t.StrictMode,{children:(0,e.jsx)(Yc,{})}))})()})();